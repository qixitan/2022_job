self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[4969],{66877:function(e,t,r){r.d(t,{Z:function(){return n},p:function(){return a}});var n,i=r(76138);!function(e){e[e.Default=0]="Default",e[e.Temporary=1]="Temporary",e[e.LocalPersist=2]="LocalPersist"}(n||(n={}));var a=(0,i.yh)("IBehavior")},59392:function(e,t,r){r.d(t,{Z:function(){return G}}),r(13857),r(54371),r(95019),r(31575),r(5570),r(64656),r(43125),r(27849),r(31688),r(84919),r(11425),r(15770);var n=r(13504),i=(r(53248),r(38934),r(63240),r(48845),r(19553),r(71091),r(81144),r(30526)),a=r(3237),o=r(85952),s=(r(17302),r(93984),r(90109),r(40819)),c=r(3332),u=r(76138),h=r(8326),l=r(82449),p=r(82249),d=r(99419),f=(r(36156),r(86280)),v=r(66544),w=r(84801),m=r(44025),g=r(68860),y=r(31973);function x(){"use strict";x=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(k){s=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof l?t:l,a=Object.create(i.prototype),o=new A(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return{value:void 0,done:!0}}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=E(o,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,o),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(k){return{type:"throw",arg:k}}}e.wrap=c;var h={};function l(){}function p(){}function d(){}var f={};s(f,i,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(P([])));w&&w!==t&&r.call(w,i)&&(f=w);var m=d.prototype=l.prototype=Object.create(f);function g(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function n(i,a,o,s){var c=u(e[i],e,a);if("throw"!==c.type){var h=c.arg,l=h.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(l).then((function(e){h.value=e,o(h)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function E(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function P(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:_}}function _(){return{value:void 0,done:!0}}return p.prototype=d,s(m,"constructor",d),s(d,"constructor",p),p.displayName=s(d,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},g(y.prototype),s(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new y(c(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},g(m),s(m,o,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}var E=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(t){a(t)}}function s(e){try{c(n.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))};function b(e){var t,r,n;return null===(n=null===(r=null===(t=globalThis)||void 0===t?void 0:t.aegis)||void 0===r?void 0:r.error)||void 0===n||n.call(r,e),console.error(e),Promise.resolve()}var C=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._level2Inited=!1,t}(0,n.Z)(t,e);var r=t.prototype;return r.initLevel2=function(){var t=Object.create(null,{_level1Inited:{get:function(){return e.prototype._level1Inited}},initLevel1:{get:function(){return e.prototype.initLevel1}}});return E(this,void 0,void 0,x().mark((function e(){var r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._level1Inited){e.next=3;break}return e.next=3,t.initLevel1.call(this);case 3:if(!this._level2Inited){e.next=6;break}return console.info("view.level2 已经初始化"),e.abrupt("return");case 6:return console.info("view.level2 初始化"),w.Am.get(m.v).listen(g.c.ContextMenuShowed,(function(){y.ZP.tdwReport({opername:"doc_excel_rightclkmenu",module:"function",action:"show"})})),e.next=11,this.initUserCustomThemeCenter().catch(b);case 11:return r=[c.k.CHART_CENTER,c.k.AREA_OVERLAY,c.k.FILTER_CENTER,c.k.DATE_REMINDER_CENTER].map((function(e){return c.U[e]()})).filter((function(e){return!!e})),e.next=14,Promise.all(r);case 14:if(!this.spreadsheetApp.sheetStatus.workbookStatus.canEdit){e.next=32;break}return e.next=17,this._initFreezePreview().catch(b);case 17:return e.next=19,this._initSmartDrag().catch(b);case 19:return e.next=21,this._initInputSmartSplit().catch(b);case 21:if(!1===h.Z.getConfig("custom.insertDeleteMoveRange")){e.next=24;break}return e.next=24,this.initRangeMove().catch(b);case 24:return e.next=26,this._initChartRangeRenderPlugin().catch(b);case 26:return e.next=28,this._initAreaOverlay().catch(b);case 28:return e.next=30,this._initValidationList().catch(b);case 30:return e.next=32,this._initConditionFormatCenter().catch(b);case 32:return e.next=34,this._initCornerTriangle().catch(b);case 34:return e.next=36,this._initMentionCenter().catch(b);case 36:return e.next=38,this._initChartCenter().catch(b);case 38:return e.next=40,this._initAccessibility().catch(b);case 40:return e.next=42,this._initCollabFilterToast().catch(b);case 42:return e.next=44,this._initFilterViewCenter().catch(b);case 44:return e.next=46,this._initFilterHeader().catch(b);case 46:return e.next=48,this._initTestApi().catch(b);case 48:return e.next=50,this.initSelectRowColHighlightRenderPlugin().catch(b);case 50:return e.next=52,this._initCanvasProvider().catch(b);case 52:return e.next=54,this.initPivotTableCenter().catch(b);case 54:e.next=71;break;case 57:return e.next=59,this._initDateReminderCenter().catch(b);case 59:return e.next=61,this.initHistoryReviewCenter().catch(b);case 61:return e.next=63,this._initWedocDiscuss().catch(b);case 63:return e.next=65,this.initDiscussion().catch(b);case 65:return e.next=67,this._initTodoCenter().catch(b);case 67:return e.next=69,this._initWeworkComponentCenter().catch(b);case 69:return e.next=71,this.initCollabCenter().catch(b);case 71:d.f2.checkPermission(),this._level2Inited=!0;case 73:case"end":return e.stop()}}),e,this)})))},r.init=function(t){var r=Object.create(null,{init:{get:function(){return e.prototype.init}}});return E(this,void 0,void 0,x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.init.call(this,t),this.initSheetRenderCache(t);case 2:case"end":return e.stop()}}),e,this)})))},r.refresh=function(t){var r=Object.create(null,{refresh:{get:function(){return e.prototype.refresh}}});return E(this,void 0,void 0,x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.refresh.call(this,t),this.initSheetRenderCache(t);case 2:case"end":return e.stop()}}),e,this)})))},r.getRangeMove=function(){return this.rangeMove},r.getCanvasProvider=function(){return this.canvasProvider},r.getTablePrintCenter=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tablePrintCenter){e.next=2;break}return e.abrupt("return",this.tablePrintCenter);case 2:return e.next=4,c.U[c.k.TABLE_PRINT_CENTER]();case 4:return t=e.sent.default,this.tablePrintCenter=new t({app:this.spreadsheetApp,spreadSheet:this.spreadsheet,transformTable:this.transformTable,rowcolAccessor:this.rowcolAccessor,borderAccessor:this.borderAccessor,rowCoverAccessor:this.rowCoverAccessor,paragraphAccessor:this.paragraphAccessor,chartCenter:this.chartCenter,normalSelectData:this.normalSelectData}),e.abrupt("return",this.tablePrintCenter);case 7:case"end":return e.stop()}}),e,this)})))},r.initSheetRenderCache=function(e){var t,r,n,i,a,o,s,c,u;null===(t=this.scrollBar)||void 0===t||t.refresh(),null===(r=this.cardCenter)||void 0===r||r.refresh(e),null===(n=this.chartCenter)||void 0===n||n.refresh(),null===(i=this.addonCenter)||void 0===i||i.refresh(),null===(a=this.dimensionEdit)||void 0===a||a.refresh(),null===(o=this.smartDrag)||void 0===o||o.refresh(),null===(s=this.inputManager)||void 0===s||s.focus(),null===(c=this.dataValidationCenter)||void 0===c||c.refresh(),null===(u=this.errorTip)||void 0===u||u.refresh(e)},r._initSmartDrag=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.SMART_DRAG]();case 2:t=e.sent.default,this.smartDrag=new t({spreadsheetApp:this.spreadsheetApp,mainBoard:this.mainBoard,areaData:this.areaData,selectData:this.normalSelectData,selectionStage:this.normalSelectionStage,autoScroll:this.autoScroll,operateData:this.operateData,modifySmartSelectionBroker:this.modifySmartSelectionBroker,headSize:this.headSize,inputManager:this.inputManager,clientRect:this.clientRect,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,scale:this.scale});case 4:case"end":return e.stop()}}),e,this)})))},r._initAreaOverlay=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.AREA_OVERLAY]();case 2:t=e.sent.default,this.areaOverlay=new t({areaData:this.areaData,mainBoard:this.mainBoard});case 4:case"end":return e.stop()}}),e,this)})))},r._initFreezePreview=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.FREEZE_PREVIEW]();case 2:t=e.sent.default,this.freezePreview=new t({areaData:this.areaData,mainBoard:this.mainBoard,rowcolAccessor:this.rowcolAccessor,renderApi:this.renderApi});case 4:case"end":return e.stop()}}),e,this)})))},r._initTestApi=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.TEST_API]();case 2:t=e.sent.default,this.testApi=new t({spreadsheet:this.spreadsheet,areaData:this.areaData});case 4:case"end":return e.stop()}}),e,this)})))},r._initFilterHeader=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.FILTER_CENTER]();case 2:t=e.sent.default,this.filterCenter=new t({spreadsheetApp:this.spreadsheetApp,spreadsheet:this.spreadsheet,alloyExcel:this.alloyExcel,rowcolAccessor:this.rowcolAccessor,areaData:this.areaData,headSize:this.headSize,renderApi:this.renderApi,tableView:this.tableView,dataCallView:this.dataCallView,operateData:this.operateData,mouseOperate:this.mouseOperate,touchOperate:this.touchOperate,spreadConfig:this.spreadConfig,scale:this.scale,mainBoard:this.mainBoard});case 4:case"end":return e.stop()}}),e,this)})))},r.initFileUploaderEnt=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.FILE_UPLOADER]();case 2:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===e;case 6:if(!t.t0){t.next=10;break}t.t2=void 0,t.next=11;break;case 10:t.t2=e.default;case 11:(r=t.t2)&&(this.iFileUploader=new r({container:this.spreadsheetView.container,spreadsheetApp:this.spreadsheetApp,spreadsheetView:this.spreadsheetView}));case 13:case"end":return t.stop()}}),t,this)})))},r._initValidationList=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.PC_DATA_VALIDATION_CENTER]();case 2:t=e.sent.default,this.dataValidationCenter=new t({spreadsheetApp:this.spreadsheetApp,spreadsheet:this.spreadsheet,alloyExcel:this.alloyExcel,normalSelectData:this.normalSelectData,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,areaData:this.areaData,headSize:this.headSize,renderApi:this.renderApi,mouseOperate:this.mouseOperate,touchOperate:this.touchOperate,operateData:this.operateData,clientRect:this.clientRect,mainBoard:this.mainBoard,inputManager:this.inputManager,mutexManagement:this.mutexManagement,sheetStatus:this.spreadsheetApp.sheetStatus,spreadsheetView:this.spreadsheetView});case 4:case"end":return e.stop()}}),e,this)})))},r._initCollabFilterToast=function(){return E(this,void 0,void 0,x().mark((function e(){var t,r=this;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.COLLAB_FILTER_TOAST]();case 2:t=e.sent.default,this.collabFilterToast=this._register(new t({mutationBehavior:this.spreadsheetApp.mutationBehavior,messageCenterAdapter:this.spreadsheetApp.messageCenterAdapter,getActiveSheetId:this.spreadsheet.getActiveSheetId.bind(this.spreadsheet),isFilterSync:function(){return r.spreadsheet.isFilterSync},spreadsheetApp:this.spreadsheetApp}));case 4:case"end":return e.stop()}}),e,this)})))},r._initCornerTriangle=function(){return E(this,void 0,void 0,x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.CORNER_TRIANGLE_RENDER_PLUGIN]();case 2:new(0,e.sent.default)({alloyExcel:this.alloyExcel,normalSelectData:this.normalSelectData,transformTable:this.transformTable,coverBackgroundCollect:this.renderPluginExtension.coverBackgroundCollect,spreadsheet:this.spreadsheet});case 4:case"end":return e.stop()}}),e,this)})))},r._initMentionCenter=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.MENTION_CENTER]();case 2:t=e.sent.default,this.mentionCenter=new t({spreadsheetApp:this.spreadsheetApp,inputManager:this.inputManager,spreadsheet:this.spreadsheet,rowcolAccessor:this.rowcolAccessor,alloyExcel:this.alloyExcel,mouseOperate:this.mouseOperate,areaData:this.areaData,headSize:this.headSize,renderApi:this.renderApi,tableView:this.tableView,transformTable:this.transformTable,rowCoverAccessor:this.rowCoverAccessor,operateData:this.operateData,scale:this.scale,sheetStatus:this.spreadsheetApp.sheetStatus,paragraphAccessor:this.paragraphAccessor,mentionHighlightCollector:this.renderPluginExtension.highlightAnimateCollector,autoFillService:this.spreadsheetApp.serviceCollection.services.get(f.Z.INPUT_AUTOFILL)});case 4:case"end":return e.stop()}}),e,this)})))},r._initChartCenter=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.CHART_CENTER]();case 2:t=e.sent.default,this.chartCenter=new t({mainBoard:this.mainBoard,dataCallView:this.dataCallView,spreadsheet:this.spreadsheet,areaData:this.areaData,scale:this.scale,operateData:this.operateData,mutexManagement:this.mutexManagement,spreadsheetApp:this.spreadsheetApp});case 4:case"end":return e.stop()}}),e,this)})))},r._initAccessibility=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.ACCESSIBILITY]();case 2:t=e.sent.default,this.accessibility=new t({board:this.container,spreadsheet:this.spreadsheet,normalSelectData:this.normalSelectData,inputManager:this.inputManager,sheetStatus:this.spreadsheetApp.sheetStatus,rowcolAccessor:this.rowcolAccessor});case 4:case"end":return e.stop()}}),e,this)})))},r._initInputSmartSplit=function(){return E(this,void 0,void 0,x().mark((function e(){return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.INPUT_SMART_SPLIT]();case 2:new(0,e.sent.default)({spreadsheetApp:this.spreadsheetApp});case 4:case"end":return e.stop()}}),e,this)})))},r._initConditionFormatCenter=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.CONDITION_FORMAT_CENTER]();case 2:t=e.sent.default,this.conditionFormatCenter=new t({spreadsheetApp:this.spreadsheetApp,spreadsheet:this.spreadsheet,tableView:this.tableView,normalSelectData:this.normalSelectData,mainBoard:this.mainBoard,areaData:this.areaData,requestApi:this.spreadsheetApp.requestApi,mutationBehavior:this.spreadsheetApp.mutationBehavior,sheetStatus:this.spreadsheetApp.sheetStatus,alloyExcel:this.alloyExcel,rowcolAccessor:this.rowcolAccessor});case 4:case"end":return e.stop()}}),e,this)})))},r._initChartRangeRenderPlugin=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.CHART_RANGE]();case 2:t=e.sent.default,this.chartRange=new t({alloyExcel:this.alloyExcel,areaData:this.areaData,headSize:this.headSize,renderApi:this.renderApi,spreadsheet:this.spreadsheet,chartRangeCollector:this.renderPluginExtension.rangeBorderRenderCollector});case 4:case"end":return e.stop()}}),e,this)})))},r._initCanvasProvider=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.CANVAS_PROVIDER]();case 2:t=e.sent.default,this.canvasProvider=new t({app:this.spreadsheetApp,chartCenter:this.chartCenter,alloyExcel:this.alloyExcel});case 4:case"end":return e.stop()}}),e,this)})))},r._initWedocDiscuss=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,l.n_)()){t.next=15;break}return t.next=4,c.U[c.k.WEDOC_DISCUSS]();case 4:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=8;break}t.t0=void 0===e;case 8:if(!t.t0){t.next=12;break}t.t2=void 0,t.next=13;break;case 12:t.t2=e.default;case 13:(r=t.t2)&&(this.WedocDiscuss=new r);case 15:case"end":return t.stop()}}),t,this)})))},r.initCollabCenter=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.COLLAB]();case 2:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===e;case 6:if(!t.t0){t.next=10;break}t.t2=void 0,t.next=11;break;case 10:t.t2=e.default;case 11:(r=t.t2)&&(this.collabCenter=new r({spreadSheet:this.spreadsheet,inputManager:this.inputManager}));case 13:case"end":return t.stop()}}),t,this)})))},r.initDiscussion=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,p.eo)()){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,c.U[c.k.DISCUSSION]();case 4:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=8;break}t.t0=void 0===e;case 8:if(!t.t0){t.next=12;break}t.t2=void 0,t.next=13;break;case 12:t.t2=e.default;case 13:(r=t.t2)&&(this.discussionCenter=new r({spreadsheet:this.spreadsheet,headSize:this.headSize,areaData:this.areaData,renderApi:this.renderApi,alloyExcel:this.alloyExcel,spreadsheetView:this.spreadsheetView}));case 15:case"end":return t.stop()}}),t,this)})))},r.initRangeMove=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.RANGE_MOVE]();case 2:t=e.sent.default,this.rangeMove=new t({spreadsheetApp:this.spreadsheetApp,mainBoard:this.mainBoard,autoScroll:this.autoScroll,operateData:this.operateData,areaData:this.areaData,selectData:this.normalSelectData,selectionStage:this.normalSelectionStage,rowcolAccessor:this.rowcolAccessor});case 4:case"end":return e.stop()}}),e,this)})))},r._initDateReminderCenter=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.DATE_REMINDER_CENTER]();case 2:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===e;case 6:if(!t.t0){t.next=10;break}t.t2=void 0,t.next=11;break;case 10:t.t2=e.default;case 11:(r=t.t2)&&(this.dateReminderCenter=new r({app:this.spreadsheetApp,spreadsheet:this.spreadsheet,spreadsheetView:this.spreadsheetView,alloyExcel:this.alloyExcel,renderApi:this.renderApi,dateReminderHighlightCollector:this.renderPluginExtension.highlightAnimateCollector,inputManager:this.inputManager,normalSelectData:this.normalSelectData,mouseOperate:this.mouseOperate,operateData:this.operateData,sheetStatus:this.spreadsheetApp.sheetStatus,container:this.container}));case 13:case"end":return t.stop()}}),t,this)})))},r.initSelectRowColHighlightRenderPlugin=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.SELECT_ROW_COL_HIGHLIGHT]();case 2:t=e.sent.default,this.selectRowColHighlightRenderPlugin=new t({alloyExcel:this.alloyExcel,renderApi:this.renderApi,selectRowColHighlightCollector:this.renderPluginExtension.selectRowColHighlightCollector,areaData:this.areaData,headSize:this.headSize,rowcolAccessor:this.rowcolAccessor,normalSelectData:this.normalSelectData});case 4:case"end":return e.stop()}}),e,this)})))},r.initHistoryReviewCenter=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.HISTORY_REVIEW_CENTER]();case 2:t=e.sent.default,this.historyReviewCenter=new t({history:this.spreadsheetApp.history,messageCenter:this.spreadsheetApp.messageCenterAdapter,spreadsheet:this.spreadsheet});case 4:case"end":return e.stop()}}),e,this)})))},r._initFilterViewCenter=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.FILTER_VIEW_CENTER]();case 2:t=e.sent.default,this.filterViewCenter=new t({spreadsheet:this.spreadsheet,resize:this.resize,alloyExcel:this.alloyExcel,requestApi:this.spreadsheetApp.requestApi,sheetStatus:this.spreadsheetApp.sheetStatus});case 4:case"end":return e.stop()}}),e,this)})))},r._initTodoCenter=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.TODO_CENTER]();case 2:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===e;case 6:if(!t.t0){t.next=10;break}t.t2=void 0,t.next=11;break;case 10:t.t2=e.default;case 11:(r=t.t2)&&(this.todoCenter=new r({app:this.spreadsheetApp,spreadsheet:this.spreadsheet,requestApi:this.spreadsheetApp.requestApi,alloyExcel:this.alloyExcel,normalSelectData:this.normalSelectData,rangeBorderCollector:this.renderPluginExtension.rangeBorderRenderCollector,spreadsheetView:this.spreadsheetView,renderApi:this.renderApi,mouseOperate:this.mouseOperate,cardCenter:this.cardCenter,hoverCardCenter:this.hoverCardCenter}));case 13:case"end":return t.stop()}}),t,this)})))},r.initUserCustomThemeCenter=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r,n=this;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.USER_CUSTOM_THEME_CENTER]();case 2:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===e;case 6:if(!t.t0){t.next=10;break}t.t2=void 0,t.next=11;break;case 10:t.t2=e.default;case 11:(r=t.t2)&&this.spreadsheetApp.event.init.listen(v.W1.AFTER_ALL_RENDER,(function(){n.userCustomTheme=new r(n.spreadsheetApp)}));case 14:case"end":return t.stop()}}),t,this)})))},r._initWeworkComponentCenter=function(){var e;return E(this,void 0,void 0,x().mark((function t(){var r;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.U[c.k.WEWORK_COMPONENT]();case 2:if(t.t1=e=t.sent,t.t0=null===t.t1,t.t0){t.next=6;break}t.t0=void 0===e;case 6:if(!t.t0){t.next=10;break}t.t2=void 0,t.next=11;break;case 10:t.t2=e.default;case 11:(r=t.t2)&&(this.weworkComponentCenter=new r({app:this.spreadsheetApp,alloyExcel:this.alloyExcel,spreadsheet:this.spreadsheet,spreadsheetView:this.spreadsheetView,renderApi:this.renderApi,hoverCardCenter:this.hoverCardCenter,todoCenter:this.todoCenter,operateData:this.operateData,mouseOperate:this.mouseOperate,cardCenter:this.cardCenter}));case 13:case"end":return t.stop()}}),t,this)})))},r.initPivotTableCenter=function(){return E(this,void 0,void 0,x().mark((function e(){var t;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.U[c.k.PIVOT_TABLE_CENTER]();case 2:t=e.sent.default,this.pivotTableCenter=new t({alloyExcel:this.alloyExcel,spreadsheet:this.spreadsheet,operateData:this.operateData,mouseOperate:this.mouseOperate,touchOperate:this.touchOperate,areaData:this.areaData,headSize:this.headSize,renderApi:this.renderApi,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,mainBoard:this.mainBoard,highlightSourceCollector:this.renderPluginExtension.rangeBorderRenderCollector});case 4:case"end":return e.stop()}}),e,this)})))},(0,o.Z)(t,[{key:"contextMenu",get:function(){var e;return null===(e=this.contextMenuCenter)||void 0===e?void 0:e.contextMenu}},{key:"shapeEdit",get:function(){var e;return null===(e=this.shapeEditCenter)||void 0===e?void 0:e.shapeEdit}},{key:"selectCells",get:function(){var e;return null===(e=this.selectCellsCenter)||void 0===e?void 0:e.selectOperate}},{key:"chartRangeRenderPlugin",get:function(){return this.chartRange}},{key:"fileUploader",get:function(){return this.iFileUploader}}]),t}((0,u.bG)(s.Z)),A=C,P=r(72565),_=r(14682),k=r(12369),S=r(32263),R={customFormatPanel:function(){return Promise.all([r.e(3188),r.e(4335),r.e(9778)]).then(r.bind(r,96058))},dataValidationPanel:function(){return Promise.all([r.e(3298),r.e(5672),r.e(6551),r.e(4335),r.e(8738),r.e(4490),r.e(1823),r.e(599),r.e(9656),r.e(87),r.e(3301)]).then(r.bind(r,50954))},sortRangePanel:function(){return Promise.all([r.e(3298),r.e(9656),r.e(9068)]).then(r.bind(r,63238))},rangeSelectionPanel:function(){return Promise.all([r.e(3188),r.e(3298),r.e(5672),r.e(6551),r.e(1756),r.e(505),r.e(2926),r.e(9656),r.e(6168)]).then(r.bind(r,72741))},validationErrorPanel:function(){return Promise.all([r.e(3188),r.e(3298),r.e(5672),r.e(6551),r.e(1756),r.e(505),r.e(2926),r.e(9656),r.e(6168)]).then(r.bind(r,90769))},filterPanel:function(){return Promise.all([r.e(3298),r.e(4335),r.e(818),r.e(910)]).then(r.bind(r,8675))},pivotTableFilterPanel:function(){return Promise.all([r.e(3298),r.e(4335),r.e(818),r.e(910)]).then(r.bind(r,7351))},formulaEditorPanel:function(){return Promise.all([r.e(4335),r.e(1147)]).then(r.bind(r,76839))},sidePanelMain:function(){return Promise.all([r.e(3188),r.e(3298),r.e(5672),r.e(6551),r.e(1756),r.e(505),r.e(2926),r.e(9656),r.e(6168)]).then(r.bind(r,85075))},rangeAuthPanel:function(){return Promise.all([r.e(3188),r.e(3298),r.e(5672),r.e(6551),r.e(4335),r.e(1756),r.e(8738),r.e(505),r.e(2926),r.e(9175)]).then(r.bind(r,41557))},errorTipPanel:function(){return Promise.all([r.e(3298),r.e(6214)]).then(r.bind(r,66706))},listPopoverCenter:function(){return r.e(8751).then(r.bind(r,5554))},dateReminderPanel:function(){return null},pivotTableCreatePanel:function(){return Promise.all([r.e(3188),r.e(3298),r.e(8738),r.e(4490),r.e(3100),r.e(1036),r.e(9061)]).then(r.bind(r,50036))},pivotTableRowColFieldSettingPanel:function(){return Promise.all([r.e(3188),r.e(3298),r.e(8738),r.e(4490),r.e(3100),r.e(1036),r.e(9061)]).then(r.bind(r,80116))},pivotTableValueFieldSettingPanel:function(){return Promise.all([r.e(3188),r.e(3298),r.e(8738),r.e(4490),r.e(3100),r.e(1036),r.e(9061)]).then(r.bind(r,16239))}},T=r(13423);function D(){"use strict";D=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(_){s=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof l?t:l,a=Object.create(i.prototype),o=new C(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(i,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw a;return{value:void 0,done:!0}}for(r.method=i,r.arg=a;;){var o=r.delegate;if(o){var s=x(o,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,o),a}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(_){return{type:"throw",arg:_}}}e.wrap=c;var h={};function l(){}function p(){}function d(){}var f={};s(f,i,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(A([])));w&&w!==t&&r.call(w,i)&&(f=w);var m=d.prototype=l.prototype=Object.create(f);function g(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function n(i,a,o,s){var c=u(e[i],e,a);if("throw"!==c.type){var h=c.arg,l=h.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(l).then((function(e){h.value=e,o(h)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function x(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,h;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:P}}function P(){return{value:void 0,done:!0}}return p.prototype=d,s(m,"constructor",d),s(d,"constructor",p),p.displayName=s(d,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,o,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},g(y.prototype),s(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(t,r,n,i,a){void 0===a&&(a=Promise);var o=new y(c(t,r,n,i),a);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},g(m),s(m,o,"Generator"),s(m,i,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),b(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;b(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:A(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}var L,O,I,N,V,F=function(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o},U=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},M=function(e,t){return function(r,n){t(r,n,e)}},j=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(t){a(t)}}function s(e){try{c(n.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))},B=function(e){function t(t,r,n,i,a){var o;return(o=e.call(this,r,r.spreadsheet,R)||this).instantiationService=t,o.app=r,o.dataCallView=n,o.mutexManagement=i,o.spreadsheetView=a,o.plugins={},o}(0,n.Z)(t,e);var i=t.prototype;return i.initCanvas=function(){var e=this;if(this.canvas)throw new Error("视图已经初始化");this.canvas=this._register(new A(this.instantiationService,this.app,this.app.spreadsheet,this.spreadsheetView,this.mutexManagement,this.dataCallView)),this.initI18n(),this.canvas.initLevel1(),this.canvas.normalSelectData.onModifySelectData((function(){return e.onSelectionChangeEmitter.fire()})),this.canvas.normalSelectionStage.onSelectionStageVisiableChange((function(){return e.onSelectionChangeEmitter.fire()})),this.canvas.renderApi.renderTable(),this.app.event.init.trigger(v.W1.AFTER_FIRST_RENDER),P.Z.start("fps_init"),this.app.emitter.once(this.app.EVENT.SPREAD_SHEET_PLUGINS_END,(function(){return j(e,void 0,void 0,D().mark((function e(){var t,n,i,a=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.startLazy();case 2:return e.next=4,this.canvas.initLevel2();case 4:this.canvas.renderApi.renderNextTick(),this._afterCanvasLoaded(),this.app.event.init.trigger(v.W1.AFTER_ALL_RENDER),this.app.emitter.on(this.app.EVENT.SPREAD_SHEET_PLUGINS_END,(function(){a.app.event.init.trigger(v.W1.AFTER_ALL_RENDER)})),null===(i=null===(n=null===(t=null===r.g||void 0===r.g?void 0:r.g.document)||void 0===t?void 0:t.body)||void 0===n?void 0:n.classList)||void 0===i||i.add("all-ready"),P.Z.end("fps_init");case 10:case"end":return e.stop()}}),e,this)})))}))},i.onRefreshExcelView=function(t,r){void 0===r&&(r=T.oz.SLIENT),r!==T.oz.API&&e.prototype.setSheetScroll.call(this,t),e.prototype.setSelection.call(this,t)},i.getCustomFormatPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("customFormatPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getDataValidationPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("dataValidationPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getRangeSelectionPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("rangeSelectionPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getValidationErrorPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("validationErrorPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getSortRangePanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("sortRangePanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getFilterPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("filterPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getPivotTableFilterPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("pivotTableFilterPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getFormulaEditorPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("formulaEditorPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getSidePanelMain=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("sidePanelMain",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getRangeAuthPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("rangeAuthPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getErrorTipPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("errorTipPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getListPopoverCenter=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("listPopoverCenter",{app:this.app}));case 1:case"end":return e.stop()}}),e,this)})))},i.getDateReminderPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("dateReminderPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getPivotTableCreatePanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("pivotTableCreatePanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getPivotTableRowColFieldSettingPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("pivotTableRowColFieldSettingPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i.getPivotTableValueFieldSettingPanel=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPluginInstance("pivotTableValueFieldSettingPanel",this.app));case 1:case"end":return e.stop()}}),e,this)})))},i._afterCanvasLoaded=function(){e.prototype._afterCanvasLoaded.call(this)},i.initPlugins=function(){return j(this,void 0,void 0,D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.getSidePanelMain(),this.getRangeSelectionPanel(),this.getValidationErrorPanel()]);case 2:case"end":return e.stop()}}),e,this)})))},t}(a.ZP),G=B=F([M(0,u.TG),M(1,i.m),M(2,_.Z),M(3,k.Z),M(4,S.Z),U("design:paramtypes",["function"===typeof(L="undefined"!==typeof u.TG&&u.TG)?L:Object,"function"===typeof(O="undefined"!==typeof i.m&&i.m)?O:Object,"function"===typeof(I="undefined"!==typeof _.Z&&_.Z)?I:Object,"function"===typeof(N="undefined"!==typeof k.Z&&k.Z)?N:Object,"function"===typeof(V="undefined"!==typeof S.Z&&S.Z)?V:Object])],B)}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/4969.5bf16a7d2d7d64575cba.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=4969.5bf16a7d2d7d64575cba.js.map