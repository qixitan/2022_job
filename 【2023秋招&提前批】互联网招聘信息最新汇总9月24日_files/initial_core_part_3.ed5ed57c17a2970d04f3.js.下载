self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[6979],{39677:function(e,t,o){o.d(t,{Iq:function(){return c},OD:function(){return i},gn:function(){return l}});var i,n=o(85952),r=o(13504),a=(o(67196),o(62883),o(76138)),s=o(24352);!function(e){e[e.NONE=0]="NONE",e[e.TOP=1]="TOP",e[e.RIGHT=2]="RIGHT",e[e.BOTTOM=4]="BOTTOM",e[e.LEFT=8]="LEFT",e[e.Y=5]="Y",e[e.X=10]="X",e[e.ALL=15]="ALL"}(i||(i={}));var l=10,c=20,h=function(e){function t(t){var o;return(o=e.call(this)||this).spreadsheetView=t,o.currDirection=i.NONE,o._running=!1,o.diff={x:0,y:0},o.virtualTouch={clientX:0,clientY:0,identifier:Date.now(),target:document},o._handleMousemove=function(e){o._calc()?(o.cacheClientX=e.clientX,o.cacheClientY=e.clientY,o._scroll({diffX:o.diff.x,diffY:o.diff.y}),o._startDispatchEvent(o._dispatchMousemove)):o.timer&&clearInterval(o.timer)},o._handleTouchmove=function(e){o._calc()?(o.cacheClientX=e.touches[0].clientX,o.cacheClientY=e.touches[0].clientY,o._scroll({diffX:o.diff.x,diffY:o.diff.y}),o._startDispatchEvent(o._dispatchTouchmove)):o.timer&&clearInterval(o.timer)},o._handleUp=function(){document.removeEventListener("mousemove",o._handleMousemove),document.removeEventListener("mouseup",o._handleUp),document.removeEventListener("touchmove",o._handleTouchmove),document.removeEventListener("touchend",o._handleUp),clearTimeout(o.timer),o.currDirection=i.NONE,o.startFocusColArea=null,o.startFocusRowArea=null,o.currFocusColArea=null,o.currFocusRowArea=null,o.diff.x=0,o.diff.y=0,o.maxWidth=0,o.maxHeight=0,o._running=!1},o._startDispatchEvent=function(e){clearTimeout(o.timer),o.timer=setTimeout(e,60)},o._dispatchMousemove=function(){try{var e=new MouseEvent("mousemove",{clientX:o.cacheClientX,clientY:o.cacheClientY});document.dispatchEvent(e)}catch(t){return}o._startDispatchEvent(o._dispatchMousemove)},o._dispatchTouchmove=function(){o.virtualTouch.clientX=o.cacheClientX,o.virtualTouch.clientY=o.cacheClientY;var e=new TouchEvent("touchmove",{touches:[new Touch(o.virtualTouch)]});document.dispatchEvent(e),o._startDispatchEvent(o._dispatchTouchmove)},o}(0,r.Z)(t,e);var o=t.prototype;return o.ready=function(e,t,o){this.currDirection=e;var i=this._getCurrFocusRowArea(),n=this._getCurrFocusColArea();this.currFocusRowArea=i,this.startFocusRowArea=i,this.currFocusColArea=n,this.startFocusColArea=n,document.addEventListener("mousemove",this._handleMousemove,!0),document.addEventListener("mouseup",this._handleUp,!0),document.addEventListener("touchmove",this._handleTouchmove,!0),document.addEventListener("touchend",this._handleUp,!0),this.maxWidth=t||window.innerWidth,this.maxHeight=o||window.innerHeight,this._running=!0},o.dispose=function(){e.prototype.dispose.call(this),this._running&&(document.removeEventListener("mousemove",this._handleMousemove,!0),document.removeEventListener("mouseup",this._handleUp,!0),document.removeEventListener("touchmove",this._handleTouchmove,!0),document.removeEventListener("touchend",this._handleUp,!0))},o._getCurrFocusRowArea=function(){var e=this.spreadsheetView.operateContext.operateData;return e.currRow>=0&&e.currRow<Number.MAX_SAFE_INTEGER?e.currRow<=this.spreadsheetView.areaData.row.frozen.to?this.spreadsheetView.areaData.row.frozen:this.spreadsheetView.areaData.row.flow:null},o._getCurrFocusColArea=function(){var e=this.spreadsheetView.operateContext.operateData;return e.currCol>=0&&e.currCol<Number.MAX_SAFE_INTEGER?e.currCol<=this.spreadsheetView.areaData.col.frozen.to?this.spreadsheetView.areaData.col.frozen:this.spreadsheetView.areaData.col.flow:null},o._calc=function(){var e=this._calcX(),t=this._calcY();return!!(Number(e)|Number(t))},o._calcX=function(){var e=!1,t=this.spreadsheetView.operateContext.operateData;return this.currDirection&i.RIGHT&&(t.currCol===Number.MAX_SAFE_INTEGER||this.maxWidth>0&&t.displayCurrX>this.maxWidth)?e=this._calcRight():this.currDirection&i.LEFT&&(e=this._calcLeft()),e},o._calcY=function(){var e=!1,t=this.spreadsheetView.operateContext.operateData;return this.currDirection&i.BOTTOM&&(t.currRow===Number.MAX_SAFE_INTEGER||this.maxHeight>0&&t.displayCurrY>this.maxHeight)?e=this._calcBottom():this.currDirection&i.TOP&&(e=this._calcTop()),e},o._calcRight=function(){return this.diff.x=s.DEFAULT_COL_WIDTH>>1,!0},o._calcLeft=function(){var e=this.spreadsheetView.operateContext.operateData;if(this.startFocusColArea===this.spreadsheetView.areaData.col.flow){if(e.currCol<this.spreadsheetView.areaData.col.flow.from)return this.diff.x=-(s.DEFAULT_COL_WIDTH>>1),!0}else if(this.startFocusColArea===this.spreadsheetView.areaData.col.frozen){var t=this._getCurrFocusColArea();if(null!==this.currFocusColArea&&null!==t&&this.currFocusColArea!==t)return this.diff.x=-this.spreadsheetView.areaData.col.flow.offsetSize,this.currFocusColArea=t,!0}return!1},o._calcBottom=function(){return this.diff.y=s.DEFAULT_ROW_HEIGHT,!0},o._calcTop=function(){var e=this.spreadsheetView.operateContext.operateData;if(this.startFocusRowArea===this.spreadsheetView.areaData.row.flow){if(e.currRow<this.spreadsheetView.areaData.row.flow.from)return this.diff.y=-s.DEFAULT_ROW_HEIGHT,!0}else if(this.startFocusRowArea===this.spreadsheetView.areaData.row.frozen){var t=this._getCurrFocusRowArea();if(null!==this.currFocusRowArea&&null!==t&&this.currFocusRowArea!==t)return this.diff.y=-this.spreadsheetView.areaData.row.flow.offsetSize,this.currFocusRowArea=t,!0}return!1},o._scroll=function(e){var t=this.spreadsheetView.areaData;t.col.flow.setOffsetSize(t.col.flow.offsetSize+e.diffX),t.row.flow.setOffsetSize(t.row.flow.offsetSize+e.diffY)},(0,n.Z)(t,[{key:"running",get:function(){return this._running}}]),t}(a.JT);t.ZP=h},98486:function(e,t,o){o.d(t,{Z:function(){return d}});var i=o(13504),n=o(74140),r=o(44251),a=new Image;a.src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbC1ydWxlPSJldmVub2RkIj48cmVjdCBmaWxsPSIjMDZhMzU3IiB4PSIuNSIgeT0iLjUiIHdpZHRoPSIxNSIgaGVpZ2h0PSIxNSIgcng9IjIiIHN0cm9rZT0iIzA2YTM1NyIvPjxwYXRoIGQ9Ik02LjY0IDkuNkwxMS45IDQgMTMgNS4xNjggNi41NyAxMiAzIDguMjA0bDEuMTctMS4yNDJ6IiBmaWxsPSIjZmZmIi8+PC9zdmc+";var s=new Image;s.src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+PHJlY3QgeD0iLjUiIHk9Ii41IiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiIHJ4PSIyIiBmaWxsPSIjZmZmIiBzdHJva2U9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLW9wYWNpdHk9Ii4xNiIvPjwvc3ZnPg==";var l=o(536),c=o(24245),h=o(11989),d=function(e){function t(t){var o;return(o=e.call(this,t)||this).renderAfterCell=function(e){var t=e.x,i=e.y,l=e.row,d=e.col,u=o.tableView.getCellViewAtPosition(l,d)||h.O;if(o.shouldCollect(l,d,u)){var f=u.content,p=(0,c.o)(o.rowcolAccessor,u,d)-1,v=(0,c.E)(o.rowcolAccessor,u,l)-1,w=o._alloyExcel.collectEngine.bitmapCollector,m=n.K,g=m,_=(0,r.F1)({cellWidth:p,cellHeight:v,dWidth:m,dHeight:g,horizontalAlign:u.style.horizontalAlign,verticalAlign:u.style.verticalAlign,marginX:n.Kw,marginY:n.Kw}),y=_.dx,S=_.dy;w.collect({dx:t+y,dy:i+S,dWidth:m,dHeight:g,img:f===n.Nf?a:s,clipInfo:[t,i,p,v]})}},o.spreadsheet=t.spreadsheet,o.tableView=t.tableView,o.rowcolAccessor=t.rowcolAccessor,o._alloyExcel.onAfterCellRender(o.renderAfterCell),o}return(0,i.Z)(t,e),t.prototype.shouldCollect=function(e,t,o){var i,r=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t);if((null===(i=null===r||void 0===r?void 0:r.getMetadata())||void 0===i?void 0:i.customDataType)!==n.ZP.CHECKBOX)return!1;if(this.tableView.getIsCellPrivate(e,t))return!1;if(this.tableView.getIsCellCanNotRead(e,t))return!1;var a=o.content;return a===n.$$||a===n.Nf},t}(l.Z)},58314:function(e,t,o){o.d(t,{Z:function(){return v}});var i=o(13504),n=o(78817),r=o.n(n),a=o(74140),s=o(44251),l=o(93463),c=o(23972),h=o(536),d=o(24245),u=o(11989),f=o(80067),p=new Image;p.src=c;var v=function(e){function t(t){var o;return(o=e.call(this,t)||this).dwtRecordCellImage="test"===(0,f.IZ)("mode"),o.renderAfterCell=function(e){var t=e.x,i=e.y,n=e.row,a=e.col,c=o.tableView.getCellViewAtPosition(n,a)||u.O,h=o.tableView.getCellImage(n,a);if(o.shouldCollect(n,a,h)){var f=(0,d.o)(o.rowcolAccessor,c,a),v=(0,d.E)(o.rowcolAccessor,c,n),w=h.url,m=l.ZP.getCachedImage(w);if(!m){if(!l.ZP.hasPicFailed(w)){var g=(0,l.yc)(h,f,v);return void l.ZP.preLoadImageToAppCache(h.url,g).then((function(e){e&&o.tryRerender()})).catch((function(e){console.error(e),o.tryRerender()}))}m=p}var _=(0,s.xl)({image:h,cellWidth:f-1,cellHeight:v-1,horizontalAlign:c.style.horizontalAlign,verticalAlign:c.style.verticalAlign,imageElement:m}),y={dx:t+_.dx,dy:i+_.dy,dWidth:_.dWidth,dHeight:_.dHeight,img:m,sx:_.sx,sy:_.sy,sWidth:_.sWidth,sHeight:_.sHeight};o._alloyExcel.collectEngine.bitmapCollector.collect(y),o.dwtRecordCellImage&&r()(window,["cellImageConfigs",n,a],y)}},o.spreadsheet=t.spreadsheet,o.tableView=t.tableView,o.rowcolAccessor=t.rowcolAccessor,o._alloyExcel.onAfterCellRender(o.renderAfterCell),o}(0,i.Z)(t,e);var o=t.prototype;return o.shouldCollect=function(e,t,o){var i,n=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t);return(null===(i=null===n||void 0===n?void 0:n.getMetadata())||void 0===i?void 0:i.customDataType)===a.ZP.IMAGE&&!this.tableView.getIsCellPrivate(e,t)&&!this.tableView.getIsCellCanNotRead(e,t)&&(null===o||void 0===o?void 0:o.url)},o.tryRerender=function(){this.spreadsheet.parent.view.canvas.renderApi.renderNextTick()},t}(h.Z)},68679:function(e,t,o){o.d(t,{Z:function(){return d}});var i=o(13504),n=o(74140),r=o(56584),a=o(44251),s=o(536),l=o(24245),c=o(11989),h=o(90980),d=function(e){function t(t){var o;return(o=e.call(this,t)||this).renderAfterCell=function(e){var t,i,s=e.x,d=e.y,u=e.row,f=e.col,p=o.tableView.getCellViewAtPosition(u,f)||c.O;if(o.shouldCollect(u,f,p)){var v=p.content,w=(0,l.o)(o.rowcolAccessor,p,f),m=(0,l.E)(o.rowcolAccessor,p,u),g=(0,h.checkAndGetPercentage)(v),_=w-1,y=m-1,S=[s,d,_-p.paddingRight,y],b=null!==(t=p.paddingLeft)&&void 0!==t?t:r.J9.left,E=_-b-(null!==(i=p.paddingRight)&&void 0!==i?i:r.J9.right),x=n.$O,D=Math.max(E*g/100,2*x),L=s+b,A=(0,a.F1)({cellWidth:_,cellHeight:y,dWidth:D,dHeight:n.E8,horizontalAlign:p.style.horizontalAlign,verticalAlign:p.style.verticalAlign,marginX:b,marginY:2}).dy,C=o._alloyExcel.collectEngine;C.roundRectCollector.collect({roundRectInfo:{rect:[L,d+A,D,n.E8],radius:x,clipInfo:S},roundRectProp:{fillColor:"#00c29c"}}),C.graphicsCollector.collect({color:p.style.background.hex,graphicsInfo:{path:[s,d,s+_,d,s+_,d+y,s,d+y]}})}},o.spreadsheet=t.spreadsheet,o.tableView=t.tableView,o.rowcolAccessor=t.rowcolAccessor,o._alloyExcel.onAfterCellRender(o.renderAfterCell),o}return(0,i.Z)(t,e),t.prototype.shouldCollect=function(e,t,o){var i,r,a=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t);if((null===(i=null===a||void 0===a?void 0:a.getMetadata())||void 0===i?void 0:i.customDataType)!==n.ZP.PROGRESS)return!1;if(this.tableView.getIsCellPrivate(e,t))return!1;if(this.tableView.getIsCellCanNotRead(e,t))return!1;var s=o.content;return!(!(0,h.checkAndGetPercentage)(s)||null!==(r=null===a||void 0===a?void 0:a.getIsDataValid())&&void 0!==r&&!r)},t}(s.Z)},72190:function(e,t,o){o.d(t,{Z:function(){return u}});var i=o(13504),n=(o(38934),o(31688),o(66929)),r=o(54253),a=o(1976),s=o(74140),l=o(536),c=o(24245),h=o(11989),d=o(81617),u=function(e){function t(t){var o;return(o=e.call(this,t)||this).renderAfterCell=function(e){var t=e.x,i=e.y,s=e.row,l=e.col,u=o.tableView.getCellViewAtPosition(s,l)||h.O;if(o.shouldCollect(s,l)){var f=(0,c.o)(o.rowcolAccessor,u,l),p=(0,c.E)(o.rowcolAccessor,u,s),v=o._alloyExcel.collectEngine,w=o.tableView.getIsCellPrivate(s,l),m=o.tableView.getIsCellCanNotRead(s,l),g=o.paragraphAccessor.getParagraph(s,l),_=(0,d.r)(u,g,o.rowcolAccessor,s,l,w,m,o.spreadsheet);if(_&&_.length){var y=[t,i,f-u.paddingRight,p];_.forEach((function(e){var s=e.offsetX,l=e.offsetY,c=0;e.segments.forEach((function(e){var h,d,u=e.size,w=e.text,m=e.bgColor,g=e.textProp,_=u.width,S=u.height,b=c+t+s,E=i+l,x=n.Gy.MARGIN,D=n.Gy.PADDING_X,L=n.Gy.RADIUS,A=E-.75*S+x,C={fillColor:a.Z.getColorHexCode(m,o.spreadsheet)||""};if("#ffffff"===a.Z.getColorHexCode(m,o.spreadsheet)&&(C.borderWidth=1,C.strokeColor="rgba(0,0,0,0.08)"),g[r.M.STRIKETHROUGH]){var I=Math.round(S/4);h=[b+1+D,E-I,b+_-1-D,E-I]}g[r.M.UNDERLINE]&&(d=[b+1+D,E+2,b+_-1-D,E+2]),v.roundRectCollector.collect({roundRectInfo:{rect:[b+x,A,_-2*x,S-2*x],radius:L,clipInfo:y||[t,i,f,p]},roundRectProp:C}),v.textCollector.collect({textInfo:{pos:[b+x+D,A+.75*(S-2*x)],text:w,clipInfo:y||void 0,strikethroughInfo:h,underlineInfo:d},textPropHash:g.hash}),c+=_}))}))}}},o.spreadsheet=t.spreadsheet,o.tableView=t.tableView,o.rowcolAccessor=t.rowcolAccessor,o.paragraphAccessor=t.paragraphAccessor,o._alloyExcel.onAfterCellRender(o.renderAfterCell),o}return(0,i.Z)(t,e),t.prototype.shouldCollect=function(e,t){var o,i=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t),n=null===i||void 0===i?void 0:i.getMetadata();return(null===n||void 0===n?void 0:n.customDataType)===s.ZP.SELECT&&!this.tableView.getIsCellPrivate(e,t)&&!this.tableView.getIsCellCanNotRead(e,t)&&(null===(o=null===n||void 0===n?void 0:n.config)||void 0===o?void 0:o.withColor)},t}(l.Z)},56303:function(e,t,o){o.d(t,{Z:function(){return p}});var i=o(13504),n=(o(38934),o(52865),o(1432)),r=o(5522),a=o(74140),s=o(44251),l=o(90980),c=o(536),h=o(24245),d=o(11989),u=new Image;u.src=r;var f=new Image;f.src=n;var p=function(e){function t(t){var o;return(o=e.call(this,t)||this).renderAfterCell=function(e){var t=e.x,i=e.y,n=e.row,r=e.col,l=o.tableView.getCellViewAtPosition(n,r)||d.O;if(o.shouldCollect(n,r,l)){var c=l.content,p=(0,h.o)(o.rowcolAccessor,l,r)-1,v=(0,h.E)(o.rowcolAccessor,l,n)-1,w=a.gb+2*a.$S,m=w*c.length,g=w,_=(0,s.F1)({cellWidth:p,cellHeight:v,dWidth:m,dHeight:g,horizontalAlign:l.style.horizontalAlign,verticalAlign:l.style.verticalAlign,marginX:a.L6,marginY:a.L6}),y=_.dx,S=_.dy,b=[t,i,p,v],E=o._alloyExcel.collectEngine.bitmapCollector;Array.prototype.forEach.call(c,(function(e,o){E.collect({dx:t+y+a.$S*(2*o+1)+a.gb*o,dy:i+S+a.$S,dWidth:a.gb,dHeight:a.gb,img:e===a.KH?u:f,clipInfo:b})}))}},o.spreadsheet=t.spreadsheet,o.tableView=t.tableView,o.rowcolAccessor=t.rowcolAccessor,o._alloyExcel.onAfterCellRender(o.renderAfterCell),o}return(0,i.Z)(t,e),t.prototype.shouldCollect=function(e,t,o){var i,n=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t);return(null===(i=null===n||void 0===n?void 0:n.getMetadata())||void 0===i?void 0:i.customDataType)===a.ZP.STAR&&!this.tableView.getIsCellPrivate(e,t)&&!this.tableView.getIsCellCanNotRead(e,t)&&l.starStrReg.test(o.content)},t}(c.Z)},1897:function(e,t,o){o.d(t,{Z:function(){return n}}),o(46396);var i=o(93463),n=function(e){this.clearCache=function(){i.ZP.clearCache()},Object.assign(this,e),e.event.sheetsBar.listen("switchSheet",this.clearCache)}},80103:function(e,t,o){var i=o(14831),n=o.n(i),r=o(56584);t.Z=function(e){if(this.spreadsheetView=e,this.default=r.QX,!n().isPC&&!n().isIPad){var t=r.U2;(this.spreadsheetView.areaData.row.frozen.isValid()||this.spreadsheetView.areaData.col.frozen.isValid())&&(t=r.ai),this.default=t,this.spreadsheetView.scale.scaleTo(t)}}},65946:function(e,t,o){o.d(t,{Z:function(){return f}});var i,n,r,a,s,l=o(38661),c=o(13504),h=(o(38934),o(48845),o(19553),o(71091),o(98779),o(36465),o(81144),o(51057)),d=o(76138),u=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)};!function(e){e.dragEnter="dragEnter",e.dragLeave="dragLeave",e.dragOver="dragOver",e.drop="drop"}(s||(s={}));var f=function(e){function t(t){var o;return o=e.call(this)||this,i.set((0,l.Z)(o),new h.Q({name:s.dragEnter})),n.set((0,l.Z)(o),new h.Q({name:s.dragLeave})),r.set((0,l.Z)(o),new h.Q({name:s.dragOver})),a.set((0,l.Z)(o),new h.Q({name:s.drop})),o.onDragEnter=u((0,l.Z)(o),i).event,o.onDragLeave=u((0,l.Z)(o),n).event,o.onDragOver=u((0,l.Z)(o),r).event,o.onDrop=u((0,l.Z)(o),a).event,o.handleDragEnter=function(e){o.node.contains(e.target)&&(e.preventDefault(),u((0,l.Z)(o),i).fire(e))},o.handleDragLeave=function(e){o.node.contains(e.target)&&(e.preventDefault(),u((0,l.Z)(o),n).fire(e))},o.handleDragOver=function(e){o.node.contains(e.target)&&(e.preventDefault(),u((0,l.Z)(o),r).fire(e))},o.handleDrop=function(e){o.node.contains(e.target)&&(e.preventDefault(),u((0,l.Z)(o),a).fire(e))},o.node=t,document.addEventListener("dragenter",o.handleDragEnter),document.addEventListener("dragleave",o.handleDragLeave),document.addEventListener("dragover",o.handleDragOver),document.addEventListener("drop",o.handleDrop),o}return(0,c.Z)(t,e),t}(d.JT);i=new WeakMap,n=new WeakMap,r=new WeakMap,a=new WeakMap},81293:function(e,t,o){var i=o(85952),n=o(13504),r=(o(71096),o(78817)),a=o.n(r),s=o(62356),l=o.n(s),c=o(13059),h=function(e){function t(t,o){var i,n;return(n=e.call(this,{dataCallView:t,spreadsheet:o})||this).dataCallView=t,n.currentSheetId=o.activeSheetId,n._rowData[n.currentSheetId]=((i={}).error_tip_data=[],i),n}(0,n.Z)(t,e);var o=t.prototype;return o.refresh=function(e){var t,o;this._rowData[this.currentSheetId]=((t={}).error_tip_data=[],t),this.currentSheetId=e,this._rowData[this.currentSheetId]=((o={}).error_tip_data=[],o)},o.getErrorTipFlags=function(e,t){var o;return(null===(o=this.data[e])||void 0===o?void 0:o[t])||0},o.setErrorTipFlags=function(e,t,o){o?a()(this.data,[e,t],o):this.deleteErrorTipFlags(e,t)},o.deleteErrorTipFlags=function(e,t){l()(this.data,[e,t]),this.data[e]&&0===Object.keys(this.data[e]).length&&delete this.data[e]},(0,i.Z)(t,[{key:"data",get:function(){return this._rowData[this.currentSheetId].error_tip_data}}]),t}(c.Z);t.Z=h},80737:function(e,t,o){var i,n=o(85952),r=o(13504),a=o(28280),s=o(80578),l=o(597);!function(e){e.updateCurrentIndex="updateCurrentIndex"}(i||(i={}));var c=function(e){function t(t,o){var n;return(n=e.call(this,t,o)||this).onUpdateCurrentIndexEmitter=new a.Q5({name:i.updateCurrentIndex}),n._currentSelectIndex=-1,n.onUpdateCurrentIndex=n.onUpdateCurrentIndexEmitter.event,n}(0,r.Z)(t,e);var o=t.prototype;return o.addSelection=function(t){null===t?(e.prototype.addSelection.call(this,null,null),this.currentSelectIndex+=1):(t.activation||(t.activation={row:t.yRange?t.yRange[0]:0,col:t.xRange?t.xRange[0]:0}),e.prototype.addSelection.call(this,t,t.activation),this.currentSelectIndex+=1),this.onAddSelectDataEmitter.fire(this.select)},o.updateSelection=function(t,o){var i=this._selectQueue[t];if(void 0===i)throw new Error("错误更新选区");if(!o.activation){if(!i.activation)throw new Error("未传入激活区域，并且无法复用之前的激活区域");if(o.activation={row:i.activation.row,col:i.activation.col},o.xRange&&(o.activation.col<o.xRange[0]||o.activation.col>o.xRange[1]))throw new Error("未传入激活区域，并且无法复用之前的激活区域");if(o.yRange&&(o.activation.row<o.yRange[0]||o.activation.row>o.yRange[1]))throw new Error("未传入激活区域，并且无法复用之前的激活区域")}e.prototype.updateSelection.call(this,t,o,o.activation),this._currentSelectIndex=t,this.onUpdateSelectDataEmitter.fire({index:t,selection:this._selectQueue[t]})},o.removeSelection=function(t){e.prototype.removeSelection.call(this,t),this._currentSelectIndex=Math.min(this._currentSelectIndex,this._selectQueue.length-1),this.onRemoveSelectDataEmitter.fire(t)},o.resetSelection=function(){e.prototype.resetSelection.call(this),this._currentSelectIndex=-1,this.onResetSelectDataEmitter.fire()},(0,n.Z)(t,[{key:"currentSelectIndex",get:function(){return this._currentSelectIndex},set:function(e){if(e>this._selectQueue.length)throw new Error("设置的当前选区异常");this._currentSelectIndex=e,this.onUpdateCurrentIndexEmitter.fire(e)}},{key:"activeRow",get:function(){if(!this._selectQueue[this._currentSelectIndex])return-1;var e=this._selectQueue[this._currentSelectIndex].activation;return e?(0,l.Uz)(this.spreadsheetView.tableView,e.row,e.col).row:-1}},{key:"activeCol",get:function(){if(!this._selectQueue[this._currentSelectIndex])return-1;var e=this._selectQueue[this._currentSelectIndex].activation;return e?(0,l.Uz)(this.spreadsheetView.tableView,e.row,e.col).col:-1}},{key:"activation",get:function(){return this._selectQueue[this._currentSelectIndex].activation}},{key:"select",get:function(){return this._selectQueue[this._currentSelectIndex]||null}}]),t}(s.Z);t.Z=c},34293:function(e,t,o){o.d(t,{Z:function(){return w}});var i=o(85952),n=o(38661),r=o(13504),a=(o(38934),o(31688),o(84415)),s=o(77802),l=(o(41031),o(46396),o(52865),o(15770),o(75793),["#f7981d","#7e3794","#11a9cc","#a61d4c","#4285f4","#f4b400","#65b045","#795548","#999999","#f1ca3a","#3f5ca9","#c3d03f"]),c=function(){function e(e){this._element=document.createElement("div"),this._element.classList.add("formula-selection"),this.setAttribute(e)}e.newInstance=function(t,o){var i=e.pools.pop();return i?i.setAttribute(o):i=new e(o),t.appendChild(i._element),i},e.destroy=function(t){t._element.remove(),t._color="",e.pools.push(t)};var t=e.prototype;return t.setAttribute=function(e){var t=l[e.index%l.length];this._color=t;var o=e.display,i=void 0===o||o;(e.width<0||e.height<0)&&(i=!1),Object.assign(this._element.style,{left:e.left+"px",top:e.top+"px",width:e.width+"px",height:e.height+"px","border-color":t,"background-color":h(t,.2),display:i?"block":"none"})},t.active=function(){this._element.style.borderStyle="dashed"},t.unactive=function(){this._element.style.borderStyle="solid"},(0,i.Z)(e,[{key:"element",get:function(){return this._element}},{key:"color",get:function(){return this._color}}]),e}();function h(e,t){if(e&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){for(var o=[],i=1;i<7;i+=2)o.push(parseInt("0x"+e.slice(i,i+2),16));return"RGBA("+o.join(",")+", "+t+")"}return e}c.pools=[];var d=c,u=function(){function e(e){this._formulaSelections=[],this._board=e}var t=e.prototype;return t.clear=function(){for(var e;e=this._formulaSelections.pop();)d.destroy(e)},t.remove=function(e){var t=this._formulaSelections[e];void 0!==t?(this._formulaSelections.splice(e,1),d.destroy(t)):console.error("can't find formula selection by index: ",e)},t.add=function(e){e.index=this._formulaSelections.length,this._formulaSelections.push(d.newInstance(this._board,e))},t.update=function(e,t){t.index=e;var o=this._formulaSelections[e];void 0!==o?o.setAttribute(t):console.error("can't find multiple selection by index: ",e)},e}(),f=function(e){function t(t,o){var i;return(i=e.call(this)||this).spreadsheetView=t,i.blockBoard=o,i.board=document.createElement("div"),i.board.classList.add("selection-stage-board"),i.blockBoard.hiddenBoard.append(i.board),i._formulaSelectionApi=new u(i.board),i}(0,r.Z)(t,e);var o=t.prototype;return o.addSelection=function(e,t){var o={left:e.left-this.blockBoard.globalOffsetX,top:e.top-this.blockBoard.globalOffsetY,width:e.width,height:e.height,padding:e.padding,display:t};this._formulaSelectionApi.add(o)},o.updateSelection=function(e,t,o){var i={left:t.left-this.blockBoard.globalOffsetX,top:t.top-this.blockBoard.globalOffsetY,width:t.width,height:t.height,padding:t.padding,display:o};this._formulaSelectionApi.update(e,i)},o.removeSelection=function(e){this._formulaSelectionApi.remove(e)},o.resetSelection=function(){this._formulaSelectionApi.clear()},o.show=function(){this.board.style.display="block"},o.hide=function(){this.board.style.display="none"},o.dispose=function(){e.prototype.dispose.call(this),this.board.remove()},(0,i.Z)(t,[{key:"formulaSelectionApi",get:function(){return this._formulaSelectionApi}}]),t}(o(76138).JT),p=o(42630),v=o(47616),w=function(e){function t(t,o,i){var r;return(r=e.call(this,t)||this).formulaSelectData=t,r.spreadsheetView=o,r.mutexManagement=i,r._showing=!0,r.handleUpdateSelections=(0,a.ad)((function(){for(var e=0;e<r._selectData.selectQueue.length;e++){var t=r._selectData.selectQueue[e];r._updateSelection({index:e,selection:t})}})),r.topLeft=r._register(new f(o,r.spreadsheetView.mainBoard.top.left)),r.topRight=r._register(new f(o,r.spreadsheetView.mainBoard.top.right)),r.bottomLeft=r._register(new f(o,r.spreadsheetView.mainBoard.bottom.left)),r.bottomRight=r._register(new f(o,r.spreadsheetView.mainBoard.bottom.right)),r._register(r.spreadsheetView.areaData.row.frozen.onUpdateViewSize(r.handleUpdateSelections)),r._register(r.spreadsheetView.areaData.row.flow.onUpdateViewSize(r.handleUpdateSelections)),r._register(r.spreadsheetView.areaData.col.frozen.onUpdateViewSize(r.handleUpdateSelections)),r._register(r.spreadsheetView.areaData.col.flow.onUpdateViewSize(r.handleUpdateSelections)),r._register(r.spreadsheetView.areaData.row.frozen.onUpdateTotalSize(r.handleUpdateSelections)),r._register(r.spreadsheetView.areaData.row.flow.onUpdateTotalSize(r.handleUpdateSelections)),r._register(r.spreadsheetView.areaData.col.frozen.onUpdateTotalSize(r.handleUpdateSelections)),r._register(r.spreadsheetView.areaData.col.flow.onUpdateTotalSize(r.handleUpdateSelections)),r.mutexManagement.addMutexComponent(v.d.SELECTION,(0,n.Z)(r)),r}(0,r.Z)(t,e);var o=t.prototype;return o.refresh=function(){},o.show=function(){this._showing||this._show()},o.hide=function(){this._showing&&this._hide()},o.mutexHide=function(){this._showing&&this._hide()},o._show=function(){this._showing=!0,this.topLeft.show(),this.topRight.show(),this.bottomLeft.show(),this.bottomRight.show(),this.mutexManagement.mutexShow(v.d.FORMULA_SELECTION)},o._hide=function(){this._showing=!1,this.topLeft.hide(),this.topRight.hide(),this.bottomLeft.hide(),this.bottomRight.hide()},o._addSelection=function(){var e=this,t=this.spreadsheetView.areaData;this.topLeft.resetSelection(),this.topRight.resetSelection(),this.bottomLeft.resetSelection(),this.bottomRight.resetSelection(),this._selectData.selectQueue.forEach((function(o){var i=(0,p.i)(e.spreadsheetView.tableView,t,o);e.topLeft.addSelection(i,i.startRow<=t.row.frozen.to&&i.startCol<=t.col.frozen.to),e.topRight.addSelection(i,i.startRow<=t.row.frozen.to&&i.endCol>=t.col.flow.from),e.bottomLeft.addSelection(i,i.endRow>=t.row.flow.from&&i.startCol<=t.col.frozen.to),e.bottomRight.addSelection(i,i.endRow>=t.row.flow.from&&i.endCol>=t.col.flow.from)}))},o._updateSelection=function(e){var t=e.index,o=e.selection,i=this.spreadsheetView.areaData,n=(0,p.i)(this.spreadsheetView.tableView,i,o);this.topLeft.updateSelection(t,n,n.startRow<=i.row.frozen.to&&n.startCol<=i.col.frozen.to),this.topRight.updateSelection(t,n,n.startRow<=i.row.frozen.to&&n.endCol>=i.col.flow.from),this.bottomLeft.updateSelection(t,n,n.endRow>=i.row.flow.from&&n.startCol<=i.col.frozen.to),this.bottomRight.updateSelection(t,n,n.endRow>=i.row.flow.from&&n.endCol>=i.col.flow.from)},o._removeSelection=function(e){this.topLeft.removeSelection(e),this.topRight.removeSelection(e),this.bottomLeft.removeSelection(e),this.bottomRight.removeSelection(e)},o._resetSelection=function(){this.topLeft.resetSelection(),this.topRight.resetSelection(),this.bottomLeft.resetSelection(),this.bottomRight.resetSelection()},(0,i.Z)(t,[{key:"showing",get:function(){return this._showing}}]),t}(s.Z)},80032:function(e,t,o){o.d(t,{N:function(){return f}}),o(53248),o(38934),o(63240),o(48845),o(52865),o(20670),o(13857),o(54371),o(95019),o(19553),o(71091),o(81144),o(31575),o(5570),o(64656),o(43125),o(27849),o(31688),o(84919),o(11425),o(15770);var i=o(13292),n=(0,o(76138).yh)("IModifyCellBroker"),r=o(83246);function a(){"use strict";a=function(){return e};var e={},t=Object.prototype,o=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(A){l=function(e,t,o){return e[t]=o}}function c(e,t,o,i){var n=t&&t.prototype instanceof u?t:u,r=Object.create(n.prototype),a=new x(i||[]);return r._invoke=function(e,t,o){var i="suspendedStart";return function(n,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw r;return{value:void 0,done:!0}}for(o.method=n,o.arg=r;;){var a=o.delegate;if(a){var s=S(a,o);if(s){if(s===d)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var l=h(e,t,o);if("normal"===l.type){if(i=o.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(i="completed",o.method="throw",o.arg=l.arg)}}}(e,o,a),r}function h(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(A){return{type:"throw",arg:A}}}e.wrap=c;var d={};function u(){}function f(){}function p(){}var v={};l(v,n,(function(){return this}));var w=Object.getPrototypeOf,m=w&&w(w(D([])));m&&m!==t&&o.call(m,n)&&(v=m);var g=p.prototype=u.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function i(n,r,a,s){var l=h(e[n],e,r);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var n;this._invoke=function(e,o){function r(){return new t((function(t,n){i(e,o,t,n)}))}return n=n?n.then(r,r):r()}}function S(e,t){var o=e.iterator[t.method];if(void 0===o){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=h(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function D(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function t(){for(;++i<e.length;)if(o.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:L}}function L(){return{value:void 0,done:!0}}return f.prototype=p,l(g,"constructor",p),l(p,"constructor",f),f.displayName=l(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},_(y.prototype),l(y.prototype,r,(function(){return this})),e.AsyncIterator=y,e.async=function(t,o,i,n,r){void 0===r&&(r=Promise);var a=new y(c(t,o,i,n),r);return e.isGeneratorFunction(o)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(g),l(g,s,"Generator"),l(g,n,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var i=t.pop();if(i in e)return o.value=i,o.done=!1,o}return o.done=!0,o}},e.values=D,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(o,i){return a.type="throw",a.arg=e,t.next=o,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),E(o),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var i=o.completion;if("throw"===i.type){var n=i.arg;E(o)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:D(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),d}},e}var s,l,c=function(e,t,o,i){var n,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,o,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(r<3?n(a):r>3?n(t,o,a):n(t,o))||a);return r>3&&a&&Object.defineProperty(t,o,a),a},h=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(o,i){t(o,i,e)}},u=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},f=function(){function e(e,t){this.spreadSheet=e,this.modifyCellBroker=t}var t=e.prototype;return t.tryToIdentifyCell=function(e){var t=e.sheetId,o=e.rowIndex,i=e.colIndex;return u(this,void 0,void 0,a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdentifiedCellValue({sheetId:t,rowIndex:o,colIndex:i});case 2:if(null!==(n=e.sent)){e.next=5;break}return e.abrupt("return");case 5:this.modifyCellBroker.setCellProperties({sheetId:t,rowIndex:o,colIndex:i,text:n,ignoreLinkUrl:!0});case 6:case"end":return e.stop()}}),e,this)})))},t.getIdentifiedCellValue=function(e){var t=e.sheetId,o=e.rowIndex,i=e.colIndex;return u(this,void 0,void 0,a().mark((function e(){var n,s,l,c,h,d,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=this.spreadSheet.sheetManager.getSheetBySheetId(t))){e.next=3;break}return e.abrupt("return",null);case 3:if(null!==(s=n.getCellDataAtPosition(o,i))){e.next=6;break}return e.abrupt("return",null);case 6:if(null!==(l=s.getEditValue())){e.next=9;break}return e.abrupt("return",null);case 9:if(null!==(c=(0,r.nx)((0,r.Kc)(l,!1)))){e.next=12;break}return e.abrupt("return",null);case 12:return e.prev=12,e.next=15,(0,r.sx)(c);case 15:if(h=e.sent,d=h.title,(u=s.getEditValue())===l){e.next=20;break}return e.abrupt("return",null);case 20:return e.abrupt("return",u.replace(c,d));case 23:return e.prev=23,e.t0=e.catch(12),e.abrupt("return",null);case 26:case"end":return e.stop()}}),e,this,[[12,23]])})))},e}();f=c([d(0,i.V),d(1,n),h("design:paramtypes",["function"===typeof(s="undefined"!==typeof i.V&&i.V)?s:Object,"function"===typeof(l="undefined"!==typeof n&&n)?l:Object])],f)},70474:function(e,t,o){o(38934),o(48845),o(13857),o(54371),o(95019),o(19553),o(71091),o(81144),o(31575),o(5570),o(64656),o(43125),o(27849),o(31688),o(84919),o(11425),o(15770);var i=o(89577),n=o(74413),r=o(31973),a=o(20445),s=o(9321);function l(){"use strict";l=function(){return e};var e={},t=Object.prototype,o=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(A){s=function(e,t,o){return e[t]=o}}function c(e,t,o,i){var n=t&&t.prototype instanceof u?t:u,r=Object.create(n.prototype),a=new x(i||[]);return r._invoke=function(e,t,o){var i="suspendedStart";return function(n,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw r;return{value:void 0,done:!0}}for(o.method=n,o.arg=r;;){var a=o.delegate;if(a){var s=S(a,o);if(s){if(s===d)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var l=h(e,t,o);if("normal"===l.type){if(i=o.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(i="completed",o.method="throw",o.arg=l.arg)}}}(e,o,a),r}function h(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(A){return{type:"throw",arg:A}}}e.wrap=c;var d={};function u(){}function f(){}function p(){}var v={};s(v,n,(function(){return this}));var w=Object.getPrototypeOf,m=w&&w(w(D([])));m&&m!==t&&o.call(m,n)&&(v=m);var g=p.prototype=u.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function i(n,r,a,s){var l=h(e[n],e,r);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var n;this._invoke=function(e,o){function r(){return new t((function(t,n){i(e,o,t,n)}))}return n=n?n.then(r,r):r()}}function S(e,t){var o=e.iterator[t.method];if(void 0===o){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=h(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function D(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function t(){for(;++i<e.length;)if(o.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:L}}function L(){return{value:void 0,done:!0}}return f.prototype=p,s(g,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},_(y.prototype),s(y.prototype,r,(function(){return this})),e.AsyncIterator=y,e.async=function(t,o,i,n,r){void 0===r&&(r=Promise);var a=new y(c(t,o,i,n),r);return e.isGeneratorFunction(o)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(g),s(g,a,"Generator"),s(g,n,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var i=t.pop();if(i in e)return o.value=i,o.done=!1,o}return o.done=!0,o}},e.values=D,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(o,i){return a.type="throw",a.arg=e,t.next=o,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),E(o),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var i=o.completion;if("throw"===i.type){var n=i.arg;E(o)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:D(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),d}},e}var c=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},h=function(){function e(e,t){this.spreadsheetApp=e,this.spreadsheet=t}var t=e.prototype;return t.clearFormat=function(){this.spreadsheetApp.requestApi.clearFormat()},t.clearContent=function(){var e,t;this.spreadsheetApp.requestApi.clearContent();var o=this.spreadsheetApp.view.getSelection().rangeSelections;null===(t=null===(e=this.spreadsheetApp.view.canvas)||void 0===e?void 0:e.weworkComponentCenter)||void 0===t||t.hidePanelWhenClearContent(o||[])},t.setCellProperties=function(e){var t;return c(this,void 0,void 0,l().mark((function o(){var i,n,s,c,h,d;return l().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i=e.colIndex,n=e.rowIndex,s=e.text,c=e.isTextChanged,h=void 0!==c&&c,this.checkDimensionsValid(n,i)){o.next=3;break}return o.abrupt("return");case 3:return d=this.spreadsheetApp,o.next=6,d.view.getValidationErrorPanel();case 6:if(!1!==o.sent.verify(n,i,s,h)){o.next=9;break}return o.abrupt("return");case 9:null===(t=this.spreadsheetApp.requestApi)||void 0===t||t.userEnter(e).catch((function(e){(null===e||void 0===e?void 0:e.stack)&&r.ZP.run(a.CONFIG.VIEW_ERROR_INPUT,[e.stack]),console.error("无效输入",e)}));case 10:case"end":return o.stop()}}),o,this)})))},t.setCellTextAutoWrap=function(e,t,o){if(this.checkDimensionsValid(e,t)){var r=this.spreadsheet.activeSheet,a=r.getCellDataAtPosition(e,t);(null===a||void 0===a?void 0:a.getUserEnteredFormat())&&a.getUserEnteredFormat().getWrapStrategy()===n.Z.OVERFLOW_CELL&&this.spreadsheetApp.requestApi.autoWrap(n.Z.WRAP,new i.Z(o||r.getSheetId(),e,e,t,t))}},t.checkDimensionsValid=function(e,t){return(0,s.MN)(e)&&(0,s.MN)(t)},e}();t.Z=h},78726:function(e,t,o){o.d(t,{Z:function(){return S}}),o(38934),o(77468),o(31688),o(62883),o(8195);var i=o(11376),n=o(36395),r=o(48943);function a(e,t,o,i){for(var n={},r=0;r<i.length;r++)for(var a=i[r],s=a[0];s<=a[1];s++)if(void 0===n[s]){for(var l=0,c=0;c<t.getRowCount();c++){var h=o.getParagraph(c,s);if(h){var d=e.getCellViewAtPosition(c,s);if(!(null===d||void 0===d?void 0:d.mergeData)&&!(null===d||void 0===d?void 0:d.mergeParent)){var u=d?d.paddingLeft+d.paddingRight:0;l=Math.max(l,h.width+u)}}}0!==l&&(n[s]=l)}return n}var s=o(31973),l=o(597),c=o(13504),h=(o(62077),o(66176)),d=o(94330),u=o(63313),f=o.n(u),p=o(52083),v=o(94358),w=-1,m=!1,g=function(e){function t(t){var o;return(o=e.call(this,t)||this).getInputValue=function(e){var t=0===e.trim().length&&e.length>0;isNaN(Number(e))||Number(e)>1e3||t?(m=!1,o.setState({inputValue:"",isError:!m})):(m=0!==e.length&&Number(e)>=o.props.params.min,w=Number(e)||107,o.setState({inputValue:e,isError:!m})),o.props.toggleDisabled(!m)},o.initKeyBoard=function(){new p.ZP({root:o.contentRef.current,bindings:[{key:p.rW.ENTER,handler:o.handleEnter}]})},o.handleEnter=function(){o.props.keyboardSubmit()},o.inputRef=f().createRef(),o.contentRef=f().createRef(),o.state={inputValue:"",isError:!1},o}(0,c.Z)(t,e);var o=t.prototype;return o.componentDidMount=function(){var e=this;this.initKeyBoard(),this.setState({inputValue:this.props.params.defaultValue},(function(){var t,o;null===(t=e.inputRef.current)||void 0===t||t.focus(),null===(o=e.inputRef.current)||void 0===o||o.select(),w=Number(e.props.params.defaultValue),m=!0}))},o.render=function(){return f().createElement("div",{ref:this.contentRef,style:{width:"100%",height:"100%"}},f().createElement("p",{style:{marginBottom:"10px"}},this.props.params.info),f().createElement(v.default.Item,{status:this.state.isError?"error":"default",message:this.props.params.errorInfo},f().createElement(d.default,{inputRef:this.inputRef,onFocus:this.onFocus.bind(this),value:this.state.inputValue,placeholder:this.props.params.defaultValue,onChange:this.getInputValue.bind(this),style:{width:"100%"}})))},o.onFocus=function(){isNaN(Number(this.state.inputValue))&&(m=!1,this.setState({inputValue:"",isError:!m}),this.props.toggleDisabled(!m))},t}(f().Component),_=function(e){var t=function(){return w<e.min||m&&(n(),e.callback(w-0)),!1},o=h.default.confirm({onOk:t,title:e.title,content:f().createElement(g,{params:e,keyboardSubmit:t,toggleDisabled:function(e){i({okDisabled:e})}}),closable:!0,draggable:!1,destroyOnClose:!0,okDisabled:!m&&!e.defaultValue}),i=o.update,n=o.close},y=o(24352),S=function(){function e(e,t,o,i){this.spreadsheetApp=e,this.spreadsheet=t,this.spreadsheetView=o,this.normalSelectData=i}var t=e.prototype;return t.insertRow=function(e){return this.spreadsheetApp.requestApi.insertRows(e)},t.insertCol=function(e){return this.spreadsheetApp.requestApi.insertColumns(e)},t.removeRow=function(){return this.spreadsheetApp.requestApi.deleteRows()},t.removeCol=function(){return this.spreadsheetApp.requestApi.deleteColumns()},t.setRowHeight=function(e,t){for(var o=[],i=0;i<e.length;i++){var a=e[i];o.push(new n.Z(this.spreadsheet.activeSheetId,a[0],a[1],r.Z.ROWS))}return this.spreadsheetApp.requestApi.resizeRows(o,t)},t.setColWidth=function(e,t){for(var o=[],i=0;i<e.length;i++){var a=e[i];o.push(new n.Z(this.spreadsheet.activeSheetId,a[0],a[1],r.Z.COLUMNS))}return this.spreadsheetApp.requestApi.resizeColumns(o,t)},t.setColWidths=function(e,t){for(var o=[],i=0;i<e.length;i++){var a=e[i];o.push(new n.Z(this.spreadsheet.activeSheetId,a[0],a[1],r.Z.COLUMNS))}return this.spreadsheetApp.requestApi.resizeColumns(o,t)},t.showDialogForRowsSetting=function(){var e,t=this,o=this.normalSelectData.selectQueue,n=i.ZP.t("设置行高"),r=i.ZP.t("行高 ( 默认值: {{DEFAULT_ROW_HEIGHT}}像素 )",{DEFAULT_ROW_HEIGHT:y.DEFAULT_ROW_HEIGHT});if(this.normalSelectData.isSingle()){var a=o[0],c=[0,0];if(a.selectAll||a.selectCol)c[0]=0,c[1]=this.spreadsheetView.rowcolAccessor.getRowCount()-1;else{if(!a.selectRow&&!a.selectCell)throw new Error("不可用的选区类型");c[0]=a.yRange[0],c[1]=a.yRange[1]}e=this.getDefaultRowSize(c),isNaN(e)&&(e="")}else e="";_({title:n,info:r,min:10,defaultValue:e.toString(),errorInfo:i.ZP.t("有效范围：{{min}}-1000",{min:10}),callback:function(e){var o=(0,l.TS)(t.spreadsheetView.rowcolAccessor,t.normalSelectData.selectQueue);t.setRowHeight(o,e),o.forEach((function(e){var t=e[0]===e[1]?"menu_1row_size":"menu_nrow_size";s.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:t})}))}})},t.showDialogForColsSetting=function(){var e,t=this,o=this.normalSelectData.selectQueue,n=i.ZP.t("设置列宽"),r=i.ZP.t("列宽 ( 默认值: {{DEFAULT_COL_WIDTH}}像素 )",{DEFAULT_COL_WIDTH:y.DEFAULT_COL_WIDTH});if(this.normalSelectData.isSingle()){var a=o[0],c=[0,0];if(a.selectAll||a.selectRow)c[0]=0,c[1]=this.spreadsheetView.rowcolAccessor.getColCount()-1;else{if(!a.selectCol&&!a.selectCell)throw new Error("不可用的选区类型");c[0]=a.xRange[0],c[1]=a.xRange[1]}e=this.getDefaultColSize(c),isNaN(e)&&(e="")}else e="";_({title:n,info:r,min:10,defaultValue:e.toString(),errorInfo:i.ZP.t("有效范围：{{min}}-1000",{min:10}),callback:function(e){var o=(0,l.rz)(t.spreadsheetView.rowcolAccessor,t.normalSelectData.selectQueue);t.setColWidth(o,e),o.forEach((function(e){var t=e[0]===e[1]?"menu_1col_size":"menu_ncol_size";s.ZP.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:t})}))}})},t.setRowHeightAutoFit=function(e){return this.setRowHeight(e,void 0)},t.setColWidthAutoFit=function(e){var t=a(this.spreadsheetView.tableView,this.spreadsheetView.rowcolAccessor,this.spreadsheetView.paragraphAccessor,e),o=[],i=[];for(var n in t)o.push([Number(n),Number(n)]),i.push(t[n]+1);return this.setColWidths(o,i)},t.setRowAndColAutoFit=function(e,t){for(var o=[],i=0;i<e.length;i++){var s=e[i];o.push({dimensionRange:new n.Z(this.spreadsheet.activeSheetId,s[0],s[1],r.Z.ROWS),size:void 0})}var l=a(this.spreadsheetView.tableView,this.spreadsheetView.rowcolAccessor,this.spreadsheetView.paragraphAccessor,t),c=[];for(var h in l)c.push({dimensionRange:new n.Z(this.spreadsheet.activeSheetId,Number(h),Number(h),r.Z.COLUMNS),size:l[h]});return this.spreadsheetApp.requestApi.resizeRowsColumns([].concat(o,c))},t.setColWidthToDefault=function(e){return this.setColWidth(e,y.DEFAULT_COL_WIDTH)},t.moveRows=function(e,t){var o=new n.Z(this.spreadsheet.activeSheetId,e[0],e[1],r.Z.ROWS);return this.spreadsheetApp.requestApi.moveRows(o,t)},t.moveCols=function(e,t){var o=new n.Z(this.spreadsheet.activeSheetId,e[0],e[1],r.Z.COLUMNS);return this.spreadsheetApp.requestApi.moveColumns(o,t)},t.hideRows=function(e){var t=this.transformOptionsToDiemsnionRanges(e,r.Z.ROWS);return this.spreadsheetApp.requestApi.hideRows(t)},t.hideCols=function(e){var t=this.transformOptionsToDiemsnionRanges(e,r.Z.COLUMNS);return this.spreadsheetApp.requestApi.hideColumns(t)},t.showRows=function(e){var t=this.transformOptionsToDiemsnionRanges(e,r.Z.ROWS);return this.spreadsheetApp.requestApi.showRows(t)},t.showCols=function(e){var t=this.transformOptionsToDiemsnionRanges(e,r.Z.COLUMNS);return this.spreadsheetApp.requestApi.showColumns(t)},t.getDefaultRowSize=function(e){for(var t=this.spreadsheetView.rowcolAccessor.getRowDisplayHeight(e[0]),o=e[0]+1;o<=e[1];o++)if(t!==this.spreadsheetView.rowcolAccessor.getRowDisplayHeight(o))return NaN;return t},t.getDefaultColSize=function(e){for(var t=this.spreadsheetView.rowcolAccessor.getColSetWidth(e[0]),o=e[0]+1;o<=e[1];o++)if(t!==this.spreadsheetView.rowcolAccessor.getColSetWidth(o))return NaN;return t},t.transformOptionsToDiemsnionRanges=function(e,t){for(var o=[],i=0;i<e.length;i++){var r=e[i];o.push(new n.Z(this.spreadsheet.activeSheetId,r.index,r.index+r.amount-1,t))}return o},e}()},84444:function(e,t){var o=function(){function e(e){this.spreadsheetApp=e}var t=e.prototype;return t.setHyperlinkIconVisibility=function(e){var t=e.row,o=e.col,i=e.visibility;this.spreadsheetApp.requestApi.setHyperlinkIconVisibility({row:t,col:o,visibility:i})},t.setHyperlinkRuns=function(e){var t=e.row,o=e.col,i=e.linkValue,n=e.range;this.spreadsheetApp.requestApi.setHyperlinkRuns({row:t,col:o,linkValue:i,range:n})},t.cancelLink=function(e,t){this.spreadsheetApp.requestApi.clearLink(e,t)},t.insertLink=function(e,t,o,i){this.spreadsheetApp.requestApi.setLink(i,o,e,t)},t.insertHyperLink=function(e,t,o,i,n,r){this.spreadsheetApp.requestApi.setHyperLink(i,o,n,e,t,r)},t.addLinkedRange=function(e){return this.spreadsheetApp.requestApi.addLinkedRange(e)},e}();t.Z=o},58727:function(e,t,o){var i=o(85952),n=o(38661),r=o(13504),a=(o(19553),o(30980),o(38934),o(71091),o(16640),o(37108),o(28255),o(50104),o(25111),o(39585),o(77575),o(76880),o(11502),o(96434),o(3377),o(71318),o(21530),o(81144),o(31688),o(71096),o(53923),o(52865),o(77468),o(11376)),s=o(56592),l=o.n(s),c=o(50858),h=o(76138),d=o(89307),u=o(78216),f=o(14831),p=o.n(f),v=o(31973),w=o(84701),m=function(e){function t(t){var o;return(o=e.call(this)||this).handleAuthError=function(e){w.default.show({type:"error",message:a.ZP.t(e+"没有此文档权限，不会收到提醒。"),autoClose:!0,duration:3e3,style:{zIndex:10004}})},o._normalSelectData=t.normalSelectData,o._waitingNotifyQueue=new Map,o._spreadSheet=t.spreadsheet,o._register(o._spreadSheet.onClearAllMention(o.clearMentionNotify.bind((0,n.Z)(o)))),o._register(o._spreadSheet.onNewAllMention(o.notifyNewMention.bind((0,n.Z)(o)))),o}(0,r.Z)(t,e);var s=t.prototype;return s.clearMentionNotify=function(e){var t=this,o=e.rowIndex,i=e.colIndex,n=e.callback,r=!1;this._waitingNotifyQueue.forEach((function(e,n){e.row===o&&e.col===i&&t.popMentionFromWaitingQueue(n)&&(r=!0)})),r&&this.showCancelNotifyToast(),null===n||void 0===n||n(r)},s.reduceMention=function(e){return Object.keys(e).reduce((function(t,o){return t[e[o].userId]=e[o],t}),{})},s.toKey=function(e,t,o){return e+"-"+t+"-"+o},s.notifyNewMention=function(e){for(var t,o=e.mentionDetails,i=e.colIndex,n=e.rowIndex,r=e.mentionText,a=o?this.reduceMention(o):{},s=0,l=Object.keys(a);s<l.length;s++)t=l[s],this.pushMentionToWaitingQueue(a[t],n,i,r)},s.hasMentionInWaitingQueue=function(e){return this._waitingNotifyQueue.has(e)},s.popMentionFromWaitingQueue=function(e){var t=this._waitingNotifyQueue.get(e);return!!t&&(this._waitingNotifyQueue.delete(e),clearTimeout(t.timeoutHandler),!0)},s.pushMentionToWaitingQueue=function(e,t,i,n){var r=this,s=e.sheetId,h=e.mentionId,u=e.userId,f=e.text,w=this.toKey(u,t,i);if(!this.hasMentionInWaitingQueue(w)){var m=(0,d.NA)(),g=(0,d.Ou)(),_=0;new RegExp(/^(w|e)2_/i).test(m)&&(_=2);var y={xRange:[i,i],yRange:[t,t],row:{frozen:0,flow:0},col:{frozen:0,flow:0},rowIndex:t,colIndex:i},S=s+"|"+(0,c.gl)(y)+"|"+h,b={method:"post",url:"/txdoc/mention_notify",params:{doc_id:m,to_vid:e.userId,title:encodeURIComponent(a.ZP.t("在 {{fileName}}) 中 @ 了你",{fileName:g})),content:encodeURIComponent(n),plat:_,mainid:encodeURIComponent(S),r:Math.random(),sheet_id:s}},E=setTimeout((function(){var e,t=p().isPC;e=t?"xls_atsucc_pc":"xls_atsucc_m",v.ZP.kvrOss({itemname:e,DocID:(0,d.NA)()}),r._waitingNotifyQueue.delete(w),o.g.log.log("enterprise mention_notify start",b.params.to_vid+g+" "+n),l()(b).then((function(e){var t,i,n,a,s,l,c=e.data;0!==(null===(t=null===c||void 0===c?void 0:c.head)||void 0===t?void 0:t.ret)?(o.g.log.log("mention_notify error",(null===c||void 0===c?void 0:c.body)?null===(i=null===c||void 0===c?void 0:c.body)||void 0===i?void 0:i.ret:null===(n=null===c||void 0===c?void 0:c.head)||void 0===n?void 0:n.ret),v.ZP.kvrOss({itemname:"xls_at_succ"})):(o.g.log.log("mention_notify success",b.params.to_vid),null===(s=null===(a=window.discussionExt)||void 0===a?void 0:a.taskComplete)||void 0===s||s.call(a,"AT")),!1===(null===(l=null===c||void 0===c?void 0:c.body)||void 0===l?void 0:l.has_auth)&&(r.handleAuthError(f),o.g.log.log("mention_notify fail, the user-mentioned has no auth",b.params.to_vid))})).catch((function(e){o.g.log.log("mention_notify network error",e)}))}),5e3);o.g.log.log("[modifyMentionNotifyBroker] pushMentionToWaitingQueue row: "+t+", col: "+i+", "+u),this._waitingNotifyQueue.set(w,{row:t,col:i,userId:u,timeoutHandler:E})}},s.showCancelNotifyToast=function(){(0,u.showToast)(a.ZP.t("已撤销本次 @，对方不会收到通知"),{},{toolToastCloseTime:2e3})},(0,i.Z)(t,[{key:"normalSelectData",get:function(){return this._normalSelectData}}]),t}(h.JT);t.Z=m},88957:function(e,t,o){var i=o(84415),n=function(){function e(e){var t=this;this.normalSelectData=e,this.cache=null,this.throttleSetSelection=(0,i.kf)((function(){null!==t.cache&&(t.normalSelectData.updateSelection(t.normalSelectData.currentSelectIndex,t.cache),t.cache=null)}),0)}return e.prototype.setSelection=function(e){this.cache=e,this.throttleSetSelection()},e}();t.Z=n},82924:function(e,t,o){o(46396);var i=o(96432),n=function(){function e(e,t){this.spreadsheetApp=e,this.spreadsheet=t}var t=e.prototype;return t.insertImage=function(e,t){void 0===t&&(t=!1),this.spreadsheetApp.requestApi.addImage(e,t)},t.updateShape=function(e,t){this.spreadsheetApp.requestApi.updateImage(Object.assign(t,{type:i.Z.IMAGE,id:e,sheetId:this.spreadsheet.activeSheetId}))},t.deleteShape=function(e){this.spreadsheetApp.requestApi.deleteImage({id:e,sheetId:this.spreadsheet.activeSheetId})},e}();t.Z=n},87190:function(e,t,o){function i(){"use strict";i=function(){return e};var e={},t=Object.prototype,o=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function l(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(A){l=function(e,t,o){return e[t]=o}}function c(e,t,o,i){var n=t&&t.prototype instanceof u?t:u,r=Object.create(n.prototype),a=new x(i||[]);return r._invoke=function(e,t,o){var i="suspendedStart";return function(n,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw r;return{value:void 0,done:!0}}for(o.method=n,o.arg=r;;){var a=o.delegate;if(a){var s=S(a,o);if(s){if(s===d)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var l=h(e,t,o);if("normal"===l.type){if(i=o.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(i="completed",o.method="throw",o.arg=l.arg)}}}(e,o,a),r}function h(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(A){return{type:"throw",arg:A}}}e.wrap=c;var d={};function u(){}function f(){}function p(){}var v={};l(v,r,(function(){return this}));var w=Object.getPrototypeOf,m=w&&w(w(D([])));m&&m!==t&&o.call(m,r)&&(v=m);var g=p.prototype=u.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function i(n,r,a,s){var l=h(e[n],e,r);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var n;this._invoke=function(e,o){function r(){return new t((function(t,n){i(e,o,t,n)}))}return n=n?n.then(r,r):r()}}function S(e,t){var o=e.iterator[t.method];if(void 0===o){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=h(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function D(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,n=function t(){for(;++i<e.length;)if(o.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:L}}function L(){return{value:void 0,done:!0}}return f.prototype=p,l(g,"constructor",p),l(p,"constructor",f),f.displayName=l(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},_(y.prototype),l(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(t,o,i,n,r){void 0===r&&(r=Promise);var a=new y(c(t,o,i,n),r);return e.isGeneratorFunction(o)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(g),l(g,s,"Generator"),l(g,r,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var i=t.pop();if(i in e)return o.value=i,o.done=!1,o}return o.done=!0,o}},e.values=D,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(o,i){return a.type="throw",a.arg=e,t.next=o,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),E(o),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var i=o.completion;if("throw"===i.type){var n=i.arg;E(o)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:D(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),d}},e}o(38934),o(48845),o(13857),o(54371),o(95019),o(19553),o(71091),o(81144),o(31575),o(5570),o(64656),o(43125),o(27849),o(31688),o(84919),o(11425),o(15770);var n=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},r=function(){function e(e){this.spreadsheetApp=e}return e.prototype.calc=function(e){return n(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.spreadsheetApp.editFeature.getSmartSelection();case 2:(0,t.sent)(this.spreadsheetApp,e);case 4:case"end":return t.stop()}}),t,this)})))},e}();t.Z=r},38868:function(e,t,o){var i,n=o(13504),r=o(84415),a=o(4175),s=o(76138),l=o(28280),c=o(96172),h=o(52083),d=o(13423);!function(e){e.startScale="startScale",e.endScale="endScale"}(i||(i={}));var u=function(e){function t(t,n,s){var u;return(u=e.call(this)||this).spreadsheetView=t,u.scrollApi=n,u.spreadSheetApp=s,u.onStartScaleEmitter=new l.Q5({name:i.startScale}),u.onEndScaleEmitter=new l.Q5({name:i.endScale}),u.isShortKey=!1,u.timer=0,u._oldScale=0,u._scaleTo=(0,r.kf)((function(e,t){if(void 0===t&&(t={x:0,y:0}),e!==u.spreadsheetView.scale.scale){var o=u.spreadsheetView.scale.scale,i=u.spreadsheetView.areaData.col.flow.offsetSize+t.x/o*u._oldScale,n=u.spreadsheetView.areaData.row.flow.offsetSize+t.y/o*u._oldScale;u.spreadsheetView.scale.scaleTo(e);var r=i-(u.spreadsheetView.areaData.col.flow.offsetSize+t.x/e*u._oldScale),a=n-(u.spreadsheetView.areaData.row.flow.offsetSize+t.y/e*u._oldScale);u.scrollApi.scrollByPixel({diffX:r,diffY:a,areaX:"flow",areaY:"flow"})}}),30),u._handleTouchstart=function(){u.spreadsheetView.operateContext.operateData.fingerData.mode===c.w.SCALE&&(u._oldScale=u.spreadsheetView.scale.scale,u.onStartScaleEmitter.fire(),document.body.addEventListener("touchmove",u._handleTouchmove),document.body.addEventListener("touchend",u._handleTouchend))},u._handleTouchmove=function(){var e=u.spreadsheetView.operateContext.operateData;if(e.fingerData.mode===c.w.SCALE){var t=e.fingerData.zoom*u.spreadsheetView.scale.scale;t=Math.min(2,Math.max(.5,t)),u._scaleTo(t,e.fingerData.center)}},u._handleTouchend=function(){u.onEndScaleEmitter.fire(),document.body.removeEventListener("touchmove",u._handleTouchmove),document.body.removeEventListener("touchup",u._handleTouchend)},u.handleWheelFirstTime=function(e){u.isShortKey=e[h.jQ],0!==e.deltaY&&(u.spreadSheetApp.spreadsheet.isExternalSheet()||(u.handleWheelScale(e),window.removeEventListener("wheel",u.handleWheelFirstTime,!0),window.addEventListener("wheel",u.handleWheelFromSecondTime,{capture:!0,passive:!1}),window.addEventListener("keyup",u.handleKeyUp)))},u.handleWheelFromSecondTime=function(e){0!==e.deltaY&&(u.timer&&o.g.clearTimeout(u.timer),u.timer=o.g.setTimeout((function(){window.removeEventListener("wheel",u.handleWheelFromSecondTime,!0),window.removeEventListener("keyup",u.handleKeyUp),window.addEventListener("wheel",u.handleWheelFirstTime,{capture:!0,passive:!1}),u.timer=0,u.isShortKey=!1}),300),u.handleWheelScale(e))},u.handleKeyUp=function(e){e.key===h.h1&&(u.isShortKey=!1)},u.handleWheelScale=function(e){if(u.isShortKey){var t=-e.deltaY/Math.abs(e.deltaY)*2;a.ZP.sheetsBar.trigger("changeScale",t,d.oz.USER),e.stopPropagation(),e.preventDefault()}},u.onStartScale=u.onStartScaleEmitter.event,u.onEndScale=u.onEndScaleEmitter.event,u._register(u.spreadsheetView.operateContext.touchOperate.onTouchstart(u._handleTouchstart)),window.addEventListener("wheel",u.handleWheelFirstTime,{capture:!0,passive:!1}),u}return(0,n.Z)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),window.removeEventListener("wheel",this.handleWheelFirstTime,!0)},t}(s.JT);t.Z=u},56603:function(e,t,o){o.d(t,{ru:function(){return i}});var i,n=o(76138);!function(e){e.LINE="LINE",e.EASE_OUT="EASE_OUT"}(i||(i={})),(0,n.yh)("IScrollApi")},81601:function(e,t,o){o(46396);var i=o(14831),n=o.n(i),r=o(13423),a=o(90644),s=o(56603),l=o(46782),c=function(){function e(e){this.spreadsheetView=e}var t=e.prototype;return t.scrollByPixel=function(e,t,o,i){void 0===t&&(t=!0),void 0===i&&(i=r.oz.SLIENT);var n=0,a=0,s=0,l=0,c={flow:!1,frozen:!1};if(void 0!==(null===e||void 0===e?void 0:e.diffX))switch(null===e||void 0===e?void 0:e.areaX){case"flow":n=e.diffX;break;case"frozen":s=e.diffX}if(void 0!==(null===e||void 0===e?void 0:e.diffY))switch(null===e||void 0===e?void 0:e.areaY){case"flow":a=e.diffY;break;case"frozen":l=e.diffY}this._scroll({diffX:n,diffY:a},t,Object.assign(Object.assign({},o),{onAnimationEnd:function(){var e;c.flow=!0,c.frozen&&(null===(e=null===o||void 0===o?void 0:o.onAnimationEnd)||void 0===e||e.call(o))}}),i),this.scrollOfFrozen({diffFrozenX:s,diffFrozenY:l},(function(){var e;c.frozen=!0,c.flow&&(null===(e=null===o||void 0===o?void 0:o.onAnimationEnd)||void 0===e||e.call(o))}))},t.scrollToRenderFrom=function(e,t,o,i){void 0===t&&(t=!0),void 0===i&&(i=r.oz.SLIENT);var n=0,a=0,s=this.spreadsheetView.areaData;if(void 0!==e.row&&e.row>=s.row.flow.from){if(e.row>s.row.flow.to)throw new Error("row越界，无法定位");a=s.getAreaTopByRow(e.row)-s.row.flow.offsetSize}if(void 0!==e.col&&e.col>=s.col.flow.from){if(e.col>s.col.flow.to)throw new Error("col越界，无法定位");n=s.getAreaLeftByCol(e.col)-s.col.flow.offsetSize}this._scroll({diffX:n,diffY:a},t,o,i)},t.scrollToCenterTop=function(e,t,o){var i;void 0===t&&(t=!0);var n=e.row,r=e.col,a=void 0,s=void 0,l=this.spreadsheetView,c=l.rowcolAccessor,h=l.clientRect,d=l.headSize,u=l.areaData,f=h.height-d.displayColHeadHeight;s=Math.round(f/4),u.row.frozen.isValid()&&u.row.frozen.totalSize<s&&(s-=u.row.frozen.totalSize);var p=c.getColsWidth(r,r),v=h.width-d.displayRowHeadWidth;a=Math.round((v-p)/2),u.col.frozen.isValid()&&u.col.frozen.totalSize<a&&(a-=u.col.frozen.totalSize),this.scrollToDistanceAnchor({row:n,col:r,left:a,top:null!==(i=e.top)&&void 0!==i?i:s,ignoreFrozen:!0},t,o)},t.scrollToVisible=function(e,t,o,i){void 0===t&&(t=!0),void 0===i&&(i=r.oz.SLIENT);var n=this.spreadsheetView.areaData,a=(0,l.Hg)(e,n),s=(0,l.yE)(e,n);this._scroll({diffX:a,diffY:s},t,o,i)},t.scrollToDistanceAnchor=function(e,t,o){void 0===t&&(t=!0);var i=e.row,n=e.col,r=e.left,a=void 0===r?0:r,s=e.top,l=void 0===s?0:s,c=e.ignoreFrozen,h=void 0!==c&&c,d=this.spreadsheetView.areaData;if(h||!d.row.frozen.isValid()&&!d.col.frozen.isValid()){var u=0,f=0;if(void 0!==i&&i>=d.row.flow.from){if(i>d.row.flow.to)throw new Error("row 越界，无法定位");f=d.getAreaTopByRow(i)-l-d.row.flow.offsetSize}if(void 0!==n&&n>=d.col.flow.from){if(n>d.col.flow.to)throw new Error("col 越界，无法定位");u=d.getAreaLeftByCol(n)-a-d.col.flow.offsetSize}this._scroll({diffX:u,diffY:f},t,o)}else this.scrollToVisible({row:i,col:n},t,o)},t.scrollOfFrozen=function(e,t,o,i){void 0===t&&(t=function(){}),void 0===i&&(i=!0);var r=e.diffFrozenX,a=e.diffFrozenY;if(this.cancelFrozenAnimationHandler&&(this.cancelFrozenAnimationHandler(),this.cancelFrozenAnimationHandler=void 0),n().isPC||0===r&&0===a)t();else{if(i)return this.setFrozenViewSize(e,o),void t();this.frozenScrollWithAnimation(e,t,o),this.spreadsheetView.renderManager.renderApi.renderTable()}},t.setFrozenViewSize=function(e,t){void 0===t&&(t=r.oz.USER);var o=e.diffFrozenX,i=e.diffFrozenY;0!==o&&this.setFrozenColViewSize(o,t),0!==i&&this.setFrozenRowViewSize(i,t),this.spreadsheetView.renderManager.renderApi.renderTable()},t.frozenScrollWithAnimation=function(e,t,o){var i=this;void 0===t&&(t=function(){}),void 0===o&&(o=r.oz.USER);var n=e.diffFrozenX,a=e.diffFrozenY,s=(0,l.SI)(n,a),c=Math.abs(n)>Math.abs(a)?n:a,h=0,d=0;this.cancelFrozenAnimationHandler=(0,l.bJ)(0,c,s,(function(e){var t=e/c*n-h,r=e/c*a-d;i.setFrozenColViewSize(t,o),i.setFrozenRowViewSize(r,o),i.spreadsheetView.renderManager.renderApi.renderTable(),h+=t,d+=r}),(function(){t(),i.cancelFrozenAnimationHandler=void 0}))},t._scroll=function(e,t,o,i){var n,a;void 0===t&&(t=!0),void 0===o&&(o={}),void 0===i&&(i=r.oz.SLIENT);var s=e.diffX,l=e.diffY,c=this.spreadsheetView.areaData;if(this.cancelAnimationHandler&&(this.cancelAnimationHandler(),this.cancelAnimationHandler=void 0),0!==s||0!==l)return t?(c.row.flow.setOffsetSize(c.row.flow.offsetSize+l,i),c.col.flow.setOffsetSize(c.col.flow.offsetSize+s,i),void(null===(a=o.onAnimationEnd)||void 0===a||a.call(o))):void this.setScrollWithAnimation(s,l,o,i);null===(n=o.onAnimationEnd)||void 0===n||n.call(o)},t.setScrollWithAnimation=function(e,t,o,i){void 0===i&&(i=r.oz.SLIENT);var n=o.type,a=void 0===n?s.ru.LINE:n,l=o.onAnimationEnd;switch(a){case s.ru.EASE_OUT:this.animationWithEaseOut(e,t,l,i,o.duration);break;case s.ru.LINE:this.animationWithLinear(e,t,l,i,o.steps)}},t.adjustScrollDistance=function(e,t,o){void 0===o&&(o=r.oz.SLIENT);var i=100,n=this.spreadsheetView.areaData,a=0,s=0;if(Math.abs(e)<i)a=e;else{var l=e/Math.abs(e),c=n.col.flow.offsetSize+l*(Math.abs(e)-i);n.col.flow.setOffsetSize(c,o),a=i*l}if(Math.abs(t)<i)s=t;else{var h=t/Math.abs(t),d=n.row.flow.offsetSize+h*(Math.abs(t)-i);n.row.flow.setOffsetSize(d,o),s=i*h}return{diffX:a,diffY:s}},t.animationWithEaseOut=function(e,t,o,i,n){var a=this;void 0===i&&(i=r.oz.SLIENT);var s=this.adjustScrollDistance(e,t,i),c=s.diffX,h=s.diffY,d=this.spreadsheetView.areaData,u=d.col.flow.offsetSize,f=d.row.flow.offsetSize,p=0,v=0;this.cancelAnimationHandler=(0,l.Vv)((function(e){var t,n=Math.ceil(e*c),r=Math.ceil(e*h);Math.abs(n-p)<2&&(n=p),Math.abs(r-v)<2&&(r=v),n!==p||r!==v?(p=n,v=r,Math.abs(c-n)<2&&(n=c),Math.abs(h-r)<2&&(r=h),d.col.flow.setOffsetSize(n+u,i),d.row.flow.setOffsetSize(r+f,i),n===c&&r===h&&(null===o||void 0===o||o(),null===(t=a.cancelAnimationHandler)||void 0===t||t.call(a),a.cancelAnimationHandler=void 0)):null===o||void 0===o||o()}),(function(){d.col.flow.setOffsetSize(c+u,i),d.row.flow.setOffsetSize(h+f,i),null===o||void 0===o||o(),a.cancelAnimationHandler=void 0}),n)},t.animationWithLinear=function(e,t,o,i,n){var a=this;void 0===i&&(i=r.oz.SLIENT);var s=this.spreadsheetView.areaData,c=n||(0,l.SI)(e,t),h=Math.abs(e)>Math.abs(t)?e:t,d=0,u=0;this.cancelAnimationHandler=(0,l.bJ)(0,h,c,(function(o){var n=o/h*e-d,r=o/h*t-u;s.row.flow.setOffsetSize(s.row.flow.offsetSize+r,i),s.col.flow.setOffsetSize(s.col.flow.offsetSize+n,i),d+=n,u+=r}),(function(){null===o||void 0===o||o(),a.cancelAnimationHandler=void 0}))},t.setFrozenColViewSize=function(e,t){void 0===t&&(t=r.oz.USER);var o=this.spreadsheetView.areaData.col.frozen.viewSize;o+=e,o=Math.min(this.spreadsheetView.areaData.col.frozen.totalSize,Math.max((0,a.pJ)(this.spreadsheetView),o)),this.spreadsheetView.areaData.col.setMaxFrozenViewSize(o,t);var i=this.spreadsheetView.areaData.col.frozen.totalSize;this.spreadsheetView.areaData.col.frozen.setOffsetSize(i,t)},t.setFrozenRowViewSize=function(e,t){void 0===t&&(t=r.oz.USER);var o=this.spreadsheetView.areaData.row.frozen.viewSize;o+=e,o=Math.min(this.spreadsheetView.areaData.row.frozen.totalSize,Math.max((0,a.n_)(this.spreadsheetView),o)),this.spreadsheetView.areaData.row.setMaxFrozenViewSize(o,t);var i=this.spreadsheetView.areaData.row.frozen.totalSize;this.spreadsheetView.areaData.row.frozen.setOffsetSize(i,t)},e}();t.Z=c},46782:function(e,t,o){o.d(t,{Hg:function(){return c},K1:function(){return u},SI:function(){return s},Vv:function(){return l},bJ:function(){return a},jc:function(){return h},yE:function(){return d}});var i=o(94131),n=o.n(i);if(6042==o.j)var r=o(24245);function a(e,t,o,i,n){o=o||2;var r=0,a=e;return function s(){if(a+=(t-e)/o,Math.abs(a)>Math.abs(t)-5)return i(t),null===n||void 0===n||n(),void(r=0);i(a),r=requestAnimationFrame(s)}(),function(){r&&cancelAnimationFrame(r)}}function s(e,t){var o=Math.abs(e||t);if(0===o)return 8;var i=8+o/(window.innerHeight/2)*8;return Math.min(16,Math.max(8,Math.round(i)))}function l(e,t,o){void 0===o&&(o=600);var i=n()(0,.98,.26,.99),r=Date.now(),a=0;return function n(){var s=(Date.now()-r)/o,l=i(s);l<1&&s<1?(e(l),a=requestAnimationFrame(n)):(null===t||void 0===t||t(),a=0)}(),function(){a&&cancelAnimationFrame(a)}}function c(e,t){var o,i,n=0,r=e.x||0,a=(null===(o=e.padding)||void 0===o?void 0:o.left)||0,s=(null===(i=e.padding)||void 0===i?void 0:i.right)||0;if(void 0!==e.col&&e.col>=t.col.flow.from){if(e.col>t.col.flow.to)throw new Error("col越界，无法定位");n=t.getAreaLeftByCol(e.col)-r-a-t.col.flow.offsetSize,0===(n=Math.min(0,n))&&(n=t.getAreaLeftByCol(e.col+1)+r+s-t.col.flow.viewSize-t.col.flow.offsetSize+t.col.flow.padding,n=Math.max(0,n))}return n}function h(e,t){var o,i,n=0,a=e.x||0,s=(null===(o=e.padding)||void 0===o?void 0:o.left)||0,l=(null===(i=e.padding)||void 0===i?void 0:i.right)||0,c=t.view.canvas,h=c.areaData,d=c.rowcolAccessor,u=c.tableView.getCellViewAtPosition(e.row||0,e.col||0);if(void 0!==e.col&&e.col>=h.col.frozen.from){if(e.col>h.col.frozen.to)return 0;if(n=h.getAreaLeftByCol(e.col)-a-s-h.col.frozen.offsetSize,0===(n=Math.min(0,n))){var f=(0,r.o)(d,u,e.col),p=h.getAreaLeftByCol(e.col)+f,v=c.scale.scale,w=Math.floor((c.clientRect.width-c.headSize.rowHeadWidth)/v);n=p+a+l-(w=Math.min(w,h.col.frozen.viewSize))-h.col.frozen.offsetSize+h.col.frozen.padding,n=Math.max(0,n)}}return n}function d(e,t){var o,i,n=0,r=e.y||0,a=(null===(o=e.padding)||void 0===o?void 0:o.top)||0,s=(null===(i=e.padding)||void 0===i?void 0:i.bottom)||0;if(void 0!==e.row&&e.row>=t.row.flow.from){if(e.row>t.row.flow.to)throw new Error("row 越界，无法定位");n=t.getAreaTopByRow(e.row)-r-a-t.row.flow.offsetSize,0===(n=Math.min(0,n))&&(n=t.getAreaTopByRow(e.row+1)+r+s-t.row.flow.viewSize-t.row.flow.offsetSize+t.row.flow.padding,n=Math.max(0,n))}return n}function u(e,t){var o,i,n=0,a=e.y||0,s=(null===(o=e.padding)||void 0===o?void 0:o.top)||0,l=(null===(i=e.padding)||void 0===i?void 0:i.bottom)||0,c=t.view.canvas,h=c.areaData,d=c.rowcolAccessor,u=c.tableView.getCellViewAtPosition(e.row||0,e.col||0);if(void 0!==e.row&&e.row>=h.row.frozen.from){if(e.row>h.row.frozen.to)return 0;if(n=h.getAreaTopByRow(e.row)-a-s-h.row.frozen.offsetSize,0===(n=Math.min(0,n))){var f=(0,r.E)(d,u,e.row),p=h.getAreaTopByRow(e.row)+f,v=c.scale.scale,w=Math.floor((c.clientRect.height-c.headSize.colHeadHeight)/v);n=p+a+l-(w=Math.min(h.row.frozen.viewSize,w))-h.row.frozen.offsetSize+h.row.frozen.padding,n=Math.max(0,n)}}return n}},7031:function(e,t,o){o.d(t,{Z:function(){return p}});var i=o(38661),n=o(13504),r=(o(46396),o(87474)),a=o(84415),s=o(14831),l=o.n(s),c=function(){function e(e,t,o,i){var n=this;this._board=document.createElement("div"),this._box=document.createElement("div"),this._originY=0,this._setBoxHeight=(0,a.ad)((function(){n._area.displayTotalSize<n._area.displayViewSize?n._board.style.display="none":(n._board.style.display="block",n._height=Math.max(60,n._area.displayViewSize/n._area.displayTotalSize*n._area.displayViewSize),n._box.style.height=n._height+"px",n._setBoxOffset())})),this._setBoxOffset=function(){var e=n._area.displayOffsetSize/(n._area.displayTotalSize-n._area.displayViewSize)*(n._area.displayViewSize-n._height-n._area.displayPadding);n._box.style.transform="translateY("+e+"px)"},this._handleMousedown=function(e){e.preventDefault(),e.stopPropagation(),n._originY=e.clientY,document.addEventListener("mousemove",n._handleMousemove),document.addEventListener("mouseup",n._handleMouseup)},this._handleMousemove=function(e){var t=e.clientY,o=n._originY-t;n._callback({x:0,y:o/(n._area.displayViewSize-n._height)*(n._area.displayTotalSize-n._area.displayViewSize)/n._scale.scale}),n._originY=t},this._handleMouseup=function(){document.removeEventListener("mousemove",n._handleMousemove),document.removeEventListener("mouseup",n._handleMouseup),n._originY=0},this._handleTouchStart=function(e){var t,o;e.stopPropagation(),n._originY=null===(o=null===(t=e.targetTouches)||void 0===t?void 0:t[0])||void 0===o?void 0:o.clientY,document.addEventListener("touchmove",n._handleTouchmove),document.addEventListener("touchend",n._handleTouchend)},this._handleTouchmove=function(e){var t,o,i=null===(o=null===(t=e.targetTouches)||void 0===t?void 0:t[0])||void 0===o?void 0:o.clientY,r=n._originY-i;n._callback({x:0,y:r/(n._area.displayViewSize-n._height)*(n._area.displayTotalSize-n._area.displayViewSize)/n._scale.scale}),n._originY=i},this._handleTouchend=function(){document.removeEventListener("touchmove",n._handleTouchmove),document.removeEventListener("touchend",n._handleTouchend),n._originY=0},this._area=t,this._callback=i,this._scale=o,this._board.classList.add("scroll-y-board-pc"),this._box.classList.add("scroll-y-box-pc"),l().isMobile&&this._box.classList.add("scroll-y-box-pad"),this._setBoxHeight(),this._board.appendChild(this._box),e.appendChild(this._board),this._area.onUpdateOffset(this._setBoxOffset),this._area.onUpdateViewSize(this._setBoxHeight),this._area.onUpdateTotalSize(this._setBoxHeight),this.bind()}var t=e.prototype;return t.refresh=function(){this._setBoxHeight(),this._setBoxOffset()},t.bind=function(){this._box.addEventListener("mousedown",this._handleMousedown),this._box.addEventListener("touchstart",this._handleTouchStart)},t.unbind=function(){this._box.removeEventListener("mousedown",this._handleMousedown),this._box.removeEventListener("touchstart",this._handleTouchStart)},e}(),h=function(){function e(e,t,o,i){var n=this;this._board=document.createElement("div"),this._box=document.createElement("div"),this._originX=0,this._setBoxWidth=(0,a.ad)((function(){n._area.displayTotalSize<n._area.displayViewSize?n._board.style.display="none":(n._board.style.display="block",n._width=Math.max(60,n._area.displayViewSize/n._area.displayTotalSize*n._area.displayViewSize),n._box.style.width=(n._width>>0)+"px",n._setBoxOffset())})),this._setBoxOffset=function(){var e=n._area.displayOffsetSize/(n._area.displayTotalSize-n._area.displayViewSize)*(n._area.displayViewSize-n._width-n._area.displayPadding);n._box.style.transform="translateX("+e+"px)"},this._handleMousedown=function(e){e.preventDefault(),e.stopPropagation(),n._originX=e.clientX,document.addEventListener("mousemove",n._handleMousemove),document.addEventListener("mouseup",n._handleMouseup)},this._handleMousemove=function(e){var t=e.clientX,o=n._originX-t;n._callback({x:o/(n._area.displayViewSize-n._width)*(n._area.displayTotalSize-n._area.displayViewSize)/n._scale.scale,y:0}),n._originX=t},this._handleMouseup=function(){document.removeEventListener("mousemove",n._handleMousemove),document.removeEventListener("mouseup",n._handleMouseup),n._originX=0},this._handleTouchStart=function(e){var t,o;e.stopPropagation(),n._originX=null===(o=null===(t=e.targetTouches)||void 0===t?void 0:t[0])||void 0===o?void 0:o.clientX,document.addEventListener("touchmove",n._handleTouchmove),document.addEventListener("touchend",n._handleTouchend)},this._handleTouchmove=function(e){var t,o,i=null===(o=null===(t=e.targetTouches)||void 0===t?void 0:t[0])||void 0===o?void 0:o.clientX,r=n._originX-i;n._callback({x:r/(n._area.displayViewSize-n._width)*(n._area.displayTotalSize-n._area.displayViewSize)/n._scale.scale,y:0}),n._originX=i},this._handleTouchend=function(){document.removeEventListener("touchmove",n._handleTouchmove),document.removeEventListener("touchend",n._handleTouchend),n._originX=0},this._area=t,this._callback=i,this._scale=o,this._board.classList.add("scroll-x-board-pc"),this._box.classList.add("scroll-x-box-pc"),l().isMobile&&this._box.classList.add("scroll-x-box-pad"),this._setBoxWidth(),this._board.appendChild(this._box),e.appendChild(this._board),this._area.onUpdateOffset(this._setBoxOffset),this._area.onUpdateViewSize(this._setBoxWidth),this._area.onUpdateTotalSize(this._setBoxWidth),this.bind()}var t=e.prototype;return t.refresh=function(){this._setBoxWidth(),this._setBoxOffset()},t.bind=function(){this._box.addEventListener("mousedown",this._handleMousedown),this._box.addEventListener("touchstart",this._handleTouchStart)},t.unbind=function(){this._box.removeEventListener("mousedown",this._handleMousedown),this._box.removeEventListener("touchstart",this._handleTouchStart)},e}(),d=function(){function e(e,t){var o=this;this._yWrap=document.createElement("div"),this._xWrap=document.createElement("div"),this._refreshY=function(){o._yWrap.style.top=o._areaData.row.frozen.displayViewSize+"px",o._scrollY.refresh()},this._refreshX=function(){o._xWrap.style.left=o._areaData.col.frozen.displayViewSize+"px",o._scrollX.refresh()},this._container=e.container,this._areaData=e.areaData,this._scale=e.scale,this._yWrap.classList.add("scroll-y-wrap-pc"),this._xWrap.classList.add("scroll-x-wrap-pc"),this._scrollY=new c(this._yWrap,this._areaData.row.flow,this._scale,t),this._scrollX=new h(this._xWrap,this._areaData.col.flow,this._scale,t),this._container.appendChild(this._yWrap),this._container.appendChild(this._xWrap),this._refreshY(),this._refreshX(),this._areaData.row.frozen.onUpdateViewSize(this._refreshY),this._areaData.col.frozen.onUpdateViewSize(this._refreshX),this._scale.onScale((function(){o._refreshY(),o._refreshX()}))}return e.prototype.refresh=function(){this._refreshY(),this._refreshX()},e}(),u=function(e,t){var o=this;this._scrollBar=e,this._areaData=t.areaData,this._scrollBar.emitter.on(r.Z.EVENT.SCROLL,(function(e){0!=e.y&&o._areaData.row.flow.setOffsetSize(o._areaData.row.flow.offsetSize-e.y),0!=e.x&&o._areaData.col.flow.setOffsetSize(o._areaData.col.flow.offsetSize-e.x)}))},f=function(e){function t(t){var o;return(o=e.call(this,t)||this)._scrollCallback=function(e){o.emitter.emit(r.Z.EVENT.SCROLL,e)},o._scrollWrap=new d({container:o._mainBoard.element,areaData:o._areaData,scale:o._scale},o._scrollCallback),o._feature=new u((0,i.Z)(o),{areaData:o._areaData}),o}return(0,n.Z)(t,e),t.prototype.refresh=function(){this._scrollWrap.refresh()},t}(r.Z);f.EVENT=Object.assign({},r.Z.EVENT);var p=f},3078:function(e,t,o){var i=o(597),n=function(){function e(e){this.spreadsheetView=e,this.spreadsheetView=e}var t=e.prototype;return t.selectAll=function(e,t){void 0===t&&(t=null),this._clearSelectData(e),e.addSelection({},t)},t.selectCells=function(e,t,o){void 0===o&&(o=null),this._clearSelectData(e);var i={xRange:t.xRange,yRange:t.yRange};e.addSelection(i,o)},t.selectRows=function(e,t,o){void 0===o&&(o=null),this._clearSelectData(e);var i={yRange:t};e.addSelection(i,o)},t.selectCols=function(e,t,o){void 0===o&&(o=null),this._clearSelectData(e);var i={xRange:t};e.addSelection(i,o)},t.getSelectedRows=function(e){return(0,i.TS)(this.spreadsheetView.rowcolAccessor,e.selectQueue)},t.getSelectedCols=function(e){return(0,i.rz)(this.spreadsheetView.rowcolAccessor,e.selectQueue)},t._clearSelectData=function(e){e.resetSelection()},e}();t.Z=n},88877:function(e,t,o){var i,n=o(85952),r=o(13504),a=o(84415),s=o(28280),l=o(80578),c=o(597);!function(e){e.modifySelectData="modifySelectData"}(i||(i={}));var h=function(e){function t(t,o){var n;return(n=e.call(this,t,o)||this).onModifySelectDataEmitter=new s.Q5({name:i.modifySelectData}),n._modifySelection=(0,a.ad)((function(){n.onModifySelectDataEmitter.fire()})),n.onModifySelectData=n.onModifySelectDataEmitter.event,n}(0,r.Z)(t,e);var o=t.prototype;return o.isSingle=function(){return 1===this._selectQueue.length},o.addSelection=function(t){var o=this.select;o&&(o.activation=null,this.onUpdateSelectDataEmitter.fire({index:this.currentSelectIndex,selection:o})),t.activation||(t.activation={row:t.yRange?t.yRange[0]:0,col:t.xRange?t.xRange[0]:0}),e.prototype.addSelection.call(this,t,t.activation),this.onAddSelectDataEmitter.fire(this.select),this._modifySelection()},o.updateSelection=function(t,o){var i=this._selectQueue[t];if(!i)throw new Error("错误更新选区");if(!o.activation){if(!i.activation)throw new Error("未传入激活区域，并且无法复用之前的激活区域");if(o.activation={row:i.activation.row,col:i.activation.col},o.xRange&&(o.activation.col<o.xRange[0]||o.activation.col>o.xRange[1]))throw new Error("未传入激活区域，并且无法复用之前的激活区域");if(o.yRange&&(o.activation.row<o.yRange[0]||o.activation.row>o.yRange[1]))throw new Error("未传入激活区域，并且无法复用之前的激活区域")}e.prototype.updateSelection.call(this,t,o,o.activation),this.onUpdateSelectDataEmitter.fire({index:t,selection:this._selectQueue[t]}),this._modifySelection()},o.removeSelection=function(){throw new Error("normalSelectData shouldn't call removeSelection")},o.resetSelection=function(){e.prototype.resetSelection.call(this),this.onResetSelectDataEmitter.fire(),this._modifySelection()},(0,n.Z)(t,[{key:"activeRow",get:function(){var e=this.activation;return e?(0,c.Uz)(this.spreadsheetView.tableView,e.row,e.col).row:-1}},{key:"activeCol",get:function(){var e=this.activation;return e?(0,c.Uz)(this.spreadsheetView.tableView,e.row,e.col).col:-1}},{key:"activation",get:function(){return null===this.select?null:this.select.activation}}]),t}(l.Z);t.Z=h},32708:function(e,t,o){o.d(t,{Z:function(){return C}});var i=o(85952),n=o(38661),r=o(13504),a=(o(41031),o(46396),function(){function e(e){this._element=document.createElement("div"),this._ac=document.createElement("div"),this._stopPropagation=function(e){2==e.button&&e.stopPropagation()},this._element.classList.add("multiple-selection"),this._ac.classList.add("multiple-selection-active"),this._element.addEventListener("mousedown",this._stopPropagation),this._element.appendChild(this._ac),this.setAttribute(e)}return e.newInstance=function(t,o){var i=e.pools.pop();return i?i.setAttribute(o):i=new e(o),t.appendChild(i._element),i},e.destroy=function(t){t._element.remove(),e.pools.push(t)},e.prototype.setAttribute=function(e){var t;if(e.padding){this._ac.style.display="block";var o=e.padding;t=o[0]+"px "+o[1]+"px "+o[2]+"px "+o[3]+"px"}else this._ac.style.display="none",t="0px 0px 0px "+(e.width-1)+"px";var i=e.display,n=void 0===i||i;Object.assign(this._element.style,{left:e.left+"px",top:e.top+"px",width:Math.max(0,e.width-1)+"px",height:Math.max(0,e.height-1)+"px","border-width":t,display:n?"block":"none"})},e}());a.pools=[];var s=a,l=function(){function e(e){this._multipleSelections=[],this._board=e}var t=e.prototype;return t.size=function(){return this._multipleSelections.length},t.clear=function(){for(var e;e=this._multipleSelections.pop();)s.destroy(e)},t.remove=function(e){var t=this._multipleSelections[e];void 0!==t?(this._multipleSelections.splice(e,1),s.destroy(t)):console.error("can't find multiple selection by index: ",e)},t.add=function(e){this._multipleSelections.push(s.newInstance(this._board,e))},t.update=function(e,t){var o=this._multipleSelections[e];void 0!==o?o.setAttribute(t):console.error("can't find multiple selection by index: ",e)},e}(),c=function(){function e(){this._element=document.createElement("div"),this._element.classList.add("single-selection")}e.newInstance=function(t){var o=e.pools.pop();return o||(o=new e),t.appendChild(o._element),o},e.destroy=function(t){t._element.remove(),e.pools.push(t)};var t=e.prototype;return t.setAttribute=function(e){var t;if(e.padding){var o=e.padding;t=o[0]+"px "+o[1]+"px "+o[2]+"px "+o[3]+"px"}else t="0px 0px 0px "+(e.width-2)+"px";var i=e.display,n=void 0===i||i;Object.assign(this._element.style,{left:e.left+"px",top:e.top+"px",width:Math.max(0,e.width-2)+"px",height:Math.max(0,e.height-2)+"px","border-width":t,display:n?"block":"none"})},t.show=function(){this._element.style.display="block"},t.hide=function(){this._element.style.display="none"},e}();c.pools=[];var h=c,d=o(76138),u=o(51057),f=function(e){function t(t){var i;return(i=e.call(this)||this)._serviceBrand=void 0,i.onClickEmitter=new u.Q,i.onDoubleClickEmitter=new u.Q,i.handleContextMenu=function(e){e.preventDefault()},i.handleMousedown=function(e){if(2===e.button)return e.preventDefault();i.onClickEmitter.fire(e)},i.handleDoubleClick=function(e){i.onDoubleClickEmitter.fire(e)},i.showCursor=function(){o.g.removeEventListener("mouseup",i.showCursor),setTimeout((function(){i.corner.classList.remove("no-cursor")}),100)},i.hideCursorWhenActive=function(){i.corner.classList.add("no-cursor"),o.g.addEventListener("mouseup",i.showCursor)},i.onClick=i.onClickEmitter.event,i.onDoubleClick=i.onDoubleClickEmitter.event,i.corner=document.createElement("div"),i.corner.classList.add("smart-corner"),i.corner.addEventListener("mousedown",i.handleMousedown),i.corner.addEventListener("dblclick",i.handleDoubleClick),i.corner.addEventListener("contextmenu",i.handleContextMenu),t.appendChild(i.corner),i}(0,r.Z)(t,e);var i=t.prototype;return i.setAttribute=function(e){this.hideCursorWhenActive(),Object.assign(this.corner.style,{left:e.left+e.width-1+"px",top:e.top+e.height-1+"px"})},i.show=function(){this.corner.style.display="block"},i.hide=function(){this.corner.style.display="none"},t}(d.JT),p=(o(38934),o(31688),o(71096),o(28280)),v=function(){function e(e){var t=this;this.valid=!1,this.initDraggers=function(e){t.draggers={topDragger:t.initDiv("top"),rightDragger:t.initDiv("right"),bottomDragger:t.initDiv("bottom"),leftDragger:t.initDiv("left")},Object.keys(t.draggers).forEach((function(o){e.appendChild(t.draggers[o])}))},this.initDiv=function(e){var o=document.createElement("div");return o.classList.add("range-move-dragger"),o.classList.add(e),o.addEventListener("mousedown",t.handleMousedown),o.addEventListener("contextmenu",t.handleContextMenu),o},this.handleContextMenu=function(e){e.preventDefault(),e.stopPropagation()},this.handleMousedown=function(e){if(2===e.button)return e.preventDefault();t.mouseDownEmitter.fire(e)},this.showCursor=function(){o.g.removeEventListener("mouseup",t.showCursor),setTimeout((function(){t.draggers.topDragger.classList.remove("no-cursor"),t.draggers.rightDragger.classList.remove("no-cursor"),t.draggers.bottomDragger.classList.remove("no-cursor"),t.draggers.leftDragger.classList.remove("no-cursor")}),100)},this.hideCursorWhenActive=function(){t.draggers.topDragger.classList.add("no-cursor"),t.draggers.rightDragger.classList.add("no-cursor"),t.draggers.bottomDragger.classList.add("no-cursor"),t.draggers.leftDragger.classList.add("no-cursor"),o.g.addEventListener("mouseup",t.showCursor)},this.initDraggers(e),this.mouseDownEmitter=new p.Q5,this.onMouseDown=this.mouseDownEmitter.event}var t=e.prototype;return t.setAttribute=function(t){this.hideCursorWhenActive(),Object.assign(this.draggers.topDragger.style,{left:t.left+"px",top:t.top-2+"px",width:t.width+"px",height:e.BORDER_WIDTH+"px"}),Object.assign(this.draggers.rightDragger.style,{left:t.left+t.width-e.BORDER_WIDTH+1+"px",top:t.top+"px",width:e.BORDER_WIDTH+"px",height:t.height-e.BORDER_WIDTH+"px"}),Object.assign(this.draggers.bottomDragger.style,{left:t.left+"px",top:t.top+t.height-e.BORDER_WIDTH+1+"px",width:t.width+"px",height:e.BORDER_WIDTH+"px"}),Object.assign(this.draggers.leftDragger.style,{left:t.left-1+"px",top:t.top+"px",width:e.BORDER_WIDTH+"px",height:t.height-e.BORDER_WIDTH+"px"})},t.show=function(){var e=this;this.valid&&Object.keys(this.draggers).forEach((function(t){e.draggers[t].style.display="block"}))},t.hide=function(){var e=this;Object.keys(this.draggers).forEach((function(t){e.draggers[t].style.display="none"}))},t.setValid=function(e){this.valid=e,e?this.show():this.hide()},e}();v.BORDER_WIDTH=4;var w,m=v,g=o(8326),_=function(){function e(e){this.board=e,this.normalSelection=h.newInstance(this.board),this.smartCorner=new f(this.board),this.rangeMoveDragger=new m(this.board)}var t=e.prototype;return t.getLeft=function(){return this.left},t.getTop=function(){return this.top},t.getWidth=function(){return this.width},t.getHeight=function(){return this.height},t.getSmartCorner=function(){return this.smartCorner},t.hide=function(){!1!==g.Z.getConfig("custom.insertDeleteMoveRange")&&this.rangeMoveDragger.hide(),this.smartCorner.hide(),this.normalSelection.hide()},t.show=function(){!1!==g.Z.getConfig("custom.insertDeleteMoveRange")&&this.rangeMoveDragger.show(),this.smartCorner.show(),this.normalSelection.show()},t.update=function(e){this.left=e.left,this.top=e.top,this.width=e.width,this.height=e.height,!1!==g.Z.getConfig("custom.insertDeleteMoveRange")&&this.rangeMoveDragger.setAttribute(e),this.smartCorner.setAttribute(e),this.normalSelection.setAttribute(e)},e}();!function(e){e[e.EMPTY=0]="EMPTY",e[e.USING_SINGLE=1]="USING_SINGLE",e[e.USING_MULTIPLE=2]="USING_MULTIPLE"}(w||(w={}));var y=function(e){function t(t,o,i){var n;return(n=e.call(this)||this).sheetStatus=t,n.spreadsheetView=o,n.blockBoard=i,n.board=document.createElement("div"),n._normalSelectionStatus=w.EMPTY,n.changePermission=function(){if(n.sheetStatus.canEdit){var e=!1!==g.Z.getConfig("custom.insertDeleteMoveRange");n._singleSelectionApi.rangeMoveDragger.setValid(e)}else n._singleSelectionApi.rangeMoveDragger.setValid(!1)},n.board.classList.add("selection-stage-board"),n.blockBoard.hiddenBoard.append(n.board),n._singleSelectionApi=new _(n.board),n._multipleSelectionApi=new l(n.board),n.sheetStatus.change(n.changePermission),n.changePermission(),n}(0,r.Z)(t,e);var o=t.prototype;return o.addSelection=function(e,t){var o={left:e.left-this.blockBoard.globalOffsetX,top:e.top-this.blockBoard.globalOffsetY,width:e.width,height:e.height,padding:e.padding,display:t};this._normalSelectionStatus===w.EMPTY?(this._singleSelectionApi.update(o),this._singleSelectionApi.show(),this._normalSelectionStatus=w.USING_SINGLE):this._normalSelectionStatus===w.USING_SINGLE?(this._singleSelectionApi.hide(),this._multipleSelectionApi.add({left:this._singleSelectionApi.getLeft(),top:this._singleSelectionApi.getTop(),width:this._singleSelectionApi.getWidth(),height:this._singleSelectionApi.getHeight()}),this._multipleSelectionApi.add(o),this._normalSelectionStatus=w.USING_MULTIPLE):this._multipleSelectionApi.add(o)},o.updateSelection=function(e,t,o){var i={left:t.left-this.blockBoard.globalOffsetX,top:t.top-this.blockBoard.globalOffsetY,width:t.width,height:t.height,padding:t.padding,display:o};this._normalSelectionStatus===w.USING_MULTIPLE?this._multipleSelectionApi.update(e,i):this._normalSelectionStatus===w.USING_SINGLE&&this._singleSelectionApi.update(i)},o.removeSelection=function(e){this._normalSelectionStatus===w.USING_MULTIPLE?this._multipleSelectionApi.remove(e):this._normalSelectionStatus===w.USING_SINGLE&&this._singleSelectionApi.hide()},o.resetSelection=function(){this._multipleSelectionApi.clear(),this._singleSelectionApi.hide(),this._normalSelectionStatus=w.EMPTY},o.show=function(){this.board.style.display="block"},o.hide=function(){this.board.style.display="none"},o.dispose=function(){e.prototype.dispose.call(this),this.board.remove()},(0,i.Z)(t,[{key:"singleSelectionApi",get:function(){return this._singleSelectionApi}}]),t}(d.JT),S=o(42630),b=o(77802),E=o(84415),x=o(47616),D=o(13423),L=o(20589),A=o.n(L),C=function(e){function t(t,o,i,r){var a;return(a=e.call(this,t)||this).normalSelectData=t,a.spreadsheetView=o,a.sheetStatus=i,a.mutexManagement=r,a._handleUpdateSelections=(0,E.ad)((function(){for(var e=0;e<a._selectData.selectQueue.length;e++){var t=a._selectData.selectQueue[e];a._updateSelection({index:e,selection:t})}})),a.handleUpdateSelectionsThrottle=A()(a._handleUpdateSelections,void 0,{trailing:!0}),a.isUpdateSelectionsLocked=!1,a.registerAfterAreaRenderOnce=function(e){var t=e.source;a.isUpdateSelectionsLocked||(t!==D.oz.RENDER?(t===D.oz.USER&&(a.isUpdateSelectionsLocked=!0),p.ju.once(a.spreadsheetView.renderManager.alloyExcel.onAfterAreaRender)((function(){a.isUpdateSelectionsLocked=!1,a._handleUpdateSelections()}))):a.handleUpdateSelectionsThrottle())},a.topLeft=a._register(new y(i,o,a.spreadsheetView.mainBoard.top.left)),a.topRight=a._register(new y(i,o,a.spreadsheetView.mainBoard.top.right)),a.bottomLeft=a._register(new y(i,o,a.spreadsheetView.mainBoard.bottom.left)),a.bottomRight=a._register(new y(i,o,a.spreadsheetView.mainBoard.bottom.right)),a._register(a.spreadsheetView.areaData.row.frozen.onUpdateViewSize(a.registerAfterAreaRenderOnce)),a._register(a.spreadsheetView.areaData.row.flow.onUpdateViewSize(a.registerAfterAreaRenderOnce)),a._register(a.spreadsheetView.areaData.col.frozen.onUpdateViewSize(a.registerAfterAreaRenderOnce)),a._register(a.spreadsheetView.areaData.col.flow.onUpdateViewSize(a.registerAfterAreaRenderOnce)),a._register(a.spreadsheetView.areaData.row.frozen.onUpdateTotalSize(a.registerAfterAreaRenderOnce)),a._register(a.spreadsheetView.areaData.row.flow.onUpdateTotalSize(a.registerAfterAreaRenderOnce)),a._register(a.spreadsheetView.areaData.col.frozen.onUpdateTotalSize(a.registerAfterAreaRenderOnce)),a._register(a.spreadsheetView.areaData.col.flow.onUpdateTotalSize(a.registerAfterAreaRenderOnce)),a.mutexManagement.addMutexComponent(x.d.SELECTION,(0,n.Z)(a)),a}(0,r.Z)(t,e);var o=t.prototype;return o.refresh=function(){},o.show=function(){this._showing||this._show()},o.hide=function(){this._showing&&this._hide()},o.mutexHide=function(){this._showing&&this._hide()},o._show=function(){this._showing=!0,this.topLeft.show(),this.topRight.show(),this.bottomLeft.show(),this.bottomRight.show(),this.mutexManagement.mutexShow(x.d.SELECTION),this.onSelectionStageVisiableChangeEmitter.fire(this._showing)},o._hide=function(){this._showing=!1,this.topLeft.hide(),this.topRight.hide(),this.bottomLeft.hide(),this.bottomRight.hide(),this.onSelectionStageVisiableChangeEmitter.fire(this._showing)},o._addSelection=function(e){var t=this.spreadsheetView.areaData,o=(0,S.i)(this.spreadsheetView.tableView,t,e);this.topLeft.addSelection(o,o.startRow<=t.row.frozen.to&&o.startCol<=t.col.frozen.to),this.topRight.addSelection(o,o.startRow<=t.row.frozen.to&&o.endCol>=t.col.flow.from),this.bottomLeft.addSelection(o,o.endRow>=t.row.flow.from&&o.startCol<=t.col.frozen.to),this.bottomRight.addSelection(o,o.endRow>=t.row.flow.from&&o.endCol>=t.col.flow.from)},o._updateSelection=function(e){var t=e.index,o=e.selection,i=this.spreadsheetView.areaData,n=(0,S.i)(this.spreadsheetView.tableView,i,o);this.topLeft.updateSelection(t,n,n.startRow<=i.row.frozen.to&&n.startCol<=i.col.frozen.to),this.topRight.updateSelection(t,n,n.startRow<=i.row.frozen.to&&n.endCol>=i.col.flow.from),this.bottomLeft.updateSelection(t,n,n.endRow>=i.row.flow.from&&n.startCol<=i.col.frozen.to),this.bottomRight.updateSelection(t,n,n.endRow>=i.row.flow.from&&n.endCol>=i.col.flow.from)},o._removeSelection=function(e){this._showing||this._show(),this.topLeft.removeSelection(e),this.topRight.removeSelection(e),this.bottomLeft.removeSelection(e),this.bottomRight.removeSelection(e)},o._resetSelection=function(){this._showing||this._show(),this.topLeft.resetSelection(),this.topRight.resetSelection(),this.bottomLeft.resetSelection(),this.bottomRight.resetSelection()},(0,i.Z)(t,[{key:"showing",get:function(){return this._showing}}]),t}(b.Z)},40152:function(e,t,o){o.d(t,{Z:function(){return R}});var i=o(13504),n=(o(38934),o(31688),o(38661)),r=(o(19553),o(30980),o(71091),o(16640),o(37108),o(28255),o(50104),o(25111),o(39585),o(77575),o(76880),o(11502),o(96434),o(3377),o(71318),o(21530),o(81144),o(46396),o(85952)),a=(o(48845),o(13857),o(54371),o(95019),o(31575),o(5570),o(64656),o(43125),o(27849),o(84919),o(11425),o(15770),o(63313)),s=o.n(a),l=o(74012),c=o.n(l),h=o(93463),d=o(26731),u=o(36130),f=o.n(u);function p(){"use strict";p=function(){return e};var e={},t=Object.prototype,o=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(A){s=function(e,t,o){return e[t]=o}}function l(e,t,o,i){var n=t&&t.prototype instanceof d?t:d,r=Object.create(n.prototype),a=new x(i||[]);return r._invoke=function(e,t,o){var i="suspendedStart";return function(n,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw r;return{value:void 0,done:!0}}for(o.method=n,o.arg=r;;){var a=o.delegate;if(a){var s=S(a,o);if(s){if(s===h)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===i)throw i="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);i="executing";var l=c(e,t,o);if("normal"===l.type){if(i=o.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(i="completed",o.method="throw",o.arg=l.arg)}}}(e,o,a),r}function c(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(A){return{type:"throw",arg:A}}}e.wrap=l;var h={};function d(){}function u(){}function f(){}var v={};s(v,n,(function(){return this}));var w=Object.getPrototypeOf,m=w&&w(w(D([])));m&&m!==t&&o.call(m,n)&&(v=m);var g=f.prototype=d.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function i(n,r,a,s){var l=c(e[n],e,r);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==typeof d&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){h.value=e,a(h)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var n;this._invoke=function(e,o){function r(){return new t((function(t,n){i(e,o,t,n)}))}return n=n?n.then(r,r):r()}}function S(e,t){var o=e.iterator[t.method];if(void 0===o){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=c(o,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function D(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function t(){for(;++i<e.length;)if(o.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:L}}function L(){return{value:void 0,done:!0}}return u.prototype=f,s(g,"constructor",f),s(f,"constructor",u),u.displayName=s(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},_(y.prototype),s(y.prototype,r,(function(){return this})),e.AsyncIterator=y,e.async=function(t,o,i,n,r){void 0===r&&(r=Promise);var a=new y(l(t,o,i,n),r);return e.isGeneratorFunction(o)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(g),s(g,a,"Generator"),s(g,n,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var i=t.pop();if(i in e)return o.value=i,o.done=!1,o}return o.done=!0,o}},e.values=D,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(o,i){return a.type="throw",a.arg=e,t.next=o,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),E(o),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var i=o.completion;if("throw"===i.type){var n=i.arg;E(o)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:D(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),h}},e}var v=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},w=function(){function e(e,t,o){this.isImgLoadingError=!1,this.wrapImpl=document.createElement("div"),this.imageBox=document.createElement("div"),this._handleLoadSuccess=function(){},this._handleLoadFail=function(){},this.container=e,this.props=t,this.wrapImpl.classList.add("shape-wrap"),this.wrapImpl.setAttribute("data-testid","shape-wrap"),this.imageBox.classList.add("shape-image-box"),this.container.appendChild(this.wrapImpl),this.wrapImpl.appendChild(this.imageBox),this.update(),o&&(this.handleFocus=o)}var t=e.prototype;return t.setDatasetId=function(e){this.imageBox.dataset.id=e},t.setProps=function(e){var t=Object.assign(Object.assign({},this.props),e);f()(t,this.props)||(this.props=t,this.update())},t.destroy=function(){this.wrapImpl.remove()},t.handleFocus=function(e){},t.update=function(){return v(this,void 0,void 0,p().mark((function t(){var o,i,n,r,a,s,l,c;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.props,i=o.width,n=o.height,r=o.left,a=o.top,s=o.zIndex,l=o.display,c=void 0===l||l,Object.assign(this.wrapImpl.style,{width:i+"px",height:n+"px",left:r+"px",top:a+"px","z-index":e.DEFAULT_Z_INDEX+s,display:c?"block":"none"}),this.updateImageSize(),t.next=5,this.updateImage();case 5:case"end":return t.stop()}}),t,this)})))},t.updateImage=function(){return v(this,void 0,void 0,p().mark((function e(){var t,i,n,r,a,l,u,f,v,w,m,g,_,y;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!this.image,i=this.props,n=i.url,r=i.clipInfo,a=i.width,l=i.height,e.prev=2,u=r.clipLeft,f=r.clipRight,v=r.clipTop,w=r.clipBottom,m=u+a+f,g=v+l+w,_=(0,h.AJ)(n,{width:m*o.g.devicePixelRatio,height:g*o.g.devicePixelRatio,strategy:h.M$.COVER}),e.next=9,h.ZP.preLoadImageToBrowserCache(_);case 9:y=e.sent,this.image=y,this.isImgLoadingError=!1,this.updateImageSize(),this.imageBox.innerHTML="",this.imageBox.appendChild(y),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),t&&(this.isImgLoadingError=!0,c().render(s().createElement(d.x,null),this.imageBox));case 20:case"end":return e.stop()}}),e,this,[[2,17]])})))},t.updateImageSize=function(){if(this.image){var e=this.props,t=e.clipInfo,o=t.clipBottom,i=t.clipTop,n=t.clipLeft,r=t.clipRight,a=e.width,s=e.height;Object.assign(this.image.style,{top:-i+"px",left:-n+"px",width:n+a+r+"px",height:i+s+o+"px"})}},(0,r.Z)(e,[{key:"wrap",get:function(){return this.wrapImpl}}]),e}();w.imagesToLoad=0,w.failImageToReport=0,w.successImageToReport=0;var m=w,g=o(9252),_=function(e){function t(t,o,i){var n;return(n=e.call(this,t,o,i)||this).handleTap=function(e){e.originEvent.preventDefault(),n.handleFocus(e.originEvent)},(0,g.D2)(n.wrap),n.bindEvent(),n}(0,i.Z)(t,e);var o=t.prototype;return o.bindEvent=function(){this.wrap.addEventListener("pointer",this.handleTap),this.wrap.addEventListener("contextmenu",this.handleFocus)},o.unbindEvent=function(){this.wrap.removeEventListener("pointer",this.handleTap),this.wrap.removeEventListener("contextmenu",this.handleFocus)},t}(m),y=o(76138),S=function(e){function t(t,o){var i;return(i=e.call(this)||this).blockBoard=t,i.focusCallback=o,i.shapeMap=new Map,i.board=document.createElement("div"),i.handleFocus=function(e){var t;e.preventDefault();var o=e.target;if(o){var r=o.dataset.id;r&&(null===(t=i.focusCallback)||void 0===t||t.call((0,n.Z)(i),r))}},i.board.classList.add("shape-stage-board"),i.blockBoard.hiddenBoard.append(i.board),i}(0,i.Z)(t,e);var o=t.prototype;return o.getShape=function(e){return this.shapeMap.get(e)},o.addShape=function(e,t){if(this.blockBoard.isInBoardVisibleArea(t,100)){var o=Object.assign(Object.assign({},t),{left:t.left-this.blockBoard.globalOffsetX,top:t.top-this.blockBoard.globalOffsetY}),i=new _(this.board,o,this.handleFocus);i.setDatasetId(e),this.shapeMap.set(e,i)}},o.updateShape=function(e,t){var o=this.shapeMap.get(e);if(o||(e===this.activeShapeBoxId&&(t.display=!1),this.addShape(e,t),o=this.shapeMap.get(e)),this.blockBoard.isInBoardVisibleArea(t,100)){var i=Object.assign({},t);void 0!==t.left&&(i.left=t.left-this.blockBoard.globalOffsetX),void 0!==t.top&&(i.top=t.top-this.blockBoard.globalOffsetY),o&&o.setProps(i)}else this.removeShape(e)},o.removeShape=function(e){var t=this.shapeMap.get(e);t&&(t.destroy(),this.shapeMap.delete(e))},o.showShape=function(e){this.activeShapeBoxId="";var t=this.shapeMap.get(e);t&&t.setProps({display:!0})},o.hideShape=function(e){this.activeShapeBoxId=e;var t=this.shapeMap.get(e);t&&t.setProps({display:!1})},o.show=function(){this.board.style.display="block"},o.hide=function(){this.board.style.display="none"},o.dispose=function(){e.prototype.dispose.call(this),this.board.remove()},t}(y.JT),b=o(39282),E=o(28280),x=o(55690),D=function(){function e(){this.shapeMap=new Map}var t=e.prototype;return t.getShapeData=function(e){var t=this.shapeMap.get(e);return t||null},t.addShapeData=function(e){var t=e.shape,o=e.position,i=e.display,n=t.id;return this.shapeMap.get(n)?(console.error("shape已经在shapeStage中"),!1):(this.shapeMap.set(n,{shape:t,position:o,display:i}),!0)},t.updateShapeData=function(e,t){var o=this.shapeMap.get(e);return o?(void 0!==t.shape&&(o.shape=t.shape),void 0!==t.position&&(o.position=t.position),void 0!==t.display&&(o.display=t.display),!0):this.addShapeData(t)},t.removeShapeData=function(e){return!!this.shapeMap.get(e)&&(this.shapeMap.delete(e),!0)},e}(),L=o(20589),A=o.n(L),C=o(85624),I=o(84415);function V(e,t,o){var i={};if(void 0!==t.position&&(i.left=t.position.left*o,i.top=t.position.top*o),void 0!==t.shape){i.width=t.shape.position.overlayPosition.widthPixels*o>>0,i.height=t.shape.position.overlayPosition.heightPixels*o>>0,i.zIndex=t.shape.position.overlayPosition.zIndex,i.clipInfo={clipTop:t.shape.clipInfo.clipTop*o,clipRight:t.shape.clipInfo.clipRight*o,clipBottom:t.shape.clipInfo.clipBottom*o,clipLeft:t.shape.clipInfo.clipLeft*o},i.url=t.shape.url;var n=t.shape.position.overlayPosition.anchorCell,r=n.rowIndex,a=n.colIndex;(e.isRowHidden(r)||e.isColHidden(a))&&(i.display=!1)}return i}var R=function(e){function t(t,o,i){var n;return(n=e.call(this)||this).spreadsheet=t,n.dataCallView=o,n.spreadsheetView=i,n.viewShapeData=new D,n.focusEmitter=new E.Q5,n.setTimeoutThrottledUpdate=A()((function(){n.updateAll()}),30),n.promiseThrottledUpdate=(0,I.ad)((function(){n.updateAll()})),n.addShape=function(e){var t=n._getImageViewData(e);if(!t||t.shape.type===x.EMBEDDED_OBJECT_TYPE.CELL_IMAGE)return!1;if(!n.viewShapeData.addShapeData(t))return!1;var o=V(n.spreadsheet.activeSheet,t,n.spreadsheetView.scale.scale);return n.topLeft.addShape(t.shape.id,o),n.topRight.addShape(t.shape.id,o),n.bottomLeft.addShape(t.shape.id,o),n.bottomRight.addShape(t.shape.id,o),!0},n.updateShape=function(e){var t=n._getImageViewData(e);if(!t)return!1;if(t.shape.type===x.EMBEDDED_OBJECT_TYPE.CELL_IMAGE)return n.viewShapeData.getShapeData(e)&&n.removeShape(e),!0;if(!n.viewShapeData.updateShapeData(e,t))return!1;var o=V(n.spreadsheet.activeSheet,t,n.spreadsheetView.scale.scale);return n.topLeft.updateShape(e,o),n.topRight.updateShape(e,o),n.bottomLeft.updateShape(e,o),n.bottomRight.updateShape(e,o),!0},n.hideShape=function(e){n.topLeft.hideShape(e),n.topRight.hideShape(e),n.bottomLeft.hideShape(e),n.bottomRight.hideShape(e)},n.showShape=function(e){n.topLeft.showShape(e),n.topRight.showShape(e),n.bottomLeft.showShape(e),n.bottomRight.showShape(e)},n.removeShape=function(e){n.viewShapeData.removeShapeData(e)?(n.topLeft.removeShape(e),n.topRight.removeShape(e),n.bottomLeft.removeShape(e),n.bottomRight.removeShape(e)):console.warn("DOM不存在，imageId: ",e)},n._handleFocus=function(e){n.focusEmitter.fire(e)},n.updateAll=function(){n.spreadsheet.activeSheet.imageManager.each((function(e,t){e.type!==x.EMBEDDED_OBJECT_TYPE.CELL_IMAGE&&n.updateShape(t)}))},n.onFocus=n.focusEmitter.event,n.topLeft=n._register(new S(n.spreadsheetView.mainBoard.top.left,n._handleFocus)),n.topRight=n._register(new S(n.spreadsheetView.mainBoard.top.right,n._handleFocus)),n.bottomLeft=n._register(new S(n.spreadsheetView.mainBoard.bottom.left,n._handleFocus)),n.bottomRight=n._register(new S(n.spreadsheetView.mainBoard.bottom.right,n._handleFocus)),n._register(n.spreadsheetView.areaData.row.frozen.onUpdateViewSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.row.flow.onUpdateViewSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.col.frozen.onUpdateViewSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.col.flow.onUpdateViewSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.row.frozen.onUpdateTotalSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.row.flow.onUpdateTotalSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.col.frozen.onUpdateTotalSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.col.flow.onUpdateTotalSize(n.promiseThrottledUpdate)),n._register(n.spreadsheetView.areaData.onUpdateOffset(n.setTimeoutThrottledUpdate)),n._recalculateListener=n._register(new b.Z({dataCallView:n.dataCallView,spreadsheet:n.spreadsheet,addEmbeddedObject:n.addShape,updateEmbeddedObject:n.updateShape,removeEmbeddedObject:n.removeShape,hideEmbeddedObject:n.hideShape,showEmbeddedObject:n.showShape})),n}(0,i.Z)(t,e);var o=t.prototype;return o.refresh=function(){var e=this;this.viewShapeData.shapeMap.forEach((function(t,o){return e.removeShape(o)})),this.spreadsheet.activeSheet.imageManager.each((function(t,o){e.addShape(o)}))},o.show=function(){this.topLeft.show(),this.topRight.show(),this.bottomLeft.show(),this.bottomRight.show()},o.hide=function(){this.topLeft.hide(),this.topRight.hide(),this.bottomLeft.hide(),this.bottomRight.hide()},o._getImageViewData=function(e){var t=this.spreadsheet.activeSheet.imageManager.getImage(e);return t?(0,C.qo)(this.spreadsheet.parent,this.spreadsheet.activeSheetId)?null:{shape:t,position:function(e,t,o){var i=o.overlayPosition.anchorCell,n=i.colIndex,r=i.rowIndex,a=t.isColHidden(n)?0:o.overlayPosition.offsetXpixels,s=t.isRowHidden(r)?0:o.overlayPosition.offsetYpixels;return{left:e.getGlobalLeftByCol(n)+a,top:e.getGlobalTopByRow(r)+s}}(this.spreadsheetView.areaData,this.spreadsheetView.rowcolAccessor,t.position)}:null},t}(y.JT)},39282:function(e,t,o){var i=o(13504),n=o(84415),r=function(e){function t(t){var o;return(o=e.call(this)||this)._updateAll=(0,n.ad)((function(e){o.isCurrentSheet(e)&&o._spreadsheet.activeSheet.imageManager.each((function(e,t){o._updateEmbeddedObject(t)}))})),o._rowVisibleChange=function(e){if(o.isCurrentSheet(e)){var t=e.ranges;o._spreadsheet.activeSheet.imageManager.each((function(e,i){for(var n=e.position.overlayPosition.anchorCell.rowIndex,r=0;r<t.length;r++){var a=t[r];if(n>=a.startIndex&&n<=a.endIndex)return void(o._spreadsheet.activeSheet.isRowHidden(n)?o._hideEmbeddedObject(i):o._showEmbeddedObject(i))}}))}},o._colVisibleChange=function(e){if(o.isCurrentSheet(e)){var t=e.ranges;o._spreadsheet.activeSheet.imageManager.each((function(e,i){for(var n=e.position.overlayPosition.anchorCell.colIndex,r=0;r<t.length;r++){var a=t[r];if(n>=a.startIndex&&n<=a.endIndex)return void(o._spreadsheet.activeSheet.isColHidden(n)?o._hideEmbeddedObject(i):o._showEmbeddedObject(i))}}))}},o._dataCallView=t.dataCallView,o._spreadsheet=t.spreadsheet,o._addEmbeddedObject=t.addEmbeddedObject,o._updateEmbeddedObject=t.updateEmbeddedObject,o._deleteEmbeddedObject=t.removeEmbeddedObject,o._hideEmbeddedObject=t.hideEmbeddedObject,o._showEmbeddedObject=t.showEmbeddedObject,o._register(o._dataCallView.onAddEmbeddedObject(o._addEmbeddedObject)),o._register(o._dataCallView.onUpdateEmbeddedObject(o._updateEmbeddedObject)),o._register(o._dataCallView.onDeleteEmbeddedObject(o._deleteEmbeddedObject)),o._register(o._dataCallView.onInsertCol(o._updateAll)),o._register(o._dataCallView.onInsertRow(o._updateAll)),o._register(o._dataCallView.onDeleteCol(o._updateAll)),o._register(o._dataCallView.onDeleteRow(o._updateAll)),o._register(o._dataCallView.onSetColVisible(o._colVisibleChange)),o._register(o._dataCallView.onSetRowVisible(o._rowVisibleChange)),o._register(o._dataCallView.onSetColWidth(o._updateAll)),o._register(o._dataCallView.onSetRowHeight(o._updateAll)),o}return(0,i.Z)(t,e),t.prototype.isCurrentSheet=function(e){return e.sheetId===this._spreadsheet.activeSheetId},t}(o(76138).JT);t.Z=r},26731:function(e,t,o){o.d(t,{x:function(){return a}});var i=o(11376),n=o(63313),r=o.n(n),a=function(){var e=(0,n.useRef)(null),t=(0,n.useState)(!1),o=t[0],a=t[1];return(0,n.useEffect)((function(){if(e.current){var t=e.current,o=t.clientHeight,i=t.clientWidth;a(!(o<108||i<200))}})),r().createElement("div",{ref:e,className:"loading-failed-pic-placeholder"},r().createElement("div",{className:"loading-failed-pic-placeholder-icon"}),r().createElement("div",{style:{display:o?"block":"none"},className:"loading-failed-pic-placeholder-tip"},i.ZP.t("图片加载失败，请稍后再试。")))}},26137:function(e,t,o){var i=o(13504),n=o(72565),r=o(80067),a=o(76138),s=o(28280),l=o(13423),c=function(e){function t(t,o){var i;return(i=e.call(this)||this).slideOperate=t,i.spreadsheetView=o,i._startSlideDispose=null,i._endSlideDispose=null,i._endFps=(0,r.Ds)((function(){var e;n.Z.end("fps_scroll"),null===(e=i._endSlideDispose)||void 0===e||e.dispose(),i._endSlideDispose=null,i._startSlideDispose=i._onceSlide(i._startFps)}),100),i._handleSlide=function(e){var t=i.spreadsheetView.areaData;t.row.flow.setOffsetSize(t.row.flow.offsetSize-e.y,l.oz.USER),t.col.flow.setOffsetSize(t.col.flow.offsetSize-e.x,l.oz.USER)},i._startFps=function(){n.Z.start("fps_scroll"),i._startSlideDispose=null,i._endSlideDispose=i.slideOperate.onSlide(i._endFps)},i._onceSlide=s.ju.once(i.slideOperate.onSlide),i._startSlideDispose=i._onceSlide(i._startFps),i._register(i.slideOperate.onSlide(i._handleSlide)),i}return(0,i.Z)(t,e),t.prototype.dispose=function(){var t,o;e.prototype.dispose.call(this),null===(t=this._startSlideDispose)||void 0===t||t.dispose(),null===(o=this._endSlideDispose)||void 0===o||o.dispose()},t}(a.JT);t.Z=c},47497:function(e,t,o){var i=o(13504),n=(o(38934),o(77468),o(14831)),r=o.n(n),a=o(66649),s=o(28280),l=o(76138),c=o(96172),h=o(4175),d=Math.cos(.25*Math.PI),u=6e-4,f=function(e){function t(t){var o;return(o=e.call(this)||this).spreadsheetView=t,o.ipadWheelData={currX:0,currY:0},o.continueMotionPoints=[],o.onSlideEmitter=new s.Q5,o.cacheData={x:0,y:0},o.handleMousedown=function(){o.cancelAnimationFrame()},o.handleWheel=function(e){switch(e.state){case"begin":o.handleWheelStart(e);break;case"change":o.handleWheelMove(e);break;case"end":o.handleWheelEnd()}},o.handleWheelStart=function(e){cancelAnimationFrame(o.requestTickID),o.ipadWheelData.currX=e["location.x"],o.ipadWheelData.currY=e["location.y"]},o.handleWheelMove=function(e){o.cacheData.x=e["location.x"]-o.ipadWheelData.currX,o.cacheData.y=e["location.y"]-o.ipadWheelData.currY,o.ipadWheelData.currX=e["location.x"],o.ipadWheelData.currY=e["location.y"],o.continueMotionPoints.length>10&&o.continueMotionPoints.shift(),o.continueMotionPoints.push({x:e["location.x"],y:e["location.y"],time:performance.now()}),o.onSlideEmitter.fire(o.cacheData)},o.handleWheelEnd=function(){o.checkAndInertiaScroll()},o.handleTouchstart=function(){var e=o.spreadsheetView.operateContext.operateData;o.cancelAnimationFrame(),o.isReachHorizontalEdge=!1,o.isReachVerticalEdge=!1,o.continueMotionPoints=[{x:e.currX,y:e.currY,time:performance.now()}],document.body.addEventListener("touchmove",o.handleTouchmove),document.body.addEventListener("touchend",o.handleTouchend),document.body.addEventListener("touchcancel",o.handleTouchend),a.Jn.sendEvent("sheet","sheet_r_start_slide")},o.handleTouchmove=function(){var e=o.spreadsheetView.operateContext.operateData;e.fingerData.mode===c.w.MOVE&&(o.cacheData.x=e.diffX,o.cacheData.y=e.diffY,o.continueMotionPoints.length>=12&&o.continueMotionPoints.shift(),o.continueMotionPoints.push({x:e.currX,y:e.currY,time:performance.now()}),o.onSlideEmitter.fire(o.cacheData))},o.handleTouchend=function(){var e=o.spreadsheetView.operateContext.operateData;o.continueMotionPoints.push({x:e.currX,y:e.currY,time:performance.now()}),e.fingerData.mode===c.w.IDLE&&(o.checkAndInertiaScroll(),document.body.removeEventListener("touchmove",o.handleTouchmove),document.body.removeEventListener("touchend",o.handleTouchend),document.body.removeEventListener("touchcancel",o.handleTouchend)),o.continueMotionPoints=[],a.Jn.sendEvent("sheet","sheet_r_end_slide")},o.onSlide=o.onSlideEmitter.event,o.addEvent(),h.ZP.sheetsBar.listen("switchSheet",(function(){o.cancelAnimationFrame()})),o}(0,i.Z)(t,e);var n=t.prototype;return n.cancelAnimationFrame=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){cancelAnimationFrame(this.requestTickID)})),n.dispose=function(){e.prototype.dispose.call(this),this.removeEvent()},n.addEvent=function(){var e;this.spreadsheetView.container.addEventListener("touchstart",this.handleTouchstart),this.spreadsheetView.container.addEventListener("mousedown",this.handleMousedown),r().isIPad&&r().isTencentDocsApp&&(null===(e=o.g.mqq)||void 0===e||e.addEventListener("ipadWheelEvent",this.handleWheel))},n.removeEvent=function(){var e;this.spreadsheetView.container.removeEventListener("touchstart",this.handleTouchstart),this.spreadsheetView.container.removeEventListener("mousedown",this.handleMousedown),r().isIPad&&r().isTencentDocsApp&&(null===(e=o.g.mqq)||void 0===e||e.removeEventListener("ipadWheelEvent",this.handleWheel))},n.checkAndInertiaScroll=function(){var e=this.getCurrentSpeed(),t=e[0],o=e[1],i=e[2];if(!(t<.04)){var n=.72*t,r=n*n/.0012,a=Math.round(t/u);this.lastScrollDistance=0,this.startInertiaScroll(r,Math.abs(o)<d?0:o,Math.abs(i)<d?0:i,a)}},n.getCurrentSpeed=function(){if(this.continueMotionPoints.length<4)return[0];var e=this.continueMotionPoints[0],t=this.continueMotionPoints[this.continueMotionPoints.length-1],o=t.x-e.x,i=t.y-e.y,n=Math.sqrt(o*o+i*i);return[n/(t.time-e.time),o/n,i/n]},n.startInertiaScroll=function(e,t,o,i){var n,r=this,a=Date.now();this.requestTickID=requestAnimationFrame((function s(){var l=Date.now()-a;l>=i?r.updateInertiaScrollStep(e,t,o):(n=e*function(e){var t=e-1;return 1-t*t*t*t}(l/i),e-n<.33||(r.updateInertiaScrollStep(n,t,o),r.checkEdge(),r.isReachHorizontalEdge&&r.isReachVerticalEdge||(r.requestTickID=requestAnimationFrame(s))))}))},n.updateInertiaScrollStep=function(e,t,o){var i=(e-this.lastScrollDistance)*t,n=(e-this.lastScrollDistance)*o;this.cacheData.x=this.isReachHorizontalEdge?0:i,this.cacheData.y=this.isReachVerticalEdge?0:n,this.lastScrollDistance=e,this.onSlideEmitter.fire(this.cacheData)},n.checkEdge=function(){var e=this.spreadsheetView.areaData.col.flow,t=e.offsetSize,o=e.maxOffsetSize,i=this.spreadsheetView.areaData.row.flow,n=i.offsetSize,r=i.maxOffsetSize;0!==t&&t!==o||(this.isReachHorizontalEdge=!0),0!==n&&n!==r||(this.isReachVerticalEdge=!0)},t}(l.JT);t.Z=f},58218:function(e,t,o){var i=o(13504),n=o(72565),r=o(80067),a=o(28280),s=o(76138),l=o(13423),c=function(e){function t(t,o){var i;return(i=e.call(this)||this).wheelOperate=t,i.spreadsheetView=o,i._startFpsDispose=null,i._endFpsDispose=null,i._endFps=(0,r.Ds)((function(){var e;n.Z.end("fps_scroll"),null===(e=i._endFpsDispose)||void 0===e||e.dispose(),i._endFpsDispose=null,i._startFpsDispose=i._onceScroll(i._startFps)}),100),i._handleScroll=function(e){var t=i.spreadsheetView.areaData;t.row.flow.setOffsetSize(t.row.flow.offsetSize-e.y,l.oz.USER),t.col.flow.setOffsetSize(t.col.flow.offsetSize-e.x,l.oz.USER)},i._startFps=function(){n.Z.start("fps_scroll"),i._startFpsDispose=null,i._endFpsDispose=i.wheelOperate.onScroll(i._endFps)},i._onceScroll=a.ju.once(i.wheelOperate.onScroll),i._startFpsDispose=i._onceScroll(i._startFps),i._register(i.wheelOperate.onScroll(i._handleScroll)),i}return(0,i.Z)(t,e),t.prototype.dispose=function(){var t,o;e.prototype.dispose.call(this),null===(t=this._startFpsDispose)||void 0===t||t.dispose(),null===(o=this._endFpsDispose)||void 0===o||o.dispose()},t}(s.JT);t.Z=c},63192:function(e,t,o){var i=o(13504),n=(o(38934),o(31688),o(5113)),r=o(28280),a=o(76138),s=o(24352),l=.3,c=function(e){function t(t,o){var i;return(i=e.call(this)||this).spreadsheetView=t,i.containers=o,i.onScrollEmitter=new r.Q5,i._smoothScrollY=!1,i._smoothScrollX=!1,i._eventName="",i._stopResponse=!1,i._handleMouseScrollEventForFirefox=function(e){if(!i._stopResponse){var t=0,o=0;if("wheel"===e.type)t=e.deltaX,o=e.deltaY,1===e.deltaMode?n.V5?(0!==o&&(o=o>0?Math.max(10,Math.min(10*o,80)):Math.min(-10,Math.max(10*o,-80))),0!==t&&(t=t>0?Math.max(10,Math.min(10*t,80)):Math.min(-10,Math.max(10*t,-80)))):(0!==o&&(o=o>0?Math.max(20,Math.min(20*o,100)):Math.min(-20,Math.max(20*o,-100))),0!==t&&(t=t>0?Math.max(20,Math.min(20*t,100)):Math.min(-20,Math.max(20*t,-100)))):(o*=l,t*=l),i._scrollByPixel(-t,-o,e.shiftKey);else{var r=e.axis,a=e.detail>0?Math.max(10,Math.min(10*e.detail,80)):Math.min(-10,Math.max(10*e.detail,-80));1===r?i._scrollByPixel(-a,0):i._scrollByPixel(0,-a)}e.preventDefault()}},i._handleMouseScrollEventForNormal=function(e){if(!i._stopResponse){var t=0,o=0;void 0!==e.deltaY?t=-e.deltaY:void 0!==e.wheelDeltaY?t=e.wheelDeltaY:e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-e.detail),void 0!==e.wheelDeltaX?o=e.wheelDeltaX:void 0!==e.deltaX&&(o=-e.deltaX);var n=2*s.DEFAULT_ROW_HEIGHT;i._smoothScrollY||0===t||t%120!==0?(i._smoothScrollY=!0,t*=l):t=Math.ceil(t/120)*n,i._smoothScrollX||0===o||o%120!==0?(i._smoothScrollX=!0,o*=l):o=Math.ceil(o/120)*n,i._scrollByPixel(o,t,e.shiftKey),e.preventDefault()}},i._handleMousedown=function(){i._stopResponse=!0,document.addEventListener("mouseup",i._handleMouseup,!0)},i._handleMouseup=function(){i._stopResponse=!1,document.removeEventListener("mouseup",i._handleMouseup,!0)},i.onScroll=i.onScrollEmitter.event,i._addEvent(),i}(0,i.Z)(t,e);var o=t.prototype;return o.dispose=function(){e.prototype.dispose.call(this),this._removeEvent()},o._addEvent=function(){var e=this;this.containers.forEach((function(t){if(n.tH){var o="onwheel"in document.createElement("div")?"wheel":"DOMMouseScroll";e._eventName=o,t.addEventListener(o,e._handleMouseScrollEventForFirefox)}else{var i;i="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e._eventName=i,t.addEventListener(i,e._handleMouseScrollEventForNormal)}t.addEventListener("mousedown",e._handleMousedown,!0)}))},o._removeEvent=function(){var e=this;this.containers.forEach((function(t){""!==e._eventName&&(n.tH?t.removeEventListener(e._eventName,e._handleMouseScrollEventForFirefox):t.removeEventListener(e._eventName,e._handleMouseScrollEventForNormal),t.removeEventListener("mousedown",e._handleMousedown,!0))}))},o._scrollByPixel=function(e,t,o){var i=this;void 0===o&&(o=!1);var n={x:e,y:t};o&&0!==n.y&&(n.x=n.y,n.y=0),window.requestAnimationFrame((function(){i.onScrollEmitter.fire(n)}))},t}(a.JT);t.Z=c}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_core_part_3.ed5ed57c17a2970d04f3.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_core_part_3.ed5ed57c17a2970d04f3.js.map