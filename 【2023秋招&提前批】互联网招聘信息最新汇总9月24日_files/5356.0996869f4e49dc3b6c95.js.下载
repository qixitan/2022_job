self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[5356],{17796:function(){},12241:function(t,e,n){"use strict";n(52865),n(38934),n(85932),n(57447),n(12024),n(81502),n(15770),n(84919),n(26894),n(71091),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(31973),o=n(14831),i=n.n(o),a=n(80067),s=n(68218),u=n(20445),c=n(35103),l=n(8326);function h(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var f=l.Z.getConfig("custom.standaloneLinks.report_sentry_3641"),p=l.Z.getConfig("custom.standaloneLinks.report_sentry_4136"),v=(0,a.IZ)("currentEnv"),g=[{test:function(t){var e=null===t||void 0===t?void 0:t.culprit;return e&&/smart-?sheet/.test(e)},dsn:p,project:"4136"},{test:function(){return!0},dsn:f,project:"3641"}];try{v?window.Raven&&Raven.setTagsContext({plantform:i().isMobilePhone||i().isAndroidPad?"mobile":"pc",uid:(0,s.getUid)(),currentEnv:v}):window.Raven&&Raven.setTagsContext({plantform:i().isMobilePhone||i().isAndroidPad?"mobile":"pc",uid:(0,s.getUid)()})}catch(m){console.warn(m)}var y=["cefQuery","playBackgroundMusic","setKeyboardHeight","test","showTips","ExecuteJsInterface","x5onSkinSwitch","WeixinJSBridge","ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications.","root node can only insert VLine","root node cannot be removed"];window.__jsErrorCount=0,window.addEventListener("error",(function(t){var e,o,i,a,s,c=(null===t||void 0===t?void 0:t.message)||"",l=(null===(e=null===t||void 0===t?void 0:t.error)||void 0===e?void 0:e.stack)||"";if(!function(t){var e;y.some((function(e){return t.match(e)}));for(var n,r=h(y);!(n=r()).done;){var o=n.value;if(t.match(o))return!0}var i=null===(e=window.navigator.userAgent.match(/Chrome\/([\d]+)/i))||void 0===e?void 0:e[1];return i&&i<=53}(c)&&(window.__jsErrorCount=window.__jsErrorCount+1,1===window.__jsErrorCount)){var d=encodeURIComponent(c);r.ZP.tdwSingleReport({opername:"quality_doc",module:"excel_detail",action:"js_error",ver8:d,ver9:l.substring(0,150),ver10:window.__globalReleaseVersion||(null===(o=window.__DWS_INFO__)||void 0===o?void 0:o.releaseVersion)});var f=["append","getBoundingClientRect","Script%20error","rcsOptimizeReady"].findIndex((function(t){return d.includes(t)}));r.ZP.zzsStatus({attrid:u.CORE_LINK_ZZS_POINTER.JS_ERROR,status:1,dimensions:f}),f>=0&&(null===(i=window.log)||void 0===i||i.info("error stack",null===(a=null===t||void 0===t?void 0:t.error)||void 0===a?void 0:a.stack,null===t||void 0===t?void 0:t.message),null===(s=n.g.log)||void 0===s||s.report(u.PROACTIVE_REPORT_ERROR))}})),window.Raven&&Raven.config(f,{release:window.__globalReleaseVersion,ignoreErrors:["cefQuery","playBackgroundMusic","setKeyboardHeight","Cannot read property 'test' of undefined","setKeyboardHeight","showTips","ExecuteJsInterface","Changeset","ResizeObserver loop limit exceeded"],sampleRate:.1,shouldSendCallback:function(){var t;return!!(null===(t=window.__globalReleaseVersion)||void 0===t?void 0:t.match("(release-|hotfix-|master-|feature-share_team|feature-team_)"))&&!(window.__jsErrorCount>9)},dataCallback:function(t){var e;if(g&&g.length>0)for(var n=0;n<g.length;n++){var r=g[n];if(null===(e=r.test)||void 0===e?void 0:e.call(r,t)){t.project!==r.project&&(window.Raven.setDSN(r.dsn),t.project=r.project);break}}return c.ZP.xlog(t)}}).install()},98264:function(t,e,n){"use strict";n(36156);var r,o=n(8326);null===(r=window.log)||void 0===r||r.init(2,{sdkUrl:o.Z.getConfig("custom.standaloneLinks.weblog_sdk_url"),release:window.artifactProperties.releaseVersion}).then((function(t){}))},27829:function(t,e,n){"use strict";n.d(e,{$F:function(){return s},IF:function(){return a}}),n(38934),n(84919),n(62883),n(77468);var r=function(){},o={};["report","info","error"].forEach((function(t){o[t]||(o[t]=r)})),o=window.log?window.log:o;var i=function(){function t(t,e){this.isChecked=!1,this.name=t,this.options=e,this.hasFinished=!1,this.startTs=0,this.endTs=0,this.nextTickTs=0,this.isCheckedWithError=!1}var e=t.prototype;return e._check=function(){var t,e,r=this.name,i=this.options,a=(void 0===i?{}:i).runNextTick,s=this.isChecked,u=r+"_nextTick",c=Number(new Date);this.nextTickTs=c,null===(t=n.g.__ws)||void 0===t||t.trigger("checkerData",{n:r,t:"nextTick",ts:c,flag:s}),this.hasFinished=!0,o.info(u,{flag:s}),s||null===(e=n.g.__ws)||void 0===e||e.trigger("checkerError"),null===a||void 0===a||a(s)},e.start=function(){var t,e=this,r=this.name,i=this.options,a=(void 0===i?{}:i).withCatchError,s=r+"_start";o.info(s);var u=Number(new Date);this.startTs=u,null===(t=n.g.__ws)||void 0===t||t.trigger("checkerData",{n:r,t:"start",ts:u}),a||setTimeout((function(){e._check()}),0)},e.end=function(){var t;if(!this.isCheckedWithError){this.isChecked=!0;var e=this.name,r=this.options.withCatchError,i=e+"_end",a=Number(new Date);this.endTickTs=a,null===(t=n.g.__ws)||void 0===t||t.trigger("checkerData",{n:e,t:"end",ts:a}),o.info(i),r&&this._check()}},e.endWithError=function(t){var e;if(!this.isChecked){this.isCheckedWithError=!0;var r=this.name,i=this.options.withCatchError,a=Number(new Date),s="";try{s=t.toString()}catch(u){}null===(e=n.g.__ws)||void 0===e||e.trigger("checkerData",{n:r,t:"endWithError",ts:a,msg:s}),o.error("[init error]",s,null===t||void 0===t?void 0:t.stack),i&&this._check()}},t}(),a=new i("canvas",{nextTick:{},common:{reportKeyPrefix:"EXCEL_CHECKER_"},runNextTick:function(t){var e;t&&(null===(e=n.g.__ws)||void 0===e||e.trigger("firstScreenFinish"))}}),s=new i("coresheet",{nextTick:{},common:{reportKeyPrefix:"EXCEL_CHECKER_"}})},51778:function(t,e,n){"use strict";n.d(e,{o:function(){return c}});var r=n(58926),o=n(2759),i=(n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770),n(9475)),a=n(72104);function s(){s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(O){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var v={};u(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,u(m,"constructor",p),u(p,"constructor",f),f.displayName=u(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),u(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,a,"Generator"),u(m,o,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var u=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},c=function(){function t(t){this.source=t,this.loaded=!1,this.initialized=!1,this.instance=null,this.emitter=new a.Z}var e=t.prototype;return e.saveParam=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.params=e},e.load=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(this,void 0,void 0,s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.ZP.getModule(this.source);case 2:return this.module=t.sent,this.loaded=!0,this.params=e,t.abrupt("return",this.module);case 6:case"end":return t.stop()}}),t,this)})))},e.createInstance=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i;return u(this,void 0,void 0,s().mark((function t(){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=this.module.default;try{this.instance=(0,o.Z)(r,e)}catch(a){null===(i=n.g.log)||void 0===i||i.error("Loader.createInstance error",null===a||void 0===a?void 0:a.stack)}return this.initialized=!0,t.abrupt("return",this.instance);case 4:case"end":return t.stop()}}),t,this)})))},e.init=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return u(this,void 0,void 0,s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isIniting=!0,e.next=3,this.load();case 3:return this.createInstance.apply(this,n),this.params=n,this.emitter.emit(t.EVENT_NAME.LOADED,this.instance),this.isIniting=!1,e.abrupt("return",this.instance);case 8:case"end":return e.stop()}}),e,this)})))},e.getInstance=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return u(this,void 0,void 0,s().mark((function e(){var o=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return u(o,void 0,void 0,s().mark((function o(){return s().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.initialized){o.next=2;break}return o.abrupt("return",e(this.instance));case 2:if(!this.loaded){o.next=5;break}return this.createInstance.apply(this,(0,r.Z)(this.params||n)),o.abrupt("return",e(this.instance));case 5:this.emitter.on(t.EVENT_NAME.LOADED,(function(t){e(t)})),this.isIniting||this.init.apply(this,(0,r.Z)(this.params||n));case 7:case"end":return o.stop()}}),o,this)})))})));case 1:case"end":return e.stop()}}),e)})))},e.then=function(t){return u(this,void 0,void 0,s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getInstance();case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e,this)})))},t}();c.EVENT_NAME={LOADED:"LOADED"}},78801:function(t,e,n){"use strict";n.d(e,{L:function(){return A},S:function(){return N}}),n(53248),n(38934),n(63240);var r=n(78888),o=n(30526),i=n(38574),a=n(21488),s=n(32263),u=(n(12024),n(81502),n(15770),n(84919),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144),n(28280)),c=n(38808),l=n(66544),h=n(4175);function d(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var p,v=[c.ZP.SET_DIMENSION_PROPERTIES_MUTATION,c.ZP.SET_RANGE_MUTATION,c.ZP.SET_CELL_PROPERTIES_MUTATION,c.ZP.MERGE_CELLS_MUTATION,c.ZP.UNMERGE_CELLS_MUTATION,c.ZP.DEFINE_SHEET_RANGE_MUTATION,c.ZP.DELETE_SHEET_RANGE_MUTATION,c.ZP.UPDATE_SHEET_RANGE_MUTATION,c.ZP.COPY_PASTE_MUTATION,c.ZP.REORDER_RANGE_MUTATION,c.ZP.UPDATE_FILTER_MUTATION,c.ZP.ADD_CONDITIONAL_FORMAT_MUTATION,c.ZP.DELETE_CONDITIONAL_FORMAT_MUTATION,c.ZP.UPDATE_CONDITIONAL_FORMAT_MUTATION,c.ZP.DEFINE_WORKBOOK_RANGE_MUTATION,c.ZP.UPDATE_WORKBOOK_RANGE_MUTATION],g=[c.ZP.UPDATE_FILTERS_MODEL_MUTATION,c.ZP.ADD_EMBEDDED_OBJECT_MUTATION,c.ZP.DELETE_EMBEDDED_OBJECT_MUTATION,c.ZP.UPDATE_EMBEDDED_OBJECT_MUTATION,c.ZP.UPDATE_ALL_SHEETS_MUTATION,c.ZP.SET_WORKBOOK_PROPERTIES_MUTATION,c.ZP.INIT_DATA_MUTATION,c.ZP.MAP_RANGE_MUTATION,c.ZP.EMPTY_MUTATION,c.ZP.DELETE_WORKBOOK_RANGE_MUTATION,c.ZP.NEW_ADD_EMBEDDED_OBJECT_MUTATION,c.ZP.NEW_DELETE_EMBEDDED_OBJECT_MUTATION,c.ZP.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION],y=[c.ZP.INSERT_DIMENSION_MUTATION,c.ZP.DELETE_DIMENSION_MUTATION,c.ZP.DEFINE_FILTER_MUTATION,c.ZP.DELETE_FILTER_MUTATION,c.ZP.SWITCH_FILTER_SYNC_MUTATION,c.ZP.ADD_FILTER_VIEW_MUTATION,c.ZP.DELETE_FILTER_VIEW_MUTATION,c.ZP.UPDATE_FILTER_VIEW_MUTATION,c.ZP.ACTIVE_FILTER_VIEW_MUTATION],m=[c.ZP.INSERT_SHEET_MUTATION,c.ZP.DELETE_SHEET_MUTATION,c.ZP.MOVE_SHEET_MUTATION,c.ZP.SET_SHEET_PROPERTIES_MUTATION];!function(t){t.dataCallWorkbench="dataCallWorkbench"}(p||(p={}));var E,w=function(){function t(t){this.app=t,this.onWorkbenchChangeEmitter=new u.Q5({name:p.dataCallWorkbench}),this.onWorkbenchChange=this.onWorkbenchChangeEmitter.event,this.init()}var e=t.prototype;return e.init=function(){this.initMutationListener(),this.initDoRedoListener()},e.initMutationListener=function(){var t,e=this;null===(t=this.app.mutationBehavior)||void 0===t||t.emitter.addListener(this.app.mutationBehavior.EVENT.DATA_CHANGE,(function(t){var n=t.mutation;e.shouldUpdateWorkbench(n)&&e.onWorkbenchChangeEmitter.fire()}))},e.initDoRedoListener=function(){var t=this;h.ZP.spreadsheetEvent.listen(l.W1.DATA_CHANGE,(function(e){"syncndoredoStack"===(null===e||void 0===e?void 0:e.type)&&t.onWorkbenchChangeEmitter.fire()}))},e.shouldUpdateWorkbench=function(t){return!g.includes(t.id)&&(!!m.includes(t.id)||(y.includes(t.id)?this.isAffectedSheetId(t):!!v.includes(t.id)&&this.isAffectedRange(t)))},e.isAffectedRange=function(t){for(var e,n=t.getAffectedGridRanges(),r=this.app.view.getSelectionWithGridRanges().rangeSelections,o=!1,i=d(n);!(e=i()).done;){for(var a,s=e.value,u=d(r);!(a=u()).done;){var c=a.value;if(s.contain(c)){o=!0;break}}if(o)break}return o},e.isAffectedSheetId=function(t){var e,n=null===(e=this.app.sheetStatus.getActiveSheetStatus())||void 0===e?void 0:e.sheetId;return t.getAffectedSheetId()===n},t}(),S=n(20589),T=n.n(S),I=n(56584);!function(t){t.selectionCallWorkbench="selectionCallWorkbench"}(E||(E={}));var _,b,R,O=function(){function t(t,e){this.app=t,this.sheetStatus=e,this.onWorkbenchChangeEmitter=new u.Q5({name:E.selectionCallWorkbench}),this.onWorkbenchChange=this.onWorkbenchChangeEmitter.event,this.init()}return t.prototype.init=function(){var t=this;this.app.view.canvas.normalSelectData.onModifySelectData(T()((function(){t.onWorkbenchChangeEmitter.fire()}),I.bU)),this.sheetStatus.change((function(){t.onWorkbenchChangeEmitter.fire()}))},t}(),x=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},C=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},L=function(t,e){return function(n,r){e(n,r,t)}},A="spreadSheetAdapter",N=function(){function t(t,e,n){var r=this;this.sheetStatus=t,this.app=e,this.spreadsheetView=n,this.app.view.canvas.spreadsheetView.resize.onResize((function(){r.resize()})),this.dataCallWorkbench=new w(e),this.selectionCallWorkbench=new O(e,t)}var e=t.prototype;return e.attachEditor=function(t,e){this.bindCallBacks(e);var n=document.getElementById("mainContainer");if(n)return this.resize(),t.appendChild(n),this.app},e.setValue=function(){},e.requestFocus=function(){this.app.view.canvas.inputManager.focus()},e.requestBlur=function(){},e.isCaret=function(){return!1},e.destroy=function(){},e.resize=function(){var t=document.getElementById("workbenchContainer");t&&(t.style.height="calc(100% - "+(0,a.x)()+"px)")},e.bindCallBacks=function(t){this.selectionCallWorkbench.onWorkbenchChange((function(){t.onDataChange()})),this.dataCallWorkbench.onWorkbenchChange((function(){t.onDataChange()}))},t}();N=x([(0,r.L)(A),L(0,i.T),L(1,o.m),L(2,s.Z),C("design:paramtypes",["function"===typeof(_="undefined"!==typeof i.T&&i.T)?_:Object,"function"===typeof(b="undefined"!==typeof o.m&&o.m)?b:Object,"function"===typeof(R="undefined"!==typeof s.Z&&s.Z)?R:Object])],N)},30526:function(t,e,n){"use strict";n.d(e,{m:function(){return r}});var r=(0,n(76138).yh)("ISpreadsheetApp")},48144:function(t,e,n){"use strict";n.d(e,{Z:function(){return p}});var r=n(85952),o=n(38661),i=n(13504),a=(n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770),n(51778)),s=function(){function t(){}return(0,r.Z)(t,[{key:"EVENT",get:function(){return t.EVENT}}]),t}();s.EVENT={};var u=s,c=n(4175),l=n(80067);function h(){h=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var d=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},f=function(t){function e(){var e;return(e=t.call(this)||this).didEditable=!1,e.historyInstance=null,e.setHistoryLoader=function(t){var n=(0,o.Z)(e);e.history={get showing(){var t;return Boolean(null===(t=n.historyInstance)||void 0===t?void 0:t.showing)},getInstance:function(){return d((0,o.Z)(e),void 0,void 0,h().mark((function e(){var r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof a.o)){e.next=6;break}return e.next=3,t.getInstance(this.permissions,this.spreadsheet,n);case 3:r=e.sent,e.next=9;break;case 6:return e.next=8,t.getInstance();case 8:r=e.sent;case 9:return this.historyInstance=r,e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,this)})))}}},e.event=c.ZP,e.isInited=!1,e}(0,i.Z)(e,t);var s=e.prototype;return s.setDidEditable=function(t){this.didEditable=t},s.getDidEditable=function(){return this.didEditable},s.setInited=function(t){this.isInited=t},s.initDocumentManager=function(t){this.documentManager=t},s.initEmitter=function(t){this.emitter=t},s.setLifeCycle=function(t){var e;null===(e=n.g.log)||void 0===e||e.info("SpreadsheetApp.setLifeCycle=",t),this.lifeCycle=t,n.g.tDocsPerformance.markLifeCycle(t)},s.initSheetStatus=function(t){this.sheetStatus=t},s.initAdvPermissions=function(t){this.advPermissions=t},s.initPermissions=function(t){this.permissions=t,"reading"===(0,l.IZ)("mode")&&this.permissions.activeShutdownStatus(!1)},s.initNetworkStatus=function(t){this.networkStatus=t},s.initSpreadsheet=function(t){this.spreadsheet=t},s.initMutationBehavior=function(t){this.mutationBehavior=t},s.initMainThreadWorker=function(t){this.mainThreadWorker=t},s.initCalcController=function(t){this.calcController=t},s.initLogin=function(t){this.login=t},s.initDataCenter=function(t){this.dataCenter=t},s.initHistoryDataCenter=function(t){this.historyDataCenter=t},s.initMessageCenter=function(t,e){this.messageCenter=t,this.messageCenterAdapter=e},s.initOfflineEdit=function(t){this.offlineEdit=t},s.initOfflineOpen=function(t){this.offlineOpen=t},s.initUndoRedoStack=function(t){this.undoredoStack=t},s.initRequestApi=function(t){this.requestApi=t},s.initView=function(t){this.view=t},s.initServiceCollection=function(t){this.serviceCollection=t},s.initFeature=function(t){this.feature=t},s.initEditFeature=function(t){this.editFeature=t},s.setSheetExportManagerLoader=function(t){this.sheetExportManagerLoader=t},s.getSheetExportManager=function(){return d(this,void 0,void 0,h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.sheetExportManagerLoader.getInstance(this));case 1:case"end":return t.stop()}}),t,this)})))},s.getCurrentMainThreadWorker=function(){return this.mainThreadWorker},s.initPlugins=function(t){this.plugins=t},s.initInstantiationService=function(t){this.instantiationService=t},s.initAppConfigInstance=function(t){this.appConfigInstance=t},s.initSheetAdapterManager=function(t){this.sheetAdapterManager=t},(0,r.Z)(e,[{key:"EVENT",get:function(){return e.EVENT}}]),e}(u);f.EVENT={PAGE_LOAD_START:"PAGE_LOAD_START",SPREAD_SHEET_SDK_CORE_START:"SPREAD_SHEET_SDK_CORE_START",SPREAD_SHEET_SDK_CORE_END:"SPREAD_SHEET_SDK_CORE_END",SPREAD_SHEET_PART_INTERACTIVE_START:"SPREAD_SHEET_PART_INTERACTIVE_START",SPREAD_SHEET_PART_INTERACTIVE_END:"SPREAD_SHEET_PART_INTERACTIVE_END",SPREAD_SHEET_MESSAGE_START:"SPREAD_SHEET_MESSAGE_START",SPREAD_SHEET_MESSAGE_END:"SPREAD_SHEET_MESSAGE_END",SPREAD_SHEET_ALL_CHUNK_READY:"SPREAD_SHEET_ALL_CHUNK_READY",SPREAD_SHEET_REQUEST_API_READY:"SPREAD_SHEET_REQUEST_API_READY",SPREAD_SHEET_EDITABLE:"SPREAD_SHEET_EDITABLE",SPREAD_SHEET_PLUGINS_START:"SPREAD_SHEET_PLUGINS_START",SPREAD_SHEET_PLUGINS_END:"SPREAD_SHEET_PLUGINS_END",PAGE_LOAD_FINISHED:"PAGE_LOAD_FINISHED",NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE:"NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE",DESTROY:"DESTROY",RESTART:"RESTART",START_DESTROY:"START_DESTROY",RESTART_END:"RESTART_END",DISCUSSION_LOADED:"DISCUSSION_LOADED"};var p=f},73304:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}}),n(84919);var r=n(65906),o=n.n(r),i=function(){function t(){}var e=t.prototype;return e.getContribute=function(t){return o().getContribute(t)},e.setContribute=function(t){var e=t.name,n=t.json,r=t.context;return o().setContribute({name:e,json:n,context:r})},e.updateContribute=function(t){var e=t.name,n=t.context;return o().updateContribute({name:e,context:n})},t}()},53102:function(t,e,n){"use strict";n.d(e,{T:function(){return r}});var r=(0,n(76138).yh)("IContributesService")},22002:function(t,e,n){"use strict";n.d(e,{Es:function(){return g},hX:function(){return u}}),n(15770),n(26894),n(54371),n(95019);var r=n(85952),o=(n(13857),n(84919),n(19725),n(52865),n(64425),n(93984),n(38934),n(71096),n(27849),n(49502),n(31688),n(46396),n(90109),n(19553),n(71091),n(81144),n(448),n(66724),n(12024),n(81502),n(8326));function i(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s,u,c=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n};!function(t){t.MARK="mark",t.LIFE_CYCLE="lifeCycle",t.RESOURCE="resource",t.CGI="cgi",t.IMG="img",t.MEASURE="measure"}(s||(s={})),function(t){t.LCP="LCP",t.TTI="TTI",t.TTE="TTE",t.HTML="html",t.OPEN_DOC="opendoc",t.PAGE_LOAD_FINISHED="PAGE_LOAD_FINISHED",t.ENTRY_START="entryStart"}(u||(u={}));var l,h={xmlhttprequest:s.CGI,img:s.IMG,script:s.RESOURCE,link:s.RESOURCE},d=o.Z.getConfig("runtime.domainName"),f=[d];!function(t){t[t.low=0]="low",t[t.high=1]="high"}(l||(l={}));var p=[{name:"https://"+d+"/dop-api/opendoc",alias:"opendoc",weight:l.high}],v=function(){function t(t,e,n,r,o){var i,a;this.name=t,this.entryType=e,this.startTime=n,this.duration=r,this.alias=null!==(i=null===o||void 0===o?void 0:o.alias)&&void 0!==i?i:this.autoGenerateAlias(t),this.weight=null!==(a=null===o||void 0===o?void 0:o.weight)&&void 0!==a?a:l.low,this.decodedBodySize=null===o||void 0===o?void 0:o.decodedBodySize,this.encodedBodySize=null===o||void 0===o?void 0:o.encodedBodySize,this.transferSize=null===o||void 0===o?void 0:o.transferSize}var e=t.prototype;return e.setEndTime=function(t){this.duration=t-this.startTime},e.toJSON=function(){var t,e,n,r,o;return{name:null!==(t=this.name)&&void 0!==t?t:this.alias,alias:null!==(e=this.alias)&&void 0!==e?e:this.name,entryType:this.entryType,startTime:this.startTime,endTime:this.startTime+this.duration,duration:this.duration,weight:this.weight,decodedBodySize:null!==(n=this.decodedBodySize)&&void 0!==n?n:0,encodedBodySize:null!==(r=this.encodedBodySize)&&void 0!==r?r:0,transferSize:null!==(o=this.transferSize)&&void 0!==o?o:0}},e.autoGenerateAlias=function(t){var e=t;switch(this.entryType){case s.RESOURCE:var n=t.lastIndexOf("/");n>0&&(e=t.substring(n+1)),e=this.generateMaxLengthAlias(e);break;case s.CGI:var r=t.lastIndexOf("?");r>0&&(e=t.substring(0,r));break;case s.IMG:var o=t.lastIndexOf("?");o>0&&(e=t.substring(0,o))}return e},e.generateMaxLengthAlias=function(t){var e=t.split("~");if(t.length>50&&e.length>0){for(var n=e[e.length-1],r=e.length-2;r>=0&&!(n.length+e[r].length>50);r--)n=e[r]+"~"+n;return n}return t},(0,r.Z)(t,[{key:"endTime",get:function(){return this.startTime+this.duration}}]),t}(),g=function(){function t(){this.customEntries=[],this.performanceTimingKeys=Object.keys(Object.getPrototypeOf(this.getPerformanceTiming())).filter((function(t){return"toJSON"!==t})),this.initPerformanceSettings()}var e=t.prototype;return e.getEntries=function(){return this.customEntries.sort((function(t,e){return t.startTime-e.startTime}))},e.getEntriesByName=function(t,e){return this.getEntries().filter((function(n){return(n.name===t||n.alias===t)&&(!e||n.entryType===e)}))},e.getEntryByName=function(t,e){var n;return null===(n=this.getEntriesByName(t,e))||void 0===n?void 0:n[0]},e.getEntriesByType=function(t,e){return void 0===e&&(e=l.low),this.getEntries().filter((function(n){return n.entryType===t&&n.weight>=e}))},e.getEntryByType=function(t){var e;return null===(e=this.getEntriesByType(t))||void 0===e?void 0:e[0]},e.mark=function(t,e){var n,r;if(!e||void 0!==e.startTime){var o=new v(t,null!==(n=null===e||void 0===e?void 0:e.entryType)&&void 0!==n?n:s.MARK,null!==(r=null===e||void 0===e?void 0:e.startTime)&&void 0!==r?r:this.now(),0);return this.customEntries.push(o),o}},e.markLifeCycle=function(t,e){var n;return this.mark(t,{startTime:null!==(n=null===e||void 0===e?void 0:e.startTime)&&void 0!==n?n:this.now(),entryType:s.LIFE_CYCLE})},e.clearMarks=function(){this.clearEntriesByType(s.MARK)},e.measure=function(t,e){if(!e||void 0!==e.startTime||void 0!==e.endTime){var n=this.getPerformanceTiming().navigationStart,r=this.now(),o=null!==e&&void 0!==e?e:{},i=o.startTime,a=o.endTime,u=o.entryType,l=c(o,["startTime","endTime","entryType"]),h=new v(t,null!==u&&void 0!==u?u:s.MEASURE,null!==i&&void 0!==i?i:n,(null!==a&&void 0!==a?a:r)-(null!==i&&void 0!==i?i:n),l);return this.customEntries.push(h),h}},e.measureStart=function(t,e){var n=new v(t,s.MEASURE,e,0);return this.customEntries.push(n),n},e.measureEnd=function(t,e){var n=this.getEntriesByName(t,s.MEASURE);if(0===n.length)throw new Error("不存在 name 为"+t+"的 entry，请确认是否有先调用 measureStart。");if(n.length>1)throw new Error("存在多个 name 为"+t+"的 entry，请确认是否对同个 name 多次调用 measureStart。");return n[0].setEndTime(e),n},e.measureResource=function(t){var e=this;t.forEach((function(t){var n=h[t.initiatorType];if(n&&!e.filterByWhiteList(t)){var r=e.getPerformanceTiming().navigationStart+t.fetchStart,o=e.getPerformanceTiming().navigationStart+t.responseEnd,i=e.getResourceExternalInfo(t),a=i.alias,s=i.weight,u=t.decodedBodySize,c=t.encodedBodySize,l=t.transferSize;e.measure(t.name,{startTime:r,endTime:o,entryType:n,alias:a,weight:s,decodedBodySize:u,encodedBodySize:c,transferSize:l})}}))},e.clearMeasures=function(t){this.clearEntriesByType(s.MEASURE,t)},e.now=function(){return Date.now()},e.toJSON=function(){return Object.assign(Object.assign({},this.timing),{customEntries:this.customEntries})},e.getBeginTimestamp=function(){var t;return null!==(t=this.timing.clickStart)&&void 0!==t?t:this.timing.navigationStart},e.getElapsedTimes=function(){var t=this.getBeginTimestamp(),e=this.getEntryStartTimeByName(u.LCP,t),n=this.getEntryStartTimeByName(u.TTI,t),r=this.getEntryStartTimeByName(u.TTE,t),o=this.getEntriesByName(u.HTML)[0],i=this.getEntriesByName(u.OPEN_DOC)[0],a=this.getEntryStartTimeByName(u.PAGE_LOAD_FINISHED,t),s=this.getEntryStartTimeByName(u.ENTRY_START,t);return{LCP:e-t,TTI:n-t,TTE:r-t,HTML:(null===o||void 0===o?void 0:o.endTime)-(null===o||void 0===o?void 0:o.startTime),OPENDOC:(null===i||void 0===i?void 0:i.endTime)-(null===i||void 0===i?void 0:i.startTime),PAGE_LOAD_FINISHED:a-t,ENTRY_START:s-t}},e.getAllLogicEntries=function(){var t=this.timing,e=t.entryStart,n=t.PAGE_LOAD_FINISHED;return this.getEntries().filter((function(t){return t.startTime>=e&&t.startTime<=n})).map((function(t){return t.toJSON()}))},e.getAllLogicEntriesBeforeTTE=function(){var t=this.timing,e=t.entryStart,n=t.TTE;return this.getEntries().filter((function(t){return t.startTime>=e&&t.startTime<=n})).map((function(t){return t.toJSON()}))},e.getAllLogicEntriesBeforeEditable=function(){var t=this.timing,e=t.entryStart,n=t.SPREAD_SHEET_EDITABLE;return this.getEntries().filter((function(t){return t.startTime>=e&&t.startTime<=n})).map((function(t){return t.toJSON()}))},e.getAllEntriesByMark=function(t,e){var n,r,o=null!==(n=t&&this.timing[t])&&void 0!==n?n:this.getBeginTimestamp(),i=null!==(r=e&&this.timing[e])&&void 0!==r?r:this.now();return this.getEntries().filter((function(t){return t.startTime>=o&&t.startTime<=i})).map((function(t){return t.toJSON()}))},e.getAllEntriesBeforeTTE=function(){var t=this.timing.TTE;return this.getEntries().filter((function(e){return e.startTime<=t})).map((function(t){return t.toJSON()}))},e.getAllEntriesValue=function(){return this.getEntries().map((function(t){return t.toJSON()}))},e.getAllEntriesWithoutLowWeightResource=function(){var t=this;return this.getEntries().filter((function(e){return!t.isLowWeightResourceEntry(e)})).map((function(t){return t.toJSON()}))},e.clearEntriesByType=function(t,e){this.customEntries=this.customEntries.filter((function(n){return n.entryType!==t||!(!e||n.name===e)}))},e.filterByWhiteList=function(t){var e=[s.CGI,s.IMG],n=h[t.initiatorType];if(-1===e.indexOf(n))return!1;var r=new URL(t.name);return-1===f.indexOf(r.host)},e.getResourceExternalInfo=function(t){for(var e,n,r=i(p);!(n=r()).done;){var o=n.value;if(0===t.name.indexOf(o.name))return{alias:null!==(e=o.alias)&&void 0!==e?e:o.name,weight:o.weight}}return{weight:l.low}},e.isLowWeightResourceEntry=function(t){return t.weight!==l.low&&t.entryType===s.RESOURCE},e.getPerformanceTiming=function(){var t;return(null===(t=window.performance)||void 0===t?void 0:t.timing)?window.performance.timing:{navigationStart:this.now()}},e.getEntryStartTimeByName=function(t,e){var n,r;return null!==(r=null===(n=this.getEntryByName(t))||void 0===n?void 0:n.startTime)&&void 0!==r?r:e},e.initPerformanceSettings=function(){var t,e;window.performance&&(null===(e=(t=window.performance).setResourceTimingBufferSize)||void 0===e||e.call(t,2e3),window.performance.onresourcetimingbufferfull=this.onResourceTimingBufferFull.bind(this))},e.onResourceTimingBufferFull=function(){if(window.performance){var t=window.performance.getEntriesByType("resource");this.measureResource(t)}},(0,r.Z)(t,[{key:"timing",get:function(){var t=this,e=[s.MARK,s.LIFE_CYCLE],n=this.getEntries().filter((function(t){return e.includes(t.entryType)})).reduce((function(t,e){var n;return Object.assign(Object.assign({},t),((n={})[e.name]=e.startTime,n))}),{}),r=this.performanceTimingKeys.reduce((function(e,n){var r,o=t.getPerformanceTiming()[n];return Object.assign(Object.assign({},e),((r={})[n]=o,r))}),{});return Object.assign(Object.assign({},r),n)}}]),t}()},17805:function(t,e,n){"use strict";n(38934),n(48845),n(15770),n(84919),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(11425);var r=n(91974),o=n(32275),i=n(49902),a=n(57982),s=n(68767),u=n(38808),c=n(31973),l=n(66544),h=n(45988),d=n(50838),f=n(4175),p=n(83311),v=n(64730),g=n(34533),y=n(45136),m=n(48834);function E(){E=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(b([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function w(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(36156);var T=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},I=function(){function t(t){this.parent=t,this.init()}var e=t.prototype;return e.init=function(){this.listenMutationRun(),this.listenUpdateCellDataDV(),this.listenUpdateCellDatFromFormula(),this.listenWorkrangeChange(),this.listenBeforeUnload(),this.listenUnload(),this.listenDataVersion(),this.listenDatabaseError()},e.initDataHandle=function(t,e){var n,r,o,i,a=t.mutation;for(n=0,o=a.lastCol;n<=o;n++)for(r=0,i=a.lastRow;r<=i;r++)e.autoUpdateCellData(a.sheetId,r,n)},e.setCellPropertiesHandle=function(t,e){var n,r,i,s,u=t.mutation,c=u.cellDataDelta,l=c.setSlots|c.clearSlots,h=c.delta.userEnteredFormatDelta?c.delta.userEnteredFormatDelta.setSlots|c.delta.userEnteredFormatDelta.clearSlots:0;if(0!==(l&1<<o.Z.SLOT_EFFIECTIVE_VALUE)||0!==(l&1<<o.Z.SLOT_FORMULA)||0!==(l&1<<o.Z.SLOT_DATA_VALIDATION_RULE)||0!==(h&1<<a.Z.NUMBER_FORMAT)){var d=u.gridRange;for(n=d.startRowIndex,i=d.endRowIndex;n<=i;n++)for(r=d.startColIndex,s=d.endColIndex;r<=s;r++)e.autoUpdateCellData(d.sheetId,n,r)}},e.setRangeHandle=function(t,e){for(var n,r,i=t.mutation,s=0,u=i.cellDataDeltaAtPositions.length;s<u;s++){var c=i.cellDataDeltaAtPositions[s].cellDataDelta;n=c.setSlots|c.clearSlots,(0,d.E)({cellDataDelta:c,spreadsheet:e,sheetId:i.gridRange.sheetId,rowIndex:i.cellDataDeltaAtPositions[s].rowIndex,colIndex:i.cellDataDeltaAtPositions[s].colIndex});var l=i.cellDataDeltaAtPositions[s].cellDataDelta.delta.userEnteredFormatDelta;r=l?l.setSlots|l.clearSlots:0,0===(n&1<<o.Z.SLOT_EFFIECTIVE_VALUE)&&0===(n&1<<o.Z.SLOT_FORMULA)&&0===(n&1<<o.Z.SLOT_DATA_VALIDATION_RULE)&&0===(r&1<<a.Z.NUMBER_FORMAT)||e.autoUpdateCellData(i.gridRange.sheetId,i.cellDataDeltaAtPositions[s].rowIndex,i.cellDataDeltaAtPositions[s].colIndex)}},e.setSheetPropertiesHandle=function(t){var e=t.mutation,n=t.isCollab,r=e.sheetDelta,o=e.sheetId;if(r)for(var i,a=w(r.deltas);!(i=a()).done;){var s=i.value;s.slotName===p.NEW_SHEET_PROPERTIES_SLOT.SLOT_HIDE&&s.value&&f.ZP.sheetsBar.trigger("listenHideSheetEvent",{sheetId:o,isCollab:n})}},e.deleteSheetHandle=function(t){var e=t.mutation;t.isCollab&&e.sheetId===this.parent.spreadsheet.activeSheetId&&f.ZP.sheetsBar.trigger("listenDelSheetEvent")},e.insertDimensionHandle=function(t){var e=t.mutation;f.ZP.rangeAuthEvent.trigger("dimensionChange",{sType:t.sType,sheetId:e.sheetId,data:t})},e.deleteDimensionHandle=function(t){var e=t.mutation;f.ZP.rangeAuthEvent.trigger("dimensionChange",{sType:t.sType,sheetId:e.sheetId,data:t})},e.defineWorkbookRangeHandle=function(t){var e=t.mutation;e.workbookRangeType===h.Z.PROTECTED_RANGE&&f.ZP.rangeAuthEvent.trigger("addNewRangeAuth",{sType:t.sType,sheetId:e.gridRange.sheetId,rangeId:e.workbookRangeId,data:t})},e.deleteWorkbookRangeHandle=function(t){var e=t.mutation;e.workbookRangeType===h.Z.PROTECTED_RANGE&&f.ZP.rangeAuthEvent.trigger("deleteRangeAuth",{sType:t.sType,rangeId:e.workbookRangeId,data:t})},e.updateWorkbookRangeHandle=function(t){var e=t.mutation;e.workbookRangeType===h.Z.PROTECTED_RANGE&&f.ZP.rangeAuthEvent.trigger("updateRangeAuth",{sType:t.sType,sheetId:e.gridRange.sheetId,data:t})},e.listenMutationRun=function(){var t,e=this,n=((t={})[u.ZP.INIT_DATA_MUTATION]=this.initDataHandle.bind(this),t[u.ZP.SET_CELL_PROPERTIES_MUTATION]=this.setCellPropertiesHandle.bind(this),t[u.ZP.SET_RANGE_MUTATION]=this.setRangeHandle.bind(this),t[u.ZP.SET_SHEET_PROPERTIES_MUTATION]=this.setSheetPropertiesHandle.bind(this),t[u.ZP.DELETE_SHEET_MUTATION]=this.deleteSheetHandle.bind(this),t[u.ZP.INSERT_DIMENSION_MUTATION]=this.insertDimensionHandle.bind(this),t[u.ZP.DELETE_DIMENSION_MUTATION]=this.deleteDimensionHandle.bind(this),t[u.ZP.DEFINE_WORKBOOK_RANGE_MUTATION]=this.defineWorkbookRangeHandle.bind(this),t[u.ZP.DELETE_WORKBOOK_RANGE_MUTATION]=this.deleteWorkbookRangeHandle.bind(this),t[u.ZP.UPDATE_WORKBOOK_RANGE_MUTATION]=this.updateWorkbookRangeHandle.bind(this),t);this.parent.mutationBehavior.emitter.addListener(this.parent.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(t){var r,o=e.parent.spreadsheet,i=t.mutation,a=i.id;n[a]&&n[a](t,o),(null===(r=e.parent.view)||void 0===r?void 0:r.canvas)&&!t.isIgnoreDataCallView&&f.ZP.spreadsheetEvent.trigger("renderAfterMutationRun",t),e.parent.calcController||e.parent.data.initMutations.push(i)}))},e.listenUpdateCellDataDV=function(){var t=this;f.ZP.spreadsheetEvent.listen("updateCellDataDV",(function(e){var n=new r.Z;"undefined"!==typeof e.dataValidation?n.setSlot(o.Z.SLOT_DATA_VALIDATION_RULE,e.dataValidation):n.clearSlot(o.Z.SLOT_DATA_VALIDATION_RULE);var a=new i.Z({gridRange:e.gridRange,cellDataDelta:n});t.parent.mutationBehavior.applyMutation(a,{isLocal:!0})}))},e.listenUpdateCellDatFromFormula=function(){var t=this;f.ZP.spreadsheetEvent.listen("updateCellDataFromFormula",(function(e){t.parent.mutationBehavior.applyMutation(e,{isLocal:!0,isFromFormula:!0})}))},e.listenUnload=function(){var t=this;window.addEventListener("unload",(function(){(0,g.W)()&&v.n.hideButtonsBeforeJump(),t.OfflineEditShutDown()}))},e.OfflineEditShutDown=function(){var t;null===(t=this.parent.offlineEdit)||void 0===t||t.shutDown(!0)},e.listenBeforeUnload=function(){return T(this,void 0,void 0,E().mark((function t(){var e=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.addEventListener("beforeunload",(function(t){var r,o,i,a,s,u=e.parent;if(null===(i=null===(o=null===(r=u.view)||void 0===r?void 0:r.canvas)||void 0===o?void 0:o.inputManager)||void 0===i?void 0:i.isInputtingState())return e.closeAndDelayRestartJankReport(1e3),t.returnValue="关闭表格将不会保存你所输入的内容，是否确认离开？";if(null===(s=null===(a=u.messageCenterAdapter)||void 0===a?void 0:a.sendMessageCenterAdapter)||void 0===s?void 0:s.hasUncommittedChanges()){if(e.closeAndDelayRestartJankReport(1e3),n.g.refreshReason===m.QU)return;return t.returnValue="文档存在未保存修改，如果关闭，修改将不会被保存。您是否确定关闭？"}c.ZP.jank.log({moduleValue:"page",actionValue:"refresh"})}));case 1:case"end":return t.stop()}}),t)})))},e.closeAndDelayRestartJankReport=function(t){c.ZP.jank.stopReport(),clearTimeout(this.restartJankReportTimer),this.restartJankReportTimer=setTimeout((function(){c.ZP.jank.restartReport()}),t)},e.listenWorkrangeChange=function(){var t=this;f.ZP.spreadsheetEvent.listen("afterKeyframeRun",(function(e){var n=e.sheetId,r=t.parent.spreadsheet.sheetManager.getSheetBySheetId(n);if(r){var o=r.sheetRangeManager;if(!o)return;o.each((function(t,e){for(var n=t.gridRange,o=n.startRowIndex,i=n.endRowIndex,a=n.startColIndex,u=n.endColIndex,c=o;c<=i;c++)for(var l=a;l<=u;l++){var h=r.getCellDataAtPosition(c,l);h||(h=new s.Z,r.setCellDataAtPosition(c,l,h)),h.addSheetRange(e,t.sheetRangeType)}}))}}))},e.listenDataVersion=function(){var t=this;this.parent.mutationBehavior.emitter.addListener(this.parent.mutationBehavior.EVENT.DATA_VERSION_TOO_LOW,(function(){t.parent.event.errorCode.trigger("errorCode",{type:"front",code:y.B.DATA_VERSION_TOO_LOW})}))},e.listenDatabaseError=function(){var t=this;f.ZP.spreadsheetEvent.listen(l.W1.DATABASE_ERROR,(function(){t.parent.messageCenter.shutDown(y.B.DATABASE_ERROR)}))},t}();e.Z=I},76960:function(t,e,n){"use strict";n.d(e,{H:function(){return h},P:function(){return d}});var r,o=n(85952),i=(n(53248),n(38934),n(63240),n(12024),n(81502),n(38574)),a=n(76138),s=n(91508),u=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},c=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(t,e){return function(n,r){e(n,r,t)}},h=(0,a.yh)("IPermissions"),d=function(){function t(t){this.sheetStatus=t}var e=t.prototype;return e.update=function(t){var e=!(!t.getConfig("canEdit")||t.getConfig("isPreview"))&&!!t.getConfig("userInfo"),n=!!t.getConfig("canCopy"),r=!!t.getConfig("canComment")&&!!t.getConfig("isLogin");this.sheetStatus.workbookStatus.status.setCanEdit(e),this.sheetStatus.workbookStatus.status.setCanCopy(n),this.sheetStatus.workbookStatus.status.setCanComment(r)},e.setWorkbookStatusCanEdit=function(t){this.sheetStatus.workbookStatus.status.setCanEdit(t);var e=s.q.getConfig("readerCanComment");this.setWorkbookStatusCanComment(1===e||t)},e.setWorkbookStatusCanCopy=function(t){this.sheetStatus.workbookStatus.status.setCanCopy(t)},e.setWorkbookStatusCanComment=function(t){this.sheetStatus.workbookStatus.status.setCanComment(t)},e.setWorkbookStatusFull=function(t){this.sheetStatus.workbookStatus.status.setFull(t)},e.setSheetsStatus=function(t,e,n){this.sheetStatus.sheetsStatus.setSheetsStatus(t,e),t===n&&this.sheetStatus.sheetsStatus.emitSheetsStatusChange(t)},e.resetSheetsStatus=function(t){this.sheetStatus.sheetsStatus.resetSheetStatus(t),this.sheetStatus.sheetsStatus.emitSheetsStatusChange(t)},e.activeTempStatus=function(t,e){var r;void 0===e&&(e={isHistory:!1}),null===(r=n.g.log)||void 0===r||r.warn("call activeTempStatus 激活临时权限",t),this.sheetStatus.tempStatus.status.setHistory(e.isHistory),this.sheetStatus.tempStatus.status.activated().setCanEdit(t);var o=s.q.getConfig("readerCanComment");this.sheetStatus.tempStatus.status.setCanComment(1===o||t)},e.activeShutdownStatus=function(t){var e;null===(e=n.g.log)||void 0===e||e.warn("call activeShutdownStatus 激活Shutdown状态",t),this.sheetStatus.shutDownStatus.status.activated().setCanEdit(t)},e.unactiveTempStatus=function(){var t;null===(t=n.g.log)||void 0===t||t.warn("call unactiveTempStatus 取消临时权限");var e=s.q.getConfig("canEdit");this.sheetStatus.tempStatus.status.setCanEdit(e),this.sheetStatus.tempStatus.status.setHistory(!1),this.sheetStatus.tempStatus.status.unactivated()},e.setWorkbookStatusOnline=function(t){this.sheetStatus.workbookStatus.status.setOnline(t)},e.setRangeStatusCanEdit=function(t){this.sheetStatus.rangesStatus.status.canEdit!==t&&this.sheetStatus.rangesStatus.status.setCanEdit(t)},e.setRangeStatusCanRead=function(t){this.sheetStatus.rangesStatus.status.canRead!==t&&this.sheetStatus.rangesStatus.status.setCanRead(t)},e.addRangeAuthAndCache=function(t,e,n,r,o,i,a){this.sheetStatus.rangesStatus.addRangeAuthAndCache(t,e,n,r,o,i,a)},e.updateRangeAuthCacheStatus=function(t,e,n){this.sheetStatus.rangesStatus.updateRangeAuthCacheStatus(t,e,n)},e.refreshRangeAuthCache=function(t,e){this.sheetStatus.rangesStatus.refreshRangeAuthCache(t,e)},e.resetRangeStatusBySheetId=function(t){this.sheetStatus.rangesStatus.resetRangeStatusBySheetId(t)},e.registerCaller=function(t){this.callers.includes(t)||this.callers.push(t)},e.activeFrozen=function(t){this.sheetStatus.frozenStatus.activeFrozen(t)},e.unActiveFrozen=function(){this.sheetStatus.frozenStatus.unActiveFrozen()},(0,o.Z)(t,[{key:"events",get:function(){return t.EVENT}}]),t}();d.EVENT={CAN_EDIT_CHANGE:"0",CAN_COPY_CHANGE:"1",CAN_COMMENT_CHANGE:"2"},d=u([l(0,i.T),c("design:paramtypes",["function"===typeof(r="undefined"!==typeof i.T&&i.T)?r:Object])],d)},86936:function(t,e,n){"use strict";n.d(e,{N:function(){return h},a:function(){return l}});var r,o=n(13504),i=(n(53248),n(38934),n(63240),n(31688),n(76138)),a=n(38574),s=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},u=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(t,e){return function(n,r){e(n,r,t)}},l=(0,i.yh)("IPermissionManage"),h=function(t){function e(e){var n;return(n=t.call(this)||this).sheetStatus=e,n.handleSheetStatusChange=function(){var t=n.getFocusStatus();t!==n.initialWorkbookStatus&&(n.initialWorkbookStatus=t,n.sheetStatus.canEditExceptRangeStatus?n.editableFnArray.forEach((function(t){t()})):n.readonlyFnArray.forEach((function(t){t()})))},n.readonlyFnArray=[],n.editableFnArray=[],n.sheetStatusChange(),n.initialWorkbookStatus=n.getFocusStatus(),n}(0,o.Z)(e,t);var n=e.prototype;return n.add=function(t,e){this.readonlyFnArray.push(t),this.editableFnArray.push(e)},n.dispose=function(){t.prototype.dispose.call(this),this.readonlyFnArray=[],this.editableFnArray=[],this.sheetStatus.offChange(this.handleSheetStatusChange)},n.sheetStatusChange=function(){this.sheetStatus.change(this.handleSheetStatusChange)},n.getFocusStatus=function(){var t=this.sheetStatus,e=t.workbookStatus,n=t.tempStatus,r=t.shutDownStatus,o=!0,i=!0;return n.status.activate&&(o=n.status.canEdit),r.status.activate&&(i=r.status.canEdit),e.canEdit&&o&&i},e}(i.JT);h=s([c(0,a.T),u("design:paramtypes",["function"===typeof(r="undefined"!==typeof a.T&&a.T)?r:Object])],h)},34996:function(t,e,n){"use strict";n.d(e,{F:function(){return o}}),n(19553),n(38934),n(81144);var r={};function o(t){return r[t]||function(t){var e=window.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(t),n={allNum:0,dataNum:0,isLarge:0};if(e){var o,i=e.getRowCount(),a=e.getColCount();n.allNum=i*a;for(var s=0;s<i;s++)if(o=e.data.rowData[s])for(var u=0;u<a;u++)o.values[u]&&(n.dataNum+=1);n.isLarge=n.dataNum>=1e4?1:0}r[t]=n}(t),r[t]}},46960:function(t,e,n){"use strict";n.d(e,{q:function(){return i}});var r=n(85952),o=(n(46396),n(72104)),i=function(){function t(){this.init()}var e=t.prototype;return e.init=function(){this.emitter=new o.Z,this.update()},e.update=function(){this.canEdit=!1,this.canRead=!0,this.canCopy=!1,this.canComment=!1,this.canUndo=!1,this.canRedo=!1,this.isPreview=!1,this.isFormPreview=!1,this.tempDisableEdit=!1,this.full=!1,this.activate=!0,this.isHistory=!1,this.isOnline=navigator.onLine},e.change=function(t){this.emitter.on(this.event.CHANGE,t)},e.offChange=function(t){this.emitter.off(this.event.CHANGE,t)},e.undoChange=function(t){this.emitter.on(this.event.UNDO_CHANGE,t)},e.offUndoChange=function(t){this.emitter.off(this.event.UNDO_CHANGE,t)},e.redoChange=function(t){this.emitter.on(this.event.REDO_CHANGE,t)},e.offRedoChange=function(t){this.emitter.off(this.event.REDO_CHANGE,t)},e.commentChange=function(t){this.emitter.on(this.event.COMMENT_CHANGE,t)},e.offCommentChange=function(t){this.emitter.off(this.event.COMMENT_CHANGE,t)},e.destroy=function(){this.emitter.off()},e.updateFromSheetMeta=function(t){var e=Object.assign({},this);this.isPreview=t.preview,this.isFormPreview=!!t.isFormPreview,this.emitter.emit(this.event.CHANGE,e,Object.assign(Object.assign({},this),{type:"preview"}))},e.setCanEdit=function(t){var e=Object.assign({},this);this.canEdit=t,this.emitter.emit(this.event.CHANGE,e,this,Object.assign(Object.assign({},this),{type:"edit"}))},e.setCanRead=function(t){var e=Object.assign({},this);this.canRead=t,this.emitter.emit(this.event.CHANGE,e,this,Object.assign(Object.assign({},this),{type:"read"}))},e.setCanCopy=function(t){var e=Object.assign({},this);this.canCopy=t,this.emitter.emit(this.event.COPY_CHANGE,e,Object.assign(Object.assign({},this),{type:"copy"}))},e.setHistory=function(t){this.isHistory=t},e.setCanComment=function(t){var e=Object.assign({},this);this.canComment=t,this.emitter.emit(this.event.COMMENT_CHANGE,e,Object.assign(Object.assign({},this),{type:"comment"}))},e.setCanUndo=function(t){var e=Object.assign({},this);this.canUndo=t,this.emitter.emit(this.event.UNDO_CHANGE,e,this)},e.setCanRedo=function(t){var e=Object.assign({},this);this.canRedo=t,this.emitter.emit(this.event.REDO_CHANGE,e,this)},e.setFull=function(t){var e=Object.assign({},this);this.full=t,this.emitter.emit(this.event.CHANGE,e,Object.assign(Object.assign({},this),{type:"full"}))},e.setOnline=function(t){var e=Object.assign({},this);this.isOnline=t,this.emitter.emit(this.event.CHANGE,e,Object.assign(Object.assign({},this),{type:"online"}))},e.unactivated=function(){return this.activate=!1,this},e.activated=function(){return this.activate=!0,this},(0,r.Z)(t,[{key:"event",get:function(){return t.EVENT}}]),t}();i.EVENT={CHANGE:"change",COMMENT_CHANGE:"commentChange",COPY_CHANGE:"copyChange",UNDO_CHANGE:"undoChange",REDO_CHANGE:"redoChange"}},85624:function(t,e,n){"use strict";n.d(e,{I1:function(){return s},Nb:function(){return u},PC:function(){return d},ft:function(){return f},qo:function(){return h},tE:function(){return a},y5:function(){return c}}),n(26894),n(71091),n(19553),n(38934),n(81144),n(90109),n(93984);var r=n(27571),o=n(91508),i=n(5826);function a(t,e,n,i){var a,s;if(void 0===i&&(i=t.spreadsheet.activeSheetId),o.q.getConfig("isOwner"))return!1;var u=null===(a=t.sheetStatus)||void 0===a?void 0:a.sheetsStatus.getSheetStatus(i);if(void 0===u?l(t,i):!u.canRead)return!0;var h=new r.GridRange(i,e,e,n,n);return(null===(s=t.sheetStatus)||void 0===s?void 0:s.rangesStatus.rangeAuthCache[i])?!t.sheetStatus.getRangeCanRead(h):!u&&c(t,new r.GridRange(i,e,e,n,n))}function s(t,e,n,i){var a,s;if(void 0===i&&(i=t.spreadsheet.activeSheetId),o.q.getConfig("isOwner"))return!1;if(!o.q.getConfig("canEdit"))return!0;var u=null===(a=t.sheetStatus)||void 0===a?void 0:a.sheetsStatus.getSheetStatus(i);if(void 0===u?l(t,i):!u.canEdit)return!0;var h=new r.GridRange(i,e,e,n,n);return(null===(s=t.sheetStatus)||void 0===s?void 0:s.rangesStatus.rangeAuthCache[i])?!t.sheetStatus.getRangeCanEdit(h):!u&&c(t,new r.GridRange(i,e,e,n,n))}function u(t,e){return Array.from(t.spreadsheet.workbookRangeManager.protectedRangeMap.values()).some((function(n){var r=n.range;return e.some((function(e){var n=r.getCross(e);return!!n&&a(t,n.startRowIndex,n.startColIndex,e.sheetId)}))}))}function c(t,e){var n=t.spreadsheet.workbookRangeManager;return Array.from(n.protectedRangeMap.values()).some((function(t){var n=t.range,r=t.properties;return n.getCross(e)&&r.otherPrivilege===i.mA.CAN_NOT_VIEW}))}function l(t,e){void 0===e&&(e=t.spreadsheet.activeSheetId);var n=t.spreadsheet.workbookRangeManager;return Array.from(n.protectedRangeMap.values()).some((function(t){var n=t.range,r=t.properties;return n.isSheet&&n.sheetId===e&&r.otherPrivilege===i.mA.CAN_NOT_VIEW}))}function h(t,e){return void 0===e&&(e=t.spreadsheet.activeSheetId),l(t,e)&&a(t,0,0,e)}function d(t){var e=t.spreadsheetReference.workbookRangeManager;return Array.from(e.protectedRangeMap.values()).filter((function(e){var n=e.range;return n.sheetId===t.getSheetId()&&a(t.spreadsheetReference.parent,n.isCol?0:n.startRowIndex,n.isRow?0:n.startColIndex,n.sheetId)})).map((function(t){return t.range}))}function f(t){var e=t.spreadsheetReference.workbookRangeManager;return Array.from(e.protectedRangeMap.values()).some((function(e){var n=e.range,r=e.properties;return n.sheetId===t.getSheetId()&&r.otherPrivilege===i.mA.CAN_NOT_VIEW}))}},38574:function(t,e,n){"use strict";n.d(e,{T:function(){return _},Z:function(){return R}});var r=n(85952),o=(n(53248),n(38934),n(63240),n(76138)),i=n(27571),a=n(30526),s=function(){function t(){this.isActive=!1}var e=t.prototype;return e.activeFrozen=function(t){this.isActive=!0,this.fronzenHandle=t},e.unActiveFrozen=function(){this.isActive=!1,this.fronzenHandle=null},e.checkFrozenStatus=function(){return!this.isActive||(this.triggerFrozenHandle(),!1)},e.triggerFrozenHandle=function(){var t,e;null===(t=this.fronzenHandle)||void 0===t||t.call(this),null===(e=n.g.log)||void 0===e||e.warn("用户操作被临时冻结拦截")},t}(),u=n(46960),c=function(){function t(t){this.app=t,this.status=new u.q}var e=t.prototype;return e.isRangeCanEdit=function(t){var e=this.app.spreadsheet.activeSheet,n=e.getRowCount(),r=e.highWaterMark.getMark();return r===n-1||!(t.endRowIndex>r)&&!e.mergeManager.mergeList.some((function(e){return e.isCross(t)&&e.endRowIndex>r}))},e.update=function(){this.status.update()},e.destroy=function(){this.status.destroy()},e.change=function(t){this.status.change(t)},e.offChange=function(t){this.status.offChange(t)},(0,r.Z)(t,[{key:"isCurrSelectionCanEdit",get:function(){var t=this,e=this.app.view;if(this.app.spreadsheet.isExternalSheet())return!0;var n=null===e||void 0===e?void 0:e.getSelection(),r=!n||n.rangeSelections.every((function(e){return t.isRangeCanEdit(e)}));return r!==this.status.canEdit&&this.status.setCanEdit(r),r}}]),t}(),l=n(85130),h=n(85624),d=n(5826),f=n(72104),p=function(){function t(t){this.init(t)}var e=t.prototype;return e.init=function(t){this.canEdit=!1,this.canRead=!0,this.sheetId=t},e.setCanEdit=function(t){this.canEdit=t},e.setCanRead=function(t){this.canRead=t},t}(),v=function(){function t(){this.status={},this.emitter=new f.Z}var e=t.prototype;return e.update=function(){this.status={}},e.change=function(e){this.emitter.on(t.EVENT.CHANGE,e)},e.offChange=function(e){this.emitter.off(t.EVENT.CHANGE,e)},e.destroy=function(){this.status={},this.emitter.off()},e.setSheetsStatus=function(t,e){var n=void 0===this.status[t]?this.createSheetsStatus(t):this.status[t];n.setCanEdit(e===d.BP.EDITABLE),n.setCanRead(e!==d.BP.CAN_NOT_VIEW)},e.emitSheetsStatusChange=function(e){this.emitter.emit(t.EVENT.CHANGE,e)},e.getSheetStatus=function(t){return this.status[t]},e.getActiveSheetStatus=function(){var t=n.g.SpreadsheetApp.spreadsheet.activeSheetId;return this.getSheetStatus(t)},e.resetSheetStatus=function(t){delete this.status[t]},e.createSheetsStatus=function(t){return this.status[t]=this.status[t]||new p(t),this.status[t]},t}();v.EVENT={CHANGE:"change"};var g,y=function(){function t(){this.status=new u.q,this.init()}var e=t.prototype;return e.init=function(){this.status.unactivated()},e.update=function(){this.status.update(),this.status.unactivated()},t}(),m=function(){function t(){this.status=new u.q,this.init()}var e=t.prototype;return e.init=function(){this.status.unactivated()},e.update=function(){this.status.update(),this.status.unactivated()},t}(),E=function(){function t(){this.status=new u.q}return t.prototype.update=function(){this.status.update()},(0,r.Z)(t,[{key:"canEdit",get:function(){return this.status.canEdit}},{key:"canCopy",get:function(){return this.status.canCopy}},{key:"canComment",get:function(){return this.status.canComment}},{key:"isOnline",get:function(){return this.status.isOnline}}]),t}(),w=n(91508),S=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},T=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},I=function(t,e){return function(n,r){e(n,r,t)}},_=(0,o.yh)("ISheetStatus"),b=function(){function t(t){this.app=t,this.init()}var e=t.prototype;return e.init=function(){this.tempStatus=new m,this.sheetsStatus=new v,this.workbookStatus=new E,this.rangesStatus=new d.wL,this.shutDownStatus=new y,this.highWaterStatus=new c(this.app),this.frozenStatus=new s},e.update=function(){this.tempStatus.update(),this.sheetsStatus.update(),this.workbookStatus.update(),this.rangesStatus.update(),this.shutDownStatus.update(),this.highWaterStatus.update()},e.getStatusBySheetId=function(t){return this.sheetsStatus.status[t]},e.getActiveSheetStatus=function(){return this.sheetsStatus.getActiveSheetStatus()},e.change=function(t){var e;try{this.tempStatus.status.change(t),this.shutDownStatus.status.change(t),this.rangesStatus.status.change(t),this.sheetsStatus.change(t),this.workbookStatus.status.change(t),this.highWaterStatus.change(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.change",null===r||void 0===r?void 0:r.stack)}},e.offChange=function(t){var e;try{this.tempStatus.status.offChange(t),this.shutDownStatus.status.offChange(t),this.rangesStatus.status.offChange(t),this.sheetsStatus.offChange(t),this.workbookStatus.status.offChange(t),this.highWaterStatus.offChange(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.offChange",null===r||void 0===r?void 0:r.stack)}},e.undoChange=function(t){var e;try{this.tempStatus.status.undoChange(t),this.workbookStatus.status.undoChange(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.undoChange",null===r||void 0===r?void 0:r.stack)}},e.offUndoChange=function(t){var e;try{this.tempStatus.status.offUndoChange(t),this.workbookStatus.status.offUndoChange(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.offUndoChange",null===r||void 0===r?void 0:r.stack)}},e.redoChange=function(t){var e;try{this.tempStatus.status.redoChange(t),this.workbookStatus.status.redoChange(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.redoChange",null===r||void 0===r?void 0:r.stack)}},e.offredoChange=function(t){var e;try{this.tempStatus.status.offRedoChange(t),this.workbookStatus.status.offRedoChange(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.offredoChange",null===r||void 0===r?void 0:r.stack)}},e.commentChange=function(t){var e;try{this.workbookStatus.status.commentChange(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.commentChange",null===r||void 0===r?void 0:r.stack)}},e.offCommentChange=function(t){var e;try{this.workbookStatus.status.offCommentChange(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("sheetStatus.offCommentChange",null===r||void 0===r?void 0:r.stack)}},e.destroy=function(){var t;try{this.tempStatus.status.destroy(),this.shutDownStatus.status.destroy(),this.sheetsStatus.destroy(),this.workbookStatus.status.destroy(),this.rangesStatus.destroy(),this.highWaterStatus.destroy()}catch(e){null===(t=n.g.log)||void 0===t||t.error("sheetStatus.destroy",null===e||void 0===e?void 0:e.stack)}},e.getRangeCanEdit=function(t){if(this.shutDownStatus.status.activate)return this.shutDownStatus.status.canEdit;if(this.tempStatus.status.activate)return this.tempStatus.status.canEdit;var e=!0,n=this.getStatusBySheetId(t.sheetId);return n&&(e=n.canEdit),this.rangesStatus.checkRangeStatus(t)===d.BP.EDITABLE&&this.workbookStatus.canEdit&&e},e.getRangeCanRead=function(t){var e=!0,n=this.getStatusBySheetId(t.sheetId);return n&&(e=n.canRead),this.rangesStatus.checkRangeStatus(t)!==d.BP.CAN_NOT_VIEW&&e},e.getRangeCanComment=function(t){return this.canComment},e.getRangeStatusBlockByBlock=function(t,e){return void 0===e&&(e=null),this.rangesStatus.getRangeStatusBlockByBlock(t,e)},e.isGridRangeSetRangeStatus=function(t,e){return this.rangesStatus.isGridRangeSetRangeStatus(t,e)},e.isCurrentRowCanEdit=function(t){var e=t.startRow,r=t.endRow,o=n.g.SpreadsheetApp.spreadsheet.getActiveSheetId(),a=new i.GridRange(o,e,r,i.DEFAULT_DIMENSION_INDEX,i.DEFAULT_DIMENSION_INDEX);return this.getRangeCanEdit(a)},e.isCurrentColCanEdit=function(t){var e=t.startCol,r=t.endCol,o=n.g.SpreadsheetApp.spreadsheet.getActiveSheetId(),a=new i.GridRange(o,i.DEFAULT_DIMENSION_INDEX,i.DEFAULT_DIMENSION_INDEX,e,r);return this.getRangeCanEdit(a)},e.isRangeCanEditByHighWater=function(t){return this.highWaterStatus.isRangeCanEdit(t)},e.isCellPrivate=function(t,e){return l.xy(this.app.spreadsheet,t,e)},e.containsPrivateRange=function(t){return void 0===t&&(t=this.app.view.getSelection().rangeSelections),l.Up(this.app.spreadsheet.workbookRangeManager,t)},e.containsPrivateCell=function(t){return void 0===t&&(t=this.app.view.getSelection().rangeSelections),l.fe(this.app.spreadsheet,t)},e.getPrivateRangeFirstLine=function(t){return void 0===t&&(t=this.app.view.getSelection().rangeSelections),l.II(this.app.spreadsheet.workbookRangeManager,t)},e.isInPrivateRange=function(t,e){return l._7(this.app.spreadsheet,t,e)},e.isCellCanNotRead=function(t,e){return h.tE(this.app,t,e)},e.containsCanNotReadRange=function(t){return void 0===t&&(t=this.app.view.getSelection().rangeSelections),h.Nb(this.app,t)},e.checkRangeStatus=function(t){var e=!0,n=this.getStatusBySheetId(t.sheetId);return n&&(e=n.canEdit),this.rangesStatus.checkRangeStatus(t)===d.BP.EDITABLE&&e},e.isCannotEditBecauseRangeAuth=function(t){var e=!this.checkRangeStatus(t),n=this.canEditExceptRangeStatus;return e&&n},e.canCreateSheet=function(){return!!w.q.getConfig("isOwner")||this.canEdit&&w.q.getConfig("privilegeAttribute").can_edit_tab},(0,r.Z)(t,[{key:"canEdit",get:function(){var t=!0,e=n.g.SpreadsheetApp.spreadsheet.activeSheetId,r=this.getStatusBySheetId(e);return r&&(t=r.canEdit),this.canEditExceptRangeStatus&&t&&this.rangesStatus.canEdit}},{key:"canEditExceptWorkbookStatus",get:function(){var t=!0;return this.shutDownStatus.status.activate?t=this.shutDownStatus.status.canEdit:this.tempStatus.status.activate&&(t=this.tempStatus.status.canEdit),t}},{key:"canEditExceptRangeStatus",get:function(){var t=!0;return this.shutDownStatus.status.activate?t=this.shutDownStatus.status.canEdit:this.tempStatus.status.activate&&(t=this.tempStatus.status.canEdit),t&&this.workbookStatus.canEdit&&this.highWaterStatus.isCurrSelectionCanEdit}},{key:"canComment",get:function(){return this.workbookStatus.status.canComment&&this.workbookStatus.status.isOnline}},{key:"canCopy",get:function(){return this.workbookStatus.status.canCopy}}]),t}(),R=b=S([I(0,a.m),T("design:paramtypes",["function"===typeof(g="undefined"!==typeof a.m&&a.m)?g:Object])],b)},85130:function(t,e,n){"use strict";n.d(e,{II:function(){return s},Up:function(){return a},_7:function(){return u},fe:function(){return c},xy:function(){return i}}),n(26894),n(71091),n(19553),n(38934),n(81144),n(31688);var r=n(27571),o=n(91508);function i(t,e,n,r,i){var a,s,c;if(void 0===r&&(r=t.activeSheet),null!==(a=null===i||void 0===i?void 0:i.isOwner)&&void 0!==a?a:o.q.getConfig("isOwner"))return!1;var l=r.getPrimaryCellDataAtPosition(e,n);if(!Boolean(null===l||void 0===l?void 0:l.getEditValue())||!u(t,e,n,r))return!1;var h=null!==(s=null===i||void 0===i?void 0:i.ownerId)&&void 0!==s?s:o.q.getConfig("ownerId"),d=null!==(c=null===i||void 0===i?void 0:i.tinyid)&&void 0!==c?c:o.q.getConfig("tinyid");return((null===l||void 0===l?void 0:l.getModifierId())||h)!==d}function a(t,e){return Array.from(t.privateRangeMap.values()).some((function(t){var n=t.range;return e.some((function(t){return n.isCross(t)}))}))}function s(t,e){var n=Array.from(t.privateRangeMap.values()),r=-1;return n.forEach((function(t){var n=t.range;return e.some((function(t){if(n.isCross(t))return(r<0||n.startRowIndex<r)&&(r=n.startRowIndex),!0}))})),r}function u(t,e,n,o){void 0===o&&(o=t.activeSheet);var i=t.workbookRangeManager.privateRangeMap;if(0===i.size)return!1;var a=new r.GridRange(o.getSheetId(),e,e,n,n);return Array.from(i).some((function(t){return t[1].range.contain(a)}))}function c(t,e){var n={isOwner:o.q.getConfig("isOwner"),ownerId:o.q.getConfig("ownerId"),tinyid:o.q.getConfig("tinyid")};return e.some((function(e){return e.some((function(e,r){return i(t,e,r,t.activeSheet,n)}))}))}},5826:function(t,e,n){"use strict";n.d(e,{BP:function(){return r},DG:function(){return i},mA:function(){return o},wL:function(){return u}});var r,o,i,a=n(85952),s=(n(38934),n(31688),n(79690),n(10012),n(8195),n(46960));!function(t){t[t.READ_ONLY=1]="READ_ONLY",t[t.EDITABLE=2]="EDITABLE",t[t.CAN_NOT_VIEW=3]="CAN_NOT_VIEW"}(r||(r={})),function(t){t[t.CAN_VIEW=1]="CAN_VIEW",t[t.CAN_NOT_VIEW=2]="CAN_NOT_VIEW"}(o||(o={})),function(t){t[t.NORMAL_MODE=0]="NORMAL_MODE",t[t.PREEMPTION_MODE=1]="PREEMPTION_MODE"}(i||(i={}));var u=function(){function t(){this.rangeAuthCache={},this.status=new s.q,this.status.canEdit=!0,this.status.canRead=!0,this.computeBlockCacheInfo={}}var e=t.prototype;return e.update=function(){this.rangeAuthCache={},this.status.update(),this.status.canEdit=!0,this.status.canRead=!0,this.computeBlockCacheInfo={}},e.destroy=function(){this.update(),this.status.destroy()},e.resetRangeStatusBySheetId=function(t){this.rangeAuthCache[t]={},this.status.update(),this.status.canEdit=!0,this.status.canRead=!0,this.computeBlockCacheInfo[t]={valid:!1,info:[]}},e.getRangeAuthCacheItem=function(t){return this.rangeAuthCache[t]||this.createRangeAuthCacheItem(t)},e.refreshRangeAuthCache=function(t,e){var n=this;this.rangeAuthCache[t]={},Object.entries(e).forEach((function(e){var r=e[0],o=e[1],i=o.gridRange,a=o.rangeStatus,s=o.mode,u=o.setAvatar,c=o.setName,l=o.setUid;n.rangeAuthCache[t][r]={rangeStatus:a,gridRange:i.clone(),mode:s,setAvatar:u,setName:c,setUid:l}}))},e.getRangeStatusBlockByBlock=function(t,e){var n,o=[];return null===e?(Object.values(null!==(n=this.rangeAuthCache[t])&&void 0!==n?n:{}).forEach((function(t){o.push(t.gridRange.clone())})),o):e===r.READ_ONLY||e===r.EDITABLE?this.getRangeAuthByStatus(t,e):e===r.CAN_NOT_VIEW?this.getRangeAuthByStatus(t,r.READ_ONLY).concat(this.getRangeAuthByStatus(t,r.CAN_NOT_VIEW)):o},e.addRangeAuthAndCache=function(t,e,n,r,o,i,a){e.isValid()&&(this.getRangeAuthCacheItem(e.sheetId)[t]={gridRange:e.clone(),rangeStatus:n,setName:r,setUid:o,setAvatar:i,mode:a})},e.checkRangeStatus=function(t){var e=t.sheetId,n=r.EDITABLE,o=this.rangeAuthCache[e];for(var i in o){var a=o[i],s=a.gridRange,u=a.rangeStatus;if(s.isCross(t)){if(u===r.CAN_NOT_VIEW){n=r.CAN_NOT_VIEW;break}u===r.READ_ONLY&&(n=r.READ_ONLY)}}return n},e.isGridRangeSetRangeStatus=function(t,e){var n=!1,r=t.sheetId,o=this.rangeAuthCache[r];for(var i in o){var a=o[i],s=a.gridRange,u=a.rangeStatus;if(s.isCross(t)&&u===e){n=!0;break}}return n},e.getCacheGridRangeByRangeId=function(t){for(var e=void 0,n=0,r=Object.entries(this.rangeAuthCache);n<r.length;n++){var o=r[n][1][t];if(void 0!==o){e=o.gridRange.clone();break}}return e},e.updateRangeAuthCacheStatus=function(t,e,n){var r=this.rangeAuthCache[e];(null===r||void 0===r?void 0:r[t])&&(r[t].rangeStatus=n)},e.getNotEditCrossRangeAuthStatus=function(t){var e=this.rangeAuthCache[t.sheetId];for(var n in e){var o=e[n];if((o.rangeStatus===r.CAN_NOT_VIEW||o.rangeStatus===r.READ_ONLY)&&o.gridRange.isCross(t))return o}return null},e.createRangeAuthCacheItem=function(t){return this.rangeAuthCache[t]=this.rangeAuthCache[t]||{},this.rangeAuthCache[t]},e.getRangeAuthByStatus=function(t,e){var n=[],r=this.rangeAuthCache[t];for(var o in r){var i=r[o];i.rangeStatus===e&&n.push(i.gridRange)}return n},(0,a.Z)(t,[{key:"canEdit",get:function(){return this.status.canEdit}},{key:"canRead",get:function(){return this.status.canRead}}]),t}();u.EVENT={CHANGE:"change",SET_OVERLAP_STATUS:"setOverlaptStatus"}},10916:function(t,e,n){"use strict";var r=n(85952),o=(n(38934),n(48845),n(46396),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770),n(48237)),i=n(8326),a=n(30089),s=n(93512),u=n(4289),c=n(91508);function l(){l=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var h={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var h=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},d=function(){function t(){"wecom"===i.Z.getConfig("domain")?this.accountApplication=o.default.dependentServiceCombinder.enterpriseAccountApplication:this.accountApplication=o.default.dependentServiceCombinder.accountApplication}var e=t.prototype;return e.login=function(t,e,n){this.accountApplication.login(t,e,n)},e.init=function(){return this.accountApplication.init()},e.setUserInfo=function(){var t=this;this.updateUserInfo(),"wecom"!==i.Z.getConfig("domain")&&(this.accountApplication.mutate("vipInfo"),this.setVipInfoSubscribe((function(e){c.q.setConfig({vipInfo:e,userOfficialInfo:t.accountApplication.officialInfo})})))},e.updateUserInfo=function(){c.q.setConfig(Object.assign({},this.changeApplicationInfo()))},e.setVipInfoSubscribe=function(t){"wecom"!==i.Z.getConfig("domain")&&this.accountApplication.subscribe("vipInfo",(function(e){t(e)}))},e.setOfficialInfoSubscribe=function(t){"wecom"!==i.Z.getConfig("domain")&&this.accountApplication.subscribe("officialInfo",(function(e){t(e)}))},e.getVipInfoForFetch=function(){return h(this,void 0,void 0,l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("wecom"!==i.Z.getConfig("domain")){t.next=2;break}return t.abrupt("return",{type:a.qu.NONE,beginTime:0,endTime:0});case 2:return t.next=4,this.accountApplication.completionUserInfo();case 4:return t.abrupt("return",this.accountApplication.vipInfo);case 5:case"end":return t.stop()}}),t,this)})))},e.getVipInfo=function(){return this.accountApplication.vipInfo},e.changeApplicationInfo=function(){var t=this.accountApplication.userInfo,e=t.userName,n=t.tinyId,r=t.uidSource,o=t.openId,i=t.userPic,a=t.loginType,s=t.corpId,u=t.corpName,c=t.uin;return{isLogin:this.isLogin,userName:e,userPic:i,userType:this.changeLoginType(a),userInfo:{avatar:i,nick:e,tinyid:n,uid:n,uidSource:r,wxOpenid:o,corpId:s,corpName:u,uin:c,loginType:a}}},e.changeLoginType=function(t){return t===s.Q.QQ?"qq":t===s.Q.WX?"wx":(s.Q.WORK,"wework")},(0,r.Z)(t,[{key:"isLogin",get:function(){return this.accountApplication.userInfo.tinyId!==u.Dr}}]),t}();e.Z=new d},93772:function(t,e,n){"use strict";n.d(e,{_:function(){return r}});var r={name:"docs-component-account-avatar",loadType:n(6529).LoadType.ON_DEMAND}},58853:function(t,e,n){"use strict";n.d(e,{X:function(){return r}});var r={name:"docs-component-menu-adv-permission",loadType:n(6529).LoadType.ON_DEMAND}},58655:function(t,e,n){"use strict";n.d(e,{O:function(){return r}});var r={name:"docs-component-at-message-toast",loadType:n(6529).LoadType.IDLE,containerId:"docs-component-at-message-toast"}},60402:function(t,e,n){"use strict";n.d(e,{I:function(){return r}});var r={name:"docs-component-at-message",loadType:n(6529).LoadType.ON_DEMAND}},75867:function(t,e,n){"use strict";n.d(e,{m:function(){return r}});var r={name:"docs-component-attachment",loadType:n(6529).LoadType.ON_DEMAND,containerId:"docs-component-attachment"}},57513:function(t,e,n){"use strict";n.d(e,{d:function(){return r}});var r={name:"docs-component-avatar-nick-nameplate",loadType:n(6529).LoadType.ON_DEMAND}},89670:function(t,e,n){"use strict";n.d(e,{M:function(){return r}});var r={name:"docs-component-collaboration",loadType:n(6529).LoadType.ON_DEMAND}},53354:function(t,e,n){"use strict";n.d(e,{x:function(){return r}});var r={name:"docs-component-collaborator-detail-mobile",loadType:n(6529).LoadType.ON_DEMAND}},43502:function(t,e,n){"use strict";n.d(e,{U:function(){return r}});var r={name:"docs-component-discuss-mobile",loadType:n(6529).LoadType.ON_DEMAND}},87233:function(t,e,n){"use strict";n.d(e,{U:function(){return r}});var r={name:"docs-component-export-async",loadType:n(6529).LoadType.ON_DEMAND}},48927:function(t,e,n){"use strict";n.d(e,{i:function(){return r}});var r={name:"docs-component-export-for-app-guide-panel",loadType:n(6529).LoadType.ON_DEMAND}},79350:function(t,e,n){"use strict";n.d(e,{r:function(){return r}});var r={name:"docs-component-export-image",loadType:n(6529).LoadType.ON_DEMAND}},56108:function(t,e,n){"use strict";n.d(e,{P:function(){return r}});var r={name:"docs-component-file-info-panel",loadType:n(6529).LoadType.ON_DEMAND}},1928:function(t,e,n){"use strict";n.d(e,{V:function(){return r}});var r={name:"docs-component-file-operation",loadType:n(6529).LoadType.EAGER}},571:function(t,e,n){"use strict";n.d(e,{B:function(){return r}});var r={name:"docs-component-help-center",loadType:n(6529).LoadType.EAGER}},31020:function(t,e,n){"use strict";n.d(e,{b:function(){return r}});var r={name:"docs-component-vip-guide",loadType:n(6529).LoadType.EAGER}},71496:function(t,e,n){"use strict";n.d(e,{u:function(){return r}});var r={name:"docs-component-like",loadType:n(6529).LoadType.ON_DEMAND}},38371:function(t,e,n){"use strict";n.d(e,{h:function(){return r}});var r={name:"docs-component-login-button-mobile",loadType:n(6529).LoadType.ON_DEMAND}},32431:function(t,e,n){"use strict";n.d(e,{f:function(){return r}});var r={name:"docs-component-login",loadType:n(6529).LoadType.ON_DEMAND}},42238:function(t,e,n){"use strict";n.d(e,{Q:function(){return r}});var r={name:"docs-component-title",loadType:n(6529).LoadType.EAGER}},41752:function(t,e,n){"use strict";n.d(e,{h:function(){return r}});var r={name:"docs-component-mini-list",loadType:n(6529).LoadType.ON_DEMAND}},38181:function(t,e,n){"use strict";n.d(e,{U:function(){return r}});var r={name:"docs-component-modal-to-pay",loadType:n(6529).LoadType.ON_DEMAND}},98418:function(t,e,n){"use strict";n.d(e,{X:function(){return r}});var r={name:"docs-component-ocr",loadType:n(6529).LoadType.EAGER}},92634:function(t,e,n){"use strict";n.d(e,{T:function(){return r}});var r={name:"docs-component-pay",loadType:n(6529).LoadType.ON_DEMAND}},75863:function(t,e,n){"use strict";n.d(e,{F:function(){return r}});var r={name:"docs-component-permit-apply",loadType:n(6529).LoadType.ON_DEMAND}},94347:function(t,e,n){"use strict";n.d(e,{A:function(){return r}});var r={name:"docs-component-read-record",loadType:n(6529).LoadType.EAGER}},3305:function(t,e,n){"use strict";n.d(e,{L:function(){return r}});var r={name:"docs-component-shortcut-panel",loadType:n(6529).LoadType.ON_DEMAND}},41510:function(t,e,n){"use strict";n.d(e,{C2:function(){return a},XM:function(){return u},iR:function(){return r}});var r,o,i,a,s=n(6529);!function(t){t[t.MINIPROGRAM_CAN_NOT_PAY=-100]="MINIPROGRAM_CAN_NOT_PAY",t[t.SIZE_LIMIT_OWNER=100]="SIZE_LIMIT_OWNER",t[t.SIZE_LIMIT_COOPERATION_OWNER=101]="SIZE_LIMIT_COOPERATION_OWNER",t[t.SIZE_LIMIT_COOPERATION_COLLABOR=102]="SIZE_LIMIT_COOPERATION_COLLABOR",t[t.SIZE_LIMIT_TRANSFER=103]="SIZE_LIMIT_TRANSFER",t[t.SIZE_LIMIT_DUPLICATE_OWNER=104]="SIZE_LIMIT_DUPLICATE_OWNER",t[t.SIZE_LIMIT_DUPLICATE_COLLABOR=105]="SIZE_LIMIT_DUPLICATE_COLLABOR",t[t.SIZE_LIMIT_RECOVER_OWNER=106]="SIZE_LIMIT_RECOVER_OWNER",t[t.SIZE_LIMIT_RECOVER_COLLABOR=107]="SIZE_LIMIT_RECOVER_COLLABOR"}(r||(r={})),function(t){t[t.GO_TO_OPEN=1]="GO_TO_OPEN",t[t.KNOW_BUTTON=2]="KNOW_BUTTON"}(o||(o={})),function(t){t[t.BUTTON_CLOSE=3]="BUTTON_CLOSE",t[t.RIGHT_CLOSE=4]="RIGHT_CLOSE"}(i||(i={})),function(t){t[t.OWNER_CREATE_COPY=4]="OWNER_CREATE_COPY",t[t.OWNER_RECOVER=5]="OWNER_RECOVER",t[t.COLLABOR_RECOVER=6]="COLLABOR_RECOVER"}(a||(a={}));var u={name:"docs-component-size-limit-dialog",loadType:s.LoadType.ON_DEMAND}},31241:function(t,e,n){"use strict";n.d(e,{a:function(){return o},q:function(){return i}});var r=n(6529),o={name:"docs-component-subscription-notification",loadType:r.LoadType.ON_DEMAND},i={name:"docs-component-subscribe",loadType:r.LoadType.EAGER}},32267:function(t,e,n){"use strict";n.d(e,{B:function(){return r}});var r={name:"docs-transfer-auth",loadType:n(6529).LoadType.ON_DEMAND}},94387:function(t,e,n){"use strict";n.d(e,{d:function(){return r}});var r={name:"docs-component-user-custom-background",loadType:n(6529).LoadType.ON_DEMAND}},79265:function(t,e,n){"use strict";n.d(e,{d:function(){return o},n:function(){return i}});var r=n(6529),o={name:"docs-component-doc-mode-entrance",loadType:r.LoadType.EAGER},i={name:"docs-component-doc-mode-list",loadType:r.LoadType.EAGER}},43943:function(t,e,n){"use strict";n.d(e,{C:function(){return r}});var r={name:"docs-component-vip-toast-mobile",loadType:n(6529).LoadType.ON_DEMAND}},86022:function(t,e,n){"use strict";n.d(e,{P:function(){return r}});var r={name:"docs-component-vip-toast",loadType:n(6529).LoadType.ON_DEMAND}},65153:function(t,e,n){"use strict";n.d(e,{G:function(){return r}});var r={name:"docs-component-wx-h5-navi-panel",loadType:n(6529).LoadType.ON_DEMAND}},48237:function(t,e,n){"use strict";n.r(e),n.d(e,{updateDomainClientVars:function(){return V}});var r=n(58926),o=(n(8195),n(6529)),i=n(94347),a=n(41510),s=n(3305),u=n(41752),c=n(60402),l=n(58655),h=n(43502),d=n(75867),f=n(58853),p=(n(36156),n(53354)),v=n(31241),g=n(1928),y=n(93772),m=n(32431),E=(n(8326),n(89670)),w=n(79350),S=n(66186),T=n(92634),I=n(71496),_=n(79265),b=n(98418),R=n(94387),O=n(42238),x=n(31020),C=n(75863),L=n(65153),A=n(571),N=n(57513),D=n(32267),M=n(38181),P=n(48927),k=n(87233),U=n(56108),F=n(38371),j=n(86022),B=n(43943),Z=(0,o.createExtensionService)({metadataLoaderOptions:{componentCdnPrefix:void 0,specifiedVersion:1}});function V(){window.clientVars&&Z.updateDomainWithClientVars(window.clientVars,!0)}V(),Z.scanAndHandleExtensions([i.A,a.XM,s.L,u.h,v.a,v.q,d.m,f.X,O.Q,x.b,c.I,l.O,h.U,p.x,w.r,y._,m.f,_.d,_.n,N.d,S.lY,b.X,g.V,C.F,L.G,A.B,R.d,P.i].concat((0,r.Z)([E.M,T.T,I.u,k.U,D.B,j.P,B.C,F.h,U.P,M.U]))),e.default=Z},976:function(t,e,n){"use strict";n.d(e,{V:function(){return r}});var r=(0,n(76138).yh)("IRequestApi")},48885:function(t,e){"use strict";var n;!function(t){t[t.INSERT_DIMENSION_REQUEST=0]="INSERT_DIMENSION_REQUEST",t[t.DELETE_DIMENSION_REQUEST=1]="DELETE_DIMENSION_REQUEST",t[t.MOVE_DIMENSION_REQUEST=2]="MOVE_DIMENSION_REQUEST",t[t.SET_DIMENSION_SIZE_REQUEST=3]="SET_DIMENSION_SIZE_REQUEST",t[t.SET_DIMENSION_HIDE_REQUEST=4]="SET_DIMENSION_HIDE_REQUEST",t[t.SET_DIMENSION_SHOW_REQUEST=5]="SET_DIMENSION_SHOW_REQUEST",t[t.ADD_IMAGE_REQUEST=6]="ADD_IMAGE_REQUEST",t[t.DELETE_IMAGE_REQUEST=7]="DELETE_IMAGE_REQUEST",t[t.UPDATE_IMAGE_REQUEST=8]="UPDATE_IMAGE_REQUEST",t[t.MERGE_CELLS_REQUEST=9]="MERGE_CELLS_REQUEST",t[t.UNMERGE_CELLS_REQUEST=10]="UNMERGE_CELLS_REQUEST",t[t.SET_SHEETS_REQUEST=11]="SET_SHEETS_REQUEST",t[t.SET_FORMAT_REQUEST=12]="SET_FORMAT_REQUEST",t[t.REORDER_RANGE_REQUEST=13]="REORDER_RANGE_REQUEST",t[t.FREEZE_REQUEST=14]="FREEZE_REQUEST",t[t.SET_SINGLE_VALUE_REQUEST=15]="SET_SINGLE_VALUE_REQUEST",t[t.SET_BORDERS_REQUEST=16]="SET_BORDERS_REQUEST",t[t.COPY_PASTE_REQUEST=17]="COPY_PASTE_REQUEST",t[t.CUT_PASTE_REQUEST=18]="CUT_PASTE_REQUEST",t[t.PASTE_DATA_REQUEST=19]="PASTE_DATA_REQUEST",t[t.CLEAR_FORMAT_REQUEST=20]="CLEAR_FORMAT_REQUEST",t[t.REPLACE_ALL_REQUEST=21]="REPLACE_ALL_REQUEST",t[t.SET_LINK_REQUEST=22]="SET_LINK_REQUEST",t[t.CLEAR_LINK_REQUEST=23]="CLEAR_LINK_REQUEST",t[t.CLEAR_RANGE_REQUEST=24]="CLEAR_RANGE_REQUEST",t[t.SET_NUMBER_FORMAT_REQUEST=25]="SET_NUMBER_FORMAT_REQUEST",t[t.ADJUST_DECIMALS_REQUEST=26]="ADJUST_DECIMALS_REQUEST",t[t.AUTO_FILL_REQUEST=27]="AUTO_FILL_REQUEST",t[t.SET_BASIC_FILTER_REQUEST=28]="SET_BASIC_FILTER_REQUEST",t[t.CLEAR_BASIC_FILTER_REQUEST=29]="CLEAR_BASIC_FILTER_REQUEST",t[t.EXPAND_DIMENSION_REQUEST=30]="EXPAND_DIMENSION_REQUEST",t[t.UPDATE_FILTER_CRITERIA_REQUEST=31]="UPDATE_FILTER_CRITERIA_REQUEST",t[t.SET_RANGE_VALUE_REQUEST=32]="SET_RANGE_VALUE_REQUEST",t[t.MULTI_REQUEST=33]="MULTI_REQUEST",t[t.CLEAR_COMMENT_REQUEST=34]="CLEAR_COMMENT_REQUEST",t[t.UPDATE_COMMENT_RANGE_REQUEST=35]="UPDATE_COMMENT_RANGE_REQUEST",t[t.DEFINE_COMMENT_RANGE_REQUEST=36]="DEFINE_COMMENT_RANGE_REQUEST",t[t.DELETE_COMMENT_RANGE_REQUEST=37]="DELETE_COMMENT_RANGE_REQUEST",t[t.SET_DIMENSION_FORMDATA_REQUEST=38]="SET_DIMENSION_FORMDATA_REQUEST",t[t.SET_DATA_VALIDATION_REQUEST=39]="SET_DATA_VALIDATION_REQUEST",t[t.REORDER_FILTER_REQUEST=40]="REORDER_FILTER_REQUEST",t[t.SET_HIDE_GRIDLINES_REQUEST=41]="SET_HIDE_GRIDLINES_REQUEST",t[t.ADD_CONDITIONAL_FORMAT_REQUEST=42]="ADD_CONDITIONAL_FORMAT_REQUEST",t[t.UPDATE_CONDITIONAL_FORMAT_REQUEST=43]="UPDATE_CONDITIONAL_FORMAT_REQUEST",t[t.DELETE_CONDITIONAL_FORMAT_REQUEST=44]="DELETE_CONDITIONAL_FORMAT_REQUEST",t[t.INSERT_SHEET_REQUEST=45]="INSERT_SHEET_REQUEST",t[t.DELETE_SHEET_REQUEST=46]="DELETE_SHEET_REQUEST",t[t.MOVE_SHEET_REQUEST=47]="MOVE_SHEET_REQUEST",t[t.HIDE_SHEET_REQUEST=48]="HIDE_SHEET_REQUEST",t[t.RENAME_SHEET_REQUEST=50]="RENAME_SHEET_REQUEST",t[t.COPY_SHEET_REQUEST=51]="COPY_SHEET_REQUEST",t[t.ADD_PROTECTED_RANGE_REQUEST=52]="ADD_PROTECTED_RANGE_REQUEST",t[t.UPDATE_PROTECTED_RANGE_REQUEST=53]="UPDATE_PROTECTED_RANGE_REQUEST",t[t.DELETE_PROTECTED_RANGE_REQUEST=54]="DELETE_PROTECTED_RANGE_REQUEST",t[t.ADD_EMBEDDED_OBJECT=55]="ADD_EMBEDDED_OBJECT",t[t.UPDATE_EMBEDDED_OBJECT=56]="UPDATE_EMBEDDED_OBJECT",t[t.DELETE_EMBEDDED_OBJECT=57]="DELETE_EMBEDDED_OBJECT",t[t.MOVE_EMBEDDED_OBJECT_TO_SHEET=58]="MOVE_EMBEDDED_OBJECT_TO_SHEET",t[t.SWITCH_FILTER_SYNC_REQUEST=59]="SWITCH_FILTER_SYNC_REQUEST",t[t.SET_IGNORED_ERROR_FLAGS=60]="SET_IGNORED_ERROR_FLAGS",t[t.ADD_LINKED_RANGE_REQUEST=61]="ADD_LINKED_RANGE_REQUEST",t[t.SET_HYPERLINK_RUNS_REQUEST=62]="SET_HYPERLINK_RUNS_REQUEST",t[t.SET_METADATA=63]="SET_METADATA",t[t.SET_REF_IDS=64]="SET_REF_IDS",t[t.INSERT_RANGE_REQUEST=65]="INSERT_RANGE_REQUEST",t[t.DELETE_RANGE_REQUEST=66]="DELETE_RANGE_REQUEST",t[t.MOVE_RANGE_REQUEST=67]="MOVE_RANGE_REQUEST",t[t.ADD_DATE_REMINDER_REQUEST=68]="ADD_DATE_REMINDER_REQUEST",t[t.DELETE_DATE_REMINDER_REQUEST=69]="DELETE_DATE_REMINDER_REQUEST",t[t.UPDATE_CONDITIONAL_FORMAT_REQUEST_INDEX=70]="UPDATE_CONDITIONAL_FORMAT_REQUEST_INDEX",t[t.SET_COLUMN_IGNORE_ERROR=71]="SET_COLUMN_IGNORE_ERROR",t[t.SET_PRIVATE_RANGE=72]="SET_PRIVATE_RANGE",t[t.ADD_WEWORK_COMPONENT_REQUEST=73]="ADD_WEWORK_COMPONENT_REQUEST",t[t.ADD_TODO_REQUEST=74]="ADD_TODO_REQUEST",t[t.DELETE_TODO_REQUEST=75]="DELETE_TODO_REQUEST",t[t.MODIFY_TODO_REQUEST=76]="MODIFY_TODO_REQUEST",t[t.ADD_NOTIFY_RANGE_REQUEST=77]="ADD_NOTIFY_RANGE_REQUEST",t[t.ADD_FILTER_VIEW=78]="ADD_FILTER_VIEW",t[t.DELETE_FILTER_VIEW=79]="DELETE_FILTER_VIEW",t[t.UPDATE_FILTER_VIEW=80]="UPDATE_FILTER_VIEW",t[t.ACTIVE_FILTER_VIEW=81]="ACTIVE_FILTER_VIEW",t[t.UPDATE_FILTER_RANGE_REQUEST=82]="UPDATE_FILTER_RANGE_REQUEST",t[t.COVER_SHEET_REQUEST=83]="COVER_SHEET_REQUEST",t[t.ADD_PIVOT_TABLE_REQUEST=84]="ADD_PIVOT_TABLE_REQUEST",t[t.DELETE_PIVOT_TABLE_REQUEST=85]="DELETE_PIVOT_TABLE_REQUEST",t[t.UPDATE_PIVOT_TABLE_REQUEST=86]="UPDATE_PIVOT_TABLE_REQUEST",t[t.CREATE_PIVOT_TABLE_DETAIL_SHEET_REQUEST=87]="CREATE_PIVOT_TABLE_DETAIL_SHEET_REQUEST"}(n||(n={})),e.Z=n},15858:function(t,e,n){"use strict";n.d(e,{S:function(){return r},l:function(){return l}}),n(46396),n(19553),n(38934),n(59677),n(71091),n(14199),n(47917),n(48912),n(34797),n(2725),n(12522),n(56687),n(10635),n(89512),n(57625),n(41403),n(76252),n(69398),n(49245),n(15421),n(554),n(81144),n(31688),n(10012),n(25594),n(71096);var r,o=n(89577),i=n(43706),a=n(47627),s=n(29835),u=n(91974),c=n(32275);!function(t){t.DV="DV",t.FORMULA="FORMULA",t.CHART="CHART",t.CONDITION="CONDITION",t.PIVOT_TABLE="PIVOT_TABLE"}(r||(r={}));var l=function(){function t(t){var e,n;this.getFormulaModelByRowCol=function(t,e,n,r){return r.inDegreeSegmentNode.nodeInfo.formulaModel||null};var o=Object.assign(Object.assign({},t),{getFormulaModelByRowCol:this.getFormulaModelByRowCol}),a=new i.nx.MergeableGraphSegmentManager(r.FORMULA,o),s=new i.nx.MergeableGraphSegmentManager(r.DV,o),u=new i.nx.BaseGraphSegmentManager(r.CONDITION,o);this.graphUpdateService=new i.nx.GraphUpdateService(o),this.formulaModelMap=((e={})[r.DV]=s,e[r.FORMULA]=a,e[r.CONDITION]=u,e),this.tempFormulaDataListMap=((n={})[r.FORMULA]=[],n[r.DV]=[],n),this.externalMethods=t}var e=t.prototype;return e.each=function(t,e,n){var i=this.formulaModelMap[t];if(i){var a=i.getTreeBySheetId(e),s=a.inDegreeTree,u=a.outDegreeTree;if(s||u){var c=new Set(null===s||void 0===s?void 0:s.all());null===u||void 0===u||u.all().forEach((function(t){t.relationshipSegments.forEach((function(t){c.add(t.node)}))})),c.forEach((function(e){var i,a=new o.Z(e.gridRange),s=a.sheetId,u=null===(i=e.nodeInfo)||void 0===i?void 0:i.formulaModel;t!==r.CONDITION?a.each((function(o,i){if(t===r.DV){var a=e.nodeInfo;n(Object.assign({row:o,col:i,sheetId:s,formulaModel:u},a))}else n({row:o,col:i,sheetId:s,formulaModel:u,nodeInfo:void 0})})):n(e.nodeInfo)}))}}},e.clear=function(){Object.values(this.formulaModelMap).forEach((function(t){t.destroy()}))},e.keyframeHandler=function(t){var e=this,n=t.sheet,r=n.data.rowData,o=n.getSheetId();r.forEach((function(t,n){t&&t.values.forEach((function(t,r){if(t){var i=t.getDataValidation();if(i){var a=new u.Z;a.setSlot(c.Z.SLOT_DATA_VALIDATION_RULE,i),e.addDataValidationData({row:n,col:r,sheetId:o},a)}var s=t.getFormula();if(s){var l=new u.Z;l.setSlot(c.Z.SLOT_FORMULA,s),e.addFormulaData({row:n,col:r,sheetId:o},l)}}}))})),this.updateFormulaModelManagerDataFinish(),n.conditionalFormatRuleManager.rules.forEach((function(t){e.addConditionalFormatData(t.id,t)}))},e.mapRange=function(t){this.commitMutation(Object.assign(Object.assign({},t),{id:i.zD.MUTATION_ID.MAP_RANGE_MUTATION,getAffectedSheetId:function(){return t.sheetId}}))},e.insertDimension=function(t){this.commitMutation(Object.assign(Object.assign({},t),{id:i.zD.MUTATION_ID.INSERT_DIMENSION_MUTATION,getAffectedSheetId:function(){return t.sheetId}}))},e.deleteDimension=function(t){this.commitMutation(Object.assign(Object.assign({},t),{id:i.zD.MUTATION_ID.DELETE_DIMENSION_MUTATION,getAffectedSheetId:function(){return t.sheetId}}))},e.moveSheet=function(t,e){this.commitMutation({toIndex:t,getAffectedSheetId:function(){return e},id:i.zD.MUTATION_ID.MOVE_SHEET_MUTATION})},e.deleteSheet=function(t,e){this.commitMutation({sheetIndex:t,sheetId:e,getAffectedSheetId:function(){return e},id:i.zD.MUTATION_ID.DELETE_SHEET_MUTATION})},e.insertSheet=function(t,e){this.commitMutation({sheetIndex:t,sheetId:e,getAffectedSheetId:function(){return e},id:i.zD.MUTATION_ID.INSERT_SHEET_MUTATION})},e.updateFormulaModelManagerDataFinish=function(){var t=this.tempFormulaDataListMap[r.FORMULA]||[];this.formulaModelMap[r.FORMULA].addNodesFromChangedNodes(t);var e=this.tempFormulaDataListMap[r.DV]||[];this.formulaModelMap[r.DV].addNodesFromChangedNodes(e),this.tempFormulaDataListMap[r.FORMULA]=[],this.tempFormulaDataListMap[r.DV]=[]},e.addFormulaData=function(t,e){var n=t.row,o=t.col,i=t.sheetId,a=(e.clearSlots&1<<c.Z.SLOT_FORMULA)===1<<c.Z.SLOT_FORMULA,s=(e.setSlots&1<<c.Z.SLOT_FORMULA)===1<<c.Z.SLOT_FORMULA;if(a||s){var u=void 0;a&&(u=void 0),s&&0===(null===(u=e.delta.formula||void 0)||void 0===u?void 0:u.getAllCellRangeWithFixedInfo().length)&&(u=void 0),this.setMapItem({type:r.FORMULA,row:n,col:o,sheetId:i,formulaModel:u,nodeInfo:{formulaModel:u}})}},e.addDataValidationData=function(t,e){var n,o=t.row,i=t.col,a=t.sheetId,s=(e.clearSlots&1<<c.Z.SLOT_DATA_VALIDATION_RULE)===1<<c.Z.SLOT_DATA_VALIDATION_RULE,u=(e.setSlots&1<<c.Z.SLOT_DATA_VALIDATION_RULE)===1<<c.Z.SLOT_DATA_VALIDATION_RULE;if(s||u){var l=void 0,h=e.delta.dataValidation;if(s&&(l=void 0),u){var d=null===(n=null===h||void 0===h?void 0:h.argTokens)||void 0===n?void 0:n.find((function(t){return t.formula}));0===(null===(l=(null===d||void 0===d?void 0:d.formula)||void 0)||void 0===l?void 0:l.getAllCellRangeWithFixedInfo().length)&&(l=void 0)}var f={type:r.DV,row:o,col:i,sheetId:a,formulaModel:l,nodeInfo:{dataValidation:h||void 0,formulaModel:l}};this.setMapItem(f)}},e.addConditionalFormatData=function(t,e){var n,o=this;if(e&&(null===e||void 0===e?void 0:e.rule)){var u=e.rule;if((null===(n=u.booleanConditionalFormat)||void 0===n?void 0:n.condition.type)===a.CONDITION_TYPE.CUSTOM_FORMULA){var c=u.booleanConditionalFormat.condition.values[0];if(c){var l=c.formula;if(l&&0!==l.getAllCellRangeWithFixedInfo().length){var h=this.formulaModelMap[r.CONDITION],d={formulaModel:l,id:e.id,index:e.index,rule:e.rule};u.ruleRanges.forEach((function(t){var e=new i.nx.GraphSegmentNode((0,s.Ad)(t),d);(null===l||void 0===l?void 0:l.getAllCellRangeWithFixedInfo()).forEach((function(n){var r=i.nx.getDepOffsetRangeByRefOffsetRangeAndPart(n,t),a=r.startRow,s=r.endRow,u=r.startCol,c=r.endCol;i.nx.getSheetIdsFromPart(n,t.sheetId,o.externalMethods.getSheetIdsAmongTwoSheets).forEach((function(t){var n=new i.nx.GraphSegmentNode(new i.zD.FormulaGridRange(t,a,s,u,c));h.addDependency(e,n)}))}))}))}}}}},e.removeConditionalFormatData=function(t,e){var n=this.formulaModelMap[r.CONDITION];e.forEach((function(e){n.searchInTree(e,i.nx.DegreeTreeType.IN_DEGREE).forEach((function(e){var r;(null===(r=e.nodeInfo)||void 0===r?void 0:r.id)===t&&n.removeNodeAndRelatedNodesInTree(e,i.nx.DegreeTreeType.IN_DEGREE)}))}))},e.setMapItem=function(t){var e=t.type;this.tempFormulaDataListMap[e]||(this.tempFormulaDataListMap[e]=[]),this.tempFormulaDataListMap[e].push(t)},e.commitMutation=function(t){var e=this,n=this.formulaModelMap;Object.keys(n).forEach((function(r){var o=n[r],a=e.graphUpdateService.updateGraphAfterMutation(o,t);o instanceof i.nx.MergeableGraphSegmentManager?e.rebuildInDegreeNodesByMergeableSegments(o,a,r):o instanceof i.nx.BaseGraphSegmentManager&&e.rebuildInDegreeNodesByBaseSegments(o,a,r)}))},e.rebuildInDegreeNodesByMergeableSegments=function(t,e,n){var a=[];e.forEach((function(e){var s=e.gridRange,u=e.nodeInfo,c=s.sheetId;t.removeNodeAndRelatedNodesInTree(e,i.nx.DegreeTreeType.IN_DEGREE),new o.Z(e.gridRange).each((function(t,e){var o,i;if(n===r.FORMULA)i=u.formulaModel;else if(n===r.DV){var s=u.dataValidation,l=null===(o=null===s||void 0===s?void 0:s.argTokens)||void 0===o?void 0:o.find((function(t){return t.formula}));i=(null===l||void 0===l?void 0:l.formula)||void 0}i&&!i.hasReferenceError&&a.push({row:t,col:e,sheetId:c,formulaModel:i,nodeInfo:u})}))})),t.addNodesFromChangedNodes(a)},e.rebuildInDegreeNodesByBaseSegments=function(t,e,n){var o=this;e.forEach((function(e){if(t.removeNodeAndRelatedNodesInTree(e,i.nx.DegreeTreeType.IN_DEGREE),n===r.CONDITION){var a=e.nodeInfo;if(!a.id)return;var s=a||void 0;o.addConditionalFormatData(a.id,s)}}))},t}()},41368:function(t,e,n){"use strict";n.d(e,{Z:function(){return c}}),n(90109),n(38934),n(46396),n(8195),n(31688),n(10012);var r=n(38808),o=n(29835),i=n(80067),a=n(33963),s=n(45422),u=function(){function t(t){var e=this;this.updateFormulaModelAfterRowColCutMove=function(t,e){var n,r=e.migrationMap,i=e.sourceStartIndex,u=e.sourceEndIndex,c=e.destinationIndex,l=e.sourceSheetId,h=e.isRow,d=e.row,f=e.col,p=e.nodeSheetId,v=!1,g=p===l,y=h?d:f,m=g&&(null===(n=r[y])||void 0===n?void 0:n.num),E="number"===typeof m?m:y,w=t.getParts().map((function(t){if("string"===typeof t)return t;var e=t.isCrossSheetReference,n=t.isStartRowRelative,r=t.isStartColRelative,a=t.isEndRowRelative,d=t.isEndColRelative,f=t.isCellRangeReferenceCorrect,p=t.isThreeDimensionalReference,m=t.startSheetId;if(!f)return t;var w=h?"startRowIndex":"startColIndex",S=h?"endRowIndex":"endColIndex",T=h?n:r,I=h?a:d,_=t[w],b=t[S],R=(0,o.sy)(_,y,T),O=(0,o.sy)(b,y,I),x=i<=R&&u>=R,C=i<=O&&u>=O;if(p||e&&l!==m||!e&&!g);else if(i<=R&&u>=O){var L=c-i;R+=L,O+=L,v=!0}else if(x||C){var A=c-i;R+=x?A:0,O+=C?A:0,v=!0}E!==y&&(v=!0);var N=t.getOptions();if(N[w]=T?R-E:R,N[S]=I?O-E:O,N[w]>N[S]){var D=[N[S],N[w]];N[w]=D[0],N[S]=D[1]}return s.ZP.createInstance(N)}));return{isFormulaChanged:v,newFormulaModel:a.Z.createInstance({formulaPartList:w})}},this.updateFormulaModelAfterRowColAdd=function(t,n){var r=n.mutationSheetId,o=n.index,i=n.amount,u=n.isRow,c=n.row,l=n.col,h=n.nodeSheetId,d=!1,f=h===r,p=u?c:l,v=f&&p>=o,g=t.getParts().map((function(t){if("string"===typeof t)return t;var n=t.isCrossSheetReference,a=t.isRowArray,c=t.isColArray;if(!t.isCellRangeReferenceCorrect)return t;var l=!1,g=u?c:a;if(n){if(t.isThreeDimensionalReference){var y=e.externalMethods.isSheetAmongTwoSheets(r,t.startSheetId,t.endSheetId);if(!v&&!y)return t;l=!0}else if(f)l=t.startSheetId!==r;else if(t.startSheetId!==r)return t}else if(h!==r)return t;if(g)return t;var m=u?"startRowIndex":"startColIndex",E=u?"endRowIndex":"endColIndex",w=t[m],S=t[E];return function(t){var e=u?t.isStartRowRelative:t.isStartColRelative,n=u?t.isEndRowRelative:t.isEndColRelative,r=t.getOptions();return e?v!==(!l&&w+p>=o)&&(r[m]=w+(v?-i:i),d=!0):!l&&w>=o&&(r[m]=w+i,d=!0),n?v!==(!l&&S+p>=o)&&(r[E]=S+(v?-i:i),d=!0):!l&&S>=o&&(r[E]=S+i,d=!0),s.ZP.createInstance(r)}(t)}));return{isFormulaChanged:d,newFormulaModel:a.Z.createInstance({formulaPartList:g})}},this.updateFormulaModelAfterRowColDel=function(t,n){var r=n.mutationSheetId,o=n.index,i=n.amount,u=n.isRow,c=n.row,l=n.col,h=n.nodeSheetId,d=!1,f=h===r,p=u?c:l,v=f&&p>=o,g=t.getParts().reduce((function(t,n){if("string"===typeof n)return t.push(n),t;var a=n.isCrossSheetReference,c=n.isRowArray,l=n.isColArray;if(!n.isCellRangeReferenceCorrect)return t.push(n),t;var g=!1,y=u?l:c;if(a){if(n.isThreeDimensionalReference){var m=e.externalMethods.isSheetAmongTwoSheets(r,n.startSheetId,n.endSheetId);if(!v&&!m)return t.push(n),t;g=!0}else if(f)g=n.startSheetId!==r;else if(n.startSheetId!==r)return t.push(n),t}else if(h!==r)return t.push(n),t;if(y)return t.push(n),t;var E="startColIndex",w="endColIndex",S=n.isStartColRelative,T=n.isEndColRelative,I=n.getAbsoluteStartCol(p),_=n.getAbsoluteEndCol(p);u&&(E="startRowIndex",w="endRowIndex",S=n.isStartRowRelative,T=n.isEndRowRelative,I=n.getAbsoluteStartRow(p),_=n.getAbsoluteEndRow(p));var b=!g&&I>=o&&I<o+i,R=!g&&_>=o&&_<o+i;return(R||b)&&(d=!0),!g&&b&&R?function(e){var n=t.length-1;return d=!0,a?t.push(s.ZP.createInstance(Object.assign(Object.assign({},e.getOptions()),{isCellRangeReferenceCorrect:!1}))):"string"===typeof t[n]?t[n]=t[n].concat("#REF!"):t.push("#REF!"),t}(n):(t.push(function(t){var e=b?o+i:I,n=R?o-1:_,r=S?e-p:e,a=T?n-p:n,u=t.getOptions();return u[E]=r,u[w]=a,S?v!==(!g&&e>=o)&&(u[E]=r-(v?-i:i),d=!0):!g&&e>=o&&(u[E]=r-i,d=!0),T?v!==(!g&&n>=o)&&(u[w]=a-(v?-i:i),d=!0):!g&&n>=o&&(u[w]=a-i,d=!0),s.ZP.createInstance(u)}(n)),t)}),[]);return{isFormulaChanged:d,newFormulaModel:a.Z.createInstance({formulaPartList:g})}},this.externalMethods=t}var e=t.prototype;return e.getChangedNodesAfterRowColAddDelete=function(t,e,n){var o=this,i=void 0===n?{}:n,a=i.isMovedNewPosition,s=i.onlyRefRangeChange,u=[],c=t.amount,l=t.index,h=t.sheetId,d=t.type.toLowerCase().indexOf("row")>-1,f=t.id===r.ZP.INSERT_DIMENSION_MUTATION;return e.forEach((function(t){t.oldRow=t.row,t.oldCol=t.col;var e=t.formulaModel,n={index:l,isRow:d,amount:c,sheetId:h,row:t.row,col:t.col,nodeSheetId:t.sheetId};if(!s||(f?e.isAffectedByRowColAdd(n):e.isAffectedByRowColDel(n))){var r=o.getChangedNodeByInsertOrDeleteMutation(t,{isRow:d,isAdd:f,amount:c,index:l,mutationSheetId:h},a),i=r.isFormulaChanged,p=r.isPositionChanged;(i||p)&&u.push(t)}})),u},e.getChangedNodesAfterRowColCutMoveMutation=function(t,e){for(var n=this,r=t.row,o=t.column,a=-1!==r.to,s=a?r:o,u=s.from,c=u.startIndex,l=u.endIndex,h=s.destinationSheetId,d=s.sourceSheetId,f=s.to,p=[],v={},g=c,y=0;g<=l;g++,y++){var m=f+y;v[g]={num:m,destinationSheetId:h,sourceSheetId:d}}return e.forEach((function(t){var e=t.row,r=t.col,o=t.sheetId,s=t.formulaModel;t.oldRow=t.row,t.oldCol=t.col;var u=n.updateFormulaModelAfterRowColCutMove(s,{sourceStartIndex:c,sourceEndIndex:l,destinationIndex:f,migrationMap:v,isRow:a,row:e,col:r,nodeSheetId:o,sourceSheetId:d}),h=u.isFormulaChanged,g=u.newFormulaModel,y=a?"row":"col",m=v[t[y]],E=o===d&&!(0,i.o8)(m)&&t[y]!==m.num;E&&(t[y]=m.num),(h||E)&&(t.formulaModel=g,p.push(t))})),p},e.getChangedNodesAfterReorderRangeMutation=function(t,e,n){var r=this,o=(void 0===n?{}:n).isMovedNewPosition,a=t.operation.rules,s=t.sheetId,u=t.range,c=u.startColIndex,l=u.endColIndex,h=[],d=-1,f=-1,p=Object.values(a||{}).reduce((function(t,e){var n,r=e.from,i=e.to;return d=-1===d?r:Math.min(d,r),f=-1===f?r:Math.max(f,r),o&&(r=(n=[i,r])[0],i=n[1]),t[r]={num:i,destinationSheetId:s,sourceSheetId:s},t}),{});return e.forEach((function(t){var e=t.col,n=t.sheetId,a=t.formulaModel;if(t.oldRow=t.row,t.oldCol=t.col,n===s){var u=t.row,d=(p[u]||{}).num;if(o){var f=[d,u];u=f[0],d=f[1]}if(!((0,i.o8)(d)||e<c||e>l)){var v=r.updateFormulaModelAfterReorderRange(a,{row:u,newRow:d}),g=v.isFormulaChanged,y=v.newFormulaModel,m=!o&&t.row!==d;m&&(t.row=d),(g||m)&&(t.formulaModel=y,h.push(t))}}})),h},e.getChangedNodesAfterSheetDeletedMutation=function(t,e){var n=this,r=t.sheetId,o=t.sheetIndex,i=[];return e.forEach((function(t){var e=t.formulaModel;t.oldRow=t.row,t.oldCol=t.col;var a=n.updateFormulaModelAfterSheetDeleted(e,{sheetId:r,originSheetIndex:o}),s=a.isFormulaChanged,u=a.newFormulaModel;s&&(t.formulaModel=u,i.push(t))})),i},e.getChangedNodeByInsertOrDeleteMutation=function(t,e,n){var r=e.isAdd,o=e.isRow,i=e.mutationSheetId,a=e.index,s=e.amount;void 0===n&&(n=!1);var u=r?this.updateFormulaModelAfterRowColAdd:this.updateFormulaModelAfterRowColDel,c=t.row,l=t.col,h=t.sheetId,d=t.formulaModel,f=o?c:l,p=c,v=l,g=c,y=l,m=r?1:-1;if(h!==i&&(m=0),n){var E=f>=a?m:0;o?p=c-E*s:v=l-E*s}else{var w=f>=a?m:0;o?g=c+w*s:y=l+w*s}if(!r&&i===h&&(o?p>=a&&p<=a+s-1:v>=a&&v<=a+s-1))return{isFormulaChanged:!1,isPositionChanged:!1};var S=u(d,{mutationSheetId:i,index:a,amount:s,isRow:o,row:p,col:v,nodeSheetId:h}),T=S.isFormulaChanged,I=S.newFormulaModel,_=p!==g||v!==y;return _&&(t.row=g,t.col=y),(T||_)&&(t.formulaModel=I),{isFormulaChanged:T,isPositionChanged:_}},e.updateFormulaModelAfterSheetDeleted=function(t,e){var n=this,r=e.sheetId,o=e.originSheetIndex,i=!1,u=t.getParts().map((function(t){if("string"===typeof t)return t;if(!t.isCrossSheetReference)return t;var e=t.getOptions();if(t.isThreeDimensionalReference){var a=n.externalMethods.getSheetIndexBySheetId(t.startSheetId),u=n.externalMethods.getSheetIndexBySheetId(t.endSheetId);if(a<0&&(a=o),u<0&&(u=o),t.startSheetId===r){var c=a>u?-1:0;e.startSheetId=n.externalMethods.getSheetIdBySheetIndex(o+c),i=!0}else if(t.endSheetId===r){var l=a>=u?0:-1;e.endSheetId=n.externalMethods.getSheetIdBySheetIndex(o+l),i=!0}}else t.startSheetId===r&&(e.startSheetId="#REF!",e.endSheetId="#REF!",i=!0);return s.ZP.createInstance(e)}));return{isFormulaChanged:i,newFormulaModel:a.Z.createInstance({formulaPartList:u})}},e.updateFormulaModelAfterReorderRange=function(t,e){var n=e.row,r=e.newRow,o=!1,i=t.getParts().reduce((function(t,e){if("string"===typeof e)return t.push(e),t;var i=e.isCrossSheetReference,a=e.isColArray;if(!e.isCellRangeReferenceCorrect||a)return t.push(e),t;var u=i,c="startRowIndex",l="endRowIndex",h=e.isStartRowRelative,d=e.isEndRowRelative,f=e[c],p=e[l],v=n-r,g=e.getOptions();if(h&&(u?(g[c]+=v,o=!0):f+r<0&&(g[c]=-r,o=!0)),d)if(u)g[l]+=v,o=!0;else if(p+r<0){var y=t.length-1;return"string"===typeof t[y]?t[y]=t[y].concat("#REF!"):t.push("#REF!"),o=!0,t}return t.push(s.ZP.createInstance(g)),t}),[]);return{isFormulaChanged:o,newFormulaModel:a.Z.createInstance({formulaPartList:i})}},t}(),c=function(){function t(t){this.externalMethods=t,this.updateFormulaModelLogic=new u({isSheetAmongTwoSheets:this.externalMethods.isSheetAmongTwoSheets,getSheetIdBySheetIndex:this.externalMethods.getSheetIdBySheetIndex,getSheetIndexBySheetId:this.externalMethods.getSheetIndexBySheetId}),this.strategyList=[]}var e=t.prototype;return e.registerStrategy=function(t){this.strategyList.push(t)},e.getChangedFormulaNode=function(t,e,n){var o=[];return t.id===r.ZP.INSERT_DIMENSION_MUTATION||t.id===r.ZP.DELETE_DIMENSION_MUTATION?o=this.updateFormulaModelLogic.getChangedNodesAfterRowColAddDelete(t,e,n):t.id===r.ZP.MAP_RANGE_MUTATION?o=this.updateFormulaModelLogic.getChangedNodesAfterRowColCutMoveMutation(t,e):t.id===r.ZP.REORDER_RANGE_MUTATION?o=this.updateFormulaModelLogic.getChangedNodesAfterReorderRangeMutation(t,e,n):t.id===r.ZP.DELETE_SHEET_MUTATION&&(o=this.updateFormulaModelLogic.getChangedNodesAfterSheetDeletedMutation(t,e)),o},t}()},16443:function(t,e,n){"use strict";n.d(e,{Z:function(){return E}});var r=n(13504),o=(n(38934),n(31688),n(41368)),i=(n(77468),n(48212)),a=n(81300),s=function(t){function e(e,n){return t.call(this,e,n)||this}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(t){var e=this;t.forEach((function(t){var n=t.row,r=t.col,o=t.formulaModel,i=t.sheetId,s=e.externalMethods.getSheetBySheetId(i),u=null===s||void 0===s?void 0:s.getCellDataAtPosition(n,r);null===u&&(u=new a.CellData,null===s||void 0===s||s.setCellDataAtPosition(n,r,u)),null===u||void 0===u||u.setFormula(o),null===u||void 0===u||u.setEditValue(o.toString(n,r,{getSheetTitleBySheetId:e.externalMethods.getSheetTitleBySheetId}));var c=new a.CellDataDelta;c.setSlot(a.CELL_DATA_SLOT.SLOT_FORMULA,o),e.formulaModelManager.addFormulaData({row:t.oldRow,col:t.oldCol,sheetId:i},c)})),this.formulaModelManager.updateFormulaModelManagerDataFinish()},n.getUpdateFormulaModelMutationsFromNodes=function(){return[]},e}(i.Z),u=(n(46396),n(68998)),c=n(11544),l=function(t){function e(e,n){return t.call(this,e,n)||this}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(t){var e=this;t.forEach((function(t){var n=t.row,r=t.col,o=t.formulaModel,i=t.sheetId,s=t.dataValidation,l=e.externalMethods.getSheetBySheetId(i),h=null===l||void 0===l?void 0:l.getCellDataAtPosition(n,r),d=[{type:u.Z.FORMULA_TOKEN,formula:o}],f=c.eJ.createInstance(Object.assign(Object.assign({},s.getOptions()),{argTokens:d}));null===h||void 0===h||h.setDataValidation(f);var p=new a.CellDataDelta;p.setSlot(a.CELL_DATA_SLOT.SLOT_DATA_VALIDATION_RULE,s),e.formulaModelManager.addDataValidationData({row:t.oldRow,col:t.oldCol,sheetId:i},p)})),this.formulaModelManager.updateFormulaModelManagerDataFinish()},n.getUpdateFormulaModelMutationsFromNodes=function(){return[]},e}(n(96403).Z),h=n(89654),d=n(56873),f=n(7692),p=n(89577),v=function(t){function e(e,n){return t.call(this,n,e)||this}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(t){var e=this;t.forEach((function(t){var n=t.workbookRangeId,r=t.embeddedObjectId,o=t.sheetId,i=t.row,a=t.col,s=t.formulaModel.toString(i,a,{getSheetTitleBySheetId:e.externalMethods.getSheetTitleBySheetId}),u=(0,f.moveEqualChar)(s),c="#REF!"===u?new p.Z(o,-1,-1,-1,-1):(0,d.hex2Range)(u,o),l=new h.ChartWorkbookRange({embeddedObjectId:r,id:n,range:c,type:h.WORKBOOK_RANGE_TYPE.CHART});e.workbookRangeManager.updateWorkbookRange(n,l)}))},n.getUpdateFormulaModelMutationsFromNodes=function(){return[]},e}(n(55543).Z),g=n(31598),y=n(73208),m=function(t){function e(e,n){return t.call(this,n,e)||this}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(t){var e=this;this.formulaModelManager&&(0,y.S)(t,this.externalMethods).forEach((function(t){var n=t.oldRule,r=t.newRule,o=(r.rule.ruleRanges||[])[0];if(o){var i=o.sheetId,a=e.externalMethods.getSheetBySheetId(i),s=null===a||void 0===a?void 0:a.conditionalFormatRuleManager;s&&s.updateConditionalFormatRule(n.index,r.rule)}}))},n.getUpdateFormulaModelMutationsFromNodes=function(){return[]},e}(g.Z),E=function(t){function e(e,n,r){var o;return(o=t.call(this,e)||this).formulaModelManager=r,o.registerStrategy(new s(r,{getSheetBySheetId:e.getSheetBySheetId,getSheetIdList:e.getSheetIdList,getSheetTitleBySheetId:e.getSheetTitleBySheetId})),o.registerStrategy(new l(r,{getSheetBySheetId:e.getSheetBySheetId,getSheetIdList:e.getSheetIdList})),o.registerStrategy(new v(n,{getSheetBySheetId:e.getSheetBySheetId,getSheetTitleBySheetId:e.getSheetTitleBySheetId})),o.registerStrategy(new m(r,{getSheetIdList:e.getSheetIdList,getSheetBySheetId:e.getSheetBySheetId,getSheetTitleBySheetId:e.getSheetTitleBySheetId})),o}(0,r.Z)(e,t);var n=e.prototype;return n.generateUpdateFormulaModelMutation=function(){return[]},n.updateFormulaModelFromMutation=function(t,e){var n=this,r=(void 0===e?{isMovedNewPosition:!1}:e).isMovedNewPosition;this.strategyList.forEach((function(e){var o=e.getFormulaModelNodes(t.sheetId),i=n.getChangedFormulaNode(t,o,{isMovedNewPosition:r});e.updateModel(i)}))},e}(o.Z)},70594:function(t,e,n){"use strict";n.d(e,{lO:function(){return x}});var r=n(13504),o=(n(38934),n(31688),n(93984),n(10012),n(91974)),i=n(32275),a=(n(71096),n(75832)),s=n(89577);function u(t,e){var n=[],r={};t.forEach((function(t){if(!(t.row<0||t.col<0)){var n=e(t);if(n){var o=t.sheetId,i=t.row,a=t.col,s={rowIndex:i,colIndex:a,cellDataDelta:n};if(r[o]){var u=r[o];u.cellDataDeltaAtPositions.push(s),u.minRow=Math.min(u.minRow,i),u.maxRow=Math.max(u.maxRow,i),u.minCol=Math.min(u.minCol,a),u.maxCol=Math.max(u.maxCol,a)}else r[o]={cellDataDeltaAtPositions:[s],minCol:a,minRow:i,maxRow:i,maxCol:a}}}}));for(var o=0,i=Object.keys(r);o<i.length;o++){var u=i[o],c=r[u],l=c.minRow,h=c.minCol,d=c.maxRow,f=c.maxCol,p=c.cellDataDeltaAtPositions,v=new a.Z({gridRange:new s.Z(u,l,d,h,f),cellDataDeltaAtPositions:p});n.push(v)}return n}var c,l=function(t){function e(e,n){return t.call(this,e,n)||this}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(t){return u(t,this.getFormulaCellDataDeltaFromNode.bind(this))},n.getFormulaCellDataDeltaFromNode=function(t){var e=t.formulaModel,n=new o.Z;return n.setSlot(i.Z.SLOT_FORMULA,e),n},e}(n(48212).Z),h=(n(46396),n(47627)),d=n(81300),f=function(t){function e(e,n){return t.call(this,e,n)||this}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(t){return u(t,this.getFormulaCellDataDeltaFromNode.bind(this))},n.getFormulaCellDataDeltaFromNode=function(t){var e=t.formulaModel,n=t.dataValidation,r=[{type:h.ARG_TOKEN_TYPE.FORMULA_TOKEN,formula:e}],a=d.DataValidationRuleFactory.createInstance(Object.assign(Object.assign({},n.getOptions()),{argTokens:r})),s=new o.Z;return s.setSlot(i.Z.SLOT_DATA_VALIDATION_RULE,a),s},e}(n(96403).Z),p=(n(77468),n(89654)),v=n(56873),g=n(7692),y=n(35631),m=function(t){function e(e,n,r){var o;return(o=t.call(this,r,e)||this).embeddedObjectManager=n,o}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(t){var e=this,n=[];return t.forEach((function(t){var r=t.formulaModel,o=t.row,i=t.col,a=t.sheetId,u=t.workbookRangeId,c=r.toString(o,i,{getSheetTitleBySheetId:e.externalMethods.getSheetTitleBySheetId}),l=(0,g.moveEqualChar)(c),h="#REF!"===l?new s.Z(a,-1,-1,-1,-1):(0,v.hex2Range)(l,a),d=e.generateUpdateWorkbookRangeMutation(u,h);d&&n.push(d)})),n},n.generateUpdateWorkbookRangeMutation=function(t,e){var n=this.workbookRangeManager.getChartWorkbookRangeById(t);if(!n)return null;var r=n.embeddedObjectId,o=this.embeddedObjectManager.getEmbeddedObject(r);if(!o)return null;var i=new p.WorkbookRangeDelta;return i.setEmbeddedObjectId(o.objectId),new y.Z({gridRange:e,workbookRangeId:t,workbookRangeType:p.WORKBOOK_RANGE_TYPE.CHART,workbookRangePropertiesDelta:i})},e}(n(55543).Z),E=n(58926),w=(n(49502),n(8195),n(31598)),S=n(97098),T=n(85145),I=n(73208),_=function(t){function e(e,n){return t.call(this,e,n)||this}(0,r.Z)(e,t);var n=e.prototype;return n.updateModel=function(){},n.getUpdateFormulaModelMutationsFromNodes=function(t){var e=(0,I.S)(t,this.externalMethods);return this.generateMutationsByNewRuleMap(e)},n.generateMutationsByNewRuleMap=function(t){var e=this,n=[],r=[];t.forEach((function(t,o){if(0!==t.newRule.rule.ruleRanges.length){var i=e.generateUpdateMutation(t,o);void 0!==i&&n.push(i)}else{var a=e.generateDeleteMutation(t,o);void 0!==a&&r.push(a)}}));var o=r.sort((function(t,e){return e.ruleIndex-t.ruleIndex}));return[].concat(n,(0,E.Z)(o))},n.generateDeleteMutation=function(t,e){var n=t.oldRule,r=n.rule.ruleRanges[0];if(r&&r.sheetId){var o=r.sheetId;if((n.rule.ruleRanges||[])[0])return new S.Z({sheetId:o,ruleIndex:e,oldRuleRanges:n.rule.ruleRanges})}},n.generateUpdateMutation=function(t,e){var n,r=t.newRule,o=(r.rule.ruleRanges||[])[0];if(o){var i=o.sheetId,a=null===(n=this.getConditionalFormatRuleManager(i))||void 0===n?void 0:n.getRuleByRuleIndex(e);if(a)return new T.Z({sheetId:i,ruleIndex:a.index,oldRuleRanges:a.rule.ruleRanges,rule:r.rule})}},e}(w.Z),b=n(41368),R=n(80067),O=function(t){function e(e,n,r,o){var i;return(i=t.call(this,e)||this).registerStrategy(new l(o,{getSheetBySheetId:e.getSheetBySheetId,getSheetIdList:e.getSheetIdList,getSheetTitleBySheetId:e.getSheetTitleBySheetId})),i.registerStrategy(new f(o,{getSheetBySheetId:e.getSheetBySheetId,getSheetIdList:e.getSheetIdList})),i.registerStrategy(new m(n,r,{getSheetBySheetId:e.getSheetBySheetId,getSheetTitleBySheetId:e.getSheetTitleBySheetId})),i.registerStrategy(new _({getSheetBySheetId:e.getSheetBySheetId,getSheetTitleBySheetId:e.getSheetTitleBySheetId},o)),i}(0,r.Z)(e,t);var n=e.prototype;return n.generateUpdateFormulaModelMutation=function(t,e){var n=this,r=(void 0===e?{isMovedNewPosition:!1}:e).isMovedNewPosition,o=[];return this.strategyList.forEach((function(e){var i=e.getFormulaModelNodes(t.sheetId),a=n.getChangedFormulaNode(t,i,{isMovedNewPosition:r,onlyRefRangeChange:e.onlyRefRangeChange}),s=e.getUpdateFormulaModelMutationsFromNodes(a);Array.prototype.push.apply(o,s)})),o},n.updateFormulaModelFromMutation=function(){},n.getInvertMutationsForRowReorderMutation=function(t){var e=t.operation.rules,n=t.sheetId,r=this.getMigrationMapForRowReorderFromRules({rules:e,sheetId:n}),o=[];return this.strategyList.forEach((function(e){var n=e.getFormulaModelNodes(t.sheetId).reduce((function(t,e){var n=e.row,o=r[n];return(0,R.o8)(o)||t.push(e),t}),[]),i=e.getUpdateFormulaModelMutationsFromNodes(n);Array.prototype.push.apply(o,i)})),o},n.getInvertMutationsForDeleteDimensionMutation=function(t){var e=t.amount,n=t.index,r=t.sheetId,o=t.type.toLowerCase().indexOf("row")>-1,i=[];return this.strategyList.forEach((function(t){var a=t.getFormulaModelNodes(r).filter((function(t){var i=t.formulaModel,a=t.sheetId,s=t.row,u=t.col;return i.isAffectedByRowColDel({index:n,amount:e,isRow:o,sheetId:r,nodeSheetId:a,row:s,col:u})})),s=t.getUpdateFormulaModelMutationsFromNodes(a);Array.prototype.push.apply(i,s)})),i},n.getMigrationMapForRowReorderFromRules=function(t){var e=t.rules,n=t.sheetId;return Object.values(e||{}).reduce((function(t,e){var r=e.from,o=e.to;return t[r]={num:o,destinationSheetId:n,sourceSheetId:n},t}),{})},e}(b.Z);function x(t){if(!c){var e={getSheetBySheetId:t.sheetManager.getSheetBySheetId.bind(t.sheetManager),getSheetIdList:t.sheetManager.getSheetIdList.bind(t.sheetManager),isSheetAmongTwoSheets:t.sheetManager.isSheetAmongTwoSheets.bind(t.sheetManager),getSheetIdBySheetIndex:t.sheetManager.getSheetIdBySheetIndex.bind(t.sheetManager),getSheetIndexBySheetId:t.sheetManager.getSheetIndexBySheetId.bind(t.sheetManager),getSheetTitleBySheetId:t.sheetManager.getSheetTitleBySheetId.bind(t.sheetManager)},n=t.workbookRangeManager,r=t.embeddedObjectManager,o=t.formulaModelManager;c=new O(e,n,r,o)}return c}},73208:function(t,e,n){"use strict";n.d(e,{S:function(){return i}}),n(38934),n(31688),n(77468),n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144);var r=n(84814),o=n(56873);function i(t,e){var n=new Map;return t.forEach((function(t){var i=t.ruleIndex,a=t.isCustomFormulaNode,s=t.isRuleRangeNode,u=t.formulaModel,c=t.sheetId,l=e.getSheetBySheetId(c),h=null===l||void 0===l?void 0:l.conditionalFormatRuleManager.getRuleByRuleIndex(i);if(h){var d=n.get(i)||{oldRule:h,newRule:{id:h.id,index:h.index,rule:h.rule.clone()}};n.set(i,d);var f=d.newRule;s&&(f.rule.ruleRanges=function(t,e){var n=t.row,i=t.col,a=t.sheetId,s=t.formulaModel,u=e.getSheetBySheetId(a);if(!u)return[];var c=[];return s.getAllCellRangeWithFixedInfo().forEach((function(t){var r=t.toString(n,i,{getSheetTitleBySheetId:e.getSheetTitleBySheetId});"#REF"!==r&&c.push((0,o.hex2Range)(r,a))})),(0,r.mergeGridRanges)((0,r.getExceptGridRange)(c,u))}(t,e)),a&&f.rule.getCustomFormula()&&f.rule.setCustomFormula(u)}})),n}},87175:function(t,e,n){"use strict";n.d(e,{Og:function(){return s},bb:function(){return y},c8:function(){return d},st:function(){return u},uY:function(){return r}}),n(52865),n(20670),n(38934),n(77468);var r,o=n(89577),i=n(10272),a=n(19031);function s(t,e){return e.startRowIndex===e.endRowIndex?function(t,e){var n=e.startColIndex,s=e.endColIndex,u=(0,a.ns)(t),h=null===u||void 0===u?void 0:u.contain(e);return n!==s||h?function(t,e){var n,i=e.startColIndex,a=e.endColIndex,s=t.getColCount()-1,u=e,h=c(t,e),d=l(t,h),f=d[0],p=d[1],g=t.getCellDataAtPosition(h.startRowIndex,p),y=null===g||void 0===g?void 0:g.getMergeReference();return y&&y.endColIndex>p&&(p=y.endColIndex),u=new o.Z(e.sheetId,h.startRowIndex,h.endRowIndex,f,p),n=i===a?r.SINGLE_CELL:0===i&&a===s?r.ONE_ROW_WHOLE:r.ONE_ROW_PART,[u,n,v(t,e)]}(t,e):[(0,i.ZP)(t,e),r.SINGLE_CELL,v(t,e)]}(t,e):function(t,e){var n=e.startRowIndex,s=e.endRowIndex,u=e.startColIndex,h=e.endColIndex,f=t.getRowCount()-1,y=(0,a.ns)(t),m=null===y||void 0===y?void 0:y.contain(e);if(function(t,e,n){return 0===t&&e===n}(n,s,f)){var E=function(t,e){var n=e.startColIndex,r=e.endColIndex,i=function(t,e){for(var n,r,o=e.startRowIndex,i=e.endRowIndex,a=e.startColIndex,s=e.endColIndex,u=function(e){for(var n=a-1;n<=s+1;n++)if(!d(t,e,n))return!1;return!0},c=o;c<=i;c++)if(!u(c)){n=c;break}if(void 0===n)return[o,o];for(var l=i;l>n;l--)if(!u(l)){r=l;break}return void 0===r&&(r=n),[n,r]}(t,e),a=i[0],s=i[1],u=new o.Z(e.sheetId,a,s,n,r),c=l(t,u),h=c[0],f=c[1];return new o.Z(e.sheetId,a,s,h,f)}(t,e),w=function(t,e){return t===e?r.ONE_COL_WHOLE:r.MULTI_COL_WHOLE}(u,h);return[E,w,v(t,e)]}if(function(t,e,n){return p(t,e)&&!n}(t,e,m))return[(0,i.ZP)(t,e),r.SINGLE_MERGE_CELL,v(t,e)];if(function(t,e,n){return function(t,e){for(var n=e.startRowIndex,r=e.endRowIndex,o=e.startColIndex,i=e.endColIndex,a=o;a<=i;a++){var s=t.getCellDataAtPosition(n,a),u=null===s||void 0===s?void 0:s.getMergeReference();if(u&&u.endRowIndex===r)return!0}return!1}(t,e)||n}(t,e,m))return function(t,e){var n,i=t.startRowIndex,a=t.endRowIndex,s=t.startColIndex,u=t.endColIndex,h=t,d=new o.Z(t.sheetId,a,a,s,u);d=c(e,d),d=new o.Z(t.sheetId,i,d.endRowIndex,s,u);var f=l(e,d),y=f[0],m=f[1];return h=new o.Z(t.sheetId,i,d.endRowIndex,y,m),n=p(e,t)?r.SINGLE_MERGE_CELL:r.MULTI_ROW_COL,h.equal(t)||(h=function(t,e){for(var n=e.startRowIndex,r=e.sheetId,i=e.startRowIndex,a=e.endRowIndex,s=e.startColIndex,u=e.endColIndex,c=i===a?a:i+1,l=i;l<=c&&(g(t,new o.Z(r,l,l,s,u))&&l<=c);l+=1){if(l===c){n=i;break}n=l+1}return new o.Z(r,n,e.endRowIndex,e.startColIndex,e.endColIndex)}(e,h)),[h,n,v(e,t)]}(e,t);var S=l(t,e),T=S[0],I=S[1];return[new o.Z(e.sheetId,e.startRowIndex,e.endRowIndex,T,I),r.MULTI_ROW_COL,v(t,e)]}(t,e)}function u(t,e){return!function(t,e){for(var n=e.startRowIndex;n<=e.endRowIndex;n++)for(var r=e.startColIndex;r<=e.endColIndex;r++)if(!d(t,n,r))return!1;return!0}(t,e)||!!function(t,e){var n=e.startRowIndex,r=e.endRowIndex,o=e.startColIndex,i=e.endColIndex;return n===r&&o===i||!!p(t,e)}(t,e)&&!(0,i.ZP)(t,e).equal(e)}function c(t,e){for(var n=e.startRowIndex,r=e.endRowIndex,i=e.startColIndex,a=e.endColIndex,s=t.getRowCount()-1,u=r,c=n;c<=s;c++){for(var l=!0,h=i;h<=a;h++)if(!d(t,c,h)){l=!1;break}if(l)break;u=c}return new o.Z(e.sheetId,n,u,i,a)}function l(t,e){for(var n,r,o=e.startRowIndex,i=e.endRowIndex,a=e.startColIndex,s=e.endColIndex,u=function(e){for(var n=o;n<=i;n++)if(!d(t,n,e))return!1;return!0},c=a;c<=s;c++)if(!u(c)){n=c;break}if(void 0===n)return[a,a];for(var l=s;l>n;l--)if(!u(l)){r=l;break}return void 0===r&&(r=n),[n,r]}function h(t,e,n,r){var o=t.getCellDataAtPosition(e,n,{filterViewId:r,isIgnoreFilterView:!r}),i=null===o||void 0===o?void 0:o.getEditValue();return!i||""===i.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function d(t,e,n,r){return f(t,e,n,r)?function(t,e,n,r){var o=t.getCellDataAtPosition(e,n,{filterViewId:r,isIgnoreFilterView:!r}),i=null===o||void 0===o?void 0:o.getMergeReference();return!!i&&h(t,i.startRowIndex,i.startColIndex)}(t,e,n,r):h(t,e,n,r)}function f(t,e,n,r){var o=t.getCellDataAtPosition(e,n,{filterViewId:r,isIgnoreFilterView:!r});return!!(null===o||void 0===o?void 0:o.getMergeReference())}function p(t,e){var n=e.startRowIndex,r=e.startColIndex,o=t.getCellDataAtPosition(n,r),i=null===o||void 0===o?void 0:o.getMergeReference();return!!i&&i.equal(e)}function v(t,e){for(var n=e.startRowIndex,r=e.endRowIndex,o=e.startColIndex,i=e.endColIndex,a=n;a<=r;a++)for(var s=o;s<=i;s++)if(f(t,a,s))return!0;return!1}function g(t,e){var n=e.startRowIndex,r=e.startColIndex,o=t.getCellDataAtPosition(n,r),i=null===o||void 0===o?void 0:o.getMergeReference();return!!i&&i.contain(e)}function y(t){var e,n,r;if(!(null===(e=t.parent)||void 0===e?void 0:e.sheetStatus.canEdit))return!1;var o=t.activeSheet.getBasicFilter(),i=null===o||void 0===o?void 0:o.range,a=null===(r=null===(n=t.parent)||void 0===n?void 0:n.permissions)||void 0===r?void 0:r.sheetStatus;return!(!a||!i)&&!a.checkRangeStatus(i)}!function(t){t[t.SINGLE_CELL=0]="SINGLE_CELL",t[t.SINGLE_MERGE_CELL=1]="SINGLE_MERGE_CELL",t[t.ONE_ROW_PART=2]="ONE_ROW_PART",t[t.ONE_ROW_WHOLE=3]="ONE_ROW_WHOLE",t[t.ONE_COL_WHOLE=4]="ONE_COL_WHOLE",t[t.MULTI_COL_WHOLE=5]="MULTI_COL_WHOLE",t[t.MULTI_ROW_COL=6]="MULTI_ROW_COL"}(r||(r={}))},10272:function(t,e,n){"use strict";n.d(e,{Jz:function(){return p},ZP:function(){return a}}),n(46396);var r=n(89577),o=n(87175);function i(t,e){for(var n=e.startRowIndex;n<=e.endRowIndex;n++)for(var r=e.startColIndex;r<=e.endColIndex;r++)if(!(0,o.c8)(t,n,r))return!1;return!0}function a(t,e,n){void 0===n&&(n=!0);var o=p(t,e);return n&&!o.equal(e)?function(t,e){var n=e.isCol||0===e.startRowIndex&&e.endRowIndex===t.getRowCount()-1,o=e.isRow||0===e.startColIndex&&e.endColIndex===t.getColCount()-1;if(!n){for(;e.endRowIndex>e.startRowIndex&&i(t,new r.Z(Object.assign(Object.assign({},e),{endRowIndex:e.startRowIndex})));)e=new r.Z(Object.assign(Object.assign({},e),{startRowIndex:e.startRowIndex+1}));for(;e.endRowIndex>e.startRowIndex&&i(t,new r.Z(Object.assign(Object.assign({},e),{startRowIndex:e.endRowIndex})));)e=new r.Z(Object.assign(Object.assign({},e),{endRowIndex:e.endRowIndex-1}))}if(!o){for(;e.endColIndex>e.startColIndex&&i(t,new r.Z(Object.assign(Object.assign({},e),{endColIndex:e.startColIndex})));)e=new r.Z(Object.assign(Object.assign({},e),{startColIndex:e.startColIndex+1}));for(;e.endColIndex>e.startColIndex&&i(t,new r.Z(Object.assign(Object.assign({},e),{startColIndex:e.endColIndex})));)e=new r.Z(Object.assign(Object.assign({},e),{endColIndex:e.endColIndex-1}))}return e}(t,o):o}function s(t,e,n,r,i){return!t||e>1||function(t,e,n){return(!(0,o.c8)(t,e-1,n)||!(0,o.c8)(t,e-1,n+1))&&(!(0,o.c8)(t,e-1,n-1)||!(0,o.c8)(t,e,n-1)||!(0,o.c8)(t,e+1,n-1))}(n,r,i)}function u(t,e,n,i,a,s,u){return function(t,e,n,r){return t&&e>=1&&n>=1&&!(0,o.c8)(r,e-1,n-1)}(t,e,n,s)?new r.Z(Object.assign(Object.assign({},u),{startRowIndex:e-1,startColIndex:n-1})):!!function(t,e,n,r,i){return t&&e>=1&&n<r-1&&!(0,o.c8)(i,e-1,n+1)}(t,e,i,a,s)&&new r.Z(Object.assign(Object.assign({},u),{startRowIndex:e-1,endColIndex:i+1}))}function c(t,e,n,i,a,s,u,c){return function(t,e,n,r,i){return t&&e<r-1&&n>=1&&!(0,o.c8)(i,e+1,n-1)}(t,e,n,a,u)?new r.Z(Object.assign(Object.assign({},c),{endRowIndex:e+1,startColIndex:n-1})):!!function(t,e,n,r,i){return t<n-1&&e<r-1&&!(0,o.c8)(i,t+1,e+1)}(e,i,a,s,u)&&new r.Z(Object.assign(Object.assign({},c),{endRowIndex:e+1,endColIndex:i+1}))}function l(t,e,n,r,o,i,a,s,l){return u(t,e,r,o,i,s,l)||c(t,n,r,o,a,i,s,l)}function h(t,e,n,o,a,s){return function(t,e,n,o){return t&&e>=1&&!i(o,new r.Z(Object.assign(Object.assign({},n),{startRowIndex:e-1,endRowIndex:e-1})))}(t,e,s,a)?new r.Z(Object.assign(Object.assign({},s),{startRowIndex:e-1})):!!function(t,e,n,o){return t<e-1&&!i(o,new r.Z(Object.assign(Object.assign({},n),{startRowIndex:t+1,endRowIndex:t+1})))}(n,o,s,a)&&new r.Z(Object.assign(Object.assign({},s),{endRowIndex:n+1}))}function d(t,e,n,o,a,s){return function(t,e,n,o){return t&&e>=1&&!i(o,new r.Z(Object.assign(Object.assign({},n),{startColIndex:e-1,endColIndex:e-1})))}(t,e,s,a)?new r.Z(Object.assign(Object.assign({},s),{startColIndex:e-1})):!!function(t,e,n,o){return t<e-1&&!i(o,new r.Z(Object.assign(Object.assign({},n),{startColIndex:t+1,endColIndex:t+1})))}(n,o,s,a)&&new r.Z(Object.assign(Object.assign({},s),{endColIndex:n+1}))}function f(t,e,n,r,o,i,a,s,u){return h(t,e,n,a,s,u)||d(t,r,o,i,s,u)}function p(t,e,n){void 0===n&&(n=!1);var o=t.getRowCount(),i=t.getColCount(),a=Date.now(),u=0,c=!1,h=new r.Z(Object.assign({},e));try{for(;u<o+i;){u+=1;var d=h,p=d.startRowIndex,v=d.startColIndex,g=d.endRowIndex,y=d.endColIndex,m=l(c=s(n,u,t,p,v),p,g,v,y,i,o,t,h),E=f(c,p,g,v,y,i,o,t,h);if(m)h=m;else{if(!E)return h;h=E}}return h}finally{var w=Date.now();window.log.info("startSearchArea used "+u+" iterations, took "+(w-a)+"ms")}}},9321:function(t,e,n){"use strict";n.d(e,{IA:function(){return i},Ly:function(){return o},MN:function(){return a},ev:function(){return c},m6:function(){return u},y2:function(){return s}}),n(38934);var r=n(54976),o={CELL_POSITION_INVALID:"userEnter-行列坐标不合法"};function i(t,e,n){for(var r=0;r<n.length;r++)if(!n[r].every((function(n,r){var o=t.getCellDataAtPosition(n,r);if(!o)return!0;var i=o.getConditionalFormatResult();return!i||!i.hasSlot(e)})))return!0;return!1}function a(t){return"number"===typeof t&&!isNaN(t)&&!(t<0)}function s(t,e){return a(t)&&a(e)}function u(t){var e=null===t||void 0===t?void 0:t.getSheetRangeReferences();return!!e&&e.some((function(t){return t.type===r.Z.COMMENT_RANGE}))}function c(t){var e,r;try{if(0!==t.id&&1!==t.id)return;var o=SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(t.sheetId);null===(e=n.g.log)||void 0===e||e.info("applyLocal","行列变换",t,"version: "+SpreadsheetApp.messageCenter.versionManager.getCurrentVersion()+", isLoaded: "+(null===o||void 0===o?void 0:o.isLoaded)+", rowCount: "+(null===o||void 0===o?void 0:o.getRowCount())+", colCount: "+(null===o||void 0===o?void 0:o.getColCount()))}catch(i){null===(r=n.g.log)||void 0===r||r.error("applyLocal","logLocalChangeDimension error")}}},91508:function(t,e,n){"use strict";n.d(e,{q:function(){return l}}),n(38934),n(31688),n(71096),n(12024),n(81502);var r=n(11376),o=n(78817),i=n.n(o),a={accountPrivs:"accountPrivs",maxRevisions:"accountPrivs.maxRevisions",advPolicy:"advPolicy",viewForbidCopyPrint:"advPolicy.view_forbid_copy_print",readerCanComment:"advPolicy.reader_can_comment",writerCanComment:"advPolicy.writer_can_comment",appInfoConfig:"appInfoConfig",clientIp:"clientIp",collabClientVars:"collab_client_vars",sid:"collab_client_vars.client.sid",upid:"collab_client_vars.client.upid",sig:"collab_client_vars.client.sig",tid:"collab_client_vars.client.tid",clientAgent:"collab_client_vars.clientAgent",dirty:"collab_client_vars.dirty",gray:"collab_client_vars.gray",dver:"collab_client_vars.dver",apid:"collab_client_vars.apid",websocket:"collab_client_vars.websocket",websocketReopenCount:"collab_client_vars.websocketReopenCount",pollingAttemptNumber:"collab_client_vars.pollingAttemptNumber",wmode:"collab_client_vars.wmode",ver:"collab_client_vars.ver",rev:"collab_client_vars.rev",pver:"collab_client_vars.pver",defaultSheetId:"collab_client_vars.padSubId",defaultData:"collab_client_vars.initialAttributedText.text",sheetList:"collab_client_vars.header[0].d",officialAuthInfo:"official_auth_info",docType:"padType",createdTime:"createdDate",title:"padTitle",guestPolicy:"initialOptions.guestPolicy",ip:"clientIp",expire:"privilegeExpire",policyType:"policy",canAddUser:"privilegeAttribute.can_add_user",canRead:"privilegeAttribute.can_read",canApplyEdit:"privilegeAttribute.can_apply_edit",isAuth:"privilegeAttribute.is_auth",canEdit:"privilegeAttribute.can_edit",canLinkExp:"privilegeAttribute.can_link_exp",canWaterMark:"privilegeAttribute.can_watermark",canHistory:"privilegeAttribute.can_history",canCopyDoc:"privilegeAttribute.can_copy_doc",canTranslate:"privilegeAttribute.can_translate",canAbout:"privilegeAttribute.can_about",canCopy:"privilegeAttribute.can_copy",canComment:"privilegeAttribute.can_comment",canSearch:"privilegeAttribute.can_search",canEditTitle:"privilegeAttribute.can_edit_title",canShare:"privilegeAttribute.can_share",canSpitSlot:"privilegeAttribute.can_spit_slot",canViewImage:"privilegeAttribute.can_view_image",canPrint:"privilegeAttribute.can_print",canModifyAuth:"wecomAllowOperations.canModifyAuth",canModifyAuthSelfInvited:"wecomAllowOperations.canModifyAuthSelfInvited",canModifyAuthAny:"wecomAllowOperations.canModifyAuthAny",canDelete:"wecomAllowOperations.canDelete",canClone:"wecomAllowOperations.canClone",canExport:"wecomAllowOperations.canExport",canForward:"wecomAllowOperations.canForward",canSaveAsLink:"wecomAllowOperations.canSaveAsLink",canMove:"wecomAllowOperations.canMove",canSaveAsTemplate:"wecomAllowOperations.canSaveAsTemplate",canShowInWedrive:"wecomAllowOperations.canShowInWedrive",relative:"relative",canTransferOwnership:"wecomAllowOperations.canTransferOwnership",avatar:"userInfo.avatar",corpId:"userInfo.corpId",corpName:"userInfo.corpName",isLogin:"isLogin",nick:"userInfo.nick",tinyid:"userInfo.tinyid",uid:"userInfo.uid",uidSource:"userInfo.uidSource",uin:"userInfo.uin",wxOpenid:"userInfo.wxOpenid",loginType:"userInfo.loginType",userName:"userName",userPic:"userPic",userType:"userType",vipInfo:"vipInfo",templateType:"templateInfo.templateType",templateId:"templateInfo.templateId",tenantId:"docInfo.tenantId",ownerIsMigrate:"docInfo.ownerIsMigrate",ownerCorpName:"docInfo.owner_corp_name",useByExternal:"use_by_external"},s={padType:"sheet",isProPad:!0,shortLink:"",docStatus:0,advPolicy:{},lastModifyUser:"",uin:"",isEmbed:!1,invitedGroupInfos:[],newOpenSvc:-1,nameGuess:null,colorPalette:[],userId:"",domainId:"",useFbChat:!1,localPadId:"",userName:"",disableFB:!1,relativeUrl:null,newPad:!1,collab_client_vars:{apid:{},apool:{},bad:-1,client:{upid:"",sid:"",sig:"",tid:0},dirty:-1,dver:"2.0.0",globalPadId:"",gray:-1,header:[{id:"BB08J2",name:r.ZP.t("工作表")}],initialAttributedText:{text:[],attribs:""},padId:"",padSubId:"",padType:"",pollingAttemptNumber:-1,pos:-1,pver:-1,rev:-1,ver:-1,websocket:!1,websocketReopenCount:-1,wmode:"",clientAgent:""},createdDate:15489504e5,padTitle:"",isUserChangeTitle:-1,initialOptions:{guestPolicy:""},globalPadId:"",titleIsReadOnly:!1,isSnapshot:!1,relative:null,envi:null,userColor:-1,isOwner:!1,policy:-1,friendUserIds:[],clientIp:"",appInfoConfig:null,userIsGuest:!1,ownerId:"",proTitle:"",userDomain:"",specialKey:null,isTimDomain:!1,isOverConNum:!1,shouldGetFbLoginStatus:!1,initialSpaces:null,ownerAppid:"",accountPrivs:{maxRevisions:1e8},isPublicPad:!1,userInfo:{},vipInfo:{type:"NONE",beginTime:0,endTime:0},padId:"",rightFlag:-1,isPadAdmin:!1,siteName:"",isLogin:!1,initialRevisionList:[],specialKeyTranslation:null,userPic:"",privilegeExpire:-1,privilegeAttribute:{can_edit:0,can_read:1},creatorId:"",userLoginCorpId:"",userLoginCorpName:"",initialTitle:"",creatorDomain:"",isOpendocxfromTim:!1,isCreator:!1,encrypted:"",userLink:"",metaCreateTime:15489504e5,dropboxConnected:!1,invitedUserInfos:[],tinyid:"",lastModifyTime:15489504e5,isTimOnline:!1,preview:"",oPadSubId:"",userType:"",enableToCVipFeature:!1,templateInfo:{},newPadType:""},u=n(44240),c=n.n(u),l=new(function(){function t(t){this.needCacheList=["isOwner","ownerId","tinyid"],this.cache={},this.clientVars=t}var e=t.prototype;return e.getConfig=function(t){var e=this.getConfigByCache(t);if(e)return e.value;var n=a[t]||t,r=c()(this.clientVars,n);return this.cacheConfig(t,r),r},e.setConfig=function(t){var e=this;Object.keys(t).forEach((function(n){var r=a[n]||n,o=t[n];i()(e.clientVars,r,o),e.cacheConfig(n,o)}))},e.reloadConfig=function(t){this.clientVars=t,this.clearCache()},e.cacheConfig=function(t,e){this.needCacheList.includes(t)&&(this.cache[t]=e)},e.getConfigByCache=function(t){if(this.needCacheList.includes(t)&&t in this.cache)return{value:this.cache[t]}},e.clearCache=function(){this.cache={}},t}())(s)},93595:function(t,e,n){"use strict";function r(t){var e,r={keyframe:[],actions:[],lastKeyFrameActions:[],hasKeyFrame:!1};if(Array.isArray(t))r.actions=t;else try{r.actions=[JSON.parse(unescape(t))]}catch(o){null===(e=n.g.log)||void 0===e||e.error("transKeyFrame",null===o||void 0===o?void 0:o.message,null===o||void 0===o?void 0:o.stack)}return r}n.d(e,{C:function(){return r}})},87509:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var r=n(31973),o=n(20445),i=n(93595),a=n(16535),s=n(17144);function u(t,e,u,c,l,h){var d,f,p;void 0===h&&(h={});var v=t.sheetManager.getSheetBySheetId(e);if(null===(d=n.g.log)||void 0===d||d.debug("flow k2sConverter start"),v){var g=h,y=g.beforeConvert,m=g.afterConvert;p=+new Date;var E=(0,i.C)(u);n.g.needOpenSpeedReport&&r.ZP.speed.runReport(o.SPEED_REPORT_POINTS.KEYFRAME_TRANSFORM,p,+new Date);var w=E.keyframe;"function"===typeof y&&y(v,w),p=+new Date,(0,a.zf)(t,E.actions,{sheetId:e,startRowIndex:c,endRowIndex:l}),E.actions.length&&v.correct(),n.g.needOpenSpeedReport&&r.ZP.tdwReport({opername:"quality_doc",module:"excel_detail",action:"first_screen_mutation_count",ver5:E.actions.length}),"function"===typeof m&&m(E);var S=new s.Z({sheetId:v.getSheetId(),lastRow:v.getRowCount()-1,lastCol:v.getColCount()-1});t.parent.mutationBehavior.applyMutation(S,{isLocal:!0},v)}return null===(f=n.g.log)||void 0===f||f.debug("flow k2sConverter end"),v}},58725:function(t,e,n){"use strict";n.d(e,{R:function(){return a}});var r=n(91508),o=n(80067),i=n(36943);function a(){var t,e;s(),null===(e=null===(t=window.tdocs)||void 0===t?void 0:t.onUrlChange)||void 0===e||e.call(t,(function(t){s(t.url)}))}function s(t){var e=t||r.q.getConfig("originalUrl")||location.href;"openAuthDlg"===(0,o.IZ)("wdop",e)&&(0,i.$y)("CooperationV3",(function(t){var e=r.q.getConfig("globalPadId"),n=r.q.getConfig("title"),o=r.q.getConfig("padTitle"),i=r.q.getConfig("corpId"),a=r.q.getConfig("creatorCorpName"),s=r.q.getConfig("uid"),u="avd-container",c=document.getElementById(u);c||((c=document.createElement("div")).id=u,document.body.appendChild(c)),t.init(c,{thirdAuthPanel:{type:"enterpriseWx",options:{globalPadId:e,title:n||o,corpId:i,corpName:a,uid:s}}})}))}},79478:function(t,e,n){"use strict";n.d(e,{J:function(){return d}}),n(38934),n(48845),n(46396),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(56592),o=n.n(r),i=n(62986),a=n(91508),s=n(20998),u=n.n(s),c="//"+n(8326).Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/doc_info";function l(){l=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var h={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var h=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};function d(t){var e;return h(this,void 0,void 0,l().mark((function r(){var s,h;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,new Promise((function(t,e){o().post(c,u().stringify({domainId:a.q.getConfig("domainId"),localPadId:a.q.getConfig("padId"),getCollected:1,getIsAddedMy:1,xsrf:(0,i.f)()})).then((function(e){var n=e.data;if(0===n.retcode)return t(n)})).catch((function(t){return e(t)}))}));case 3:s=r.sent,h={docType:s.doc_meta.doc_type,docUrl:s.doc_url,createTime:1e3*s.doc_meta.create_ts,createNick:s.creator_nick,ownerName:s.owner_nick,ownerCorpId:s.owner_corp_id,ownerCorpName:s.owner_corp_name,ownerAvatar:s.owner_avatar,ownerUidSource:s.owner_uid_source,isCollected:s.is_collected,isAddedMy:s.is_added_my,tenantId:s.doc_meta.tenant_id,ownerIsMigrate:s.doc_meta.wedrive_info.owner_is_migrate,lastModifyNick:s.last_modify_nick,certification:Object.assign({isCertification:!!s.doc_meta.official_auth_info},s.doc_meta.official_auth_info)},null===t||void 0===t||t(h),r.next=12;break;case 8:r.prev=8,r.t0=r.catch(0),console.error(r.t0),null===(e=n.g.log)||void 0===e||e.error("[DocInfo] 获取DocInfo失败",r.t0);case 12:case"end":return r.stop()}}),r,null,[[0,8]])})))}},27429:function(t,e,n){"use strict";n.d(e,{_:function(){return r}});var r=(0,n(76138).yh)("IFeature")},99789:function(t,e,n){"use strict";n.d(e,{XY:function(){return S},cM:function(){return o},rX:function(){return w}}),n(90109),n(71096);var r,o,i=n(11376),a=n(74140),s=n(81300),u=n(66935),c=n(39935),l=n(7950),h=n(72303),d=n(46634),f=n(18997),p=n(8641),v=n(11726),g=n(72094),y=n(83408),m=n(92096),E=n(7032);!function(t){t.SELECT="select",t.CHECKBOX="checkbox",t.STAR="star",t.PROGRESS="progress",t.ID_CARD="id-card",t.PHONE_NUMBER="phone-number",t.TELEPHONE_NUMBER="telephone-number",t.EMAIL="email",t.NUMBER="number",t.TEXT="text",t.DATE_TIME="date-time",t.TEMPERATURE="temperature"}(o||(o={}));var w=((r={})[o.SELECT]={icon:h,iconName:"data_validation_list",text:i.ZP.t("下拉选项"),customDataType:a.ZP.SELECT,ruleType:s.DATA_VALIDATION_RULE_TYPE.LIST},r[o.CHECKBOX]={icon:c,iconName:"data_validation_checkbox",text:i.ZP.t("复选框"),customDataType:a.ZP.CHECKBOX,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_CHECKBOX},r[o.STAR]={icon:m,iconName:"data_validation_star",text:i.ZP.t("评星"),customDataType:a.ZP.STAR,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_STAR},r[o.PROGRESS]={icon:y,iconName:"data_validation_progress",text:i.ZP.t("进度"),customDataType:a.ZP.PROGRESS,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_PROGRESS},r[o.ID_CARD]={icon:f,iconName:"data_validation_idcard",text:i.ZP.t("身份证"),customDataType:a.ZP.ID,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_ID_CARD},r[o.PHONE_NUMBER]={icon:v,iconName:"data_validation_phone",text:i.ZP.t("手机号"),customDataType:a.ZP.PHONE_NUM,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_NUM_PHONE},r[o.TELEPHONE_NUMBER]={icon:g,iconName:"data_validation_telephone",text:i.ZP.t("电话号码"),customDataType:a.ZP.TELEPHONE_NUM,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_NUM_TEL},r[o.EMAIL]={icon:d,iconName:"data_validation_mail",text:i.ZP.t("电子邮箱"),customDataType:a.ZP.EMAIL,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_TEXT_MAIL},r[o.NUMBER]={icon:p,iconName:"data_validation_number",text:i.ZP.t("数字"),customDataType:a.ZP.NUMBER,ruleType:s.DATA_VALIDATION_RULE_TYPE.NUMBER_FLOAT_AND_INT},r[o.TEXT]={icon:E,iconName:"data_validation_text",text:i.ZP.t("文本内容/长度"),customDataType:a.ZP.TEXT,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_TEXT_CONTAINS},r[o.DATE_TIME]={icon:l,iconName:"data_validation_date",text:i.ZP.t("时间日期"),customDataType:a.ZP.DATE_TIME,ruleType:s.DATA_VALIDATION_RULE_TYPE.DATE},r[o.TEMPERATURE]={icon:u,iconName:"data_validation_temperature",text:i.ZP.t("温度"),customDataType:a.ZP.TEMPERATURE,ruleType:s.DATA_VALIDATION_RULE_TYPE.CUSTOM_NUMBER_TEMPERATURE},r),S=Object.keys(w).map((function(t){return{id:t,text:w[t].text,icon:w[t].icon}}))},55578:function(t,e,n){"use strict";var r,o,i;n.d(e,{h6:function(){return r},ob:function(){return o},sS:function(){return i}}),function(t){t.CONTENT="content",t.LENGTH="length",t.INT="int",t.FLOAT="float",t.ID_CARD="id-card",t.PHONE="phone",t.MAIL="mail",t.URL="url",t.GENDER="gender",t.NONE="none",t.TEMPERATURE="temperature",t.PROGRESS="progress",t.TELEPHONE="telephone"}(r||(r={})),function(t){t.LIST="list",t.NUMBER="number",t.TEXT="text",t.DATE="date",t.AVAILABLE="available",t.CHECKBOX="checkbox",t.STAR="star",t.ATTACHMENT="attachment",t.CONTACT="contact"}(o||(o={})),function(t){t[t.NONE=0]="NONE",t[t.INT=1]="INT",t[t.FLOAT=2]="FLOAT",t[t.LENGTH=3]="LENGTH",t[t.DATE=4]="DATE"}(i||(i={}))},20241:function(t,e,n){"use strict";n.d(e,{J:function(){return s}}),n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(56592),o=n.n(r);function i(){i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(O){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var v={};u(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,u(m,"constructor",p),u(p,"constructor",f),f.displayName=u(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,o,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}n(36156),n(91508);var a=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},s=function(){var t={relateform:!0,wedrive:!0,wedoc:!0,txdocGray:!1},e=function(){return a(void 0,void 0,void 0,i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=5;break;case 4:return e.abrupt("return",o().post("/disk/get_config").then((function(e){var n,r,o,i,a=e.data;if(0===(null===(n=null===a||void 0===a?void 0:a.head)||void 0===n?void 0:n.ret)&&(null===(r=null===a||void 0===a?void 0:a.body)||void 0===r?void 0:r.auth_flag)){var s=null===(o=null===a||void 0===a?void 0:a.body)||void 0===o?void 0:o.auth_flag,u=(512&s)<=0,c=(1024&s)<=0,l=(2048&s)<=0,h=null===(i=null===a||void 0===a?void 0:a.body)||void 0===i?void 0:i.txdoc_gray;return t={wedoc:l,relateform:u,wedrive:c,txdocGray:h}}return t})).catch((function(){return t})));case 5:return e.abrupt("return",Promise.resolve(t));case 7:case"end":return e.stop()}}),e)})))};return e(),{fetch:e,get:function(){return t}}}()},55075:function(t,e,n){"use strict";function r(t){if("string"===typeof t&&o(t)){var e=t.replace(/(")[^"]*?\1/g,"");e=(e=e.replace(/'.*?'!/g,"")).replace(/\n$/g,"");for(var n=0,r=0,i=0;i<e.length;++i)"("===e[i]?n+=1:")"===e[i]&&(r+=1);n-r===1&&(t+=")")}return t}function o(t){return"string"===typeof t&&"="===t[0]&&t.length>1}n.d(e,{$:function(){return r},j:function(){return o}}),n(52865),n(20670)},51421:function(t,e,n){"use strict";n.d(e,{gI:function(){return o},x2:function(){return i}});var r=[];function o(t){r.push(t)}function i(){for(;r.length>0;){var t=r.pop();t&&t()}}},50838:function(t,e,n){"use strict";n.d(e,{E:function(){return d},EG:function(){return h},nn:function(){return l}}),n(38934),n(31688),n(62077),n(52865),n(20670),n(77468);var r,o=n(45422),i=n(33963),a=n(81300),s=n(43706),u=n(29835),c=[];function l(t){r=t,c.forEach((function(t){f(t)})),c=[]}function h(t,e,n,a,c){void 0===c&&(c={});var l=c,h=l.filterViewRelativeRow,d=l.filterViewRelativeCol,f=r.parse,p=t.replace(/^=/,"").trim(),v=(0,u.k1)(e,n,a),g=f(p,{row:e,col:n,sheetId:a,id:v}),y=function(t,e,n,r){return void 0!==n&&(t=n),void 0!==r&&(e=r),{formulaRowIndex:t,formulaColIndex:e}}(e,n,h,d);if(e=y.formulaRowIndex,n=y.formulaColIndex,s.AD.isCellNode(g)){var m,E=((m={})[s.AD.AST_TYPE.CELL]=function(t,r,i){var a=r.cellId,c="",l="";s.AD.isCellNodeCrossTable(r)&&(c=r.sheetId,l=r.sheetId);var h=s.AD.isCurrentNodeInPositionRelyFunction(r,i),d=(0,u.cn)(a),f=d.row,p=d.col,v=d.isRowRelative,g=d.isColRelative,y=v?f-e:f,m=g?p-n:p;t.push(o.ZP.createInstance({startColIndex:m,endColIndex:m,startRowIndex:y,endRowIndex:y,isStartColRelative:g,isEndColRelative:g,isStartRowRelative:v,isEndRowRelative:v,isPositionRely:h,startSheetId:c,endSheetId:l}))},m[s.AD.AST_TYPE.CELL_RANGE]=function(t,r,i){var a=r.originValue,c=r.cellRangeType,l=r.start,h=r.end,d="",f="",p=s.AD.isCurrentNodeInPositionRelyFunction(r,i);if(s.AD.isCellRangeNodeCrossTable(r)&&(d=r.startSheetId,f=r.endSheetId),"COL"===c){var v=!/\$/.test(l),g=!/\$/.test(h),y=(0,s.VT)(l)-(v?n:0),m=(0,s.VT)(h)-(g?n:0);t.push(o.ZP.createInstance({startColIndex:y,endColIndex:m,startRowIndex:0,endRowIndex:0,isStartColRelative:v,isEndColRelative:g,isStartRowRelative:!0,isEndRowRelative:!0,isColArray:!0,isPositionRely:p,startSheetId:d,endSheetId:f}))}else if("ROW"===c){var E=!/\$/.test(l),w=!/\$/.test(h),S=(0,s.Fz)(l)-(E?e:0),T=(0,s.Fz)(h)-(w?e:0);t.push(o.ZP.createInstance({startColIndex:0,endColIndex:0,startRowIndex:S,endRowIndex:T,isStartColRelative:!0,isEndColRelative:!0,isStartRowRelative:E,isEndRowRelative:w,isRowArray:!0,isPositionRely:p,startSheetId:d,endSheetId:f}))}else if("NORMAL"===c){var I=(0,u.cn)(l),_=I.row,b=I.col,R=I.isRowRelative,O=I.isColRelative,x=(0,u.cn)(h),C=x.row,L=x.col,A=x.isRowRelative,N=x.isColRelative,D=Math.min(b,L),M=Math.max(b,L),P=Math.min(C,_),k=Math.max(_,C),U=R?P-e:P,F=O?D-n:D,j=A?k-e:k,B=N?M-n:M;t.push(o.ZP.createInstance({startColIndex:F,endColIndex:B,startRowIndex:U,endRowIndex:j,isStartColRelative:O,isEndColRelative:N,isStartRowRelative:R,isEndRowRelative:A,isPositionRely:p,startSheetId:d,endSheetId:f}))}else t.push(a)},m),w=[];g.body&&(w=g.body.toFormulaModel(E));for(var S=[],T="=",I=0;I<w.length;I++){var _=w[I];o.ZP.isTargetType(_)?(""!==T&&(S.push(T),T=""),S.push(_)):T+=_,I===w.length-1&&""!==T&&S.push(T)}return i.Z.createInstance({formulaPartList:S})}return i.Z.createInstance({formulaPartList:[t]})}function d(t){var e=t.cellDataDelta;0!==(e.setSlots&1<<a.CELL_DATA_SLOT.SLOT_FORMULA)&&e.delta.formula&&(r?f(t):c.push(t))}function f(t){var e,n=t.cellDataDelta,r=t.spreadsheet,o=t.sheetId,i=t.rowIndex,a=t.colIndex,s=n.delta.formula,u=!1,c=!1,l=5e3;if(s.getParts().forEach((function(t){if("string"===typeof t){var e=t.toLowerCase();(e.indexOf("row")>-1||e.indexOf("offset")>-1)&&(u=!0)}else Array.isArray(t)&&t.isPositionRely&&(c=!0)})),u&&!c){var d=h(s.toString(l,l,r.sheetManager),l,l,"NOEXIST"),f=null===(e=r.sheetManager.getSheetBySheetId(o))||void 0===e?void 0:e.getCellDataAtPosition(i,a,{isIgnoreFilterView:!0});f&&f.setFormula(d)}}},55566:function(t,e,n){"use strict";n.d(e,{f:function(){return a}}),n(38934),n(31688),n(19553),n(81144);var r=n(55075),o=n(74140),i=n(80227);function a(t,e){var n=t.sheetManager.getSheetBySheetId(e),o=function(t){var e=!1,n=!1;if(t)for(var o=t.getRowCount(),i=t.getColCount(),a=0;a<o&&(!e||!n);a++){var u=t.data.rowData[a];if(u)for(var c=0;c<i&&(!e||!n);c++){var l=u.values[c];l&&(e=e||(0,r.j)(l.getEditValue()),n=n||s(l))}}return{hasFormula:e,hasDataValidation:n}}(n),a=o.hasFormula,u=o.hasDataValidation,c=!!n&&n.conditionalFormatRuleManager.rules.length>0,l=function(t,e){var n=!1,r=t.embeddedObjectManager.embeddedObjectMap;return r.size>0&&r.forEach((function(t){n||t.properties.type===i.NEW_EMBEDDED_OBJECT_TYPE.CHART&&t.location.sheetId===e&&(n=!0)})),n}(t,e),h=Boolean(null===n||void 0===n?void 0:n.pivotTableManager.pivotTableMap.size);return{hasFormula:a,hasDataValidation:u,hasChart:l,hasConditionalFormat:c,hasPivotTable:h,needLoadInWorker:a||u||l||c||h}}function s(t){var e=t.getDataValidation();if(!e)return!1;var n=t.getCellType();if(!n)return!0;var r=!(n!==o.d9.DATE_TIME||!e.operator);return(0,o.NI)(n)||(0,o.J$)(n,e)||r}},23951:function(t,e,n){"use strict";n.d(e,{Un:function(){return p},pw:function(){return f},v:function(){return d}});var r=n(44240),o=n.n(r),i=n(27716),a=n(27571),s=n(56873),u=n(21496),c=n(61224),l=n(76062),h=n(6769);function d(t){var e=t.sourceSheet,n=t.pivotTableItemId,r=t.tableDef,o=t.cacheDef,i=t.calcSingleFormula,a={displayTable:[[]],colHeadStartRow:0,dataStartRow:0,shouldMergeCells:[]},s=p(e,o);if(!s)return a;var u=(0,h.HP)(r,o),d=u.rowCriterias,f=u.colCriterias,v=u.pageCriterias,g=u.dataFields,y=(0,l.c)({sourceDatas:s,rowCriterias:d,colCriterias:f,pageCriterias:v,dataFields:g,calcSingleFormula:i});return y?(0,c.wB)({statistics:y,rowCriterias:d,colCriterias:f,pageCriterias:v,dataFields:g,pivotTableItemId:n,isDataOnRows:r.dataOnRows}):a}function f(t){var e,n=t.sourceSheet,r=t.tableDef,i=t.cacheDef,a=t.path,s=p(n,i);if(!s)return[];var u=(0,h.HP)(r,i),c=u.rowCriterias,d=u.colCriterias,f=u.pageCriterias,v=u.dataFields,g=(0,l.c)({sourceDatas:s,rowCriterias:c,colCriterias:d,pageCriterias:f,dataFields:v});if(!g)return[];var y=g.pivotTree,m=o()(y,a);return(null===(e=null===m||void 0===m?void 0:m[0])||void 0===e?void 0:e.rowDatas)||[]}function p(t,e){var r,o,c;if((null===(r=e.cacheSource)||void 0===r?void 0:r.type)!==i.S.SmlWorksheet)return n.g.log.error("[PivotTable] 传入了非同workbook数据源"),null;var l=null===(c=null===(o=e.cacheSource)||void 0===o?void 0:o.worksheetSource)||void 0===c?void 0:c.ref;if(!l)return n.g.log.error("[PivotTable] cacheDefinition无ref"),null;var h=(0,s.hex2Range)(l,t.getSheetId()),d=new a.GridRange(h.sheetId,h.startRowIndex+u.ZB,h.endRowIndex,h.startColIndex,h.endColIndex);return t.getCellDatasAtRange(d)}},21496:function(t,e,n){"use strict";n.d(e,{Cf:function(){return N},Em:function(){return b},Im:function(){return p},Kn:function(){return L},N0:function(){return M},NZ:function(){return I},Pk:function(){return g},UQ:function(){return y},Ve:function(){return S},Vi:function(){return T},YZ:function(){return w},ZB:function(){return h},ZJ:function(){return C},dU:function(){return E},eG:function(){return D},eH:function(){return k},i4:function(){return O},kA:function(){return f},kG:function(){return x},lu:function(){return _},o:function(){return m},rk:function(){return P},sN:function(){return v},uP:function(){return d},wj:function(){return R}});var r,o,i,a=n(11376),s=n(82614),u=n(32569),c=n(96065),l=n(45841),h=1,d="__subtotal__",f=1,p=1,v=3,g=9,y=g+p+1,m=v+1,E=-2,w=-1,S=c.Z.createInstance("#a3abb8"),T=c.Z.createInstance("#c5cad3"),I=c.Z.createInstance("#dcdfe4"),_=c.Z.createInstance("#f3f5f7"),b=c.Z.createInstance("#000000"),R=c.Z.createInstance("#5c5c5c"),O=c.Z.createInstance("#7b7b7b"),x=c.Z.createInstance("#9d9d9d"),C=["COUNTA","COUNT"],L=((r={})[s.N.PBDEFAULT]="SUM",r[s.N.Average]="AVERAGE",r[s.N.Count]="COUNTA",r[s.N.CountNums]="COUNT",r[s.N.Max]="MAX",r[s.N.Min]="MIN",r[s.N.Product]="PRODUCT",r[s.N.StdDev]="STDEVA",r[s.N.StdDevp]="STDEVPA",r[s.N.Sum]="SUM",r[s.N.Var]="VARA",r[s.N.Varp]="VARPA",r),A="DEFAULT_SUBTOTAL_METHOD",N=((o={})[u.I.PBDEFAULT]=A,o[u.I.Default]=A,o[u.I.Avg]="AVERAGE",o[u.I.Count]="COUNT",o[u.I.CountA]="COUNTA",o[u.I.Max]="MAX",o[u.I.Min]="MIN",o[u.I.Product]="PRODUCT",o[u.I.StdDev]="STDEVA",o[u.I.StdDevP]="STDEVPA",o[u.I.Sum]="SUM",o[u.I.Var]="VARA",o[u.I.VarP]="VARPA",o),D=((i={})[u.I.PBDEFAULT]=a.ZP.t("pivot-table|求和项："),i[u.I.Avg]=a.ZP.t("pivot-table|平均值项："),i[u.I.Count]=a.ZP.t("pivot-table|计数项："),i[u.I.CountA]=a.ZP.t("pivot-table|计数项："),i[u.I.Max]=a.ZP.t("pivot-table|最大值项："),i[u.I.Min]=a.ZP.t("pivot-table|最小值项："),i[u.I.Product]=a.ZP.t("pivot-table|乘积项："),i[u.I.StdDev]=a.ZP.t("pivot-table|标准偏差项："),i[u.I.StdDevP]=a.ZP.t("pivot-table|总体标准偏差项："),i[u.I.Sum]=a.ZP.t("pivot-table|求和项："),i[u.I.Var]=a.ZP.t("pivot-table|方差项："),i[u.I.VarP]=a.ZP.t("pivot-table|总体方差项："),i),M=[{originalName:"",field:{fld:0,subtotal:s.N.Sum}}],P=a.ZP.t("存在循环引用，请先移除数据源中的循环引用部分。"),k=[l.B.ROW_SUBTOTAL,l.B.COL_SUBTOTAL,l.B.ROW_GRAND_TOTAL,l.B.COL_GRAND_TOTAL]},61224:function(t,e,n){"use strict";n.d(e,{wh:function(){return H},rr:function(){return Z},wB:function(){return V}});var r=n(58926),o=(n(8195),n(90109),n(19553),n(38934),n(81144),n(44904),n(84919),n(93984),n(31688),n(46396),n(25594),n(12024),n(81502),n(78817)),i=n.n(o),a=n(44240),s=n.n(a),u=n(8198),c=n.n(u),l=n(11376),h=n(45841),d=n(6769),f=n(21496),p=n(27571),v=n(32569),g=(n(49502),n(36130)),y=n.n(g),m=n(33810),E=n(42427),w=n(65937);function S(t){var e=t.paths,n=t.criterias,r=t.isRow,o=t.pivotTree,i=t.hasOtherAxis;if(!o||n.every((function(t){return!R(t)})))return e;var a=I({paths:e,isRow:r,level:0,startIndex:0,endIndex:e.length-1,hasOtherAxis:i}),s=a.segments,u=a.subtotalIndex,c={pivotTreePath:[],startIndex:0,endIndex:e.length-1,subSegments:s,subtotalIndex:u};_(s,n,o,0);var l=[];return T(e,l,c,0),l}function T(t,e,n,r){var o=n.subSegments,i=n.subtotalIndex,a=n.endIndex;if(!o||0===o.length)return e[r]=t[a],r+1;var s=r;return o.forEach((function(n){s=T(t,e,n,s)})),"number"===typeof i?(e[s]=t[i],s+1):s}function I(t){var e,n,r=t.paths,o=t.level,i=t.startIndex,a=t.endIndex,s=t.isRow,u=t.hasOtherAxis;if(i>=a||o>=(0,d.QF)(r))return{};for(var c=[],l=void 0,h=i,f=h+1;f<=a+1;f++){var p=null===(e=r[f])||void 0===e?void 0:e[o],v=null===(n=r[f-1])||void 0===n?void 0:n[o];if(!p||!y()(p,v)){var g=h,m=f-1;if(h=f,null===v||void 0===v?void 0:v.subtotalMethod)l=m;else{var E={pivotTreePath:b(r[m],s,u),startIndex:g,endIndex:m},w=I({level:o+1,isRow:s,paths:r,startIndex:g,endIndex:m,hasOtherAxis:u}),S=w.segments,T=w.subtotalIndex;E.subSegments=S,E.subtotalIndex=T,c.push(E)}}}return{segments:c,subtotalIndex:l}}function _(t,e,n,r){var o=e[r];if(t&&o){if(R(o)){var i=o.valueSortIndex,a=o.field;t.sort((function(t,e){var r,o,u,c,l=null===(r=s()(n,t.pivotTreePath))||void 0===r?void 0:r[i],h=null===(o=s()(n,e.pivotTreePath))||void 0===o?void 0:o[i];if(!l||!h)return 1;var d=null===(u=(l.defaultSubtotalBucket||l).result)||void 0===u?void 0:u.value,f=null===(c=(h.defaultSubtotalBucket||h).result)||void 0===c?void 0:c.value,p=a.sortType===m.L.Ascending?E.Z.PositiveSequence:E.Z.ReverseOrder;return(0,w.h4)({A2:d,A1:f,isAsc:p})}))}t.forEach((function(t){_(t.subSegments,e,n,r+1)}))}}function b(t,e,n){var r=t.filter((function(t){return t})).map((function(t){return t.subtotalMethod?f.uP:t.effectiveValue.key}));return n&&(e?r.push(f.uP):r.unshift(f.uP)),r}function R(t){var e=t.valueSortIndex,n=t.field;return"number"===typeof e&&[m.L.Ascending,m.L.Descending].includes(n.sortType)}var O=n(76062),x=n(52731),C=n(8266),L=n(38086),A=n(31406);function N(t){var e=t.displayTable,n=t.dataStartCol,r=t.dataStartRow,o=t.nonBodyRows,i=t.pivotTableItemId,a=t.colHeadNameLines;!function(t){var e=t.nonBodyRows,n=t.dataStartRow,r=t.displayTable,o=t.pivotTableItemId,i=(0,d.Cp)(r).cols,a=new p.GridRange("",e,n-1,0,i-1);M({displayTable:r,range:a,format:x.Z.createInstance({textFormat:L.TextFormat.createInstance({bold:!0}),backgroundColor:f.Ve}),defaultRef:{id:o,pivotCellType:h.B.TABLE_HEAD}})}({nonBodyRows:o,dataStartRow:r,displayTable:e,pivotTableItemId:i}),function(t){var e,n,r=t.dataStartRow,o=t.dataStartCol,i=t.displayTable,a=t.pivotTableItemId,s=(0,d.Cp)(i),u=s.rows,c=s.cols,l=new p.GridRange("",r,u-1,0,o-1);M({displayTable:i,range:l,format:x.Z.createInstance({backgroundColor:f.NZ,borders:L.Borders.createInstance({bottom:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.kG}),left:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.i4})})}),defaultRef:function(t,e){if(e<o)return{id:a,pivotCellType:h.B.ROW_SUBTOTAL}}});for(var v=[],g=0;g<o-1;g++)for(var m=r;m<u;m++){var E=null===(e=i[m])||void 0===e?void 0:e[g],w=null===(n=i[m+1])||void 0===n?void 0:n[g];y()(E,w)||v.push(new p.GridRange("",m,m,g,c-1))}v.forEach((function(t){M({displayTable:i,range:t,format:x.Z.createInstance({borders:L.Borders.createInstance({bottom:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.Em})})})})}))}({dataStartRow:r,dataStartCol:n,displayTable:e,pivotTableItemId:i}),function(t){var e,n,r=t.dataStartRow,o=t.dataStartCol,i=t.displayTable,a=t.nonBodyRows,s=t.colHeadNameLines,u=(0,d.Cp)(i),c=u.rows,l=u.cols,h=new p.GridRange("",a+s,r-1,o,l-1);M({displayTable:i,range:h,format:x.Z.createInstance({borders:L.Borders.createInstance({bottom:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.wj}),right:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.wj})})})});for(var v=[],g=h.startRowIndex;g<r-1;g++)for(var m=o;m<l;m++){var E=null===(e=i[g])||void 0===e?void 0:e[m],w=null===(n=i[g])||void 0===n?void 0:n[m+1];y()(E,w)||v.push(new p.GridRange("",g,c-1,m,m))}v.forEach((function(t){M({displayTable:i,range:t,format:x.Z.createInstance({borders:L.Borders.createInstance({right:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.Em})})})})}))}({displayTable:e,colHeadNameLines:a,dataStartCol:n,dataStartRow:r,nonBodyRows:o}),function(t){var e=t.nonBodyRows,n=t.dataStartRow,r=t.dataStartCol,o=t.displayTable,i=t.colHeadNameLines,a=(0,d.Cp)(o).cols,s=new p.GridRange("",e,n-1,0,r-1);if(D({displayTable:o,range:s,viewMergeReference:s}),i){var u=new p.GridRange("",e,e+i-1,r,a-1);D({displayTable:o,range:u,viewMergeReference:u}),M({displayTable:o,range:u,format:x.Z.createInstance({borders:L.Borders.createInstance({bottom:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.Em})})})})}}({nonBodyRows:o,dataStartRow:r,dataStartCol:n,displayTable:e,colHeadNameLines:a}),function(t){var e=t.nonBodyRows,n=t.dataStartCol,r=t.displayTable,o=t.dataStartRow,i=(0,d.Cp)(r),a=i.rows,s=i.cols,u=new p.GridRange("",e,a-1,n,n);M({displayTable:r,range:u,format:x.Z.createInstance({borders:L.Borders.createInstance({left:A.Z.createInstance({style:L.BORDER_STYLE.MEDIUM,color:f.Em})})})});var c=new p.GridRange("",o,o,0,s-1);M({displayTable:r,range:c,format:x.Z.createInstance({borders:L.Borders.createInstance({top:A.Z.createInstance({style:L.BORDER_STYLE.MEDIUM,color:f.Em})})})})}({nonBodyRows:o,dataStartCol:n,displayTable:e,dataStartRow:r}),function(t){for(var e,n=t.nonBodyRows,r=t.dataStartRow,o=t.dataStartCol,i=t.displayTable,a=(0,d.Cp)(i),s=a.rows,u=a.cols,c=[],l=[],v=n;v<r;v++)for(var g=o;g<u;g++){var y=null===(e=i[v])||void 0===e?void 0:e[g],m=null===y||void 0===y?void 0:y.pivotTableRef.pivotCellType;m===h.B.COL_SUBTOTAL?c.push(g):m===h.B.COL_GRAND_TOTAL&&l.push(g)}c.forEach((function(t){M({displayTable:i,range:new p.GridRange("",r,s-1,t,t),format:x.Z.createInstance({backgroundColor:f.lu})})})),l.forEach((function(t){M({displayTable:i,range:new p.GridRange("",r,s-1,t,t),format:x.Z.createInstance({backgroundColor:f.NZ})})}))}({nonBodyRows:o,dataStartRow:r,dataStartCol:n,displayTable:e}),function(t){for(var e,n=t.dataStartCol,r=t.dataStartRow,o=t.displayTable,i=(0,d.Cp)(o),a=i.rows,s=i.cols,u=[],c=[],l=0;l<n;l++)for(var v=r;v<a;v++){var g=null===(e=o[v])||void 0===e?void 0:e[l],y=null===g||void 0===g?void 0:g.pivotTableRef.pivotCellType;y===h.B.ROW_SUBTOTAL?u.push(new p.GridRange("",v,v,l,s-1)):y===h.B.ROW_GRAND_TOTAL&&c.push(new p.GridRange("",v,v,l,s-1))}u.forEach((function(t){M({displayTable:o,range:t,format:x.Z.createInstance({backgroundColor:f.Vi})})})),c.forEach((function(t){M({displayTable:o,range:t,format:x.Z.createInstance({backgroundColor:f.Vi})})}))}({dataStartCol:n,dataStartRow:r,displayTable:e}),function(t){var e=t.displayTable,n=t.pivotTableItemId,r=t.nonBodyRows,o=t.dataStartRow,i=t.dataStartCol;(function(t,e){var n=(0,d.Cp)(t).cols,r=new p.GridRange("",0,0,0,n-1);M({displayTable:t,range:r,format:x.Z.createInstance({borders:L.Borders.createInstance({top:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.Em})})}),defaultRef:{id:e,pivotCellType:h.B.TITLE}})})(e,n),function(t){var e=t.displayTable,n=t.nonBodyRows,r=t.pivotTableItemId,o=t.dataStartRow,i=(0,d.Cp)(e),a=i.rows,s=i.cols,u=new p.GridRange("",0,a-1,s-1,s-1);M({displayTable:e,range:u,format:x.Z.createInstance({borders:L.Borders.createInstance({right:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.Em})})}),defaultRef:function(t){return t<n?{id:r,pivotCellType:h.B.HEADER}:t>=n&&t<o?{id:r,pivotCellType:h.B.TABLE_HEAD}:{id:r,pivotCellType:h.B.DATA}}})}({displayTable:e,nonBodyRows:r,pivotTableItemId:n,dataStartRow:o}),function(t,e,n){var r=(0,d.Cp)(t).rows,o=new p.GridRange("",0,r-1,0,0);M({displayTable:t,range:o,format:x.Z.createInstance({borders:L.Borders.createInstance({left:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.Em})})}),defaultRef:function(t){if(t<e)return{id:n,pivotCellType:h.B.HEADER}}})}(e,r,n),function(t,e,n){var r=(0,d.Cp)(t),o=r.rows,i=r.cols,a=new p.GridRange("",o-1,o-1,0,i-1);M({displayTable:t,range:a,format:x.Z.createInstance({borders:L.Borders.createInstance({bottom:A.Z.createInstance({style:L.BORDER_STYLE.THIN,color:f.Em})})}),defaultRef:function(t,r){return r<e?{id:n,pivotCellType:h.B.ROW_SUBTOTAL}:{id:n,pivotCellType:h.B.DATA}}})}(e,i,n)}({displayTable:e,pivotTableItemId:i,nonBodyRows:o,dataStartRow:r,dataStartCol:n})}function D(t){k({displayTable:t.displayTable,range:t.range,propertyName:"viewMergeReference",propertyValue:t.viewMergeReference,defaultRef:t.defaultRef})}function M(t){k({displayTable:t.displayTable,range:t.range,propertyName:"format",propertyValue:t.format,defaultRef:t.defaultRef,propertyValueMerger:P})}function P(t,e){var n=[t,e].filter((function(t){return t}));return(0,C.mergeCellFormats)(n)}function k(t){var e=t.displayTable,n=t.range,r=t.propertyName,o=t.propertyValue,a=t.defaultRef,u=t.propertyValueMerger,c=(0,d.Cp)(e),l=c.rows,h=c.cols;n.each((function(t,n){if(!(t>=l||n>=h)){var c=s()(e,[t,n]);if(c){var d,f=c.pivotTableRef[r],p=u?u(f,o):o,v=c.pivotTableRef;c=Object.assign(Object.assign({},c),{pivotTableRef:Object.assign(Object.assign({},v),(d={},d[r]=p,d))})}else{var g,y="function"===typeof a?a(t,n):a;if(!y)return void console.error("空 display cell，并且没有提供 defaultRef");c={effectiveValue:null,pivotTableRef:Object.assign(Object.assign({},y),(g={},g[r]=o,g))}}i()(e,[t,n],c)}}))}function U(t){var e=t.table,n=t.colHeadEndRow,o=t.rowHeadEndCol,i=t.nonBodyRows,a=t.hasAppendDatasOnRows,s=t.colHeadNameLines,u=function(t){for(var e,n,r,o,i=t.table,a=t.colHeadEndRow,s=t.rowHeadEndCol,u=t.hasAppendDatas,c=[],l=0;l<=s;l++)for(var d=a+1,f=d+1;f<=i.length;f++){var v=l>0?l-1:l,g=null===(e=i[f])||void 0===e?void 0:e[l],m=null===(n=i[f])||void 0===n?void 0:n[v],E=null===(r=i[f-1])||void 0===r?void 0:r[l],w=null===(o=i[f-1])||void 0===o?void 0:o[v];if(!(g&&y()(g,E)&&y()(m,w))){var S=d,T=f-1,I=(null===E||void 0===E?void 0:E.pivotTableRef.pivotCellType)===h.B.ROW_SUBTOTAL;if(T>S||I){var _=l;I&&(_=s-(u?1:0)),(T>S||_>l)&&c.push(new p.GridRange("",S,T,l,_))}d=f}}return c}({table:e,colHeadEndRow:n,rowHeadEndCol:o,hasAppendDatas:!0===a}),c=function(t){for(var e,n,r,o,i=t.table,a=t.colHeadEndRow,s=t.rowHeadEndCol,u=t.nonBodyRows,c=t.hasAppendDatas,l=t.colHeadNameLines,f=(0,d.QF)(i),v=[],g=u+l,m=g;m<=a;m++)for(var E=s+1,w=E+1;w<=f;w++){var S=m>g?m-1:m,T=null===(e=i[m])||void 0===e?void 0:e[w],I=null===(n=i[S])||void 0===n?void 0:n[w],_=null===(r=i[m])||void 0===r?void 0:r[w-1],b=null===(o=i[S])||void 0===o?void 0:o[w-1];if(!(T&&y()(T,_)&&y()(I,b))){var R=E,O=w-1,x=(null===_||void 0===_?void 0:_.pivotTableRef.pivotCellType)===h.B.COL_SUBTOTAL;if(O>R||x){var C=m;x&&(C=a-(c?1:0)),(C>m||O>R)&&v.push(new p.GridRange("",m,C,R,O))}E=w}}return v}({table:e,colHeadEndRow:n,rowHeadEndCol:o,nonBodyRows:i,hasAppendDatas:!1===a,colHeadNameLines:s});return[].concat((0,r.Z)(u),(0,r.Z)(c))}var F=[h.B.COL_LEAF,h.B.COL_SUBTOTAL,h.B.COL_PARENT,h.B.DATA_LEAF],j=-1,B=(0,d.Yt)(1);function Z(t,e,n){var o,i=(0,d.HP)(t,e),a=i.rowCriterias,s=i.colCriterias,u=i.pageCriterias,c=i.dataFields;o=0===[].concat((0,r.Z)(a),(0,r.Z)(s)).length?{pivotTree:{},values:c.map((function(){return null}))}:(0,O.c)({rowCriterias:a,colCriterias:s,pageCriterias:u,dataFields:c,isCheckHasValueOnly:!0,sourceDatas:n});var l=V({rowCriterias:a,colCriterias:s,dataFields:c,pageCriterias:u,pivotTableItemId:"",statistics:o,isDataOnRows:t.dataOnRows,isPredict:!0}).displayTable;return(0,d.Cp)(l)}function V(t){var e=t.statistics,n=e.pivotTree,o=e.values,a=t.rowCriterias,s=t.colCriterias,u=t.dataFields,c=t.pageCriterias,v=t.pivotTableItemId,g=t.isDataOnRows,y=void 0!==g&&g,m=t.isPredict,E=void 0!==m&&m;if(null===o||void 0===o?void 0:o.length)return function(t){var e,n=t.statistics.values,o=t.dataFields,i=t.pageCriterias,a=t.pivotTableItemId,s=H(a),u=G(i,a),c=function(t,e,n){var r=n.map((function(e){var n=e.field.name;return{pivotTableRef:{id:t,pivotCellType:h.B.DATA_LEAF},effectiveValue:(0,d.Yt)(n)}})),o=e.map((function(e){return{pivotTableRef:{id:t,pivotCellType:h.B.DATA},effectiveValue:e}}));return[r,o]}(a,n,o),l=Math.max.apply(Math,[(null===(e=u[0])||void 0===e?void 0:e.length)||0].concat((0,r.Z)(c.map((function(t){return t.length}))))),f=[Array(l).fill(s)].concat((0,r.Z)(u),(0,r.Z)(c)),v=f.length-c.length,g=new p.GridRange("",0,0,0,l-1);return{displayTable:f,colHeadStartRow:v,dataStartRow:v+1,shouldMergeCells:[g]}}(t);var w=H(v),S=G(c,v),T=function(t){var e=t.rowCriterias,n=t.pivotTableItemId,r=t.dataFields,o=t.pivotTree,a=t.shouldAppendData,s=t.hasOtherAxis;if(0===e.length&&0===r.length)return function(t){var e={pivotTableRef:{id:t,pivotCellType:h.B.ROW_LEAF,fieldIndex:f.YZ},effectiveValue:(0,d.Yt)(l.ZP.t("行"))};return Array(f.Pk).fill([e])}(n);var u=[[]];return Q(e,!0,n,u),W({singleAxisCriterias:e,isRow:!0,pivotTableItemId:n,pivotTree:o,dataFields:a?r:[],hasOtherAxis:s}).forEach((function(t,n){t.forEach((function(t,r){i()(u,[n+(e.length?f.kA:0),r],t)}))})),u}({rowCriterias:a,pivotTableItemId:v,dataFields:u,pivotTree:n,shouldAppendData:y,hasOtherAxis:s.length>0}),I=function(t){var e=t.colCriterias,n=t.pivotTableItemId,r=t.dataFields,o=t.pivotTree,a=t.shouldAppendData,s=t.hasOtherAxis;if(0===e.length&&0===r.length)return function(t){var e={pivotTableRef:{id:t,pivotCellType:h.B.COL_LEAF,fieldIndex:f.YZ},effectiveValue:(0,d.Yt)(l.ZP.t("列"))};return[Array(f.sN).fill(e)]}(n);var u=[[]];return Q(e,!1,n,u),W({singleAxisCriterias:e,isRow:!1,pivotTableItemId:n,pivotTree:o,dataFields:a?r:[],hasOtherAxis:s}).forEach((function(t,n){t.forEach((function(t,r){i()(u,[r+(e.length?f.kA:0),n],t)}))})),u}({colCriterias:s,pivotTableItemId:v,dataFields:u,pivotTree:n,shouldAppendData:!y,hasOtherAxis:a.length>0}),_=[[]];i()(_,[0,0],w);var b=f.Im+S.length,R=a.length?f.kA:0,O=s.length?f.kA:0,x=I.length-R+b,C=(0,d.QF)(T);if((0,d.Bt)(T,_,x,0),(0,d.Bt)(I,_,b,C),a.length>0&&s.length>0&&1===u.length){var L=function(t,e){var n=t.field.name;return{pivotTableRef:{id:e,pivotCellType:h.B.TABLE_HEAD},effectiveValue:(0,d.Yt)(n)}}(u[0],v);i()(_,[b,0],L)}var A=T.length+I.length-R+b,D=C+(0,d.QF)(I);(0,d.Bt)(S,_,f.Im,0);var M=x+R,P=C,k=E||0===u.length,B=u.length>1?1:0;!function(t){for(var e=t.displayTable,n=t.dataFields,r=t.totalRows,o=t.totalCols,a=t.dataStartRow,s=t.dataStartCol,u=t.pivotTree,c=t.pivotTableItemId,l=t.rowConditionLevels,d=t.colConditionLevels,p=t.isCheckHasValueOnly,v=n.length?n:f.N0,g=a;g<r;g++)for(var y=s;y<o;y++){var m=Y({displayTable:e,pivotTree:u,row:g,col:y,dataStartRow:a,dataStartCol:s,rowConditionLevels:l,colConditionLevels:d,isCheckHasValueOnly:p}),E=m.value,w=m.dataIndex,S={pivotTableRef:{id:c,pivotCellType:h.B.DATA,fieldIndex:v[w].field.fld},effectiveValue:E};i()(e,[g,y],S)}}({displayTable:_,dataFields:u,totalRows:A,totalCols:D,dataStartRow:M,dataStartCol:P,pivotTree:n,pivotTableItemId:v,rowConditionLevels:a.length+(y?B:0),colConditionLevels:s.length+(y?0:B),isCheckHasValueOnly:k});var Z=a.length>0||s.length>0?function(t){for(var e,n,r=t.displayTable,o=t.dataStartRow,a=t.dataStartCol,s=t.totalCols,u=r.map((function(t,e){return e<o||t.some((function(t,e){return e>=a&&(null===t||void 0===t?void 0:t.effectiveValue)}))?t:j})).filter((function(t){return t!==j})),c=u.length,l=a;l<s;l++){for(var h=!1,d=o;d<c;d++){var f=null===(e=u[d])||void 0===e?void 0:e[l];if(null===f||void 0===f?void 0:f.effectiveValue){h=!1;break}h=!0}if(h){for(var p=o-1;p>=0;p--){var v=null===(n=u[p])||void 0===n?void 0:n[l];if(!v||!F.includes(v.pivotTableRef.pivotCellType))break;i()(u,[p,l],j)}for(var g=o;g<c;g++)i()(u,[g,l],j)}}var y=u.map((function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];r!==j&&e.push(r)}return e}));return y}({displayTable:_,dataStartRow:M,dataStartCol:P,totalCols:D}):_;if(E)return{displayTable:Z,colHeadStartRow:b,dataStartRow:M,shouldMergeCells:[]};var V=(0,d.Cp)(Z),z=V.rows,q=V.cols;if(0===u.length){var K=function(t,e,n,o){var i={pivotTableRef:{id:t,pivotCellType:h.B.DATA,viewMergeReference:o},effectiveValue:(0,d.Yt)("")},a=Object.assign(Object.assign({},i),{effectiveValue:(0,d.Yt)(l.ZP.t("值"))}),s=Array(e).fill(Array(n).fill(i));return s[0]=(0,r.Z)(s[0]),s[0][0]=a,s}(v,z-M,q-P,new p.GridRange("",M,z-1,P,q-1));(0,d.Bt)(K,Z,M,P)}var X=U({table:Z,colHeadEndRow:M-1,rowHeadEndCol:C-1,nonBodyRows:b,hasAppendDatasOnRows:u.length>1?y:null,colHeadNameLines:O}),J=new p.GridRange("",0,0,0,q-1);return X.push(J),N({displayTable:Z,nonBodyRows:b,dataStartRow:M,dataStartCol:P,pivotTableItemId:v,colHeadNameLines:O}),{displayTable:Z,colHeadStartRow:b,dataStartRow:M,shouldMergeCells:X}}function G(t,e){var n=t.map((function(t){var n,r=t.name,o=t.index,i=t.data.values.filter((function(t){return"object"===typeof t})),a=i.filter((function(t){return!t.isHidden})),s=null;return n=a.length===i.length?(0,d.Yt)(l.ZP.t("pivot-table|（全部）")):1===a.length?(s=a[0]).value:0===a.length?(0,d.Yt)(l.ZP.t("pivot-table|（无）")):(0,d.Yt)(l.ZP.t("pivot-table|（多项）")),[{pivotTableRef:{id:e,pivotCellType:h.B.FILTER_NAME,fieldIndex:o},effectiveValue:(0,d.Yt)(r)},{pivotTableRef:{id:e,pivotCellType:h.B.FILTER_BUTTON,fieldIndex:o,format:(null===s||void 0===s?void 0:s.numberFormat)?x.Z.createInstance({numberFormat:s.numberFormat}):null},effectiveValue:n}]}));return n.length>0&&n.push([void 0]),n}function H(t){return{pivotTableRef:{id:t,pivotCellType:h.B.TITLE},effectiveValue:(0,d.Yt)(l.ZP.t("pivot-table|数据透视表"))}}function W(t){var e=t.singleAxisCriterias,n=t.isRow,r=t.pivotTableItemId,o=t.pivotTree,i=t.dataFields,a=void 0===i?[]:i,s=t.hasOtherAxis,u=function(t){var e=t.singleAxisCriterias,n=t.isRow,r=t.pivotTableItemId,o=t.pivotTree,i=t.hasOtherAxis,a=e.map((function(t,o){return(0,d.zx)(t,(function(i){var a,s=o===e.length-1,u="number"===typeof i;a=u?n?h.B.ROW_SUBTOTAL:h.B.COL_SUBTOTAL:s?n?h.B.ROW_LEAF:h.B.COL_LEAF:n?h.B.ROW_PARENT:h.B.COL_PARENT;var c={value:{pivotTableRef:{id:r,pivotCellType:a,fieldIndex:u?void 0:t.index,itemIndex:u?void 0:i.cacheItemIndex,format:u?void 0:x.Z.createInstance({numberFormat:i.numberFormat})},effectiveValue:u?(0,d.Yt)(l.ZP.t("pivot-table|合计")):i.value,subtotalMethod:u?i:void 0},shouldShrink:u};return!u&&i.isCollapsed&&(c.collapseValue={pivotTableRef:{id:r,pivotCellType:n?h.B.ROW_SUBTOTAL:h.B.COL_SUBTOTAL},effectiveValue:(0,d.Yt)(l.ZP.t("pivot-table|合计")),subtotalMethod:v.I.Default}),c}))}));return S({paths:(0,d.zo)(a),criterias:e,isRow:n,pivotTree:o,hasOtherAxis:i})}({singleAxisCriterias:e,isRow:n,pivotTableItemId:r,pivotTree:o,hasOtherAxis:s});if(!(a.length>1||0===e.length))return u;var p=a.map((function(t,e){var n=t.field.name;return{pivotTableRef:{id:r,pivotCellType:h.B.DATA_LEAF},effectiveValue:(0,d.Yt)(n),dataIndex:e}}));return(u=(0,d.bj)([u,p],c())).forEach((function(t){var e,n=null===(e=t.find((function(t){return null===t||void 0===t?void 0:t.subtotalMethod})))||void 0===e?void 0:e.subtotalMethod;if(n&&n!==v.I.Default){var r=t[t.length-1],o=f.eG[n],i=a[r.dataIndex].originalName;t[t.length-1]=Object.assign(Object.assign({},r),{effectiveValue:(0,d.Yt)(o+i)})}})),u}function Y(t){for(var e,n,r,o=t.displayTable,i=t.pivotTree,a=t.row,u=t.col,c=t.dataStartRow,l=t.dataStartCol,h=t.rowConditionLevels,d=t.colConditionLevels,p=t.isCheckHasValueOnly,v=[],g=0,y=l-h;y<l;y++){var m=o[a][y];if(m)if(f.eH.includes(m.pivotTableRef.pivotCellType))v.push(f.uP);else{if("number"===typeof m.dataIndex){g=m.dataIndex;break}v.push((null===(e=m.effectiveValue)||void 0===e?void 0:e.key)||"")}}for(var E=c-d;E<c;E++){var w=o[E][u];if(w)if(f.eH.includes(w.pivotTableRef.pivotCellType))v.push(f.uP);else{if("number"===typeof w.dataIndex){g=w.dataIndex;break}v.push((null===(n=w.effectiveValue)||void 0===n?void 0:n.key)||"")}}var S=null===(r=s()(i,v))||void 0===r?void 0:r[g],T=null;return S&&(T=p?S.values.length>0?B:null:S.result),{value:T,dataIndex:g}}function Q(t,e,n,r){t.forEach((function(t,o){var a=t.name,s=t.index,u={pivotTableRef:{id:n,pivotCellType:e?h.B.ROW_NAME:h.B.COL_NAME,fieldIndex:s},effectiveValue:(0,d.Yt)(a)};i()(r,[0,o],u)}))}},76062:function(t,e,n){"use strict";n.d(e,{c:function(){return f}});var r=n(58926),o=(n(8195),n(90109),n(38934),n(31688),n(93984),n(19553),n(81144),n(59677),n(71091),n(14199),n(47917),n(48912),n(34797),n(2725),n(12522),n(56687),n(10635),n(89512),n(57625),n(41403),n(76252),n(69398),n(49245),n(15421),n(554),n(49502),n(26894),n(41031),n(12024),n(81502),n(75793),n(52865),n(78817)),i=n.n(o),a=n(44240),s=n.n(a),u=n(82614),c=n(6769),l=n(21496),h=n(32569),d=(0,c.Yt)("").key;function f(t){var e=t.sourceDatas,n=t.rowCriterias,o=t.colCriterias,a=t.dataFields,u=t.pageCriterias,d=t.calcSingleFormula,f=t.isCheckHasValueOnly,E=[].concat((0,r.Z)(n),(0,r.Z)(o));if(0===E.length)return{pivotTree:{},values:v({sourceDatas:e,dataFields:a,pageCriterias:u,calcSingleFormula:d})};var w=n.length,S=f||0===a.length,T=a.length?a:l.N0,I=function(t){var e=t.criterias,n=t.colStartPathIndex,o=t.dataFields,a={},u=e.map((function(t){return(0,c.zx)(t,(function(t){return{key:"number"===typeof t?l.uP:t.value.key,subtotalMethod:"number"===typeof t?t:void 0,isCollapsed:"number"!==typeof t&&t.isCollapsed}}))})),d=(0,c.bj)(u),f=[],v=function(t,r){var u=r.map((function(t){return t.key}));if(!Array.isArray(s()(a,u))){var c=function(t){var e=t.filter((function(t){return t.key===l.uP&&t.subtotalMethod!==h.I.Default}));if(0===e.length)return{subtotalMethod:null,isValid:!0};if(1===e.length)return{subtotalMethod:e[0].subtotalMethod,isValid:!0};if(2===e.length){var n=e.map((function(t){return t.subtotalMethod}));if(n[0]===n[1])return{subtotalMethod:n[0],isValid:!0}}return{subtotalMethod:null,isValid:!1}}(r),d=c.subtotalMethod;if(c.isValid){var v=function(t){var e,n=t.path,r=t.colStartPathIndex,o=t.dataFields,i=t.subtotalMethod,a=t.criterias,s=o.map((function(t){return{values:[],rowDatas:[],result:null,functionName:p(i,t.field.subtotal)}})),u=function(t,e){var n,r;if(t[0].key===l.uP){if((null===(n=t[e])||void 0===n?void 0:n.key)===l.uP)return-1;for(var o=e+1;o<t.length;o++)if(t[o].key===l.uP)return o-1}if((null===(r=t[e])||void 0===r?void 0:r.key)===l.uP)for(var i=1;i<e;i++)if(t[i].key===l.uP)return i-1;return-1}(n,r),c=null===(e=a[u])||void 0===e?void 0:e.valueSortIndex;if("number"===typeof c){var h=p(null,o[c].field.subtotal);h!==s[c].functionName&&(s[c].defaultSubtotalBucket={values:[],rowDatas:[],result:null,functionName:h})}return s}({path:t,colStartPathIndex:n,dataFields:o,subtotalMethod:d,criterias:e});i()(a,u,v),f.push(v)}}};return d.forEach((function(t){var e=function(t,e){var n=(0,c.nl)(t,e,(function(t){return t.key===l.uP})),o=n.firstRequiredRowIndex,i=n.firstRequiredColIndex,a=(0,r.Z)(t);"number"===typeof i&&a.splice(i+1);var s=e;"number"===typeof o&&(a.splice(o+1,e-o-1),s=o+1);var u=(0,r.Z)(a),d=(0,c.nl)(u,s,(function(t){return t.isCollapsed})),f=d.firstRequiredRowIndex,p=d.firstRequiredColIndex,v={isCollapsed:!1,key:l.uP,subtotalMethod:h.I.Default},g=!1;return"number"===typeof p&&p<u.length-1&&(u.splice(p+1),u.push(v),g=!0),"number"===typeof f&&f<s-1&&(u.splice(f+1,s-f-1,v),g=!0),{mainPath:a,collapsePath:g?u:null}}(t,n),o=e.mainPath,i=e.collapsePath;v(t,o),i&&v(t,i)})),{pivotTree:a,leafNodes:f}}({colStartPathIndex:w,criterias:E,dataFields:T}),_=I.leafNodes,b=I.pivotTree,R=g(u),O=R.filterHiddenValues,x=R.filterIndexes,C=E.map((function(t){return t.index})),L=T.map((function(t){return t.field.fld||0})),A=function(t,e){var n=new Set,r=new Set,o=function(o){o<e?n.add(o):o<t.length&&r.add(o)};return t.forEach((function(t,e){var n,r;t.data.subtotalMethod&&o(e),(null===(r=null===(n=t.field.items)||void 0===n?void 0:n.item)||void 0===r?void 0:r.some((function(t){return!1===t.sd})))&&o(e+1)})),{rowSubtotalIndexes:Array.from(n.values()).sort(),colSubtotalIndexes:Array.from(r.values()).sort()}}(E,w),N=A.rowSubtotalIndexes,D=A.colSubtotalIndexes;return e.forEach((function(t){if(!x.some((function(e){return O[e].has(y(t,e))}))){var e=C.map((function(e){return y(t,e)}));if(s()(b,e)){var n=function(t,e,n,o){for(var i=[],a=0;a<=n.length;a++)for(var s=n[a],u=0;u<=o.length;u++){var c=o[u],h=(0,r.Z)(t);"number"===typeof c&&(h[c]=l.uP,h.splice(c+1)),"number"===typeof s&&(h[s]=l.uP,h.splice(s+1,e-s-1)),i.push(h)}return i}(e,w,N,D),o=n.map((function(t){return s()(b,t)})).filter((function(t){return t}));L.forEach((function(e,n){var r,i=(null===(r=t[e])||void 0===r?void 0:r.getEffectiveValue())||null;o.forEach((function(e){var r=e[n];S&&0===r.values.length?r.values.push(null):(r.values.push(i),r.rowDatas.push(t),r.defaultSubtotalBucket&&(r.defaultSubtotalBucket.values.push(i),r.defaultSubtotalBucket.rowDatas.push(t)))}))}))}}})),d&&_.forEach((function(t){t.forEach((function(t){t.result=m(t,d),t.defaultSubtotalBucket&&(t.defaultSubtotalBucket.result=m(t.defaultSubtotalBucket,d))}))})),{pivotTree:b}}function p(t,e){var n=e||u.N.Sum,r=l.Kn[n];return t&&t!==h.I.Default?l.Cf[t]:r}function v(t){var e=t.sourceDatas,n=t.dataFields,r=t.pageCriterias,o=t.calcSingleFormula;if(!o)return n.map((function(){return null}));var i=n.map((function(t){return t.field.fld||0})),a=n.map((function(t){return{values:[],rowDatas:[],functionName:p(null,t.field.subtotal),result:null}})),s=g(r),u=s.filterHiddenValues,c=s.filterIndexes;return e.forEach((function(t){c.some((function(e){return u[e].has(y(t,e))}))||i.forEach((function(e,n){var r,o=(null===(r=t[e])||void 0===r?void 0:r.getEffectiveValue())||null,i=a[n];i.values.push(o),i.rowDatas.push(t)}))})),a.map((function(t){return m(t,o)}))}function g(t){var e={},n=[];return t.forEach((function(t){var r=t.data,o=t.index,i=new Set(r.values.filter((function(t){return"object"===typeof t&&t.isHidden})).map((function(t){return t.value.key})));i.size>0&&(e[o]=i,n.push(o))})),{filterHiddenValues:e,filterIndexes:n}}function y(t,e){var n,r;return(null===(r=null===(n=t[e])||void 0===n?void 0:n.getEffectiveValue())||void 0===r?void 0:r.key)||d}function m(t,e){var n=t.functionName,r=t.values.map(c.io);if(l.ZJ.includes(n)&&(r=r.filter((function(t){return""!==t}))),!r.length)return null;var o=r.join(",");if(/^,*$/.test(o))return(0,c.Yt)("");var i=e("="+n+"("+o+")").result;return(0,c.Yt)(i)}},6769:function(t,e,n){"use strict";n.d(e,{Bt:function(){return S},Cp:function(){return _},HP:function(){return w},QF:function(){return I},Yt:function(){return p},bj:function(){return v},io:function(){return T},nl:function(){return b},zo:function(){return g},zx:function(){return m}});var r=n(58926),o=(n(38934),n(31688),n(8195),n(44904),n(90109),n(93984),n(19553),n(81144),n(46396),n(84919),n(52865),n(20670),n(28086)),i=n(19750),a=n(32569),s=n(84464),u=n(78817),c=n.n(u),l=n(92066),h=n(29835),d=n(21496),f={string:o.Z.STRING,number:o.Z.NUMBER,boolean:o.Z.BOOL};function p(t){if("object"===typeof t)return i.Z.createInstance({type:o.Z.ERROR,value:(0,h.qo)(t.displayText||"")});var e=f[typeof t];return i.Z.createInstance({type:e,value:t})}function v(t,e){return t.reduce((function(t,n){var r=[];return t.forEach((function(t){n.forEach((function(n){var o=t.concat(n);o=e?e(o):o,r.push(o)}))})),r}),[[]])}function g(t){return t.reduceRight((function(t,e){var n=[];return e.forEach((function(e){var r;if(e.shouldShrink){var o=Array(t[0].length).fill(null);n.push(o.concat(e.value))}else{if(e.collapseValue){var i=((null===(r=t[0])||void 0===r?void 0:r.length)||0)-1;if(i>=0){var a=Array(i).fill(null);return void n.push(a.concat(e.collapseValue,e.value))}}t.forEach((function(t){n.push(t.concat(e.value))}))}})),n}),[[]]).map((function(t){return t.reverse()}))}function y(t){if(0===t.length)return{correctedCriterias:[],leafSubtotal:null};var e=t[t.length-1].data.subtotalMethod;return{correctedCriterias:t.map((function(e,n){var r,o,i,s=null!==(i=null===(o=null===(r=t[n-1])||void 0===r?void 0:r.data)||void 0===o?void 0:o.subtotalMethod)&&void 0!==i?i:null,u=0===n?a.I.Default:s,c=e.data.values.filter((function(t){return"object"===typeof t}));"number"===typeof u&&c.push(u);var l={subtotalMethod:u,values:c};return Object.assign(Object.assign({},e),{data:l})})),leafSubtotal:e}}function m(t,e,n){return void 0===n&&(n=!1),t.data.values.filter((function(t){return"number"===typeof t?!n:!t.isHidden})).map(e)}function E(t){var e,n,r,o,i,a,s=null===(a=null===(i=null===(o=null===(r=null===(n=null===(e=null===t||void 0===t?void 0:t.autoSortScope)||void 0===e?void 0:e.pivotArea)||void 0===n?void 0:n.references)||void 0===r?void 0:r.reference)||void 0===o?void 0:o[0])||void 0===i?void 0:i.x)||void 0===a?void 0:a[0].v;return null!==s&&void 0!==s?s:void 0}function w(t,e){var n,r,o,i,a,u,c=(null===(n=t.pivotFields)||void 0===n?void 0:n.pivotField)||[],h=(null===(r=e.cacheFields)||void 0===r?void 0:r.cacheField)||[],f=function(t,e){return t.map((function(t,n){var r,o,i=(null===(r=t.items)||void 0===r?void 0:r.item)||[],a=(null===(o=e[n].sharedItems)||void 0===o?void 0:o.egSharedItems)||[],u=null,c=[];return i.forEach((function(t){if(t.t)u=t.t,c.push(t.t);else{var e=a[t.x],n=(0,s.$U)(e);c.push({isHidden:Boolean(t.h),value:n.effectiveValue,numberFormat:n.numberFormat,cacheItemIndex:t.x,isCollapsed:!1===t.sd})}})),{subtotalMethod:u,values:c}}))}(c,h),p=(null===(o=t.rowFields)||void 0===o?void 0:o.field)||[],v=(null===(i=t.colFields)||void 0===i?void 0:i.field)||[],g=(null===(a=t.pageFields)||void 0===a?void 0:a.pageField)||[],m=p.map((function(n){var r=n.x;return{index:r,field:c[r],data:f[r],name:(0,l.Cy)(t,e,r).name,valueSortIndex:E(c[r])}})),w=v.map((function(n){var r=n.x;return{index:r,field:c[r],data:f[r],name:(0,l.Cy)(t,e,r).name,valueSortIndex:E(c[r])}})),S=g.map((function(n){var r=n.fld;return{index:r,field:c[r],data:f[r],name:(0,l.Cy)(t,e,r).name}})),T=((null===(u=t.dataFields)||void 0===u?void 0:u.dataField)||[]).map((function(n){return{field:n,originalName:(0,l.Cy)(t,e,n.fld).name}}));return{rowCriterias:y(m.filter((function(t){return t.index!==d.dU}))).correctedCriterias,colCriterias:y(w.filter((function(t){return t.index!==d.dU}))).correctedCriterias,pageCriterias:S,dataFields:T}}function S(t,e,n,r){t.forEach((function(t,o){t.forEach((function(t,i){c()(e,[n+o,r+i],t)}))}))}function T(t){if(!t)return"";var e=t.value,n=t.type;return null===e?"":n===o.Z.BOOL||n===o.Z.NUMBER?String(e):n===o.Z.STRING?'"'+String(e).replace(/"/g,'\\"')+'"':n===o.Z.ERROR&&e.displayText||""}function I(t){return Math.max.apply(Math,(0,r.Z)(t.map((function(t){return t.length}))))}function _(t){return{rows:t.length,cols:I(t)}}function b(t,e,n){for(var r=void 0,o=void 0,i=0;i<t.length;i++)if(n(t[i])&&(i<e&&"number"!==typeof r&&(r=i),i>=e&&"number"!==typeof o)){o=i;break}return{firstRequiredRowIndex:r,firstRequiredColIndex:o}}},60014:function(t,e,n){"use strict";n.d(e,{$l:function(){return o},Vh:function(){return s},_I:function(){return u},er:function(){return i},qF:function(){return a}});var r=n(8326),o=100,i=100,a="https://"+r.Z.getConfig("runtime.domainName")+"/mall/index/form/collect",s=7e3,u=20010},19031:function(t,e,n){"use strict";n.d(e,{CV:function(){return g},Fh:function(){return y},GY:function(){return T},LH:function(){return S},Ot:function(){return v},g8:function(){return E},ns:function(){return w},o_:function(){return m}}),n(53923),n(52865),n(77468),n(19553),n(38934),n(81144),n(90109),n(15770),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(84919),n(26894),n(13857),n(54371),n(95019);var r=n(89577),o=n(20589),i=n.n(o),a=n(39033),s=n.n(a),u=n(60014),c=n(11376),l=n(56873);function h(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var f=new RegExp(c.ZP.t("(序号|编号|姓名|名字|名称|人员|成员|商品名称|负责人|岗位|职位|性别|电话|联系方式|号码|手机号|民族|籍贯|毕业院校|专业|学位|学历|身份证|身份证号码|户口所在地|金额|类型|工作单位|年龄|项目|类别|分类|事项|产品|日期|时间|日期时间|星期|生日|出生月日|进展|阶段进展|阶段成果|项目进展|项目成果|状态|下周计划|目标|任务|KPI|OKR|备注|说明|价格|售价|单价|部门|语文|数学|英语|政治|历史|地理|物理|化学|生物|name|date|place|address|tele)",{nsSeparator:"#"}),"i");function p(t,e){var n,r,o,i,a,u,c,l,h,d;if(void 0===e&&(e=0),!t||0===(null===t||void 0===t?void 0:t.values.length))return new Array(6);for(var f=s()(t),p=(null!==f&&void 0!==f?f:{values:[]}).values,v=p.length-1;v>=0;v--){var g=p[v];if((null===g||void 0===g?void 0:g.getEditValue())||(null===g||void 0===g?void 0:g.getMergeReference()))break;p.pop()}for(var y=0;y<p.length;y++){var m=p[y],E=null!==(n=null===m||void 0===m?void 0:m.getMergeReference())&&void 0!==n?n:{},w=E.startRowIndex,S=void 0===w?0:w,T=E.endRowIndex,I=void 0===T?0:T,_=E.startColIndex,b=void 0===_?0:_,R=(E.endColIndex,null!==(i=null===(o=null===(r=SpreadsheetApp.spreadsheet.activeSheet.data.rowData[S])||void 0===r?void 0:r.values[b])||void 0===o?void 0:o.getEditValue())&&void 0!==i?i:"");if((null===m||void 0===m?void 0:m.getMergeReference())&&I-S>0){if(I===e){null===m||void 0===m||m.setEditValue(R);continue}null===m||void 0===m||m.setEditValue("")}(null===(a=null===m||void 0===m?void 0:m.getMergeReference())||void 0===a?void 0:a.startRowIndex)===e&&(null===(u=p[y])||void 0===u||u.setEditValue(R));var O=null===(c=SpreadsheetApp.spreadsheet.activeSheet.data.rowData[e-1])||void 0===c?void 0:c.values[y],x=null!==(l=null===O||void 0===O?void 0:O.getMergeReference())&&void 0!==l?l:{},C=x.startRowIndex,L=void 0===C?0:C,A=x.startColIndex,N=void 0===A?0:A,D=x.endColIndex,M=void 0===D?0:D,P=M-N+1;if(!(0===P||P/p.length>=.5)&&(!(null===O||void 0===O?void 0:O.getMergeReference())||M-N!==0)){var k=null===(d=null===(h=SpreadsheetApp.spreadsheet.activeSheet.data.rowData[L])||void 0===h?void 0:h.values[N])||void 0===d?void 0:d.getEditValue();(null===O||void 0===O?void 0:O.getMergeReference())&&(null===m||void 0===m||m.setEditValue(k+"-"+m.getEditValue()))}}return p.map((function(t){var e;return!t||(null===(e=t.getMetadata())||void 0===e?void 0:e.customDataType)?null:null===t||void 0===t?void 0:t.getEditValue()}))}var v=function(){for(var t,e,n,r=0,o=h(null===(t=SpreadsheetApp.spreadsheet.activeSheet.data)||void 0===t?void 0:t.rowData);!(n=o()).done;){var i=n.value;if(i)for(var a=i.values,s=a.length-1;s>0;s--){var u=a[s];if(((null===u||void 0===u?void 0:u.getEditValue())||(null===u||void 0===u?void 0:u.getMergeReference()))&&10!==(null===(e=null===u||void 0===u?void 0:u.getMetadata())||void 0===e?void 0:e.customDataType)){r=Math.max(r,s+1);break}}}return r},g=function(t,e){for(var n=[],o=0;o<e.length;o++){var i=e[o],a=new r.Z({sheetId:SpreadsheetApp.spreadsheet.activeSheetId,startRowIndex:t,endRowIndex:t,startColIndex:o,endColIndex:o}),s=!SpreadsheetApp.sheetStatus.containsCanNotReadRange([a]),c=(0,l.colIndex2ColChar)(o).toUpperCase()+"列";n.push({col:o,row:t,value:(i||c).substr(0,u.er),isRangeAuthRead:s,colName:c})}return n};function y(t,e){var n,r=e.slice(0),o=new Map;if(SpreadsheetApp.spreadsheet.activeSheet.properties.gridProperties.frozenRowCount){var i=SpreadsheetApp.spreadsheet.activeSheet.properties.gridProperties.frozenRowCount-1;return o.set(i+1,p(t[i],i)),{cellIndexMap:o,titleLine:i}}var a=function(t,e){for(var n,r,o,i=[],a=0,u=0,c=0,l=h(e);!(o=l()).done;){var d=o.value;if(d>10)break;for(var f=s()(t[d]),p=(null!==f&&void 0!==f?f:{values:[]}).values,g=p.length-1;g>=0;g--){var y=p[g];if(((null===y||void 0===y?void 0:y.getEditValue())||(null===y||void 0===y?void 0:y.getMergeReference()))&&10!==(null===(n=null===y||void 0===y?void 0:y.getMetadata())||void 0===n?void 0:n.customDataType))break;p.pop()}var m=null!==(r=null===f||void 0===f?void 0:f.values)&&void 0!==r?r:[];if(!m.every((function(t){return null===t||void 0===t?void 0:t.getMergeReference()}))){for(var E,w=0,S=v(),T=h(m);!(E=T()).done;){var I=E.value;(null===I||void 0===I?void 0:I.getMergeReference())&&(null===I||void 0===I?void 0:I.getMergeReference()).endRowIndex>d&&(w-=1),(null===I||void 0===I?void 0:I.getMergeReference())&&(null===I||void 0===I?void 0:I.getMergeReference()).endRowIndex===d?w+=1:(null===I||void 0===I?void 0:I.getEditValue())&&w++}w/S>=.6&&(i.push(d),u<(a=w/S)&&(c=d,u=a))}}return{targetIndexs:i,pointLine:c}}(t,r),u=a.targetIndexs,c=a.pointLine;if(u.length>0){for(var l,d=h(u);!(l=d()).done;)for(var g,y=l.value,m=p(t[y],y),E=h(m);!(g=E()).done;){var w=g.value;if(f.test(w))return o.set(y+1,m),{cellIndexMap:o,titleLine:y}}var S=p(t[c],c);return o.set(c+1,S),{cellIndexMap:o,titleLine:c}}for(var T,I=function(){var e=T.value;if(e>10)return"break";if(null===(n=t[e])||void 0===n?void 0:n.values.some((function(t){var n;return(null===(n=null===t||void 0===t?void 0:t.getMergeReference())||void 0===n?void 0:n.endRowIndex)===e})))return"continue";var r=p(t[e]);return r.length>0?(o.set(e+1,r),{v:{cellIndexMap:o,titleLine:e}}):void 0},_=h(r);!(T=_()).done;){var b=I();if("break"===b)break;if("continue"!==b&&"object"===typeof b)return b.v}for(var R,O=h(r);!(R=O()).done;){var x=R.value;if(x>10)break;var C=p(t[x]);if(C.length>0)return o.set(x+1,C),{cellIndexMap:o,titleLine:x}}return{cellIndexMap:o,titleLine:-1}}function m(t,e){for(var n=[],r=0;r<10;r++){var o=e[r];!t[r]||o&&o.hiddenByUser||n.push(r)}return n}function E(t,e){return{headData:t.get(e+1)||[],titleLine:e}}function w(t){try{var e=function(t){var e=t.data;if(!e||!e.rowData||!e.rowMetadata)return null;var n=e.rowData,r=y(n,m(n,e.rowMetadata)),o=r.cellIndexMap,i=r.titleLine,a=E(o,i).headData;return i>=0?{headDatas:g(0,a),titleLine:i}:null}(t);if(!e||0===e.headDatas.length)return null;var n=e.headDatas,o=e.titleLine,i=n[0],a=i.row,s=i.col,u=n[n.length-1].col,c=Math.max(a,o);return new r.Z(t.getSheetId(),a,c,s,u)}catch(l){return console.error(l),null}}function S(t){var e=w(t);return e&&new r.Z(t.getSheetId(),0,e.endRowIndex,e.startColIndex,e.endColIndex)}var T=i()(w,15)},45932:function(t,e,n){"use strict";n(38934),n(48845),n(84919),n(52865),n(20670),n(64425),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(11425),n(15770);var r=n(11376),o=n(56592),i=n.n(o),a=n(80067),s=n(62986),u=n(14831),c=n.n(u),l=n(4175),h=n(25962),d=n.n(h),f=n(68218),p=n(84701),v=n(22685),g=n(91508),y=n(11008),m=n(95946),E=n(45136),w=n(26702),S=n(51406),T=n(36156),I=n(8326),_=n(48237),b=n(32431),R=n(65153),O=n(10916),x=n(37906),C=n(38371);function L(){L=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var A,N,D=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};!function(t){t.loggedIn="loggedIn",t.loggedOut="loggedOut",t.switched="switched",t.error="error"}(A||(A={})),function(t){t.OPEN_LOGIN_BOX="OPEN_LOGIN_BOX",t.OPEN_LOGIN_BOX_FOR_QQ_QUICK_LOGIN="OPEN_LOGIN_BOX_FOR_QQ_QUICK_LOGIN"}(N||(N={}));var M="//"+I.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/user_info",P=function(){function t(){var t=this;this.logoutApp=function(){c().isTencentDocsApp&&((0,y.t4)(),setTimeout((function(){var t;null===(t=n.g.mqq)||void 0===t||t.invoke("docx","logoutAccount")}),100))},this.onPskeyError=function(e,n){(0,m.V)({errorCode:""+n,message:"onPskeyError "+e,padType:S.LogPadType.Backend,tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)(),url:e}}),(0,y.J3)({errCode:n,cgi:e}),e.indexOf("user_info")<0?t.checkLoginState((function(){(0,m.V)({errorCode:E.B.PS_KEY_ERROR,message:"onPskeyErrorException",tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)()}}),(0,y.J3)({errCode:n,cgi:e,loginType:"cgi_exp_err_report"})}),(function(){t.handlePskeyError()})):t.handlePskeyError()}}var e=t.prototype;return e.init=function(){(0,x.b)()||this.tryAutoLogin()},e.postLogin=function(){this.registerLoginListeners(),this.registerMsgCenterListeners(),this.setLoginTime(),this.checkLoginIsExpired(),g.q.setConfig({uidKey:(0,a.ej)("uid_key")})},e.tryAutoLogin=function(){var t=this;O.Z.isLogin||(this.weChatH5Login(!0),this.wxWorkLogin("autologin")),this.qqClientLogin(),this.browserAutoLogin(),n.g.SpreadsheetApp.emitter.once(n.g.SpreadsheetApp.EVENT.SPREAD_SHEET_PLUGINS_END,(function(){t.showWeChatH5NaviPanel()}))},e.login=function(){var t=this;c().isTencentDocsApp?(new w.AppExceptionHandler).tryLogin():O.Z.login(location.href,(function(){t.showLoginModal()}),(function(){t.weChatH5Login()}))},e.showLoginModal=function(){return D(this,void 0,void 0,L().mark((function t(){return L().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.default.getExtension(b.f.name);case 2:t.sent.show({usageScenario:N.OPEN_LOGIN_BOX,container:this.getLoginContainer()});case 4:case"end":return t.stop()}}),t,this)})))},e.showQuickLoginModal=function(){return D(this,void 0,void 0,L().mark((function t(){return L().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.default.getExtension(b.f.name);case 2:t.sent.show({usageScenario:N.OPEN_LOGIN_BOX_FOR_QQ_QUICK_LOGIN,container:this.getLoginContainer()});case 4:case"end":return t.stop()}}),t,this)})))},e.checkLoginState=function(t,e,n){(0,y.Bp)()||e(0),i()({method:"get",url:M+"?only_check=1&xsrf="+(0,s.f)(),timeout:n||1e3}).then((function(n){var r=n.data;if(0===(null===r||void 0===r?void 0:r.retcode))return t();var o=(null===r||void 0===r?void 0:r.retcode)||-306;console.warn("[login] checkLoginState fail: "+o),(0,m.V)({errorCode:o,message:"checkLoginState retcode not 0",padType:S.LogPadType.Backend,tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)(),url:M}}),e(o)})).catch((function(t){var n,r,o,i,a=(null===(r=null===(n=null===t||void 0===t?void 0:t.response)||void 0===n?void 0:n.data)||void 0===r?void 0:r.retcode)||(null===(i=null===(o=null===t||void 0===t?void 0:t.response)||void 0===o?void 0:o.data)||void 0===i?void 0:i.errCode)||-306;console.warn("[login] checkLoginState error: "+a),(0,m.V)({errorCode:a,message:"checkLoginState response error",padType:S.LogPadType.Backend,tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)(),url:M}}),e(a)}))},e.checkIfAccountSwitched=function(){return O.Z.isLogin,!1},e.showWeChatH5NaviPanel=function(){return D(this,void 0,void 0,L().mark((function t(){return L().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,y.Yv)()){t.next=2;break}return t.abrupt("return");case 2:if(c().isWeChat){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,_.default.getExtension(R.G.name);case 6:t.sent.show({url:n.g.__originUrl});case 8:case"end":return t.stop()}}),t)})))},e.weChatH5Login=function(t){return void 0===t&&(t=!1),D(this,void 0,void 0,L().mark((function e(){var n;return L().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c().isWeChat){e.next=2;break}return e.abrupt("return");case 2:if(n=function(){var t="https://"+I.Z.getConfig("runtime.domainName")+"/scenario/wx-login.html?target="+encodeURIComponent(location.href),e="https://"+I.Z.getConfig("custom.standaloneDomains.open_weixin_qq_com")+"/connect/oauth2/authorize?appid=wx46dfe750eef96da7&redirect_uri="+encodeURIComponent(t)+"&response_type=code&scope=snsapi_userinfo&state=onweixinlogin";location.replace(e)},t){e.next=6;break}return n(),e.abrupt("return");case 6:return e.next=8,_.default.getExtension(C.h.name);case 8:(0,e.sent.renderPopup)(n).showPopup(4e3);case 11:case"end":return e.stop()}}),e)})))},e.wxWorkLogin=function(t){if(void 0===t&&(t="autologin"),c().isWxWork){var e="https://"+I.Z.getConfig("runtime.domainName")+"/scenario/ww-login.html?from="+t+"&url="+encodeURIComponent(location.href),n="https://"+I.Z.getConfig("custom.standaloneDomains.open_weixin_qq_com")+"/connect/oauth2/authorize?appid=ww20388f7040b655b7&redirect_uri="+encodeURIComponent(e)+"&response_type=code&scope=snsapi_userinfo&state=weworklogin#wechat_redirect";location.replace(n)}},e.qqClientLogin=function(){var t=this;(0,f.quickQQLogin)((function(e){e||t.showQuickLoginModal()}))},e.browserAutoLogin=function(){(0,a.IZ)("autoshowlogin")&&this.showLoginModal()},e.getLoginContainer=function(){var t=document.getElementById("loginContainer");return t||((t=document.createElement("div")).id="loginContainer",document.body.appendChild(t)),t},e.registerMsgCenterListeners=function(){d().setCallback((function(t){var e;t&&1e4===t.code?(null===(e=n.g.log)||void 0===e||e.info("TX-LOGIN-ACCOUNT-SWITCHED dispatch MsgCenter Callback"),n.g.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:A.switched})):t&&10001===t.code&&n.g.SLR.dispatch("TX-LOGIN-LOGOUT-OTHER-TAB",{})}))},e.registerLoginListeners=function(){l.ZP.loginEvent.listen("logoutApp",this.logoutApp),l.ZP.loginEvent.listen("pskeyError",this.onPskeyError),this.registerLoginListener(),this.registerAccountSwitchedListener(),this.registerPskeyExpiredListener(),this.registerLoggedOutInOtherTabListener()},e.registerLoginListener=function(){var t=this;n.g.SLR.listen("TX-LOGIN-SHOW",(function(){t.showLoginModal()}))},e.registerAccountSwitchedListener=function(){var t=this;c().isMobilePhone||c().isAndroidPad||n.g.SLR.listen("TX-LOGIN-ACCOUNT-SWITCHED",(function(e){var o,i=e.detail;null===(o=n.g.log)||void 0===o||o.info("TX-LOGIN-ACCOUNT-SWITCHED listen");var a=(i||{}).op;if(a===A.loggedIn||a===A.error)return(0,m.V)({errorCode:E.B.LOGIN_SWITCHED,message:"status: "+a,snackbarMsg:r.ZP.t("其他页面已登录，正在刷新"),type:"info",tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)()}}),p.default.show({type:"info",autoClose:!0,duration:1500,message:r.ZP.t("其他页面已登录，正在刷新...")}),void setTimeout((function(){location.reload()}),1800);(0,m.V)({errorCode:E.B.LOGIN_SWITCHED,message:"status: "+a,snackbarMsg:r.ZP.t("帐号信息变化 刷新"),type:"info",tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)()}}),t.showRefreshTips()}))},e.registerPskeyExpiredListener=function(){var t=this;n.g.SLR.listen("TX-LOGIN-PSKEY-EXPIRED",(function(e){var n="unknown url",r=e.detail||{},o=r.url,i=r.code,a=void 0===i?0:i;"string"===typeof o&&o&&(n=o.split("?")[0]),console.error("[login] listen onPskeyError("+n+") = "+a),t.onPskeyError(n,a)}))},e.registerLoggedOutInOtherTabListener=function(){var t=this;n.g.SLR.listen("TX-LOGIN-LOGOUT-OTHER-TAB",(function(){t.showLoginExpiredTips(A.loggedOut),(0,m.V)({errorCode:E.B.LOGGED_OUT,message:"listen TX-LOGIN-LOGOUT-OTHER-TAB",type:"info",tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)()}})}))},e.showRefreshTips=function(){p.default.show({type:"info",autoClose:!1,message:r.ZP.t("帐号信息变化"),action:r.ZP.t("刷新"),onClickAction:function(){location.reload()},id:"accountSwitchTips"})},e.showLoginExpiredTips=function(t){var e=this;(0,m.V)({errorCode:E.B.SHOW_RELOGIN,message:"status: "+t+";",snackbarMsg:r.ZP.t("登录过期"),type:"info",tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)()}}),c().isMobilePhone||c().isAndroidPad?v.default.show({type:"info",autoClose:!1,message:r.ZP.t("登录过期"),action:r.ZP.t("重新登录"),onClickAction:function(){e.login()}}):p.default.show({type:"info",autoClose:!1,message:r.ZP.t("登录过期"),action:r.ZP.t("重新登录"),onClickAction:function(){try{if(!O.Z.isLogin)return void e.login();if(e.checkIfAccountSwitched())return void e.checkLoginState((function(){var e;null===(e=n.g.log)||void 0===e||e.info("TX-LOGIN-EXPIRED IS SWITCHED"),n.g.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:t})}),(function(){e.login()}));e.login()}catch(r){location.reload()}}})},e.handlePskeyError=function(){g.q.getConfig("isLogin")&&((0,m.V)({errorCode:E.B.LOGIN_ERROR,message:"handlePskeyError LOGIN_STATUS.error",tipsCustom:{utype:(0,f.getLoginType)(),pttype:(0,y.F$)()}}),this.showLoginExpiredTips(A.error))},e.setLoginTime=function(){if(g.q.getConfig("isLogin")&&!(0,a.ej)("loginTime")){var t=(new Date).getTime();(0,a.d8)("loginTime",String(t)),(0,y.J3)({errCode:0,cgi:"null",loginType:"loginSuc"})}},e.checkLoginIsExpired=function(){var t=this;document.addEventListener("visibilitychange",(function(){var e;if("hidden"!==document.visibilityState&&T.xc)return t.checkIfAccountSwitched()?(null===(e=n.g.log)||void 0===e||e.info("TX-LOGIN-ACCOUNT-SWITCHED In checkLoginIsExpired"),void n.g.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"autoResetPskey"})):void 0}))},t}();e.ZP=new P},11008:function(t,e,n){"use strict";n.d(e,{Bp:function(){return c},F$:function(){return l},J3:function(){return s},Xj:function(){return h},Yv:function(){return f},t4:function(){return u}}),n(52865),n(20670),n(64425),n(62883),n(75793),n(84919),n(38934);var r=n(80067),o=n(31973),i=(n(14831),n(68218)),a=n(8326);function s(t){var e=t.errCode,n=t.cgi,i=t.loginType,a=void 0===i?"pskey_expired":i,s=n.split("?")[0].replace(/.*?(?=\/ep\/api)/g,""),u=Number((0,r.ej)("loginTime")||0),c=Number(localStorage.getItem("renewalTime")||0),l=u?new Date(u).toLocaleString():"null",h=c?new Date(c).toLocaleString():"null",d=new Date,f={opername:"tech_doc",module:"b_login_project",action:"doc_login",table:"dc03111",ver6:[l,u,h,c,d.toLocaleString(),d,"web",e,s,a,"core-sheet"].join(";")};o.ZP.tdwReport(f)}function u(t){return"skey"===t?((0,r.A0)("p_uin"),(0,r.A0)("p_skey"),(0,r.A0)("p_luin"),(0,r.A0)("p_lskey"),(0,r.A0)("loginTime"),void localStorage.removeItem("renewalTime")):"uid"===t?((0,r.A0)("uid"),(0,r.A0)("uid",a.Z.getConfig("custom.standaloneDomains.qq_com"),"/"),(0,r.A0)("uid_key"),(0,r.A0)("loginTime"),void localStorage.removeItem("renewalTime")):((0,r.A0)("utype"),(0,r.A0)("is_bind"),(0,r.A0)("p_uin"),(0,r.A0)("p_skey"),(0,r.A0)("p_luin"),(0,r.A0)("p_lskey"),(0,r.A0)("uid"),(0,r.A0)("uid",a.Z.getConfig("custom.standaloneDomains.qq_com"),"/"),(0,r.A0)("uid_key"),(0,r.A0)("TOK"),(0,r.A0)("ES2"),(0,r.A0)("loginTime"),void localStorage.removeItem("renewalTime"))}function c(){return[(0,i.isLogin)(),(0,r.ej)("p_uin")&&(0,r.ej)("p_skey"),(0,r.ej)("p_luin")&&(0,r.ej)("p_lskey")].some((function(t){return t}))}function l(){return(0,r.ej)("p_uin")&&(0,r.ej)("p_skey")?0:(0,r.ej)("p_luin")&&(0,r.ej)("p_lskey")?1:-1}function h(t){return 11e3===t||11005===t||11006===t||1e5===t}var d=["BLgBlcbwatiW"];function f(){var t=n.g.spreadConfig.getConfig("padId");return-1!==d.indexOf(t)}},36943:function(t,e,n){"use strict";n.d(e,{$y:function(){return c},CN:function(){return u}}),n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(31973),o=n(62066);function i(){i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(O){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var v={};u(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,u(m,"constructor",p),u(p,"constructor",f),f.displayName=u(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,o,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var a=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},s={};function u(t){o.W.init("/components/feature/assets.v1.json",t)}function c(t,e){return a(this,void 0,void 0,i().mark((function n(){var u=this;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.ZP.jank.log({moduleValue:"scriptLoader",actionValue:t,lockJankKey:!0}),!s[t]){n.next=7;break}return n.next=4,e(s[t],!1);case 4:r.ZP.jank.releaseLock(),n.next=8;break;case 7:o.W.load(t,(function(n){return a(u,void 0,void 0,i().mark((function o(){return i().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return s[t]=n,o.next=3,e(n,!0);case 3:r.ZP.jank.releaseLock();case 4:case"end":return o.stop()}}),o)})))}));case 8:case"end":return n.stop()}}),n)})))}},62066:function(t,e,n){"use strict";n.d(e,{W:function(){return f}}),n(38934),n(48845),n(75793),n(31688),n(71096),n(19553),n(71091),n(81144),n(41031),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(84919),n(11425),n(15770);var r=n(80067),o=n(24624),i=n(8326);function a(){a=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(O){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var v={};u(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,u(m,"constructor",p),u(p,"constructor",f),f.displayName=u(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,s,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),u(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),u(m,s,"Generator"),u(m,o,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var s=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};function u(){}function c(t,e){return t+=t.indexOf("?")>=0?"&":"?"+e}!function(){if("function"===typeof window.CustomEvent)return!1;function t(t,e){var n=e||{bubbles:!1,cancelable:!1,detail:void 0},r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail),r}t.prototype=window.Event.prototype,n.g.CustomEvent=t}();var l=-1,h=(0,o.A)(),d=h.getRetryCountLimit(),f={metadata:null,firstLoaded:{},asset:{React:{url:i.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__react"),state:l}},assetLoaded:!1,events:{},cache:{},evtArr:[],init:function(t,e,n,r){var o=this;void 0===e&&(e=u),void 0===n&&(n=u),void 0===r&&(r=0),this.assetLoaded||(r||(this.asset=this.asset||{},this.asset.QReport={url:i.Z.getConfig("runtime.library.TENCENT_DOCS_LIBRARY__alloyreport_latest"),state:l}),r<=2?this.ajax({url:c(t,"_t="+Date.now()),success:function(t){o.metadata=t.data.metadata,delete t.data.metadata,delete t.data.ScriptLoader,Object.keys(t.data).forEach((function(e){if(o.asset[e]={url:t.data[e].js||null,state:l},t.data[e].dependency){var n=t.data[e].dependency;o.asset[e].dep=n,Object.keys(n).forEach((function(t){o.asset[t]={url:n[t],state:l}}))}})),o.assetLoaded=!0,o.dispatch("SL-INIT"),null===e||void 0===e||e(),o.evtArr.forEach((function(t){o.dispatch(t.eventName,t.detail)}))},fail:function(t){}}):null===n||void 0===n||n({code:1,msg:"load error"}))},load:function(t,e,n,r){var o=this;void 0===e&&(e=u),void 0===n&&(n=u),void 0===r&&(r=0);var i=this.asset,a=this.cache;this.assetLoaded||"React"===t?this.tryload(i,a,t,e,n,r):this.listen("SL-INIT",(function(){o.load(t,e,n,r)}))},tryload:function(t,e,r,o,i,c){return void 0===o&&(o=u),void 0===i&&(i=u),void 0===c&&(c=0),s(this,void 0,void 0,a().mark((function s(){var u,h=this;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,"undefined"===typeof t[r]){a.next=14;break}if(!("undefined"===typeof e[r]&&c<d)){a.next=11;break}if(!t[r].dep){a.next=8;break}return u=[],Object.keys(t[r].dep).forEach((function(a){if(n.g[a])e[a]=n.g[a],t[a].state=0;else if("undefined"===typeof e[a]&&t[a].state===l){var s=h.loadScriptProcess({asset:t,cache:e,mod:a,parentModule:r},o,i,c);t[a].loading=s,u.push(s)}else{var d=t[a];d.loading&&u.push(d.loading)}})),a.next=8,Promise.all(u);case 8:t[r].state===l?this.loadScriptProcess({asset:t,cache:e,mod:r,parentModule:r},o,i,c):this.listenModuleLoad(r,(function(){o(h.cache[r],h.cache)})),a.next=12;break;case 11:e[r]&&this.firstLoaded[r]&&this.checkAllLoaded(t,r)&&(o(e[r],e),this.firstLoaded[r]=!0);case 12:a.next=16;break;case 14:console.error(r+" is not found."),null===i||void 0===i||i({code:1,msg:r+" is not found."});case 16:a.next=22;break;case 18:a.prev=18,a.t0=a.catch(0),a.t0,null===i||void 0===i||i({code:2,msg:a.t0});case 22:case"end":return a.stop()}}),s,this,[[0,18]])})))},loadScriptProcess:function(t,e,o,i){var a=this,s=t.asset,u=t.cache,c=t.mod,f=t.parentModule;return new Promise((function(t,p){var v=(0,r.ej)("env_id")?s[c].url:h.findRequestUrl(s[c].url,i),g=null;g=a.createScript(v),s[c].state=1,null===g||void 0===g||g.addEventListener("load",(function(){n.g[c]&&(h.emitLoadSuccessEvent(v,{resourceType:"JS",retryCount:i}),u[c]=n.g[c],s[c].state=0,!a.firstLoaded[f]&&a.checkAllLoaded(s,f)&&e(u[f],u),a.dispatch("SL_MODULE_LOAD_"+c),t())})),null===g||void 0===g||g.addEventListener("error",(function(){h.emitLoadFailedEvent(v,{resourceType:"JS",retryCount:i}),i+1>=d?(s[c].state=2,p()):s[c].state=l,s[c].url=v,a.load(c,(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];null===e||void 0===e||e.apply(null,r),t()}),o,i+1),g&&a.removeScript(g),null===o||void 0===o||o({code:3,msg:"load error"})}))}))},checkAllLoaded:function(t,e){var r=t[e];if(0!==t[e].state)return!1;if("undefined"!==typeof r.dep)for(var o=Object.keys(r.dep),i=0,a=o.length;i<a;i++)if(!n.g[o[i]])return!1;return this.firstLoaded[e]=!0,!0},createScript:function(t){var e=document.createElement("script");return e.src=t,e.async=!1,e.type="text/javascript",document.body.appendChild(e),e},removeScript:function(t){(null===t||void 0===t?void 0:t.parentNode)&&t.parentNode.removeChild(t)},ajax:function(t){var e=function(t){var e={};return e.url=t.url,e.paramObj=t.param||{},e.success=t.success||u,e.fail=t.fail||u,e.method=String.prototype.toUpperCase.apply(t.ajaxType||"GET"),e}(t),n=function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n+"="+encodeURIComponent(t[n]));return e.join("&")}(e.paramObj),r=c(e.url,n),o=function(){for(var t=null,e=[function(){return new XMLHttpRequest},function(){return new(0,window.XDomainRequest)},function(){return new window.ActiveXObject("Msxml2.XMLHTTP")},function(){return new window.ActiveXObject("Msxml3.xmlhttp")},function(){return new window.ActiveXObject("Microsoft.XMLHTTP")}],n=0,r=e.length;n<r;n++){try{t=e[n]()}catch(o){continue}break}return t}();if(!o)throw new Error("XMLHttp is not defined");o.open("GET",r,!0),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){var t=JSON.parse(o.responseText);e.success({data:t,code:0})}else e.fail({code:o.status})},o.onerror=function(){e.fail({code:-1})},o.send()},dispatch:function(t,e){if(this.assetLoaded){var r=new window.CustomEvent(t,{detail:e});n.g.dispatchEvent(r)}else this.evtArr.push({eventName:t,detail:e})},listen:function(t,e){void 0===e&&(e=u),this.events[t]||(this.events[t]=[]),this.events[t].push(e),window.addEventListener(t,e)},remove:function(t,e){if(this.events[t]){var n=this.events[t].indexOf(e);-1!==n&&(this.events[t].splice(n,1),window.removeEventListener(t,e))}},removeAllEvent:function(){var t=this;Object.keys(this.events).forEach((function(e){t.events[e].forEach((function(n){t.remove(e,n)}))}))},listenModuleLoad:function(t,e){void 0===e&&(e=u),this.listen("SL_MODULE_LOAD_"+t,e)}};n.g.ScriptLoader||(n.g.ScriptLoader=f),n.g.SLR=n.g.ScriptLoader},78216:function(t,e,n){"use strict";n.r(e),n.d(e,{changeToastInnerText:function(){return c},hideToast:function(){return s},showToast:function(){return u}}),n(52865),n(20670);var r=n(14831),o=n.n(r),i=n(84701),a=null;function s(t){if(a)return a.close(),a=null,void setTimeout((function(){null===t||void 0===t||t()}),300);null===t||void 0===t||t()}function u(t,e,n,r){var c=n||{},l=c.toastType,h=void 0===l?"typeNotice":l,d=c.isWarnning,f=c.toolToastCloseTime,p=c.btnText,v=c.btnCallBack,g=c.btnCallback,y=c.toolToastRemoveCallBack,m=c.showCloseBtn,E=Boolean(f)||(o().isMobilePhone||o().isAndroidPad)&&!p,w="boolean"===typeof m?m:!E,S="object"===typeof e&&null!==e?e.zIndex:10100,T=d?"error":{typeSuccess:"success",typeWarning:"error",typeNotice:"info",typeNoticeWhite:"info",typeLoading:"loading"}[h],I="function"===typeof t?t():t;"string"===typeof I&&(I=I.replace(/[,，]$/,"")),a?s((function(){u(t,e,n,r)})):(a=i.default.show({style:{zIndex:S},message:I,closable:w,type:T,action:p,onClickAction:v||g,onClose:function(){a&&(a=null,null===y||void 0===y||y())},containerDom:r,duration:f,autoClose:E}),E&&setTimeout((function(){null===y||void 0===y||y()}),f))}function c(t,e){if(a){var n={message:t};e&&(n.type=e),a.update(n)}}},93463:function(t,e,n){"use strict";n.d(e,{M$:function(){return g},ZP:function(){return b},yc:function(){return E},L1:function(){return I},AJ:function(){return w}}),n(38934),n(48845),n(52865),n(19553),n(59677),n(71091),n(14199),n(47917),n(48912),n(34797),n(2725),n(12522),n(56687),n(10635),n(89512),n(57625),n(41403),n(76252),n(69398),n(49245),n(15421),n(554),n(81144),n(448),n(66724),n(62883),n(33552),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(14831),o=n.n(r),i=n(58926),a=(n(30980),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.max=t,this.ttl=e,this.first=null,this.last=null,this.items=new Map,this.size=0}var e=t.prototype;return e.has=function(t){return this.items.has(t)},e.clear=function(){return this.first=null,this.items=new Map,this.last=null,this.size=0,this},e.delete=function(t){if(this.has(t)){var e=this.items.get(t);this.items.delete(t),this.size-=1,null!==e.prev&&(e.prev.next=e.next),null!==e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev)}return this},e.evict=function(){var t=this.first;return t?(this.items.delete(t.key),this.first=t.next,this.first&&(this.first.prev=null),this.size-=1,this):this},e.get=function(t){var e;if(this.has(t)){var n=this.items.get(t);this.ttl>0&&n.expiry<=(new Date).getTime()?this.delete(t):(e=n.value,this.set(t,e,!0))}return e},e.keys=function(){return(0,i.Z)(this.items.keys())},e.set=function(t,e,n){var r;if(void 0===n&&(n=!1),n||this.has(t)){if((r=this.items.get(t)).value=e,!1===n&&(r.expiry=this.ttl>0?(new Date).getTime()+this.ttl:this.ttl),this.last!==r){var o=this.last,i=r,a=i.next,s=i.prev;this.first===r&&(this.first=r.next),r.next=null,r.prev=this.last,o&&(o.next=r),null!==s&&(s.next=a),null!==a&&(a.prev=s)}}else this.max>0&&this.size===this.max&&this.evict(),r={expiry:this.ttl>0?(new Date).getTime()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e},this.items.set(t,r),this.size+=1,1===this.size?this.first=r:this.last&&(this.last.next=r);return this.last=r,this},t}()),s=n(8326);function u(){u=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var c,l,h=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};if("undefined"!==typeof window){var d=navigator.userAgent,f=/android|adr/i.test(d),p=/(mobile)/i.test(d)&&f,v=/(ipad)/i.test(d);/(mobile)/i.test(d)&&!v&&(c=200),(v||p)&&(l=600)}var g,y=c||l||1500;!function(t){t[t.CONTAIN=0]="CONTAIN",t[t.COVER=1]="COVER"}(g||(g={}));var m=function(){function t(){var t=this;this.maxCount=16,this.loadingCount=0,this.tasks=[],this.imageCache=new a(y),this.loadedCount=0,this.errorCount=0,this.alreadyFailedImages=new Set,this.preLoadImageToBrowserCache=function(e){return h(t,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.triggerNewTask(e,{shouldSkipCache:!0,shouldConsiderCORS:!1});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))},this.preLoadImageToAppCache=function(e,n){return h(t,void 0,void 0,u().mark((function t(){var r,o,i,a,s,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.getCachedImage(e)){t.next=5;break}return t.next=4,this.triggerNewTask(e,{compressOptions:n,shouldSkipCache:!1,shouldConsiderCORS:!0});case 4:return t.abrupt("return",t.sent);case 5:if(n&&T(e)){t.next=7;break}return t.abrupt("return");case 7:if(o=I(r),i=o.naturalWidth,a=o.naturalHeight,s=n.width,!(n.height<=a&&s<=i)){t.next=11;break}return t.abrupt("return");case 11:return t.next=13,this.triggerNewTask(e,{compressOptions:n,shouldSkipCache:!1,shouldConsiderCORS:!0});case 13:if(!((c=t.sent).naturalWidth>i||c.naturalHeight>a)){t.next=16;break}return t.abrupt("return",c);case 16:case"end":return t.stop()}}),t,this)})))},this.triggerNewTask=function(e,n){return h(t,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.loadingCount<this.maxCount)){t.next=4;break}return t.next=3,this.request(e,n);case 3:case 6:return t.abrupt("return",t.sent);case 4:return t.next=6,this.waitingTask(e,n);case 7:case"end":return t.stop()}}),t,this)})))}}var e=t.prototype;return e.loadImage=function(t,e){return h(this,void 0,void 0,u().mark((function n(){var r,o;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==(r=(e||{}).shouldSkipCache)&&r||!(o=this.getCachedImage(t))){n.next=3;break}return n.abrupt("return",o);case 3:return n.next=5,this.triggerNewTask(t,e);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))},e.getCachedImage=function(t){return this.imageCache.get(t)},e.clearCache=function(){this.imageCache.clear(),this.alreadyFailedImages.clear()},e.hasPicFailed=function(t){return this.alreadyFailedImages.has(t)},e.addToCache=function(t,e){return h(this,void 0,void 0,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e,"function"!==typeof window.createImageBitmap){n.next=5;break}return n.next=4,createImageBitmap(e);case 4:r=n.sent;case 5:this.imageCache.set(t,r);case 6:case"end":return n.stop()}}),n,this)})))},e.waitingTask=function(t,e){return h(this,void 0,void 0,u().mark((function n(){var r=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){r.tasks.push({url:t,callback:function(t){n(t)},requestOptions:e})})));case 1:case"end":return n.stop()}}),n)})))},e.runTask=function(){return h(this,void 0,void 0,u().mark((function t(){var e,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.tasks.pop()){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.request(e.url,e.requestOptions);case 5:n=t.sent,e.callback(n);case 7:case"end":return t.stop()}}),t,this)})))},e.idle=function(){this.loadingCount-=1,this.tasks.length>0&&this.runTask()},e.request=function(t,e){return void 0===e&&(e={}),h(this,void 0,void 0,u().mark((function n(){var r,o,i,a,s,c,l=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=e).shouldSkipCache,i=void 0!==o&&o,a=r.shouldConsiderCORS,s=void 0===a||a,c=r.compressOptions,n.abrupt("return",new Promise((function(e,n){var r=new Image;s&&r.setAttribute("crossorigin","anonymous"),r.onload=function(){return h(l,void 0,void 0,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.loadedCount+=1,this.idle(),i){n.next=5;break}return n.next=5,this.addToCache(t,r);case 5:e(r);case 6:case"end":return n.stop()}}),n,this)})))},r.onerror=function(){l.errorCount+=1,r.onload=null,r.onerror=null,l.idle(),l.alreadyFailedImages.add(t),n("Get Image Error: "+t)},r.src=c?w(t,c):t,l.loadingCount+=1})));case 2:case"end":return n.stop()}}),n)})))},t}(),E=function(t,e,r){var o=t.position.overlayPosition,i=o.widthPixels,a=o.heightPixels,s=t.clipInfo,u=s.clipBottom,c=i/a,l=(i+s.clipLeft+s.clipRight)/i,h=(a+s.clipTop+u)/a;return c>e/r?{width:e*l*n.g.devicePixelRatio,height:e/c*h*n.g.devicePixelRatio,strategy:g.COVER}:{width:r*c*l*n.g.devicePixelRatio,height:r*h*n.g.devicePixelRatio,strategy:g.COVER}},w=function(t,e){if(!T(t))return t;if(_(t))return t.substring(0,t.length-1)+(o().isMobile?"1123":"1600");var n=e.width,r=e.height,i=e.strategy;return S(new URL(t),50*Math.ceil(n/50),50*Math.ceil(r/50),i)},S=function(t,e,n,r){if((!e||Number(t.searchParams.get("w"))<=e)&&(!n||Number(t.searchParams.get("h"))<=n))return t.href;var o=""+t.origin+t.pathname+"?imageMogr2/thumbnail/";return r===g.COVER?o+"!"+(0===e?"":e)+"x"+(0===n?"":n)+"r/ignore-error/1":""+o+(0===e?"":e)+"x"+(0===n?"":n)+"/ignore-error/1"},T=function(t){return _(t)||function(t){return!(!t||t.length<1)&&t.search(/docimg([0-9]|10)\.docs\.qq\.com/)>=0}(t)};function I(t){return t instanceof HTMLImageElement?t:{naturalWidth:t.width,naturalHeight:t.height}}var _=function(t){return!(!t||t.length<1)&&t.indexOf(s.Z.getConfig("custom.standaloneDomains.qqadapt_qpic_cn"))>0},b=new m},37906:function(t,e,n){"use strict";n.d(e,{b:function(){return i},q:function(){return o}});var r=n(91508);function o(){return-1!==["local","new"].indexOf(r.q.getConfig("padStatus"))}var i=function(){return"preview"===r.q.getConfig("preview")}},44251:function(t,e,n){"use strict";n.d(e,{F1:function(){return s},f_:function(){return l},kd:function(){return c},xl:function(){return u}});var r=n(55690),o=n(27869),i=n(29843),a=n(93463);function s(t){var e=t.cellWidth,n=t.cellHeight,r=t.horizontalAlign,o=t.verticalAlign,i=t.dWidth,a=t.dHeight,s=t.marginX,u=void 0===s?0:s,c=t.marginY,l=void 0===c?0:c,h=0,d=0;switch(r.value){case"left":h=u;break;case"center":h=(e-i)/2;break;case"right":h=e-i-u}switch(o.value){case"top":d=l;break;case"middle":d=(n-a)/2;break;case"bottom":d=n-a-l}return{dx:h,dy:d}}function u(t){var e=t.image,n=t.cellWidth,r=t.cellHeight,o=t.horizontalAlign,i=t.verticalAlign,u=t.imageElement,c=e.position.overlayPosition,l=c.widthPixels,h=c.heightPixels,d=e.clipInfo,f=d.clipBottom,p=d.clipLeft,v=d.clipRight,g=d.clipTop,y=l+p+v,m=h+g+f,E=0,w=0,S=0,T=0;if(u){var I=(0,a.L1)(u),_=I.naturalWidth,b=I.naturalHeight;E=_*l/y,w=b*h/m,S=_*p/y,T=b*g/m}var R=l/h,O=0,x=0;R>n/r?x=(O=n)/R:O=(x=r)*R;var C=O/l,L=s({cellWidth:n,cellHeight:r,dWidth:O,dHeight:x,horizontalAlign:o,verticalAlign:i});return{dx:L.dx,dy:L.dy,dWidth:O,dHeight:x,scale:C,sx:S,sy:T,sWidth:E,sHeight:w}}function c(t){var e=t.embeddedImage,n=t.imageItem,r=e.position.overlayPosition,o=r.widthPixels,i=r.heightPixels,s=e.clipInfo,u=s.clipBottom,c=s.clipLeft,l=s.clipRight,h=s.clipTop,d=o+c+l,f=i+h+u,p=(0,a.L1)(n),v=p.naturalWidth,g=p.naturalHeight;return{x:v*c/d,y:g*h/f,width:v*o/d,height:g*i/f}}function l(t,e,n){var a=t.getCellImage(e,n),s=t.getCellDataAtPosition(e,n);if(!a||!s)return null;var c=u({image:a,cellWidth:t.getColWidth(n),cellHeight:(0,o.O)(t,e),horizontalAlign:(0,i.PE)(s),verticalAlign:(0,i.YW)(s)}),l=c.dx,h=c.dy,d=c.scale,f=a.position.overlayPosition,p=f.zIndex,v=f.heightPixels,g=f.widthPixels,y=a.clipInfo,m=y.clipBottom,E=y.clipLeft,w=y.clipRight,S=y.clipTop;return{overlayPosition:new r.OverlayPosition({anchorCell:{rowIndex:e,colIndex:n},offsetXpixels:l,offsetYpixels:h,zIndex:p,heightPixels:v*d,widthPixels:g*d}),clipInfo:new r.EmbeddedImageClip({clipLeft:E*d,clipRight:w*d,clipTop:S*d,clipBottom:m*d})}}},97640:function(t,e,n){"use strict";n.d(e,{Z:function(){return _}}),n(38934),n(48845),n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(31688),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(84919),n(11425),n(15770);var r=n(72757),o=n(4175),i=n(88243),a=n(13504),s=(n(71096),n(46396),function(){function t(t){this.app=t,this.domBound=!1,this.node={}}var e=t.prototype;return e.onSwitchSheet=function(t){this!==t?this.hideViewContainer():this.showViewContainer()},e.getNode=function(){return this.node},t}()),u=n(64668),c=n(56584),l=n(91508),h=n(69315),d=n(98161),f=n(72697);function p(){p=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=f.prototype=h.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=f,s(m,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var v=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},g=function(t){function e(){return t.apply(this,arguments)||this}(0,a.Z)(e,t);var i=e.prototype;return i.init=function(){this.createViewContainer(),this.initEvent(),this.hideViewContainer(),this.resizeEventList=[]},i.bindMountContainer=function(){},i.hideViewContainer=function(){var t=this;Object.keys(this.node).forEach((function(e){var n;null===(n=t.node[e])||void 0===n||n.classList.add("block-hidden")}))},i.showViewContainer=function(){var t,e,n=this;Object.keys(this.node).forEach((function(t){var e;null===(e=n.node[t])||void 0===e||e.classList.remove("block-hidden")})),this.updateContainerSize(),this.updateMobileContainerSize(null===(e=null===(t=this.app.view)||void 0===t?void 0:t.interaction)||void 0===e?void 0:e.getStatus())},i.render=function(t){return v(this,void 0,void 0,p().mark((function e(){var n;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.app.sheetAdapterManager.getAdapterBySheetType(r.ZP.SMART_SHEET),e.next=3,null===n||void 0===n?void 0:n.render(t);case 3:this.app.view.canvas.dataCallView.stop(),this.app.view.canvas.dataCallView.start(),this.updateContainerSize();case 6:case"end":return e.stop()}}),e,this)})))},i.resize=function(){this.updateContainerSize(),this.resizeEventList.forEach((function(t){null===t||void 0===t||t()}))},i.onResize=function(t){t&&this.resizeEventList.push(t)},i.setTopPosition=function(t){var e=this.node.container;e&&(e.style.transform="translateY("+t+"px)",setTimeout((function(){e.style.height="calc(100vh - "+t+"px)"}),600))},i.toggleThemeMode=function(t){t?this.enableThemeMode():this.unableThemeMode()},i.createViewContainer=function(){var t;t=this.insertContainerInPc(),this.node.container=t;var e=document.getElementById("mainContainer");null===e||void 0===e||e.appendChild(t)},i.insertContainerInPc=function(){var t=document.getElementById("mainEditor"),e=t?t.getBoundingClientRect().top:0,n=document.createElement("div");return n.id="external-sheet-container",n.innerHTML="",n.style.width="100%",n.style.zIndex="500",n.style.display="block",n.style.height=window.innerHeight-e+"px",n},i.insertContainerInMobile=function(){document.querySelector("html").style.width="100%",document.body.style.height="100vh",document.body.style.width="100vw",document.body.style.overflow="hidden";var t=document.createElement("div");return Object.assign(t.style,{position:"absolute",top:"0",zIndex:"1001",width:"100vw",height:"calc(100vh - "+c.MN+"px)",overflow:"hidden",transform:"translateY("+(u.VQ?0:c.MN)+"px)",transition:"transform .3s ease",backgroundColor:"#f4f5f9",transformOrigin:"left top"}),t.setAttribute("id","external-sheet-container"),(0,h.vb)(t),t},i.insertContainerInPad=function(){document.querySelector("html").style.width="100%",document.body.style.height="100%",document.body.style.width="100%",document.body.style.overflow="hidden";var t=document.createElement("div");t.id="external-sheet-container";var e=u.VQ?0:c.Mz;return l.q.getConfig("isHistory"),Object.assign(t.style,{position:"absolute",top:"0",marginTop:"0",zIndex:"501",width:"100%",height:window.innerHeight-e+"px",overflow:"hidden",transform:"translateY("+e+"px)",transition:"transform .5s ease",backgroundColor:"#f4f5f9",transformOrigin:"left top",padding:"0",borderTop:"1px solid #e2e4e8"}),t},i.updateContainerSize=function(){var t,e,r=this.node.container,o=document.querySelector("#footerContainer"),i=(null===o||void 0===o?void 0:o.clientHeight)||0,a=null!==(e=null===(t=null===r||void 0===r?void 0:r.getBoundingClientRect())||void 0===t?void 0:t.top)&&void 0!==e?e:100;l.q.getConfig("isHistory")&&(a=0),r.style.height=n.g.innerHeight-a-i+"px"},i.updateMobileContainerSize=function(t){this.app.spreadsheet.isExternalSheet()&&t&&this.node.container},i.initEvent=function(){var t=this;o.ZP.windowEvent.listen("resize",(function(){t.updateContainerSize()})),this.app.event.view.listen(d.Z.EVENT_NAME.ENTER_SCAN_STATUS,(function(){t.updateMobileContainerSize(f.$.SCAN)})),this.app.event.view.listen(d.Z.EVENT_NAME.ENTER_NORMAL_STATUS,(function(){t.updateMobileContainerSize(f.$.NORMAL)}))},i.enableThemeMode=function(){this.node.container.style.background="transparent"},i.unableThemeMode=function(){this.node.container.style.background=c.Xs},e}(s),y=n(84801),m=n(12380);function E(){E=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(b([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var w=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},S=function(t){function e(){return t.apply(this,arguments)||this}(0,a.Z)(e,t);var n=e.prototype;return n.init=function(){},n.bindMountContainer=function(){var t=document.getElementById("mainContainer");this.formulaBar=t.getElementsByClassName("formula-bar")[0],this.mainEditor=document.getElementById("mainEditor"),this.toolbarWrapper=document.getElementsByClassName("pc-toolbar")[0],this.node={formulaBar:this.formulaBar,mainEditor:this.mainEditor,toolbarWrapper:this.toolbarWrapper},this.domBound=!0},n.hideViewContainer=function(){var t=this;this.domBound||this.bindMountContainer(),Object.keys(this.node).forEach((function(e){var n,r;null===(r=null===(n=t.node[e])||void 0===n?void 0:n.classList)||void 0===r||r.add("block-hidden")})),document.body.classList.add("sheet-self-child-hidden")},n.showViewContainer=function(){var t=this;Object.keys(this.node).forEach((function(e){var n,r;null===(r=null===(n=t.node[e])||void 0===n?void 0:n.classList)||void 0===r||r.remove("block-hidden")})),document.body.classList.remove("sheet-self-child-hidden")},n.render=function(t,e){return w(this,void 0,void 0,E().mark((function n(){var r;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=y.Am.get(m.Z),n.next=3,r.switchToSheet();case 3:this.app.view.render(t,null===e||void 0===e?void 0:e.source);case 4:case"end":return n.stop()}}),n,this)})))},n.resize=function(){this.app.view.canvas.resize.resize()},n.onResize=function(){},n.setTopPosition=function(){},n.toggleThemeMode=function(){},e}(s);function T(){T=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(b([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var I=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},_=function(){function t(t){this.app=t,this.typeMap=new Map,this.viewMap=new Map,this.init(),this.typeMap.set(r.ZP.FORM,r.ZP.GRID),this.typeMap.set(r.ZP.OBJECT,r.ZP.GRID),this.typeMap.set(r.ZP.GRID,r.ZP.GRID)}var e=t.prototype;return e.renderView=function(t,e,r){return I(this,void 0,void 0,T().mark((function o(){var i,a;return T().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i=this.typeMap.get(t),a=this.getView(i)){o.next=5;break}return n.g.log.error(t+"对应视图还未注册，无法渲染子表"+e+"！"),o.abrupt("return");case 5:return a!==this.activeView&&(this.activeView=a,this.notifySwitchSheet()),o.next=8,a.render(e,r);case 8:case"end":return o.stop()}}),o,this)})))},e.hiddenOtherContainer=function(t){var e=this,n=this.typeMap.get(t);this.viewMap.forEach((function(t){e.viewMap.get(n)===t?(e.activeView=t,t.showViewContainer()):t.hideViewContainer()}))},e.registerView=function(t,e){var n=e||new g(this.app);return this.viewMap.set(t,n),this.typeMap.set(t,t),n.init(),n},e.getView=function(t){var e=this.typeMap.get(t);if(!this.viewMap.has(e))throw new Error("不存在对应的 sheetType = "+t+"的 view。");return this.viewMap.get(e)},e.getActiveView=function(){return this.activeView},e.resize=function(){this.activeView.resize()},e.isNormalSheet=function(){return this.activeView instanceof S},e.init=function(){this.initDefaultViews(),this.initEvent()},e.initDefaultViews=function(){this.viewMap.set(r.ZP.GRID,new S(this.app)),this.viewMap.forEach((function(t){t.init()}))},e.notifySwitchSheet=function(){var t=this;this.viewMap.forEach((function(e){e.onSwitchSheet(t.activeView)}))},e.initEvent=function(){var t=this;o.ZP.default.listen(i.m.ThemeDetail,(function(e){return t.toggleThemeMode(e)}))},e.toggleThemeMode=function(t){this.viewMap.forEach((function(e){e.toggleThemeMode(t)}))},t}()},40819:function(t,e,n){"use strict";n.d(e,{Z:function(){return rt}});var r,o,i,a,s,u,c=n(13504),l=(n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770),n(53248),n(63240),n(30526)),h=n(76138),d=n(13292),f=n(32263),p=n(12369),v=n(39677),g=n(81293),y=n(80103),m=n(14682),E=n(70474),w=n(78726),S=n(84444),T=n(88957),I=n(82924),_=n(87190),b=n(88877),R=n(80737),O=n(81601),x=n(3078),C=n(40152),L=n(38868),A=n(91508),N=n(65946),D=n(58727),M=n(98486),P=n(56303),k=n(68679),U=n(72190),F=n(58314),j=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},B=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},Z=function(t,e){return function(n,r){e(n,r,t)}},V=function(){function t(t,e,n,r,o,i){this.instantiationService=t,this.spreadsheetApp=e,this.spreadsheet=n,this.spreadsheetView=r,this.mutexManagement=o,this.dataCallView=i,this._level0Inited=!1,this.container=r.container,this.paragraphAccessor=r.paragraphAccessor,this.tableView=r.tableView,this.resize=r.resize,this.clientRect=r.clientRect,this.scale=r.scale,this.headSize=r.headSize,this.transformTable=r.transformTable,this.alloyExcel=r.renderManager.alloyExcel,this.rowcolAccessor=r.rowcolAccessor,this.rowCoverAccessor=r.rowCoverAccessor,this.borderAccessor=r.borderAccessor,this.areaData=r.areaData,this.renderApi=r.renderManager.renderApi,this.mainBoard=r.mainBoard,this.spreadConfig=A.q,this.initCellRenderPlugins(),this.errorTipAccessor=new g.Z(this.dataCallView,this.spreadsheet),this.autoScroll=new v.ZP(this.spreadsheetView),this.defaultScale=new y.Z(this.spreadsheetView),this.operateData=this.spreadsheetView.operateContext.operateData,this.operateBoard=this.spreadsheetView.operateContext.operateBoard,this.mouseOperate=this.spreadsheetView.operateContext.mouseOperate,this.touchOperate=this.spreadsheetView.operateContext.touchOperate,this.dragOperate=new N.Z(this.container),this.normalSelectData=new b.Z(this.dataCallView,this.spreadsheetView),this.formulaSelectData=new R.Z(this.dataCallView,this.spreadsheetView),this.modifyCellBroker=new E.Z(this.spreadsheetApp,this.spreadsheet),this.modifyDimensionBroker=new w.Z(this.spreadsheetApp,this.spreadsheet,this.spreadsheetView,this.normalSelectData),this.modifyLinkBroker=new S.Z(this.spreadsheetApp),this.modifySelectionBroker=new T.Z(this.normalSelectData),this.modifyShapeBroker=new I.Z(this.spreadsheetApp,this.spreadsheet),this.modifySmartSelectionBroker=new _.Z(this.spreadsheetApp),this.modifyMentionNotifyBroker=new D.Z({spreadsheet:this.spreadsheet,normalSelectData:this.normalSelectData}),this.scrollApi=new O.Z(this.spreadsheetView),this.selectApi=new x.Z(this.spreadsheetView),this.shapeStage=new C.Z(this.spreadsheet,this.dataCallView,this.spreadsheetView),this.scaleOperate=new L.Z(this.spreadsheetView,this.scrollApi,this.spreadsheetApp)}var e=t.prototype;return e.initLevel0=function(){this._level0Inited?console.info("view.level0已经初始化"):(console.info("view.level0初始化"),this._level0Inited=!0)},e.init=function(t){this.dataCallView.refresh(t),this.clientRect.refresh(),this.paragraphAccessor.init(t),this.rowCoverAccessor.init(t),this.rowcolAccessor.init(t),this.tableView.init(t),this.borderAccessor.init(t),this.areaData.refresh(),this.alloyExcel.resize(),this.mainBoard.refresh(),this.borderAccessor.init(t),this.errorTipAccessor.refresh(t),this.shapeStage.refresh(),this.resize.resize()},e.refresh=function(t){this.dataCallView.refresh(t),this.clientRect.refresh(),this.paragraphAccessor.refresh(t),this.rowCoverAccessor.refresh(t),this.rowcolAccessor.refresh(t),this.tableView.refresh(t),this.borderAccessor.refresh(t),this.areaData.refresh(),this.alloyExcel.resize(),this.mainBoard.refresh(),this.borderAccessor.refresh(t),this.errorTipAccessor.refresh(t),this.shapeStage.refresh(),this.resize.resize()},e.initCellRenderPlugins=function(){new M.Z({alloyExcel:this.alloyExcel,spreadsheet:this.spreadsheet,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor}),new P.Z({alloyExcel:this.alloyExcel,spreadsheet:this.spreadsheet,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor}),new k.Z({alloyExcel:this.alloyExcel,spreadsheet:this.spreadsheet,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor}),new U.Z({alloyExcel:this.alloyExcel,spreadsheet:this.spreadsheet,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,paragraphAccessor:this.paragraphAccessor}),new F.Z({alloyExcel:this.alloyExcel,spreadsheet:this.spreadsheet,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor})},t}(),G=V=j([Z(0,h.TG),Z(1,l.m),Z(2,d.V),Z(3,f.Z),Z(4,p.Z),Z(5,m.Z),B("design:paramtypes",["function"===typeof(r="undefined"!==typeof h.TG&&h.TG)?r:Object,"function"===typeof(o="undefined"!==typeof l.m&&l.m)?o:Object,"function"===typeof(i="undefined"!==typeof d.V&&d.V)?i:Object,"function"===typeof(a="undefined"!==typeof f.Z&&f.Z)?a:Object,"function"===typeof(s="undefined"!==typeof p.Z&&p.Z)?s:Object,"function"===typeof(u="undefined"!==typeof m.Z&&m.Z)?u:Object])],V),H=n(63192),W=n(47497),Y=n(58218),Q=n(26137),z=n(34293),q=n(32708),K=n(1897),X=n(31360),J=n(80032),$=n(7031);function tt(){tt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var et=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},nt=function(t){function e(){var e;return(e=t.apply(this,arguments)||this)._level1Inited=!1,e}(0,c.Z)(e,t);var n=e.prototype;return n.initLevel1=function(){t.prototype._level0Inited||t.prototype.initLevel0.call(this),this._level1Inited?console.info("view.level1已经初始化"):(this.initLevel1Readonly(),this.spreadsheetApp.sheetStatus.workbookStatus.canEdit&&this.initLevel1Edit(),console.info("view.level1初始化"),this._level1Inited=!0)},n.init=function(e){t.prototype.init.call(this,e)},n.refresh=function(e){t.prototype.refresh.call(this,e)},n.initLevel1Readonly=function(){this._initNormalSelectionStage(),this._initFormulaSelectionStage(),this._initWheelOperate(),this._initSlideOperate(),this._initCellImageManager(),this._initSelectCells(),this.initScrollBar()},n.initLevel1Edit=function(){this._initLinkIdentifyCenter()},n._initSelectCells=function(){this.selectCellsCenter=new X.Z({spreadsheet:this.spreadsheet,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,areaData:this.areaData,touchOperate:this.touchOperate,mouseOperate:this.mouseOperate,selectData:this.normalSelectData,operateData:this.operateData,container:this.container,scrollApi:this.scrollApi,keyboardMount:this.container,normalSelectData:this.normalSelectData,formulaSelectData:this.formulaSelectData,normalSelectionStage:this.normalSelectionStage,formulaSelectionStage:this.formulaSelectionStage,autoScroll:this.autoScroll,clientRect:this.clientRect,mutexManagement:this.mutexManagement})},n._initWheelOperate=function(){this.wheelOperate=new H.Z(this.spreadsheetView,[this.mainBoard.element,this.operateBoard.board]),new Y.Z(this.wheelOperate,this.spreadsheetView)},n._initSlideOperate=function(){this.slideOperate=new W.Z(this.spreadsheetView),new Q.Z(this.slideOperate,this.spreadsheetView)},n._initNormalSelectionStage=function(){this.normalSelectionStage=new q.Z(this.normalSelectData,this.spreadsheetView,this.spreadsheetApp.sheetStatus,this.mutexManagement)},n._initFormulaSelectionStage=function(){this.formulaSelectionStage=new z.Z(this.formulaSelectData,this.spreadsheetView,this.mutexManagement)},n._initCellImageManager=function(){this.cellImageManager=new K.Z({event:this.spreadsheetApp.event,mutationBehavior:this.spreadsheetApp.mutationBehavior,spreadsheet:this.spreadsheet,renderApi:this.renderApi})},n._initLinkIdentifyCenter=function(){this.linkIdentifyCenter=new J.N(this.spreadsheet,this.modifyCellBroker)},n.initScrollBar=function(){return et(this,void 0,void 0,tt().mark((function t(){return tt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.scrollBar=new $.Z({mainBoard:this.spreadsheetView.mainBoard,areaData:this.spreadsheetView.areaData,scale:this.spreadsheetView.scale});case 1:case"end":return t.stop()}}),t,this)})))},e}(G),rt=nt},14682:function(t,e,n){"use strict";var r=(0,n(76138).yh)("IDataCallView");e.Z=r},45721:function(t,e,n){"use strict";var r,o=n(13504),i=(n(53248),n(38934),n(63240),n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(31688),n(74686),n(49502),n(39033)),a=n.n(i),s=n(13292),u=n(4175),c=n(38808),l=n(73543),h=n(48943),d=n(62962),f=n(51592),p=n(28280),v=n(76138),g=n(89654),y=n(20445),m=n(31973),E=n(80227),w=n(65749),S=n(16900),T=n(47590),I=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},_=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},b=function(t,e){return function(n,r){e(n,r,t)}},R=function(t){function e(e){var r;return(r=t.call(this)||this).spreadsheet=e,r.formulaDisplay=!1,r.cacheFilterRangeInSheet={},r.cacheFilterRangeInFilterView={},r.cacheMapRuleInActiveFilterView=new Map,r.onInsertRowEmitter=new p.Q5,r.onInsertColEmitter=new p.Q5,r.onDeleteRowEmitter=new p.Q5,r.onDeleteColEmitter=new p.Q5,r.onSetRowHeightEmitter=new p.Q5,r.onSetColWidthEmitter=new p.Q5,r.onSetRowVisibleEmitter=new p.Q5,r.onSetColVisibleEmitter=new p.Q5,r.onUpdateCellsEmitter=new p.Q5,r.onMergeUnmergeEmitter=new p.Q5,r.onAddEmbeddedObjectEmitter=new p.Q5,r.onUpdateEmbeddedObjectEmitter=new p.Q5,r.onDeleteEmbeddedObjectEmitter=new p.Q5,r.onUpdateHideGridLinesEmitter=new p.Q5,r.onUpdateFreezeEmitter=new p.Q5,r.onAddChartEmitter=new p.Q5,r.onDeleteChartEmitter=new p.Q5,r.onUpdateChartEmitter=new p.Q5,r.onAddAddonEmitter=new p.Q5,r.onDeleteAddonEmitter=new p.Q5,r.onUpdateAddonEmitter=new p.Q5,r.allSheetHandleMutations=[c.ZP.INSERT_DIMENSION_MUTATION,c.ZP.DELETE_DIMENSION_MUTATION,c.ZP.SET_DIMENSION_PROPERTIES_MUTATION,c.ZP.SET_RANGE_MUTATION,c.ZP.SET_CELL_PROPERTIES_MUTATION,c.ZP.REORDER_RANGE_MUTATION,c.ZP.COPY_PASTE_MUTATION,c.ZP.DEFINE_FILTER_MUTATION,c.ZP.UPDATE_FILTER_MUTATION,c.ZP.DELETE_FILTER_MUTATION,c.ZP.MERGE_CELLS_MUTATION,c.ZP.UNMERGE_CELLS_MUTATION],r._handleAfterMutationRun=function(t){m.ZP.jank.log({moduleValue:"dataCallView",actionValue:"handleAfterMutationRun"});try{if(r.spreadsheet.activeSheetId!==t.sheetId&&-1===r.allSheetHandleMutations.indexOf(t.mutation.id)&&"WORKBOOK"!==t.sheetId||r.spreadsheet.isExternalSheet(t.sheetId))return;var e=t.mutation;switch(e.id){case c.ZP.INSERT_DIMENSION_MUTATION:r._insertDimension(e);break;case c.ZP.DELETE_DIMENSION_MUTATION:r._deleteDimension(e);break;case c.ZP.SET_DIMENSION_PROPERTIES_MUTATION:r._setDimensionProperties(e);break;case c.ZP.SET_RANGE_MUTATION:r._setRange(e,t.sheetId);break;case c.ZP.SET_CELL_PROPERTIES_MUTATION:r._setCellProperties(e,t.sheetId);break;case c.ZP.REORDER_RANGE_MUTATION:r._reorderRange(e,t.sheetId);break;case c.ZP.COPY_PASTE_MUTATION:r._copyPaste(e);break;case c.ZP.MERGE_CELLS_MUTATION:case c.ZP.UNMERGE_CELLS_MUTATION:r._mergeOrUnmerge(e);break;case c.ZP.ADD_EMBEDDED_OBJECT_MUTATION:r._addEmbedded(e);break;case c.ZP.UPDATE_EMBEDDED_OBJECT_MUTATION:r._updateEmbedded(e);break;case c.ZP.DELETE_EMBEDDED_OBJECT_MUTATION:r._deleteEmbedded(e);break;case c.ZP.SET_SHEET_PROPERTIES_MUTATION:r._setSheetProperties(e);break;case c.ZP.DEFINE_FILTER_MUTATION:r._defineFilter(e);break;case c.ZP.UPDATE_FILTER_MUTATION:r._updateFilter(e);break;case c.ZP.DELETE_FILTER_MUTATION:r._deleteFilter(e);break;case c.ZP.NEW_ADD_EMBEDDED_OBJECT_MUTATION:r._newAddEmbeddedObject(e);break;case c.ZP.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION:r._newUpdateEmbeddedObject(e);break;case c.ZP.NEW_DELETE_EMBEDDED_OBJECT_MUTATION:r._newDeleteEmbeddedObject(e);break;case c.ZP.UPDATE_WORKBOOK_RANGE_MUTATION:e.workbookRangeType===g.WORKBOOK_RANGE_TYPE.CHART&&r.reRenderChart({workbookRangeId:e.workbookRangeId});break;case c.ZP.ACTIVE_FILTER_VIEW_MUTATION:r.activeFilterView(e)}}catch(o){n.g.log.error("DataCallView handleAfterMutationRun error:",o),m.ZP.zzsStatus({attrid:y.CORE_LINK_ZZS_POINTER.MUTATION_APPLY_TO_VIEW_ERROR,status:1}),T.$.report("MUTATION_APPLY_TO_VIEW_ERROR"),m.ZP.opentelemetry({name:"MUTATION_APPLY_TO_VIEW_ERROR",message:null===o||void 0===o?void 0:o.message,stack:null===o||void 0===o?void 0:o.stack})}},r.handleBeforeMutationRun=function(){var t=r.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();t?r.cacheMapRuleInActiveFilterView=a()(t.getSheet2FilterViewMap()):r.cacheMapRuleInActiveFilterView.clear()},r.updateFilterViewRange=function(t){var e,n=r.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();if(n){var o=null===(e=n.getBasicFilter())||void 0===e?void 0:e.range;(null===o||void 0===o?void 0:o.isCross(t))&&r.onUpdateCellsEmitter.fire({sheetId:t.sheetId,startRow:o.startRowIndex,endRow:o.endRowIndex,startCol:o.startColIndex,endCol:o.endColIndex})}},r.onInsertRow=r.onInsertRowEmitter.event,r.onInsertCol=r.onInsertColEmitter.event,r.onDeleteRow=r.onDeleteRowEmitter.event,r.onDeleteCol=r.onDeleteColEmitter.event,r.onSetRowHeight=r.onSetRowHeightEmitter.event,r.onSetColWidth=r.onSetColWidthEmitter.event,r.onSetRowVisible=r.onSetRowVisibleEmitter.event,r.onSetColVisible=r.onSetColVisibleEmitter.event,r.onUpdateCells=r.onUpdateCellsEmitter.event,r.onMergeUnmerge=r.onMergeUnmergeEmitter.event,r.onAddEmbeddedObject=r.onAddEmbeddedObjectEmitter.event,r.onUpdateEmbeddedObject=r.onUpdateEmbeddedObjectEmitter.event,r.onDeleteEmbeddedObject=r.onDeleteEmbeddedObjectEmitter.event,r.onUpdateHideGridLines=r.onUpdateHideGridLinesEmitter.event,r.onUpdateFreeze=r.onUpdateFreezeEmitter.event,r.onAddChart=r.onAddChartEmitter.event,r.onDeleteChart=r.onDeleteChartEmitter.event,r.onUpdateChart=r.onUpdateChartEmitter.event,r.onAddAddon=r.onAddAddonEmitter.event,r.onDeleteAddon=r.onDeleteAddonEmitter.event,r.onUpdateAddon=r.onUpdateAddonEmitter.event,r.updateCacheFilterRange(e.activeSheetId),r.start(),r}(0,o.Z)(e,t);var r=e.prototype;return r.stop=function(){var t;null===(t=n.g.log)||void 0===t||t.debug("flow DataCallView stop()"),u.ZP.spreadsheetEvent.remove("renderAfterMutationRun",this._handleAfterMutationRun),this.spreadsheet.parent.mutationBehavior.emitter.off(l.Z.EVENT.BEFORE_MUTATION_RUN,this.handleBeforeMutationRun)},r.start=function(){u.ZP.spreadsheetEvent.listen("renderAfterMutationRun",this._handleAfterMutationRun),this.spreadsheet.parent.mutationBehavior.emitter.on(l.Z.EVENT.BEFORE_MUTATION_RUN,this.handleBeforeMutationRun)},r.refresh=function(t){this.updateCacheFilterRange(t),this.stop(),this.start()},r.openFormulaDisplay=function(){this.formulaDisplay=!0},r.closeFormulaDisplay=function(){this.formulaDisplay=!1},r.reRenderChart=function(t){var e=this;this.spreadsheet.embeddedObjectManager.each((function(n){var r=n.properties.chart;r&&r.workbookRangeId.indexOf(t.workbookRangeId)>-1&&n.location.sheetId===e.spreadsheet.activeSheetId&&e.onUpdateChartEmitter.fire({object:n})}))},r.setRowHeight=function(t,e,n){this.onSetRowHeightEmitter.fire({ranges:[{startIndex:t,endIndex:t,dimension:h.Z.ROWS}],size:e,sheetId:n})},r.updateCacheFilterRange=function(t){var e,n=this.spreadsheet.sheetManager.getSheetBySheetId(t);this.cacheFilterRangeInSheet[t]=null===(e=null===n||void 0===n?void 0:n.getBasicFilter())||void 0===e?void 0:e.range},r.updateCacheFilterRangeInFilterView=function(t,e){var n,r=this.spreadsheet.sheetManager.getSheetBySheetId(t),o=null===(n=null===r||void 0===r?void 0:r.getBasicFilter())||void 0===n?void 0:n.range;this.cacheFilterRangeInFilterView[e]=o},r._insertDimension=function(t){t.type===h.Z.ROWS?(t.index=(0,w.Wo)(t.index,this.cacheMapRuleInActiveFilterView),this.onInsertRowEmitter.fire(t)):this.onInsertColEmitter.fire(t)},r._deleteDimension=function(t){t.type===h.Z.ROWS?(t.index=(0,w.Wo)(t.index,this.cacheMapRuleInActiveFilterView),this.onDeleteRowEmitter.fire(t)):this.onDeleteColEmitter.fire(t)},r._setDimensionProperties=function(t){for(var e=0;e<t.operation.length;e++){var n=t.operation[e];if(n.slot===d.P8.SLOT_SIZE){var r={ranges:t.ranges,size:n.size,sheetId:t.sheetId};t.type===h.Z.ROWS?this.onSetRowHeightEmitter.fire(r):this.onSetColWidthEmitter.fire(r)}else if(n.slot===d.P8.SLOT_HIDDEN){var o={ranges:t.ranges,hidden:!!n.hidden,sheetId:t.sheetId};t.type===h.Z.ROWS?this.onSetRowVisibleEmitter.fire(o):this.onSetColVisibleEmitter.fire(o)}}},r._setRange=function(t,e){var n=this.rangeToUpdateCellData(t.gridRange,e);this.onUpdateCellsEmitter.fire(n),this.updateFilterViewRange(t.gridRange)},r._setCellProperties=function(t,e){this.onUpdateCellsEmitter.fire(this.rangeToUpdateCellData(t.gridRange,e)),this.updateFilterViewRange(t.gridRange)},r._reorderRange=function(t,e){this.onUpdateCellsEmitter.fire(this.rangeToUpdateCellData(t.range,e))},r._copyPaste=function(t){var e=this;t.pasteMappings.forEach((function(n){e.onUpdateCellsEmitter.fire(e.rangeToUpdateCellData(n.destination,t.sheetId))}))},r._mergeOrUnmerge=function(t){var e=this.rangeToUpdateCellData(t,t.sheetId);this.onUpdateCellsEmitter.fire(e),this.onMergeUnmergeEmitter.fire(e)},r._addEmbedded=function(t){this.onAddEmbeddedObjectEmitter.fire(t.data.id)},r._updateEmbedded=function(t){this.onUpdateEmbeddedObjectEmitter.fire(t.data.id)},r._deleteEmbedded=function(t){this.onDeleteEmbeddedObjectEmitter.fire(t.key)},r._setSheetProperties=function(t){if(t.sheetDelta)for(var e=t.sheetDelta.deltas,n=0;n<e.length;n++)switch(e[n].slotName){case f.b.SLOT_FROZEN_COL_COUNT:case f.b.SLOT_FROZEN_ROW_COUNT:this.onUpdateFreezeEmitter.fire(t.sheetId);break;case f.b.SLOT_HIDE_GRID_LINE:this.onUpdateHideGridLinesEmitter.fire(t.sheetId)}},r._defineFilter=function(t){var e=t.sheetId,n=t.gridRange,r=t.filterViewId;r?this.cacheFilterRangeInFilterView[r]=n:this.cacheFilterRangeInSheet[e]=n,this.onUpdateCellsEmitter.fire({sheetId:e,startRow:n.startRowIndex,endRow:n.startRowIndex,startCol:n.startColIndex,endCol:n.endColIndex})},r._updateFilter=function(t){var e=t.filterViewId,n=t.sheetId;e&&e===this.spreadsheet.activeSheet.filterViewManager.getActiveFilterViewId()?this.updateFilterView(n,e):this.updateFilter(n)},r.updateFilter=function(t){var e,n=this.spreadsheet.sheetManager.getSheetBySheetId(t);if(n){var r=null===(e=n.getBasicFilter())||void 0===e?void 0:e.range,o=this.cacheFilterRangeInSheet[t],i=(null===o||void 0===o?void 0:o.endRowIndex)||0;this.updateCacheFilterRange(t),r&&this.onSetRowVisibleEmitter.fire({ranges:[{startIndex:r.startRowIndex,endIndex:Math.max(r.endRowIndex,i),dimension:h.Z.ROWS}],sheetId:t})}},r.updateFilterView=function(t,e){var n,r=this,o=this.spreadsheet.sheetManager.getSheetBySheetId(t);if(o){var i=this.cacheFilterRangeInFilterView[e];i&&this.onUpdateCellsEmitter.fire({sheetId:t,startRow:i.startRowIndex,endRow:i.endRowIndex,startCol:i.startColIndex,endCol:i.endColIndex}),this.updateCacheFilterRangeInFilterView(t,e);var a=null===(n=o.getBasicFilter())||void 0===n?void 0:n.range;if(a){var s=[a];i&&(s=a.getExcept(i,this.spreadsheet.activeSheet)),s.length&&s.forEach((function(e){r.onUpdateCellsEmitter.fire({sheetId:t,startRow:e.startRowIndex,endRow:e.endRowIndex,startCol:e.startColIndex,endCol:e.endColIndex})})),this.onSetRowVisibleEmitter.fire({ranges:[{startIndex:a.startRowIndex,endIndex:a.endRowIndex,dimension:h.Z.ROWS}],sheetId:t})}}},r._deleteFilter=function(t){var e=t.sheetId,n=t.filterViewId,r=this.cacheFilterRangeInSheet[e];n&&(r=this.cacheFilterRangeInFilterView[n]),r&&(this.onSetRowVisibleEmitter.fire({ranges:[{startIndex:r.startRowIndex,endIndex:r.endRowIndex,dimension:h.Z.ROWS}],sheetId:e}),this.onUpdateCellsEmitter.fire({sheetId:e,startRow:r.startRowIndex,endRow:r.startRowIndex,startCol:r.startColIndex,endCol:r.endColIndex}),n?this.cacheFilterRangeInFilterView[n]=void 0:this.cacheFilterRangeInSheet[e]=void 0)},r._newAddEmbeddedObject=function(t){var e=t.object;e.location.sheetId===this.spreadsheet.getActiveSheetId()&&(e.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.CHART&&this.onAddChartEmitter.fire(t),e.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.ADDON&&this.onAddAddonEmitter.fire(t))},r._newUpdateEmbeddedObject=function(t){var e=t.object;e.location.sheetId===this.spreadsheet.getActiveSheetId()&&(e.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.CHART&&this.onUpdateChartEmitter.fire(t),e.properties.type===E.NEW_EMBEDDED_OBJECT_TYPE.ADDON&&this.onUpdateAddonEmitter.fire(t))},r._newDeleteEmbeddedObject=function(t){t.objectId.startsWith(S._)?this.onDeleteAddonEmitter.fire(t):this.onDeleteChartEmitter.fire(t)},r.rangeToUpdateCellData=function(t,e){var n=this.spreadsheet.sheetManager.getSheetBySheetId(e).highWaterMark.getMark();return{sheetId:e,startRow:t.startRowIndex,endRow:Math.min(t.endRowIndex,n),startCol:t.startColIndex,endCol:t.endColIndex,showCellFormual:this.formulaDisplay}},r.setRangeMutationToUpdateRanges=function(t,e){for(var n,r,o,i=[],a=this.spreadsheet.sheetManager.getSheetBySheetId(e).highWaterMark.getMark(),s=t.cellDataDeltaAtPositions.sort((function(t,e){return t.rowIndex-e.rowIndex})),u=0;u<s.length;u++){var c=t.cellDataDeltaAtPositions[u],l=t.cellDataDeltaAtPositions[u+1],h=c.rowIndex,d=c.colIndex;if(h>a)break;n=null!==n&&void 0!==n?n:h,r=void 0===r?d:Math.min(r,d),o=void 0===o?d:Math.max(o,d),(!l||l.rowIndex>h+1)&&(i.push({sheetId:e,startRow:n,endRow:h,startCol:r,endCol:o,showCellFormual:this.formulaDisplay}),n=void 0,r=void 0,o=void 0)}return i},r.activeFilterView=function(t){var e=this.spreadsheet.activeSheet,n=this.spreadsheet.getActiveSheetId();this.onUpdateCellsEmitter.fire({sheetId:n,startRow:0,endRow:e.getRowCount(),startCol:0,endCol:e.getColCount()}),this.onUpdateFreezeEmitter.fire(t.sheetId);var r=t.originFilterViewId?e.filterViewManager.getFilterViewByViewId(t.originFilterViewId):null,o=e.filterViewManager.getActiveFilterView(),i=r||e,a=o||e,s=[],u=[],c=[],l=[];null===i||void 0===i||i.getHiddenRowsByUser().forEach((function(t){s.push({startIndex:t,endIndex:t,dimension:h.Z.ROWS})})),null===i||void 0===i||i.getHiddenColumnsByUser().forEach((function(t){u.push({startIndex:t,endIndex:t,dimension:h.Z.COLUMNS})})),a.getHiddenRowsByUser().forEach((function(t){c.push({startIndex:t,endIndex:t,dimension:h.Z.ROWS})})),a.getHiddenColumnsByUser().forEach((function(t){l.push({startIndex:t,endIndex:t,dimension:h.Z.COLUMNS})})),s.length&&this.onSetRowVisibleEmitter.fire({ranges:s,sheetId:n}),u.length&&this.onSetColVisibleEmitter.fire({ranges:u,sheetId:n});var d={ranges:c,hidden:!0,sheetId:n};c.length&&this.onSetRowVisibleEmitter.fire(d);var f={ranges:l,hidden:!0,sheetId:n};l.length&&this.onSetColVisibleEmitter.fire(f)},e}(v.JT);R=I([b(0,s.V),_("design:paramtypes",["function"===typeof(r="undefined"!==typeof s.V&&s.V)?r:Object])],R),e.Z=R},64668:function(t,e,n){"use strict";n.d(e,{VQ:function(){return o}}),n(38934),n(48845),n(19553),n(71091),n(81144),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(80067),o="1"===(0,r.IZ)("m_preview")},57879:function(t,e,n){"use strict";n.d(e,{w:function(){return r}});var r=(0,n(76138).yh)("IView")},3237:function(t,e,n){"use strict";var r=n(2759),o=n(58926),i=n(13504),a=(n(38934),n(48845),n(46396),n(62883),n(19553),n(71091),n(81144),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770),n(31973)),s=n(4175),u=n(25285),c=n(91998),l=n(89577),h=n(14831),d=n.n(h),f=n(72413),p=n(64668),v=n(76138),g=n(597),y=n(22696),m=n(27858),E=n(28280),w=n(56603),S=n(13423),T=n(20589),I=n.n(T),_=n(6655),b=n.n(_),R=n(56584);function O(){O=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var x,C=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};!function(t){t.selectionChange="selectionChange"}(x||(x={}));var L=function(t){function e(e,n,r){var o;return(o=t.call(this)||this).app=e,o.spreadsheet=n,o.pluginImporter=r,o.onSelectionChangeEmitter=new E.Q5({name:x.selectionChange}),o.selectionCache={},o.onSelectionChange=o.onSelectionChangeEmitter.event,o.renderedSheets=[],o.renderedSheets.push(null===n||void 0===n?void 0:n.activeSheetId),o.initViewEvent(),o}(0,i.Z)(e,t);var h=e.prototype;return h.resetAndRefreshExcelView=function(t){this.selectionCache={}},h.initI18n=function(){},h.reportLocation=function(){var t;if(this.canvas){var e=this.canvas.normalSelectData.activeCol,n=this.canvas.normalSelectData.activeRow;if(!(e<0||n<0)){var r={coords:[n,e,n,e],isEditing:!!(null===(t=this.canvas.inputManager)||void 0===t?void 0:t.isInputtingState())};s.ZP.network.trigger("userCaretChange",r)}}},h.initViewEvent=function(){var t,e=this;this.onSelectionChange(I()((function(){e.app.view.canvas.renderApi.renderColHead(),e.app.view.canvas.renderApi.renderRowHead()}),R.dT)),this.onSelectionChange(b()((function(){e.app.view.canvas.renderApi.renderNextTick()}),R.Gy,{leading:!1,trailing:!0})),null===(t=this.app.emitter)||void 0===t||t.on(this.app.EVENT.NEW_DOC_SPREAD_SHEET_PART_INTERACTIVE,(function(t){e.refreshExcelView(t)}))},h.getSelection=function(t){var e,n,r,o,i=this.spreadsheet.activeSheetId,a=this.spreadsheet.activeSheet.getColCount()-1,s=this.spreadsheet.activeSheet.getRowCount()-1;if(t){var h=new c.Z(i,0,0),d=new l.Z(i,0,s,0,a);return new u.Z(h,[d],m.SelectionType.NORMAL,[y.Z.newInstance()])}if(!(null===(e=this.canvas)||void 0===e?void 0:e.normalSelectData))throw new Error("调用getSelection太早，模块未加载");var f=this.canvas.normalSelectData,p=f.selectQueue,v=f.activeRow,E=f.activeCol,w=new c.Z(i,v,E),S=(0,g.UN)(i,this.canvas.rowcolAccessor,p),T=m.SelectionType.NORMAL;return(null===(n=this.canvas.chartCenter)||void 0===n?void 0:n.chartStage.activeChartBoxId)&&(T=m.SelectionType.CHART),(null===(o=null===(r=this.canvas.shapeEditCenter)||void 0===r?void 0:r.shapeEdit)||void 0===o?void 0:o.focusing)&&(T=m.SelectionType.SHAPE),new u.Z(w,S,T,p)},h.getSelectionWithGridRanges=function(t){var e,n,r,o,i=this.spreadsheet.activeSheetId;if(t){var a=new c.Z(i,0,0),s=new l.Z(i);return new u.Z(a,[s],m.SelectionType.NORMAL,[y.Z.newInstance()])}if(!(null===(e=this.canvas)||void 0===e?void 0:e.normalSelectData))throw new Error("调用getSelection太早，模块未加载");var h=this.canvas.normalSelectData,d=h.selectQueue,f=h.activeRow,p=h.activeCol,v=new c.Z(i,f,p),E=(0,g.fq)(i,this.canvas.rowcolAccessor,this.canvas.normalSelectData),w=m.SelectionType.NORMAL;return(null===(n=this.canvas.chartCenter)||void 0===n?void 0:n.chartStage.activeChartBoxId)&&(w=m.SelectionType.CHART),(null===(o=null===(r=this.canvas.shapeEditCenter)||void 0===r?void 0:r.shapeEdit)||void 0===o?void 0:o.focusing)&&(w=m.SelectionType.SHAPE),new u.Z(v,E,w,d)},h.saveSelectionCache=function(t,e){this.selectionCache[t]=e||Object.assign(Object.assign({},this.getSheetLocation()),this.getCurrentPosition())},h.deleteSelectionCache=function(t){this.selectionCache[t]=void 0},h.getSelectionCache=function(t){return this.selectionCache[t]},h.setSelection=function(t){var e=this.getSelectionCache(t);void 0!==e?this.setCurrentSelection(e):this.setFirstCellFocus()},h.setCurrentSelection=function(t){this.canvas.selectApi.selectCells(this.canvas.normalSelectData,{xRange:t.xRange&&(0,o.Z)(t.xRange),yRange:t.yRange&&(0,o.Z)(t.yRange)},null)},h.getSheetLocation=function(){var t,e=this.canvas,n={xRange:[],yRange:[],row:{frozen:0,flow:0},col:{frozen:0,flow:0}};if(null===(t=null===e||void 0===e?void 0:e.normalSelectData)||void 0===t?void 0:t.selectQueue[0]){var r=(0,g.TS)(e.rowcolAccessor,[e.normalSelectData.selectQueue[0]]),o=(0,g.rz)(e.rowcolAccessor,[e.normalSelectData.selectQueue[0]]);n={xRange:[A(o[0][0]),A(o[0][1])],yRange:[A(r[0][0]),A(r[0][1])]}}return n.row={frozen:e.areaData.row.frozen.offsetSize,flow:e.areaData.row.flow.offsetSize},n.col={frozen:e.areaData.col.frozen.offsetSize,flow:e.areaData.col.flow.offsetSize},n},h.getCurrentPosition=function(){return this.canvas?{rowIndex:this.canvas.areaData.row.flow.renderFrom,colIndex:this.canvas.areaData.col.flow.renderFrom}:{rowIndex:0,colIndex:0}},h.setFirstCellFocus=function(){var t=(0,f.mt)(this.spreadsheet.activeSheet,-1,1),e=(0,f.kI)(this.spreadsheet.activeSheet,-1,1);this.canvas.selectApi.selectCells(this.canvas.normalSelectData,{xRange:[t,t],yRange:[e,e]},null)},h.setTopScroll=function(){this.canvas.scrollApi.scrollByPixel({areaX:"flow",diffX:0,areaY:"flow",diffY:0})},h.setSheetScroll=function(t){var e,r,o=this.getSelectionCache(t);if(null===(e=n.g.log)||void 0===e||e.info("[locate] setSheetScroll",{sheetId:t,curSelection:o}),void 0!==o){var i=o.col.flow,a=o.row.flow,s=o.rowIndex,u=o.colIndex,c=this.canvas.spreadsheetView.clientRect,l=c.width,h=c.height,f=this.app.spreadsheet.sheetManager.getSheetBySheetId(t);if(Number(null===(r=null===f||void 0===f?void 0:f.highWaterMark)||void 0===r?void 0:r.getMark())<o.yRange[0])return!1;if(o.needCheckScrollBySize&&i<l&&a<h)return!1;var p=this.canvas.spreadsheetView.renderManager.getRender().calculateSplitter;p.stopAsyncCalculate(),this.canvas.scrollApi.scrollToRenderFrom({row:s,col:u},!1,{type:w.ru.EASE_OUT,onAnimationEnd:function(){return p.startAsyncCalculate()}})}else d().isMobilePhone||d().isAndroidPad||this.setTopScroll();return!0},h.render=function(t,e){if(void 0===e&&(e=S.oz.SLIENT),!this.canvas)throw new Error("视图尚未初始化");this.refreshExcelView(t,e)},h.startLazy=function(){return Promise.all([this.initPlugins()])},h.refreshExcelView=function(t,e){var r;void 0===e&&(e=S.oz.SLIENT),a.ZP.jank.log({moduleValue:"SHEETS_BAR_JANK",actionValue:"SWITCH_SHEET"}),null===(r=n.g.log)||void 0===r||r.info("sheets_bar::switch_sheet_full_refresh_canvas"),this.refreshExcelViewData(t),this.onRefreshExcelView(t,e),this.canvas.renderApi.renderNextTick()},h.refreshExcelViewData=function(t,e){if(t!==this.getActiveSheet().getSheetId())throw new Error("更新 sheet 异常");-1===this.renderedSheets.indexOf(t)||e?(this.renderedSheets.push(t),this.canvas.init(t)):this.canvas.refresh(t)},h.refreshExcelViewSync=function(t){var e;null===(e=n.g.log)||void 0===e||e.info("flow refreshExcelViewSync"),this.refreshExcelViewData(t),this.onRefreshExcelView(t),this.canvas.renderApi.renderTable()},h.onRefreshExcelView=function(t,e){void 0===e&&(e=S.oz.SLIENT)},h.getPluginInstance=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return C(this,void 0,void 0,O().mark((function e(){var o;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.plugins[t]){e.next=2;break}return e.abrupt("return",this.plugins[t]);case 2:return e.next=4,this.pluginImporter[t]();case 4:if(o=e.sent,!this.plugins[t]){e.next=7;break}return e.abrupt("return",this.plugins[t]);case 7:return e.abrupt("return",this.plugins[t]=(0,r.Z)(o.default,n));case 8:case"end":return e.stop()}}),e,this)})))},h._afterCanvasLoaded=function(){window.performanceData&&(window.performanceData.initAfterCanvasLoaded=+new Date)},h.initPlugins=function(){return Promise.resolve()},h.hideLoadingAndWebviewBarIfPreview=function(){var t,e;if(p.VQ){var r=document.createElement("style");r.setAttribute("type","text/css"),r.innerText=".snack-loading-container { display: none !important }",document.head.appendChild(r),d().isTencentDocsApp&&(null===(e=null===(t=n.g.mqq)||void 0===t?void 0:t.ui)||void 0===e||e.setWebViewBehavior({titleBarHide:!0}))}},h.getActiveSheet=function(){return this.spreadsheet.activeSheet},h._setSelectionInSheet=function(t,e){var n,r,o=(null===(n=t.xRange)||void 0===n?void 0:n[0])||0,i=(null===(r=t.yRange)||void 0===r?void 0:r[0])||0;return(o>=e.getColCount()||e.data.isColHidden(o))&&(o=(0,f.mt)(e,0,1)),(i>=e.getRowCount()||e.data.isRowHidden(i))&&(i=(0,f.kI)(e,0,1)),t.xRange=[o,o],t.yRange=[i,i],{x:o,y:i}},e}(v.JT);function A(t){return t<0?0:t}e.ZP=L},89334:function(t,e,n){"use strict";var r=n(85952),o=function(){function t(t){this._a=1,this._b=0,this._c=0,this._d=1,this._e=0,this._f=0,t&&(this._a=t.a,this._b=t.b,this._c=t.c,this._d=t.d,this._e=t.e,this._f=t.f)}var e=t.prototype;return e.transform=function(t,e,n,r,o,i){var a=this._a,s=this._b,u=this._c,c=this._d,l=this._e,h=this._f;return this._a=a*t+u*e,this._b=s*t+c*e,this._c=a*n+u*r,this._d=s*n+c*r,this._e=a*o+u*i+l,this._f=s*o+c*i+h,this},e.scale=function(t,e){return this.transform(t,0,0,e,0,0),this},e.translate=function(t,e){return this.transform(1,0,0,1,t,e),this},e.rotate=function(t){var e=Math.cos(t),n=Math.sin(t);return this.transform(e,n,-n,e,0,0),this},e.applyToPoint=function(t,e){return{x:t*this._a+e*this._c+this._e,y:t*this._b+e*this._d+this._f}},e.reset=function(){return this._a=this._d=1,this._b=this._c=this._e=this._f=0,this},(0,r.Z)(t,[{key:"a",get:function(){return this._a}},{key:"b",get:function(){return this._b}},{key:"c",get:function(){return this._c}},{key:"d",get:function(){return this._d}},{key:"e",get:function(){return this._e}},{key:"f",get:function(){return this._f}}]),t}();e.Z=o},12369:function(t,e,n){"use strict";var r=(0,n(76138).yh)("IMutexManagement");e.Z=r},47616:function(t,e,n){"use strict";n.d(e,{d:function(){return o}}),n(57447),n(41031),n(38934),n(31688);var r,o,i=n(14831),a=n.n(i);!function(t){t.SELECTION="selection",t.FORMULA_SELECTION="formulaSelection",t.SHAPE="shape",t.CHART="chart",t.CARD_CENTER="cardCenter",t.CONTEXT_MENU="contextMenu",t.INPUT="input",t.VALIDATION_LIST="validationList",t.ERROR_TIP_PANEL="errorTipPanel",t.CELL_EDITOR_DROPDOWN="cellEditorDropdown",t.CUSTOM_CELL_EDITOR="customCellEditor",t.VALIDATION_LIST_HEADER="validationListHeader",t.ADDON="addon"}(o||(o={}));var s=o,u=((r={})[s.CHART]=[s.SELECTION,s.SHAPE,s.CUSTOM_CELL_EDITOR,s.ADDON],r[s.SELECTION]=[s.SHAPE,s.CHART,s.ADDON],r[s.FORMULA_SELECTION]=[s.SHAPE,s.CHART,s.ADDON],r[s.INPUT]=[s.CARD_CENTER],r[s.CELL_EDITOR_DROPDOWN]=[s.CARD_CENTER,s.CONTEXT_MENU,s.VALIDATION_LIST],r[s.CONTEXT_MENU]=a().isPC?[s.CARD_CENTER,s.CELL_EDITOR_DROPDOWN,s.VALIDATION_LIST]:[s.CARD_CENTER],r[s.VALIDATION_LIST]=[s.CARD_CENTER],r[s.SHAPE]=a().isPC?[s.SELECTION,s.CHART,s.INPUT,s.CUSTOM_CELL_EDITOR,s.ADDON]:[s.SELECTION,s.CHART,s.CUSTOM_CELL_EDITOR,s.ADDON],r[s.ERROR_TIP_PANEL]=[s.CARD_CENTER,s.CONTEXT_MENU,s.VALIDATION_LIST],r[s.CUSTOM_CELL_EDITOR]=[s.VALIDATION_LIST_HEADER],r[s.ADDON]=[s.SELECTION,s.SHAPE,s.CUSTOM_CELL_EDITOR,s.CHART],r),c=function(){function t(){this._mutexRelations=u,this._mutexComponents={}}var e=t.prototype;return e.addMutexComponent=function(t,e){void 0===this._mutexComponents[t]&&(this._mutexComponents[t]=[]),this._mutexComponents[t].push(e)},e.removeMutexComponent=function(t,e){var n=this._mutexComponents[t];if(n){var r=n.findIndex((function(t){return t===e}));r<0||n.splice(r,1)}},e.mutexShow=function(t){var e,n=this;null===(e=this._mutexRelations[t])||void 0===e||e.forEach((function(t){var e;null===(e=n._mutexComponents[t])||void 0===e||e.forEach((function(t){t.mutexHide()}))}))},t}();e.Z=c},9252:function(t,e,n){"use strict";var r;function o(t,e){return{isMouse:!!n.g.MouseEvent&&t instanceof MouseEvent&&(e===r.MOUSE||!e),isTouch:!!n.g.TouchEvent&&t instanceof TouchEvent&&(e===r.TOUCH||!e)}}function i(t,e,n,r,o){var i=document.createEvent("HTMLEvents");i.initEvent(n,!1,!0),i.x=r,i.y=o,i.originEvent=t,null===e||void 0===e||e.dispatchEvent(i)}function a(t){var e=this,n=o(t,this.handlingType),a=n.isMouse,s=n.isTouch;switch(this.downTime=Date.now(),!0){case a:this.handlingType=r.MOUSE,this.clientX=t.clientX,this.clientY=t.clientY,i(t,e,"pointerDown",this.clientX,this.clientY),this.longPointerTick=setTimeout(i.bind(this,t,e,"longPointer"),500);break;case s:this.handlingType=r.TOUCH;var u=t.touches[0];this.clientX=u.clientX,this.clientY=u.clientY,i(t,e,"pointerDown",this.clientX,this.clientY),this.longPointerTick=setTimeout(i.bind(this,t,e,"longPointer"),500)}}function s(t){var e,r,o;if(n.g.TouchEvent&&t instanceof n.g.TouchEvent){var i=t.touches[0];o=5,e=i.clientX,r=i.clientY}else o=2,e=t.clientX,r=t.clientY;return Math.abs(r-this.clientY)<o&&Math.abs(e-this.clientX)<o}function u(t){var e=o(t,this.handlingType),r=e.isMouse,i=e.isTouch;switch(!0){case r:case i:this.preventDefault&&t.preventDefault(),this.longPointerTick&&!s.call(this,t)&&n.g.clearTimeout(this.longPointerTick)}}function c(t){var e=o(t,this.handlingType),r=e.isMouse,a=e.isTouch,s=-31,u=-31;switch(!0){case r:if(0!==t.button)return;s=t.clientX,u=t.clientY;break;case a:var c=t.changedTouches[0];s=c.clientX,u=c.clientY}this.handlingType=void 0,n.g.clearTimeout(this.longPointerTick),this.longPointerTick=null,Math.abs(s-this.clientX)>30||Math.abs(u-this.clientY)>30||void 0===this.downTime||Date.now()>this.downTime+250&&a||(this.downTime=void 0,i(t,this,"pointer",s,u))}function l(t,e){void 0===e&&(e=!0),t.preventDefault=e,t.addEventListener("mousedown",a),t.addEventListener("touchstart",a),t.addEventListener("mousemove",u),t.addEventListener("touchmove",u),t.addEventListener("mouseup",c),t.addEventListener("touchend",c)}n.d(e,{D2:function(){return l}}),function(t){t.TOUCH="TOUCH",t.MOUSE="MOUSE"}(r||(r={}))},84269:function(t,e,n){"use strict";function r(t){t.addEventListener("touchstart",(function(e){if(1!==e.touches.length)return this.touchT=void 0,void window.clearTimeout(this.longTapTick);var n=e.touches[0];this.touchX=n.clientX,this.touchY=n.clientY,this.touchT=Date.now(),this.longTapTick=window.setTimeout((function(){if(t.onLongTap)t.onLongTap();else{var e=document.createEvent("HTMLEvents");e.initEvent("longTap",!1,!0),t.dispatchEvent(e)}}),500)})),t.addEventListener("touchmove",(function(t){if(t.preventDefault(),this.longTapTick){var e=t.touches[0],n=e.clientX,r=e.clientY;(Math.abs(r-this.touchY)>5||Math.abs(n-this.touchX)>5)&&window.clearTimeout(this.longTapTick)}})),t.addEventListener("touchend",(function(e){var n=e.changedTouches[0],r=n.clientX,o=n.clientY;if(window.clearTimeout(this.longTapTick),!(e.touches.length>0)&&void 0!==this.touchT&&!(Math.abs(o-this.touchY)>30||Math.abs(r-this.touchX)>30)&&Date.now()<=this.touchT+250)if(t.ontap)t.ontap();else{var i=document.createEvent("HTMLEvents");i.initEvent("tap",!1,!0),i.x=r,i.y=o,i.originEvent=e,t.dispatchEvent(i)}}))}n.d(e,{C:function(){return r}})},79506:function(t,e,n){"use strict";function r(t,e,n){var r=t.getCellViewAtPosition(n,e);if(null===r)throw new Error("getCellViewAtPosition error!");return!r.mergeParent}function o(t,e,n){var r=t.getCellViewAtPosition(n,e);if(null===r)throw new Error("getCellViewAtPosition error!");if(r.mergeParent){var o=t.getCellViewAtPosition(n+r.mergeParent.y,e+r.mergeParent.x);if(o&&o.mergeData.colCount>1)return!1}return!(r.mergeData&&r.mergeData.colCount>1)}function i(t,e,n){var r=t.getCellViewAtPosition(n,e);if(null===r)throw new Error("getCellViewAtPosition error!");if(r.mergeParent){var o=t.getCellViewAtPosition(n+r.mergeParent.y,e+r.mergeParent.x);if(o&&o.mergeData.rowCount>1)return!1}return!(r.mergeData&&r.mergeData.rowCount>1)}function a(t,e,n){return!t.isColHidden(e)&&!t.isRowHidden(n)}function s(t,e,n){return!t.isRowHidden(n)}function u(t,e){return!t.isColHidden(e)}function c(t,e,n){var r=t.getCellViewAtPosition(n,e);return null!==r&&!!r.content}function l(t,e,n){var r=t.getCellViewAtPosition(n,e);return null!==r&&!r.content}n.d(e,{AS:function(){return l},D0:function(){return i},PA:function(){return c},Sl:function(){return u},So:function(){return s},dK:function(){return o},eN:function(){return r},hZ:function(){return a}})},5113:function(t,e,n){"use strict";n.d(e,{V5:function(){return o},tH:function(){return r}}),n(52865),n(85932);var r=navigator.userAgent.indexOf("Firefox")>-1,o=(-1!==navigator.userAgent.indexOf("Mac")&&-1!==navigator.userAgent.indexOf("Safari")&&navigator.userAgent.indexOf("Chrome"),navigator.userAgent.match(/Mac\sOS\sX/i));-1!==navigator.userAgent.indexOf("msie")||-1!==navigator.userAgent.indexOf("rv:11")||window.ActiveXObject||window},90644:function(t,e,n){"use strict";function r(t){return 2*t.headSize.rowHeadWidth}function o(t){return 2*t.headSize.colHeadHeight}n.d(e,{n_:function(){return o},pJ:function(){return r}}),n(80067)},12380:function(t,e,n){"use strict";n(53248),n(38934),n(63240),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(48605),o=n(84801),i=n(74755),a=n(43964),s=n(84030),u=n(78801),c=n(30526);function l(){l=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var h={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var h,d,f,p,v=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},y=function(t,e){return function(n,r){e(n,r,t)}},m=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},E=function(){function t(t,e,n,r){this.workbench=t,this.surfaceService=e,this.workbenchSettingService=n,this.app=r,this.isOpening=!1}var e=t.prototype;return e.open=function(){return m(this,void 0,void 0,l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.workbenchSettingService.set("contextMenu.hasOverlay",!1),this.app.spreadsheet.isExternalSheet()){t.next=6;break}return t.next=4,this.renderSheet();case 4:t.next=8;break;case 6:return t.next=8,this.app.sheetAdapterManager.getCurrentAdapter().renderWithWorkbench();case 8:case"end":return t.stop()}}),t,this)})))},e.switchToSheet=function(){return m(this,void 0,void 0,l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.workbenchSettingService.set("contextMenu.hasOverlay",!1),!this.surfaceId){t.next=6;break}return t.next=4,this.surfaceService.setCurrent(this.surfaceId);case 4:t.next=8;break;case 6:return t.next=8,this.renderSheet();case 8:case"end":return t.stop()}}),t,this)})))},e.renderSheet=function(){return m(this,void 0,void 0,l().mark((function t(){var e,n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isOpening){t.next=2;break}return t.abrupt("return");case 2:return this.isOpening=!0,t.next=5,this.workbench.open(u.S,{mode:"stack",attachBeforeRender:!0});case 5:e=t.sent,n=e.id,this.surfaceId=n,this.isOpening=!1;case 9:case"end":return t.stop()}}),t,this)})))},t}();E=v([(0,r.t)(),y(0,(0,o.tB)(i.K)),y(3,c.m),g("design:paramtypes",["function"===typeof(h="undefined"!==typeof i.K&&i.K)?h:Object,"function"===typeof(d="undefined"!==typeof a.W&&a.W)?d:Object,"function"===typeof(f="undefined"!==typeof s.I&&s.I)?f:Object,"function"===typeof(p="undefined"!==typeof c.m&&c.m)?p:Object])],E),e.Z=E},66533:function(){window.requestIdleCallback||(window.requestIdleCallback=function(t,e){var n=(null===e||void 0===e?void 0:e.timeout)||1,r=performance.now();return window.setTimeout((function(){t({get didTimeout(){return!(null===e||void 0===e?void 0:e.timeout)&&performance.now()-r-1>n},timeRemaining:function(){return Math.max(0,performance.now()-r+1)}})}),1)})},70010:function(t,e,n){"use strict";n.d(e,{Du:function(){return o},pI:function(){return i},yv:function(){return r}});var r,o,i=(0,n(76138).yh)("ICollaborationManager");!function(t){t.CURSOR="cursor",t.USERINFO="userinfo",t.NEW="new"}(r||(r={})),function(t){t.CONNECTED="connected",t.NEW="new",t.LEAVE="leave"}(o||(o={}))},84317:function(t,e,n){"use strict";n.d(e,{L:function(){return E},i:function(){return m}}),n(38934),n(48845),n(90109),n(71096),n(31688),n(75793),n(74686),n(93984),n(57447),n(77468),n(84919),n(52865),n(20670),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(11425),n(15770);var r=n(56592),o=n.n(r),i=n(20998),a=n.n(i),s=n(91508),u=n(80067),c=n(48237),l=n(24389);function h(){h=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var d=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};function f(t){var e=[];return Object.keys(t).map((function(n){var r=t[n];Array.isArray(r)?r.forEach((function(t){e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):void 0!==r&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))})),e.join("&")}function p(t){var e,r,o;return d(this,void 0,void 0,h().mark((function i(){var a,s;return h().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=c.default.dependentServiceCombinder.collaborateDomain,i.prev=1,i.next=4,a.collaborateAggregate.getUserMarkName(t);case 4:if(s=i.sent,(null===(e=null===s||void 0===s?void 0:s.resData)||void 0===e?void 0:e.retcode)!==l.Z.SUCCESS){i.next=7;break}return i.abrupt("return",null===(o=null===(r=null===s||void 0===s?void 0:s.resData.data)||void 0===r?void 0:r.result)||void 0===o?void 0:o.rsp);case 7:return i.abrupt("return",[]);case 10:return i.prev=10,i.t0=i.catch(1),n.g.log.error("获取user info 异常",JSON.stringify(i.t0)),i.abrupt("return",[]);case 14:case"end":return i.stop()}}),i,null,[[1,10]])})))}function v(t){return d(this,void 0,void 0,h().mark((function e(){var n,r,o,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(t){return t.startsWith("14")},(r=t.filter((function(t){return n(t)}))).length){e.next=5;break}return e.abrupt("return",{tinyIdToWedriveUin:{},wedriveUinToTinyId:{}});case 5:return o={},i={},e.next=9,p(r);case 9:return e.sent.forEach((function(t){t.wedriveUin&&(o[t.uid]=t.wedriveUin,i[t.wedriveUin]=t.uid)})),e.abrupt("return",{tinyIdToWedriveUin:o,wedriveUinToTinyId:i});case 12:case"end":return e.stop()}}),e)})))}function g(t){var e,n;return d(this,void 0,void 0,h().mark((function r(){var i,a,c,l;return h().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=t.filter((function(t){return t.wedriveUin})),(a=i.map((function(t){return t.wedriveUin}))).length){r.next=4;break}return r.abrupt("return",t);case 4:return r.prev=4,r.next=7,o().post("/wedoc/doc_member_mgr",f({docid:s.q.getConfig("padId"),scode:(0,u.IZ)("scode"),func:8,wx_uin:a}));case 7:c=r.sent,l=c.data,0===(null===(e=l.head)||void 0===e?void 0:e.ret)&&(null===(n=l.body)||void 0===n?void 0:n.uin2xid)&&l.body.uin2xid.forEach((function(t){var e=i.findIndex((function(e){return e.wedriveUin===t.uin}));e>=0&&(i[e].xid=t.xid.toString())})),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(4),console.error(r.t0);case 15:return r.abrupt("return",t);case 16:case"end":return r.stop()}}),r,null,[[4,12]])})))}function y(t){var e,n;return d(this,void 0,void 0,h().mark((function r(){var i,s,u,c,l;return h().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.length){r.next=2;break}return r.abrupt("return",Promise.resolve([]));case 2:return r.next=4,v(t);case 4:return i=r.sent,s=i.tinyIdToWedriveUin,u=i.wedriveUinToTinyId,c=a().stringify({func:1,f:"json",auth_list:JSON.stringify({info:t.map((function(t){return{id:s[t]||t}}))})}),r.prev=8,r.next=11,o().post("/webdisk/member_info",c,{withCredentials:!0});case 11:l=r.sent,r.next=17;break;case 14:r.prev=14,r.t0=r.catch(8),console.error(r.t0);case 17:if(0!==(null===(e=null===l||void 0===l?void 0:l.data.head)||void 0===e?void 0:e.ret)||!(null===(n=null===l||void 0===l?void 0:l.data.body)||void 0===n?void 0:n.member)){r.next=21;break}return r.next=20,g(l.data.body.member.map((function(t){return{markName:t.english_name&&t.real_name?t.english_name+"("+t.real_name+")":t.name,userId:u[t.id]||t.id||t.vid.toString(),uid:u[t.id]||t.id||t.vid.toString(),userPic:t.avatar,corpName:t.corp_name||"",wedriveUin:u[t.id]?s[u[t.id]]:void 0}})));case 20:return r.abrupt("return",r.sent);case 21:return r.abrupt("return",Promise.resolve([]));case 23:case"end":return r.stop()}}),r,null,[[8,14]])})))}function m(t,e){return d(this,void 0,void 0,h().mark((function n(){var r,o;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.filter((function(t){var e;return(null===(e=t.userId)||void 0===e?void 0:e.indexOf("p"))>-1})).map((function(t){var e;return null===(e=t.userId)||void 0===e?void 0:e.replace(/^(.*)\./,"")})),n.next=3,E(r,e);case 3:return o=n.sent,n.abrupt("return",o);case 5:case"end":return n.stop()}}),n)})))}function E(t,e){return void 0===e&&(e=!1),d(this,void 0,void 0,h().mark((function n(){return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",e?y(t):p(t));case 1:case"end":return n.stop()}}),n)})))}},89307:function(t,e,n){"use strict";n.d(e,{DI:function(){return a},FD:function(){return h},Ht:function(){return i},NA:function(){return u},Ou:function(){return c},bM:function(){return l},sn:function(){return s}}),n(19553),n(30980),n(38934),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(90109),n(93984),n(84919);var r,o=n(91508),i=function(){return o.q.getConfig("corpId")||""},a=(null===(r=n.g)||void 0===r?void 0:r.tdocs)||{},s=function(){var t=[];return{set:function(e){t=e},get:function(){return t}}}(),u=function(){return o.q.getConfig("padId")},c=function(){return o.q.getConfig("title")},l=function(){var t=o.q.getConfig("invitedUserInfos")||[],e=new Map;return t.filter((function(t){return!e.has(t.uin)&&e.set(t.uin,1)})).map((function(t){return{englishName:"",name:(null===t||void 0===t?void 0:t.name)||"",vid:(null===t||void 0===t?void 0:t.vid)||(null===t||void 0===t?void 0:t.uin)||"",iconurl:(null===t||void 0===t?void 0:t.iconurl)||(null===t||void 0===t?void 0:t.userPic)||""}}))},h=function(){return!1}},82993:function(t,e,n){"use strict";n.d(e,{az:function(){return O},fV:function(){return S},iV:function(){return o.iV},ji:function(){return R},mC:function(){return y},y8:function(){return v}}),n(84919),n(38934),n(31688),n(71096);var r,o=n(31973),i=n(34996),a=n(99839),s=n(14831),u=n.n(s),c=n(80067),l=n(51795),h=n.n(l),d=n(75227),f=n(10698),p=o.ZP.tdwSingleReport;!function(t){t.PC="PC",t.ANDROID="Android",t.IOS="IOS"}(r||(r={}));var v,g={CheckMutationError:6,RunMutationError:6,afterMutationRunError:6};function y(t){var e=t.message,n=t.error,r=t.errorType;if(void 0!==g[r]){if(g[r]<=0)return;g[r]=g[r]-1}if(o.iV){e||(e="no_message");try{n||((n={}).name="dataLost",n.message="{"+JSON.stringify(e)+"\n}")}catch(i){}null===a.e||void 0===a.e||a.e.captureException(n,{level:"error",logger:"info-report",tags:{ErrorType:r,networkVersion:"new"},sampleReport:!1})}}!function(t){t[t.IMPORTANT=0]="IMPORTANT",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO"}(v||(v={}));var m={level:"l",moduleValue:"m",actionValue:"a",ver5Value:"v5",obj3Value:"o3",detail:"d",baseVersion:"bv",activeSheetId:"asi",memory:"mem"},E=[{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"1",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"2",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"4",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"5",count:5},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"6",count:5},{moduleValue:"messageCenter",actionValue:"commitingQueueBlock",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"-1",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"0",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"1",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"2",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"3",count:5},{moduleValue:"mutation",actionValue:"afterMutationRunDataChange",ver5Value:"1",count:5},{moduleValue:"mutation",actionValue:"afterMutationRun",ver5Value:"1",count:5},{moduleValue:"indexeddb",actionValue:"getDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"clearDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"deleteDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"updateDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"changeDataKeyCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"0",count:0},{moduleValue:"mutationQueue",actionValue:"maxSize",count:5},{moduleValue:"mutationQueue",actionValue:"completeTimeout",count:5}],w={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0};function S(t){var e,n,r,o,i,a,s=t.moduleValue,u=t.actionValue;"applyBehavior"!==s||"local"!==u&&"undo"!==u&&"redo"!==u?"mutation"===s&&"commitMutation"===u?w.commitMutationAmount+=1:"messageCenter"!==s||"sendOfflineUserChange"!==u&&"sendUserChange"!==u?"messageCenter"!==s||"acceptCommit"!==u&&"acceptOfflineCommit"!==u||(w.acceptCommitAmount+=1):w.sendUserChangeAmount+=1:w.applyBehaviorAmount+=1;var c=(null===(n=null===(e=window.SpreadsheetApp)||void 0===e?void 0:e.messageCenter)||void 0===n?void 0:n.versionManager.getCurrentVersion())||-1,l=(null===(o=null===(r=window.SpreadsheetApp)||void 0===r?void 0:r.spreadsheet)||void 0===o?void 0:o.activeSheetId)||"unknown";t.baseVersion=c,t.activeSheetId=l,null===(a=null===(i=window.log)||void 0===i?void 0:i.info)||void 0===a||a.call(i,O(t))}var T=null;function I(){T=d.Z.wait(1e4).run((function(){var t=w,e=t.applyBehaviorAmount,n=t.commitMutationAmount,r=t.sendUserChangeAmount,o=t.acceptCommitAmount;if(0!==e||0!==n||0!==r||0!==o){var a=(0,i.F)(window.SpreadsheetApp.spreadsheet.activeSheetId),s={opername:"excel_dataflow",module:"datalost",action:"datalost",ver3:JSON.stringify(a),ver5:e,ver6:n,ver7:r,ver8:o};null===p||void 0===p||p(s,["user_mac","id"]),w={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0}}I()}))}function _(t,e){void 0===e&&(e=!1);var n=t.moduleValue,r=t.actionValue,o=t.ver5Value,i=n+"_"+r;return void 0===o||e||(i+="_"+o),i}o.iV&&I(),h().visibilitychange.registerOnVisible(I),h().visibilitychange.registerOnHidden((function(){d.Z.erase(T),T=null}));var b=function(){var t={};return E.forEach((function(e){var n=e.moduleValue,r=e.actionValue,o=e.ver5Value,i=e.count,a=_({level:-1,moduleValue:n,actionValue:r,ver5Value:o});t[a]=i})),t}();function R(t){var e,i,a,s,c,l,h,d;try{var g=t.level,y=t.moduleValue,m=t.actionValue,E=t.ver5Value,w=t.obj3Value,S=_(t);if(function(t,e){if(void 0!==b[t]){if(b[t]<=0)return!0;b[t]=b[t]-1}else{var n=_(e,!0);if(void 0!==b[n]){if(b[n]<=0)return!0;b[n]=b[n]-1}}return!1}(S,t))return;var T=null===(i=null===(e=window.SpreadsheetApp)||void 0===e?void 0:e.messageCenter)||void 0===i?void 0:i.versionManager.getCurrentVersion(),I=void 0===T?-1:T,R=(null===(s=null===(a=window.SpreadsheetApp)||void 0===a?void 0:a.spreadsheet)||void 0===s?void 0:s.activeSheetId)||"unknown",x=window.__globalReleaseVersion||"unknown";if(t.baseVersion=I,t.activeSheetId=R,null===(l=null===(c=window.log)||void 0===c?void 0:c.info)||void 0===l||l.call(c,O(t)),!o.iV)return;if(g===v.IMPORTANT||g===v.DEBUG&&(u().isMobilePhone||u().isAndroidPad?u().isAndroid?r.ANDROID:r.IOS:r.PC)===r.PC){var C={opername:"excel_dataflow",module:y||"unknown_dataflow_module",action:m||"unknown_action",obj3:w,ver3:R,ver5:E,ver6:I,ver7:f.Z.CODE_VER,ver8:x,ver9:JSON.stringify({container:n.g.isContainer?1:0,offline_package:n.g.__isOfflinePkg?1:0})};null===p||void 0===p||p(C,["user_mac","id"])}(g===v.DEBUG||g===v.IMPORTANT&&"0"!==E)&&(null===(h=window.log)||void 0===h||h.report(S))}catch(L){console.warn(L),null===(d=window.log)||void 0===d||d.warn("dataFlowReport",L.message)}}function O(t){var e="";if(t)if(Array.isArray(t))t.forEach((function(t){if(e+="#",t)try{e+=JSON.stringify(t)}catch(n){e+="JSON.stringify error."}}));else try{var n={};Object.keys(t).forEach((function(e){n[m[e]||e]=t[e]})),e+=JSON.stringify(n)}catch(r){e+="JSON.stringify error."}return e}"1"===(0,c.IZ)("alloy_report_close")&&(window.isCloseAlloyReport=!0)},50858:function(t,e,n){"use strict";n.d(e,{fe:function(){return a},gl:function(){return i}}),n(52865),n(85932),n(64425),n(93984),n(38934),n(75793);var r=n(56873),o=n(80067);function i(t){var e=t.xRange,n=t.yRange,o=t.col,i=t.row,a=t.rowIndex,s=t.colIndex,u="";return u+=(0,r.colIndex2ColChar)(e[0]||0)+((n[0]||0)+1),u+=(0,r.colIndex2ColChar)(s),u+=o.frozen||0,u+=(0,r.colIndex2ColChar)(a),u+=i.frozen||0,u=encodeURIComponent(u)}function a(t){var e={xRange:[0,0],yRange:[0,0],row:{frozen:0,flow:0},col:{frozen:0,flow:0},rowIndex:0,colIndex:0};return t?decodeURIComponent((0,o.r)(t)).indexOf("$")>-1?e:e=function(t){var e={xRange:[0,0],yRange:[0,0],row:{frozen:0,flow:0},col:{frozen:0,flow:0},rowIndex:0,colIndex:0},o=t.match(/([A-Z]+[0-9]+)/gi);if(o&&3===o.length){var i=(0,r.cellChar2CellCoords)(o[0]),a=(0,r.cellChar2CellCoords)(o[0]),s=(0,r.cellChar2CellCoords)(o[1]),u=(0,r.cellChar2CellCoords)(o[2]);if(i&&a&&s&&u){e.xRange=[i[1],a[1]],e.yRange=[i[0],a[0]];var c=s[0],l=s[1],h=u[0],d=u[1];e.colIndex=l,e.rowIndex=d;var f=function(t,e){var r=n.g.SpreadsheetApp.view.canvas.areaData,o=r.getDisplayViewLeftByCol(e),i=r.getDisplayViewTopByRow(t);return{colFlow:o,rowFlow:i}}(d,l),p=f.colFlow,v=f.rowFlow;e.col.flow=p,e.col.frozen=c+1,e.row.flow=v,e.row.frozen=h+1}}return e}(t):e}},3623:function(t,e,n){"use strict";n.d(e,{c:function(){return r}});var r=(0,n(76138).yh)("ISheetAdapterManager")},78013:function(t,e,n){"use strict";n.d(e,{Z:function(){return Wt}}),n(53248),n(38934),n(63240),n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144);var r=n(72757),o=n(30526),i=n(70010),a=n(76138),s=n(4175),u=(n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770),n(38661)),c=n(13504),l=(n(48845),n(38808)),h=n(51057);function d(){d=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function h(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=h.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var f,p,v,g=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},y=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},m=function(t,e){return function(n,r){e(n,r,t)}},E=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};!function(t){t[t.UNINIT=0]="UNINIT",t[t.INITING=1]="INITING",t[t.SUCCESS=2]="SUCCESS",t[t.FAIL=3]="FAIL"}(v||(v={}));var w,S=function(t,e){var r=this;this.app=t,this.onInitSuccEmitter=new h.Q,this.onInitSucc=this.onInitSuccEmitter.event,this.initStatus=v.UNINIT,this.init=function(){return new Promise((function(t){return E(r,void 0,void 0,d().mark((function e(){var r=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initStatus!==v.SUCCESS){e.next=3;break}return t(!0),e.abrupt("return");case 3:if(this.initStatus!==v.INITING){e.next=6;break}return this.onInitSucc((function(){t(!0)})),e.abrupt("return");case 6:if(e.prev=6,this.initStatus=v.INITING,this.externalSheetSDK){e.next=12;break}return e.next=11,this.bootstrap();case 11:this.externalSheetSDK=e.sent;case 12:if(!this.app.sheetAdapterManager.isWorkbenchReady){e.next=17;break}return e.next=15,this.loadWorkbench();case 15:e.next=18;break;case 17:s.ZP.default.one("sheet_workbench_ready",(function(){return E(r,void 0,void 0,d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.workbenchAdapter){t.next=3;break}return t.next=3,this.loadWorkbench();case 3:case"end":return t.stop()}}),t,this)})))}));case 18:this.registerEvents(),this.injectModules(),this.initStatus=v.SUCCESS,this.onInitSuccEmitter.fire(),t(!0),e.next=30;break;case 25:e.prev=25,e.t0=e.catch(6),n.g.log.error("sheetAdapter: 初始化 sdk 失败: ",e.t0),this.initStatus=v.FAIL,t(!1);case 30:case"end":return e.stop()}}),e,this,[[6,25]])})))}))},this.isInitialized=function(){return r.initStatus===v.SUCCESS},this.registerEvents=function(){r.events||r.initEvents(),r.events.forEach((function(t){var e=t.eventName,n=t.event;r.registerEvent(e,n)}))},this.listen=function(){r.app.emitter.once(r.app.EVENT.SPREAD_SHEET_SDK_CORE_END,(function(){r.app.mutationBehavior.emitter.addListener(r.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,r.onMutationChange)})),r.onInitSucc((function(){r.afterInit()}))},this.onMutationChange=function(t){t.mutation.id===l.ZP.INSERT_SHEET_MUTATION&&r.app.spreadsheet.sheetManager.getSheetBySheetId(t.sheetId).getSheetType()===r.sheetType&&r.init()},this.sheetType=e,this.app.viewManager.registerView(this.sheetType);var o=this.app.viewManager.getView(this.sheetType);this.viewDom=o.getNode().container,this.listen()},T=S=g([m(0,o.m),y("design:paramtypes",["function"===typeof(f="undefined"!==typeof o.m&&o.m)?f:Object,"function"===typeof(p="undefined"!==typeof r.ZP&&r.ZP)?p:Object])],S),I=n(2710),_=n(44099),b=n(91508),R=n(84317),O=n(85952),x=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},C=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},L=function(t,e){return function(n,r){e(n,r,t)}},A=function(){function t(t){this.app=t;var e=this.app.sheetStatus;this.shutDownStatus=e.shutDownStatus,this.tempStatus=e.tempStatus,this.workbookStatus=e.workbookStatus,this.sheetsStatus=e.sheetsStatus}var e=t.prototype;return e.change=function(t){this.shutDownStatus.status.change(t),this.tempStatus.status.change(t),this.workbookStatus.status.change(t),this.sheetsStatus.change(t)},e.offChange=function(t){this.shutDownStatus.status.offChange(t),this.tempStatus.status.offChange(t),this.workbookStatus.status.offChange(t),this.sheetsStatus.offChange(t)},e.getSubStatusBySheetId=function(t){return this.sheetsStatus.status[t]},e.setShutDownStatus=function(t){this.app.permissions.activeShutdownStatus(t)},e.getSheetStatusBySheetId=function(t){if(this.app.spreadsheet.sheetManager.getSheetBySheetId(t)){var e=!0;this.shutDownStatus.status.activate?e=this.shutDownStatus.status.canEdit:this.tempStatus.status.activate&&(e=this.tempStatus.status.canEdit);var n=!0,r=this.sheetsStatus.status[t];return r&&(n=r.canEdit),{canEdit:e&&this.workbookStatus.canEdit&&n,canComment:this.workbookStatus.canComment&&this.workbookStatus.isOnline,canCopy:this.workbookStatus.canCopy}}},(0,O.Z)(t,[{key:"canEdit",get:function(){var t=!0;this.shutDownStatus.status.activate?t=this.shutDownStatus.status.canEdit:this.tempStatus.status.activate&&(t=this.tempStatus.status.canEdit);var e=!0,n=this.app.spreadsheet.activeSheetId,r=this.getSubStatusBySheetId(n);return r&&(e=r.canEdit),t&&this.workbookStatus.canEdit&&e}},{key:"canComment",get:function(){return this.workbookStatus.canComment&&this.workbookStatus.isOnline}},{key:"canCopy",get:function(){return this.workbookStatus.canCopy}}]),t}(),N=A=x([L(0,o.m),C("design:paramtypes",["function"===typeof(w="undefined"!==typeof o.m&&o.m)?w:Object])],A),D=n(75867);function M(){M=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var P=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},k=function(){function t(){}return t.prototype.getAttachment=function(){return P(this,void 0,void 0,M().mark((function t(){var e;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(n.bind(n,48237));case 2:return e=t.sent.default,t.next=5,e.getExtension(D.m.name);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))},t}(),U=n(56592),F=n.n(U),j=n(62986);function B(){B=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var Z=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},V=function(){function t(){}var e=t.prototype;return e.getBrowseLocation=function(t){return Z(this,void 0,void 0,B().mark((function e(){var r,o;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F()({method:"GET",url:"/sdc/getbrowselocation",params:{sheetid:t,type:"view",padid:b.q.getConfig("globalPadId"),xsrf:(0,j.f)()}});case 3:if(r=e.sent,0===(null===(o=r.data)||void 0===o?void 0:o.retcode)){e.next=8;break}return n.g.log.error("getBrowseLocation 获取浏览位置失败",o),e.abrupt("return");case 8:return e.abrupt("return",null===o||void 0===o?void 0:o.result);case 11:return e.prev=11,e.t0=e.catch(0),n.g.log.error("getBrowseLocation 获取浏览位置失败",e.t0),e.abrupt("return");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))},e.updateBrowseLocation=function(t){return Z(this,void 0,void 0,B().mark((function e(){var r,o,i,a;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=t.sheetId,o=t.location,e.next=4,F()({method:"POST",url:"/sdc/updatebrowselocation",params:{sheetid:r,location:o,type:"view",padid:b.q.getConfig("globalPadId"),xsrf:(0,j.f)()}});case 4:i=e.sent,0!==(null===(a=i.data)||void 0===a?void 0:a.retcode)&&n.g.log.error("updateBrowseLocation 更新浏览位置失败",a),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n.g.log.error("updateBrowseLocation 更新浏览位置失败",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))},t}(),G=(n(46396),n(86198)),H=n(1870),W=n(91730),Y=n(66172),Q=n(47974),z=function(t){this.adapterManager=Y.h.getInstance(),this.tencentMeetingController=Q.p.getInstance(t),this.meetingApi=H,this.meetingUtil=Object.assign(Object.assign({},G),{hideFollowButton:W.V,displayFollowButton:W.w});var e=s.ZP.network;this.networkEvent=e},q=n(36156),K=n(8326);function X(){X=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var J=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},$={code:I.fU.SUCCESS,msg:I.pE.SUCCESS},tt={code:I.fU.FAIL,msg:I.pE.FAIL},et={code:I.fU.NOT_FOUND,msg:I.pE.NOT_FOUND},nt=function(){function t(t,e){this.app=t,this.sdk=e,this.initEvent()}var e=t.prototype;return e.setTitle=function(t){var e;if(0===b.q.getConfig("isUserChangeTitle"))try{this.app.spreadsheet.setTitle(t)}catch(r){null===(e=n.g.log)||void 0===e||e.error("smartsheet","应用 title 失败:",r)}},e.isWeCom=function(){return q.xc},e.isToc=function(){return q.oT},e.isHotDoc=function(){var t;return null===(t=n.g.clientVars)||void 0===t?void 0:t.hotDocs},e.fetchSheetData=function(t){var e=this;return b.q.getConfig("isHistory")?this.preloadSheetDataInHistory(t):new Promise((function(r,o){return J(e,void 0,void 0,X().mark((function e(){var i;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.apiReadyPromise;case 2:if(i=this.app.spreadsheet.sheetManager.getSheetBySheetId(t)){e.next=6;break}return r(et),e.abrupt("return");case 6:if(!i.isLoaded){e.next=9;break}return r($),e.abrupt("return");case 9:try{n.g.log.info("smartsheet: 关联子表 "+t+" 开始预加载 loadSheet"),this.app.dataCenter.loadSheetData({sheetId:t,onFinished:function(){n.g.log.info("smartsheet","关联子表 "+t+" 预加载 loadSheet 结束"),r($)},onFail:function(t){r(tt),n.g.log.log("smartsheet "+t)}})}catch(a){n.g.log.info("smartsheet关联子表 "+t+" 预加载 loadSheet 发生异常"),o(a)}case 10:case"end":return e.stop()}}),e,this)})))}))},e.preloadSheetDataInHistory=function(t){return J(this,void 0,void 0,X().mark((function e(){var n;return X().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.app.historyDataCenter.preloadSheetData(t);case 2:if(!(n=e.sent)){e.next=6;break}return this.sdk.applyHistoryData(t,n),e.abrupt("return",Promise.resolve($));case 6:return e.abrupt("return",Promise.reject());case 7:case"end":return e.stop()}}),e,this)})))},e.getSheetList=function(){return this.app.spreadsheet.sheetManager.sheetList},e.getShareInfo=function(){return K.Z.getConfig("custom.share.shareInfo")},e.initEvent=function(){var t=this;this.apiReadyPromise=new Promise((function(e){t.app.sheetAdapterManager.isRequestReady?e(!0):t.app.emitter.once(t.app.EVENT.SPREAD_SHEET_REQUEST_API_READY,(function(){e(!0)}))}))},t}(),rt=n(98161);function ot(){ot=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var it,at,st=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},ut=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},ct=function(t,e){return function(n,r){e(n,r,t)}},lt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ht=function(t){function e(e,o){var i;return(i=t.call(this,e,r.ZP.SMART_SHEET)||this).app=e,i.collaborationManager=o,i.applySheetData=function(t,e){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function n(){return ot().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isInitialized()){n.next=3;break}return n.next=3,this.init();case 3:this.externalSheetSDK.applySheetData(t,e);case 4:case"end":return n.stop()}}),n,this)})))},i.applyReferenceData=function(t,e){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function n(){return ot().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isInitialized()){n.next=3;break}return n.next=3,this.init();case 3:this.externalSheetSDK.applyReferenceData(t,e);case 4:case"end":return n.stop()}}),n,this)})))},i.render=function(t){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function e(){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isInitialized()){e.next=3;break}return e.next=3,this.init();case 3:if(!this.workbenchAdapter){e.next=9;break}if(!1===this.prevSheetIsSmart){e.next=7;break}return e.next=7,this.switchSmartWorkbench();case 7:e.next=10;break;case 9:this.externalSheetSDK.attachEditor(this.viewDom);case 10:this.externalSheetSDK.render(t);case 11:case"end":return e.stop()}}),e,this)})))},i.renderWithWorkbench=function(){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isInitialized()){t.next=3;break}return t.next=3,this.init();case 3:if(this.workbenchAdapter){t.next=6;break}return t.next=6,this.loadWorkbench();case 6:if(!1===this.prevSheetIsSmart){t.next=9;break}return t.next=9,this.switchSmartWorkbench();case 9:this.externalSheetSDK.render(this.app.spreadsheet.activeSheetId);case 10:case"end":return t.stop()}}),t,this)})))},i.dispose=function(){i.externalSheetSDK.dispose()},i.createSheet=function(t,e){i.externalSheetSDK.createSheet(t,e)},i.copySheet=function(t,e){i.externalSheetSDK.copySheet(t,e)},i.deleteSheet=function(t){i.externalSheetSDK.deleteSheet(t)},i.getKeyframeBySheetId=function(t,e){return i.externalSheetSDK.getKeyframeBySheetId(t,e)},i.getTableJSONByViewType=function(t){return i.externalSheetSDK.getTableJSONByViewType(t)},i.getTableJSONBySheetCellData=function(t,e){return i.externalSheetSDK.getTableJSONBySheetCellData(t,e)},i.getTableJSONByTemplateMutations=function(t,e){return i.externalSheetSDK.getTableJSONByTemplateMutations(t,e)},i.renderHistory=function(t,e){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function n(){return ot().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.isInitialized()){n.next=3;break}return n.next=3,this.init();case 3:this.historyAttached||(this.externalSheetSDK.attachEditor(this.viewDom),this.historyAttached=!0),this.externalSheetSDK.applyHistoryData(t,e||{}),this.externalSheetSDK.renderHistory(t);case 6:case"end":return n.stop()}}),n,this)})))},i.handleCreateSheetAcceptCommit=function(t,e){var n,r;null===(r=(n=i.externalSheetSDK).handleCreateSheetAcceptCommit)||void 0===r||r.call(n,t,e)},i.getKeybindings=function(){return i.externalSheetSDK.getShortcutKeybindings()},i.getWorkbenchConfig=function(){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.externalSheetSDK.getWorkbenchSettings());case 1:case"end":return t.stop()}}),t,this)})))},i.getWorkBenchAdapter=function(){return i.externalSheetSDK.getAdapter()},i.coverTableByTemplateMutations=function(t,e){i.externalSheetSDK.coverTableByTemplateMutations(t,e)},i.loadWorkbench=function(){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))},i.switchFirstScreenReport=function(){i.externalSheetSDK.switchFirstScreenReport()},i.bootstrap=function(){return Promise.resolve()},i.registerEvent=function(t,e){i.externalSheetSDK.registerEvent(t,e)},i.injectModule=function(t,e){i.externalSheetSDK.injectModule(t,e)},i.useWorkbenchRender=function(){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.app.spreadsheet.activeSheet.getSheetType()!==r.ZP.SMART_SHEET){t.next=3;break}return t.next=3,this.render(this.app.spreadsheet.activeSheetId);case 3:case"end":return t.stop()}}),t,this)})))},i.handleWatermark=function(){var t,e=b.q.getConfig("watermark");if(e)try{var r=JSON.parse(e);((null===r||void 0===r?void 0:r.show)||(null===(t=null===r||void 0===r?void 0:r.s)||void 0===t?void 0:t.private))&&i.renderWatermark(e)}catch(o){n.g.log.error("smartSheetAdapter: 解析水印数据出错",o)}},i.renderWatermark=function(t){var e={isAuthor:b.q.getConfig("isCreator"),userName:b.q.getConfig("userName"),userDomain:b.q.getConfig("userDomain")};i.externalSheetSDK.renderWatermark({watermarkDocs:t,watermarkUsersDocs:e,watermarkOptions:_.jM})},i.getUserInfosFromServer=function(t){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function e(){return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,R.L)(JSON.parse(t),q.xc));case 1:case"end":return e.stop()}}),e)})))},i.getCollaboratorInfo=function(t){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function e(){var n,r;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=0===(null===t||void 0===t?void 0:t.indexOf("p."))?t:"p."+t,e.next=3,this.collaborationManager.getInstance();case 3:return r=e.sent,e.abrupt("return",r.getCollaboratorInfo(n));case 5:case"end":return e.stop()}}),e,this)})))},i.switchSmartWorkbench=function(){return lt((0,u.Z)(i),void 0,void 0,ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.workbenchAdapter.enter(this.viewDom);case 2:case"end":return t.stop()}}),t,this)})))},i.permission=new N(e),i.userCenter={getUserInfos:i.getUserInfosFromServer,getCollaboratorInfo:i.getCollaboratorInfo},i.browseLocation=new V,i.arkCenter=new k,i}(0,c.Z)(e,t);var o=e.prototype;return o.followRequestMutations=function(t,e,n){return this.externalSheetSDK.followRequestMutations(t,e,n)},o.deserializeMutation=function(t){return this.externalSheetSDK.deserializeMutation(t)},o.deserializeRequests=function(t){return this.externalSheetSDK.deserializeRequests(t)},o.serializeMutation=function(t){return this.externalSheetSDK.serializeMutation(t)},o.getMutationClassByMutationId=function(t){return this.externalSheetSDK.getMutationClassByMutationId(t)},o.runMutations=function(t){return this.externalSheetSDK.runMutations(t)},o.resetHistoryData=function(){var t,e;null===(e=null===(t=this.externalSheetSDK)||void 0===t?void 0:t.resetHistoryData)||void 0===e||e.call(t)},o.initEvents=function(){var t=this;this.events=[{eventName:I.TF.HIDE_SHEET_LIST,event:function(){s.ZP.toolBar.trigger(I.XZ.AFTER_TOOL_PANEL_SHOW)}},{eventName:I.TF.FIRST_EDIT,event:function(t){s.ZP.default.trigger(I.XZ.SMART_SHEET_FIRST_EDIT,t)}},{eventName:I.TF.RENDER_FINISH,event:function(){var t;null===(t=n.g.__ws)||void 0===t||t.trigger(I.XZ.SMART_SHEET_WHITE_FINISH)}},{eventName:I.TF.CANVAS_RENDER_FINISH,event:function(){t.removeSmartSheetTableSsrDOM()}},{eventName:I.TF.ENTER_EDIT_STATUS,event:function(){s.ZP.default.trigger(I.XZ.SMART_SHEET_ENTER_EDIT_STATUS)}},{eventName:I.TF.QUIT_EDIT_STATUS,event:function(){s.ZP.default.trigger(I.XZ.SMART_SHEET_QUIT_EDIT_STATUS)}}]},o.injectModules=function(){var t=this,e=this.app;this.injectModule(I.v7.DATA_CENTER,e.dataCenter),this.injectModule(I.v7.SPREAD_CONFIG,b.q),this.injectModule(I.v7.PERMISSION,this.permission),this.injectModule(I.v7.USER_CENTER,this.userCenter),this.injectModule(I.v7.BROWSE_LOCATION,this.browseLocation),this.injectModule(I.v7.ARK_CENTER,this.arkCenter),this.meetingCenter=new z(e),this.injectModule(I.v7.MEETING_CENTER,this.meetingCenter),this.commonOperation=new nt(e,this.externalSheetSDK),this.injectModule(I.v7.COMMON_OPERATION,this.commonOperation),e.messageCenter?this.injectModule(I.v7.MESSAGE_CENTER,e.messageCenter):e.emitter.once(e.EVENT.SPREAD_SHEET_MESSAGE_END,(function(){t.injectModule(I.v7.MESSAGE_CENTER,e.messageCenter)})),e.undoredoStack?this.injectModule(I.v7.UNDO_REDO_STACK,e.undoredoStack):e.emitter.once(e.EVENT.SPREAD_SHEET_REQUEST_API_READY,(function(){t.injectModule(I.v7.UNDO_REDO_STACK,e.undoredoStack)}))},o.afterInit=function(){this.handleWatermark(),this.listenAfterInit(),this.handleTransformCSV()},o.listenAfterInit=function(){var t;return lt(this,void 0,void 0,ot().mark((function e(){var r=this;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.ZP.network.listen("newWatermark",(function(t){(null===t||void 0===t?void 0:t.watermark)&&r.renderWatermark(t.watermark)})),s.ZP.sheetsBar.listen("switchActiveSheetEnd",(function(t){var e,n;r.prevSheetIsSmart=!r.app.spreadsheet.isExternalSheet();var o=r.app.spreadsheet.sheetManager.getSheetBySheetId(t);null===(n=(e=r.externalSheetSDK).handleSwitchSheet)||void 0===n||n.call(e,{sheetId:t,sheetType:o.getSheetType()})}),"ignoreOffline"),s.ZP.view.listen("handleCursorEnd",(function(t){return lt(r,void 0,void 0,ot().mark((function e(){var n;return ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(n=this.externalSheetSDK)||void 0===n||n.handleCursorMessages(t);case 1:case"end":return e.stop()}}),e,this)})))})),s.ZP.default.listen("refreshUrlAfterSwitchSheet",(function(){var t,e;null===(e=(t=r.externalSheetSDK).refreshURL)||void 0===e||e.call(t)})),!(null===(t=this.app.feature)||void 0===t?void 0:t.relateForm)){e.next=12;break}return e.next=7,n.e(9074).then(n.bind(n,89074));case 7:new(0,e.sent.default)(this.app,this.app.spreadsheet.activeSheetId).handleSmartSheetForm(),e.next=13;break;case 12:rt.Z.event.sheetsBar.one("RelateFormFinished",(function(){return lt(r,void 0,void 0,ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(9074).then(n.bind(n,89074));case 2:new(0,t.sent.default)(this.app,this.app.spreadsheet.activeSheetId).handleSmartSheetForm();case 5:case"end":return t.stop()}}),t,this)})))}));case 13:case"end":return e.stop()}}),e,this)})))},o.removeSmartSheetTableSsrDOM=function(){var t=document.querySelector("#smartsheet-ssr-root");t&&setTimeout((function(){var e;null===(e=t.parentElement)||void 0===e||e.removeChild(t)}),100)},o.handleTransformCSV=function(){return lt(this,void 0,void 0,ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(1756),n.e(505),n.e(2926),n.e(6414)]).then(n.bind(n,68834));case 2:new(0,t.sent.default)(this.app).checkAndTransformCSV();case 5:case"end":return t.stop()}}),t,this)})))},e}(T),dt=ht=st([ct(0,o.m),ct(1,i.pI),ut("design:paramtypes",["function"===typeof(it="undefined"!==typeof o.m&&o.m)?it:Object,"function"===typeof(at="undefined"!==typeof a.RU&&a.RU)?at:Object])],ht),ft=n(24369),pt=n(84801),vt=n(43964),gt=n(48605),yt=n(74755);function mt(){mt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var Et,wt=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},St=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},Tt=function(t,e){return function(n,r){e(n,r,t)}},It=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},_t=function(t){var e=this;this.workbench=t,this.openAdapter=function(t,n){return It(e,void 0,void 0,mt().mark((function e(){return mt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.workbench.open(t,{mode:"stack",attachBeforeRender:!0,content:{container:n}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))},this.workbench=t},bt=_t=wt([(0,gt.t)(),Tt(0,(0,pt.tB)(yt.K)),St("design:paramtypes",["function"===typeof(Et="undefined"!==typeof yt.K&&yt.K)?Et:Object])],_t);function Rt(){Rt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var Ot=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},xt=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).getWorkbenchSettings=function(){return Ot((0,u.Z)(e),void 0,void 0,Rt().mark((function t(){var e,r;return Rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(9661),n.e(8738),n.e(4490),n.e(5620),n.e(6783),n.e(741)]).then(n.bind(n,79395));case 2:return e=t.sent,r=e.pcSheetWorkbenchOptions,t.abrupt("return",r.mount);case 5:case"end":return t.stop()}}),t)})))},e.openSmartSheet=function(t){return Ot((0,u.Z)(e),void 0,void 0,Rt().mark((function e(){var r,o,i,a,s;return Rt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.surfaceService=pt.Am.get(vt.W),this.openService=pt.Am.get(bt),r=this.app.sheetAdapterManager.getCurrentAdapter().getWorkBenchAdapter(),e.next=5,Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(9661),n.e(8738),n.e(4490),n.e(5620),n.e(6783),n.e(741)]).then(n.bind(n,79395));case 5:if(o=e.sent,i=o.pcSheetWorkbenchOptions,this.changeInitialConfigSettings(i),this.surfaceId){e.next=17;break}return e.next=11,this.openService.openAdapter(r,t);case 11:a=e.sent,s=a.id,this.surfaceId=s,this.resize(),e.next=18;break;case 17:this.surfaceService.setCurrent(this.surfaceId);case 18:case"end":return e.stop()}}),e,this)})))},e}return(0,c.Z)(e,t),e}(ft.Z),Ct=xt;function Lt(){Lt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var At,Nt,Dt,Mt,Pt=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},kt=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},Ut=function(t,e){return function(n,r){e(n,r,t)}},Ft=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},jt=function(t){function e(e,r){var o;return(o=t.call(this,e,r)||this).app=e,o.collaborationManager=r,o.loadWorkbench=function(){return Ft((0,u.Z)(o),void 0,void 0,Lt().mark((function t(){return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.workbenchAdapter=new Ct(this.app),t.next=3,this.workbenchAdapter.updateWorkbenchSetting();case 3:case"end":return t.stop()}}),t,this)})))},o.bootstrap=function(){return Ft((0,u.Z)(o),void 0,void 0,Lt().mark((function t(){var e,r;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(9661),n.e(8738),n.e(4490),n.e(9618),n.e(5620),n.e(6783),n.e(247),n.e(1714),n.e(9140)]).then(n.bind(n,81714));case 3:return e=t.sent,r=e.PcSmartSheetSdkSheetAdapter,t.abrupt("return",new r);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",Promise.reject());case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))},o}return(0,c.Z)(e,t),e}(dt),Bt=jt=Pt([Ut(0,o.m),Ut(1,i.pI),kt("design:paramtypes",["function"===typeof(At="undefined"!==typeof o.m&&o.m)?At:Object,"function"===typeof(Nt="undefined"!==typeof a.RU&&a.RU)?Nt:Object])],jt),Zt=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},Vt=function(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)},Gt=function(t,e){return function(n,r){e(n,r,t)}},Ht=function(t,e){var n=this;this.app=t,this.collaborationManager=e,this.adapterMap=new Map,this.init=function(){var t=new Bt(n.app,n.collaborationManager);n.adapterMap.set(r.ZP.SMART_SHEET,t),s.ZP.default.listen("sheet_workbench_ready",(function(){n.isWorkbenchReady=!0}))},this.getAdapterBySheetType=function(t){return n.adapterMap.get(t)},this.getAdapterBySheetId=function(t){var e=n.app.spreadsheet.sheetManager.getSheetBySheetId(t);if(e)return n.adapterMap.get(e.getSheetType())},this.getCurrentAdapter=function(){return n.adapterMap.get(n.app.spreadsheet.activeSheet.getSheetType())}},Wt=Ht=Zt([Gt(0,o.m),Gt(1,i.pI),Vt("design:paramtypes",["function"===typeof(Dt="undefined"!==typeof o.m&&o.m)?Dt:Object,"function"===typeof(Mt="undefined"!==typeof a.RU&&a.RU)?Mt:Object])],Ht)},66172:function(t,e,n){"use strict";n.d(e,{h:function(){return u}});var r=n(58926),o=(n(19553),n(30980),n(38934),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(8195),n(15770),n(84919),n(26894),n(52865),n(13857),n(54371),n(95019),n(98161)),i=n(40597);function a(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u=function(){function t(){this.operationsInFollowing=new Map,this.operationsInUnfollowing=new Map,this.updateMethods=new Map,this.shouldOrderOperation=new Map}t.getInstance=function(){return this.instance||(this.instance=new t),this.instance};var e=t.prototype;return e.registerFollowingOperation=function(t){for(var e=this.operationsInFollowing.get(t)||[],n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];this.operationsInFollowing.set(t,[].concat((0,r.Z)(e),a)),o.Z.event.tencentMeetingEvent.trigger(i.z.DATA_INIT_END,{sheetType:t,operations:a})},e.registerUnfollowingOperation=function(t){for(var e=this.operationsInUnfollowing.get(t)||[],n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];this.operationsInUnfollowing.set(t,[].concat((0,r.Z)(e),o))},e.registerUpdateMethod=function(t,e){this.updateMethods.set(t,e)},e.setShouldOrderOperation=function(t,e){this.shouldOrderOperation.set(t,e)},e.getUpdateMethod=function(t){return this.updateMethods.get(t)},e.getOperationsInfollowing=function(t){return this.operationsInFollowing.get(t)||[]},e.getOperationsInUnfollowing=function(t){return this.operationsInUnfollowing.get(t)||[]},e.getAllOperationsInfollowing=function(){for(var t,e=[],n=a(this.operationsInFollowing.values());!(t=n()).done;){var o=t.value;e.push.apply(e,(0,r.Z)(o))}return e},e.getShouldOrderOperation=function(t){return!!this.shouldOrderOperation.get(t)},t}()},1870:function(t,e,n){"use strict";n.r(e),n.d(e,{getPresentHost:function(){return d},sendPresentData:function(){return p},setPresentHost:function(){return f}}),n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(56592),o=n.n(r),i=n(34522),a=n(86198),s=n(8326);function u(){u=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=l(t[o],t,i);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var c,l=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))};!function(t){t[t.PRESENTER_IS_EMPTY=64004]="PRESENTER_IS_EMPTY",t[t.DOS_HAS_USED=64e3]="DOS_HAS_USED",t[t.SUCCESS=0]="SUCCESS"}(c||(c={}));var h="https://"+s.Z.getConfig("runtime.domainName")+"/room-api/presentinfo";function d(t,e){return l(this,void 0,void 0,u().mark((function r(){var i,a,s,l,d,f,p;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,o().get(""+h,{params:{docid:t,presentid:e},headers:{"content-type":"application/json"}});case 3:if(i=r.sent,(a=i.data).retcode!==c.SUCCESS){r.next=11;break}return s=JSON.parse(a.result||"{}"),l=s.hostInfo,d=s.editPos,f=JSON.parse(d||"{}"),p={hostInfo:l,latestSyncData:f.syncData},r.abrupt("return",p);case 11:return g(a.retcode),n.g.log.error("服务端错误：",a),r.abrupt("return",{});case 16:r.prev=16,r.t0=r.catch(0),n.g.log.error("获取主讲人请求报错：",r.t0);case 19:case"end":return r.stop()}}),r,null,[[0,16]])})))}function f(t,e,r){return l(this,void 0,void 0,u().mark((function i(){var a,s;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,o().post(""+h,{docid:t,presentid:e,uid:r},{headers:{"content-type":"application/json"}});case 3:a=i.sent,(s=a.data).retcode!==c.SUCCESS&&(g(s.retcode),n.g.log.error("设置主讲人信息失败，错误码：",s.retcode,"错误信息：",s.retmsg)),i.next=11;break;case 8:i.prev=8,i.t0=i.catch(0),n.g.log.error("设置主讲人请求报错：",i.t0);case 11:case"end":return i.stop()}}),i,null,[[0,8]])})))}function p(t,e,r){var o={docid:(0,a.getDocId)(),bizid:t,biz_type:"meeting",syncData:e};n.g.log.info("主讲人同步信息sendData：",o),r.sendMessage({cmd:"PRESENT_INFO",taskId:0,data:JSON.stringify(o),onError:v})}function v(t,e,r,o){n.g.log.error("onSendPresentHostDataError",o)}function g(t){t!==c.PRESENTER_IS_EMPTY&&(t!==c.DOS_HAS_USED?i.Z.server.meetingErrorTips(t):i.Z.server.docOccupiedTips(t))}},47974:function(t,e,n){"use strict";n.d(e,{p:function(){return z}}),n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r,o,i,a=n(93184),s=n(1870),u=n(28054),c=(n(46396),n(56592)),l=n.n(c),h=n(86198),d=(n(52865),n(80067));n(36156),function(t){t.PRODUCTION="production",t.PRERELEASE="prerelease",t.TEST="test"}(i||(i={}));var f,p=((r={})[i.PRODUCTION]="16272901304",r[i.PRERELEASE]="16310196082",r[i.TEST]="16282553643",r),v=((o={})[i.PRODUCTION]="1400115281",o[i.PRERELEASE]="1400212767",o[i.TEST]="200008554",o),g=(f=(0,d.ej)("env_name")||"",/testWemeet/.test(f)?i.TEST:/prereleaseWemeet/.test(f)?i.PRERELEASE:i.PRODUCTION),y=p[g],m=v[g];function E(){E=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(b([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var w=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},S=!1,T=function(t){return w(void 0,void 0,void 0,E().mark((function e(){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l().get("/cooperation/v1/meeting/jssdk-sign",{params:t});case 2:if(n=e.sent,0===(r=n.data).ret){e.next=6;break}throw new Error(r.msg);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))},I=n(4175),_=n(13423),b=n(47592),R=n.n(b),O=n(22410),x=n(91730),C=(n(26894),n(40597)),L=n(6801),A=n(83311),N=n(66172);function D(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var P=new(function(){function t(){var t=this;this.updateFollowButton=function(e,n){var r=e.spreadsheet.activeSheetId,o=e.spreadsheet.sheetManager.getSheetBySheetId(r),i=(null===o||void 0===o?void 0:o.getSheetType())||A.SHEET_TYPE.GRID,a=(n||{sheetType:A.SHEET_TYPE.GRID}).sheetType,s=(t.getUpdateButtonMethod(i,a)||L.Jh)(n);I.ZP.tencentMeetingEvent.trigger(C.z.UPDATE_FOLLOW_BUTTON,s)}}var e=t.prototype;return e.handleWithMesssage=function(t,e){for(var n,r,o=D(O.$.getInstance(t).getOperationsInUnfollowing());!(r=o()).done;){var i=r.value;null===(n=i.syncHostOperation)||void 0===n||n.call(i,e)}this.updateFollowButton(t,e)},e.handleWithAudienceOperation=function(t,e){this.updateFollowButton(t,e)},e.getUpdateButtonMethod=function(t,e){var n=N.h.getInstance().getUpdateMethod(t);return t===e&&n?n:function(){return{hideDirection:!0}}},t}()),k=n(21389);function U(){U=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var F=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},j=R()(h.showTip),B=new(function(){function t(){var t=this;this.backToFollow=function(e,r){return F(t,void 0,void 0,U().mark((function t(){var o,i,a;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=(0,h.getDocId)(),t.next=3,(0,s.getPresentHost)(o,r);case 3:if(i=t.sent){t.next=6;break}return t.abrupt("return");case 6:if(a=i.latestSyncData){t.next=10;break}return n.g.log.error("角色是参会者，但是获得到的主讲人位置信息却为空，得到的 presentHostData 为：",i),t.abrupt("return");case 10:Z.setState(B),Z.getState().handleWithMesssage(e,a,r),(0,x.V)(),(0,k.V)();case 15:case"end":return t.stop()}}),t)})))}}var e=t.prototype;return e.handleWithMesssage=function(t,e){O.$.getInstance(t).syncHostOperation(e)},e.handleWithAudienceOperation=function(t,e,n){var r=this;Z.setState(P),j(),(0,x.w)({presenterAvatarUrl:this.getHostPic(e),onClick:function(){return r.backToFollow(t,n)},hideDirection:!0,directionDegree:0})},e.getHostPic=function(t){return t.userInfo.userPic},t}()),Z=new(function(){function t(){this.currentState=B}var e=t.prototype;return e.setState=function(t){this.currentState=t},e.getState=function(){return this.currentState},t}()),V=function(){function t(t,e){var n=this;this.app=t,this.presentId=e,this.handleWithAudienceOperation=function(t){t===_.oz.USER&&(0,h.isPageFished)(n.app)&&Z.getState().handleWithAudienceOperation(n.app,n.hostOperationInfo,n.presentId)},this.operationManager=O.$.getInstance(this.app)}var e=t.prototype;return e.init=function(t){this.operationManager.initAudienceOperationListener(this.handleWithAudienceOperation),this.initMessageListener(),t&&(this.hostOperationInfo=t,this.followHostOperationAfterPageFinished(t))},e.followHostOperationAfterPageFinished=function(t){var e=this,n=Z.getState();(0,h.isPageFished)(this.app)?n.handleWithMesssage(this.app,t,this.presentId):this.app.emitter.once(this.app.EVENT.PAGE_LOAD_FINISHED,(function(){return e.followHostOperationAfterPageFinished(t)}))},e.initMessageListener=function(){var t=this;I.ZP.network.listen("presentData",(function(e,n){t.presentId===n&&(t.hostOperationInfo=e,Z.getState().handleWithMesssage(t.app,e,t.presentId))}))},t}(),G=n(6655),H=n.n(G),W=function(){function t(t,e){var n=this;this.app=t,this.presentId=e,this.debouncedSendPresentData=H()(s.sendPresentData,300),this.getAndSendHostOperation=function(t){var e=n.operationManager.getHostOperationsInfo(t);n.debouncedSendPresentData(n.presentId,e,n.app.messageCenter)},this.operationManager=O.$.getInstance(this.app)}return t.prototype.init=function(){var t=this;this.operationManager.initHostOperationListener(this.getAndSendHostOperation),(0,h.isPageFished)(this.app)?this.getAndSendHostOperation():this.app.emitter.once(this.app.EVENT.PAGE_LOAD_FINISHED,(function(){return t.getAndSendHostOperation()}))},t}();function Y(){Y=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(R){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=u;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,g=v&&v(v(_([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=f.prototype=h.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function _(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:b}}function b(){return{value:void 0,done:!0}}return d.prototype=f,s(y,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(E.prototype),s(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=_,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:_(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var Q=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},z=function(){function t(t){this.app=t,this.role=(0,h.getRoleFromUrl)(),this.uid=(0,a.getUid)(),this.docId=(0,h.getDocId)()}t.getInstance=function(e){return this.instance||(this.instance=new t(e)),this.instance};var e=t.prototype;return e.init=function(){return Q(this,void 0,void 0,Y().mark((function t(){return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.initConfig();case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:return t.next=9,this.initPresentHostData();case 9:this.initController(),(0,h.checkAndShowPrivateFilterTip)(this.app.spreadsheet);case 11:case"end":return t.stop()}}),t,this,[[0,5]])})))},e.isHost=function(){return this.role===u.uU.HOST},e.isAudience=function(){return this.role===u.uU.AUDIENCE},e.getRole=function(){return this.role},e.getPresentId=function(){return this.presentId},e.initPresentHostData=function(){return Q(this,void 0,void 0,Y().mark((function t(){var e,n,r;return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,h.getPresentId)();case 2:return this.presentId=t.sent,t.next=5,(0,s.getPresentHost)(this.docId,this.presentId);case 5:if(e=t.sent){t.next=8;break}return t.abrupt("return");case 8:n=e.hostInfo,r=e.latestSyncData,this.role!==u.uU.HOST||n?this.role=(null===n||void 0===n?void 0:n.uid)===this.uid?u.uU.HOST:u.uU.AUDIENCE:(0,s.setPresentHost)(this.docId,this.presentId,this.uid),this.latestSyncData=r;case 11:case"end":return t.stop()}}),t,this)})))},e.initController=function(){this.role===u.uU.HOST?(this.hostController=new W(this.app,this.presentId),this.hostController.init()):(this.audienceController=new V(this.app,this.presentId),this.audienceController.init(this.latestSyncData))},e.initConfig=function(){return Q(this,void 0,void 0,Y().mark((function t(){return Y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,h.stopTencentMeetingLoading)(),t.next=3,w(void 0,void 0,void 0,E().mark((function t(){var e,r,o,i,a;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!S){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,(0,h.getTencentMeetingSDK)();case 4:return e=t.sent,t.next=7,e.permission.checkJsApiConfig().catch((function(t){var e;throw null===(e=n.g.log)||void 0===e||e.error("检查授权状态失败："+(null===t||void 0===t?void 0:t.message)),new Error("检查授权状态失败："+(null===t||void 0===t?void 0:t.message))}));case 7:if(t.sent.configState!==e.JsApiConfigState.DONE){t.next=12;break}return S=!0,t.abrupt("return");case 12:return t.next=14,e.permission.requestAgentAuthCode({sdkId:y}).catch((function(t){var e;throw null===(e=n.g.log)||void 0===e||e.error("获取授权码失败："+(null===t||void 0===t?void 0:t.message)),new Error("获取授权码失败："+(null===t||void 0===t?void 0:t.message))}));case 14:return r=t.sent,o=r.authCode,t.next=18,T({code:o,url:n.g.location.href}).catch((function(t){var e;throw null===(e=n.g.log)||void 0===e||e.error("获取 sdk 初始化参数失败："+t.message),new Error("获取 sdk 初始化参数失败："+t.message)}));case 18:return i=t.sent,a=i.data,t.next=22,e.permission.agentConfig(Object.assign({corpId:m,sdkId:y},a)).catch((function(t){var e;throw null===(e=n.g.log)||void 0===e||e.error("agentConfig 失败："+t.message),new Error("agentConfig 失败："+t.message)}));case 22:S=!0;case 23:case"end":return t.stop()}}),t)})));case 3:(0,h.setDocCanEditInTencentMeeting)(this.app.sheetStatus.canEdit),(0,h.setDocViewDirectionInTencentMeeting)();case 5:case"end":return t.stop()}}),t,this)})))},t}()},40597:function(t,e,n){"use strict";var r;n.d(e,{z:function(){return r}}),function(t){t.UPDATE_FOLLOW_BUTTON="update_follow_button",t.SHAPE_PREVIEW_SHOW="shape_preview_show",t.SHAPE_PREVIEW_HIDE="shape_preview_hide",t.SHAPE_PREVIEW_UPDATE="shape_preview_update",t.CARD_SHOW="card_show",t.CARD_HIDE="card_hide",t.FOLLOW_HOST_OPERATION_END="follow_host_operation_end",t.DATA_INIT_END="data_init_end"}(r||(r={}))},22410:function(t,e,n){"use strict";n.d(e,{$:function(){return g}});var r=n(58926),o=(n(46396),n(38934),n(15770),n(84919),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144),n(14831)),i=n.n(o),a=n(98161),s=n(91508),u=n(40597),c=n(28054),l=n(66172),h=n(83311),d=n(13423),f=function(){function t(t){var e=this;this.app=t,this.onSwithFinish=function(){e.app.view.canvas.renderApi.renderNextTick(),g.getInstance(e.app).syncNextOperation()}}var e=t.prototype;return e.initHostOperationListener=function(t){a.Z.event.sheetsBar.listen("switchSheet",(function(){return t(c.C8.SWITCH_SHEET)})),a.Z.event.sheetsBar.listen("switchActiveSheetEnd",(function(){return t(c.C8.SWITCH_SHEET)}))},e.getHostOperationInfo=function(){},e.initAudienceOperationListener=function(t){a.Z.event.sheetsBar.listen("switchSheet",(function(e,n,r){var o=(r||{source:d.oz.API}).source;t(o)})),a.Z.event.sheetsBar.listen("switchActiveSheetEnd",(function(e,n){var r=(n||{source:d.oz.API}).source;t(r)}))},e.syncHostOperation=function(t){var e=this,n=this.app.spreadsheet.activeSheetId,r=t.sheetId;r&&n!==r?(a.Z.event.sheetsBar.one("switchSheetEnd",(function(){return e.onSwithFinish()})),a.Z.event.sheetsBar.trigger("switchSheet",r,n,{source:d.oz.API})):this.onSwithFinish()},t}();function p(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var g=function(){function t(t){var e=this;this.getPlatform=function(){var t=c.uF.MOBILE;return i().isPC?t=c.uF.PC:i().isIPad&&(t=c.uF.IPAD),t},this.getUserInfo=function(){var t,n=e.app.view,r=s.q.getConfig("userName"),o=!!(null===(t=n.canvas.inputManager)||void 0===t?void 0:t.isInputtingState()),i=s.q.getConfig("userPic");return{userName:String(r),userPic:i,isEditing:o}},this.app=t,this.adapterManager=l.h.getInstance(),this.preFollowOperations=[new f(this.app)]}t.getInstance=function(e){return this.instance||(this.instance=new t(e)),this.instance};var e=t.prototype;return e.getOperationsInUnfollowing=function(){var t=this.getSheetType()||h.SHEET_TYPE.GRID;return this.adapterManager.getOperationsInUnfollowing(t)},e.getHostOperationsInfo=function(t){var e=Object.assign(Object.assign({},this.getDefaultOperationInfo()),{operationType:t}),n=(this.hostOperationInfo||e).sheetType,r=void 0===n?h.SHEET_TYPE.GRID:n;return this.adapterManager.getOperationsInfollowing(r).reduce((function(t,e){var n,r=null===(n=e.getHostOperationInfo)||void 0===n?void 0:n.call(e);return Object.assign(Object.assign({},t),r)}),e)},e.syncHostOperation=function(t){var e;if(this.currentOperationIndex=-1,this.hostOperationInfo=t,this.hostOperationInfo)for(var n,r=p(this.preFollowOperations);!(n=r()).done;){var o=n.value;null===(e=null===o||void 0===o?void 0:o.syncHostOperation)||void 0===e||e.call(o,t)}},e.syncNextOperation=function(){var t,e=(this.hostOperationInfo||{sheetType:h.SHEET_TYPE.GRID}).sheetType,n=this.adapterManager.getOperationsInfollowing(e);if(this.hostOperationInfo)if(this.adapterManager.getShouldOrderOperation(e))this.syncNextOperationByOrder(n);else for(var r,o=p(n);!(r=o()).done;){var i=r.value;null===(t=null===i||void 0===i?void 0:i.syncHostOperation)||void 0===t||t.call(i,this.hostOperationInfo)}},e.initAudienceOperationListener=function(t){for(var e,n,r=p(this.getAllOperationsInfollowing());!(n=r()).done;){var o=n.value;null===(e=o.initAudienceOperationListener)||void 0===e||e.call(o,t)}a.Z.event.tencentMeetingEvent.listen(u.z.DATA_INIT_END,(function(e){for(var n,r,o=p(e.operations);!(r=o()).done;){var i=r.value;null===(n=i.initAudienceOperationListener)||void 0===n||n.call(i,t)}}))},e.initHostOperationListener=function(t){for(var e,n,r=p(this.getAllOperationsInfollowing());!(n=r()).done;){var o=n.value;null===(e=o.initHostOperationListener)||void 0===e||e.call(o,t)}a.Z.event.tencentMeetingEvent.listen(u.z.DATA_INIT_END,(function(e){for(var n,r,o=p(e.operations);!(r=o()).done;){var i=r.value;null===(n=i.initHostOperationListener)||void 0===n||n.call(i,t)}}))},e.syncNextOperationByOrder=function(t){var e,n=t.length;if(this.currentOperationIndex+=1,this.currentOperationIndex<n&&this.hostOperationInfo){var r=t[this.currentOperationIndex];null===(e=null===r||void 0===r?void 0:r.syncHostOperation)||void 0===e||e.call(r,this.hostOperationInfo)}else this.currentOperationIndex>=n&&a.Z.event.tencentMeetingEvent.trigger(u.z.FOLLOW_HOST_OPERATION_END)},e.getAllOperationsInfollowing=function(){var t=this.preFollowOperations;return t.push.apply(t,(0,r.Z)(this.adapterManager.getAllOperationsInfollowing())),t},e.getSheetType=function(){var t=this.app.spreadsheet.activeSheetId,e=this.app.spreadsheet.sheetManager.getSheetBySheetId(t);return null===e||void 0===e?void 0:e.getSheetType()},e.getDefaultOperationInfo=function(){var t=this.app.spreadsheet.activeSheetId,e=this.app.spreadsheet.sheetManager.getSheetBySheetId(t),n=null===e||void 0===e?void 0:e.getSheetType();return{platform:this.getPlatform(),sheetId:t,sheetType:n,userInfo:this.getUserInfo()}},t}()},21389:function(t,e,n){"use strict";n.d(e,{G:function(){return s},V:function(){return u}});var r=n(14831),o=n.n(r),i=n(31973),a=n(80067);function s(){if(o().isTencentMeeting){var t=(0,a.IZ)("meet_from");t&&i.ZP.tdwReport({opername:"doc_meet_web",module:"share_in_meet",action:"begin_presentation",file_type:2,ver10:t})}}function u(){i.ZP.tdwReport({opername:"doc_meet_web",module:"share_in_meet",action:"click_follow_host",file_type:2,ver10:o().isPC?"pc":"mobile"})}},86198:function(t,e,n){"use strict";n.r(e),n.d(e,{checkAndShowPrivateFilterTip:function(){return w},getDirectionDegree:function(){return R},getDocId:function(){return p},getPresentId:function(){return v},getRoleFromUrl:function(){return f},getTencentMeetingSDK:function(){return _},isFromTencentMeetingSharing:function(){return m},isPageFished:function(){return y},setDocCanEditInTencentMeeting:function(){return S},setDocViewDirectionInTencentMeeting:function(){return T},showTip:function(){return E},stopTencentMeetingLoading:function(){return g}}),n(38934),n(48845),n(52865),n(33552),n(19553),n(71091),n(81144),n(66724),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(11376),o=n(47592),i=n.n(o),a=n(84701),s=(n(22685),n(17663)),u=n(91508),c=n(28054);function l(){l=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(O){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var h={};function d(){}function f(){}function p(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(b([])));y&&y!==e&&n.call(y,o)&&(v=y);var m=p.prototype=d.prototype=Object.create(v);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var u=c(t[o],t,i);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function S(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function b(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return f.prototype=p,s(m,"constructor",p),s(p,"constructor",f),f.displayName=s(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},E(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(m),s(m,a,"Generator"),s(m,o,(function(){return this})),s(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;I(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var h=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function s(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},d=a.default;function f(){var t=n.g.location.search.substring(1);return"speaker"===new URLSearchParams(t).get("login")?c.uU.HOST:c.uU.AUDIENCE}function p(){return u.q.getConfig("globalPadId")}function v(){var t;return h(this,void 0,void 0,l().mark((function e(){var r,o,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return r=e.sent,o=r.data,e.prev=4,e.next=7,o.getCurrMeetingInfo();case 7:return i=e.sent,e.abrupt("return",null!==(t=i.meetingId)&&void 0!==t?t:b());case 11:return e.prev=11,e.t0=e.catch(4),n.g.log.error("获取会议信息失败:",e.t0),n.g.log.info("使用路由的方式获取会议 id"),e.abrupt("return",b());case 16:case"end":return e.stop()}}),e,null,[[4,11]])})))}function g(){return h(this,void 0,void 0,l().mark((function t(){var e,r;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_();case 2:return e=t.sent,r=e.ui,t.prev=4,t.next=7,r.closeLoading();case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(4),n.g.log.error("关闭会议客户端 Loading 失败:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[4,9]])})))}function y(t){return t.lifeCycle===t.EVENT.PAGE_LOAD_FINISHED}function m(){var t="tencent_meeting"===(0,s.i)(),e="true"===localStorage.getItem("meetingDev");return t||e}function E(){d.show({message:r.ZP.t("你可以自由浏览此文档。"),type:"success",duration:3e3})}function w(t){if(m()){var e=t.activeSheet.getBasicFilter();if(e){var n=e.getIsLocalView();(n||!n&&!t.isFilterSync)&&I()}}}function S(t){return h(this,void 0,void 0,l().mark((function e(){var r,o;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:return r=e.sent,o=r.appShare,e.prev=4,e.next=7,o.setDocEditState({state:t});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),n.g.log.error("通知会议文档编辑权限失败:",e.t0);case 12:case"end":return e.stop()}}),e,null,[[4,9]])})))}function T(){return h(this,void 0,void 0,l().mark((function t(){var e,r,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_();case 2:return e=t.sent,r=e.appShare,o=e.DocViewDirectionType,t.prev=4,t.next=7,r.setDocViewDirection({direction:o.LANDSCAPE});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(4),n.g.log.error("通知会议文档最佳展示方向失败:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[4,9]])})))}var I=i()((function(){d.show({message:r.ZP.t("CURRENT_FILTER_VIEW_NOT_SUPPORT_FOLLOWING"),id:"filter-sync-close-tip",type:"info",autoClose:!1,action:r.ZP.t("关闭")})}));function _(){return h(this,void 0,void 0,l().mark((function t(){var e;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(6768).then(n.t.bind(n,62958,23));case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})))}function b(){var t,e=n.g.location.search.substring(1);return null!==(t=new URLSearchParams(e).get("editingPresentId"))&&void 0!==t?t:""}function R(t){var e,n=t.audiencePlace,r=t.hostPlace,o=t.diffPlace,i=0,a=0;if(o)a=o.diffY,i=o.diffX;else if(n&&r){var s=n.row,u=n.col;a=r.row-s,i=r.col-u}return e=0===i&&0===a?-1:0===i?a>0?180:0:0===a?i>0?90:270:function(t){var e=t.diffCol,n=t.diffRow,r=180*Math.atan(Math.abs(e/n))/Math.PI;return r=n>0?180+r*(e<0?1:-1):360+r*(e>0?1:-1),r%=360}({diffRow:a,diffCol:i}),e}},91730:function(t,e,n){"use strict";n.d(e,{V:function(){return y},w:function(){return g}});var r=n(13504),o=(n(13857),n(46396),n(63313)),i=n.n(o),a=n(74012),s=n.n(a),u=n(11376),c=n(14831),l=n.n(c),h=n(82789),d=n(40597),f=n(4175),p=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},v="follow-button-container";function g(t){var e=document.getElementById(v);e||(e=document.createElement("div"),document.body.appendChild(e),e.id=v,s().render(i().createElement(m,Object.assign({},t,{onClick:t.onClick})),e)),e.style.display="block"}function y(){var t=document.getElementById(v);t&&(t.style.display="none")}var m=function(t){function e(){var e;return(e=t.apply(this,arguments)||this).state={directionDegree:0,hideDirection:!1},e.updateFollowButton=function(t){var n=t.directionDegree,r=t.hideDirection;e.setState({hideDirection:r,directionDegree:n})},e}(0,r.Z)(e,t);var n=e.prototype;return n.componentDidMount=function(){f.ZP.tencentMeetingEvent.listen(d.z.UPDATE_FOLLOW_BUTTON,this.updateFollowButton)},n.componentWillUnmount=function(){f.ZP.tencentMeetingEvent.remove(d.z.UPDATE_FOLLOW_BUTTON,this.updateFollowButton)},n.render=function(){var t=this.props,e=t.presenterAvatarUrl,n=p(t,["presenterAvatarUrl"]),r=this.state,o=r.hideDirection,a=r.directionDegree;return l().isMobile?i().createElement(h.SuspendButtonMobile,Object.assign({imgUrl:e,shouldShowGuideAnimation:!0,guideText:u.ZP.t("跟随共享人"),style:{zIndex:9995}},n,{directionDegree:a,hideDirection:o,minBottomOffsetOnResize:60})):i().createElement(h.SuspendButtonPc,Object.assign({imgUrl:e,shouldShowGuideAnimation:!0,guideText:u.ZP.t("跟随共享人"),tipText:u.ZP.t("跟随共享人"),style:{zIndex:1}},n,{directionDegree:a,hideDirection:o}))},e}(i().Component)},22327:function(t,e,n){"use strict";var r;n.d(e,{Y:function(){return S}}),n(38934),n(31688),n(84919),function(t){t.grid="grid",t.form="form",t.smartsheet="smartsheet"}(r||(r={})),n(52865),n(85932),n(33552),n(53923),n(77468);var o=n(16670),i=n(38322),a=n(33069),s=n(14831),u=n.n(s),c=n(20024),l=n(75677);function h(t){return t===o.Y.ADMINISTRATOR||t===o.Y.EDITABLE||t===o.Y.OWNER}function d(t){var e=window.location.search.match(new RegExp("(\\?|&)"+t+"=([^&]*)(&|$)"));return e?decodeURIComponent(e[2]):""}function f(t){var e,r;if(document.getElementById(l.Zu)&&!document.getElementById(l.vs)){var i={sheetId:d("tab"),sheetList:null===(r=null===(e=n.g.clientVars.collab_client_vars.header)||void 0===e?void 0:e[0])||void 0===r?void 0:r.d},a="";try{a=t(i.sheetList||[],i.sheetId,function(){var t=document.querySelector("div[privilegetype]");return t?Number(t.getAttribute("privilegetype")):o.Y.READABLE}())}catch(c){console.error("appendFooterStrPad------------"+c)}var s=document.createElement("div");s.innerHTML=a,s.id=l.n2;var u=document.getElementById(l.Zu);null===u||void 0===u||u.appendChild(s)}}n(62883);var p='<div class="sheet-list-box-container"><div class="hiding-prompt-tip-pc" style="display: none;"><div class="hiding-prompt-tip-pc-content"></div><div class="hiding-prompt-tip-pc-arrow"></div></div><div style="display: inline-block"><div><div class="dui-dropdown-container" data-dui-0-100-3="dui-dropdown-container"><div class="dui-trigger dui-tooltip dui-tooltip-wrapper" data-dui-0-100-3="dui-trigger dui-tooltip dui-tooltip-wrapper"><div><div><div class="sheetListBoxIcon borderRightNone"></div></div></div></div></div></div></div></div>',v='\n<div>\n<div class="tsSheetbox" style="width: '+function(){var t=(document.body||document.documentElement).clientWidth;return t-c.F1.FIXED_WIDTH-(t>c.FR.LARGE?c.U_.NO_COLLAPSE:c.U_.IS_COLLAPSE)}()+'px;">\n',g="</div></div>",y='<div class="scrollWrap">';function m(t,e,n){var o=function(t){var e=(document.body||document.documentElement).clientWidth;return e<c.FR.SMALL||e<c.FR.MIDDLE&&t>4?E:w}(t.length),s=function(t,e,n){var o=h(n),s=function(t,e,n){var o=function(t){var e=0,n=0,o=[];return t.forEach((function(t,e){o[e]=(0,i.clone)(t)})),o.forEach((function(t){var o=t.name,i=(0,a.E)(o),s=t.type===r.smartsheet||t.type==r.form,c=(0,a.h)(i,{hidden:t.hidden,isSetAuthLock:!1,hasSheetIcon:s}),l=e;!u().isMobilePhone&&!u().isAndroidPad&&!u().isIPad&&c>0&&(e+=c-1),t.hidden?n+=c:n+=c-1,t.inputWidth=i,t.width=c,t.left=l})),{contentWidth:n+=1,sheets:o}}(t),s=o.contentWidth,c=o.sheets,l=h(n)&&!0,d='<div class="sheet-content" style="width: '+s+'px; transform: translateX(0px);">';return c.forEach((function(t,n){var o;if(!(n>20||t.hidden)){var i,a=t.id===e?"focus":"blur";d+='\n            <div class="sheet-box sheet sheet-tab-'+a+'" data-id="'+t.id+'" aria-label="'+t.name+'" role="button"\n                tabindex="4" style="z-index: 0; left: '+t.left+"px; width: "+t.width+'px; display: flex;">\n                '+((i=null!==(o=t.type)&&void 0!==o?o:r.grid)===r.form?'<div class="sheet-icon form-sheet-icon"></div>':i===r.smartsheet?'<div class="sheet-icon smart-sheet-icon"></div>':"")+'\n                <span\n                    class="sheet-tab-name" style="width: '+t.inputWidth+'px;">'+t.name+"</span>\n                "+(l?'<div class="meun-iconbox"><div class="menu-icon"> </div></div>':"")+"\n            </div>\n    "}})),y+d+"\n            </div>\n        </div>\n    "}(t,e,n);return v+(o?'\n        <div style="display: inline-block"><div><div class="dui-dropdown-container" data-dui-0-100-3="dui-dropdown-container"><div class="dui-trigger dui-tooltip dui-tooltip-wrapper" data-dui-0-100-3="dui-trigger dui-tooltip dui-tooltip-wrapper"><div><div><span class="dui-badge" data-dui-0-100-3="dui-badge"><div class="addbutton borderRightNone"><div class="icon-svg-sheet-add"></div></div><sup class="dui-badge-dot" data-dui-0-100-3="dui-badge-dot" style="visibility: hidden; width: 8px; height: 8px; background: rgb(255, 71, 71); margin-right: 7px; margin-top: 8px;"></sup></span></div></div></div></div></div></div>\n    ':"")+p+s+g}(t,e,n);return'<footer id="ssrfooterContainer" class="footer-ssr-container">\n                                <div id="pcFooter" class="footer-bottom-pc">'+s+o+"</div></footer>"}var E='\n<div id="sheetbar-right-container">\n        <div class="highlight">\n        <div class="light-switch" data-tooltip="高亮所在行列"></div>\n            <div style="display: inline-block"><div><div class="dui-dropdown-container" data-dui-0-100-3="dui-dropdown-container"><div class="color-switch"><div class="arrow-wrapper"></div></div></div></div></div>\n        </div>\n        <div class="highlight-divider highlight-divider-disable"></div>\n        <div class="full-and-scale divider-disable">\n        <div class="full-and-scale-switch" data-tooltip="显示比例"></div>\n        <div style="display: inline-block">\n        <div>\n        <div>\n        <div class="arrow-wrapper">\n        <div class="arrow"></div>\n        </div>\n        </div>\n        </div>\n        </div>\n        </div>\n        </div>\n',w='<div id="sheetbar-right-container">\n<div class="highlight">\n<div class="light-switch" data-tooltip="高亮所在行列"></div>\n<div style="display: inline-block;">\n<div>\n<div>\n<div class="color-switch">\n<div class="arrow-wrapper"></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class="highlight-divider"></div>\n<div class="full-and-scale-wrap">\n<div class="fullscreenbar" data-tooltip="全屏模式" aria-label="全屏模式" role="button" tabindex="4" style="margin-right: 0px;">\n<div class="fullscreenbar__button">\n<div class="icon-svg-entry-fullscreen sheetbar-fullscreenbar-icon"></div>\n</div>\n</div>\n<div class="scalebar" tabindex="-1" data-tooltip-offsetleft="-27.5">\n<div class="scalebar__zoom scalebar__zoomout" data-tooltip="Cmd+0可恢复至100%" aria-label="缩小,Cmd+0可恢复至100%" tabindex="4">\n<div class="scalebar__zoom-btn"></div>\n</div><span class="scalebar__progress" tabindex="-1"><span class="content">100%</span>\n<ul class="scalebar__progress-list" style="display: none;">\n<li class="item">50%</li>\n<li class="item">75%</li>\n<li class="item selected">100%</li>\n<li class="item">125%</li>\n<li class="item">150%</li>\n<li class="item">200%</li>\n<li class="item">300%</li>\n<li class="item">400%</li>\n</ul>\n</span>\n<div class="scalebar__zoom scalebar__zoomin" data-tooltip="Cmd+0可恢复至100%" aria-label="放大,Cmd+0可恢复至100%" tabindex="4">\n<div class="scalebar__zoom-btn"></div>\n<div class="scalebar__zoom-btn--vertical"></div>\n</div>\n</div>\n</div>\n</div>';function S(){f(m)}},95880:function(t,e,n){"use strict";n.d(e,{F:function(){return r}});var r=(0,n(76138).yh)("IFooter")},33069:function(t,e,n){"use strict";n.d(e,{h:function(){return s},E:function(){return c}});var r=document.createElement("canvas"),o=r.getContext("2d");o.font="400 14px Microsoft YaHei,Verdana,sans-serif";var i=n(14831),a=n.n(i),s=function(t,e){if(e.hidden)return 0;var n=e.isSetAuthLock,r=e.hasSheetIcon,o=0;return a().isMobilePhone||a().isAndroidPad?o=100:(o=t+51,r&&(o+=32)),n&&(o+=r?10:24),o},u={};function c(t){if(u[t])return u[t];var e=function(t){var e=o.measureText(t).width;return Math.ceil(e)}(t)+2;return u[t]=e,e}},64730:function(t,e,n){"use strict";n.d(e,{n:function(){return s}}),n(90109),n(46396),n(19553),n(38934),n(59677),n(71091),n(14199),n(47917),n(48912),n(34797),n(2725),n(12522),n(56687),n(10635),n(89512),n(57625),n(41403),n(76252),n(69398),n(49245),n(15421),n(554),n(81144);var r=n(3857),o=n.n(r),i=n(3653);function a(t){var e=o()(t),r=e.position,a=e.state,s=e.onClick;return void 0!==a&&(e.state=i.W4[a]),void 0!==r&&(e.position=i.LG[r]),void 0!==s&&(e.onclick=n.g.mqq.callback(t.onClick)),e}n(36156);var s=function(){function t(){}return t.show=function(){var t;null===(t=n.g.mqq)||void 0===t||t.invoke("titlebar","setState",{state:1})},t.hide=function(){var t;null===(t=n.g.mqq)||void 0===t||t.invoke("titlebar","setState",{state:0})},t.setActionButtons=function(t){var e;null===(e=n.g.mqq)||void 0===e||e.invoke("titlebar","setActionButtons",{buttons:t.map(a)})},t.updateActionButton=function(e,n){t.updateActionButtons([a(Object.assign({id:e},n))])},t.updateActionButtons=function(t){var e;null===(e=n.g.mqq)||void 0===e||e.invoke("titlebar","updateActionButtonsById",{buttons:t.map(a)})},t.showDialog=function(e,r){void 0===r&&(r=!1);var o=e.id,i=e.content,a=e.button,s=e.onClick;t.dialogExisting.has(o)||(!0===r&&t.dialogExisting.add(o),n.g.mqq.invoke("titlebar","showDialogById",{id:o,event:event,msg:i,btnText:a,onclick:n.g.mqq.callback((function(e){s(e),t.dialogExisting.delete(o)}))}))},t.hideButtonsBeforeJump=function(){t.setActionButtons([{id:"back",state:"show",type:"image",position:"left",url:i.Te.BACK}])},t}();s.dialogExisting=new Set},3653:function(t,e,n){"use strict";n.d(e,{GV:function(){return a},Je:function(){return s},LG:function(){return i},Te:function(){return r},W4:function(){return o},fS:function(){return u}});var r={SHARE:"0",MENU:"1",STAR_OFF:"2",STAR_ON:"3",BACK:"4",UNDO:"5",REDO:"6",EXPAND:"7",DONE:"10",EYE:"11",ADD_COLLABORATOR:"12",COLLABORATOR:"13",NOTIFICATION:"14",AUTH:"15"},o={show:0,hide:1,disable:2},i={left:0,right:1,middle:2},a="nv_types",s="sheet",u="2.16.9"},34533:function(t,e,n){"use strict";n.d(e,{W:function(){return c},y:function(){return l}}),n(52865),n(85932);var r=n(14831),o=n.n(r),i=n(80067),a=n(3653),s=n(36156),u=void 0;function c(){return void 0!==u?u:u=function(){var t,e;return((null===(e=null===(t=n.g.tdocs)||void 0===t?void 0:t.isWedocWebview)||void 0===e?void 0:e.call(t))||o().isTencentDocsApp)&&s.xc,!(!o().isTencentDocsApp||null===(0,i.ej)(a.GV).match(a.Je))}()}function l(){return!(!o().isTencentDocsApp||null===(0,i.ej)(a.GV).match(a.Je))}},20024:function(t,e,n){"use strict";var r,o,i;n.d(e,{F1:function(){return i},FR:function(){return r},U_:function(){return o}}),function(t){t[t.LARGE=1280]="LARGE",t[t.MIDDLE=800]="MIDDLE",t[t.SMALL=512]="SMALL"}(r||(r={})),function(t){t[t.IS_COLLAPSE=110]="IS_COLLAPSE",t[t.NO_COLLAPSE=236]="NO_COLLAPSE"}(o||(o={})),function(t){t[t.FIXED_WIDTH=140]="FIXED_WIDTH",t[t.MIN_NOCOLLAPSE_STATISTICS168=168]="MIN_NOCOLLAPSE_STATISTICS168",t[t.MIN_COLLAPSE_STATISTICS=50]="MIN_COLLAPSE_STATISTICS",t[t.SMALL_STATISTICS_WIDEST_WIDTH=100]="SMALL_STATISTICS_WIDEST_WIDTH",t[t.STATISTICS_RIGHT=24]="STATISTICS_RIGHT",t[t.STATISTICS_PADDING=40]="STATISTICS_PADDING",t[t.NCOLLAPSE_STATISTICS_RIGHT=20]="NCOLLAPSE_STATISTICS_RIGHT",t[t.SCROLL_WIDTH=60]="SCROLL_WIDTH",t[t.FASTCALCULAT_WIDTH=60]="FASTCALCULAT_WIDTH",t[t.MIN_WRAPWIDTH=100]="MIN_WRAPWIDTH",t[t.INTOASRPREVIEW_RIGHT=60]="INTOASRPREVIEW_RIGHT",t[t.FULLANDSCALE_COLLAPSE_RIGHT=80]="FULLANDSCALE_COLLAPSE_RIGHT",t[t.FULLANDSCALE_NO_COLLAPSE_RIGHT=218]="FULLANDSCALE_NO_COLLAPSE_RIGHT"}(i||(i={}))},3762:function(t,e,n){"use strict";var r;n.d(e,{o:function(){return r}}),function(t){t[t.RESET_STATE=0]="RESET_STATE",t[t.UPDATE_STATE=1]="UPDATE_STATE"}(r||(r={}))},41105:function(){}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/5356.0996869f4e49dc3b6c95.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=5356.0996869f4e49dc3b6c95.js.map