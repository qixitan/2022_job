self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[514],{22735:function(e,t,r){r.d(t,{Z:function(){return hi}});var i=r(13504),n=(r(53248),r(38934),r(63240),r(85952)),o=(r(44904),r(41031),r(8195),r(11989)),a=r(71699),s=r(29843),l=r(76138),c=r(81300),h=r(85130),d=r(85624),u=r(7872),f=r(56584),g=r(57356),_=r(52904),p=r(77466),v=r(5004),w=function(){function e(e,t,r,i){this.content="",this.style=g.Z.newInstance({background:v.Z.newInstanceByHex("#ffcccc"),horizontalAlign:_.Z.newInstance(p.Z.LEFT),verticalAlign:f.OC,wrapStrategy:f.mK}),this.innerHTML=null,this._padding=f.J9,null!==e&&i&&(this.content=(0,s.nv)(e,!0),this.style=g.Z.newInstance({background:(0,s.z1)(e,i),horizontalAlign:this.style.horizontalAlign,verticalAlign:(0,s.YW)(e),wrapStrategy:(0,s.fs)(e)}),e.getMergeReference()&&(this.mergeData=(0,s.fl)(e,t,r),this.mergeParent=(0,s.PF)(e,t,r)))}e.defaultCellView=function(){return new e(null,-1,-1)};var t=e.prototype;return t.isEmpty=function(){return!this.content.length},t.isAutoWrap=function(){return"normal"===this.style.wrapStrategy.value},(0,n.Z)(e,[{key:"paddingLeft",get:function(){return this._padding.left},set:function(e){this._padding=u.Z.newInstance(this._padding.top,this._padding.right,this._padding.bottom,e)}},{key:"paddingRight",get:function(){return this._padding.right},set:function(e){this._padding=u.Z.newInstance(this._padding.top,e,this._padding.bottom,this._padding.left)}},{key:"paddingTop",get:function(){return this._padding.top}},{key:"paddingBottom",get:function(){return this._padding.bottom},set:function(e){this._padding=u.Z.newInstance(this._padding.top,this._padding.right,e,this._padding.left)}}]),e}(),R=w,C=r(24644),y=r(74140),m=r(38639),E=r(23075),S=function(e){function t(t){var r;return(r=e.call(this)||this).tableCellViews={},r._cellViews=[],r.cellDataToCellView=function(e,t,i,n,o,a){for(var s=o||r._spreadsheet.activeSheetId,l=e;l<=t;l++)for(var c=i;c<=n;c++)r.setCellViewAtPosition(l,c,s,a)},r.addRow=function(e){var t=e.index,i=e.amount,n=e.sheetId,a=r.getTargetSheet(n);if(a)for(var s=a.getColCount(),l=0;l<i;l++){var c=new Array(s);c.fill(o.O),r.tableCellViews[n].splice(t,0,c)}},r.addCol=function(e){var t=e.index,i=e.amount,n=e.sheetId,a=r.getTargetSheet(n);if(a)for(var s=a.getRowCount(),l=0;l<s;l++){var c,h=new Array(i);h.fill(o.O),(c=r.tableCellViews[n][l]).splice.apply(c,[t,0].concat(h))}},r.deleteRow=function(e){var t=e.index,i=e.amount,n=e.sheetId,o=r.getTargetSheet(n);if(o){for(var s=o.getColCount(),l=0;l<s;l++)for(var c=0;c<i;c++){var h=t+c,d=r.tableCellViews[n][h][l];if(d.mergeParent){var u=r.tableCellViews[n][h+d.mergeParent.y][l];(0,a.u_)(u)}}r.tableCellViews[n].splice(t,i)}},r.deleteCol=function(e){var t=e.index,i=e.amount,n=e.sheetId,o=r.getTargetSheet(n);if(o)for(var s=o.getRowCount(),l=0;l<s;l++){for(var c=0;c<i;c++){var h=t+c,d=r.tableCellViews[n][l][h];if(d.mergeParent){var u=r.tableCellViews[n][l][h+d.mergeParent.x];(0,a.$x)(u)}}r.tableCellViews[n][l].splice(t,i)}},r._spreadsheet=t.spreadsheet,r._dataCallView=t.dataCallView,r._register(r._dataCallView.onInsertRow(r.addRow)),r._register(r._dataCallView.onInsertCol(r.addCol)),r._register(r._dataCallView.onDeleteRow(r.deleteRow)),r._register(r._dataCallView.onDeleteCol(r.deleteCol)),r._register(r._dataCallView.onUpdateCells((function(e){r.cellDataToCellView(e.startRow,e.endRow,e.startCol,e.endCol,e.sheetId,null===e||void 0===e?void 0:e.showCellFormual)}))),r.init(r._spreadsheet.activeSheetId),r}(0,i.Z)(t,e);var l=t.prototype;return l.init=function(e){this.tableCellViews[e]=[];var t=this.getTargetSheet(e);if(t){var i=t.getRowCount()-1,n=t.highWaterMark.getMark(),a=t.getColCount()-1;r.g.log.info("TableView init, endRow:"+n+" endCol:"+a),this.cellDataToCellView(0,n,0,a,e);for(var s=n+1;s<=i;s++)for(var l=0;l<=a;l++)this.tableCellViews[e][s]||(this.tableCellViews[e][s]=[]),this.tableCellViews[e][s][l]=o.O}},l.refresh=function(e){!e||this.tableCellViews[e]&&0!==this.tableCellViews[e].length||this.init(e)},l.calculateRange=function(e,t,r){var i=0,n=this._spreadsheet.activeSheet.getColCount()-1;r&&(i=r[0],n=r[1]),this.cellDataToCellView(e,t,i,n,this._spreadsheet.activeSheetId)},l.setCellViewAtPosition=function(e,t,r,i){this.tableCellViews[r]||(this.tableCellViews[r]=[]),this.tableCellViews[r][e]||(this.tableCellViews[r][e]=[]),this.tableCellViews[r].length<=e&&(this.tableCellViews[r][e]=[]);var n=this.getTargetSheet(r);if(n){var a,s=n.getCellDataAtPosition(e,t);if(s){a=i&&s.getFormula()?new R(s,e,t,this._spreadsheet):new o.Z(s,e,t,this._spreadsheet);var l=this._calcPadding(e,t,r,s),c=l.paddingLeft,h=l.paddingRight;a.paddingLeft=c,a.paddingRight=h}else a=o.O;this.tableCellViews[r][e][t]=a}},l.getCellViewAtPosition=function(e,t,r){var i=r||this._spreadsheet.activeSheetId;return this.tableCellViews[i]||(this.tableCellViews[i]=[]),this.tableCellViews[i][e]||(this.tableCellViews[i][e]=[]),e>=this.tableCellViews[i].length||e<0||t>=this.tableCellViews[i][e].length||t<0?null:this.tableCellViews[i][e][t]||null},l.getSelectQueue=function(){var e=this._spreadsheet.parent.view.getSelection().selectQueue;return e&&e.length>0?e:null},l.getCellMetadata=function(e,t){var r;return(null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getMetadata())||null},l.getCellImage=function(e,t){return this._spreadsheet.activeSheet.getCellImage(e,t)},l.getIsDataValid=function(e,t){var r,i;return null===(i=null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getIsDataValid())||void 0===i||i},l.getDataBar=function(e,t){var r;return(null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getDataBar())||null},l.getCellHyperlinkType=function(e,t){var r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t);return(null===r||void 0===r?void 0:r.getLinkIconStatus())===C.Z.PLAIN_TEXT?null:(null===r||void 0===r?void 0:r.getHyperlinkRuns())?c.HYPERLINK_TYPE.SHEET_LINK:(null===r||void 0===r?void 0:r.getHyperlinkType())||null},l.getCellHyperlink=function(e,t){var r;return(null===(r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t))||void 0===r?void 0:r.getHyperlink())||null},l.getIsCellPrivate=function(e,t){return(0,h.xy)(this._spreadsheet,e,t)},l.getWeworkCardIcon=function(e,t){var r=this._spreadsheet.activeSheet.getCellDataAtPosition(e,t),i=null===r||void 0===r?void 0:r.getCellType(),n=null===r||void 0===r?void 0:r.getWeworkComponent();return i===y.ZP.STAFF_CARD&&n||i===y.ZP.GROUP_CARD&&n?n.iconUrl||null:i===y.ZP.THIRD_PARTY_APP&&n&&n.iconUrl||null},l.getTodoRange=function(e,t){return this._spreadsheet.activeSheet.todoManager.getTodoRange(e,t)},l.getIsCellCanNotRead=function(e,t){return(0,d.tE)(this._spreadsheet.parent,e,t)},l.getFilterHeaderIcon=function(e,t){return(0,a.EL)(this._spreadsheet.activeSheet,e,t)?(0,E.pv)(this._spreadsheet.activeSheet,e,t):(0,a.eN)(this._spreadsheet.activeSheet,e,t)?(0,m.fC)(this._spreadsheet.activeSheet,e,t):null},l.getPivotTableCollapseIcon=function(e,t){var r=this._spreadsheet.activeSheet.getPrimaryCellDataAtPosition(e,t);return(0,a.oC)(r)?(0,m.JY)(this._spreadsheet.activeSheet,e,t):null},l._calcPadding=function(e,t,r,i){var n=this.getTargetSheet(r);if(!n)return{paddingLeft:0,paddingRight:0};var o=(0,s.jl)(n,e,t,i);return{paddingLeft:o.paddingLeft,paddingRight:o.paddingRight}},l.getTargetSheet=function(e){var t=this._spreadsheet.sheetManager.getSheetBySheetId(e);return t||(r.g.log.error("TableView getTargetSheet: sheetId is invalid"),null)},(0,n.Z)(t,[{key:"cellViews",get:function(){var e=this._spreadsheet.activeSheetId;return this.tableCellViews[e]||(this.tableCellViews[e]=[]),this.tableCellViews[e]}}]),t}(l.JT),D=S,A=r(28280);function x(e,t,i){var n=e*r.g.devicePixelRatio,o=t-i,a=Math.abs(o),s=Math.ceil(a*n)/n;return o>0?i+s:i-s}function T(e){for(var t=e.length-1;t>0;t--)if(e[t-1]<e[t])return t-1;return t}var I,b=r(13423);function O(e,t,r,i){var n=r.row.frozen.viewSize,o=r.row.flow.viewSize,a=r.col.frozen.viewSize,s=r.col.flow.viewSize;return[i.rowHeadWidth+(t===I.FROZEN?0:a),i.colHeadHeight+(e===I.FROZEN?0:n),t===I.FROZEN?a:s,e===I.FROZEN?n:o]}function L(e){if(function(e){return e%1===0}(e))return e;var t=Math.floor(e),r=e-t,i=Math.floor(100*r);return i<=20?t:i>=70?t+1:t+.5}r(29816),r(62883),function(e){e[e.FROZEN=0]="FROZEN",e[e.FLOW=1]="FLOW"}(I||(I={})),r(46396);var H=r(58926),z=function(e){this.api=e},M=r(54253),B=r(77851);function P(e,t,r,i,n,o,a){var s,l,c=r?t:e,h=r?e:t,d=i.getDiagBorderStyle(o,n,!0),u=i.getDiagBorderStyle(o,n,!1),f=i.getDiagBorderStyle(o+1,n,!0),g=i.getDiagBorderStyle(o+1,n,!1);return r?(s=i.getVerticalBorderStyle(n-1,o-1),l=i.getVerticalBorderStyle(n-1,o)):(s=i.getVerticalBorderStyle(n-1,o),l=i.getVerticalBorderStyle(n-1,o+1)),function(e,t,r,i,n,o,a,s){s||((e&&r===B.j2.DOUBLE||!e&&t===B.j2.DOUBLE)&&(o.x+=2),(e&&i===B.j2.DOUBLE||!e&&n===B.j2.DOUBLE)&&(a.x+=2))}(r,d,u,f,g,c,h,a),s===B.j2.DOUBLE&&l===B.j2.DOUBLE?(c.x+=1,h.x+=1):s===B.j2.DOUBLE||l===B.j2.DOUBLE?function(e,t,r,i,n){t!==B.j2.DOUBLE&&r===B.j2.DOUBLE?e?(i.x+=1,n.x-=1):(i.x-=1,n.x+=1):t===B.j2.DOUBLE&&r!==B.j2.DOUBLE&&(e?(i.x-=1,n.x+=1):(i.x+=1,n.x-=1))}(r,s,l,c,h):s===B.j2.NONE&&l===B.j2.NONE||(c.x+=1,h.x+=1),{innerLineStartPoint:c,outerLineStartPoint:h}}function N(e,t,r,i,n,o,a){var s,l,c=r?t:e,h=r?e:t,d=i.getDiagBorderStyle(o,n,!0),u=i.getDiagBorderStyle(o,n,!1),f=i.getDiagBorderStyle(o+1,n,!0),g=i.getDiagBorderStyle(o+1,n,!1);return r?(s=i.getVerticalBorderStyle(n,o-1),l=i.getVerticalBorderStyle(n,o)):(s=i.getVerticalBorderStyle(n,o),l=i.getVerticalBorderStyle(n,o+1)),function(e,t,r,i,n,o,a,s){s||((e&&t===B.j2.DOUBLE||!e&&r===B.j2.DOUBLE)&&(o.x-=2),(e&&n===B.j2.DOUBLE||!e&&i===B.j2.DOUBLE)&&(a.x-=2))}(r,d,u,f,g,c,h,a),s===B.j2.DOUBLE&&l===B.j2.DOUBLE?(c.x-=1,h.x-=1):s!==B.j2.DOUBLE&&l!==B.j2.DOUBLE||function(e,t,r,i,n){t!==B.j2.DOUBLE&&r===B.j2.DOUBLE?e?(i.x-=1,n.x+=1):(i.x+=1,n.x-=1):t===B.j2.DOUBLE&&r!==B.j2.DOUBLE&&(e?(i.x+=1,n.x-=1):(i.x-=1,n.x+=1))}(r,s,l,c,h),{innerLineEndPoint:c,outerLineEndPoint:h}}function V(e,t,r,i,n,o,a,s,l){s+=1;var c=function(e,t,r,i,n,o){var a,s,l,c={x:e,y:t};r?(a=i.getHorizontalBorderStyle(o-1,n-1),s=i.getVerticalBorderStyle(n-1,o-1),l=i.getVerticalBorderStyle(n-1,o)):(a=i.getHorizontalBorderStyle(o,n-1),s=i.getVerticalBorderStyle(n-1,o),l=i.getVerticalBorderStyle(n-1,o+1));var h=0;return a===B.j2.DOUBLE&&(h+=1),s===B.j2.DOUBLE&&(h+=1),l===B.j2.DOUBLE&&(h+=1),s!==B.j2.DOUBLE&&l!==B.j2.DOUBLE||1!==h?h>1&&(c.x+=1):c.x-=1,c}(i-=.5,n,t,r,o,a),h=function(e,t,r,i,n,o){var a,s,l,c={x:e,y:t};r?(a=i.getHorizontalBorderStyle(o-1,n+1),s=i.getVerticalBorderStyle(n,o-1),l=i.getVerticalBorderStyle(n,o)):(a=i.getHorizontalBorderStyle(o,n+1),s=i.getVerticalBorderStyle(n,o),l=i.getVerticalBorderStyle(n,o+1));var h=0;return a===B.j2.DOUBLE&&(h+=1),s===B.j2.DOUBLE&&(h+=1),l===B.j2.DOUBLE&&(h+=1),s!==B.j2.DOUBLE&&l!==B.j2.DOUBLE||1!==h?h>1&&(c.x-=1):c.x+=1,c}(i+s,n,t,r,o,a);e.lineCollector.collect({lineProp:l,line:[c.x,c.y,h.x,h.y]})}function F(e,t,r,i,n,o,a){var s,l,c=r?t:e,h=r?e:t,d=i.getDiagBorderStyle(o,n,!0),u=i.getDiagBorderStyle(o,n,!1),f=i.getDiagBorderStyle(o,n-1,!0),g=i.getDiagBorderStyle(o,n+1,!1);return r?(s=i.getHorizontalBorderStyle(o-1,n-1),l=i.getHorizontalBorderStyle(o-1,n)):(s=i.getHorizontalBorderStyle(o-1,n),l=i.getHorizontalBorderStyle(o-1,n+1)),function(e,t,r,i,n,o,a,s){s||((e&&r===B.j2.DOUBLE||!e&&t===B.j2.DOUBLE)&&(o.y+=3),(e&&i===B.j2.DOUBLE||!e&&n===B.j2.DOUBLE)&&(a.y+=3))}(r,d,u,f,g,c,h,a),s===B.j2.DOUBLE&&l===B.j2.DOUBLE?(c.y+=1,h.y+=1):s!==B.j2.DOUBLE&&l!==B.j2.DOUBLE||function(e,t,r,i,n){t!==B.j2.DOUBLE&&r===B.j2.DOUBLE?e?(i.y+=1,n.y-=1):(i.y-=1,n.y+=1):t===B.j2.DOUBLE&&r!==B.j2.DOUBLE&&(e?(i.y-=1,n.y+=1):(i.y+=1,n.y-=1))}(r,s,l,c,h),{innerLineStartPoint:c,outerLineStartPoint:h}}function Z(e,t,r,i,n,o,a){var s,l,c=r?t:e,h=r?e:t,d=i.getDiagBorderStyle(o,n,!0),u=i.getDiagBorderStyle(o,n,!1),f=i.getDiagBorderStyle(o,n-1,!1),g=i.getDiagBorderStyle(o,n+1,!0);return r?(s=i.getHorizontalBorderStyle(o,n-1),l=i.getHorizontalBorderStyle(o,n)):(s=i.getHorizontalBorderStyle(o,n),l=i.getHorizontalBorderStyle(o,n+1)),function(e,t,r,i,n,o,a,s){s||((e&&t===B.j2.DOUBLE||!e&&r===B.j2.DOUBLE)&&(o.y-=3),(e&&i===B.j2.DOUBLE||!e&&n===B.j2.DOUBLE)&&(a.y-=3))}(r,d,u,f,g,c,h,a),s===B.j2.DOUBLE&&l===B.j2.DOUBLE?(c.y-=1,h.y-=1):s===B.j2.DOUBLE&&l===B.j2.DOUBLE?function(e,t,r,i,n){t!==B.j2.DOUBLE&&r===B.j2.DOUBLE?e?(i.y-=1,n.y+=1):(i.y+=1,n.y-=1):t===B.j2.DOUBLE&&r!==B.j2.DOUBLE&&(e?(i.y+=1,n.y-=1):(i.y-=1,n.y+=1))}(r,s,l,c,h):s===B.j2.NONE&&l===B.j2.NONE||(c.y-=1,h.y-=1),{innerLineEndPoint:c,outerLineEndPoint:h}}function k(e,t,r,i,n,o,a,s,l){s+=1;var c=function(e,t,r,i,n,o){var a,s,l,c={x:e,y:t};r?(a=i.getVerticalBorderStyle(n-1,o-1),s=i.getHorizontalBorderStyle(o-1,n-1),l=i.getHorizontalBorderStyle(o-1,n)):(a=i.getVerticalBorderStyle(n,o-1),s=i.getHorizontalBorderStyle(o-1,n),l=i.getHorizontalBorderStyle(o-1,n+1));var h=0;return a===B.j2.DOUBLE&&(h+=1),s===B.j2.DOUBLE&&(h+=1),l===B.j2.DOUBLE&&(h+=1),s!==B.j2.DOUBLE&&l!==B.j2.DOUBLE||1!==h?h>1&&(c.y+=1):c.y-=1,c}(i,n-=.5,t,r,o,a),h=function(e,t,r,i,n,o){var a,s,l,c={x:e,y:t};r?(a=i.getVerticalBorderStyle(n-1,o+1),s=i.getHorizontalBorderStyle(o,n-1),l=i.getHorizontalBorderStyle(o,n)):(a=i.getVerticalBorderStyle(n,o+1),s=i.getHorizontalBorderStyle(o,n),l=i.getHorizontalBorderStyle(o,n+1));var h=0;return a===B.j2.DOUBLE&&(h+=1),s===B.j2.DOUBLE&&(h+=1),l===B.j2.DOUBLE&&(h+=1),s!==B.j2.DOUBLE&&l!==B.j2.DOUBLE||1!==h?h>1&&(c.y-=1):c.y+=1,c}(i,n+s,t,r,o,a);e.lineCollector.collect({lineProp:l,line:[c.x,c.y,h.x,h.y]})}function U(e,t,r,i,n,o,a,s,l,c){var h=t?{x:i+s,y:n}:{x:i+s,y:n+l},d=function(e,t,r,i,n){var o,a=e.x,s=e.y;return t?(o=r.getVerticalBorderStyle(n,i-1),r.getHorizontalBorderStyle(i,n)===B.j2.DOUBLE&&(s-=1),o===B.j2.DOUBLE&&(a+=1)):(o=r.getVerticalBorderStyle(n,i-1),r.getHorizontalBorderStyle(i,n-1)===B.j2.DOUBLE&&(s+=1),o===B.j2.DOUBLE&&(a+=1)),{x:a,y:s}}(t?{x:i,y:n+l}:{x:i,y:n},t,r,o,a),u=function(e,t,r,i,n){var o,a=e.x,s=e.y;return t?(o=r.getVerticalBorderStyle(n,i),r.getHorizontalBorderStyle(i,n-1)===B.j2.DOUBLE&&(s+=1),o===B.j2.DOUBLE&&(a-=1)):(o=r.getVerticalBorderStyle(n,i),r.getHorizontalBorderStyle(i,n)===B.j2.DOUBLE&&(s-=1),o===B.j2.DOUBLE&&(a-=1)),{x:a,y:s}}(h,t,r,o,a);e.lineCollector.collect({lineProp:c,line:[d.x,d.y,u.x,u.y]})}function W(e,t,r,i,n,o,a,s,l,c,h){var d=t?{x:i+s-2,y:n}:{x:i+s,y:n+l-2},u=t?{x:i+s,y:n+2}:{x:i+s-2,y:n+l},f=function(e,t,r,i,n,o){var a,s={x:e.x,y:e.y},l={x:t.x,y:t.y};return r?(a=i.getVerticalBorderStyle(n-1,o),i.getHorizontalBorderStyle(o,n)===B.j2.DOUBLE&&(l.x+=1.5,l.y-=1),a===B.j2.DOUBLE&&(s.x+=1,s.y-=1)):(a=i.getVerticalBorderStyle(n-1,o),i.getHorizontalBorderStyle(o-1,n)===B.j2.DOUBLE&&(s.x+=1.5,s.y+=1),a===B.j2.DOUBLE&&(l.x+=1,l.y+=1)),{upperStartPoint:s,lowerStartPoint:l}}(t?{x:i,y:n+l-2}:{x:i+2,y:n},t?{x:i+2,y:n+l}:{x:i,y:n+2},t,r,o,a),g=f.upperStartPoint,_=f.lowerStartPoint,p=function(e,t,r,i,n,o){var a,s={x:e.x,y:e.y},l={x:t.x,y:t.y};return r?(a=i.getVerticalBorderStyle(n,o),i.getHorizontalBorderStyle(o-1,n)===B.j2.DOUBLE&&(s.x-=1.5,s.y+=1),a===B.j2.DOUBLE&&(l.x-=1,l.y+=1)):(a=i.getVerticalBorderStyle(n,o),i.getHorizontalBorderStyle(o,n)===B.j2.DOUBLE&&(l.x-=1.5,l.y-=1),a===B.j2.DOUBLE&&(s.x-=1,s.y-=1)),{upperEndPoint:s,lowerEndPoint:l}}(d,u,t,r,o,a),v=p.upperEndPoint,w=p.lowerEndPoint;if(h){var R={x:(g.x+v.x)/2-1.5,y:t?(v.y+g.y)/2+1:(v.y+g.y)/2-1},C={x:(g.x+v.x)/2+1.5,y:t?(v.y+g.y)/2-1:(v.y+g.y)/2+1},y={x:(_.x+w.x)/2-1.5,y:t?(_.y+w.y)/2+1:(w.y+_.y)/2-1},m={x:(_.x+w.x)/2+1.5,y:t?(w.y+_.y)/2-1:(w.y+_.y)/2+1};e.lineCollector.collect({lineProp:c,line:[g.x,g.y,R.x,R.y]}),e.lineCollector.collect({lineProp:c,line:[C.x,C.y,v.x,v.y]}),e.lineCollector.collect({lineProp:c,line:[_.x,_.y,y.x,y.y]}),e.lineCollector.collect({lineProp:c,line:[m.x,m.y,w.x,w.y]})}else e.lineCollector.collect({lineProp:c,line:[g.x,g.y,v.x,v.y]}),e.lineCollector.collect({lineProp:c,line:[_.x,_.y,w.x,w.y]})}function G(e,t,r,i,n,o,a,s,l){s.style===B.j2.DOUBLE?function(e,t,r,i,n,o,a,s,l,c){var h={x:(i-=.5)+(s+=1),y:n-1},d={x:i+s,y:n+1},u=P({x:i,y:n-1},{x:i,y:n+1},t,r,o,a,c),f=u.innerLineStartPoint,g=u.outerLineStartPoint,_=N(h,d,t,r,o,a,c),p=_.innerLineEndPoint,v=_.outerLineEndPoint;e.lineCollector.collect({lineProp:l,line:[f.x,f.y,p.x,p.y]}),e.lineCollector.collect({lineProp:l,line:[g.x,g.y,v.x,v.y]})}(e,!1,t,r,i,n,o,a,s,l):V(e,!1,t,r,i,n,o,a,s)}function j(e,t,r,i,n,o,a,s,l){s.style===B.j2.DOUBLE?function(e,t,r,i,n,o,a,s,l,c){var h={x:i-1,y:(n-=.5)+(s+=1)},d={x:i+1,y:n+s},u=F({x:i-1,y:n},{x:i+1,y:n},t,r,o,a,c),f=u.innerLineStartPoint,g=u.outerLineStartPoint,_=Z(h,d,t,r,o,a,c),p=_.innerLineEndPoint,v=_.outerLineEndPoint;e.lineCollector.collect({lineProp:l,line:[f.x,f.y,p.x,p.y]}),e.lineCollector.collect({lineProp:l,line:[g.x,g.y,v.x,v.y]})}(e,!1,t,r,i,n,o,a,s,l):k(e,!1,t,r,i,n,o,a,s)}var Y=r(53140),X=function(){function e(e,t,r){this._renderedMergeCells=[],this._renderedCoverCells=[],this._table=e,this._onAfterCellRender=t,this.spreadsheet=r}var t=e.prototype;return t.collect=function(e,t,r,i,n,o){this._table.ctx.textBaseline="alphabetic",this._table.ctx.textAlign="left",this._renderedMergeCells=[],this._renderedCoverCells=[];var a,s,l=this._table.api.rowHeadWidth+o,c=this._table.api.colHeadHeight+n,h=l,d=c;for(this._table.api.refreshFilterVisibleBorderRange(),a=e;a<=t;a++)if(h=l,!this._table.api.isRowHidden(a)){for(s=r;s<=i;s++)this._table.api.isColHidden(s)||(this._collectCell(h,d,a,s),h+=this._table.api.getColWidth(s));d+=this._table.api.getRowHeight(a)}return[l,c,h-l,d-c]},t.clearRect=function(e){var t;(t=this._table.ctx).clearRect.apply(t,(0,H.Z)(e))},t._collectCell=function(e,t,r,i){var n=this._table.api.getCellDataAtPosition(r,i),o=this._table.api.getColWidth(i),a=this._table.api.getRowHeight(r),s=this._table.api.getCellBackgroundWidth(r,i),l=this._table.api.getCellBackgroundHeight(r,i);if(n.mergeData){if(this._hasRenderedMergeCell(r,i))return;this._addRenderedMergeCell(r,i)}else{if(n.mergeParent)return void this._renderMergeCellViceCell(e,t,r,i,n.mergeParent);if(n.coverParents)return this._renderBackground(n,e,t,s,l),this.renderBorder(r,i,n,e,t,o,a,!0,!0),this._renderHiddenCell(e,t,r,i,n.coverParents),void this._onAfterCellRender.fire({row:r,col:i,x:e,y:t});if(n.isCover){if(this._hasRenderedCoverCell(r,i))return;this._addRenderedCoverCell(r,i)}}(0,B.WQ)(n)||this._renderText(r,i,n,e,t,s,l),(0,B.mY)(n)||this._renderBackground(n,e,t,s,l),n.mergeData?this.renderMergeCellBorder(e,t,r,i,n.mergeData):this.renderBorder(r,i,n,e,t,o,a,!0,!0),this._onAfterCellRender.fire({row:r,col:i,x:e,y:t})},t._hasRenderedMergeCell=function(e,t){return this._renderedMergeCells.indexOf(e+":"+t)>=0},t._addRenderedMergeCell=function(e,t){this._renderedMergeCells.push(e+":"+t)},t._hasRenderedCoverCell=function(e,t){return this._renderedCoverCells.indexOf(e+":"+t)>=0},t._addRenderedCoverCell=function(e,t){this._renderedCoverCells.push(e+":"+t)},t._renderMergeCellViceCell=function(e,t,r,i,n){var o=r+n.y,a=i+n.x;if(!this._hasRenderedMergeCell(o,a)){for(var s=e,l=t,c=r-1;c>=o;c--)this._table.api.isRowHidden(c)||(l-=this._table.api.getRowHeight(c));for(var h=i-1;h>=a;h--)this._table.api.isColHidden(h)||(s-=this._table.api.getColWidth(h));this._collectCell(s,l,o,a),this._addRenderedMergeCell(o,a)}},t._renderHiddenCell=function(e,t,r,i,n){for(var o=0;o<n.length;o++){var a=n[o];if(this._hasRenderedCoverCell(a.rowIndex,a.colIndex))break;if(this._table.api.isColHidden(a.colIndex))return;var s=e;if(i<a.colIndex)for(var l=i;l<a.colIndex;l++)s+=this._table.api.getColWidth(l);else for(var c=i-1;c>=a.colIndex;c--)s-=this._table.api.getColWidth(c);this._collectCell(s,t,a.rowIndex,a.colIndex),this._addRenderedCoverCell(a.rowIndex,a.colIndex)}},t.renderMergeCellBorder=function(e,t,r,i,n){var o,a,s,l=e,c=t,h=this._table.api.getRowHeight(r),d=this._table.api.getColWidth(i);for(s=r;s<r+n.rowCount;s++)if(!this._table.api.isRowHidden(s)){for(d=this._table.api.getRowHeight(s),l=e,a=i;a<i+n.colCount;a++)this._table.api.isColHidden(a)||(h=this._table.api.getColWidth(a),r<s&&s<r+n.rowCount-1&&a!==i&&a!==i+n.colCount-1||(o=this._table.api.getCellDataAtPosition(s,a),this.renderBorder(s,a,o,l,c,h,d,!1,!0)),l+=h);c+=d}},t.renderBorder=function(e,t,r,i,n,o,a,s,l){var c,h,d,u,f,g;(null===(c=r.borderRight)||void 0===c?void 0:c.style)&&j(this._table.collectEngine,this._table.api,i+o,n,t,e,a,r.borderRight,l),(null===(h=r.borderBottom)||void 0===h?void 0:h.style)&&G(this._table.collectEngine,this._table.api,i,n+a,t,e,o,r.borderBottom,l),s&&(null===(d=r.borderDiagDown)||void 0===d?void 0:d.style)&&function(e,t,r,i,n,o,a,s,l,c){l.style===B.j2.DOUBLE?W(e,!1,t,r,i,n,o,a,s,l,c):U(e,!1,t,r,i,n,o,a,s,l)}(this._table.collectEngine,this._table.api,i,n,t,e,o,a,r.borderDiagDown,(null===(u=r.borderDiagUp)||void 0===u?void 0:u.style)===B.j2.DOUBLE),s&&(null===(f=r.borderDiagUp)||void 0===f?void 0:f.style)&&function(e,t,r,i,n,o,a,s,l,c){l.style===B.j2.DOUBLE?W(e,!0,t,r,i,n,o,a,s,l,c):U(e,!0,t,r,i,n,o,a,s,l)}(this._table.collectEngine,this._table.api,i,n,t,e,o,a,r.borderDiagUp,(null===(g=r.borderDiagDown)||void 0===g?void 0:g.style)===B.j2.DOUBLE)},t._renderBackground=function(e,t,r,i,n){this._table.collectEngine.graphicsCollector.collect({color:e.background.hex,graphicsInfo:{path:[t,r,t+i,r,t+i,r+n,t,r+n]}})},t._renderText=function(e,t,r,i,n,o,a){var s=r.lines;if(s&&s.length)for(var l=this._table.api.getClipInfo(e,t,i,n,o,a),c=0;c<s.length;c++){var h=s[c],d=i+h.offsetX,u=n+h.offsetY;if(!(u-3*h.height/4>>0<n+a))break;for(var f=0;f<h.segments.length;f++){var g=h.segments[f],_=g.size.width;if(g.customRender)g.customRender(r,d,u,l,this._table.collectEngine);else{var p={pos:[d,u],text:g.text};l&&(p.clipInfo=l);var v=g.size.height,w=(0,Y.d)(r,g.textProp,this.spreadsheet),R=w.hash,C=w.underline;if(w.strikethrough&&g.textProp[M.M.STRIKETHROUGH]){var y=Math.round(v/4);p.strikethroughInfo=[d,u-y,d+_,u-y]}C&&g.textProp[M.M.UNDERLINE]&&(p.underlineInfo=[d,u+2,d+_,u+2]),this._table.collectEngine.textCollector.collect({textInfo:p,textPropHash:R})}d+=_}}},e}(),K=X,J=r(55789),Q=r(99997),$=r(60973),q=function(){function e(e,t,r){this._temp=[0,0,0,0],this._endX=0,this._afterColHeadRenderData={col:0,x:0},this._table=e,this._onAfterColRender=t,this.spreadsheet=r}var t=e.prototype;return t.collect=function(e,t,r){var i=this._table.api.rowHeadWidth+r;this._collectColHead(e,t,i),this._table.ctx.clearRect(Math.max(0,i),0,this._endX-Math.max(0,i),this._table.api.colHeadHeight)},t._setTemp=function(e,t,r,i){this._temp[0]=e,this._temp[1]=t,this._temp[2]=r,this._temp[3]=i},t._collectColHead=function(e,t,r){var i,n,o=this._table.api.colHeadHeight;for(this._setTemp(0,0,this._table.width,0),this._table.collectEngine.lineCollector.collect({lineProp:J.Z.LINE,line:this._temp}),i=e;i<=t;i++)if(!this._table.api.isColHidden(i)){if(this._afterColHeadRenderData.col=i,this._afterColHeadRenderData.x=r,(n=this._table.api.getColMeta(i)).borderLeft&&(this._setTemp(r,0,r,o),this._table.collectEngine.lineCollector.collect({lineProp:n.borderLeft,line:this._temp})),n.borderBottom){var a=n.fitLineExpand||0;this._setTemp(r-a,o-n.borderBottom.width+1,r+n.width+a,o-n.borderBottom.width+1),this._table.collectEngine.lineCollector.collect({lineProp:n.borderBottom,line:this._temp})}this._setTemp(r,0,n.width,o),this._table.collectEngine.graphicsCollector.collect({color:n.background.hex,graphicsInfo:{path:[r,0,r+n.width,0,r+n.width,o,r,o]}}),this._table.collectEngine.textCollector.collect({textPropHash:Q.Z.newInstance({fontFamily:$.em,fontSize:J.Z.DIMENSION_FONT_SIZE,color:v.Z.newInstanceByHex(n.color.hex)},this.spreadsheet).hash,textInfo:{text:this._table.api.getColContent(i),pos:[r+n.width/2,o/2]}}),r+=n.width,n.borderRight&&(this._setTemp(r,0,r,o),this._table.collectEngine.lineCollector.collect({lineProp:n.borderRight,line:this._temp})),this._onAfterColRender.fire(this._afterColHeadRenderData)}this._endX=r,this._setTemp(0,o,this._endX,o),this._table.collectEngine.lineCollector.collect({lineProp:J.Z.LINE,line:this._temp})},e}(),ee=q,te=function(){function e(e,t,r){this._temp=[0,0,0,0],this._endY=0,this._afterRowHeadRenderData={row:0,y:0},this._table=e,this._onAfterRowRender=t,this.spreadsheet=r}var t=e.prototype;return t.collect=function(e,t,r){var i=this._table.api.colHeadHeight+r;this._collectRowHead(e,t,i),this._table.ctx.clearRect(0,Math.max(0,i),this._table.api.rowHeadWidth,this._endY-Math.max(0,i))},t._setTemp=function(e,t,r,i){this._temp[0]=e,this._temp[1]=t,this._temp[2]=r,this._temp[3]=i},t._collectRowHead=function(e,t,r){var i,n,o=this._table.api.rowHeadWidth;for(this._setTemp(0,0,0,this._table.height),this._table.collectEngine.lineCollector.collect({lineProp:J.Z.LINE,line:this._temp}),i=e;i<=t;i++)if(!this._table.api.isRowHidden(i)){if(this._afterRowHeadRenderData.row=i,this._afterRowHeadRenderData.y=r,(n=this._table.api.getRowMeta(i)).borderTop&&(this._setTemp(0,r,o,r),this._table.collectEngine.lineCollector.collect({lineProp:n.borderTop,line:this._temp})),n.borderRight){var a=n.fitLineExpand||0;this._setTemp(o-n.borderRight.width+1,r-a,o-n.borderRight.width+1,r+n.height+a),this._table.collectEngine.lineCollector.collect({lineProp:n.borderRight,line:this._temp})}this._table.collectEngine.graphicsCollector.collect({color:n.background.hex,graphicsInfo:{path:[0,r,o,r,o,r+n.height,0,r+n.height]}}),this._table.collectEngine.textCollector.collect({textPropHash:Q.Z.newInstance({fontFamily:$.em,fontSize:J.Z.DIMENSION_FONT_SIZE,color:v.Z.newInstanceByHex(n.color.hex)},this.spreadsheet).hash,textInfo:{text:this._table.api.getRowContent(i),pos:[o/2,r+n.height/2]}}),r+=n.height,n.borderBottom&&(this._setTemp(0,r,o,r),this._table.collectEngine.lineCollector.collect({lineProp:n.borderBottom,line:this._temp})),this._onAfterRowRender.fire(this._afterRowHeadRenderData)}this._endY=r,this._setTemp(o,0,o,this._endY),this._table.collectEngine.lineCollector.collect({lineProp:J.Z.LINE,line:this._temp})},e}(),re=te,ie=r(12441),ne=r(1003),oe=function(){function e(e,t){this._temp=[0,0,0,0],this._table=e,this._onAfterCornerRender=t}var t=e.prototype;return t.collect=function(){this._collectBackground(),this._collectLine(),this.collectTriangle(),this._table.ctx.clearRect(0,0,this._table.api.rowHeadWidth,this._table.api.colHeadHeight),this._onAfterCornerRender.fire()},t._setTemp=function(e,t,r,i){this._temp[0]=e,this._temp[1]=t,this._temp[2]=r,this._temp[3]=i},t._collectLine=function(){var e=this._table.api,t=e.colHeadHeight,r=e.rowHeadWidth;this._setTemp(r,0,r,t),this._table.collectEngine.lineCollector.collect({lineProp:J.Z.LINE,line:this._temp}),this._setTemp(r,t,0,t),this._table.collectEngine.lineCollector.collect({lineProp:J.Z.LINE,line:this._temp})},t._collectBackground=function(){var e=this._table.api,t=e.rowHeadWidth,r=e.colHeadHeight;this._table.collectEngine.graphicsCollector.collect({color:ne.Et.hex,graphicsInfo:{path:(0,ie.au)(t,r)}})},t.collectTriangle=function(){var e=this._table.api,t=e.rowHeadWidth,r=e.colHeadHeight,i=(0,ie.ns)(t,r);this._table.collectEngine.graphicsCollector.collect({color:ne.a8.hex,graphicsInfo:{path:i}})},e}(),ae=oe,se=(r(31688),r(71096),r(49502),r(87743)),le=(r(52865),r(64425),r(20670),function(){function e(){}return e.compare=function(t,r){void 0===e._colorLevel[t]&&(e._colorLevel[t]=e._getLevel(t)),void 0===e._colorLevel[r]&&(e._colorLevel[r]=e._getLevel(r));var i=e._colorLevel[t],n=e._colorLevel[r];return i>n?-1:i===n?0:1},e._getLevel=function(e){var t=function(e){e.indexOf("#")>-1&&(e=e.replace("#",""));var t=1;3===e.length?e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]:4===e.length?(t=parseInt(e[3]+e[3],16)/255,e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]):8===e.length&&(t=parseInt(e[6]+e[7],16)/255,e=e.substring(0,6));var r=parseInt(e,16);return{red:r>>16,green:r>>8&255,blue:255&r,alpha:t}}(e);return 299*t.red+587*t.green+114*t.blue},e}());le._colorLevel={};var ce,he=le,de=r(64548),ue=r(3120),fe=r(90980),ge=((ce={})[de.Z.NONE]=0,ce[de.Z.HAIR]=1,ce[de.Z.DASH_DOT]=2,ce[de.Z.DASH_DOT_DOT]=3,ce[de.Z.DOTTED]=4,ce[de.Z.DASHED]=5,ce[de.Z.THIN]=6,ce[de.Z.MEDIUM_DASH_DOT_DOT]=7,ce[de.Z.SLANTED_DASH_DOT]=8,ce[de.Z.MEDIUM_DASH_DOT]=9,ce[de.Z.MEDIUM_DASHED]=10,ce[de.Z.MEDIUM]=11,ce[de.Z.THICK]=12,ce[de.Z.DOUBLE]=13,ce);function _e(e,t){var r;if(!e)return null;var i=[e.getUserEnteredFormat(),null===(r=e.getPivotTableRef())||void 0===r?void 0:r.format];return(0,fe.getMergedFormatValueFromFormats)(i,t)}function pe(e,t,r){if(!t||null===t.style)return 1;if(!e||null===e.style)return-1;var i=function(e,t){return t.style?e.style?ge[e.style]-ge[t.style]:-1:1}(e,t);return 0===i?function(e,t,r){return t?e?(0,ue.compareColorByBrightness)(e.color,t.color,r):-1:1}(e,t,r):i}var ve=function(){function e(e,t,r){this._width=e,this._style=t,this._color=r}e.newInstance=function(t){var r,i=t.split("-"),n=Number(i[0]),o=Number(i[1]),a=i[2];return(r=this._pool.shift())?(r._width=o,r._style=n,r._color=a):r=new e(o,n,a),r},e.destroyInstance=function(e){this._pool.push(e)};var t=e.prototype;return t.getDashSegments=function(){var e;switch(this._style){case B.j2.HAIR:e=[1,1];break;case B.j2.DOTTED:e=[2,2];break;case B.j2.DASH_DOT_DOT:case B.j2.MEDIUM_DASH_DOT_DOT:e=[3,3,3,3,9,3];break;case B.j2.DASH_DOT:case B.j2.MEDIUM_DASH_DOT:case B.j2.SLANTED_DASH_DOT:e=[3,3,9,3];break;case B.j2.DASHED:e=[3,3];break;case B.j2.MEDIUM_DASHED:e=[9,3];break;case B.j2.NONE:case B.j2.THIN:case B.j2.MEDIUM:case B.j2.THICK:case B.j2.DOUBLE:default:e=[]}return e},t.getStyle=function(){return this._style},t.getWidth=function(){var e=B.v.NONE;switch(this._style){case B.j2.THIN:case B.j2.DASH_DOT:case B.j2.DASH_DOT_DOT:case B.j2.DASHED:case B.j2.DOTTED:case B.j2.HAIR:case B.j2.DOUBLE:e=B.v.THIN;break;case B.j2.MEDIUM:case B.j2.MEDIUM_DASHED:case B.j2.MEDIUM_DASH_DOT:case B.j2.MEDIUM_DASH_DOT_DOT:case B.j2.SLANTED_DASH_DOT:e=B.v.MEDIUM;break;case B.j2.THICK:e=B.v.THICK;break;case B.j2.NONE:default:e=B.v.NONE}return e},t.getColor=function(){return this._color},t.compare=function(e){var t=this._compareStylePriority(e);return 0===t?this._compareColorPriority(e):t},t._compareStylePriority=function(e){return ge[this._style]-ge[e._style]},t._compareColorPriority=function(e){return he.compare(this._color,e.getColor())},e}();ve._pool=[];var we=ve,Re=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){this._ctx=t;var r=e.renderInfos,i=Object.keys(r);if(i&&i.length){var n,o;this._ctx.translate(-.5,-.5),i.sort(this._sortFunc);for(var a=0;a<i.length;a++)n=i[a],o=we.newInstance(n),this._prepareRenderContext(o),this._renderLine(r[n]),we.destroyInstance(o);this._ctx.setLineDash([]),this._ctx.translate(.5,.5)}},r._prepareRenderContext=function(e){this._ctx.strokeStyle=e.getColor(),this._ctx.lineWidth=e.getWidth(),this._ctx.setLineDash(e.getDashSegments())},r._renderLine=function(e){this._ctx.beginPath();for(var t=0,r=0;r<e.length;++r){var i=e[r];this._ctx.moveTo(i[0],i[1]);for(var n=2;n<i.length;n+=2)this._ctx.lineTo(i[n],i[n+1]);t>1e3?(t=0,this._ctx.stroke(),this._ctx.beginPath()):t+=1}this._ctx.stroke()},r._sortFunc=function(e,t){var r=we.newInstance(e),i=we.newInstance(t),n=r.compare(i);return we.destroyInstance(r),we.destroyInstance(i),n},t}(se.ZP),Ce=Re,ye=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){this._ctx=t;for(var r,i,n,o=e.renderInfos,a=Object.keys(o),s=0;s<a.length;s++){r=a[s],this._prepareRenderContext(r),i=o[r];for(var l=0;l<i.length;l++)(n=i[l]).clipInfo&&(this._ctx.save(),this._ctx.beginPath(),this._ctx.rect(n.clipInfo[0],n.clipInfo[1],n.clipInfo[2],n.clipInfo[3]),this._ctx.clip()),this._renderText(n),this._renderUnderlineAndStrikethrough(n),n.clipInfo&&this._ctx.restore()}},r._prepareRenderContext=function(e){var t=e.split(Q.L),r=t[0],i=t[1],n=Number(t[2])||0;r&&(this._ctx.font=r),i&&(this._ctx.fillStyle=i,this._ctx.strokeStyle=i),n&&(this._ctx.lineWidth=Math.max(1,n))},r._renderText=function(e){this._ctx.beginPath(),this._ctx.fillText(e.text,e.pos[0],e.pos[1]),this._ctx.closePath()},r._renderUnderlineAndStrikethrough=function(e){e.underlineInfo&&this._renderLine(e.underlineInfo),e.strikethroughInfo&&this._renderLine(e.strikethroughInfo)},r._renderLine=function(e){this._ctx.beginPath(),this._ctx.moveTo(e[0],e[1]),this._ctx.lineTo(e[2],e[3]),this._ctx.stroke()},t}(se.ZP),me=ye,Ee=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){var r=this;this._ctx=t;var i=e.renderInfos;i.canvasPatternInfo.forEach((function(e){r._ctx.fillStyle=e.canvasPattern,r._renderGraphics({path:e.path,clipInfo:e.clipInfo})}));var n=Object.keys(i.colorInfo);if(n&&n.length)for(var o,a,s=0;s<n.length;s++)if(a=n[s],null===(o=i.colorInfo[a])||void 0===o?void 0:o.length){this._ctx.fillStyle=a;for(var l=0;l<o.length;l++)this._renderGraphics(o[l])}},r._renderGraphics=function(e){var t;e.clipInfo&&(this._ctx.save(),this._ctx.beginPath(),(t=this._ctx).rect.apply(t,(0,H.Z)(e.clipInfo)),this._ctx.clip());var r=e.path;this._ctx.beginPath(),this._ctx.moveTo(r[0],r[1]);for(var i=2;i<r.length;i+=2)this._ctx.lineTo(r[i],r[i+1]);this._ctx.closePath(),this._ctx.fill(),e.clipInfo&&this._ctx.restore()},t}(se.ZP),Se=Ee,De=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var n=t.prototype;return n.render=function(e,t){var r=this;this._ctx=t,e.renderInfos.forEach((function(e){return r.renderBitmap(e)}))},n.renderBitmap=function(e){var t,i=e.clipInfo,n=e.sx,o=e.sy,a=e.sWidth,s=e.sHeight,l=e.dWidth,c=e.dHeight,h=e.img,d=e.dx,u=e.dy;if(h&&this._ctx){i&&(this._ctx.save(),this._ctx.beginPath(),this._ctx.rect(i[0],i[1],i[2],i[3]),this._ctx.clip());try{void 0!==n&&void 0!==o&&void 0!==a&&void 0!==s&&void 0!==l&&void 0!==c?this._ctx.drawImage(h,n,o,a,s,d,u,l,c):void 0!==l&&void 0!==c?this._ctx.drawImage(h,d,u,l,c):this._ctx.drawImage(h,d,u)}catch(f){null===(t=r.g.log)||void 0===t||t.info(f)}i&&this._ctx.restore()}},t}(se.ZP),Ae=De,xe=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){this._ctx=t;for(var r=e.renderInfos,i=0;i<r.length;i++){var n=r[i].roundRectProp,o=r[i].roundRectInfo;this._prepareRenderContext(n),this._drawSingleRoundRect(n,o)}},r._prepareRenderContext=function(e){this._ctx.lineWidth=e.borderWidth||1,e.fillColor&&(this._ctx.fillStyle=e.fillColor),e.strokeColor&&(this._ctx.strokeStyle=e.strokeColor)},r._drawSingleRoundRect=function(e,t){var r,i=t.rect,n=t.radius,o=t.clipInfo;o&&(this._ctx.save(),this._ctx.beginPath(),(r=this._ctx).rect.apply(r,(0,H.Z)(o)),this._ctx.clip());var a=[i[0]+n,i[1]],s=[i[0]+i[2],i[1]],l=[i[0]+i[2],i[1]+i[3]],c=[i[0],i[1]+i[3]],h=[i[0],i[1]];this._ctx.beginPath(),this._ctx.moveTo(a[0],a[1]),this._ctx.arcTo(s[0],s[1],l[0],l[1],n),this._ctx.arcTo(l[0],l[1],c[0],c[1],n),this._ctx.arcTo(c[0],c[1],h[0],h[1],n),this._ctx.arcTo(h[0],h[1],a[0],a[1],n),e.strokeColor&&this._ctx.stroke(),e.shadowInfo&&(e.shadowInfo.shadowColor&&(this._ctx.shadowColor=e.shadowInfo.shadowColor),e.shadowInfo.shadowOffsetX&&(this._ctx.shadowOffsetX=e.shadowInfo.shadowOffsetX),e.shadowInfo.shadowOffsetY&&(this._ctx.shadowOffsetY=e.shadowInfo.shadowOffsetY),e.shadowInfo.shadowBlur&&(this._ctx.shadowBlur=e.shadowInfo.shadowBlur),this._ctx.stroke(),this._ctx.shadowColor="",this._ctx.shadowOffsetX=0,this._ctx.shadowOffsetY=0,this._ctx.shadowBlur=0),e.fillColor&&this._ctx.fill(),o&&this._ctx.restore()},t}(se.ZP),Te=xe,Ie=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e);var r=t.prototype;return r.render=function(e,t){var r=this;this._ctx=t;var i=e.renderInfos;Object.keys(i).forEach((function(e){r.renderPath2d(i[e])}))},r.renderPath2d=function(e){var t=this,r=null;e.forEach((function(e){r||(r=new Path2D(e.path2d)),t.beforeFillPath(e),t._ctx.fill(r,e.fillRule||"evenodd"),t.afterFillPath(e)}))},r.beforeFillPath=function(e){var t,r,i,n=e.fillStyle,o=e.translate,a=e.scale,s=e.clipInfo;this._ctx.fillStyle=n,s&&(this._ctx.save(),this._ctx.beginPath(),(t=this._ctx).rect.apply(t,(0,H.Z)(s)),this._ctx.clip()),(o||a)&&this._ctx.save(),o&&(r=this._ctx).translate.apply(r,(0,H.Z)(o)),a&&(i=this._ctx).scale.apply(i,(0,H.Z)(a))},r.afterFillPath=function(e){var t=e.translate,r=e.scale,i=e.clipInfo;(t||r)&&this._ctx.restore(),i&&this._ctx.restore()},t}(se.ZP),be=Ie,Oe=r(58615),Le=r(81433),He=r(64737),ze=r(2990),Me=r(75297),Be=r(89485),Pe=function(){function e(e){this._ctx=e,this._lineRenderer=new Ce,this._textRenderer=new me,this._graphicsRender=new Se,this._bitmapRenderer=new Ae,this._roundRectRenderer=new Te,this._path2dRenderer=new be}return e.prototype.render=function(e,t){var r=this;e.collectors.forEach((function(e){switch(e.constructor){case Oe.Z:r._bitmapRenderer.render(e,t);break;case Le.Z:r._graphicsRender.render(e,t);break;case He.Z:r._lineRenderer.render(e,t);break;case ze.Z:r._textRenderer.render(e,t);break;case Me.Z:r._roundRectRenderer.render(e,t);break;case Be.Z:r._path2dRenderer.render(e,t);break;default:return}}))},e}(),Ne=r(91955),Ve=function(e){function t(t,r,i,n){var o;return(o=e.call(this,r)||this).onAfterAreaRenderEmitter=new A.Q5,o.onAfterCellRenderEmitter=new A.Q5,o.onAfterRowHeadRenderEmitter=new A.Q5,o.onAfterColHeadRenderEmitter=new A.Q5,o.onAfterCornerRenderEmitter=new A.Q5,o.onAfterAreaRender=o.onAfterAreaRenderEmitter.event,o.onAfterCellRender=o.onAfterCellRenderEmitter.event,o.onAfterRowHeadRender=o.onAfterRowHeadRenderEmitter.event,o.onAfterColHeadRender=o.onAfterColHeadRenderEmitter.event,o.onAfterCornerRender=o.onAfterCornerRenderEmitter.event,o.spreadsheet=n,o._matrix=i,o._initStage(t),o._initRenderEngine(),o._initCollectEngine(),o._initContent(),o}(0,i.Z)(t,e);var r=t.prototype;return r.resize=function(){var e=this._container.offsetWidth,t=this._container.offsetHeight;this._width=e,this._height=t,Fe(this._canvas,e,t);var r=this._matrix;this._ctx.setTransform(r.a*window.devicePixelRatio,r.b*window.devicePixelRatio,r.c*window.devicePixelRatio,r.d*window.devicePixelRatio,r.e*window.devicePixelRatio,r.f*window.devicePixelRatio)},r.clear=function(){this._ctx.clearRect(0,0,this.canvas.width/Math.min(1,this._matrix.a),this.canvas.height/Math.min(1,this._matrix.d))},r.applyMatrixToCanvas=function(e){this._matrix=e,this._ctx.setTransform(e.a*window.devicePixelRatio,e.b*window.devicePixelRatio,e.c*window.devicePixelRatio,e.d*window.devicePixelRatio,e.e*window.devicePixelRatio,e.f*window.devicePixelRatio)},r.renderRowHead=function(e,t,r,i){void 0===r&&(r=0);var n=i||{},o=n.ctx,a=n.scale,s=void 0===a?1:a;if(o){this.switchCtx(o);var l=this._matrix;o.setTransform(l.a*window.devicePixelRatio*s,l.b*window.devicePixelRatio*s,l.c*window.devicePixelRatio*s,l.d*window.devicePixelRatio*s,l.e*window.devicePixelRatio*s,l.f*window.devicePixelRatio*s)}this._ctx.save(),this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._rowHead.collect(e,t,r),this.renderEngine.render(this._collectEngine,this._ctx),this._ctx.restore(),this.switchCtx(this._ctx_default),this._collectEngine.clear()},r.renderColHead=function(e,t,r,i){void 0===r&&(r=0);var n=i||{},o=n.ctx,a=n.scale,s=void 0===a?1:a;if(o){this.switchCtx(o);var l=this._matrix;o.setTransform(l.a*window.devicePixelRatio*s,l.b*window.devicePixelRatio*s,l.c*window.devicePixelRatio*s,l.d*window.devicePixelRatio*s,l.e*window.devicePixelRatio*s,l.f*window.devicePixelRatio*s)}this._ctx.save(),this._ctx.textBaseline="middle",this._ctx.textAlign="center",this._colHead.collect(e,t,r),this._renderEngine.render(this._collectEngine,this._ctx),this._ctx.restore(),this.switchCtx(this._ctx_default),this._collectEngine.clear()},r.renderCorner=function(e){var t=e||{},r=t.ctx,i=t.scale,n=void 0===i?1:i;if(r){this.switchCtx(r);var o=this._matrix;r.setTransform(o.a*window.devicePixelRatio*n,o.b*window.devicePixelRatio*n,o.c*window.devicePixelRatio*n,o.d*window.devicePixelRatio*n,o.e*window.devicePixelRatio*n,o.f*window.devicePixelRatio*n)}this._corner.collect(),this.renderEngine.render(this._collectEngine,this._ctx),this._collectEngine.clear()},r.renderCells=function(e,t,r,i,n,o,a,s){void 0===n&&(n=0),void 0===o&&(o=0);var l=s||{},c=l.ctx,h=l.scale,d=void 0===h?1:h,u=l.collectOption;if(c){this.switchCtx(c);var f=this._matrix;c.setTransform(f.a*window.devicePixelRatio*d,f.b*window.devicePixelRatio*d,f.c*window.devicePixelRatio*d,f.d*window.devicePixelRatio*d,f.e*window.devicePixelRatio*d,f.f*window.devicePixelRatio*d)}u&&this._collectEngine.setCollectOption(u);var g=this._body.collect(e,t,r,i,n,o);this._body.clearRect(g),this.onAfterAreaRenderEmitter.fire({fromRow:e,toRow:t,fromCol:r,toCol:i,offsetX:o,offsetY:n}),this.renderEngine.render(this._collectEngine,this._ctx),this.switchCtx(this._ctx_default),this._collectEngine.clear()},r.scrollRenderCells=function(e,t,r,i,n,o,a,s){var l;void 0===n&&(n=0),void 0===o&&(o=0);var c=s||{},h=c.ctx,d=c.collectOption;h&&this.switchCtx(h),d&&this._collectEngine.setCollectOption(d);var u=this._body.collect(e,t,r,i,n,o);this._ctx.save(),this._ctx.beginPath(),(l=this._ctx).rect.apply(l,(0,H.Z)(a)),this._ctx.clip(),this._ctx.closePath(),this._body.clearRect(u),this.onAfterAreaRenderEmitter.fire({fromRow:e,toRow:t,fromCol:r,toCol:i,offsetX:o,offsetY:n}),this.renderEngine.render(this._collectEngine,this._ctx),this.switchCtx(this._ctx_default),this._collectEngine.clear(),this._ctx.restore()},r._initStage=function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),i=e.offsetWidth,n=e.offsetHeight;this._width=i,this._height=n,Fe(t,i,n),e.appendChild(t),this._container=e,this._canvas=t,this._ctx=r,this._ctx_default=r,this._setupCanvasMatrix()},r._initContent=function(){this._corner=new ae(this,this.onAfterCornerRenderEmitter),this._body=new K(this,this.onAfterCellRenderEmitter,this.spreadsheet),this._colHead=new ee(this,this.onAfterColHeadRenderEmitter,this.spreadsheet),this._rowHead=new re(this,this.onAfterRowHeadRenderEmitter,this.spreadsheet)},r._setupCanvasMatrix=function(){this._matrix.reset(),this.applyMatrixToCanvas(this._matrix)},r._initRenderEngine=function(){this._renderEngine=new Pe(this.ctx)},r._initCollectEngine=function(){this._collectEngine=new Ne.Z(this.spreadsheet)},r.switchCtx=function(e){this._ctx=e||this._ctx_default},(0,n.Z)(t,[{key:"canvas",get:function(){return this._canvas}},{key:"ctx",get:function(){return this._ctx}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"container",get:function(){return this._container}},{key:"renderEngine",get:function(){return this._renderEngine}},{key:"collectEngine",get:function(){return this._collectEngine}}]),t}(z);function Fe(e,t,r){var i=window.devicePixelRatio||1,n=Math.round(t*i),o=Math.round(r*i);e.setAttribute("width",String(n)),e.setAttribute("height",String(o)),e.style.width=n/i+"px",e.style.height=o/i+"px"}var Ze,ke,Ue=Ve,We=(r(67196),r(84415)),Ge=r(14831),je=r.n(Ge),Ye=r(80067),Xe=r(10261),Ke=r(82993),Je=r(36156),Qe=je().isFirefox,$e=function(){function e(e){var t=this;this.scrollRender=function(){if(t.isNeedRepaint())return{isNeedRepaint:!0};var e=t.alloyExcel.ctx;e.save(),e.setTransform(1,0,0,1,0,0);var r=t.scrollRowsRender(),i=r.repaintY,n=r.repaintHeight,o=t.scrollColsRender(),a=o.repaintX,s=o.repaintWidth;return e.restore(),t.renderScrollMultipleRows(i,n),t.renderScrollMultipleCols(a,s),t.clearRectBottomArea(),t.clearRectRightArea(),t.areaData.row.flow.offsetDiff=0,t.areaData.col.flow.offsetDiff=0,{isNeedRepaint:!1}},this.scrollRowsRender=function(){var e={repaintY:0,repaintHeight:0},r=t.areaData.row.flow.offsetDiff;if(0===(r*=t.scrollRenderRatio))return e;var i=t.transformTable.colHeadHeight*t.scrollRenderRatio,n=t.alloyExcel.canvas.width-0,o=r<0&&t.areaData.row.flow.padding>0,a=t.areaData.row.flow.viewSize*t.scrollRenderRatio-Math.abs(r)-(o?0:t.areaData.row.flow.padding*t.scrollRenderRatio),s=n,l=a,c=i,h=i;return r<0?(h=(c+=t.areaData.row.frozen.viewSize*t.scrollRenderRatio+2*t.scrollRenderRatio)-r,e.repaintY=c-2*t.scrollRenderRatio,e.repaintHeight=h-e.repaintY+2*t.scrollRenderRatio):r>0&&(c=(h+=t.areaData.row.frozen.viewSize*t.scrollRenderRatio)+r,e.repaintY=h+l-2*t.scrollRenderRatio,e.repaintHeight=t.alloyExcel.canvas.height-e.repaintY),t.drawCanvasImage(0,c,n,a,0,h,s,l),e.repaintY=e.repaintY/t.scrollRenderRatio,e.repaintHeight=e.repaintHeight/t.scrollRenderRatio,e},this.scrollColsRender=function(){var e={repaintX:0,repaintWidth:0},r=t.areaData.col.flow.offsetDiff;if(0===(r*=t.scrollRenderRatio))return e;var i=t.transformTable.rowHeadWidth*t.scrollRenderRatio,n=t.areaData.col.flow.viewSize*t.scrollRenderRatio-Math.abs(r),o=t.alloyExcel.canvas.height-0,a=n,s=o,l=i,c=i;return r<0?(c=(l+=t.areaData.col.frozen.viewSize*t.scrollRenderRatio+2*t.scrollRenderRatio)-r,e.repaintX=l-2*t.scrollRenderRatio,e.repaintWidth=c-e.repaintX+2*t.scrollRenderRatio):r>0&&(l+=t.areaData.col.frozen.viewSize*t.scrollRenderRatio+r,c+=t.areaData.col.frozen.viewSize*t.scrollRenderRatio,e.repaintX=c+a-2*t.scrollRenderRatio,e.repaintWidth=Math.abs(r)+2*t.scrollRenderRatio),t.drawCanvasImage(l,0,n,o,c,0,a,s),e.repaintX=e.repaintX/t.scrollRenderRatio,e.repaintWidth=e.repaintWidth/t.scrollRenderRatio,e},this.drawCanvasImage=function(e,r,i,n,o,a,s,l){e=L(e),r=L(r),i=L(i),n=L(n),o=L(o),a=L(a),s=L(s),l=L(l);var c=t.alloyExcel.ctx,h=e+i-c.canvas.width,d=r+n-c.canvas.height;(h>2||d>2)&&(0,Ke.ji)({level:Ke.y8.INFO,moduleValue:"scrollrender",actionValue:"canvasCalcError",detail:[e,i,c.canvas.width,r,n,c.canvas.height]}),h>0&&(s=i=c.canvas.width-e),d>0&&(l=n=c.canvas.height-r),c.drawImage(t.alloyExcel.canvas,e,r,i,n,o,a,s,l)},this.renderScrollMultipleRows=function(e,r){if(!(e<0||r<0)&&(0!==e||0!==r)){var i=function(e,t,r,i){for(var n=r.row.frozen,o=n.viewSize,a=n.to,s=r.row.flow,l=s.offsetSize,c=s.from,h={fromRow:a,toRow:a},d=e+l-o-i.colHeadHeight,u=d+t,f=r.row.flow.areaTop,g=f.length,_=0;_<g;_+=1){var p=f[_];if(p<=d&&(h.fromRow+=1),p>=u)break;h.toRow+=1}return h.fromRow=-1===h.fromRow?0:h.fromRow,h.toRow=-1===h.toRow?0:h.toRow,h.fromRow=h.fromRow<c?c:h.fromRow,h.toRow=h.toRow<c?c:h.toRow,h}(e,r,t.areaData,t.transformTable),n=i.fromRow,o=i.toRow,a=t.areaData,s=a.row,l=a.col;if(!(s.frozen.renderTo>=n&&s.frozen.renderFrom<=o)){var c=t.areaData.getViewTopByRow(n),h=t.areaData.row.flow.viewSize;if(t.areaData.row.flow.offsetDiff>0){e=t.areaData.getViewTopByRow(n)+t.headSize.colHeadHeight;var d=t.areaData.row.frozen.viewSize+t.headSize.colHeadHeight;e=Math.max(d,e)}else h=t.areaData.getViewBottomByRow(o)+t.headSize.colHeadHeight-e;if(l.flow.to>=l.flow.from){var u=l.flow.renderFrom,f=Math.min(t.transformTable.getColCount()-1,l.flow.renderTo),g=t.areaData.getViewLeftByCol(u),_=O(I.FLOW,I.FLOW,t.areaData,t.transformTable),p=[_[0],e,_[2],h];t.alloyExcel.scrollRenderCells(n,o,u,f,c,g,p)}if(l.frozen.to>=l.frozen.from){var v=l.frozen.renderFrom,w=Math.min(t.transformTable.getColCount()-1,l.frozen.renderTo),R=t.areaData.getViewLeftByCol(v),C=O(I.FLOW,I.FROZEN,t.areaData,t.transformTable),y=[C[0],e,C[2],h];t.alloyExcel.scrollRenderCells(n,o,v,w,c,R,y)}}}},this.renderScrollMultipleCols=function(e,r){if(!(e<0||r<0)&&(0!==e||0!==r)){var i=function(e,t,r,i){for(var n=r.col.frozen,o=n.viewSize,a=n.to,s=r.col.flow,l=s.offsetSize,c=s.from,h={fromCol:a,toCol:a},d=e+l-o-i.rowHeadWidth,u=d+t,f=r.col.flow.areaLeft,g=f.length,_=0;_<g;_+=1){var p=f[_];if(p<=d&&(h.fromCol+=1),p>=u)break;h.toCol+=1}return h.fromCol=-1===h.fromCol?0:h.fromCol,h.toCol=-1===h.toCol?0:h.toCol,h.fromCol=h.fromCol<c?c:h.fromCol,h.toCol=h.toCol<c?c:h.toCol,h}(e,r,t.areaData,t.transformTable),n=i.fromCol,o=i.toCol,a=t.areaData,s=a.row,l=a.col;if(!(l.frozen.renderTo>=n&&l.frozen.renderFrom<=o)){var c=t.areaData.getViewLeftByCol(n),h=t.areaData.col.flow.viewSize;if(t.areaData.col.flow.offsetDiff>0){e=t.areaData.getViewLeftByCol(n)+t.headSize.rowHeadWidth;var d=t.areaData.col.frozen.viewSize+t.headSize.rowHeadWidth;e=Math.max(d,e)}else h=t.areaData.getViewRightByCol(o)+t.headSize.rowHeadWidth-e;if(s.flow.to>=s.flow.from){var u=s.flow.renderFrom,f=Math.min(t.transformTable.getRowCount()-1,s.flow.renderTo),g=t.areaData.getViewTopByRow(u),_=O(I.FLOW,I.FLOW,t.areaData,t.transformTable),p=[e,_[1],h,_[3]];t.alloyExcel.scrollRenderCells(u,f,n,o,g,c,p)}if(s.frozen.to>=s.frozen.from){var v=s.frozen.renderFrom,w=Math.min(t.transformTable.getRowCount()-1,s.frozen.renderTo),R=t.areaData.getViewTopByRow(v),C=O(I.FROZEN,I.FLOW,t.areaData,t.transformTable),y=[e,C[1],h,C[3]];t.alloyExcel.scrollRenderCells(v,w,n,o,R,c,y)}}}},this.isNeedRepaint=function(){return!!t.disableScrollRender||!!je().isMiniProgram||!(!Qe&&!Xe.x9)||!(!je().isPC||!t.isPcNeedRepaint())||!(!je().isMobilePhone||!t.isMobileNeedRepaint())||t.commonCheck()},this.isPcNeedRepaint=function(){return!1},this.isMobileNeedRepaint=function(){if(0!==t.areaData.col.flow.offsetDiff)return!0;var e=t.areaData.row.flow.padding;if(t.mobileRowPadding!==e)return t.mobileRowPadding=e,!0;var r=t.scale.scale;return.85!==r&&.65!==r||!(0,Ye.gr)()},this.commonCheck=function(){return!t.spreadsheet.activeSheet.isLoaded||(t.isFirstTimeRender?(t.isFirstTimeRender=!1,!0):!!t.isScaleOrPixelRatioChange()||t.isScrollTooMuch())},this.isScaleOrPixelRatioChange=function(){var e=t.scale.scale;return!(!je().isPC||1===e)||(t.currentScale!==e?(t.currentScale=e,!0):t.devicePixelRatio!==r.g.devicePixelRatio&&(t.devicePixelRatio=r.g.devicePixelRatio,!0))},this.isScrollTooMuch=function(){var e=t.areaData.row.flow.padding,r=t.areaData.row.flow,i=r.offsetDiff,n=r.viewSize;if(Math.abs(i)+2+e>=n)return!0;var o=t.areaData.col.flow,a=o.offsetDiff,s=o.viewSize;return Math.abs(a)+2>=s},this.alloyExcel=e.alloyExcel,this.areaData=e.areaData,this.transformTable=e.transformTable,this.scale=e.scale,this.mobileRowPadding=this.areaData.row.flow.padding,this.currentScale=this.scale.scale,this.spreadsheet=e.spreadsheet,this.isFirstTimeRender=!0,this.disableScrollRender=""!==(0,Ye.IZ)("disableScrollRender")||Je.xc,this.devicePixelRatio=r.g.devicePixelRatio,this.headSize=e.headSize}var t=e.prototype;return t.clearRectBottomArea=function(){je().isPC?this.clearPcRectBottomArea():(je().isAndroidPad||je().isIPad)&&this.clearPadRectBottomArea()},t.clearPcRectBottomArea=function(){if(this.areaData.row.flow.offsetDiff>0){var e=this.areaData.row.flow.offsetSize-this.areaData.row.flow.maxOffsetSize+this.areaData.row.flow.safeDistance;if(e>0){var t=this.areaData.row.flow.viewSize+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight-e,r=this.areaData.col.flow.viewSize+this.areaData.col.frozen.viewSize+this.transformTable.rowHeadWidth,i=e;this.alloyExcel.ctx.clearRect(0,t,r,i)}}},t.clearPadRectBottomArea=function(){var e=this.areaData.row.flow,t=e.padding,r=e.renderTo,i=e.areaTop,n=e.offsetSize;if(t>0){var o=this.areaData.row.flow.viewSize+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight,a=this.areaData.col.flow.viewSize+this.areaData.col.frozen.viewSize+this.transformTable.rowHeadWidth,s=i[r+1]+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight-n,l=s,c=a,h=o-s;this.alloyExcel.ctx.clearRect(0,l,c,h)}},t.clearRectRightArea=function(){if(this.areaData.col.flow.offsetDiff>0){var e=this.areaData.col.flow.offsetSize-this.areaData.col.flow.maxOffsetSize+this.areaData.col.flow.safeDistance;if(e>0){var t=this.areaData.row.flow.viewSize+this.areaData.row.frozen.viewSize+this.transformTable.colHeadHeight,r=this.areaData.col.flow.viewSize+this.areaData.col.frozen.viewSize+this.transformTable.rowHeadWidth-e,i=e,n=t;this.alloyExcel.ctx.clearRect(r,0,i,n)}}},(0,n.Z)(e,[{key:"scrollRenderRatio",get:function(){return this.scale.scale*this.devicePixelRatio}}]),e}();function qe(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return et(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?et(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function tt(e,t){var r=t.index,i=t.amount,n=t.type,o=e[0],a=e[1],s=n===Ze.INSERT,l=r,c=s?r:r+i;if(l>a)return[o,a];var h=o;return c<o?h=rt(o,i,n):!s&&l<o&&(h=rt(c,i,n)),[h,rt(!s&&a<c?c-1:a,i,n)]}function rt(e,t,r){return r===Ze.INSERT?e+t:e-t}function it(e,t){var r=at(e,t);if(!r&&!ot(e,t))return[e];var i=nt(e,t),n=i[0],o=i[1],a=n.rowStart,s=n.rowEnd,l=n.colRanges,c=n.calculateTypes,h=o.rowStart,d=o.rowEnd,u=o.colRanges,f=o.calculateTypes;return a===h&&s===d?[st(a,s,dt(l,u),gt(c,f))]:r||a<h&&h<=s&&s<d?function(e,t){var r=e.rowStart,i=e.rowEnd,n=e.colRanges,o=e.calculateTypes,a=t.rowStart,s=t.rowEnd,l=t.colRanges,c=t.calculateTypes,h=ht(o,c);return!ct(n,l)&&h?[st(r,s,n,o)]:!n.length&&h?[st(r,a,[],o),t]:!l.length&&h?[e,st(i,s,[],c)]:[st(r,a-1,n,o),st(a,i,dt(n,l),gt(o,c)),st(i+1,s,l,c)]}(n,o):function(e,t){var r=e.rowStart,i=e.rowEnd,n=e.colRanges,o=e.calculateTypes,a=t.rowStart,s=t.rowEnd,l=t.colRanges,c=t.calculateTypes;return!ht(o,c)||ct(n,l)&&l.length?r===a?[st(r,i,dt(n,l),gt(o,c)),st(i+1,s,l,c)]:i===s?[st(r,a-1,n,o),st(a,s,dt(n,l),gt(o,c))]:[st(r,a-1,n,o),st(a,s,dt(n,l),gt(o,c)),st(s+1,i,n,o)]:[st(Math.min(r,a),Math.max(i,s),n,gt(o,c))]}(n,o)}function nt(e,t){return vt(e.rowStart,e.rowEnd,t.rowStart,t.rowEnd)?[e,t]:[t,e]}function ot(e,t){return _t(e.rowStart,e.rowEnd,t.rowStart,t.rowEnd)}function at(e,t){return pt(e.rowStart,e.rowEnd,t.rowStart,t.rowEnd)}function st(e,t,r,i){return void 0===r&&(r=[]),void 0===i&&(i=[]),{rowStart:e,rowEnd:t,colRanges:r,calculateTypes:i}}function lt(e){return{rowStart:e.rowStart,rowEnd:e.rowEnd,colRanges:e.colRanges,calculateTypes:e.calculateTypes}}function ct(e,t){if(e.length!==t.length)return!0;for(var r=0;r<e.length;r++){var i=e[r],n=i[0],o=i[1],a=t[r],s=a[0],l=a[1];if(n!==s||o!==l)return!0}return!1}function ht(e,t){return e.sort().join(",")===t.sort().join(",")}function dt(e,t){var r=(0,H.Z)(e);return t.forEach((function(e){for(var t,i,n,o=[e],a=qe(r);!(t=a()).done;){var s=t.value,l=o.pop();if(function(e,t){var r=e[0],i=e[1],n=t[0],o=t[1];return _t(r,i,n,o)}(i=s,n=l)||function(e,t){var r=e[0],i=e[1],n=t[0],o=t[1];return pt(r,i,n,o)}(i,n)){var c=ut(s,l);o.push(c)}else o.push.apply(o,(0,H.Z)(ft(s,l)))}r=o})),r}function ut(e,t){var r=e[0],i=e[1],n=t[0],o=t[1];return[Math.min(r,n),Math.max(i,o)]}function ft(e,t){return vt(e[0],e[1],t[0],t[1])?[e,t]:[t,e]}function gt(e,t){return Array.from(new Set(e.concat(t)))}function _t(e,t,r,i){return!(e>i||t<r)}function pt(e,t,r,i){return e===i+1||t===r-1}function vt(e,t,r,i){return e<r||e===r&&t<=i}r(15770),r(84919),r(26894),r(71091),r(13857),r(54371),r(95019),r(19553),r(81144),r(25594),r(93984),r(90109),r(75793),r(59677),r(14199),r(47917),r(48912),r(34797),r(2725),r(12522),r(56687),r(10635),r(89512),r(57625),r(41403),r(76252),r(69398),r(49245),r(15421),r(554),function(e){e[e.INSERT=1]="INSERT",e[e.DELETE=2]="DELETE"}(Ze||(Ze={})),function(e){e.PARAGRAPH="paragraph",e.BORDER="border",e.ROW_COVER="row-cover"}(ke||(ke={})),(0,l.yh)("ICalculateArea");var wt=function(e){function t(t){var r;return(r=e.call(this)||this).rowStart=t.rowStart,r.rowEnd=t.rowEnd,r.colRanges=t.colRanges||[],r.calculateTypes=t.calculateTypes,r}(0,i.Z)(t,e);var r=t.prototype;return r.mergeArea=function(e){return it({rowStart:this.rowStart,rowEnd:this.rowEnd,colRanges:this.colRanges,calculateTypes:this.calculateTypes},e)},r.removeRow=function(e,t){return e>this.rowEnd||t<this.rowStart?[lt(this)]:e<=this.rowStart&&t<this.rowEnd?(this.rowStart=t+1,[lt(this)]):e>this.rowStart&&t>=this.rowEnd?(this.rowEnd=e-1,[lt(this)]):e<=this.rowStart&&t>=this.rowEnd?[]:[st(this.rowStart,e-1,this.colRanges,this.calculateTypes),st(t+1,this.rowEnd,this.colRanges,this.calculateTypes)]},r.rowChange=function(e){var t=tt([this.rowStart,this.rowEnd],e),r=t[0],i=t[1];this.rowStart=r,this.rowEnd=i},r.colChange=function(e){var t=this;this.colRanges.forEach((function(r,i){t.colRanges[i]=tt(r,e)}))},t}(l.JT);function Rt(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return Ct(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ct(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var yt,mt,Et=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).areaListMap={},t}(0,i.Z)(t,e);var r=t.prototype;return r.getAreaList=function(e){return this.areaListMap[e]||[]},r.getNearbyAreaRow=function(e,t){for(var r,i,n,o,a=Rt(this.getAreaList(e));!(o=a()).done;){var s=o.value,l=s.rowStart,c=s.rowEnd;if(t>=l&&t<=c){r=t,i=s,n=0;break}var h=Math.abs(t-l),d=Math.abs(t-c),u=Math.min(h,d);if((void 0===n||u<n)&&(r=u===h?l:c,i=s,n=u),u===h)break}return void 0===r?void 0:{rowIndex:r,area:i}},r.getAreaByRowIndex=function(e,t){return this.getAreaList(e).find((function(e){return e.rowEnd>=t&&e.rowStart<=t}))},r.getAreaByRowRange=function(e,t,r){var i=this.getAreaList(e),n=[t,r].sort((function(e,t){return e-t})),o=n[0],a=n[1],s=i.filter((function(e){return ot(e,{rowStart:o,rowEnd:a})}));return s.length?s.map((function(e){var t=e.rowStart,r=e.rowEnd,i=e.colRanges,n=e.calculateTypes;return st(Math.max(t,o),Math.min(r,a),i,n)})):[]},r.clearArea=function(e){this.areaListMap[e]=[]},r.addArea=function(e,t){for(var r,i,n,o=[t],a=Rt(this.getAreaList(e));!(r=a()).done;){var s=r.value,l=o.pop();if(ot(i=s,n=l)||at(i,n)){var c=it(l,s);o.push.apply(o,(0,H.Z)(c))}else o.push.apply(o,(0,H.Z)(nt(l,s)))}return this.areaListMap[e]=o},r.removeArea=function(e,t,r){var i=this.getAreaList(e),n=[];return i.forEach((function(e){if(!(t<=e.rowStart&&r>=e.rowEnd)){var i=new wt(e);n.push.apply(n,(0,H.Z)(i.removeRow(t,r)))}})),this.areaListMap[e]=n},r.addRowChange=function(e,t){var r=this.getAreaList(e).map((function(e){var r=new wt(e);return r.rowChange(t),lt(r)}));return this.areaListMap[e]=r},r.addColChange=function(e,t){var r=this.getAreaList(e).map((function(e){var r=new wt(e);return r.colChange(t),lt(r)}));return this.areaListMap[e]=r},t}(l.JT),St=Et;function Dt(e,t,r){var i=t===I.FROZEN,n=r===I.FROZEN,o=e.row[i?"frozen":"flow"],a=e.col[n?"frozen":"flow"],s=o.renderFrom,l=Math.min(o.to,o.renderTo),c=e.getViewTopByRow(s),h=a.renderFrom;return{fromRow:s,toRow:l,fromCol:h,toCol:Math.min(a.to,a.renderTo),offsetY:c,offsetX:e.getViewLeftByCol(h)}}function At(e){var t=[],r=Dt(e,I.FROZEN,I.FROZEN);r.toRow>=0&&t.push({areaType:I.FROZEN,rowStart:r.fromRow,rowEnd:r.offsetY>0?r.toRow+1:r.toRow});var i=Dt(e,I.FLOW,I.FLOW);return t.push({areaType:I.FLOW,rowStart:i.fromRow,rowEnd:i.offsetY>0?i.toRow+1:i.toRow}),t}!function(e){e[e.FROZEN=0]="FROZEN",e[e.FLOW=1]="FLOW"}(yt||(yt={})),function(e){e.afterRender="afterRender"}(mt||(mt={}));var xt=function(e){function t(t){var r;return(r=e.call(this)||this)._onAfterRender=new A.Q5({name:mt.afterRender}),r.renderTable=function(){r._alloyExcel.clear(),r._renderBody(),r._renderRowHead(),r._renderColHead(),r._renderCorner(),r._onAfterRender.fire()},r.renderNextTick=(0,We.kf)(r.renderTable,0),r.renderRowCells=function(e){var t,i=r._areaData.row,n=r._areaData.col;if(i.frozen.renderFrom<=e&&e<=i.frozen.renderTo)t=yt.FROZEN;else{if(!(i.flow.renderFrom<=e&&e<=i.flow.renderTo))return;t=yt.FLOW}var o=r._areaData.getViewTopByRow(e);if(n.flow.to>=n.flow.from){var a=n.flow.renderFrom,s=Math.min(r._transformTable.getColCount()-1,n.flow.renderTo),l=r._areaData.getViewLeftByCol(a);r._clipBodyArea(t,yt.FLOW,(function(){r._alloyExcel.renderCells(e,e,a,s,o,l)}))}if(n.frozen.to>=n.frozen.from){var c=n.frozen.renderFrom,h=Math.min(r._transformTable.getColCount()-1,n.frozen.renderTo),d=r._areaData.getViewLeftByCol(c);r._clipBodyArea(t,yt.FROZEN,(function(){r._alloyExcel.renderCells(e,e,c,h,o,d)}))}r._renderRowHead(),r._renderColHead(),r._renderCorner(),r._onAfterRender.fire()},r.onAfterRender=r._onAfterRender.event,r._alloyExcel=t.alloyExcel,r._areaData=t.areaData,r._transformTable=t.transformTable,r._headSize=t.headSize,r._scrollRenderApi=new $e(t),r}(0,i.Z)(t,e);var r=t.prototype;return r.scrollCanvasRender=function(){this._scrollRenderApi.scrollRender().isNeedRepaint&&(this._alloyExcel.clear(),this._renderBody()),this._renderRowHead(),this._renderColHead(),this._renderCorner(),this._onAfterRender.fire()},r.renderRowHead=function(){this._alloyExcel.ctx.clearRect(0,0,this._headSize.rowHeadWidth,Number.MAX_SAFE_INTEGER),this._renderRowHead(),this._renderCorner(),this._onAfterRender.fire()},r.renderColHead=function(){this._alloyExcel.ctx.clearRect(0,0,Number.MAX_SAFE_INTEGER,this._headSize.colHeadHeight),this._renderColHead(),this._renderCorner(),this._onAfterRender.fire()},r._renderBody=function(){var e=this._areaData.row,t=this._areaData.col;e.flow.to>=e.flow.from&&(this._renderBodyArea(yt.FLOW,yt.FLOW),t.frozen.to>=t.frozen.from&&this._renderBodyArea(yt.FLOW,yt.FROZEN)),e.frozen.to>=e.frozen.from&&(this._renderBodyArea(yt.FROZEN,yt.FLOW),t.frozen.to>=t.frozen.from&&this._renderBodyArea(yt.FROZEN,yt.FROZEN))},r._renderCorner=function(){this._alloyExcel.renderCorner()},r._renderRowHead=function(){var e=this._areaData.row;this._renderRowArea(yt.FLOW),e.frozen.to>=e.frozen.from&&this._renderRowArea(yt.FROZEN)},r._renderColHead=function(){var e=this._areaData.col;this._renderColArea(yt.FLOW),e.frozen.to>=e.frozen.from&&this._renderColArea(yt.FROZEN)},r._renderBodyArea=function(e,t){var r=this,i=Dt(this._areaData,e,t),n=i.fromRow,o=i.toRow,a=i.fromCol,s=i.toCol,l=i.offsetY,c=i.offsetX;e===yt.FROZEN||t===yt.FROZEN?this._clipBodyArea(e,t,(function(){r._alloyExcel.renderCells(n,o,a,s,l,c)})):this._alloyExcel.renderCells(n,o,a,s,l,c)},r._clipBodyArea=function(e,t,r){var i,n=this._getFrozenAreaClipRect(e,t);this._alloyExcel.ctx.save(),this._alloyExcel.ctx.beginPath(),(i=this._alloyExcel.ctx).rect.apply(i,(0,H.Z)(n)),this._alloyExcel.ctx.clip(),this._alloyExcel.ctx.closePath(),r(),this._alloyExcel.ctx.restore()},r._getFrozenAreaClipRect=function(e,t){return O(e,t,this._areaData,this._transformTable)},r._renderRowArea=function(e){var t=this._areaData.row[e===yt.FROZEN?"frozen":"flow"],r=this._areaData.getViewTopByRow(t.renderFrom);this._alloyExcel.renderRowHead(t.renderFrom,t.renderTo,r)},r._renderColArea=function(e){var t=this._areaData.col[e===yt.FROZEN?"frozen":"flow"],r=this._areaData.getViewLeftByCol(t.renderFrom);this._alloyExcel.renderColHead(t.renderFrom,t.renderTo,r)},t}(l.JT),Tt=(r(12024),r(81502),r(4175)),It=r(41266),bt=r(38808),Ot=r(20445),Lt=r(31973),Ht=r(47590);function zt(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return Mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mt(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}var Bt=function(e){function t(t){var i;return(i=e.call(this)||this).getVisibleRowArea=function(){var e=At(i.areaData);return{sheetId:i.spreadsheet.activeSheetId,rowRanges:e}},i.onCalculateCells=function(e){try{e.forEach((function(e){var t=e.rowStart,r=e.rowEnd,n=e.colRanges,o=e.calculateTypes,a=e.sheetId;n.length>0?i.calculateByRowCol(a,t,r,n,o):i.calculateByRow(a,t,r,o)}))}catch(t){r.g.log.error("CanvasRender onCalculateCells error:",t),Lt.ZP.zzsStatus({attrid:Ot.CORE_LINK_ZZS_POINTER.MUTATION_APPLY_TO_VIEW_ERROR,status:1}),Ht.$.report("MUTATION_APPLY_TO_VIEW_ERROR"),Lt.ZP.opentelemetry({name:"MUTATION_APPLY_TO_VIEW_ERROR",message:null===t||void 0===t?void 0:t.message,stack:null===t||void 0===t?void 0:t.stack})}},i.onSetRowHeight=function(e){var t=e.ranges,r=e.sheetId;t.forEach((function(e){i.rowcolAccessor.calculateRange(r,e.startIndex,e.endIndex)}))},i.handleSwitchSheetStart=function(e){var t=i.spreadsheet.sheetManager.getSheetBySheetId(e),n=i.spreadsheet.activeSheetId;if(t&&n!==e&&t.isLoaded&&!i.spreadsheet.isExternalSheet(n)){i.calculateSplitter.stopAsyncCalculate();var o=function(e,t){var i=[],n=At(e),o=t.activeSheet.getRowCount()-1,a=new St;return a.addArea(t.getActiveSheetId(),{rowStart:0,rowEnd:o,colRanges:[],calculateTypes:[]}),n.forEach((function(e){a.removeArea(t.getActiveSheetId(),e.rowStart,e.rowEnd)})),a.getAreaList(t.getActiveSheetId()).forEach((function(e){r.g.log.debug("fragmentRender getInvisibleRowRange rowStart:"+e.rowStart+" rowEnd:"+e.rowEnd),i.push({rowStart:e.rowStart,rowEnd:e.rowEnd})})),i}(i.areaData,i.spreadsheet);i.paragraphAccessor.clear(n,o),i.rowCoverAccessor.clear(n,o),i.borderAccessor.clear(n,o),i.calculateSplitter.startAsyncCalculate()}},i.handleAfterMutationRun=function(e){var t=e.mutation.getAffectedGridRanges();if(e.mutation.id!==bt.ZP.SET_RANGE_MUTATION||Jt.isFullRender)i.renderApi.renderNextTick();else{for(var r,n=i.getVisibleRowArea(),o=!1,a=zt(t);!(r=a()).done;)for(var s,l=r.value,c={rowStart:l.startRowIndex,rowEnd:l.endRowIndex},h=zt(n.rowRanges);!(s=h()).done;){var d=s.value;if(ot(c,{rowStart:d.rowStart,rowEnd:d.rowEnd})){o=!0;break}}o&&i.renderApi.renderNextTick()}},i.onUpdateHideGridLines=function(e){i.borderAccessor.checkGridlines(e)},i.dataCallView=t.dataCallView,i.spreadsheet=t.spreadsheet,i.resize=t.resize,i.scale=t.scale,i.areaData=t.areaData,i.alloyExcel=t.alloyExcel,i.renderApi=t.renderApi,i.paragraphAccessor=t.paragraphAccessor,i.rowcolAccessor=t.rowcolAccessor,i.rowCoverAccessor=t.rowCoverAccessor,i.borderAccessor=t.borderAccessor,i.tableView=t.tableView,i.disableAsyncCalculate=t.disableAsyncCalculate,i}(0,i.Z)(t,e);var n=t.prototype;return n.registerEvents=function(){this.registerDataEvents(),this.registerCanvasEvents()},n.dispose=function(){e.prototype.dispose.call(this),Tt.ZP.spreadsheetEvent.remove("renderAfterMutationRun",this.renderApi.renderNextTick),r.g.SpreadsheetApp.event.sheetsBar.remove("switchSheetStart",this.handleSwitchSheetStart)},n.calculateByRow=function(e,t,r,i){i.includes(ke.PARAGRAPH)&&(this.paragraphAccessor.calculateRange(e,t,r),this.rowcolAccessor.calculateRange(e,t,r)),i.includes(ke.ROW_COVER)&&this.rowCoverAccessor.calculateRange(e,t,r),i.includes(ke.BORDER)&&this.borderAccessor.calculateRange(e,Math.max(0,t-1),r)},n.calculateByRowCol=function(e,t,r,i,n){var o=this;n.includes(ke.PARAGRAPH)&&(i.forEach((function(i){o.paragraphAccessor.calculateRange(e,t,r,i)})),this.rowcolAccessor.calculateRange(e,t,r)),n.includes(ke.ROW_COVER)&&this.rowCoverAccessor.calculateRange(e,t,r),n.includes(ke.BORDER)&&this.borderAccessor.calculateRange(e,Math.max(0,t-1),r)},n.registerCanvasEvents=function(){this._register(this.areaData.onUpdateOffset((function(e){e.source!==b.oz.RENDER&&e.source!==b.oz.API&&It.Z.getInstance().onScrolling()}))),this._register(this.resize.onResize(this.handleResize)),this._register(this.scale.onScale(this.handleScale)),this._register(this.areaData.onUpdateOffset((0,We.ad)(this.handleScroll)))},n.registerDataEvents=function(){Tt.ZP.spreadsheetEvent.listen("renderAfterMutationRun",this.handleAfterMutationRun),r.g.SpreadsheetApp.event.sheetsBar.listen("switchSheetStart",this.handleSwitchSheetStart),this._register(this.dataCallView.onSetRowHeight(this.onSetRowHeight)),this._register(this.dataCallView.onUpdateHideGridLines(this.onUpdateHideGridLines)),this.calculateSplitter=this.initSplitter(this.disableAsyncCalculate),this._register(this.calculateSplitter.onCalculateCells(this.onCalculateCells))},t}(l.JT),Pt=Bt,Nt=r(26178),Vt=function(e){function t(t){var r;return(r=e.call(this)||this).areaManager=t.areaManager,r.runAreaCalculate=t.runAreaCalculate,r.getVisibleRowArea=t.getVisibleRowArea,r}(0,i.Z)(t,e);var n=t.prototype;return n.calculateNextTask=function(e){var t=performance.now(),i=this.getVisibleRowArea(),n=i.sheetId,o=i.rowRanges,a=this.runVisibleCalculate(e),s=o.find((function(e){return e.areaType===I.FLOW}));if(!s)return r.g.log.warn("AsyncCalculateRunner calculateNextTask 取不到可视区域范围"),{sheetId:n,rowRanges:a,hasVisibleRanges:!!a.length};var l=Math.floor((s.rowStart+s.rowEnd)/2),c=this.areaManager.getNearbyAreaRow(n,l),h=new St;for(a.forEach((function(e){return h.addArea(n,{colRanges:[],calculateTypes:[],rowStart:e.rowStart,rowEnd:e.rowEnd})}));c&&performance.now()-t<e;)this.runRowCalculate(n,c.rowIndex).forEach((function(e){return h.addArea(n,{colRanges:[],calculateTypes:[],rowStart:e.rowStart,rowEnd:e.rowEnd})})),c=this.areaManager.getNearbyAreaRow(n,l);var d=h.getAreaList(n);return{sheetId:n,rowRanges:d.map((function(e){return{rowStart:e.rowStart,rowEnd:e.rowEnd}})),hasVisibleRanges:!!a.length}},n.runVisibleCalculate=function(e){var t=this,r=(new Date).getTime(),i=this.getVisibleRowArea(),n=i.sheetId,o=i.rowRanges,a=[];if(o.forEach((function(e){a.push.apply(a,(0,H.Z)(t.areaManager.getAreaByRowRange(n,e.rowStart,e.rowEnd)))})),!a.length)return[];for(var s=new St;a.length&&(new Date).getTime()-r<e;){var l=a.shift(),c=l.rowStart,h=l.rowEnd,d=this.runRowCalculate(n,c);h>c&&a.unshift({rowStart:c+1,rowEnd:h}),d.forEach((function(e){return s.addArea(n,{colRanges:[],calculateTypes:[],rowStart:e.rowStart,rowEnd:e.rowEnd})}))}return s.getAreaList(n)},n.runRowCalculate=function(e,t){return this.runAreaCalculate(e,{rowStart:t,rowEnd:t})},t}(l.JT),Ft=function(e){function t(t){var r;return(r=e.call(this)||this).onBeforeAsyncCalculateEmitter=new A.Q5,r.onAfterAsyncCalculateEmitter=new A.Q5,r.areaManager=t.areaManager,r.getVisibleRowArea=t.getVisibleRowArea,r.calculateRunner=new Vt(t),r.onBeforeAsyncCalculate=r.onBeforeAsyncCalculateEmitter.event,r.onAfterAsyncCalculate=r.onAfterAsyncCalculateEmitter.event,r}(0,i.Z)(t,e);var r=t.prototype;return r.start=function(){this.runNext()},r.stop=function(){this.timer&&clearTimeout(this.timer)},r.runNext=function(){var e=this;this.timer&&clearTimeout(this.timer);var r=this.getVisibleRowArea().sheetId;this.areaManager.getAreaList(r).length&&(this.timer=setTimeout((function(){e.onBeforeAsyncCalculateEmitter.fire();var r=e.calculateRunner.calculateNextTask(t.timeForEveryTask);e.onAfterAsyncCalculateEmitter.fire(r),e.runNext()}),10))},t}(l.JT);Ft.timeForEveryTask=50;var Zt=Ft,kt=function(e){function t(t){var i;return(i=e.call(this)||this).handleCellsCalculate=function(e){var t=e.sheetId,r=e.startCol,n=e.startRow,o=e.endCol,a=e.endRow;i.isCurrentSheet(t)&&i.calculateAndSplitArea(t,{rowStart:n,rowEnd:a,colRanges:[[r,o]],calculateTypes:[ke.PARAGRAPH,ke.BORDER,ke.ROW_COVER]})},i.handleColRangeCalculate=function(e){var t=e.sheetId,r=e.ranges;if(i.isCurrentSheet(t)){var n=i.getTargetSheet(t);i.calculateAndSplitArea(t,{rowStart:0,rowEnd:n.getRowCount()-1,colRanges:r.map((function(e){return[e.startIndex,e.endIndex]})),calculateTypes:[ke.PARAGRAPH,ke.BORDER,ke.ROW_COVER]})}},i.handleColChangeCalculate=function(e){var t=e.sheetId;if(i.isCurrentSheet(t)){var r=i.getTargetSheet(t);i.calculateAndSplitArea(t,{rowStart:0,rowEnd:r.getRowCount()-1,colRanges:[],calculateTypes:[ke.BORDER,ke.ROW_COVER]})}},i.handleRowCalculate=function(e){var t=e.index,r=e.amount,n=e.sheetId;i.isCurrentSheet(n)&&i.handleRowRangeCalculate({sheetId:n,ranges:[{startIndex:t,endIndex:t+r}]})},i.handleRowRangeCalculate=function(e){var t=e.ranges,r=e.sheetId;i.isCurrentSheet(r)&&t.forEach((function(e){i.calculateAndSplitArea(r,{rowStart:Math.max(0,e.startIndex),rowEnd:e.endIndex,colRanges:[],calculateTypes:[ke.BORDER]})}))},i.handleSwitchSheetStart=function(e){if(e&&e!==i.spreadsheet.activeSheetId&&!i.spreadsheet.isExternalSheet(e)){var t=i.getTargetSheet(e);t&&t.isLoaded&&r.g.SpreadsheetApp.event.sheetsBar.listen("switchActiveSheetEnd",i.handleSwitchSheetEnd,"ignoreOffline")}},i.handleSwitchSheetEnd=function(e){var t=e,n=i.spreadsheet.activeSheetId;e!==n&&(r.g.log.warn("fragmentRender switchActiveSheetEnd:"+e+", but active sheet is:"+n),t=n);var o=i.getTargetSheet(t);o&&(r.g.SpreadsheetApp.event.sheetsBar.remove("switchActiveSheetEnd",i.handleSwitchSheetEnd),i.calculateAndSplitArea(t,{rowStart:0,rowEnd:o.getRowCount()-1,colRanges:[[0,o.getColCount()-1]],calculateTypes:[ke.PARAGRAPH,ke.ROW_COVER,ke.BORDER]}))},i.isCurrentSheet=function(e){return e===i.spreadsheet.activeSheetId},i.getTargetSheet=function(e){return i.spreadsheet.sheetManager.getSheetBySheetId(e)},i.dataCallView=t.dataCallView,i.spreadsheet=t.spreadsheet,i.handleRowColChangeArea=t.handleRowColChangeArea,i.calculateAndSplitArea=t.calculateAndSplitArea,i.handleEventChange(),i}return(0,i.Z)(t,e),t.prototype.handleEventChange=function(){var e=this;this._register(this.dataCallView.onUpdateCells(this.handleCellsCalculate)),this._register(this.dataCallView.onSetColWidth(this.handleColRangeCalculate)),this._register(this.dataCallView.onSetColVisible(this.handleColRangeCalculate)),this._register(this.dataCallView.onSetRowVisible(this.handleRowRangeCalculate)),this._register(this.dataCallView.onInsertCol((function(t){e.handleRowColChangeArea(t,Ze.INSERT),e.handleColChangeCalculate(t)}))),this._register(this.dataCallView.onDeleteCol((function(t){e.handleRowColChangeArea(t,Ze.DELETE),e.handleColChangeCalculate(t)}))),this._register(this.dataCallView.onInsertRow((function(t){e.handleRowColChangeArea(t,Ze.INSERT),e.handleRowCalculate(t)}))),this._register(this.dataCallView.onDeleteRow((function(t){e.handleRowColChangeArea(t,Ze.DELETE),e.handleRowCalculate(t)}))),r.g.SpreadsheetApp.event.sheetsBar.listen("switchSheetStart",this.handleSwitchSheetStart)},t}(l.JT),Ut=function(e){function t(t){var r;return(r=e.call(this)||this).onCalculateCellsEmitter=new A.Q5,r.onBeforeAsyncCalculateEmitter=new A.Q5,r.onAfterAsyncCalculateEmitter=new A.Q5,r.disableAsyncCalculate=!1,r.isAsyncCalculateStop=!1,r.asyncCalculateJankCount=0,r.calculateAndSplitArea=function(e,t){var i=t.rowStart,n=t.rowEnd;!r.disableAsyncCalculate&&r.needRangeSplit(e,i,n)?r.splitArea(e,t):r.runMergeAreaCalculate(e,t)},r.runAreaCalculate=function(e,t){var i=t.rowStart,n=t.rowEnd,o=r.areaManager.getAreaByRowRange(e,i,n);return r.onCalculateCellsEmitter.fire(o.map((function(t){return Object.assign(Object.assign({},t),{sheetId:e})}))),r.areaManager.removeArea(e,i,n),o},r.runAndClearAllCalculate=function(e){r.runAreaCalculate(e,{rowStart:0,rowEnd:r.spreadsheet.activeSheet.getRowCount()-1})},r.handleRowColChangeArea=function(e,t){var i=e.index,n=e.amount,o=e.type,a=e.sheetId;o!==Nt.Dimension.DIMENSION_TYPE.ROWS?o===Nt.Dimension.DIMENSION_TYPE.COLUMNS&&r.areaManager.addColChange(a,{index:i,amount:n,type:t}):r.areaManager.addRowChange(a,{index:i,amount:n,type:t})},r.getVisibleRowArea=t.getVisibleRowArea,r.spreadsheet=t.spreadsheet,r.initManager(),r.disableAsyncCalculate=t.disableAsyncCalculate,r._register(new kt({dataCallView:t.dataCallView,spreadsheet:t.spreadsheet,areaManager:r.areaManager,disableAsyncCalculate:t.disableAsyncCalculate,handleRowColChangeArea:r.handleRowColChangeArea,calculateAndSplitArea:r.calculateAndSplitArea,getVisibleRowArea:r.getVisibleRowArea})),r}(0,i.Z)(t,e);var n=t.prototype;return n.startAsyncCalculate=function(){this.disableAsyncCalculate||(this.isAsyncCalculateStop=!1,this.asyncManager.start())},n.stopAsyncCalculate=function(){this.disableAsyncCalculate||(this.isAsyncCalculateStop=!0,this.asyncManager.stop())},n.runCalculateInArea=function(e,t){this.runAreaCalculate(e,t)},n.runNewCalculateInArea=function(e,t){this.runMergeAreaCalculate(e,t)},n.initManager=function(){var e=this,t=new St;this.areaManager=t,this.asyncManager=new Zt({areaManager:t,runAreaCalculate:this.runAreaCalculate,getVisibleRowArea:this.getVisibleRowArea}),this.onCalculateCells=this.onCalculateCellsEmitter.event,this.onBeforeAsyncCalculate=this.onBeforeAsyncCalculateEmitter.event,this.onAfterAsyncCalculate=this.onAfterAsyncCalculateEmitter.event,this._register(this.asyncManager.onBeforeAsyncCalculate((function(){return e.onBeforeAsyncCalculateEmitter.fire()}))),this._register(this.asyncManager.onAfterAsyncCalculate((function(t){return e.onAfterAsyncCalculateEmitter.fire(t)})))},n.runMergeAreaCalculate=function(e,t){var r=t.rowStart,i=t.rowEnd,n=this.getCalculateArea(e,t);this.onCalculateCellsEmitter.fire(n.map((function(t){return Object.assign(Object.assign({},t),{sheetId:e})}))),this.areaManager.removeArea(e,r,i)},n.splitArea=function(e,t){var r=this,i=performance.now(),n=t.rowStart,o=t.rowEnd,a=t.colRanges,s=t.calculateTypes,l=this.getVisibleRowArea(),c=l.rowRanges.filter((function(e){return ot(e,{rowStart:n,rowEnd:o})}));if(c.length&&l.sheetId===e){var h=new St;h.addArea(e,{rowStart:n,rowEnd:o,colRanges:[],calculateTypes:[]});var d=performance.now();c.forEach((function(i){var a=Math.max(n,i.rowStart),s=Math.min(o,i.rowEnd);r.runMergeAreaCalculate(e,Object.assign(Object.assign({},t),{rowStart:a,rowEnd:s})),h.removeArea(e,a,s)}));var u=performance.now();h.getAreaList(e).forEach((function(t){r.addAreaAndRunAsyncTask(e,st(t.rowStart,t.rowEnd,a,s))}));var f=performance.now()-i-(u-d);this.checkJankAndStopAsyncCalculate(e,f)}else{this.addAreaAndRunAsyncTask(e,t);var g=performance.now()-i;this.checkJankAndStopAsyncCalculate(e,g)}},n.getCalculateArea=function(e,t){var r=t.rowStart,i=t.rowEnd,n=this.areaManager.getAreaByRowRange(e,r,i);if(!n.length)return[t];if(1===n.length)return it(t,n[0]);var o=new St;return o.addArea(e,t),n.forEach((function(t){o.addArea(e,t)})),o.getAreaList(e)},n.needRangeSplit=function(e,t,r){var i=this.getVisibleRowArea();if(e!==this.spreadsheet.activeSheetId)return!0;var n=i.rowRanges.filter((function(e){return function(e,t){var r=e.rowStart,i=e.rowEnd;if(ot(t,{rowStart:r,rowEnd:i})){var n=t.rowStart-r,o=i-t.rowEnd;return n>Gt.separateRowLimit||o>Gt.separateRowLimit||n+o>Gt.separateRowLimit}return!0}({rowStart:t,rowEnd:r},e)}));return!!n.length},n.addAreaAndRunAsyncTask=function(e,t){this.areaManager.addArea(e,t),!this.isAsyncCalculateStop&&this.areaManager.getAreaList(e).length&&this.startAsyncCalculate()},n.checkJankAndStopAsyncCalculate=function(e,t){t<10||(this.asyncCalculateJankCount=this.asyncCalculateJankCount+1,this.runAndClearAllCalculate(e),this.asyncCalculateJankCount>5&&(this.disableAsyncCalculate=!0,r.g.log.report("splitter_render_calculate_jank")),r.g.log.warn("异步分片检测出执行耗时过长的任务，同步清理剩余未计算完成任务：sheetId = "+e+", 耗时为 "+t+" 毫秒"),Lt.ZP.zzsStatus({attrid:Ot.ZZS_REPORT_ATTR.SPLITTER_RENDER_CALCULATE_OVER_10_MS,status:0}))},t}(l.JT);Ut.separateRowLimit=10;var Wt,Gt=Ut,jt=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).handleScroll=function(e){e.source!==b.oz.RENDER&&t.renderApi.scrollCanvasRender()},t.handleResize=function(){t.alloyExcel.resize(),t.renderApi.renderTable()},t.handleScale=function(){t.alloyExcel.applyMatrixToCanvas(t.scale.matrix),t.renderApi.renderNextTick()},t.onAfterAsyncCalculate=function(e){e.hasVisibleRanges&&window.requestAnimationFrame((function(){t.renderApi.renderTable()}))},t}(0,i.Z)(t,e);var r=t.prototype;return r.registerEvents=function(){e.prototype.registerEvents.call(this),this._register(this.calculateSplitter.onAfterAsyncCalculate(this.onAfterAsyncCalculate))},r.initSplitter=function(e){return new Gt({dataCallView:this.dataCallView,spreadsheet:this.spreadsheet,getVisibleRowArea:this.getVisibleRowArea,disableAsyncCalculate:e})},t}(Pt),Yt=jt,Xt=r(86198);!function(e){e[e.FULL=0]="FULL",e[e.FRAGMENT=1]="FRAGMENT"}(Wt||(Wt={}));var Kt=function(e){function t(t){var r;return(r=e.call(this)||this).alloyExcel=new Ue(t.container,t.transformTable,t.scale.matrix,t.spreadsheet),r.renderApi=new xt({alloyExcel:r.alloyExcel,areaData:t.areaData,transformTable:t.transformTable,headSize:t.headSize,scale:t.scale,spreadsheet:t.spreadsheet}),"1"===(0,Ye.IZ)("disableFragmentRender")||(0,Xt.isFromTencentMeetingSharing)()?r.initRender(Wt.FULL,t):r.initRender(Wt.FRAGMENT,t),r}(0,i.Z)(t,e);var r=t.prototype;return r.getRender=function(){return this.render},r.getRenderType=function(){return this.renderType},r.initRender=function(e,r){if(t.isFullRender=e===Wt.FULL,this.renderType!==e){this.render&&this.render.dispose();var i={dataCallView:r.dataCallView,spreadsheet:r.spreadsheet,container:r.container,alloyExcel:this.alloyExcel,renderApi:this.renderApi,areaData:r.areaData,resize:r.resize,scale:r.scale,tableView:r.tableView,rowcolAccessor:r.rowcolAccessor,rowCoverAccessor:r.rowCoverAccessor,paragraphAccessor:r.paragraphAccessor,borderAccessor:r.borderAccessor};switch(e){case Wt.FULL:this.render=new Yt(Object.assign(Object.assign({},i),{disableAsyncCalculate:!0}));break;case Wt.FRAGMENT:this.render=new Yt(Object.assign(Object.assign({},i),{disableAsyncCalculate:!1}));break;default:this.render=new Yt(Object.assign(Object.assign({},i),{disableAsyncCalculate:!0}))}this.render.registerEvents(),this.renderType=e}},t}(l.JT);Kt.isFullRender=!1;var Jt=Kt,Qt=function(){function e(e){this._renderFrom=0,this._renderTo=0,this._from=0,this._to=0,this._areaTop=[],this._offsetSize=0,this._viewSize=0,this._contentSize=0,this._displaySafeDistance=0,this._displayPadding=0,this._maxVisibleHeight=0,this.updateOffsetEmitter=new A.Q5,this.updateViewSizeEmitter=new A.Q5,this.updateTotalSizeEmitter=new A.Q5,this.updatePaddingEmitter=new A.Q5,this._scale=e.scale,this._maxVisibleHeight=e.maxVisibleHeight,this.areaType=e.areaType,this.onUpdateOffset=this.updateOffsetEmitter.event,this.onUpdateViewSize=this.updateViewSizeEmitter.event,this.onUpdateTotalSize=this.updateTotalSizeEmitter.event,this.onUpdatePadding=this.updatePaddingEmitter.event}var t=e.prototype;return t.set=function(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=b.oz.SLIENT);var o=this._offsetSize-(this._areaTop[this._renderFrom]||0);this.setFromTo(t,r),this.calcAreaTop(e,i);var a=!1;0===this._offsetSize||Jt.isFullRender||(this.calcOffsetSize(o)||this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:b.oz.RENDER}),a=!0),this.calcRenderFromTo(),this.updateTotalSizeEmitter.fire({totalSize:this._contentSize,source:a?b.oz.RENDER:n})},t.setMaxVisibleHeight=function(e){this._maxVisibleHeight=e},t.setViewSize=function(e,t){void 0===t&&(t=b.oz.SLIENT);var r=Math.max(e,0);this._viewSize!==r&&(this._viewSize=r,this.checkOffset(t),this.calcRenderFromTo(),this.updateViewSizeEmitter.fire({viewSize:this._viewSize,source:t}))},t.setOffsetSize=function(e,t){void 0===t&&(t=b.oz.SLIENT),e=x(this._scale.scale,e,this._offsetSize),e=Math.max(e,0),e=Math.min(e,this._maxOffsetSize),this._offsetSize!==e?(this.offsetDiff=e-this._offsetSize,this._offsetSize=e,this.calcRenderFromTo(),this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:t})):this.offsetDiff=0},t.setDisplayPadding=function(e){this._displayPadding=e,this.checkOffset(b.oz.SLIENT),this.calcRenderFromTo(),this.updatePaddingEmitter.fire(this._padding)},t.setDisplaySafeDistance=function(e){this._displaySafeDistance=e,this.checkOffset(b.oz.SLIENT),this.calcRenderFromTo(),this.updateTotalSizeEmitter.fire({totalSize:this._contentSize,source:b.oz.SLIENT})},t.getAreaTop=function(e){return this._areaTop[e]},t.isValid=function(){return this._totalSize>0},t.getLastRowInView=function(){return this._renderFrom+T(this._areaTop)},t.refresh=function(){this._offsetSize=0,this._contentSize=0,this._viewSize=0,this._renderFrom=0,this._renderTo=0},t.calcRenderFromTo=function(){var e,t=this._to-this._from;if(t<0)this._renderTo=this._to;else if(0!==this._viewSize){var r=Math.min(this._viewSize,this._maxVisibleHeight-this._padding),i=!0,n=this._from,o=this._from;for(e=1;e<t+1;e++)if(this._offsetSize<this._areaTop[e]){n=this._from+e-1;break}for(;e<=t;e++)if(this._offsetSize+r<=this._areaTop[e]){o=this._from+e-1,i=!1;break}i&&(o=this._to),this._renderFrom=n,this._renderTo=o}},t.setFromTo=function(e,t){this._from=e,this._to=t},t.calcAreaTop=function(e,t){void 0===t&&(t=0);var r=0;this._areaTop.length=0;for(var i=this._from;i<=this._to;i++)this._areaTop.push(r),e.isRowHidden(i)||(r+=e.getRowDisplayHeight(i));this._areaTop.push(r),r>0&&(r+=t),this._contentSize=r},t.calcOffsetSize=function(e){return this.areaType===I.FLOW?this._offsetSize=this._areaTop[this._renderFrom]+e:this.areaType===I.FROZEN&&(this._offsetSize=this._areaTop[this._to+1]-this._viewSize),this.checkOffset(b.oz.RENDER)},t.checkOffset=function(e){var t=!1;return this._offsetSize<0&&(this._offsetSize=0,t=!0),(isNaN(this._offsetSize)||this._offsetSize>this._maxOffsetSize)&&(this._offsetSize=this._maxOffsetSize,t=!0),t&&this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:e}),t},(0,n.Z)(e,[{key:"_totalSize",get:function(){return this._contentSize+this._safeDistance}},{key:"_maxOffsetSize",get:function(){return Math.max(0,this._totalSize+this._padding-this._viewSize)}},{key:"_padding",get:function(){return this._displayPadding/this._scale.scale}},{key:"_safeDistance",get:function(){return this._displaySafeDistance/this._scale.scale}},{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"renderFrom",get:function(){return this._renderFrom}},{key:"renderTo",get:function(){return this._renderTo}},{key:"viewSize",get:function(){return this._viewSize}},{key:"displayViewSize",get:function(){return this._viewSize*this._scale.scale}},{key:"contentSize",get:function(){return this._contentSize}},{key:"totalSize",get:function(){return this._totalSize}},{key:"displayTotalSize",get:function(){return this._totalSize*this._scale.scale}},{key:"offsetSize",get:function(){return this._offsetSize}},{key:"displayOffsetSize",get:function(){return this._offsetSize*this._scale.scale}},{key:"padding",get:function(){return this._padding}},{key:"displayPadding",get:function(){return this._displayPadding}},{key:"safeDistance",get:function(){return this._safeDistance}},{key:"displaySafeDistance",get:function(){return this._displaySafeDistance}},{key:"maxOffsetSize",get:function(){return this._maxOffsetSize}},{key:"areaTop",get:function(){return this._areaTop}}]),e}(),$t=function(e){function t(t){var r;return(r=e.call(this)||this)._maxFrozenViewSize=null,r._maxVisibleHeight=0,r._scale=t.scale,r._maxVisibleHeight=t.maxVisibleHeight,r._frozen=new Qt({scale:r._scale,maxVisibleHeight:r._maxVisibleHeight,areaType:I.FROZEN}),r._flow=new Qt({scale:r._scale,maxVisibleHeight:r._maxVisibleHeight,areaType:I.FLOW}),r}(0,i.Z)(t,e);var r=t.prototype;return r.setMaxVisibleHeight=function(e){e/=this._scale.scale,this._maxVisibleHeight!==e&&(this._maxVisibleHeight=e,this._frozen.setMaxVisibleHeight(this._maxVisibleHeight),this._flow.setMaxVisibleHeight(this._maxVisibleHeight))},r.updateOffsetSize=function(e){this._flow.setOffsetSize(e)},r.set=function(e,t,r,i){this._frozen.set(e,0,t-1,t>0?f.kW:0,i),this._flow.set(e,t,r-1,void 0,i),this.updateViewSize()},r.getMaxHeight=function(){return this._maxVisibleHeight},r.setMaxFrozenViewSize=function(e,t){void 0===t&&(t=b.oz.USER),this._maxFrozenViewSize=e,this.updateViewSize(t)},r.refresh=function(){this._frozen.refresh(),this._flow.refresh()},r.updateViewSize=function(e){void 0===e&&(e=b.oz.SLIENT);var t=this._maxVisibleHeight,r=0;this._frozen.totalSize>0&&(r=null===this._maxFrozenViewSize?this._frozen.totalSize:Math.min(this._frozen.totalSize,this._maxFrozenViewSize)),this._frozen.setViewSize(r,e),t-=r,this._flow.setViewSize(t,e)},(0,n.Z)(t,[{key:"frozen",get:function(){return this._frozen}},{key:"flow",get:function(){return this._flow}}]),t}(l.JT),qt=function(){function e(e){this._renderFrom=0,this._renderTo=0,this._from=0,this._to=0,this._areaLeft=[],this._offsetSize=0,this._viewSize=0,this._contentSize=0,this._displaySafeDistance=0,this._displayPadding=0,this._maxVisibleWidth=0,this.updateOffsetEmitter=new A.Q5,this.updateViewSizeEmitter=new A.Q5,this.updateTotalSizeEmitter=new A.Q5,this.updatePaddingEmitter=new A.Q5,this._scale=e.scale,this._maxVisibleWidth=e.maxVisibleWidth,this.areaType=e.areaType,this.onUpdateOffset=this.updateOffsetEmitter.event,this.onUpdateViewSize=this.updateViewSizeEmitter.event,this.onUpdateTotalSize=this.updateTotalSizeEmitter.event,this.onUpdatePadding=this.updatePaddingEmitter.event}var t=e.prototype;return t.set=function(e,t,r,i,n){void 0===i&&(i=0),void 0===n&&(n=b.oz.SLIENT);var o=this._offsetSize-(this._areaLeft[this._renderFrom]||0);this.setFromTo(t,r),this.calcAreaLeft(e,i);var a=!1;0===this._offsetSize||Jt.isFullRender||(this.calcOffsetSize(o)||this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:b.oz.RENDER}),a=!0),this.calcRenderFromTo(),this.updateTotalSizeEmitter.fire({totalSize:this._contentSize,source:a?b.oz.RENDER:n})},t.setMaxVisibleWidth=function(e){this._maxVisibleWidth=e},t.setViewSize=function(e,t){void 0===t&&(t=b.oz.SLIENT);var r=Math.max(e,0);this._viewSize!==r&&(this._viewSize=r,this.checkOffset(t),this.calcRenderFromTo(),this.updateViewSizeEmitter.fire({viewSize:this._viewSize,source:t}))},t.setOffsetSize=function(e,t){void 0===t&&(t=b.oz.SLIENT),e=x(this._scale.scale,e,this._offsetSize),e=Math.max(e,0),e=Math.min(e,this._maxOffsetSize),this._offsetSize!==e?(this.offsetDiff=e-this._offsetSize,this._offsetSize=e,this.calcRenderFromTo(),this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:t})):this.offsetDiff=0},t.setDisplayPadding=function(e){this._displayPadding=e,this.checkOffset(b.oz.SLIENT),this.calcRenderFromTo(),this.updatePaddingEmitter.fire(this._padding)},t.setDisplaySafeDistance=function(e){this._displaySafeDistance=e,this.checkOffset(b.oz.SLIENT),this.calcRenderFromTo(),this.updateTotalSizeEmitter.fire({totalSize:this._contentSize,source:b.oz.SLIENT})},t.getAreaLeft=function(e){return this._areaLeft[e]},t.isValid=function(){return this._totalSize>0},t.getLastColInView=function(){return this._renderFrom+T(this._areaLeft)},t.refresh=function(){this._offsetSize=0,this._contentSize=0,this._viewSize=0,this._renderFrom=0,this._renderTo=0},t.calcRenderFromTo=function(){var e,t=this._to-this._from;if(t<0)this._renderTo=this._to;else if(0!==this._viewSize){var r=Math.min(this._viewSize,this._maxVisibleWidth-this._padding),i=!0,n=this._from,o=this._from;for(e=1;e<t+1;e++)if(this._offsetSize<this._areaLeft[e]){n=this._from+e-1;break}for(;e<=t;e++)if(this._offsetSize+r<=this._areaLeft[e]){o=this._from+e-1,i=!1;break}i&&(o=this._to),this._renderFrom=n,this._renderTo=o}},t.setFromTo=function(e,t){this._from=e,this._to=t},t.calcAreaLeft=function(e,t){void 0===t&&(t=0);var r=0;this._areaLeft.length=0;for(var i=this._from;i<=this._to;i++)this._areaLeft.push(r),e.isColHidden(i)||(r+=e.getColSetWidth(i));this._areaLeft.push(r),r>0&&(r+=t),this._contentSize=r},t.calcOffsetSize=function(e){return this.areaType===I.FLOW?this._offsetSize=this._areaLeft[this._renderFrom]+e:this.areaType===I.FROZEN&&(this._offsetSize=this._areaLeft[this._to+1]-this._viewSize),this.checkOffset(b.oz.RENDER)},t.checkOffset=function(e){var t=!1;return this._offsetSize<0&&(this._offsetSize=0,t=!0),(isNaN(this._offsetSize)||this._offsetSize>this._maxOffsetSize)&&(this._offsetSize=this._maxOffsetSize,t=!0),t&&this.updateOffsetEmitter.fire({offsetSize:this._offsetSize,source:e}),t},(0,n.Z)(e,[{key:"_totalSize",get:function(){return this._contentSize+this._safeDistance}},{key:"_maxOffsetSize",get:function(){return Math.max(0,this._totalSize+this._padding-this._viewSize)}},{key:"_padding",get:function(){return this._displayPadding/this._scale.scale}},{key:"_safeDistance",get:function(){return this._displaySafeDistance/this._scale.scale}},{key:"from",get:function(){return this._from}},{key:"to",get:function(){return this._to}},{key:"renderFrom",get:function(){return this._renderFrom}},{key:"renderTo",get:function(){return this._renderTo}},{key:"viewSize",get:function(){return this._viewSize}},{key:"displayViewSize",get:function(){return this._viewSize*this._scale.scale}},{key:"contentSize",get:function(){return this._contentSize}},{key:"totalSize",get:function(){return this._totalSize}},{key:"displayTotalSize",get:function(){return this._totalSize*this._scale.scale}},{key:"offsetSize",get:function(){return this._offsetSize}},{key:"displayOffsetSize",get:function(){return this._offsetSize*this._scale.scale}},{key:"padding",get:function(){return this._padding}},{key:"displayPadding",get:function(){return this._displayPadding}},{key:"safeDistance",get:function(){return this._safeDistance}},{key:"displaySafeDistance",get:function(){return this._displaySafeDistance}},{key:"maxOffsetSize",get:function(){return this._maxOffsetSize}},{key:"areaLeft",get:function(){return this._areaLeft}}]),e}(),er=function(e){function t(t){var r;return(r=e.call(this)||this)._maxFrozenViewSize=null,r._maxVisibleWidth=0,r._scale=t.scale,r._maxVisibleWidth=t.maxVisibleWidth,r._frozen=new qt({scale:r._scale,maxVisibleWidth:r._maxVisibleWidth,areaType:I.FROZEN}),r._flow=new qt({scale:r._scale,maxVisibleWidth:r._maxVisibleWidth,areaType:I.FLOW}),r}(0,i.Z)(t,e);var r=t.prototype;return r.setMaxVisibleWidth=function(e){e/=this._scale.scale,this._maxVisibleWidth!==e&&(this._maxVisibleWidth=e,this._frozen.setMaxVisibleWidth(this._maxVisibleWidth),this._flow.setMaxVisibleWidth(this._maxVisibleWidth))},r.updateOffsetSize=function(e){this._flow.setOffsetSize(e)},r.set=function(e,t,r,i){this._frozen.set(e,0,t-1,t>0?f.kW:0,i),this._flow.set(e,t,r-1,void 0,i),this.updateViewSize()},r.getMaxWidth=function(){return this._maxVisibleWidth},r.setMaxFrozenViewSize=function(e,t){void 0===t&&(t=b.oz.SLIENT),this._maxFrozenViewSize=e,this.updateViewSize(t)},r.refresh=function(){this._frozen.refresh(),this._flow.refresh()},r.updateViewSize=function(e){void 0===e&&(e=b.oz.SLIENT);var t=this._maxVisibleWidth,r=0;this._frozen.totalSize>0&&(r=null===this._maxFrozenViewSize?this._frozen.totalSize:Math.min(this._frozen.totalSize,this._maxFrozenViewSize)),this._frozen.setViewSize(r,e),t-=r,this._flow.setViewSize(t,e)},(0,n.Z)(t,[{key:"frozen",get:function(){return this._frozen}},{key:"flow",get:function(){return this._flow}}]),t}(l.JT),tr=function(e){function t(t){var r;return(r=e.call(this)||this).updateOffsetEmitter=new A.Q5,r._updateOffsetHandler=(0,We.ad)((function(e){r.updateOffsetEmitter.fire(e)})),r.refreshRow=function(e,t){e&&!r.isCurrentSheet(e)||r._row.set(r._rowcolAccessor,r._rowcolAccessor.getFrozenRowCount(),r._rowcolAccessor.getRowCount(),t)},r.refreshCol=function(e,t){e&&!r.isCurrentSheet(e)||r._col.set(r._rowcolAccessor,r._rowcolAccessor.getFrozenColCount(),r._rowcolAccessor.getColCount(),t)},r._updateFreeze=function(e){r.isCurrentSheet({sheetId:e})&&(r.refreshRow(),r.refreshCol(),r._col.frozen.setOffsetSize(r._col.frozen.totalSize),r._row.frozen.setOffsetSize(r._row.frozen.totalSize))},r.onResize=function(){r.refreshVisibleArea(),r._row.updateViewSize(),r._col.updateViewSize()},r.onScale=function(){r.refreshVisibleArea(),r.refreshRow(void 0,b.oz.USER),r.refreshCol(void 0,b.oz.USER),r._col.updateOffsetSize(r._col.flow.offsetSize),r._row.updateOffsetSize(r._row.flow.offsetSize)},r._spreadsheet=t.spreadsheet,r._clientRect=t.clientRect,r._rowcolAccessor=t.rowcolAccessor,r._headSize=t.headSize,r._dataCallView=t.dataCallView,r._resize=t.resize,r._scale=t.scale,r.onUpdateOffset=r.updateOffsetEmitter.event,r._row=r._register(new $t({scale:r._scale,maxVisibleHeight:r._clientRect.height-r._headSize.displayColHeadHeight})),r._col=r._register(new er({scale:r._scale,maxVisibleWidth:r._clientRect.width-r._headSize.displayRowHeadWidth})),r.refreshRow(),r.refreshCol(),"undefined"!==typeof window&&(r._register(r._resize.onResize(r.onResize)),r._register(r._scale.onScale(r.onScale))),r._register(r._row.frozen.onUpdateOffset(r._updateOffsetHandler)),r._register(r._row.flow.onUpdateOffset(r._updateOffsetHandler)),r._register(r._col.frozen.onUpdateOffset(r._updateOffsetHandler)),r._register(r._col.flow.onUpdateOffset(r._updateOffsetHandler)),r._register(r._dataCallView.onInsertRow((0,We.ad)(r.refreshRow))),r._register(r._dataCallView.onDeleteRow((0,We.ad)(r.refreshRow))),r._register(r._dataCallView.onSetRowVisible((0,We.ad)(r.refreshRow))),r._register(r._dataCallView.onSetRowHeight((0,We.ad)(r.refreshRow))),r._register(r._dataCallView.onInsertCol((0,We.ad)(r.refreshCol))),r._register(r._dataCallView.onDeleteCol((0,We.ad)(r.refreshCol))),r._register(r._dataCallView.onSetColWidth((0,We.ad)(r.refreshCol))),r._register(r._dataCallView.onSetColVisible((0,We.ad)(r.refreshCol))),r._register(r._dataCallView.onUpdateFreeze(r._updateFreeze)),r}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this.refreshVisibleArea(),this._row.refresh(),this._col.refresh(),this.refreshRow(),this.refreshCol()},r.getAreaTopByRow=function(e){return e<=this._row.frozen.to?this._row.frozen.getAreaTop(e):this._row.flow.getAreaTop(e-(this._row.frozen.to-this._row.frozen.from+1))},r.getAreaLeftByCol=function(e){return e<=this._col.frozen.to?this._col.frozen.getAreaLeft(e):this._col.flow.getAreaLeft(e-(this._col.frozen.to-this._row.frozen.from+1))},r.getDisplayGlobalTopByRow=function(e){return this.getGlobalTopByRow(e)*this._scale.scale},r.getGlobalTopByRow=function(e){return e<=this._row.frozen.to?this._row.frozen.getAreaTop(e):this._row.flow.getAreaTop(e-(this._row.frozen.to-this._row.frozen.from+1))+this._row.frozen.totalSize},r.getDisplayGlobalBottomByRow=function(e){return this.getGlobalBottomByRow(e)*this._scale.scale},r.getGlobalBottomByRow=function(e){var t=this.getGlobalTopByRow(e+1);return e===this._row.frozen.to&&(t-=f.kW),t},r.getDisplayGlobalLeftByCol=function(e){return this.getGlobalLeftByCol(e)*this._scale.scale},r.getGlobalLeftByCol=function(e){return e<=this._col.frozen.to?this._col.frozen.getAreaLeft(e):this._col.flow.getAreaLeft(e-(this._col.frozen.to-this._row.frozen.from+1))+this._col.frozen.totalSize},r.getDisplayGlobalRightByCol=function(e){return this.getGlobalRightByCol(e)*this._scale.scale},r.getGlobalRightByCol=function(e){var t=this.getGlobalLeftByCol(e+1);return e===this._col.frozen.to&&(t-=f.kW),t},r.getDisplayViewTopByRow=function(e){return this.getViewTopByRow(e)*this._scale.scale},r.getViewTopByRow=function(e){var t=this.getAreaTopByRow(e);return e<=this._row.frozen.to?t-this._row.frozen.offsetSize:t-this._row.flow.offsetSize+this._row.frozen.viewSize},r.getDisplayViewBottomByRow=function(e){return this.getViewBottomByRow(e)*this._scale.scale},r.getViewBottomByRow=function(e){return e===this._row.frozen.to?this._row.frozen.viewSize:this.getViewTopByRow(e+1)},r.getDisplayViewLeftByCol=function(e){return this.getViewLeftByCol(e)*this._scale.scale},r.getViewLeftByCol=function(e){var t=this.getAreaLeftByCol(e);return e<=this._col.frozen.to?t-this._col.frozen.offsetSize:t-this._col.flow.offsetSize+this._col.frozen.viewSize},r.getDisplayViewRightByCol=function(e){return this.getViewRightByCol(e)*this._scale.scale},r.getViewRightByCol=function(e){return e===this._col.frozen.to?this._col.frozen.viewSize:this.getViewLeftByCol(e+1)},r.getRowByDisplayViewTop=function(e){return e/=this._scale.scale,this.getRowByViewTop(e)},r.getRowByViewTop=function(e){var t;if(e>=0&&e<this._row.frozen.viewSize){for(e+=this._row.frozen.offsetSize,t=this._row.frozen.renderFrom+1;t<=this._row.frozen.to;){if(e<this._row.frozen.getAreaTop(t))return t-1;t+=1}return t-1}if((e=e-this._row.frozen.viewSize+this._row.flow.offsetSize)<this._row.flow.contentSize){for(t=this._row.flow.renderFrom+1;t<=this._row.flow.to;){if(e<this._row.flow.getAreaTop(t-(this._row.frozen.to-this._row.frozen.from+1)))return t-1;t+=1}return t-1}return this._spreadsheet.activeSheet.getRowCount()-1},r.getRowByDisplayGlobalTop=function(e){return e/=this._scale.scale,this.getRowByGlobalTop(e)},r.getRowByGlobalTop=function(e){var t;if(e>=0&&e<this._row.frozen.totalSize){for(t=this._row.frozen.from+1;t<=this._row.frozen.to;){if(e<this._row.frozen.getAreaTop(t))return t-1;t+=1}return t-1}if((e-=this._row.frozen.totalSize)<this._row.flow.contentSize){for(t=this._row.flow.from+1;t<=this._row.flow.to;){if(e<this._row.flow.getAreaTop(t-(this._row.frozen.to-this._row.frozen.from+1)))return t-1;t+=1}return t-1}return this._spreadsheet.activeSheet.getRowCount()-1},r.getColByDisplayViewLeft=function(e){return e/=this._scale.scale,this.getColByViewLeft(e)},r.getColByViewLeft=function(e){var t;if(e>=0&&e<this._col.frozen.viewSize){for(e+=this._col.frozen.offsetSize,t=this._col.frozen.renderFrom+1;t<=this._col.frozen.to;){if(e<this._col.frozen.getAreaLeft(t))return t-1;t+=1}return t-1}if((e=e-this._col.frozen.viewSize+this._col.flow.offsetSize)<this._col.flow.contentSize){for(t=this._col.flow.renderFrom+1;t<=this._col.flow.to;){if(e<this._col.flow.getAreaLeft(t-(this._col.frozen.to-this._col.frozen.from+1)))return t-1;t+=1}return t-1}return this._spreadsheet.activeSheet.getColCount()-1},r.getColByDisplayGlobalLeft=function(e){return e/=this._scale.scale,this.getColByGlobalLeft(e)},r.getColByGlobalLeft=function(e){var t;if(e>=0&&e<this._col.frozen.totalSize){for(t=this._col.frozen.from+1;t<=this._col.frozen.to;){if(e<this._col.frozen.getAreaLeft(t))return t-1;t+=1}return t-1}if((e-=this._col.frozen.totalSize)<this._col.flow.contentSize){for(t=this._col.flow.from+1;t<=this._col.flow.to;){if(e<this._col.flow.getAreaLeft(t-(this._col.frozen.to-this._col.frozen.from+1)))return t-1;t+=1}return t-1}return this._spreadsheet.activeSheet.getColCount()-1},r.getFirstRowInView=function(){return this._row.frozen.viewSize>0?this._row.frozen.renderFrom:this._row.flow.renderFrom},r.getLastRowInView=function(){return this._row.flow.viewSize>0?this._row.flow.renderTo:this._row.frozen.renderTo},r.getFirstColInView=function(){return this._col.frozen.viewSize>0?this._col.frozen.renderFrom:this._col.flow.renderFrom},r.getLastColInView=function(){return this._col.flow.viewSize>0?this._col.flow.renderTo:this._col.frozen.renderTo},r.inFrozenRowArea=function(e){return this._row.frozen.from<=e&&e<=this._row.frozen.to},r.inFlowRowArea=function(e){return this._row.flow.from<=e&&e<=this._row.flow.to},r.inFrozenColArea=function(e){return this._col.frozen.from<=e&&e<=this._col.frozen.to},r.inFlowColArea=function(e){return this._col.flow.from<=e&&e<=this._col.flow.to},r.isCellVisiable=function(e,t){var r=this.inFrozenRowArea(e)?this._row.frozen:this._row.flow,i=this.inFrozenColArea(t)?this._col.frozen:this._col.flow;return e>=r.renderFrom&&e<=r.renderTo&&t>=i.renderFrom&&t<=i.renderTo},r.refreshVisibleArea=function(){this._row.setMaxVisibleHeight(this._clientRect.height-this._headSize.displayColHeadHeight),this._col.setMaxVisibleWidth(this._clientRect.width-this._headSize.displayRowHeadWidth)},r.isCurrentSheet=function(e){return e.sheetId===this._spreadsheet.activeSheetId},(0,n.Z)(t,[{key:"row",get:function(){return this._row}},{key:"col",get:function(){return this._col}}]),t}(l.JT),rr=function(e){function t(t,i){var n;return(n=e.call(this)||this).wrapper=t,n.resize=i,n.refresh=function(){var e=document.querySelector("#footerContainer"),t=(null===e||void 0===e?void 0:e.clientHeight)||0,i=n.wrapper.getBoundingClientRect().top;n.wrapper.style.height=r.g.innerHeight-i-t+"px";var o=n.container.getBoundingClientRect(),a=o.left,s=o.top,l=o.width,c=o.height;n.distanceX=a,n.distanceY=s,n.width=l,n.height=c},n.initContainer(),n.refresh(),n._register(n.resize.onResize(n.refresh)),n}return(0,i.Z)(t,e),t.prototype.initContainer=function(){this.container=document.createElement("div"),this.container.className="excel-container",this.container.setAttribute("tabIndex","3"),Object.assign(this.container.style,{width:"100%",height:"calc(100% - 1px)",transform:"scale(1)",overflow:"hidden","-webkit-transform":"scale(1)","transform-origin":"left top","-webkit-transform-origin":"left top","user-select":"none","-webkit-user-select":"none","background-color":"#F3F5F7","box-sizing":"border-box"}),this.wrapper.appendChild(this.container)},t}(l.JT),ir=function(){function e(e){this._rowHeadWidth=f.vf,this._colHeadHeight=f.gU,this._scale=e.scale}return(0,n.Z)(e,[{key:"displayRowHeadWidth",get:function(){return this._rowHeadWidth*this._scale.scale>>0}},{key:"displayColHeadHeight",get:function(){return this._colHeadHeight*this._scale.scale>>0}},{key:"rowHeadWidth",get:function(){return this._rowHeadWidth}},{key:"colHeadHeight",get:function(){return this._colHeadHeight}}]),e}(),nr=function(e){function t(){var t;if((t=e.call(this)||this).preInnerWidth=r.g.innerWidth,t.preInnerHeight=r.g.innerHeight,t.resize=function(){t.handleResize()},t.onPixelRatioChange=function(){t.devicePixelRatio!==r.g.devicePixelRatio&&(t.devicePixelRatio=r.g.devicePixelRatio,t.resize())},t.handleResize=function(){"visible"===r.g.document.visibilityState&&t.onResizeEmitter.fire()},t.onResizeEmitter=new A.Q5,t.onResize=t.onResizeEmitter.event,t.devicePixelRatio=r.g.devicePixelRatio,t.throttleHandleResize=(0,We.Ic)((function(){t.checkWindowResize()&&t.handleResize()}),3e3),"undefined"!==typeof r.g.window){r.g.addEventListener("resize",t.throttleHandleResize),r.g.document.addEventListener("visibilitychange",t.handleResize);var i="(resolution: "+r.g.devicePixelRatio+"dppx)";window.matchMedia(i).addListener(t.onPixelRatioChange),je().isTencentDocsApp&&je().isIPad&&t.throttleHandleResize()}return t}(0,i.Z)(t,e);var n=t.prototype;return n.dispose=function(){if(e.prototype.dispose.call(this),"undefined"!==typeof r.g.window){r.g.removeEventListener("resize",this.throttleHandleResize),r.g.document.removeEventListener("visibilitychange",this.handleResize);var t="(resolution: "+r.g.devicePixelRatio+"dppx)";r.g.matchMedia(t).removeListener(this.onPixelRatioChange)}},n.checkWindowResize=function(){return(this.preInnerHeight!==r.g.innerHeight||this.preInnerWidth!==r.g.innerWidth)&&(this.preInnerWidth=r.g.innerWidth,this.preInnerHeight=r.g.innerHeight,!0)},t}(l.JT),or=(r(48845),r(31575),r(5570),r(64656),r(43125),r(27849),r(11425),r(89334));function ar(e,t,r,i,n){if(e!==t){var o=t-e>0?r:-r,a=1.5*r,s=e;!function e(){if(o>0&&Math.abs(s)>Math.abs(t)-a||o<0&&Math.abs(s)<Math.abs(t)-a)return i(t-s),void(null===n||void 0===n||n());s+=o,i(o),requestAnimationFrame(e)}()}}function sr(){"use strict";sr=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(A){s=function(e,t,r){return e[t]=r}}function l(e,t,r,i){var n=t&&t.prototype instanceof d?t:d,o=Object.create(n.prototype),a=new E(i||[]);return o._invoke=function(e,t,r){var i="suspendedStart";return function(n,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===n)throw o;return{value:void 0,done:!0}}for(r.method=n,r.arg=o;;){var a=r.delegate;if(a){var s=C(a,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===i)throw i="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i="executing";var l=c(e,t,r);if("normal"===l.type){if(i=r.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(i="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(A){return{type:"throw",arg:A}}}e.wrap=l;var h={};function d(){}function u(){}function f(){}var g={};s(g,n,(function(){return this}));var _=Object.getPrototypeOf,p=_&&_(_(S([])));p&&p!==t&&r.call(p,n)&&(g=p);var v=f.prototype=d.prototype=Object.create(g);function w(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function i(n,o,a,s){var l=c(e[n],e,o);if("throw"!==l.type){var h=l.arg,d=h.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(d).then((function(e){h.value=e,a(h)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var n;this._invoke=function(e,r){function o(){return new t((function(t,n){i(e,r,t,n)}))}return n=n?n.then(o,o):o()}}function C(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=c(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function y(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function m(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(y,this),this.reset(!0)}function S(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:D}}function D(){return{value:void 0,done:!0}}return u.prototype=f,s(v,"constructor",f),s(f,"constructor",u),u.displayName=s(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},w(R.prototype),s(R.prototype,o,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,i,n,o){void 0===o&&(o=Promise);var a=new R(l(t,r,i,n),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(v),s(v,a,"Generator"),s(v,n,(function(){return this})),s(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var i=t.pop();if(i in e)return r.value=i,r.done=!1,r}return r.done=!0,r}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(m),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(r,i){return a.type="throw",a.arg=e,t.next=r,i&&(t.method="next",t.arg=void 0),!!i}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),m(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;m(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}var lr=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function a(e){try{l(i.next(e))}catch(t){o(t)}}function s(e){try{l(i.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},cr=function(){function e(){this._onScale=new A.Q5,this._matrix=new or.Z,this._scale=1,this.onScale=this._onScale.event}var t=e.prototype;return t.scaleTo=function(e,t){return void 0===t&&(t={}),lr(this,void 0,void 0,sr().mark((function r(){var i,n,o,a,s,l,c,h,d,u,f=this;return sr().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=(i=t).immediately,o=void 0===n||n,a=i.step,s=void 0===a?.08:a,l=i.frameCb,c=void 0===l?function(){}:l,h=i.endCb,d=void 0===h?function(){}:h,u=function(e){e(),d()},r.abrupt("return",new Promise((function(t){return f._scale===e?t():o?(c(),f._handleScale(e),void u(t)):void ar(f._scale,e,s,(function(e){c(),f._handleScale(f._scale+e)}),u.bind(f,t))})).catch((function(){})));case 3:case"end":return r.stop()}}),r)})))},t._handleScale=function(e){this._matrix.scale(e/this._scale,e/this._scale),this._scale=e,this._onScale.fire(this._scale)},(0,n.Z)(e,[{key:"scale",get:function(){return this._scale}},{key:"matrix",get:function(){return this._matrix}}]),e}(),hr=r(27869),dr=r(77876);function ur(e){return null===e||!(0,s.nv)(e).length}function fr(e){return null!==e&&!!e.getMergeReference()}var gr=r(82017),_r=function(e){function t(t){var i;return(i=e.call(this,t)||this).inputCoverData=[],i.inputCoverParent=[],i._calcRowCoverInfo=function(e,t){i._rowData[t]||i.init(t);var n=i._spreadsheet.sheetManager.getSheetBySheetId(t);if(n){i._resetRow(e,t);for(var o=i._rowcolAccessor.getColCount(t)-1,a=0;a<o;a++){var s=i.getCellDataAtPosition(e,a,n);if(s){var l=i._calcCellViewCover(s,e,a,t);l&&i._setCoverInfo(l,t)}}}else r.g.log.error("RowCoverAccessor _calcRowCoverInfo: sheetId is invalid")},i.getCellDataAtPosition=function(e,t,r){return i.shouldUseInputCellData(e,t)?i.inputCellData:r.getCellDataAtPosition(e,t)},i.shouldUseInputCellData=function(e,t){return i.inputCellData&&e===i.inputRow&&t===i.inputCol},i.shouldUseInputRowData=function(e){return i.inputCellData&&e===i.inputRow},i._paragraphAccessor=t.paragraphAccessor,i._rowcolAccessor=t.rowcolAccessor,i.init(i._spreadsheet.activeSheetId),i}(0,i.Z)(t,e);var n=t.prototype;return n.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length||this.init(e)},n.getCoverOffset=function(e,t,r){var i;if(this.shouldUseInputRowData(e)&&(null===(i=this.inputCoverData[e])||void 0===i?void 0:i[t]))return this._fromValue(this.inputCoverData[e][t]);var n=r||this._spreadsheet.activeSheetId;if(!this._rowData[n]||!this._rowData[n].cover_data[e])return null;var o=this._rowData[n].cover_data[e][t];return o?this._fromValue(o):null},n.getHiddenOffset=function(e,t,r){var i;if(this.shouldUseInputRowData(e)&&(null===(i=this.inputCoverParent[e])||void 0===i?void 0:i[t]))return this._fromValue(this.inputCoverParent[e][t]);if(!this._rowData[r]||!this._rowData[r].cover_parent[e])return null;var n=this._rowData[r].cover_parent[e][t];return n?this._fromValue(n):null},n.isCoverCell=function(e,t,r){var i;if(this.shouldUseInputRowData(e))return!!(null===(i=this.inputCoverData[e])||void 0===i?void 0:i[t]);var n=r||this._spreadsheet.activeSheetId;return!(!this._rowData[n]||!this._rowData[n].cover_data[e])&&!!this._rowData[n].cover_data[e][t]},n.isHiddenCell=function(e,t,r){var i;if(this.shouldUseInputRowData(e))return!!(null===(i=this.inputCoverParent[e])||void 0===i?void 0:i[t]);var n=r||this._spreadsheet.activeSheetId;return!(!this._rowData[n]||!this._rowData[n].cover_parent[e])&&!!this._rowData[n].cover_parent[e][t]},n.getHiddenCellParents=function(e,t,r){var i,n,o,a=r||this._spreadsheet.activeSheetId;if(!this.isHiddenCell(e,t,a))return null;var s=[];if(!(o=this.shouldUseInputRowData(e)&&(null===(i=this.inputCoverParent[e])||void 0===i?void 0:i[t])?this.inputCoverParent[e][t]:null===(n=this._rowData[a].cover_parent[e])||void 0===n?void 0:n[t]))return null;var l=this._fromValue(o);return l.leftOffset&&s.push({rowIndex:e,colIndex:t-l.leftOffset}),l.rightOffset&&s.push({rowIndex:e,colIndex:t+l.rightOffset}),s.length?s:null},n.setInputCellData=function(e,t,r){if(r){this.inputRow=e,this.inputCol=t,this.inputCellData=r;var i=this._spreadsheet.activeSheetId;this._resetRow(e,i);for(var n=this._rowcolAccessor.getColCount(i)-1,o=0;o<n;o++){var a=this.getCellDataAtPosition(e,o,this._spreadsheet.activeSheet);if(a){var s=this._calcCellViewCover(a,e,o,i);if(s){var l=s.coverPos,c=s.offset;this.inputCoverData[l.rowIndex]||(this.inputCoverData[l.rowIndex]={}),this.inputCoverData[l.rowIndex][l.colIndex]=this._toVale(c),this.setInputCellCoverData(c,l)}}}}else this.inputCellData=null},n.clearInputCellData=function(){this.inputRow=-1,this.inputCol=-1,this.inputCellData=null,this.inputCoverData=[],this.inputCoverParent=[]},n.init=function(e){var t,i=this.getTargetSheet(e);if(i){this._rowData[e]=((t={}).cover_data=[],t.cover_parent=[],t);var n=i.highWaterMark.getMark();r.g.log.info("fragmentRender RowCoverAccessor init, sheetId:"+e+" endRow:"+n);for(var o=0;o<=n;o++)this._calcRowCoverInfo(o,e)}else r.g.log.error("RowCoverAccessor _init: sheetId is invalid",e)},n.clear=function(e,t){var r=this;this._spreadsheet.sheetManager.getSheetBySheetId(e)&&t.forEach((function(t){for(var i=t.rowStart;i<=t.rowEnd;i++)r._resetRow(i,e)}))},n.calculateRange=function(e,t,r){for(var i=e||this._spreadsheet.activeSheetId,n=t;n<=r;n++)this._calcRowCoverInfo(n,i)},n.setInputCellCoverData=function(e,t){var r;if(e.leftOffset)for(r=t.colIndex-e.leftOffset;r<t.colIndex;r++)if(this.inputCoverParent[t.rowIndex]){var i=this.inputCoverParent[t.rowIndex][r];this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:(i||0)>>16,rightOffset:t.colIndex-r})}else this.inputCoverParent[t.rowIndex]={},this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:0,rightOffset:t.colIndex-r});if(e.rightOffset)for(r=t.colIndex+1;r<=t.colIndex+e.rightOffset;r++)if(this.inputCoverParent[t.rowIndex]){var n=this.inputCoverParent[t.rowIndex][r];this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:r-t.colIndex,rightOffset:n||0})}else this.inputCoverParent[t.rowIndex]={},this.inputCoverParent[t.rowIndex][r]=this._toVale({leftOffset:r-t.colIndex,rightOffset:0})},n._resetRow=function(e,t){this.inputCoverData[e]&&(this.inputCoverData[e]={}),this.inputCoverParent[e]&&(this.inputCoverParent[e]={}),this._rowData[t].cover_data[e]&&(this._rowData[t].cover_data[e]={}),this._rowData[t].cover_parent[e]&&(this._rowData[t].cover_parent[e]={})},n._toVale=function(e){return(e.leftOffset<<16)+e.rightOffset},n._fromValue=function(e){return{leftOffset:e>>16,rightOffset:65535&e}},n._setCoverInfo=function(e,t){var r,i=e.coverPos,n=e.offset;if(this._rowData[t].cover_data[i.rowIndex]||(this._rowData[t].cover_data[i.rowIndex]={}),this._rowData[t].cover_data[i.rowIndex][i.colIndex]=this._toVale(n),n.leftOffset)for(r=i.colIndex-n.leftOffset;r<i.colIndex;r++)if(this._rowData[t].cover_parent[i.rowIndex]){var o=this._rowData[t].cover_parent[i.rowIndex][r];this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:(o||0)>>16,rightOffset:i.colIndex-r})}else this._rowData[t].cover_parent[i.rowIndex]={},this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:0,rightOffset:i.colIndex-r});if(n.rightOffset)for(r=i.colIndex+1;r<=i.colIndex+n.rightOffset;r++)if(this._rowData[t].cover_parent[i.rowIndex]){var a=this._rowData[t].cover_parent[i.rowIndex][r];this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:r-i.colIndex,rightOffset:a||0})}else this._rowData[t].cover_parent[i.rowIndex]={},this._rowData[t].cover_parent[i.rowIndex][r]=this._toVale({leftOffset:r-i.colIndex,rightOffset:0})},n._calcCellViewCover=function(e,t,i,n){var o=this._spreadsheet.sheetManager.getSheetBySheetId(n);if(o){var a=this._paragraphAccessor.getParagraph(t,i,n);if(a&&!(e.getMergeReference()||(0,gr.l)(e)||this._rowcolAccessor.isColHidden(i,n))){var l,c=(0,s.PE)(e).value;l=c===p.Z.LEFT?(0,s.Hv)(e):c===p.Z.RIGHT?(0,s.Sb)(o,t,i,e):0;var h=a.width+l,d=function(e,t,r,i){var n=t.getMergeReference();if(!n)return e.getColSetWidth(r,i);for(var o=0,a=n.startColIndex;a<n.endColIndex;a++)e.isColHidden(a,i)||(o+=e.getColSetWidth(a,i));return o}(this._rowcolAccessor,e,i,n);if(!(h<d)){var u=this._calcOffset(c,h,d,t,i,n);return{coverPos:{rowIndex:t,colIndex:i},offset:{leftOffset:u.leftOffset,rightOffset:u.rightOffset}}}}}else r.g.log.error("RowCoverAccessor _calcCellViewCover: sheetId is invalid")},n._calcOffset=function(e,t,r,i,n,o){var a=0,s=0,l=(t-r)/2;switch(e){case p.Z.LEFT:s=this._extendCoverToRight(t-r,n,i,o);break;case p.Z.RIGHT:a=this._extendCoverToLeft(t-r,n,i,o);break;case p.Z.CENTER:a=this._extendCoverToLeft(l,n,i,o),s=this._extendCoverToRight(l,n,i,o)}return{leftOffset:a,rightOffset:s}},n._extendCoverToRight=function(e,t,i,n){var o=e,a=this._rowcolAccessor.getColCount(n),s=this._spreadsheet.sheetManager.getSheetBySheetId(n);if(!s)return r.g.log.error("RowCoverAccessor _extendCoverToRight: sheetId is invalid"),0;for(var l=1,c=t+l,h=this.getCellDataAtPosition(i,c,s);c<a&&o>0&&(ur(h)||this._rowcolAccessor.isColHidden(c,n))&&!fr(h);)o-=this._rowcolAccessor.isColHidden(c,n)?0:this._rowcolAccessor.getColSetWidth(c,n),c=t+(l+=1),h=this.getCellDataAtPosition(i,c,s);return l-=1},n._extendCoverToLeft=function(e,t,i,n){var o=e,a=this._spreadsheet.sheetManager.getSheetBySheetId(n);if(!a)return r.g.log.error("RowCoverAccessor _extendCoverToLeft: sheetId is invalid"),0;for(var s=1,l=t-s,c=this.getCellDataAtPosition(i,l,a);l>=0&&o>0&&(ur(c)||this._rowcolAccessor.isColHidden(l,n))&&!fr(c);)o-=this._rowcolAccessor.isColHidden(l,n)?0:this._rowcolAccessor.getColSetWidth(l,n),l=t-(s+=1),c=this.getCellDataAtPosition(i,l,a);return s-=1},t}(dr.Z),pr=_r,vr=r(3426),wr=r(72084),Rr=r(72413),Cr=r(13059);function yr(e){var t;return(null===e||void 0===e?void 0:e.getMergeReference())||(null===(t=null===e||void 0===e?void 0:e.getPivotTableRef())||void 0===t?void 0:t.viewMergeReference)}var mr,Er,Sr=function(e){function t(t){var i;return(i=e.call(this,t)||this).checkGridlines=function(e){i._rowData[e]||i.init(e);var t=i._spreadsheet.sheetManager.getSheetBySheetId(e);t?t.getHideGridlines()?f.t1.style=0:f.t1.style=3:r.g.log.error("BorderAccessor checkGridlines: sheetId is invalid")},i.calcRangeBorder=function(e,t,r,n,o){i._rowData[o]||i.init(o);for(var a=Math.max(0,e),s=Math.min(t,i.rowcolAccessor.getRowCount(o)-1),l=Math.max(0,r),c=Math.min(n,i.rowcolAccessor.getColCount(o)-1),h=a;h<=s;h++)if(!i.rowcolAccessor.isRowHidden(h,o))for(var d=l;d<=c;d++){var u=i.calcCellBorder(h,d,o);u&&(i._rowData[o].border_show_data[h]||(i._rowData[o].border_show_data[h]=[]),i._rowData[o].border_show_data[h][d]=u)}},i.rowCoverAccessor=t.rowCoverAccessor,i.rowcolAccessor=t.rowcolAccessor,i._spreadsheet=t.spreadsheet,i.init(i._spreadsheet.activeSheetId),i}(0,i.Z)(t,e);var n=t.prototype;return n.getBorder=function(e,t,r){var i=r||this._spreadsheet.activeSheetId;if(this._rowData[i]&&this._rowData[i].border_show_data[e])return this._rowData[i].border_show_data[e][t]},n.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length?this.checkGridlines(e):this.init(e)},n.init=function(e){var t;this._rowData[e]=((t={}).border_show_data=[],t);var i=this._spreadsheet.sheetManager.getSheetBySheetId(e);if(i){this.checkGridlines(e);var n=i.highWaterMark.getMark(),o=i.getColCount()-1;r.g.log.info("BorderAccessor init, sheetId:"+e+" endRow:"+n),this.calcRangeBorder(0,n,0,o,e)}else r.g.log.error("BorderAccessor init: sheetId is invalid")},n.clear=function(e,t){if(this._spreadsheet.sheetManager.getSheetBySheetId(e)){var r=this._rowData[e].border_show_data;t.forEach((function(e){for(var t=e.rowStart;t<=e.rowEnd;t++)r[t]&&(r[t]=[])}))}},n.calculateRange=function(e,t,i,n){var o=this._spreadsheet.sheetManager.getSheetBySheetId(e);if(o){var a=0,s=o.getColCount()-1;n&&(a=n[0],s=n[1]),this.calcRangeBorder(t,i,a,s,o.getSheetId())}else r.g.log.error("BorderAccessor calculateRange: sheetId is invalid",e)},n.calcCellBorder=function(e,t,i){var n=this._spreadsheet.sheetManager.getSheetBySheetId(i);if(n){var o=n.getCellDataAtPosition(e,t),a=this.transformBottom(n,o,e,t),s=function(e){return _e(e,"getBorderDiagUp")}(o),l=function(e){return _e(e,"getBorderDiagDown")}(o);return{right:this.isRightBorderHiddenByCoverCell(e,t,i)||this.isRightBorderHiddenInHiddenCell(e,t,i)?null:this.transformRight(n,o,e,t),bottom:a,diagUp:s,diagDown:l}}r.g.log.error("BorderAccessor calcCellBorder: sheetId is invalid")},n.isRightBorderHiddenByCoverCell=function(e,t,r){var i=this.rowCoverAccessor.getCoverOffset(e,t,r);if(!i)return!1;if(i.rightOffset)for(var n=i.rightOffset,o=t;n;){if(o+=1,!this.rowcolAccessor.isColHidden(o,r))return!0;n-=1}return!1},n.isRightBorderHiddenInHiddenCell=function(e,t,r){var i=this.rowCoverAccessor.getHiddenOffset(e,t,r);if(!i)return!1;if(i.rightOffset)return!0;if(i.leftOffset){var n=this.rowCoverAccessor.getCoverOffset(e,t-i.leftOffset,r);if(!n)return!1;if(i.leftOffset<n.rightOffset)return!0}return!1},n.transformRight=function(e,t,r,i){var n,o,a,s=yr(t);return s&&i<s.endColIndex&&(0,Rr.mt)(e,i,1)<=s.endColIndex?a=null:(n=function(e){return _e(e,"getBorderRight")}(t),o=function(e){return _e(e,"getBorderLeft")}((0,wr.Iv)(e,i,r)),a=pe(n,o,this._spreadsheet)>=0?(null===n||void 0===n?void 0:n.style)?n:f.t1:(null===o||void 0===o?void 0:o.style)?o:f.t1),a},n.transformBottom=function(e,t,r,i){var n,o,a,s=yr(t);return s&&r<s.endRowIndex&&(0,Rr.kI)(e,r,1)<=s.endRowIndex?a=null:(n=function(e){return _e(e,"getBorderBottom")}(t),o=function(e){return _e(e,"getBorderTop")}((0,wr.F5)(e,i,r)),a=pe(n,o,this._spreadsheet)>=0?(null===n||void 0===n?void 0:n.style)?n:f.t1:(null===o||void 0===o?void 0:o.style)?o:f.t1),a},t}(Cr.Z),Dr=r(35890),Ar=r(14682),xr=r(89815),Tr=function(){function e(e){this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.borderDiagUp=null,this.borderDiagDown=null,this.isCover=!1,this.coverParents=null,this.metadata=null,this.image=null,this.isDataValid=!0,this.isPrivate=!1,this.isCanNotRead=!1,this._cell=null,this._cell=e,this.background=e.style.background}return e.newInstance=function(t){var r=e._instance;return void 0===r?r=new e(t):(r._reset(),r._cell=t,r.background=t.style.background),e._instance=r,r},e.prototype._reset=function(){this._cell=null,this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.borderDiagUp=null,this.borderDiagDown=null,this.isCover=!1,this.coverParents=null,this.metadata=null,this.image=null,this.isDataValid=!0,this.isPrivate=!1,this.isCanNotRead=!1,this.filterIcon=null,this.pivotTableCollapseIcon=null},(0,n.Z)(e,[{key:"cell",get:function(){return this._cell}},{key:"wrapStrategy",get:function(){return this._cell.style.wrapStrategy}},{key:"mergeData",get:function(){if(this._cell.mergeData)return this._cell.mergeData}},{key:"mergeParent",get:function(){if(this._cell.mergeParent)return this._cell.mergeParent}},{key:"horizontalAlign",get:function(){return this._cell.style.horizontalAlign}},{key:"verticalAlign",get:function(){return this._cell.style.verticalAlign}}]),e}(),Ir=r(30494),br=r(81617),Or=r(24245),Lr=r(56873),Hr=r(38086),zr=function(){function e(e){var t=this;this._onCalcRowHeadStatus=new A.Q5,this.onCalcRowHeadStatus=this._onCalcRowHeadStatus.event,this._onCalcColHeadStatus=new A.Q5,this.onCalcColHeadStatus=this._onCalcColHeadStatus.event,this._dimensionMeta=new Ir.Z,this.getNormalClipInfo=function(e,r,i,n,o,a){var s=null;if(e){for(var l=0,c=0,h=1;h<=e.leftOffset;h++)l+=t.getColWidth(n-h);for(var d=1;d<=e.rightOffset;d++)c+=t.getColWidth(n+d);s=[r-l,i,l+o+c,a]}else s=[r,i,o,a];return s},this.isMergeCellNeedClip=function(e,t,r,i,n){return e.mergeData&&(t.width+i>r||t.height>n)},this.shouldUseInputCellData=function(e,r){return t.inputCellData&&e===t.inputRow&&r===t.inputCol},this.isNeedShowRightFilterBorder=function(e,t,r,i){var n=i.startRowIndex,o=i.endRowIndex,a=i.startColIndex,s=i.endColIndex;return e.right&&(r===a||r===s)&&t>n&&t<=o},this.isNeedShowBottomFilterBorder=function(e,t,r,i){var n=i.startRowIndex,o=i.endRowIndex,a=i.startColIndex,s=i.endColIndex;return e.bottom&&(t===n||t===o)&&r>a&&r<=s},this._tableView=e.tableView,this._rowcolAccessor=e.rowcolAccessor,this._rowCoverAccessor=e.rowCoverAccessor,this._paragraphAccessor=e.paragraphAccessor,this._borderAccessor=e.borderAccessor,this.spreadsheet=e.spreadsheet}var t=e.prototype;return t.getCellDataAtPosition=function(e,t){var r,i,n,a;if(this.shouldUseInputCellData(e,t))return this.getInputTransformCell(e,t);var s=this._tableView.getCellViewAtPosition(e,t);null===s&&(s=o.O);var l=Tr.newInstance(s),c=this._tableView.getIsCellPrivate(e,t);l.isPrivate=c;var h=this._tableView.getIsCellCanNotRead(e,t);l.isCanNotRead=h;var d=this._paragraphAccessor.getParagraph(e,t);l.lines=(0,br.r)(s,d,this._rowcolAccessor,e,t,c,h,this.spreadsheet);var u=this.getBorder(e,t);if(u&&(u.right&&(l.borderRight=u.right),u.bottom&&(l.borderBottom=u.bottom),u.diagUp&&(l.borderDiagUp=u.diagUp),u.diagDown&&(l.borderDiagDown=u.diagDown)),0===e){var f=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t),g=null===(i=null===(r=null===f||void 0===f?void 0:f.getUserEnteredFormat())||void 0===r?void 0:r.borders)||void 0===i?void 0:i.top;g&&(l.borderTop=g)}if(0===t){var _=this.spreadsheet.activeSheet.getCellDataAtPosition(e,t),p=null===(a=null===(n=null===_||void 0===_?void 0:_.getUserEnteredFormat())||void 0===n?void 0:n.borders)||void 0===a?void 0:a.left;p&&(l.borderLeft=p)}return l.isCover=this._rowCoverAccessor.isCoverCell(e,t),l.coverParents=this._rowCoverAccessor.getHiddenCellParents(e,t),l.metadata=this._tableView.getCellMetadata(e,t),l.image=this._tableView.getCellImage(e,t),l.isDataValid=this._tableView.getIsDataValid(e,t),l.dataBar=this._tableView.getDataBar(e,t),l.hyperlinkType=this._tableView.getCellHyperlinkType(e,t),l.hyperlink=this._tableView.getCellHyperlink(e,t),l.weworkCardIcon=this._tableView.getWeworkCardIcon(e,t),l.todoRange=this._tableView.getTodoRange(e,t),l.filterIcon=this._tableView.getFilterHeaderIcon(e,t),l.pivotTableCollapseIcon=this._tableView.getPivotTableCollapseIcon(e,t),l},t.getRowContent=function(e){return String(e+1)},t.getColContent=function(e){return(0,Lr.colIndex2ColChar)(e)},t.getRowMeta=function(e){return this._dimensionMeta.resize(e),this._onCalcRowHeadStatus.fire(this._dimensionMeta),(0,xr.Lg)(e,this._rowcolAccessor,this._dimensionMeta)},t.getColMeta=function(e){return this._dimensionMeta.resize(e),this._onCalcColHeadStatus.fire(this._dimensionMeta),(0,xr.Go)(e,this._rowcolAccessor,this._dimensionMeta)},t.getRowHeight=function(e){return this.isRowHidden(e)?0:this._rowcolAccessor.getRowDisplayHeight(e)},t.getColWidth=function(e){return this.isColHidden(e)?0:this._rowcolAccessor.getColSetWidth(e)},t.isRowHidden=function(e){return this._rowcolAccessor.isRowHidden(e)},t.isColHidden=function(e){return this._rowcolAccessor.isColHidden(e)},t.getRowCount=function(){return this._tableView.cellViews.length},t.getColCount=function(){return void 0===this._tableView.cellViews[0]?0:this._tableView.cellViews[0].length},t.getCellBackgroundWidth=function(e,t){return(0,Or.o)(this._rowcolAccessor,this._tableView.getCellViewAtPosition(e,t),t)},t.getCellBackgroundHeight=function(e,t){return(0,Or.E)(this._rowcolAccessor,this._tableView.getCellViewAtPosition(e,t),e)},t.getClipInfo=function(e,t,r,i,n,o){var a=null,s=this.getCellDataAtPosition(e,t),l=this._paragraphAccessor.getParagraph(e,t);if(!l)return a;var c=this._rowCoverAccessor.getCoverOffset(e,t),h=this.getCellOffset(s);return this.isMergeCellNeedClip(s,l,n,h,o)?a=[r,i,n,o]:(l.height>o||l.width+h>n||c)&&(a=this.getNormalClipInfo(c,r,i,t,n,o)),a},t.getVerticalBorderStyle=function(e,t){var r=this.getBorder(t,e);return(null===r||void 0===r?void 0:r.right)&&r.right.style||B.j2.NONE},t.getHorizontalBorderStyle=function(e,t){var r=this.getBorder(e,t);return(null===r||void 0===r?void 0:r.bottom)&&r.bottom.style||B.j2.NONE},t.getDiagBorderStyle=function(e,t,r){var i=this.getBorder(e,t);return r&&(null===i||void 0===i?void 0:i.diagUp)?i.diagUp.style||B.j2.NONE:!r&&(null===i||void 0===i?void 0:i.diagDown)&&i.diagDown.style||B.j2.NONE},t.getBorder=function(e,t){var r,i=this._borderAccessor.getBorder(e,t);if(!i)return{right:f.t1,bottom:f.t1,diagUp:null,diagDown:null};var n=this.getFilterVisibleBorderRange();if(n){var o=n.isFilterSync,a=null===(r=this.spreadsheet.activeSheet.getBasicFilter())||void 0===r?void 0:r.getIsLocalView(),s=a||!a&&!o?f.e6:f.ey;this.isNeedShowRightFilterBorder(i,e,t,n)&&(i.right=s),this.isNeedShowBottomFilterBorder(i,e,t,n)&&(i.bottom=s)}return i},t.refreshFilterVisibleBorderRange=function(){var e,t=this.spreadsheet,r=t.isFilterSync,i=t.activeSheet,n=null===(e=i.getBasicFilter())||void 0===e?void 0:e.range;if(n){var o=n.startRowIndex,a=n.startColIndex,s=n.endRowIndex,l=n.endColIndex;do{o-=1}while(o>=0&&i.isRowHidden(o));do{a-=1}while(o>=0&&i.isColHidden(a));for(;s>o&&i.isRowHidden(s);)s-=1;for(;l>a&&i.isColHidden(l);)l-=1;this.filterVisibleBorderRange={startRowIndex:o,endRowIndex:s,startColIndex:a,endColIndex:l,isFilterSync:r}}else this.filterVisibleBorderRange=null},t.setInputCellData=function(e,t,r){r?(this._paragraphAccessor.setInputCellData(e,t,r),this._rowCoverAccessor.setInputCellData(e,t,r),this._rowcolAccessor.setInputCellData(e,t,r),this.inputRow=e,this.inputCol=t,this.inputCellData=r):this.inputCellData=null},t.clearInputCellData=function(){this._paragraphAccessor.clearInputCellData(),this._rowCoverAccessor.clearInputCellData(),this._rowcolAccessor.clearInputCellData(),this.inputCellData=null},t.getInputTransformCell=function(e,t){var r,i=this._tableView._spreadsheet;r=this.inputCellData.getFormula()?new R(this.inputCellData,e,t,i):new o.Z(this.inputCellData,e,t,i);var n=(0,s.jl)(i.activeSheet,e,t,this.inputCellData),a=n.paddingLeft,l=n.paddingRight;r.paddingLeft=a,r.paddingRight=l;var c=Tr.newInstance(r),h=this._paragraphAccessor.getParagraph(e,t);c.lines=(0,br.r)(r,h,this._rowcolAccessor,e,t,!1,!1,this._tableView._spreadsheet);var d=this.getBorder(e,t);return d&&(d.right&&(c.borderRight=d.right),d.bottom&&(c.borderBottom=d.bottom),d.diagUp&&(c.borderDiagUp=d.diagUp),d.diagDown&&(c.borderDiagDown=d.diagDown)),c.isCover=this._rowCoverAccessor.isCoverCell(e,t),c.coverParents=this._rowCoverAccessor.getHiddenCellParents(e,t),c.metadata=this.inputCellData.getMetadata()||null,c.isDataValid=!!this.inputCellData.getIsDataValid(),c.dataBar=this.inputCellData.getDataBar(),c.hyperlinkType=this.inputCellData.getHyperlinkType(),c.hyperlink=this.inputCellData.getHyperlink(),c},t.getFilterVisibleBorderRange=function(){return this.filterVisibleBorderRange},t.getCellOffset=function(e){var t,r,i=null===(r=null===(t=e.lines)||void 0===t?void 0:t[0])||void 0===r?void 0:r.offsetX;if(!i)return i=0;if(i<0){if(e.horizontalAlign.value===Hr.HORIZONTAL_ALIGN.RIGHT)return Math.abs(i);i=0}return i},(0,n.Z)(e,[{key:"rowHeadWidth",get:function(){return f.vf}},{key:"colHeadHeight",get:function(){return f.gU}}]),e}(),Mr=zr,Br=function(e){function t(t){var r;(r=e.call(this)||this).onAfterRender=function(){var e=r._renderManager.alloyExcel;0!==r._areaData.col.frozen.displayViewSize&&(e.ctx.beginPath(),e.ctx.fillStyle="#d6d6d6",e.ctx.rect(r._headSize.rowHeadWidth+r._areaData.col.frozen.viewSize-f.kW,0,f.kW,r._headSize.colHeadHeight+r._areaData.getViewBottomByRow(r._areaData.getLastRowInView())),e.ctx.fill(),e.ctx.closePath()),0!==r._areaData.row.frozen.displayViewSize&&(e.ctx.beginPath(),e.ctx.fillStyle="#d6d6d6",e.ctx.rect(0,r._headSize.colHeadHeight+r._areaData.row.frozen.viewSize-f.kW,r._headSize.rowHeadWidth+r._areaData.getViewRightByCol(r._areaData.getLastColInView()),f.kW),e.ctx.fill(),e.ctx.closePath())},r._areaData=t.areaData,r._headSize=t.headSize,r._renderManager=t.renderManager;var i=r._renderManager.renderApi;return r._register(i.onAfterRender(r.onAfterRender)),r}return(0,i.Z)(t,e),t}(l.JT),Pr=function(e){function t(t){var r;return(r=e.call(this)||this).board=document.createElement("div"),r._container=t.container,r.board.classList.add("operate-board"),r.board.setAttribute("aria-hidden","true"),r.board.setAttribute("tabIndex","3"),r._container.appendChild(r.board),r}return(0,i.Z)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this.board)},t}(l.JT),Nr=(r(30980),r(16640),r(37108),r(28255),r(50104),r(25111),r(39585),r(77575),r(76880),r(11502),r(96434),r(3377),r(71318),r(21530),r(80828),r(77468),r(96172)),Vr=function(){function e(e){this.customInfo=new Map,this.startX=0,this.startY=0,this.startCol=0,this.startRow=0,this.currX=0,this.currY=0,this.currCol=0,this.currRow=0,this.diffX=0,this.diffY=0,this.startTime=0,this.endTime=0,this.fingerData=new Nr.Z,this.down=!1,this._stopPropagation=!1,this.isMovingRowOrCol=!1,this.preventAutoTapFocus=!1,this._scale=e.scale}var t=e.prototype;return t.mouseDown=function(e,t,r,i,n){this._start(e,t,r,i),this.e=n},t.mouseMove=function(e,t,r,i,n){this._move(e,t,r,i),this.e=n},t.mouseUp=function(e,t,r,i,n){this._end(e,t,r,i),this.e=n},t.touchStart=function(e,t,r,i,n){this._start(e,t,r,i),this.fingerData.startFirstFinger(e,t),this.e=n},t.touchSecondFingerStart=function(e,t){this.fingerData.startSecondFinger(e,t)},t.touchMove=function(e,t,r,i,n){this._move(e,t,r,i),this.fingerData.moveFirstFinger(e,t),this.e=n},t.touchSecondFingerMove=function(e,t){this.fingerData.moveSecondFinger(e,t)},t.touchEnd=function(e,t,r,i,n){this._end(e,t,r,i),this.fingerData.endUpdateFinger(n),this.e=n},t.isHoverCell=function(){return-1!==this.currCol&&this.currCol!==Number.MAX_SAFE_INTEGER&&this.currCol!==Number.MIN_SAFE_INTEGER&&-1!==this.currRow&&this.currRow!==Number.MAX_SAFE_INTEGER&&this.currRow!==Number.MIN_SAFE_INTEGER},t.isHoverCol=function(){return-1===this.currRow&&-1!==this.currCol},t.isHoverRow=function(){return-1===this.currCol&&-1!==this.currRow},t.isOverTable=function(){return this.currCol===Number.MAX_SAFE_INTEGER||this.currCol===Number.MIN_SAFE_INTEGER||this.currRow===Number.MAX_SAFE_INTEGER||this.currRow===Number.MIN_SAFE_INTEGER},t.toString=function(){var e=this.startRow,t=this.startCol,r=this.currRow,i=this.currCol;return JSON.stringify({startRow:e,startCol:t,currRow:r,currCol:i})},t._start=function(e,t,r,i){this.stopPropagation=!1,this.customInfo.clear(),this.currX=e,this.startX=e,this.currY=t,this.startY=t,this.currCol=r,this.startCol=r,this.currRow=i,this.startRow=i,this.down=!0,this.preventAutoTapFocus=!1,this.startTime=Date.now()},t._move=function(e,t,r,i){this.diffX=e-this.currX,this.diffY=t-this.currY,this.currX=e,this.currY=t,this.currCol=r,this.currRow=i},t._end=function(e,t,r,i){this.currX=e,this.currY=t,this.currCol=r,this.currRow=i,this.down=!1,this.isMovingRowOrCol=!1,this.endTime=Date.now()},(0,n.Z)(e,[{key:"displayStartX",get:function(){return this.startX*this._scale.scale}},{key:"displayStartY",get:function(){return this.startY*this._scale.scale}},{key:"displayCurrX",get:function(){return this.currX*this._scale.scale}},{key:"displayCurrY",get:function(){return this.currY*this._scale.scale}},{key:"stopPropagation",get:function(){return this._stopPropagation},set:function(e){this._stopPropagation=e}}]),e}();!function(e){e[e.DOWN=0]="DOWN",e[e.MOVE=1]="MOVE",e[e.UP=2]="UP"}(mr||(mr={})),function(e){e[e.START=0]="START",e[e.MOVE=1]="MOVE",e[e.END=2]="END"}(Er||(Er={}));var Fr=new(function(){function e(){var e=this;this.mouseHandlers=new Map,this.touchHandlers=new Map,this._handleMousedown=function(t){var r=e.mouseHandlers.get(mr.DOWN);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleMousemove=function(t){var r=e.mouseHandlers.get(mr.MOVE);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleMouseup=function(t){var r=e.mouseHandlers.get(mr.UP);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleTouchstart=function(t){var r=e.touchHandlers.get(Er.START);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleTouchmove=function(t){var r=e.touchHandlers.get(Er.MOVE);null===r||void 0===r||r.forEach((function(e){e(t)}))},this._handleTouchend=function(t){var r=e.touchHandlers.get(Er.END);null===r||void 0===r||r.forEach((function(e){e(t)}))},document.addEventListener("mousedown",this._handleMousedown,!0),document.addEventListener("mousemove",this._handleMousemove,!0),document.addEventListener("mouseup",this._handleMouseup,!0),document.addEventListener("touchstart",this._handleTouchstart,!0),document.addEventListener("touchmove",this._handleTouchmove,!0),document.addEventListener("touchend",this._handleTouchend,!0)}var t=e.prototype;return t.addMousedownHandler=function(e){this._addMouseHandler(mr.DOWN,e)},t.removeMousedownHandler=function(e){this._removeMouseHandler(mr.DOWN,e)},t.addMousemoveHandler=function(e){this._addMouseHandler(mr.MOVE,e)},t.removeMousemoveHandler=function(e){this._removeMouseHandler(mr.MOVE,e)},t.addMouseupHandler=function(e){this._addMouseHandler(mr.UP,e)},t.removeMouseupHandler=function(e){this._removeMouseHandler(mr.UP,e)},t.addTouchstartHandler=function(e){this._addTouchHandler(Er.START,e)},t.removeTouchstartHandler=function(e){this._removeTouchHandler(Er.START,e)},t.addTouchmoveHandler=function(e){this._addTouchHandler(Er.MOVE,e)},t.removeTouchmoveHandler=function(e){this._removeTouchHandler(Er.MOVE,e)},t.addTouchendHandler=function(e){this._addTouchHandler(Er.END,e)},t.removeTouchendHandler=function(e){this._removeTouchHandler(Er.END,e)},t._addMouseHandler=function(e,t){this.mouseHandlers.has(e)||this.mouseHandlers.set(e,[]),this.mouseHandlers.get(e).push(t)},t._removeMouseHandler=function(e,t){var r=this.mouseHandlers.get(e);if(r){var i=r.indexOf(t);i>=0?r.splice(i,1):console.warn("尝试移除没有绑定的 MouseHandler")}else console.warn("尝试移除没有绑定的 MouseHandler")},t._addTouchHandler=function(e,t){this.touchHandlers.has(e)||this.touchHandlers.set(e,[]),this.touchHandlers.get(e).push(t)},t._removeTouchHandler=function(e,t){var r=this.touchHandlers.get(e);if(r){var i=r.indexOf(t);i>=0?r.splice(i,1):console.warn("尝试移除没有绑定的 MouseHandler")}else console.warn("尝试移除没有绑定的 MouseHandler")},e}()),Zr=function(e){function t(t){var r;return(r=e.call(this)||this)._cacheHoverData={x:0,y:0,col:0,row:0},r._handleMousedown=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.clientX,e.clientY),r._operateData.mouseDown(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._handleMousemove=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.clientX,e.clientY),r._operateData.mouseMove(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._handleMouseup=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.clientX,e.clientY),r._operateData.mouseUp(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._clientRect=t.clientRect,r._headSize=t.headSize,r._areaData=t.areaData,r._scale=t.scale,r._operateData=t.operateData,r.spreadsheet=t.spreadsheet,Fr.addMousedownHandler(r._handleMousedown),Fr.addMousemoveHandler(r._handleMousemove),Fr.addMouseupHandler(r._handleMouseup),r}(0,i.Z)(t,e);var r=t.prototype;return r.dispose=function(){e.prototype.dispose.call(this),Fr.removeMousedownHandler(this._handleMousedown),Fr.removeMousemoveHandler(this._handleMousemove),Fr.removeMouseupHandler(this._handleMouseup)},r.calcHoverData=function(e,t){var r,i;e>this._clientRect.width?r=Number.MAX_SAFE_INTEGER:e<this._clientRect.distanceX?r=Number.MIN_SAFE_INTEGER:e<this._clientRect.distanceX+this._headSize.displayRowHeadWidth&&(r=-1),t>this._clientRect.distanceY+this._clientRect.height?i=Number.MAX_SAFE_INTEGER:t<this._clientRect.distanceY?i=Number.MIN_SAFE_INTEGER:t<this._clientRect.distanceY+this._headSize.displayColHeadHeight&&(i=-1);var n=this._scale.scale,o=t-this._clientRect.distanceY-this._headSize.displayColHeadHeight,a=e-this._clientRect.distanceX-this._headSize.displayRowHeadWidth;return isNaN(Number(r))&&isNaN(Number(i))?(i=this._areaData.getRowByDisplayViewTop(o),r=this._areaData.getColByDisplayViewLeft(a)):isNaN(Number(i))?i=this._areaData.getRowByDisplayViewTop(o):isNaN(Number(r))&&(r=this._areaData.getColByDisplayViewLeft(a)),{col:r,row:i,x:(e-this._clientRect.distanceX)/n,y:(t-this._clientRect.distanceY)/n}},r._updateHoverData=function(e,t){var r=this.calcHoverData(e,t),i=r.x,n=r.y,o=r.row,a=r.col;this._cacheHoverData.x=i,this._cacheHoverData.y=n,this._cacheHoverData.col=a,this._cacheHoverData.row=o},t}(l.JT),kr=Zr,Ur=function(e){function t(t){var r;return(r=e.call(this)||this)._cacheHoverData={x:0,y:0,col:0,row:0},r._handleTouchstart=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.touches[0].clientX,e.touches[0].clientY),r._operateData.touchStart(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e),e.touches.length>1&&(r._updateHoverData(e.touches[1].clientX,e.touches[1].clientY),r._operateData.touchSecondFingerStart(r._cacheHoverData.x,r._cacheHoverData.y)))},r._handleTouchmove=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.touches[0].clientX,e.touches[0].clientY),r._operateData.touchMove(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e),e.touches.length>1&&(r._updateHoverData(e.touches[1].clientX,e.touches[1].clientY),r._operateData.touchSecondFingerMove(r._cacheHoverData.x,r._cacheHoverData.y)))},r._handleTouchend=function(e){var t;(null===(t=r.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(r._updateHoverData(e.changedTouches[0].clientX,e.changedTouches[0].clientY),1===e.touches.length?r._updateHoverData(e.touches[0].clientX,e.touches[0].clientY):r._updateHoverData(e.changedTouches[0].clientX,e.changedTouches[0].clientY),r._operateData.touchEnd(r._cacheHoverData.x,r._cacheHoverData.y,r._cacheHoverData.col,r._cacheHoverData.row,e))},r._clientRect=t.clientRect,r._headSize=t.headSize,r._areaData=t.areaData,r._scale=t.scale,r._operateData=t.operateData,r.spreadsheet=t.spreadsheet,Fr.addTouchstartHandler(r._handleTouchstart),Fr.addTouchmoveHandler(r._handleTouchmove),Fr.addTouchendHandler(r._handleTouchend),r}(0,i.Z)(t,e);var r=t.prototype;return r.dispose=function(){e.prototype.dispose.call(this),Fr.removeTouchstartHandler(this._handleTouchstart),Fr.removeTouchmoveHandler(this._handleTouchmove),Fr.removeTouchendHandler(this._handleTouchend)},r._updateHoverData=function(e,t){var r,i;e>this._clientRect.width?r=Number.MAX_SAFE_INTEGER:e<this._clientRect.distanceX?r=Number.MIN_SAFE_INTEGER:e<this._clientRect.distanceX+this._headSize.displayRowHeadWidth&&(r=-1),t>this._clientRect.distanceY+this._clientRect.height?i=Number.MAX_SAFE_INTEGER:t<this._clientRect.distanceY?i=Number.MIN_SAFE_INTEGER:t<this._clientRect.distanceY+this._headSize.displayColHeadHeight&&(i=-1);var n=this._scale.scale,o=t-this._clientRect.distanceY-this._headSize.displayColHeadHeight,a=e-this._clientRect.distanceX-this._headSize.displayRowHeadWidth;isNaN(Number(r))&&isNaN(Number(i))?(i=this._areaData.getRowByDisplayViewTop(o),r=this._areaData.getColByDisplayViewLeft(a)):isNaN(Number(i))?i=this._areaData.getRowByDisplayViewTop(o):isNaN(Number(r))&&(r=this._areaData.getColByDisplayViewLeft(a)),this._cacheHoverData.x=(e-this._clientRect.distanceX)/n,this._cacheHoverData.y=(t-this._clientRect.distanceY)/n,this._cacheHoverData.col=r,this._cacheHoverData.row=i},t}(l.JT),Wr=Ur,Gr=function(e){function t(t){var i;return(i=e.call(this)||this).onMousedownEmitter=new A.Q5,i.onMousemoveEmitter=new A.Q5,i.onMouseupEmitter=new A.Q5,i.onContextMenuEmitter=new A.Q5,i.onDblClickEmitter=new A.Q5,i.onClickEmitter=new A.Q5,i.handleMousedown=function(){var e,t;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||(null===(t=r.g.log)||void 0===t||t.info("view canvas mousedown: "+i.operateData.toString()),i.onMousedownEmitter.fire(i.operateData))},i.handleMousemove=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onMousemoveEmitter.fire(i.operateData)},i.handleMouseup=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onMouseupEmitter.fire(i.operateData)},i.handleContextMenu=function(e){var t;(null===(t=i.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(e.preventDefault(),i.onContextMenuEmitter.fire(i.operateData))},i.handleDblClick=function(e){var t,n;(null===(t=i.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(null===(n=r.g.log)||void 0===n||n.info("view canvas dblclick: "+i.operateData.toString()),e.preventDefault(),i.onDblClickEmitter.fire(i.operateData))},i.handleClick=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onClickEmitter.fire(i.operateData)},i.onMousedown=i.onMousedownEmitter.event,i.onMousemove=i.onMousemoveEmitter.event,i.onMouseup=i.onMouseupEmitter.event,i.onContextMenu=i.onContextMenuEmitter.event,i.onDblClick=i.onDblClickEmitter.event,i.onClick=i.onClickEmitter.event,i.board=t.board,i.operateData=t.operateData,i.spreadsheet=t.spreadsheet,i.addEvent(),i}(0,i.Z)(t,e);var n=t.prototype;return n.addEvent=function(){this.board.addEventListener("mousedown",this.handleMousedown),document.addEventListener("mousemove",this.handleMousemove),document.addEventListener("mouseup",this.handleMouseup),this.board.addEventListener("contextmenu",this.handleContextMenu),this.board.addEventListener("dblclick",this.handleDblClick),this.board.addEventListener("click",this.handleClick)},n.removeEvent=function(){this.board.removeEventListener("mousedown",this.handleMousedown),document.removeEventListener("mousemove",this.handleMousemove),document.removeEventListener("mouseup",this.handleMouseup),this.board.removeEventListener("contextmenu",this.handleContextMenu),this.board.removeEventListener("dblclick",this.handleDblClick),this.board.removeEventListener("click",this.handleClick)},n.dispose=function(){e.prototype.dispose.call(this),this.removeEvent()},t}(l.JT),jr=Gr,Yr=r(84269),Xr=function(e){function t(t){var i;return(i=e.call(this)||this).onTouchstartEvent=new A.Q5,i.onTouchmoveEvent=new A.Q5,i.onTouchendEvent=new A.Q5,i.onTapEvent=new A.Q5,i.onLongTapEvent=new A.Q5,i._handleTouchstart=function(e){var t,n;(null===(t=i.spreadsheet)||void 0===t?void 0:t.isExternalSheet())||(null===(n=r.g.log)||void 0===n||n.info("view canvas touchstart: "+i._operateData.toString()),e.preventDefault(),i.onTouchstartEvent.fire(i._operateData))},i._handleTouchmove=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onTouchmoveEvent.fire(i._operateData)},i._handleTouchend=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||i.onTouchendEvent.fire(i._operateData)},i._handleTap=function(){var e;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||(i.onTapEvent.fire(i._operateData),!je().isIPad||i._operateData.preventAutoTapFocus||i._board.contains(document.activeElement)||i._board.focus())},i._handleLongTap=function(){var e,t;(null===(e=i.spreadsheet)||void 0===e?void 0:e.isExternalSheet())||(null===(t=r.g.log)||void 0===t||t.info("view canvas longTap: "+i._operateData.toString()),i.onLongTapEvent.fire(i._operateData))},i.onTouchstart=i.onTouchstartEvent.event,i.onTouchmove=i.onTouchmoveEvent.event,i.onTouchend=i.onTouchendEvent.event,i.onLongTap=i.onLongTapEvent.event,i.onTap=i.onTapEvent.event,i._board=t.board,i._operateData=t.operateData,i.spreadsheet=t.spreadsheet,i._board.addEventListener("contextmenu",We.PF),(0,Yr.C)(i._board),i.addEvent(),i}(0,i.Z)(t,e);var o=t.prototype;return o.addEvent=function(){this._board.addEventListener("touchstart",this._handleTouchstart),document.addEventListener("touchmove",this._handleTouchmove,!1),document.addEventListener("touchend",this._handleTouchend,!1),this._board.addEventListener("tap",this._handleTap),this._board.addEventListener("longTap",this._handleLongTap)},o.removeEvent=function(){this._board.removeEventListener("touchstart",this._handleTouchstart),document.removeEventListener("touchmove",this._handleTouchmove,!1),document.removeEventListener("touchend",this._handleTouchend,!1),this._board.removeEventListener("tap",this._handleTap),this._board.removeEventListener("longTap",this._handleLongTap)},(0,n.Z)(t,[{key:"board",get:function(){return this._board}}]),t}(l.JT),Kr=Xr,Jr=function(e){function t(t){var r;return(r=e.call(this)||this).operateBoard=r._register(new Pr({container:t.container})),r.operateData=new Vr({scale:t.scale}),r.mousePrepare=r._register(new kr(Object.assign(Object.assign({},t),{operateData:r.operateData,spreadsheet:t.spreadsheet}))),r.touchPrepare=r._register(new Wr(Object.assign(Object.assign({},t),{operateData:r.operateData,spreadsheet:t.spreadsheet}))),r.mouseOperate=r._register(new jr({board:r.operateBoard.board,operateData:r.operateData,spreadsheet:t.spreadsheet})),r.touchOperate=r._register(new Kr({board:r.operateBoard.board,operateData:r.operateData,spreadsheet:t.spreadsheet})),r}return(0,i.Z)(t,e),t.prototype.calcHoverData=function(e,t){return this.mousePrepare.calcHoverData(e,t)},t}(l.JT),Qr=function(e){function t(t){var r;return(r=e.call(this)||this).board=document.createElement("div"),r._tx=0,r._ty=0,r.board.classList.add("feature-board"),t.appendChild(r.board),r}(0,i.Z)(t,e);var r=t.prototype;return r.translateX=function(e){e!==this._tx&&(this._tx=e,this.board.style.transform="translate3d("+this._tx+"px, "+this._ty+"px, 0px)")},r.translateY=function(e){e!==this._ty&&(this._ty=e,this.board.style.transform="translate3d("+this._tx+"px, "+this._ty+"px, 0px)")},r.dispose=function(){this.board.remove()},t}(l.JT),$r=function(e){function t(t){var r;return(r=e.call(this,t)||this)._board.classList.add("hidden-board"),r}return(0,i.Z)(t,e),t}(function(e){function t(t){var r;return(r=e.call(this)||this)._board=document.createElement("div"),r._board.classList.add("wrap-board"),r.featureBoard=r._register(new Qr(r._board)),t.appendChild(r._board),r}(0,i.Z)(t,e);var r=t.prototype;return r.append=function(e){this.featureBoard.board.appendChild(e)},r.remove=function(e){this.featureBoard.board.contains(e)&&this.featureBoard.board.removeChild(e)},r.dispose=function(){e.prototype.dispose.call(this),this._board.remove()},t}(l.JT));function qr(e,t){if(e.left<=0&&e.width<=0||e.top<=0&&e.height<=0)return!1;var r=t.left-e.left,i=t.top-e.top;return!(r>e.width||i>e.height||r+t.width<0||i+t.height<0)}var ei,ti,ri,ii=function(e){function t(t,r,i){var n;return(n=e.call(this)||this)._offsetX=0,n._offsetY=0,n._globalOffsetX=0,n._globalOffsetY=0,n._refresh=function(){var e=n._colArea.displayViewSize;Object.assign(n._board.style,{display:0===e?"none":"inline-block",width:e+"px"})},n._container=t,n._rowArea=r,n._colArea=i,n._init(),n}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this._refresh()},r.setOffset=function(e,t,r,i){this._offsetX=e,this._offsetY=t,this._globalOffsetX=r,this._globalOffsetY=i},r.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this._board)},r.isInBoard=function(e){return qr({left:this.offsetX,top:this.offsetY,width:this.totalWidth,height:this.totalHeight},e)},r.isInBoardVisibleArea=function(e,t){return void 0===t&&(t=0),!(this.visibleWidth<=0||this.visibleHeight<=0)&&qr({left:this._globalOffsetX+this._colArea.displayOffsetSize-t,top:this._globalOffsetY+this._rowArea.displayOffsetSize-t,width:this.visibleWidth+2*t,height:this.visibleHeight+2*t},e)},r._init=function(){this._board=document.createElement("div"),this._board.classList.add("block-board"),this._container.appendChild(this._board),this._hiddenBoard=this._register(new $r(this._board)),this._register(this._colArea.onUpdateViewSize(this._refresh))},(0,n.Z)(t,[{key:"element",get:function(){return this._board}},{key:"hiddenBoard",get:function(){return this._hiddenBoard}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"globalOffsetX",get:function(){return this._globalOffsetX}},{key:"globalOffsetY",get:function(){return this._globalOffsetY}},{key:"totalWidth",get:function(){return this._colArea.displayTotalSize}},{key:"totalHeight",get:function(){return this._rowArea.displayTotalSize}},{key:"visibleWidth",get:function(){return this._colArea.displayViewSize}},{key:"visibleHeight",get:function(){return this._rowArea.displayViewSize}}]),t}(l.JT),ni=function(e){function t(t,r,i){var n;return(n=e.call(this)||this)._refresh=function(){var e=n._area.displayViewSize;Object.assign(n._board.style,{display:0===e?"none":"block",height:e+"px"}),n._left.refresh(),n._right.refresh()},n._container=t,n._area=r,n._areaDataCol=i,n._init(),n}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this._refresh()},r.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this._board)},r._init=function(){this._board=document.createElement("div"),this._board.classList.add("line-board"),this._container.appendChild(this._board),this._left=this._register(new ii(this._board,this._area,this._areaDataCol.frozen)),this._right=this._register(new ii(this._board,this._area,this._areaDataCol.flow)),this._register(this._area.onUpdateViewSize(this._refresh))},(0,n.Z)(t,[{key:"left",get:function(){return this._left}},{key:"right",get:function(){return this._right}}]),t}(l.JT),oi=function(e){function t(t){var r;return(r=e.call(this)||this).registerAfterAreaRenderOnce=function(){A.ju.once(r.renderManager.alloyExcel.onAfterAreaRender)((function(){r._handleScale()}))},r._updateAreaOffset=function(){var e=r._areaData.getDisplayGlobalLeftByCol(r._areaData.col.flow.from),t=r._areaData.getDisplayGlobalTopByRow(r._areaData.row.flow.from),i=-r._areaData.getDisplayViewLeftByCol(0),n=-r._areaData.getDisplayViewTopByRow(0);r._topLine.left.setOffset(i,n,0,0),r._topLine.right.setOffset(e,n,e,0),r._bottomLine.left.setOffset(i,t,0,t),r._bottomLine.right.setOffset(e,t,e,t)},r._refresh=function(){Object.assign(r._board.style,{top:r._headSize.displayColHeadHeight+"px",left:r._headSize.displayRowHeadWidth+"px"}),r._topLine.refresh(),r._bottomLine.refresh(),r._updateAreaOffset(),r.updateFeatureBoardTranslate()},r.updateFeatureBoardTranslate=function(){var e=-r._areaData.row.flow.displayOffsetSize;r._bottomLine.left.hiddenBoard.featureBoard.translateY(e),r._bottomLine.right.hiddenBoard.featureBoard.translateY(e);var t=-r._areaData.row.frozen.displayOffsetSize;r._topLine.left.hiddenBoard.featureBoard.translateY(t),r._topLine.right.hiddenBoard.featureBoard.translateY(t);var i=-r._areaData.col.flow.displayOffsetSize;r._topLine.right.hiddenBoard.featureBoard.translateX(i),r._bottomLine.right.hiddenBoard.featureBoard.translateX(i);var n=-r._areaData.col.frozen.displayOffsetSize;r._topLine.left.hiddenBoard.featureBoard.translateX(n),r._bottomLine.left.hiddenBoard.featureBoard.translateX(n)},r._handleScale=function(){r._refresh()},r._container=t.container,r._headSize=t.headSize,r._areaData=t.areaData,r._scale=t.scale,r.renderManager=t.renderManager,r._init(),r}(0,i.Z)(t,e);var r=t.prototype;return r.refresh=function(){this._refresh()},r.dispose=function(){e.prototype.dispose.call(this),this._container.removeChild(this._board)},r._init=function(){this._board=document.createElement("div"),this._board.classList.add("main-board"),this._container.appendChild(this._board),this._topLine=this._register(new ni(this._board,this._areaData.row.frozen,this._areaData.col)),this._bottomLine=this._register(new ni(this._board,this._areaData.row.flow,this._areaData.col)),this._register(this._scale.onScale(this.registerAfterAreaRenderOnce)),this._register(this._areaData.row.frozen.onUpdateViewSize(this._updateAreaOffset)),this._register(this._areaData.col.frozen.onUpdateViewSize(this._updateAreaOffset)),this._register(this._areaData.row.frozen.onUpdateOffset(this._updateAreaOffset)),this._register(this._areaData.col.frozen.onUpdateOffset(this._updateAreaOffset)),this._register(this._areaData.row.flow.onUpdateOffset(this.updateFeatureBoardTranslate)),this._register(this._areaData.col.flow.onUpdateOffset(this.updateFeatureBoardTranslate)),this._register(this._areaData.row.frozen.onUpdateOffset(this.updateFeatureBoardTranslate)),this._register(this._areaData.col.frozen.onUpdateOffset(this.updateFeatureBoardTranslate)),this._refresh()},(0,n.Z)(t,[{key:"element",get:function(){return this._board}},{key:"top",get:function(){return this._topLine}},{key:"bottom",get:function(){return this._bottomLine}}]),t}(l.JT),ai=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},si=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},li=function(e,t){return function(r,i){t(r,i,e)}},ci=function(e){function t(t,r,i){var n;return(n=e.call(this)||this).wrap=t,n.spreadsheet=r,n.dataCallView=i,n.init(),n}(0,i.Z)(t,e);var n=t.prototype;return n.getActiveSheetId=function(){return this.spreadsheet.activeSheetId},n.init=function(){this.initScale(),this.initResize(),this.initHeadSize(),this.initClientRect();var e=+new Date;this.initParagraphAccessor(),this.initRowcolAccessor(),this.initRowCoverAccessor(),this.initBorderAccessor();var t=+new Date;r.g.performanceData&&(r.g.performanceData.FS_CalcAccessor=t-e),this.initTableView(),this.initAreaData(),this.initTransformTable(),this.initRenderManager(),this.initFreezeLine(),this.initMainBoard(),this.initOperateContext()},n.dispose=function(){e.prototype.dispose.call(this),this.wrap.removeChild(this.container)},n.initScale=function(){this.scale=new cr},n.initResize=function(){this.resize=this._register(new nr)},n.initHeadSize=function(){this.headSize=new ir({scale:this.scale})},n.initClientRect=function(){this.clientRect=this._register(new rr(this.wrap,this.resize)),this.container=this.clientRect.container},n.initParagraphAccessor=function(){this.paragraphAccessor=this._register(new vr.Z({dataCallView:this.dataCallView,spreadsheet:this.spreadsheet}))},n.initRowcolAccessor=function(){this.rowcolAccessor=this._register(new hr.Z({paragraphAccessor:this.paragraphAccessor,spreadsheet:this.spreadsheet,dataCallView:this.dataCallView}))},n.initRowCoverAccessor=function(){this.rowCoverAccessor=this._register(new pr({dataCallView:this.dataCallView,paragraphAccessor:this.paragraphAccessor,rowcolAccessor:this.rowcolAccessor,spreadsheet:this.spreadsheet}))},n.initBorderAccessor=function(){this.borderAccessor=this._register(new Sr({spreadsheet:this.spreadsheet,dataCallView:this.dataCallView,rowCoverAccessor:this.rowCoverAccessor,rowcolAccessor:this.rowcolAccessor}))},n.initTableView=function(){this.tableView=this._register(new D({spreadsheet:this.spreadsheet,dataCallView:this.dataCallView}))},n.initAreaData=function(){this.areaData=this._register(new tr({clientRect:this.clientRect,rowcolAccessor:this.rowcolAccessor,headSize:this.headSize,dataCallView:this.dataCallView,resize:this.resize,scale:this.scale,spreadsheet:this.spreadsheet}))},n.initTransformTable=function(){this.transformTable=new Mr({tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,rowCoverAccessor:this.rowCoverAccessor,borderAccessor:this.borderAccessor,paragraphAccessor:this.paragraphAccessor,spreadsheet:this.spreadsheet})},n.initRenderManager=function(){this.renderManager=this._register(new Jt({dataCallView:this.dataCallView,spreadsheet:this.spreadsheet,container:this.container,areaData:this.areaData,resize:this.resize,scale:this.scale,headSize:this.headSize,transformTable:this.transformTable,tableView:this.tableView,rowcolAccessor:this.rowcolAccessor,rowCoverAccessor:this.rowCoverAccessor,paragraphAccessor:this.paragraphAccessor,borderAccessor:this.borderAccessor}))},n.initFreezeLine=function(){this.freezeLine=this._register(new Br({areaData:this.areaData,headSize:this.headSize,renderManager:this.renderManager}))},n.initOperateContext=function(){this.operateContext=this._register(new Jr({container:this.container,scale:this.scale,clientRect:this.clientRect,headSize:this.headSize,areaData:this.areaData,spreadsheet:this.spreadsheet}))},n.initMainBoard=function(){this.mainBoard=this._register(new oi({container:this.container,headSize:this.headSize,areaData:this.areaData,scale:this.scale,renderManager:this.renderManager}))},t}(l.JT),hi=ci=ai([li(1,Dr.ISpreadsheet),li(2,Ar.Z),si("design:paramtypes",["function"===typeof(ei="undefined"!==typeof HTMLDivElement&&HTMLDivElement)?ei:Object,"function"===typeof(ti="undefined"!==typeof Dr.ISpreadsheet&&Dr.ISpreadsheet)?ti:Object,"function"===typeof(ri="undefined"!==typeof Ar.Z&&Ar.Z)?ri:Object])],ci)},32263:function(e,t,r){r.d(t,{N:function(){return i}});var i=(0,r(76138).yh)("ISpreadsheetView");t.Z=i},13059:function(e,t,r){var i=r(58926),n=r(13504),o=(r(71096),r(41031),r(8195),function(e){function t(t){var r;return(r=e.call(this,t)||this)._handleInsertCol=function(e){var t=r._rowData[e.sheetId];if(t)for(var n=Object.keys(t),o=0;o<n.length;o++)for(var a=n[o],s=r._rowData[e.sheetId][a],l=0;l<s.length;l++){var c;s[l]&&(e.index>=s[l].length?s[l].length=e.index+e.amount:(c=s[l]).splice.apply(c,[e.index,0].concat((0,i.Z)(new Array(e.amount)))))}},r._handleDeleteCol=function(e){var t=r._rowData[e.sheetId];if(t)for(var i=Object.keys(t),n=0;n<i.length;n++)for(var o=i[n],a=r._rowData[e.sheetId][o],s=0;s<a.length;s++)a[s]&&(e.index>=a[s].length?a[s].length=e.index+e.amount:a[s].splice(e.index,e.amount))},r._register(r._dataCallView.onInsertCol(r._handleInsertCol)),r._register(r._dataCallView.onDeleteCol(r._handleDeleteCol)),r}return(0,n.Z)(t,e),t}(r(77876).Z));t.Z=o},77876:function(e,t,r){var i=r(58926),n=r(13504),o=(r(71096),r(41031),r(8195),function(e){function t(t){var r;return(r=e.call(this)||this)._rowData={},r._handleInsertRow=function(e){var t=e.sheetId,n=r._rowData[t];if(n)for(var o,a=Object.keys(n),s=0;s<a.length;s++){var l;if(o=a[s],e.index>=n[o].length)return void(n[o].length=e.index+e.amount);(l=n[o]).splice.apply(l,[e.index,0].concat((0,i.Z)(new Array(e.amount))))}},r._handleDeleteRow=function(e){var t=e.sheetId,i=r._rowData[t];if(i)for(var n,o=Object.keys(i),a=0;a<o.length;a++){if(n=o[a],e.index>=i[n].length)return;i[n].splice(e.index,e.amount)}},r._spreadsheet=t.spreadsheet,r._dataCallView=t.dataCallView,r._register(r._dataCallView.onInsertRow(r._handleInsertRow)),r._register(r._dataCallView.onDeleteRow(r._handleDeleteRow)),r}return(0,n.Z)(t,e),t.prototype.getTargetSheet=function(e){return this._spreadsheet.sheetManager.getSheetBySheetId(e)},t}(r(76138).JT));t.Z=o},13423:function(e,t,r){r.d(t,{oz:function(){return i}});var i,n=r(76138);!function(e){e.USER="user",e.API="api",e.SLIENT="slient",e.RENDER="render"}(i||(i={}));var o=(0,n.yh)("IAreaData");t.ZP=o},7872:function(e,t,r){var i;r.d(t,{i:function(){return i}}),function(e){e[e.EMPTY=0]="EMPTY",e[e.TEXT=4]="TEXT",e[e.ICON=26]="ICON"}(i||(i={}));var n=function(){function e(t,r,i,n,o){this.top=t,this.right=r,this.bottom=i,this.left=n,e.pools[o]=this}return e.newInstance=function(t,r,i,n){var o=t+":"+r+":"+i+":"+n,a=e.pools[o];return a||new e(t,r,i,n,o)},e}();n.pools={},t.Z=n},5004:function(e,t,r){var i=r(3120),n=function(){function e(t,r,i,n,o){this.red=t,this.green=r,this.blue=i,this.alpha=n,this.hex=o,e.pools[o]=this}return e.newInstanceByRGB=function(t,r,n,o){void 0===o&&(o=1);var a=function(e,t,r,n){return(0,i.rgba2hex)(e,t,r,n)}(t,r,n,o);return e.pools[a]?e.pools[a]:new e(t,r,n,o,a)},e.newInstanceByHex=function(t){var r=t.toLowerCase(),n=e.pools[r];if(n)return n;var o=function(e){return(0,i.hex2rgba)(e)}(r);return new e(o.red,o.green,o.blue,o.alpha,r)},e}();n.pools={},t.Z=n},52904:function(e,t,r){var i=r(85952),n=(r(77466),function(){function e(e){this._value=e}return e.newInstance=function(t){var r=e.pools[t];return r||(e.pools[t]=new e(t))},(0,i.Z)(e,[{key:"value",get:function(){return this._value}}]),e}());n.pools={},t.Z=n},99997:function(e,t,r){r.d(t,{L:function(){return h}});var i=r(85952),n=(r(91877),r(60113),r(52865),r(20670),r(62077),r(1976)),o=r(56584),a=r(54253),s=r(89880),l=r(60973),c=r(45435),h=":",d=function(){function e(e){void 0!==e[a.M.COLOR]&&(this[a.M.COLOR]=e[a.M.COLOR]),void 0!==e[a.M.FONT_SIZE]&&(this[a.M.FONT_SIZE]=e[a.M.FONT_SIZE]),void 0!==e[a.M.FONT_FAMILY]&&(this[a.M.FONT_FAMILY]=e[a.M.FONT_FAMILY]),void 0!==e[a.M.BOLD]&&(this[a.M.BOLD]=e[a.M.BOLD]),void 0!==e[a.M.ITALIC]&&(this[a.M.ITALIC]=e[a.M.ITALIC]),void 0!==e[a.M.UNDERLINE]&&(this[a.M.UNDERLINE]=e[a.M.UNDERLINE]),void 0!==e[a.M.STRIKETHROUGH]&&(this[a.M.STRIKETHROUGH]=e[a.M.STRIKETHROUGH])}return e.toRGBA=function(e){return"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")"},e.toKey=function(t){var r=t.color,i="";return r&&(i=c.ZP.isTargetType(r)?r.serialize():e.toRGBA(r)),"{"+i+","+(null!=t.fontFamily?t.fontFamily:"")+","+(null!=t.fontSize?t.fontSize:"")+","+(t.bold?"1":"")+","+(t.italic?"1":"")+","+(t.strikethrough?"1":"")+","+(t.underline?"1":"")+"}"},e.newInstance=function(t,r){var i=e.toKey(t),o=e.pools[i];if(!o){var s=Object.create(null);if(t.color){var l=t.color;c.ZP.isTargetType(l)&&(l=n.Z.getColorRGBA(l,r)),s[a.M.COLOR]=e.toRGBA(l)}return t.fontSize&&(s[a.M.FONT_SIZE]=t.fontSize),t.fontFamily&&(s[a.M.FONT_FAMILY]=e.polyfillFontFamilyIfNeed(t.fontFamily)),t.bold&&(s[a.M.BOLD]=1),t.italic&&(s[a.M.ITALIC]=1),t.underline&&(s[a.M.UNDERLINE]=1),t.strikethrough&&(s[a.M.STRIKETHROUGH]=1),e.pools[i]=new e(s)}return o},e.polyfillFontFamilyIfNeed=function(e){return(null===e||void 0===e?void 0:e.replace)&&(e=e.replace(/[（|()].*?[）|)]/g,"")),(e=(0,s.A)(e)).trim()},e.prototype._getLineWidth=function(e){return e?Math.round(e/15):0},(0,i.Z)(e,[{key:"hash",get:function(){return""+this.font+h+this.color+h+this._getLineWidth(this.fontSize)}},{key:"font",get:function(){var e="";return this[a.M.ITALIC]&&(e="italic"),this[a.M.BOLD]&&(e+=" bold"),(e=e+" "+this.fontSize+"pt "+this.fontFamily).trim()}},{key:"color",get:function(){return this[a.M.COLOR]||e.toRGBA(o.xw)}},{key:"fontSize",get:function(){return this[a.M.FONT_SIZE]||o.n5}},{key:"fontFamily",get:function(){return this[a.M.FONT_FAMILY]||l.em}},{key:"underline",get:function(){return Boolean(this[a.M.UNDERLINE])}},{key:"strikethrough",get:function(){return Boolean(this[a.M.STRIKETHROUGH])}},{key:"bold",get:function(){return!!this[a.M.BOLD]||!1}},{key:"italic",get:function(){return!!this[a.M.ITALIC]||!1}},{key:"hasColor",get:function(){return"undefined"!==typeof this[a.M.COLOR]}}]),e}();a.M.COLOR,a.M.FONT_SIZE,a.M.FONT_FAMILY,a.M.BOLD,a.M.ITALIC,a.M.UNDERLINE,a.M.STRIKETHROUGH,d.pools={},t.Z=d},57856:function(e,t,r){r.d(t,{o:function(){return i}});var i,n=r(85952),o=function(){function e(e){this._value=e}return e.newInstance=function(t){var r=e.pools[t];return r||(e.pools[t]=new e(t))},(0,n.Z)(e,[{key:"value",get:function(){return this._value}}]),e}();o.pools={},function(e){e.TOP="top",e.MIDDLE="middle",e.BOTTOM="bottom"}(i||(i={})),t.Z=o},90270:function(e,t,r){r.d(t,{J:function(){return i}});var i,n=r(85952),o=function(){function e(e){this._value=e}return e.newInstance=function(t){var r=e.pools[t];return r||(e.pools[t]=new e(t))},(0,n.Z)(e,[{key:"value",get:function(){return this._value}}]),e}();o.pools={},function(e){e.NOWRAP="nowrap",e.NORMAL="normal"}(i||(i={})),t.Z=o},3390:function(e,t,r){r.d(t,{C:function(){return o}});var i=r(42023),n=r(34245);function o(e,t,r,a,s){var l=e.substr(0,a),c=i.Z.measureWidth(l instanceof n.eE?l.basicString:l,t,!0);if(0===c||c<=s&&a>=e.length||c>s&&1===l.length)return{text:"string"===typeof l?l:l.basicString,width:c};var h=c/l.length*5;if(c<=s&&s-c<h){for(var d=a+1;d<e.length;d++){var u=e.substr(0,d),f=i.Z.measureWidth("string"===typeof u?u:u.basicString,t);if(f>s)break;l=u,c=f}return{text:"string"===typeof l?l:l.basicString,width:c}}return c>s?o(e,t,r,Math.floor((r+a)/2),s):o(e,t,a,Math.floor((a+e.length)/2),s)}t.Z=o},34245:function(e,t,r){r.d(t,{Am:function(){return h},eE:function(){return f},uc:function(){return u}}),r(15770),r(38934),r(84919),r(26894),r(71091),r(52865),r(13857),r(54371),r(95019),r(19553),r(81144);var i=r(3390),n=r(42986),o=r(98161),a=r(54535),s=r.n(a);function l(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function h(e,t){var i,n=[],o=0,a=0;n[o]=[];for(var s=e.shift();s;){if(0===(null===(i=n[o-1])||void 0===i?void 0:i.length))return r.g.log.error("LineEngine splitLineByWidth error - empty split result:"+s.text),n;if(g(a+=s.size.width,t,s)){if(!_(t,s)){a=0,n[o+=1]=[];continue}var c=d(a,t,s);if(c.frontSegment&&!c.frontSegment.isEmpty()&&n[o].push(c.frontSegment),c.backSegments.length>0)for(var h,u=l(c.backSegments);!(h=u()).done;){var f=h.value;n[o+=1]=[],a=f.size.width,n[o].push(f)}else n[o+=1]=[],a=0}else n[o].push(s);s=e.shift()}return n}function d(e,t,r){var i=t-(e-r.size.width);return r.splitSegment(i,t)}function u(e,t,r){var n;if(o.Z.util.string.hasEmojiCharacter(t.text)){var a=new f(t.text);n=(0,i.Z)(a,e,0,a.length,r)}else n=(0,i.Z)(t.text,e,0,t.text.length,r);return[n,{text:t.text.slice(n.text.length,t.text.length),width:t.width-n.width}]}var f=function(){function e(e){this._emojiString=new(s())(e),this.length=this._emojiString.length,this.basicString=e}return e.prototype.substr=function(t,r){return new e(this._emojiString.substr(t,r))},e}();function g(e,t,r){return e>t||(0,n.N6)(r.text)}function _(e,t){return t.size.width>e||t.size.width<=e&&t.canSplit()}},46114:function(e,t,r){r.d(t,{iF:function(){return R},ll:function(){return v}}),r(93984),r(38934),r(90109),r(25594),r(46396),r(12024),r(81502),r(91877),r(60113),r(10012),r(49502),r(15770),r(84919),r(26894),r(71091),r(52865),r(13857),r(54371),r(95019),r(19553),r(81144);var i=r(56584),n=r(60878),o=r(29423),a=r(66929),s=r(99997),l=r(42023),c=r(46554),h=r(74140),d=r(90980),u=r(19247),f=r(1976),g=r(45841);function _(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function v(e,t){var r=function(e,t){var r=e.cellData,i=r.getMetadata();if(!i)return null;if(i.customDataType===h.ZP.SELECT){if(!i.config.withColor)return null;var n=r.getRefIds();if(n&&n.length>0){var o=i.config.options;return n.map((function(e){return o.find((function(t){return t.id===e}))})).filter((function(e){return e})).map((function(e){var i=e.textColor,n=e.text,o=e.bgColor,c=Object.assign(Object.assign({},(0,d.getMergedTextFormat)(r)),{color:i}),h=s.Z.newInstance(c,t);return a.ZP.createInstance({text:n,textProp:h,size:{width:l.Z.measureWidth(n,h,!0),height:l.Z.measureHeight(h)},bgColor:o})}))}}return null}(e,t);return r||function(e,t){var r=e.cellText,i=e.textFormatRuns,n=e.cellData.getMentionDetails(),a=n&&Object.values(n)||[];a.length&&(a=a.sort((function(e,t){return e.pos[0]-t.pos[0]})));for(var h=[],d=i.length,u=0;u<d;u++)for(var f,g=i[u],p=u+1<d?i[u+1]:null,v=g.format,w=void 0,R=_(C([g.startIndex,p?p.startIndex:r.length],a));!(f=R()).done;){w=f.value;var m=r.substring(w.pos[0],w.pos[1]);if(w.mention){var E=y(v,t),S=l.Z.measureWidth(m,E,!0),D=l.Z.measureHeight(E);h.push(o.Z.createInstance({text:m,textProp:E,size:{width:S,height:D},mention:w.mention,spreadsheet:t}))}else{var A=s.Z.newInstance(v,t),x=l.Z.measureWidth(m,A,!0),T=l.Z.measureHeight(A);h.push(c.Z.createInstance({text:m,textProp:A,size:{width:x,height:T}}))}}return h}(e,t)}var w=[g.B.FILTER_NAME,g.B.ROW_NAME,g.B.COL_NAME,g.B.TITLE];function R(e,t){void 0===t&&(t=!1);var r=e.getTextFormatRuns(),i=e.getConditionalFormatResult(),o=e.getEffectiveFormat(),a=function(){var r,i,o=null===(r=e.getPivotTableRef())||void 0===r?void 0:r.pivotCellType,a=o&&w.includes(o);return n.Z.createInstance({color:(0,d.getMergedFormatValue)(e,"getColor",t),fontFamily:(0,d.getMergedFormatValue)(e,"getFontFamily",t),fontSize:(0,d.getMergedFormatValue)(e,"getFontSize",t),bold:null!==(i=(0,d.getMergedFormatValue)(e,"getBold",t))&&void 0!==i?i:a,italic:(0,d.getMergedFormatValue)(e,"getItalic",t),strikethrough:(0,d.getMergedFormatValue)(e,"getStrikethrough",t),underline:(0,d.getMergedFormatValue)(e,"getUnderline",t)})},s=function(e){var t,r,a,s,l,c,h;return n.Z.createInstance({color:(null===i||void 0===i?void 0:i.getColor())||(null===o||void 0===o?void 0:o.getColor())||(null===(t=e.format)||void 0===t?void 0:t.color),fontFamily:(null===i||void 0===i?void 0:i.getFontFamily())||(null===o||void 0===o?void 0:o.getFontFamily())||(null===(r=e.format)||void 0===r?void 0:r.fontFamily),fontSize:(null===i||void 0===i?void 0:i.getFontSize())||(null===o||void 0===o?void 0:o.getFontSize())||(null===(a=e.format)||void 0===a?void 0:a.fontSize),bold:(null===i||void 0===i?void 0:i.getBold())||(null===o||void 0===o?void 0:o.getBold())||(null===(s=e.format)||void 0===s?void 0:s.bold),italic:(null===i||void 0===i?void 0:i.getItalic())||(null===o||void 0===o?void 0:o.getItalic())||(null===(l=e.format)||void 0===l?void 0:l.italic),strikethrough:(null===i||void 0===i?void 0:i.getStrikethrough())||(null===o||void 0===o?void 0:o.getStrikethrough())||(null===(c=e.format)||void 0===c?void 0:c.strikethrough),underline:(null===i||void 0===i?void 0:i.getUnderline())||(null===o||void 0===o?void 0:o.getUnderline())||(null===(h=e.format)||void 0===h?void 0:h.underline)})};return(null===r||void 0===r?void 0:r.length)?r.map((function(e){return u.Z.createInstance({startIndex:e.startIndex,format:e.format?t?e.format.clone():s(e):a()})})):r=[u.Z.createInstance({startIndex:0,format:a()})]}function C(e,t){if(!t.length)return[{pos:e}];var r=[],i=t.filter((function(t){return e[0]<=t.pos[0]&&t.pos[1]<=e[1]}));if(i.length>0){for(var n,o,a=e[0],s=_(i);!(o=s()).done;)a<(n=o.value).pos[0]&&r.push({pos:[a,n.pos[0]]}),r.push({pos:[n.pos[0],n.pos[1]],mention:n}),a=n.pos[1];return a<e[1]&&r.push({pos:[a,e[1]]}),r}return[{pos:e}]}function y(e,t){var r;if(null===e.color||f.Z.getColorHexCode(e.color,t)!==i.GB.TextColor){var o=n.Z.createInstance(Object.assign(Object.assign({},e),{color:"#0188fb"}));r=s.Z.newInstance(o,t)}else r=s.Z.newInstance(e,t);return r}},42986:function(e,t,r){r.d(t,{N6:function(){return a},Pp:function(){return l},Tm:function(){return o},Wd:function(){return s}}),r(52865),r(20670),r(81296);var i,n=r(75083);function o(e){return a(e)?e.replace(/\n/g," "):e}function a(e){return e&&/\n/.test(e)}function s(e){if(0===e.length)return!1;for(var t=0;t<e.length;t++){var r=e.codePointAt(t);if(!(0,n.FD)(r))return!1}return!0}function l(e){var t=e.charCodeAt(e.length-1);return 10===t||13===t}!function(e){e[e.ZH=1]="ZH",e[e.COMBINATION=2]="COMBINATION",e[e.SPACE=3]="SPACE",e[e.OTHER=4]="OTHER"}(i||(i={}))},68803:function(e,t,r){var i=r(58926);t.Z=function(e){var t;void 0===e&&(e=[]),this.segments=[],(t=this.segments).push.apply(t,(0,i.Z)(e));for(var r=0,n=0,o=0;o<e.length;o++)r+=e[o].size.width,n=Math.max(n,e[o].size.height);this.width=r,this.height=n}},60570:function(e,t){t.Z=function(e){void 0===e&&(e=[]),this.lines=[];for(var t=0,r=0,i=0;i<e.length;i++)t=Math.max(e[i].width,t),r+=e[i].height;this.lines=e,this.width=t,this.height=r}},23884:function(e,t,r){var i=r(32198),n=function(){function e(e,t){this.key=t,this.segment=e,this.width=this.segment.size.width,this.height=this.segment.size.height}return e.generateKey=function(e){return e.key},e}();n.factory=new i.Z(n),t.Z=n.factory},25393:function(e,t,r){r.d(t,{U:function(){return l},i:function(){return s}});var i=r(42023),n=r(99997),o=r(68803),a=r(46554),s="＊＊＊＊＊＊＊",l=function(e){var t=n.Z.newInstance({fontSize:10},e),r=i.Z.measureWidth(s,t,!0),l=i.Z.measureHeight(t),c=a.Z.createInstance({text:s,textProp:t,size:{width:r,height:l}});return new o.Z([c])}},29423:function(e,t,r){var i,n=r(13504),o=(r(90109),r(56584)),a=r(15106),s=r(32198),l=(r(36156),r(53140));!function(e){e[e.NORMAL=0]="NORMAL",e[e.HOVER=1]="HOVER",e[e.HIGHTLIGHT=2]="HIGHTLIGHT"}(i||(i={}));var c=function(e){function t(t,r){var i;(i=e.call(this,t,r)||this).key=r,i.focusing=!1,i.highlight=!1;var n=t.mention,a=t.size,s=t.spreadsheet;return i.mention=n,i.spreadsheet=s,i.size.width=2*o.li.OuterPadding+2*o.li.InnerLeftRightPadding+a.width+o.li.LabelAndTrianglePadding+o.li.TriangleWidth,i.size.height=2*o.li.OuterPadding+o.li.Height,i}(0,n.Z)(t,e),t.generateKey=function(e){return e.mention.mentionId};var r=t.prototype;return r.focus=function(){this.focusing=!0},r.unfocus=function(){this.focusing=!1},r.canSplit=function(){return!1},r.splitSegment=function(e,t){var r=null,i=[];return e===t?r=this.size.width>t?this.segmentHardSplit(t):this:(r=null,i=[this]),{frontSegment:r,backSegments:i}},r.customRender=function(e,t,r,i,n){this.customRenderToC(t,r,i,n)},r.customRenderToB=function(e,t,r,i,n){var a={pos:[t+o.li.OuterPadding+o.li.InnerLeftRightPaddingEnt,r],text:this.text};i&&(a.clipInfo=i);var s=(0,l.d)(e,this.textProp,this.spreadsheet).hash;n.textCollector.collect({textInfo:a,textPropHash:s})},r.customRenderToC=function(e,t,r,i){var n,a={pos:[e+o.li.OuterPadding+o.li.InnerLeftRightPadding,t-o.li.OuterPadding],text:this.text};r&&(a.clipInfo=r),i.textCollector.collect({textInfo:a,textPropHash:this.textProp.hash});var s=Math.round(t-.75*this.size.height)+o.li.OuterPadding,l={radius:o.li.Radius,rect:[o.li.OuterPadding+e,s,this.size.width-2*o.li.OuterPadding,this.size.height-2*o.li.OuterPadding]};r&&(l.clipInfo=r),i.roundRectCollector.collect({roundRectProp:this.getRoundRectRenderProp(),roundRectInfo:l});var c=s-o.li.OuterPadding+(this.size.height-o.li.TriangleHeight)/2,h=[e+this.size.width-o.li.OuterPadding-o.li.InnerLeftRightPadding-o.li.TriangleWidth,c],d={path:this.getTriangleCoordinate(h)};r&&(d.clipInfo=r),null===(n=i.get("mention-triangle"))||void 0===n||n.collect({color:o.GB.TriangleColor,graphicsInfo:d})},r.getRoundRectRenderProp=function(){return this.focusing?o.I1:this.highlight?o.kp:o.et},r.segmentHardSplit=function(e){var r=this.castToWidth(e),i=r.text,n=r.textProp,o=r.size;return t.factory.createInstance({text:i,textProp:n,size:o,mention:this.mention,spreadsheet:this.spreadsheet})},r.getTriangleCoordinate=function(e){return o.Co.map((function(t,r){return t+e[r%2]}))},t}(a.Z);c.factory=new s.Z(c),t.Z=c.factory},15106:function(e,t,r){var i=r(3390),n=r(42023),o=function(){function e(e,t){this.key=t,this.text=e.text,this.textProp=e.textProp,this.size=e.size}var t=e.prototype;return t.isEmpty=function(){return!this.text},t.castToWidth=function(e){var t=(0,i.C)(this.text,this.textProp,0,this.text.length,e),r=n.Z.measureWidth(t.text,this.textProp),o=n.Z.measureHeight(this.textProp);return{text:t.text,textProp:this.textProp,size:{width:r,height:o}}},e}();t.Z=o},66929:function(e,t,r){r.d(t,{Gy:function(){return h}});var i=r(13504),n=r(15106),o=r(32198),a=r(99997),s=r(38086),l=r(54253),c=function(e){function t(t,r){var i;(i=e.call(this,t,r)||this).key=r;var n=t.bgColor,o=t.size;return i.bgColor=n,i.setSize(o),i}(0,i.Z)(t,e),t.generateKey=function(e){var t=e.text,r=e.bgColor,i=e.textProp,n=e.size,o="";if(i){var c=i.fontFamily,h=i.fontSize,d=i.underline,u=i.strikethrough,f=i.color,g=!!i[l.M.BOLD],_=!!i[l.M.ITALIC];o=a.Z.toKey({fontFamily:c,fontSize:h,color:s.Color.createColor(f),underline:d,strikethrough:u,bold:g,italic:_})}return t+","+(r&&r.serialize())+","+o+","+n.width+","+n.height};var r=t.prototype;return r.clone=function(){return t.factory.createInstance({text:this.text,textProp:this.textProp,size:this.size,bgColor:this.bgColor})},r.setSize=function(e){this.size.width=2*t.MARGIN+2*t.PADDING_X+e.width,this.size.height=2*t.MARGIN+2*t.PADDING_Y+e.height},r.canSplit=function(){return!1},r.splitSegment=function(e,t){var r=null,i=[];return e===t?r=this.size.width>t?this.segmentHardSplit(t):this:(r=null,i=[this]),{frontSegment:r,backSegments:i}},r.segmentHardSplit=function(e){var r=e-2*(t.MARGIN+t.PADDING_X),i=this.castToWidth(r),n=i.text,o=i.textProp,a=i.size;return t.factory.createInstance({text:n,textProp:o,size:a,bgColor:this.bgColor})},t}(n.Z);c.factory=new o.Z(c),c.MARGIN=1,c.PADDING_X=8,c.PADDING_Y=1,c.RADIUS=2,t.ZP=c.factory;var h={MARGIN:c.MARGIN,PADDING_X:c.PADDING_X,PADDING_Y:c.PADDING_Y,RADIUS:c.RADIUS}},46554:function(e,t,r){r.d(t,{Z:function(){return v}});var i=r(13504),n=(r(15770),r(38934),r(31688),r(26894),r(71091),r(19553),r(81144),r(84919),r(52865),r(13857),r(54371),r(95019),r(15106)),o=r(32198),a=r(54253),s=r(75083),l=r(42023),c=r(34245),h=r(42986),d=function(){function e(e,t){this.text=e,this.textProp=t,this.splitPoints=[],this.lineBreaker=new s.bk(e,{lineBreak:s.zJ.Normal,wordBreak:s.H4.Normal})}e.isBreakable=function(e){return(0,s.KJ)(e)!==e.length};var t=e.prototype;return t.breakLine=function(t){for(var r=t.lineWidth,i=t.limitWidth,n=i===r,o=0,a="",s=0,l=this.next();l;){var d=l.position-o,u=this.getWord(o,d),f=u.currentWord,g=u.currentWordWidth,_=(0,h.Wd)(f);if(s+g<=i)o=l.position,(0,h.Pp)(f)?(this.insertSplitPoint(o,s+g),a="",s=0,i=r,n=!0):(a+=f,s+=g,n=!1);else if(_)o=l.position,a+=f,s+=g,n=!1;else{var p=i-s,v=e.isBreakable(f);if(""!==a||!n){this.insertSplitPoint(o,s),a="",s=0,i=r,n=!0;continue}if(v){var w=(0,c.uc)(this.textProp,{text:f,width:g},p);a+=w[0].text,o+=w[0].text.length,this.insertSplitPoint(o,s+w[0].width),a="",s=0,i=r;continue}o=l.position,s+=g,this.insertSplitPoint(o,s),a="",s=0,i=r}l=this.next()}return this.insertSplitPoint(o,s),this.splitPoints},t.next=function(){var e=null;return(e=this.containsSpace()?{position:this.currentBreakPoint.position+1,required:!0}:this.lineBreaker.next(!0))&&(this.currentBreakPoint=e),e},t.insertSplitPoint=function(e,t){this.splitPoints.push({position:e,width:t})},t.getWord=function(e,t){var r,i=this.text.substr(e,t);return r=(0,h.Pp)(i)?l.Z.measureWidth(i.substr(0,i.length-1),this.textProp):l.Z.measureWidth(i,this.textProp),{currentWord:i,currentWordWidth:r}},t.containsSpace=function(){if(!this.currentBreakPoint)return!1;var e=this.currentBreakPoint.position,t=this.text.charAt(e),r=this.text.charAt(e+1);return!((0,h.Wd)(t)||!(0,h.Wd)(r))},e}();function u(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function g(e,t,r){void 0===t&&(t=0),void 0===r&&(r=1e3);var i=t*r,n=i+r,o=e.slice(i,n);requestAnimationFrame((function(){o.forEach((function(e){e.splitSegmentCache=void 0})),e[n+1]&&g(e,t+1)}))}var _=function(e){function t(){return e.apply(this,arguments)||this}return(0,i.Z)(t,e),t.prototype.releasePools=function(){g(Array.from(this.pools.values())),e.prototype.releasePools.call(this)},t}(o.Z),p=function(e){function t(){return e.apply(this,arguments)||this}(0,i.Z)(t,e),t.generateKey=function(e){var t=e.text,r=e.textProp;return t+","+r.hash+","+r[a.M.BOLD]+","+r[a.M.ITALIC]+","+r[a.M.UNDERLINE]+","+r[a.M.STRIKETHROUGH]};var r=t.prototype;return r.canSplit=function(){return!0},r.splitSegment=function(e,t){var r=""+e+String(e===t),i=this.getSegmentCache(r);if(i)return i;var n=new d(this.text,this.textProp).breakLine({limitWidth:e,lineWidth:t}),o=this.splitSegmentByBreakPoints(n);return this.setSegmentCache(r,o)},r.splitSegmentByBreakPoints=function(e){for(var r,i=[],n=0,o=u(e);!(r=o()).done;){var a=r.value,s=a.position-n,l=a.width,c=this.text.substr(n,s);i.push(t.factory.createInstance({text:c,textProp:this.textProp,size:{width:l,height:this.size.height}})),n=a.position}return i},r.getSegmentCache=function(e){this.splitSegmentCache||(this.splitSegmentCache={});var t=this.splitSegmentCache[e];return t?{frontSegment:t.segments[0],backSegments:t.segments.slice(1)}:null},r.setSegmentCache=function(e,t){return this.splitSegmentCache||(this.splitSegmentCache={}),this.splitSegmentCache[e]={segments:t},{frontSegment:t[0],backSegments:t.slice(1)}},t}(n.Z);p.factory=new _(p);var v=p.factory},42023:function(e,t,r){r.d(t,{Z:function(){return o}}),r(81296);var i=r(75083);function n(e){return"number"!==typeof e?(console.error("x is not a number"),0):Math.round(100*e)/100}r(52865),r(85932),r(75793);var o=new(function(){function e(){this.measureCtx=function(){if("undefined"!==typeof window){var e=document.createElement("canvas");return e.width=1,e.height=500,e.dir="ltr",e.getContext("2d")}return null}(),this.wordCache={},this.charCache={},this.measureCtx||r.g.log.error("Measurer - cannot get measureCtx!")}var t=e.prototype;return t.measureWidth=function(e,t,r){return void 0===r&&(r=!1),n(this.getTextWidthByTextProp(e,t,r))},t.measureHeight=function(e){return n(4*Math.max(2.25,e.fontSize)/3*1.4)},t.getTextWidthByTextProp=function(e,t,r){var n=(0,i.iM)(e.codePointAt(0)||0);return 1===e.length&&"Han"===n?this.getCharWidthByTextProp(e,t,!0):this.getWordWidthByTextProp(e,t,r)},t.getWordWidthByTextProp=function(e,t,r){var i=0,n=t.font;return void 0===this.wordCache[n]&&(this.wordCache[n]={}),void 0===this.wordCache[n][e]?(i=this.calcTextWidthByTextProp(e,t),r&&(this.wordCache[n][e]=i)):i=this.wordCache[n][e],i},t.getCharWidthByTextProp=function(e,t,r){var i=0,n=t.font;return void 0===this.charCache[n]?(i=this.calcTextWidthByTextProp(e,t),r&&(this.charCache[n]=i)):i=this.charCache[n],i},t.calcTextWidthByTextProp=function(e,t){var i=0;return this.measureCtx?(this.measureCtx.font!==t.font&&(this.measureCtx.font=t.font),i=this.measureCtx.measureText(e).width):r.g.log.error("Measurer - cannot find measureCtx!"),n(i)},e}())},96172:function(e,t,r){var i;r.d(t,{w:function(){return i}}),function(e){e[e.IDLE=0]="IDLE",e[e.MOVE=1]="MOVE",e[e.SCALE=2]="SCALE"}(i||(i={}));var n=function(){function e(){this.firstFinger={x:0,y:0},this.secondFinger={x:0,y:0},this.center={x:0,y:0}}var t=e.prototype;return t.startFirstFinger=function(e,t){this.mode=i.MOVE,this.firstFinger.x=e,this.firstFinger.y=t},t.startSecondFinger=function(e,t){this.mode=i.SCALE;var r=this.firstFinger.x,n=this.firstFinger.y,o=e;this.secondFinger.x=e;var a=t;this.secondFinger.y=t,this.center.x=(r+o)/2,this.center.y=(n+a)/2,this.fingersDis=Math.sqrt((o-r)*(o-r)+(a-n)*(a-n))},t.moveFirstFinger=function(e,t){this.firstFinger.x=e,this.firstFinger.y=t},t.moveSecondFinger=function(e,t){var r=this.firstFinger.x,i=this.firstFinger.y,n=e;this.secondFinger.x=e;var o=t;this.secondFinger.y=t;var a=Math.sqrt((n-r)*(n-r)+(o-i)*(o-i));this.zoom=a/this.fingersDis},t.endUpdateFinger=function(e){this.mode=e.touches.length>1?i.SCALE:i.MOVE,e.touches.length>1?this.mode=i.SCALE:1===e.touches.length?this.mode=i.MOVE:this.mode=i.IDLE},t.end=function(){this.firstFinger.x=0,this.secondFinger.x=0,this.center.x=0,this.center.y=0,this.fingersDis=0},e}();t.Z=n},3426:function(e,t,r){r.d(t,{F:function(){return C},Z:function(){return y}});var i=r(13504),n=(r(71096),r(38934),r(31688),r(13059)),o=r(84415),a=r(46554),s=r(82017),l=r(29843),c=r(66929),h=(r(15770),r(84919),r(26894),r(71091),r(52865),r(13857),r(54371),r(95019),r(19553),r(81144),r(42986)),d=r(23884),u=r(68803),f=r(60570),g=r(34245),_=r(46114);function p(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function w(e,t,r){var i=(0,_.iF)(t),n=(0,h.Tm)((0,l.nv)(t,r));if(!n)return null;var o=(0,_.ll)({cellText:n,textFormatRuns:i,cellData:t},e);if(1===o.length)return d.Z.createInstance(o[0]);var a=new u.Z(o);return new f.Z([a])}function R(e,t,r,i){var n=(0,_.iF)(t),o=(0,l.nv)(t,i);if(!o||r<=0)return null;o=o.substr(0,5e4);var a=(0,_.ll)({cellText:o,textFormatRuns:n,cellData:t},e);return function(e){if(1===e.length&&1===e[0].length)return d.Z.createInstance(e[0][0]);for(var t,r=[],i=p(e);!(t=i()).done;){var n=t.value;r.push(new u.Z(n))}return new f.Z(r)}((0,g.Am)(a,r))}function C(e,t,r,i){var n=t,o=r,a=e.getCellDataAtPosition(n,o),c=null===a||void 0===a?void 0:a.getMergeReference();if(c&&(n=c.startRowIndex,o=c.startColIndex,a=e.getCellDataAtPosition(n,o)),!a)return{row:n,col:o,paragraph:null};var h=(0,l.jl)(e,n,o,a),d=h.paddingLeft,u=h.paddingRight,f=(0,s.D)(e,a,o)-d-u;return{row:n,col:o,paragraph:(0,s.l)(a)?R(e.spreadsheetReference,a,f,!!i):w(e.spreadsheetReference,a,!!i)}}var y=function(e){function t(t){var i;return(i=e.call(this,t)||this).formulaDisplay=!1,i._cancelSegmentFlyweight=(0,o.kf)((function(){a.Z.releasePools(),c.ZP.releasePools()}),10),i.init=function(e){var t,n=i._spreadsheet.sheetManager.getSheetBySheetId(e);if(n){i._rowData[e]=((t={}).PARAGRAPH_DATA=[],t);var o=n.highWaterMark.getMark(),a=n.getColCount()-1;r.g.log.info("fragmentRender ParagraphAccessor init, endRow:"+o+" endCol:"+a);for(var s=0;s<=o;s++)for(var l=0;l<=a;l++)i._calc(s,l,e)}else r.g.log.error("RecalculateListener init: sheetId is invalid",e,i._spreadsheet.sheetManager.sheetList)},i.shouldUseInputCellData=function(e,t){return i.inputCellData&&e===i.inputRow&&t===i.inputCol},i._calc=function(e,t,n){i._rowData[n]||i.init(n);var o=i._spreadsheet.sheetManager.getSheetBySheetId(n);if(o){var a=C(o,e,t,i.formulaDisplay),s=a.paragraph,l=a.row,c=a.col;null!==s?(i._rowData[n].PARAGRAPH_DATA[l]||(i._rowData[n].PARAGRAPH_DATA[l]=[]),i._rowData[n].PARAGRAPH_DATA[l][c]=s,i._cancelSegmentFlyweight()):i._rowData[n].PARAGRAPH_DATA[l]&&(i._rowData[n].PARAGRAPH_DATA[l][c]=void 0)}else r.g.log.error("RecalculateListener _calc: sheetId is invalid")},i.init(t.spreadsheet.activeSheetId),i}(0,i.Z)(t,e);var n=t.prototype;return n.getParagraph=function(e,t,r){if(this.shouldUseInputCellData(e,t))return this.inputCellLineData;var i=r||this._spreadsheet.activeSheetId;return this._rowData[i]&&this._rowData[i].PARAGRAPH_DATA[e]?this._rowData[i].PARAGRAPH_DATA[e][t]:void 0},n.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length||this.init(e)},n.clear=function(e,t){var r=this._spreadsheet.sheetManager.getSheetBySheetId(e);if(r){var i=this._rowData[e].PARAGRAPH_DATA,n=r.getColCount()-1;t.forEach((function(e){for(var t=e.rowStart;t<=e.rowEnd;t++)if(i[t])for(var r=0;r<=n;r++)i[t][r]=void 0}))}},n.setInputCellData=function(e,t,r){this.inputRow=e,this.inputCol=t,this.inputCellData=r;var i,n=this._spreadsheet.activeSheet,o=(0,l.jl)(n,e,t,r),a=o.paddingLeft,c=o.paddingRight,h=(0,s.D)(n,this.inputCellData,t)-a-c,d=!!this.inputCellData.getFormula();i=(0,s.l)(this.inputCellData)?R(n.spreadsheetReference,this.inputCellData,h,d):w(n.spreadsheetReference,this.inputCellData,d),this.inputCellLineData=i},n.clearInputCellData=function(){this.inputRow=-1,this.inputCol=-1,this.inputCellData=null,this.inputCellLineData=null},n.calculateRange=function(e,t,i,n){var o=this._spreadsheet.sheetManager.getSheetBySheetId(e);if(o){var a=o.getSheetId(),s=0,l=o.getColCount()-1;n&&(s=n[0],l=n[1]);for(var c=t;c<=i;c++)for(var h=s;h<=l;h++)this._calc(c,h,a)}else r.g.log.error("ParagraphAccessor calculateRange: sheetId is invalid",e)},t}(n.Z)},82017:function(e,t,r){r.d(t,{D:function(){return l},l:function(){return s}});var i=r(38086),n=r(74140),o=r(24352),a=r(90980);function s(e){var t;return(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType)===n.ZP.SELECT||(0,a.getMergedFormatValue)(e,"getWrapStrategy")===i.WRAP_STRATEGY.WRAP}function l(e,t,r){if(!t)return o.DEFAULT_COL_WIDTH;var i=0,n=t.getMergeReference();if(!n)return e.isColHidden(r)?0:e.getColWidth(r);for(var a=n.startColIndex;a<=n.endColIndex;a++)e.isColHidden(a)||(i+=e.getColWidth(a));return i}},55789:function(e,t,r){var i=r(77851),n=function(){function e(){}return e.reset=function(t){void 0!==t.lineWidth&&(e.LINE_WIDTH=t.lineWidth,e.LINE.width=e.LINE_WIDTH),void 0!==t.lineColor&&(e.LINE_COLOR=t.lineColor,e.LINE.color=e.LINE_COLOR),void 0!==t.lineStyle&&(e.LINE_STYLE=t.lineStyle,e.LINE.style=e.LINE_STYLE),void 0!==t.color&&(e.COLOR=t.color,e.FONT_STYLE.color=e.COLOR),void 0!==t.fontFamily&&(e.FONT_FAMILY=t.fontFamily,e.FONT_STYLE.fontFamily=e.FONT_FAMILY),void 0!==t.fontSize&&(e.FONT_SIZE=t.fontSize,e.FONT_STYLE.fontSize=e.FONT_SIZE),void 0!==t.backgroundColor&&(e.BACKGROUND_COLOR=t.backgroundColor)},e}();n.LINE_WIDTH=1,n.LINE_COLOR={red:220,green:220,blue:220,alpha:1,hex:"#e2e4e8"},n.LINE_STYLE=i.j2.THIN,n.LINE={width:n.LINE_WIDTH,style:n.LINE_STYLE,color:n.LINE_COLOR},n.COLOR={red:0,green:0,blue:0,alpha:1,hex:"#000000"},n.FONT_FAMILY="",n.FONT_SIZE=10,n.DIMENSION_FONT_SIZE=9,n.FONT_STYLE={color:n.COLOR,fontFamily:n.FONT_FAMILY,fontSize:n.FONT_SIZE,bold:!1,italic:!1,strikethrough:!1,underline:!1},n.BACKGROUND_COLOR={red:0,green:0,blue:0,alpha:1,hex:"#ffffff"},t.Z=n},91955:function(e,t,r){r.d(t,{h:function(){return i}});var i,n=r(85952),o=(r(19553),r(30980),r(38934),r(71091),r(16640),r(37108),r(28255),r(50104),r(25111),r(39585),r(77575),r(76880),r(11502),r(96434),r(3377),r(71318),r(21530),r(81144),r(31688),r(49502),r(87743)),a=r(2990),s=r(64737),l=r(81433),c=r(58615),h=r(75297),d=r(89485);!function(e){e[e.COPY_FRAME=1]="COPY_FRAME",e[e.WATER_MARK=2]="WATER_MARK",e[e.RANGTH_AUTH_BACKGROUND=3]="RANGTH_AUTH_BACKGROUND",e[e.RANGTH_AUTH_HIGHLIGHT=4]="RANGTH_AUTH_HIGHLIGHT",e[e.CHART_RANGE=5]="CHART_RANGE",e[e.FILTER_RANGE=6]="FILTER_RANGE",e[e.FILTER_HEADER=7]="FILTER_HEADER",e[e.COVER_BACKGROUND=8]="COVER_BACKGROUND",e[e.CELL_CORNER=9]="CELL_CORNER",e[e.COLLAB_CELL_CURSOR=10]="COLLAB_CELL_CURSOR",e[e.COMMENT_HIGHLIGHT=11]="COMMENT_HIGHLIGHT",e[e.COMMENT=12]="COMMENT",e[e.DATA_BAR=13]="DATA_BAR",e[e.VALIDATION_HEADER=14]="VALIDATION_HEADER",e[e.DATE_REMINDER=15]="DATE_REMINDER",e[e.FORMULA_LOADING=16]="FORMULA_LOADING",e[e.MENTION=17]="MENTION",e[e.PREVIEW_IMAGE=18]="PREVIEW_IMAGE",e[e.AREA_HIGHLIGHT=19]="AREA_HIGHLIGHT",e[e.SEARCH_HIGHLIGHT=20]="SEARCH_HIGHLIGHT",e[e.IMAGE_CELL=21]="IMAGE_CELL",e[e.SELECT_ROW_COL_HIGHLIGHT=22]="SELECT_ROW_COL_HIGHLIGHT",e[e.CELL_MASK=23]="CELL_MASK",e[e.CORNER_TRIANGLE=24]="CORNER_TRIANGLE",e[e.PIVOT_TABLE_COLLAPSE_BTN=25]="PIVOT_TABLE_COLLAPSE_BTN"}(i||(i={}));var u=function(){function e(e){this._collectorVector=[],this._collectorMap=new Map,this._textCollector=new a.Z(o.hy[o.g4.TextRenderer],this),this._lineCollector=new s.Z(o.hy[o.g4.LineRenderer],this,e),this._graphicsCollector=new l.Z(o.hy[o.g4.GraphicsRender],this),this._bitmapCollector=new c.Z(o.hy[o.g4.BitmapRenderer],this),this._roundRectCollector=new h.Z(o.hy[o.g4.RoundRectRenderer],this),this._path2dCollector=new d.Z(o.hy[o.g4.Path2dRenderer],this),this.spreadsheet=e,this._collectorVector=[this._textCollector,this._lineCollector,this._graphicsCollector,this._bitmapCollector,this._roundRectCollector,this._path2dCollector],this._sort(),this._collectorMap.set("DefaultText",this._textCollector),this._collectorMap.set("DefaultLine",this._lineCollector),this._collectorMap.set("DefaultGraphics",this._graphicsCollector),this._collectorMap.set("DefaultBitmap",this._bitmapCollector),this._collectorMap.set("DefaultRoundRect",this._roundRectCollector),this._collectorMap.set("DefaultPath2d",this._path2dCollector)}var t=e.prototype;return t.add=function(e,t){if(this._collectorMap.has(e))throw new Error("收集器重名，请检查");this._collectorMap.set(e,t),this._collectorVector.push(t),this._sort()},t.get=function(e){return this._collectorMap.get(e)},t.clear=function(){this._collectorVector.forEach((function(e){e.clear()})),this.clearCollectOption()},t.generateCollector=function(e,t){switch(e){case o.g4.LineRenderer:return new s.Z(t,this,this.spreadsheet);case o.g4.TextRenderer:return new a.Z(t,this);case o.g4.BitmapRenderer:return new c.Z(t,this);case o.g4.GraphicsRender:return new l.Z(t,this);case o.g4.RoundRectRenderer:return new h.Z(t,this);case o.g4.Path2dRenderer:return new d.Z(t,this);default:throw new Error("Error-RenderCollector: generateCollector")}},t.setCollectOption=function(e){this._collectOption=e},t.clearCollectOption=function(){this._collectOption=null},t._sort=function(){this._collectorVector.sort((function(e,t){return e.compare(t)}))},(0,n.Z)(e,[{key:"textCollector",get:function(){return this._textCollector}},{key:"lineCollector",get:function(){return this._lineCollector}},{key:"graphicsCollector",get:function(){return this._graphicsCollector}},{key:"bitmapCollector",get:function(){return this._bitmapCollector}},{key:"roundRectCollector",get:function(){return this._roundRectCollector}},{key:"path2dCollector",get:function(){return this._path2dCollector}},{key:"collectors",get:function(){return this._collectorVector}},{key:"collectOption",get:function(){return this._collectOption}}]),e}();t.Z=u},48385:function(e,t,r){r.d(t,{Z:function(){return i}});var i=function(){function e(e,t){this.level=e,this.collectorEngine=t}return e.prototype.compare=function(e){return this.level>e.level?1:-1},e}()},58615:function(e,t,r){var i=r(85952),n=r(13504),o=(r(12024),r(81502),function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos=[],t}(0,n.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;t&&(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))||this._renderInfos.push(e)},r.clear=function(){this._renderInfos=[]},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r(48385).Z));t.Z=o},81433:function(e,t,r){var i=r(85952),n=r(13504),o=(r(12024),r(81502),function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos={colorInfo:{},canvasPatternInfo:[]},t}(0,n.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;t&&(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))||(void 0===e.canvasPattern?(Object.prototype.hasOwnProperty.call(this._renderInfos.colorInfo,e.color)||(this._renderInfos.colorInfo[e.color]=[]),this._renderInfos.colorInfo[e.color].push(e.graphicsInfo)):this._renderInfos.canvasPatternInfo.push({path:e.graphicsInfo.path,clipInfo:e.graphicsInfo.clipInfo,canvasPattern:e.canvasPattern}))},r.clear=function(){this._renderInfos={colorInfo:{},canvasPatternInfo:[]}},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r(48385).Z));t.Z=o},64737:function(e,t,r){var i=r(58926),n=r(85952),o=r(13504),a=(r(12024),r(81502),r(1976)),s=r(48385),l=r(56584),c=r(77851),h=function(e){function t(t,r,i){var n;return(n=e.call(this,t,r)||this)._renderInfos={},n.spreadsheet=i,n}(0,o.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,n;if((!t||!(null===(n=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===n?void 0:n.includes(t)))&&e.lineProp.style!==c.j2.NONE){var o=this._toHash(e.lineProp);this._renderInfos[o]||(this._renderInfos[o]=[]),this._renderInfos[o].push((0,i.Z)(e.line))}},r.clear=function(){this._renderInfos={}},r._toHash=function(e){var t=l.ws.hex;return e.color&&(t=a.Z.isTargetType(e.color)?a.Z.getColorHexCode(e.color,this.spreadsheet):e.color.hex),e.style+"-"+e.width+"-"+t},(0,n.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(s.Z);t.Z=h},89485:function(e,t,r){var i,n=r(85952),o=r(13504),a=(r(12024),r(81502),r(48385));!function(e){e.NONZERO="nonzero",e.EVENODD="evenodd"}(i||(i={}));var s=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos={},t}(0,o.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;if(!t||!(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))){var n=e.type;this._renderInfos[n]||(this._renderInfos[n]=[]),this._renderInfos[n].push(e)}},r.clear=function(){this._renderInfos={}},(0,n.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(a.Z);t.Z=s},75297:function(e,t,r){var i=r(85952),n=r(13504),o=(r(12024),r(81502),function(e){function t(t,r){var i;return(i=e.call(this,t,r)||this)._renderInfos=[],i}(0,n.Z)(t,e);var r=t.prototype;return r.collect=function(e,t){var r,i;t&&(null===(i=null===(r=this.collectorEngine.collectOption)||void 0===r?void 0:r.exclude)||void 0===i?void 0:i.includes(t))||this._renderInfos.push({roundRectProp:e.roundRectProp,roundRectInfo:e.roundRectInfo})},r.clear=function(){this._renderInfos.length=0},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r(48385).Z));t.Z=o},2990:function(e,t,r){var i=r(85952),n=r(13504),o=function(e){function t(){var t;return(t=e.apply(this,arguments)||this)._renderInfos={},t}(0,n.Z)(t,e);var r=t.prototype;return r.collect=function(e){var t=e.textPropHash;Object.prototype.hasOwnProperty.call(this._renderInfos,t)||(this._renderInfos[t]=[]),this._renderInfos[t].push(e.textInfo)},r.clear=function(){this._renderInfos={}},(0,i.Z)(t,[{key:"renderInfos",get:function(){return this._renderInfos}}]),t}(r(48385).Z);t.Z=o},87743:function(e,t,r){var i;r.d(t,{DF:function(){return l},ZP:function(){return o},g4:function(){return n},hy:function(){return s}});var n,o=function(){function e(){}return e.prototype.setCtx=function(e){this._ctx=e},e}();!function(e){e[e.GraphicsRender=0]="GraphicsRender",e[e.RoundRectRenderer=1]="RoundRectRenderer",e[e.LineRenderer=2]="LineRenderer",e[e.TextRenderer=3]="TextRenderer",e[e.BitmapRenderer=4]="BitmapRenderer",e[e.Path2dRenderer=5]="Path2dRenderer"}(n||(n={}));var a,s=((i={})[n.GraphicsRender]=0,i[n.RoundRectRenderer]=10,i[n.TextRenderer]=20,i[n.LineRenderer]=30,i[n.BitmapRenderer]=40,i[n.Path2dRenderer]=40,i),l={CommentHighlight:s[n.GraphicsRender]+3,RangeAuthLine:s[n.GraphicsRender]+2,RangeAuthBackground:s[n.GraphicsRender]+2,CoverBackground:s[n.GraphicsRender]+2,RowColTriangle:s[n.GraphicsRender]+3,HighlightAnimate:s[n.GraphicsRender]+3,MentionTriangle:s[n.RoundRectRenderer]+1,CollabBorder:s[n.LineRenderer]+1,DataBar:s[n.GraphicsRender]+2,ChartRange:s[n.LineRenderer]+2,FormulaBackGroundMask:s[n.TextRenderer]+1,FormulaTextMask:s[n.TextRenderer]+1,SelectRowColHighlight:s[n.GraphicsRender]+7,ShapeToCellHighlight:s[n.GraphicsRender]+7};!function(e){e[e.DATE_REMINDER_ICON=0]="DATE_REMINDER_ICON"}(a||(a={}))},54253:function(e,t,r){var i;r.d(t,{M:function(){return i}}),function(e){e[e.COLOR=0]="COLOR",e[e.FONT_SIZE=1]="FONT_SIZE",e[e.FONT_FAMILY=2]="FONT_FAMILY",e[e.BOLD=3]="BOLD",e[e.ITALIC=4]="ITALIC",e[e.UNDERLINE=5]="UNDERLINE",e[e.STRIKETHROUGH=6]="STRIKETHROUGH"}(i||(i={}))},53140:function(e,t,r){r.d(t,{d:function(){return s}});var i=r(74140),n=(r(91877),r(60113),r(24591)),o=r(5004),a=r(99997);function s(e,t,r){var s,l,c=null===(s=e.metadata)||void 0===s?void 0:s.customDataType;return c===i.ZP.STAFF_CARD||c===i.ZP.GROUP_CARD||c===i.ZP.SCHEDULE||c===i.ZP.THIRD_PARTY_APP||c===i.ZP.MINI_APP?function(e,t){var r=e.fontSize,i=e.fontFamily;return{hash:a.Z.newInstance({color:o.Z.newInstanceByHex("#267EF0"),bold:!1,italic:!1,underline:!1,strikethrough:!1,fontSize:r,fontFamily:i},t).hash,underline:!1,strikethrough:!1}}(t,r):(null===(l=null===e||void 0===e?void 0:e.todoRange)||void 0===l?void 0:l.isDone)?function(e,t){var r=e.color,i=e.fontSize,s=e.fontFamily,l=e.bold,c=e.italic,h=e.underline,d=e.strikethrough,u=o.Z.newInstanceByHex((0,n.s)(r)),f=u.red,g=u.green,_=u.blue;return{hash:a.Z.newInstance({color:o.Z.newInstanceByRGB(f,g,_,.4),fontSize:i,fontFamily:s,bold:l,italic:c,underline:h,strikethrough:d},t).hash,underline:h,strikethrough:d}}(t,r):{hash:t.hash,underline:t.underline,strikethrough:t.strikethrough}}},1003:function(e,t,r){r.d(t,{Et:function(){return a},a8:function(){return n},hB:function(){return o},zP:function(){return s}});var i=r(5004),n=i.Z.newInstanceByHex("#babdc1"),o=i.Z.newInstanceByHex("#4b8cff"),a=i.Z.newInstanceByHex("#f9fafb"),s=i.Z.newInstanceByHex("#c2c2c2")},12441:function(e,t,r){function i(e,t){return[e-4,4,e-4,t-4,e-t+4,t-4]}function n(e,t){return[0,0,e,0,e,t,0,t]}r.d(t,{au:function(){return n},ns:function(){return i}})},77851:function(e,t,r){r.d(t,{WQ:function(){return s},j2:function(){return i},mY:function(){return l},v:function(){return n}}),r(52865);var i,n,o=r(74140),a=r(90980);function s(e){var t,r,i,n,s;if(e.isPrivate||e.isCanNotRead)return!1;var l=(null===(t=e.cell)||void 0===t?void 0:t.content)||"",c=null===(r=e.metadata)||void 0===r?void 0:r.customDataType;if(c===o.ZP.CHECKBOX&&(l===o.$$||l===o.Nf))return!0;if(c===o.ZP.STAR&&a.starStrReg.test(l))return!0;var h=e.image;return!(c!==o.ZP.IMAGE||!(null===h||void 0===h?void 0:h.url))||!(c!==o.ZP.SELECT||!(null===(n=null===(i=e.metadata)||void 0===i?void 0:i.config)||void 0===n?void 0:n.withColor))||c===o.ZP.DATE_REMINDER||!!(null===(s=e.dataBar)||void 0===s?void 0:s.hideData)}function l(e){var t,r;if(e.isPrivate&&e.isCanNotRead)return!1;var i=(null===(t=e.cell)||void 0===t?void 0:t.content)||"";return!((null===(r=e.metadata)||void 0===r?void 0:r.customDataType)!==o.ZP.PROGRESS||!(0,a.checkAndGetPercentage)(i)||!e.isDataValid)}!function(e){e[e.NONE=0]="NONE",e[e.THIN=3]="THIN",e[e.MEDIUM=2]="MEDIUM",e[e.DASHED=1]="DASHED",e[e.DOTTED=4]="DOTTED",e[e.THICK=5]="THICK",e[e.DOUBLE=6]="DOUBLE",e[e.HAIR=7]="HAIR",e[e.MEDIUM_DASHED=8]="MEDIUM_DASHED",e[e.DASH_DOT=9]="DASH_DOT",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.DASH_DOT_DOT=11]="DASH_DOT_DOT",e[e.MEDIUM_DASH_DOT_DOT=12]="MEDIUM_DASH_DOT_DOT",e[e.SLANTED_DASH_DOT=13]="SLANTED_DASH_DOT"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.MEDIUM=2]="MEDIUM",e[e.THICK=3]="THICK"}(n||(n={}))},42132:function(e,t,r){var i,n;r.d(t,{J:function(){return n},f:function(){return i}}),function(e){e.FORCE_DROP_WHEN_SCROLLING="FORCE_DROP_WHEN_SCROLLING"}(i||(i={})),function(e){e.CELL_CORNER="CELL_CORNER",e.LINK_ICON="LINK_ICON",e.COLLAB_CURSOR="COLLAB_CURSOR",e.CELL_EDITOR="CELL_EDITOR",e.COMMENT_BUBBLE="COMMENT_BUBBLE",e.COMMENT="COMMENT",e.DATA_BAR="DATA_BAR",e.DATE_REMINDER="DATE_REMINDER",e.FILTER_HEADER="FILTER_HEADER",e.FORMULA_LOADING="FORMULA_LOADING",e.MENTION="MENTION",e.SEARCH_HIGHLIGHT="SEARCH_HIGHLIGHT",e.SHAPE_HIGHLIGHT="SHAPE_HIGHLIGHT",e.WEWORK_COMPONENT="WEWORK_COMPONENT",e.AREA_TEXTURE="AREA_TEXTURE",e.COLLAB_AREA_CURSOR="COLLAB_AREA_CURSOR",e.TODO_BORDER="TODO_BORDER",e.COLUMN_ERROR_TIP="COLUMN_ERROR_TIP",e.ROW_COL_HIDE="ROW_COL_HIDE"}(n||(n={}))},41266:function(e,t,r){r.d(t,{Z:function(){return p}});var i,n=r(38661),o=r(13504),a=(r(38934),r(48845),r(76138)),s=r(61686),l=r(42132),c=((i={})[l.f.FORCE_DROP_WHEN_SCROLLING]=[l.J.COLLAB_CURSOR,l.J.CELL_EDITOR,l.J.SEARCH_HIGHLIGHT,l.J.SHAPE_HIGHLIGHT],i),h=250,d=1920,u=function(e,t,r,i,n,o,a,s){return Math.min(r,a)>=Math.max(e,n)&&Math.min(i,s)>=Math.max(t,o)},f=function(e,t,r){return e>=t&&e<=r},g=function(e,t){return-1!==c[t].indexOf(e)},_=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).scrolling=!1,t.fastScrollingTriggerCounter=0,t.fastScrolling=!1,t.needCalculateIfCellInInitialRange=!1,t.screenGeometry={width:d,height:d},t.onScrollingBegin=(0,s.debounce)((function(){t.scrolling=!0,t.screenGeometry={width:window.innerWidth,height:window.innerHeight}}),h,{leading:!0,trailing:!1}),t.onScrollingEnd=(0,s.debounce)((function(){!0===t.scrolling&&(t.resetRenderDefererStatus(),r.g.SpreadsheetApp.view.canvas.renderApi.renderNextTick())}),h,{leading:!1,trailing:!0}),t.setNeedCalculateIfCellInInitialRange=(0,s.throttle)((function(e){var r=(0,n.Z)(t).scrollingInitialRange;!u(r.from.flow.row,r.from.flow.col,r.to.flow.row,r.to.flow.col,e.row.flow.renderFrom,e.col.flow.renderFrom,e.row.flow.renderTo,e.col.flow.renderTo)&&(t.needCalculateIfCellInInitialRange=!1)}),250,{trailing:!0}),t.onScrolling=function(){t.onScrollingBegin(),t.onScrollingEnd(),t.setIsFastScrolling()},t}(0,o.Z)(t,e),t.getInstance=function(){return t.instance||(t.instance=new t),t.instance};var i=t.prototype;return i.isScrolling=function(){return this.scrolling},i.onAfterCellRenderWrapper=function(e,t){return this.onAfterCellRenderGenerator(e,t)},i.onAfterRenderWrapper=function(e,t){return this.onAfterRenderGenerator(e,t)},i.onAfterRowColHeadRenderWrapper=function(e,t){return this.onAfterRowColHeadRenderGenerator(e,t)},i.onAfterCellRenderGenerator=function(e,t){var i=this,n=r.g.SpreadsheetApp.view.canvas.areaData,o=g(e,l.f.FORCE_DROP_WHEN_SCROLLING);return function(e){return i.scrolling?o?i.drop():!i.fastScrolling||(r=e.row,a=e.col,s=i.scrollingInitialRange,f(r,s.from.frozen.row,s.to.frozen.row)&&f(a,s.from.frozen.col,s.to.frozen.col))||function(e,t,r,i){return!1!==i&&f(e,r.from.flow.row,r.to.flow.row)&&f(t,r.from.flow.col,r.to.flow.col)}(e.row,e.col,i.scrollingInitialRange,i.needCalculateIfCellInInitialRange)?t(e):(i.setNeedCalculateIfCellInInitialRange(n),i.drop()):t(e);var r,a,s}},i.onAfterRenderGenerator=function(e,t){var r=this,i=g(e,l.f.FORCE_DROP_WHEN_SCROLLING);return function(e){return r.scrolling&&(i||r.fastScrolling)?r.drop():t(e)}},i.onAfterRowColHeadRenderGenerator=function(e,t){var r=this,i=g(e,l.f.FORCE_DROP_WHEN_SCROLLING);return function(e){return r.scrolling&&(i||r.fastScrolling&&((null===e||void 0===e?void 0:e.row)&&(n=e.row,o=r.scrollingInitialRange,f(n,o.from.frozen.row,o.to.frozen.row)||f(n,o.from.flow.row,o.to.flow.row))||(null===e||void 0===e?void 0:e.col)&&function(e,t){return f(e,t.from.frozen.col,t.to.frozen.col)||f(e,t.from.flow.col,t.to.flow.col)}(e.col,r.scrollingInitialRange)))?r.drop():t(e);var n,o}},i.drop=function(){},i.setIsFastScrolling=function(){if(!this.fastScrolling){var e=r.g.SpreadsheetApp.view.canvas,t=e.areaData,i=e.scale,n=t.row.flow.offsetDiff,o=t.col.flow.offsetDiff,a=.04*i.scale,s=0|Math.abs(n),l=0|Math.abs(o),c=Math.max(this.screenGeometry.height,this.screenGeometry.width),h=(c=c>d?d:c)*a|0;return(s>=h||l>=h)&&(this.fastScrollingTriggerCounter+=1,this.fastScrollingTriggerCounter>3)?(this.fastScrolling=!0,this.setScrollingInitialRange(r.g.SpreadsheetApp.view.canvas.areaData)):void 0}},i.setScrollingInitialRange=function(e){this.scrollingInitialRange={from:{frozen:{row:e.row.frozen.renderFrom,col:e.col.frozen.renderFrom},flow:{row:e.row.flow.renderFrom,col:e.col.flow.renderFrom}},to:{frozen:{row:e.row.frozen.renderTo,col:e.col.frozen.renderTo},flow:{row:e.row.flow.renderTo,col:e.col.flow.renderTo}}},this.needCalculateIfCellInInitialRange=!0},i.resetRenderDefererStatus=function(){this.scrolling=!1,this.fastScrollingTriggerCounter=0,this.fastScrolling=!1,this.needCalculateIfCellInInitialRange=!1},t}(a.JT),p=_},27869:function(e,t,r){r.d(t,{O:function(){return h}});var i=r(13504),n=(r(71096),r(8195),r(77876)),o=r(3426),a=r(24352),s=function(e){function t(t){var i;return(i=e.call(this,t)||this).inputCellRowHeight=0,i.shouldUseInputCellData=function(e){return i.inputCellData&&e===i.inputRow},i._calcRowDisplayHeight=function(e,t){var n=i.getTargetSheet(t);if(n){i._rowData[t]||i.init(t);var o=l(n,e,i._paragraphAccessor);i._setRowDisplayHeight(e,o,t)}else r.g.log.error("RowcolAccessor _calcRowDisplayHeight: sheetId is invalid")},i._paragraphAccessor=t.paragraphAccessor,i.init(t.spreadsheet.activeSheetId),i}(0,i.Z)(t,e);var n=t.prototype;return n.refresh=function(e){this._rowData[e]&&0!==Object.keys(this._rowData[e]).length||this.init(e)},n.setInputCellData=function(e,t,r){this.inputRow=e,this.inputCellData=r;var i,n=this._spreadsheet.activeSheet;(i=this._paragraphAccessor.getParagraph(e,t,n.getSheetId()))&&this.inputCellRowHeight!==i.height&&(this.inputCellRowHeight=i.height,this._dataCallView.setRowHeight(e,i.height,n.getSheetId()))},n.clearInputCellData=function(){this.inputRow=-1,this.inputCellData=null,this.inputCellRowHeight=0},n.getRowSetHeight=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return c(r,e)}return c(this._spreadsheet.activeSheet,e)},n.getColSetWidth=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return r.getColWidth(e)>>0}return this._spreadsheet.activeSheet.getColWidth(e)>>0},n.getRowDisplayHeight=function(e,t){var r,i,n=this.shouldUseInputCellData(e),o=t||this._spreadsheet.activeSheetId,s=this.getRowSetHeight(e,o);return void 0!==s?i=s:(i=((null===(r=this._rowData[o])||void 0===r?void 0:r.row_display_height[e])||a.DEFAULT_ROW_HEIGHT)>>0,n&&(i=Math.max(this.inputCellRowHeight,i)),i)},n.getRowCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getRowCount()}return this._spreadsheet.activeSheet.getRowCount()},n.getColCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getColCount()}return this._spreadsheet.activeSheet.getColCount()},n.getFrozenRowCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getFrozenRowCount()}return this._spreadsheet.activeSheet.getFrozenRowCount()},n.getFrozenColCount=function(e){if(e){var t=this.getTargetSheet(e);if(t)return t.getFrozenColCount()}return this._spreadsheet.activeSheet.getFrozenColCount()},n.isRowHidden=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return r.isRowHidden(e)}return this._spreadsheet.activeSheet.isRowHidden(e)},n.isColHidden=function(e,t){if(t){var r=this.getTargetSheet(t);if(r)return r.isColHidden(e)}return this._spreadsheet.activeSheet.isColHidden(e)},n.init=function(e){var t;r.g.log.info("RowcolAccessor init",e);var i=this.getTargetSheet(e);if(i){this._rowData[e]=((t={}).row_display_height=[],t);var n=i.getRowCount()-1;r.g.log.info("fragmentRender RowcolAccessor init, endRow:"+n);for(var o=0;o<=n;o++)this._calcRowDisplayHeight(o,i.getSheetId())}else r.g.log.error("RowcolAccessor _init: sheetId is invalid",e)},n.getColsWidth=function(e,t){for(var r=0,i=e;i<=t;i++)this.isColHidden(i)||(r+=this.getColSetWidth(i));return r},n.getRowsHeight=function(e,t){for(var r=0,i=e;i<=t;i++)this.isRowHidden(i)||(r+=this.getRowDisplayHeight(i));return r},n.calculateRange=function(e,t,r){for(var i=e||this._spreadsheet.activeSheetId,n=t;n<=r;n++)"undefined"===typeof this.getRowSetHeight(n,i)&&this._calcRowDisplayHeight(n,i)},n._setRowDisplayHeight=function(e,t,r){var i;this._rowData[r]||(this._rowData[r]=((i={}).row_display_height=[],i)),this._rowData[r].row_display_height[e]!==t&&(this._rowData[r].row_display_height[e]=t,this._dataCallView.setRowHeight(e,t,r))},t}(n.Z);function l(e,t,r){for(var i,n=[],s=0;s<e.getColCount();s++){var l=e.getCellDataAtPosition(t,s);if(null===l||void 0===l?void 0:l.getMergeReference()){if(l.getMergeReference().startColIndex!==s)continue;var c=null===(i=l.getMergeReference())||void 0===i?void 0:i.getRowCount();if(c&&c>1)continue}var h=null;(h=r?r.getParagraph(t,s,e.getSheetId()):(0,o.F)(e,t,s).paragraph)&&n.push(h.height)}return Math.max.apply(Math,n.concat([a.DEFAULT_ROW_HEIGHT]))}function c(e,t){var r=(e.filterViewManager.getActiveFilterView()||e).getRowProperties(t);if(r&&null!==r.pixelSize&&0!==r.pixelSize)return r.pixelSize}function h(e,t,r){var i=c(e,t);return void 0!==i?i:(l(e,t,r)||a.DEFAULT_ROW_HEIGHT)>>0}t.Z=s},77171:function(e,t,r){function i(e){for(var t=0,r=e.getRowCount();t<r;){if(!e.isRowHidden(t))return t;t+=1}return null}function n(e){for(var t=e.getRowCount()-1;t>=0;){if(!e.isRowHidden(t))return t;t-=1}return null}function o(e){for(var t=0,r=e.getColCount();t<r;){if(!e.isColHidden(t))return t;t+=1}return null}function a(e){for(var t=e.getColCount()-1;t>=0;){if(!e.isColHidden(t))return t;t-=1}return null}r.d(t,{HN:function(){return n},Ho:function(){return o},kq:function(){return i},qA:function(){return a}})},57356:function(e,t,r){var i=r(85952),n=function(){function e(e,t,r,i){this._background=e,this._horizontalAlign=t,this._verticalAlign=r,this._wrapStrategy=i}return e.getKey=function(e,t,r,i){return e.hex+","+t.value+","+r.value+","+i.value},e.newInstance=function(t){var r=t.background,i=t.horizontalAlign,n=t.verticalAlign,o=t.wrapStrategy,a=e.getKey(r,i,n,o),s=e.pools[a];return s||(e.pools[a]=new e(r,i,n,o))},e.newInstanceByOther=function(t,r){var i={background:r.background||t._background,horizontalAlign:r.horizontalAlign||t._horizontalAlign,verticalAlign:r.verticalAlign||t._verticalAlign,wrapStrategy:r.wrapStrategy||t._wrapStrategy};return e.newInstance(i)},(0,i.Z)(e,[{key:"background",get:function(){return this._background}},{key:"horizontalAlign",get:function(){return this._horizontalAlign}},{key:"verticalAlign",get:function(){return this._verticalAlign}},{key:"wrapStrategy",get:function(){return this._wrapStrategy}}]),e}();n.pools={},t.Z=n},11989:function(e,t,r){r.d(t,{O:function(){return c}});var i=r(85952),n=r(56584),o=r(29843),a=r(7872),s=r(57356),l=function(){function e(e,t,r,i){this.content="",this.style=s.Z.newInstance({background:n._4,horizontalAlign:n.YH,verticalAlign:n.OC,wrapStrategy:n.mK}),this._padding=n.J9,null!==e&&i&&(this.content=(0,o.nv)(e),this.style=s.Z.newInstance({background:(0,o.z1)(e,i),horizontalAlign:(0,o.PE)(e),verticalAlign:(0,o.YW)(e),wrapStrategy:(0,o.fs)(e)}),e.getMergeReference()&&(this.mergeData=(0,o.fl)(e,t,r),this.mergeParent=(0,o.PF)(e,t,r)))}e.defaultCellView=function(){return new e(null,-1,-1)};var t=e.prototype;return t.isEmpty=function(){return!this.content.length},t.isAutoWrap=function(){return"normal"===this.style.wrapStrategy.value},(0,i.Z)(e,[{key:"paddingLeft",get:function(){return this._padding.left},set:function(e){this._padding=a.Z.newInstance(this._padding.top,this._padding.right,this._padding.bottom,e)}},{key:"paddingRight",get:function(){return this._padding.right},set:function(e){this._padding=a.Z.newInstance(this._padding.top,e,this._padding.bottom,this._padding.left)}},{key:"paddingTop",get:function(){return this._padding.top}},{key:"paddingBottom",get:function(){return this._padding.bottom},set:function(e){this._padding=a.Z.newInstance(this._padding.top,this._padding.right,e,this._padding.left)}}]),e}(),c=l.defaultCellView();t.Z=l},71699:function(e,t,r){r.d(t,{$x:function(){return E},EL:function(){return f},Fs:function(){return m},Jj:function(){return v},Tk:function(){return _},Z6:function(){return p},eN:function(){return g},gB:function(){return u},gi:function(){return w},hy:function(){return C},oC:function(){return y},u_:function(){return S},vJ:function(){return R}}),r(12024),r(81502);var i=r(91508),n=r(66159),o=r(27571),a=r(55578),s=r(81300),l=r(24644),c=r(74140),h=r(78173),d=r(38639);function u(e,t,i,n,o,a){var s;for(null===(s=r.g.log)||void 0===s||s.info("flow fragmentCellDataToCellView");t<=i;)e.cellDataToCellView(t,Math.min(t+50-1,i),n,o),t+=49,null===a||void 0===a||a()}function f(e,t,r,i){if(null===e)return!1;var n=e.getBasicFilter();if(null===n||void 0===n)return!1;var a=i||e.getCellDataAtPosition(t,r),s=n.range,l=null===a||void 0===a?void 0:a.getMergeReference();if(l){var c=new o.GridRange(s.sheetId,s.startRowIndex,s.startRowIndex,s.startColIndex,s.endColIndex);return t=l.startRowIndex,r=l.startColIndex,l.isCross(c)}return t===s.startRowIndex&&r>=s.startColIndex&&r<=s.endColIndex}function g(e,t,r){return!!e&&(0,d.LC)(e,t,r)}function _(e,t,r){var i;if(null===e)return!1;var o=e.getCellDataAtPosition(t,r);if(!o)return!1;var s=o.getMergeReference();s&&(t=s.startRowIndex,r=s.startColIndex);var l=(0,n.Sc)(e,t,r);return!(!l||l.validType!==a.ob.LIST||!(null===(i=l.argTokens)||void 0===i?void 0:i.length))}function p(e,t){var r,i=!1;window.clientVars.isLogin&&window.clientVars.ownerNick&&(i=!0);var n=t.sheetStatus.workbookStatus.canEdit,o=function(e,t){if(null===e)return!1;var r=e.getBasicFilter();if(null===r||void 0===r)return!1;var i=r.range;return t.sheetStatus.getRangeCanEdit(i)&&t.sheetStatus.isRangeCanEditByHighWater(i)}(e,t),a=t.spreadsheet,s=a.isFilterSync,l=null===(r=a.activeSheet.getBasicFilter())||void 0===r?void 0:r.getIsLocalView();return i&&n&&!o&&s&&!l}function v(e){var t=!1,r=e.sheetStatus.canEdit;return i.q.getConfig("isLogin")&&(t=!0),t&&r}function w(e){return!!e&&!(!e.getHyperlink()&&!e.getHyperlinkRuns())&&(null===e||void 0===e?void 0:e.getHyperlinkType())!==s.HYPERLINK_TYPE.NORMAL&&e.getLinkIconStatus()===l.Z.WITH_IMAGE}function R(e){return(null===e||void 0===e?void 0:e.getCellType())===c.ZP.DATE_REMINDER}function C(e){return(null===e||void 0===e?void 0:e.isWeworkComponent())||!1}function y(e){return!(!e||!e.getPivotTableRef())&&h.pg.includes(e.getPivotTableRef().pivotCellType)}function m(e,t,r){var i=e.getCellViewAtPosition(t,r);return(null===i||void 0===i?void 0:i.mergeParent)?{row:t+i.mergeParent.y,col:r+i.mergeParent.x}:{row:t,col:r}}function E(e){e.mergeData&&(e.mergeData.colCount-=1,1===e.mergeData.colCount&&1===e.mergeData.rowCount&&(e.mergeData=void 0))}function S(e){e.mergeData&&(e.mergeData.rowCount-=1,1===e.mergeData.colCount&&1===e.mergeData.rowCount&&(e.mergeData=void 0))}},30494:function(e,t,r){var i;r.d(t,{i:function(){return i}}),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SELECT_ACTIVE=100]="SELECT_ACTIVE",e[e.SELECT_SELECTED=200]="SELECT_SELECTED",e[e.FILTER_VIEW_ACTIVE=300]="FILTER_VIEW_ACTIVE",e[e.FILTER_VIEW_SELECTED=400]="FILTER_VIEW_SELECTED",e[e.FILTER_VIEW_DEFAULT=500]="FILTER_VIEW_DEFAULT"}(i||(i={}));var n=function(){function e(){this.index=0,this.status=i.DEFAULT,this.size=-1,this.fitLineExpand=0}var t=e.prototype;return t.setSize=function(e){this.size=e},t.expandFitLine=function(e){this.fitLineExpand=e},t.selected=function(e){this.status=e?i.FILTER_VIEW_SELECTED:i.SELECT_SELECTED},t.actived=function(e){if(this.status!==i.SELECT_SELECTED){if(e)return void(this.status=i.FILTER_VIEW_ACTIVE);this.status=i.SELECT_ACTIVE}},t.defaulted=function(e){e&&(this.status=i.FILTER_VIEW_DEFAULT)},t.resize=function(e){this.index=e,this.status=0,this.size=-1,this.fitLineExpand=0},e}();t.Z=n},29843:function(e,t,r){r.d(t,{FG:function(){return O},Hv:function(){return x},PE:function(){return S},PF:function(){return y},Sb:function(){return T},YW:function(){return D},fl:function(){return C},fs:function(){return A},jl:function(){return I},nv:function(){return R},qe:function(){return b},z1:function(){return m}}),r(12024),r(81502);var i=r(1976),n=r(5004),o=r(56584),a=r(26178),s=r(52904),l=r(77466),c=r(57856),h=r(90270),d=r(61424),u=r(71699),f=r(7872),g=r(24644),_=r(90980),p=r(99997),v=r(74140),w=r(81300);function R(e,t){var r,i=e.getEffectiveValue(),n=e.getFormattedValue();if(i&&i.type===a.Cell.EXTENDED_VALUE_TYPE.ERROR&&"object"===typeof i.value)return(null===(r=i.value)||void 0===r?void 0:r.displayText)||"";var o=null;return(null===n||void 0===n?void 0:n.type)!==a.Cell.FORMATTED_VALUE_TYPE.NORMAL&&(null===n||void 0===n?void 0:n.type)!==a.Cell.FORMATTED_VALUE_TYPE.ERROR||(o=n.value),e.getFormula()&&t&&(o=e.getEditValue()),o||""}function C(e,t,r){if(function(e,t,r){var i=e.getMergeReference();if(i){var n=i;return t===n.startRowIndex&&r===n.startColIndex}return!1}(e,t,r)){var i=e.getMergeReference();return{rowCount:i.endRowIndex-i.startRowIndex+1,colCount:i.endColIndex-i.startColIndex+1}}return null}function y(e,t,r){var i=e.getMergeReference();if(i){var n=i,o=n.startColIndex-r,a=n.startRowIndex-t;if(o||a)return{x:o,y:a}}return null}function m(e,t){if(!e)return o._4;var r=(0,_.getMergedFormatValue)(e,"getBackgroundColor");if(r){var a=i.Z.getColorRGBA(r,t),s=a.red,l=a.green,c=a.blue,h=a.alpha;return n.Z.newInstanceByRGB(s,l,c,h)}return o._4}var E=[v.ZP.DATE_REMINDER,v.ZP.STAFF_CARD,v.ZP.GROUP_CARD,v.ZP.SCHEDULE,v.ZP.TODO,v.ZP.THIRD_PARTY_APP,v.ZP.MINI_APP];function S(e){var t,r=(0,_.getMergedFormatValue)(e,"getHorizontalAlign"),i=e.getCellType();if((null===e||void 0===e?void 0:e.getLinkIconStatus())===g.Z.WITH_IMAGE||i&&E.includes(i))return t=o.YH;if(null!==r)t=r===a.Cell.Format.HORIZONTAL_ALIGN.LEFT?s.Z.newInstance(l.Z.LEFT):r===a.Cell.Format.HORIZONTAL_ALIGN.CENTER?s.Z.newInstance(l.Z.CENTER):s.Z.newInstance(l.Z.RIGHT);else if(!r&&e.getEffectiveValue()){var n=a.Cell.cellDataUtils.getExportFormat(e),c=null===e||void 0===e?void 0:e.getHyperlinkType();if(c===w.HYPERLINK_TYPE.EMAIL_LINK||c===w.HYPERLINK_TYPE.PHONE_NUMBER_LINK)return o.YH;t=n&&(0,d.isTextCell)(n.getNumberFormat())?s.Z.newInstance(l.Z.LEFT):e.getEffectiveValue().type===a.Cell.EXTENDED_VALUE_TYPE.BOOL||e.getEffectiveValue().type===a.Cell.EXTENDED_VALUE_TYPE.ERROR?s.Z.newInstance(l.Z.CENTER):e.getEffectiveValue().type===a.Cell.EXTENDED_VALUE_TYPE.NUMBER?s.Z.newInstance(l.Z.RIGHT):s.Z.newInstance(l.Z.LEFT)}else t=o.YH;return t}function D(e){var t=(0,_.getMergedFormatValue)(e,"getVerticalAlign");return null!==t?t===a.Cell.Format.VERTICAL_ALIGN.TOP?c.Z.newInstance(c.o.TOP):t===a.Cell.Format.VERTICAL_ALIGN.MIDDLE?c.Z.newInstance(c.o.MIDDLE):c.Z.newInstance(c.o.BOTTOM):o.OC}function A(e){var t=(0,_.getMergedFormatValue)(e,"getWrapStrategy");return null!==t?t===a.Cell.Format.WRAP_STRATEGY.OVERFLOW_CELL?h.Z.newInstance(h.J.NOWRAP):t===a.Cell.Format.WRAP_STRATEGY.WRAP?h.Z.newInstance(h.J.NORMAL):o.mK:o.mK}function x(e){var t;if((0,u.gi)(e)||(0,u.vJ)(e)||(0,u.hy)(e)||(0,u.oC)(e)){var r=null===(t=null===e||void 0===e?void 0:e.getUserEnteredFormat())||void 0===t?void 0:t.textFormat,i=((null===r||void 0===r?void 0:r.fontSize)||o.n5)/o.n5;return f.i.TEXT+(f.i.ICON-f.i.TEXT)*i}return f.i.TEXT}function T(e,t,r,i){return(0,u.EL)(e,t,r,i)?f.i.ICON:f.i.TEXT}function I(e,t,r,i){return{paddingLeft:x(i),paddingRight:T(e,t,r,i)}}function b(e,t){if(!e)return p.Z.newInstance(o.C8,t);var r=(0,_.getMergedTextFormat)(e)||{};return p.Z.newInstance(r,t)}function O(e,t){var r=i.Z.createColor(function(e,t){if(!e)return o.xw;var r=(0,_.getMergedFormatValue)(e,"getColor");if(!r)return o.xw;var a=i.Z.getColorRGBA(r,t),s=a.red,l=a.green,c=a.blue,h=a.alpha;return n.Z.newInstanceByRGB(s,l,c,h)}(e,t));return{textColor:r,bgColor:i.Z.createColor(m(e,t))}}},89815:function(e,t,r){r.d(t,{BG:function(){return h},UW:function(){return d},Go:function(){return R},Lg:function(){return w}}),r(52865);var i,n=r(56584),o=r(5004),a=r(77851),s=r(24352),l=function(){function e(){this.hidden=!1,this.width=s.DEFAULT_COL_WIDTH,this.height=s.DEFAULT_ROW_HEIGHT,this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.background=h[0],this.color=d[0],this.fitLineExpand=0}return e.prototype.reset=function(){this.hidden=!1,this.width=a.v.THIN,this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.fitLineExpand=0},e}(),c=/(mobile)/i.test(null===(i=r.g.navigator)||void 0===i?void 0:i.userAgent.toLowerCase()),h={0:o.Z.newInstanceByHex("#f9fafb"),100:o.Z.newInstanceByHex("#eaebec"),200:o.Z.newInstanceByHex("#5f6266"),300:o.Z.newInstanceByHex("#81868f"),400:o.Z.newInstanceByHex("#c9ddff"),500:o.Z.newInstanceByHex("#464d5a")},d={0:o.Z.newInstanceByRGB(0,0,0,.88),100:o.Z.newInstanceByRGB(0,0,0,.88),200:o.Z.newInstanceByRGB(255,255,255,.88),300:o.Z.newInstanceByHex("#f5f5f5"),400:o.Z.newInstanceByRGB(0,0,0,.88),500:o.Z.newInstanceByHex("#f5f5f5")},u={0:n.Tx,100:n.Tx,200:n.Tx,300:n.u3,400:n.u3,500:n.u3},f={width:a.v.THIN,style:a.j2.THIN,color:o.Z.newInstanceByHex("#4b8cff")},g={width:a.v.THIN,style:a.j2.THIN,color:o.Z.newInstanceByHex("#1e6fff")},_={0:null,100:c?null:f,200:c?null:f,300:g,400:g},p=new l,v=new l;function w(e,t,r){var i=r.status,n=r.size;return p.reset(),p.hidden=t.isRowHidden(e),p.height=n>=0?n:t.getRowDisplayHeight(e),p.background=h[i],p.color=d[i],p.borderBottom=u[i],p.borderRight=_[i],p.fitLineExpand=r.fitLineExpand,p}function R(e,t,r){var i=r.status,n=r.size;return v.reset(),v.hidden=t.isColHidden(e),v.width=n>=0?n:t.getColSetWidth(e),v.background=h[i],v.color=d[i],v.borderRight=u[i],v.borderBottom=_[i],v.fitLineExpand=r.fitLineExpand,v}},81617:function(e,t,r){r.d(t,{r:function(){return c}}),r(46396),r(38934),r(31688);var i=r(57856),n=r(24245),o=r(60570),a=r(23884),s=r(77466),l=r(25393);function c(e,t,r,c,d,u,f,g){var _=[];return f||(t&&u&&e.content?_.push(Object.assign(Object.assign({},(0,l.U)(g)),{offsetX:0,offsetY:0})):a.Z.isTargetType(t)?_.push({segments:[t.segment],offsetX:0,offsetY:0,width:t.width,height:t.height}):t instanceof o.Z&&t.lines.forEach((function(e){_.push({segments:e.segments,offsetX:0,offsetY:0,width:e.width,height:e.height})}))),_.length>0&&(function(e,t,r,n,o){var a=t.style.verticalAlign.value;(t.mergeData&&n>r||t.isAutoWrap()&&n>r)&&(a=i.o.TOP),o&&(a=i.o.MIDDLE);var s=0;switch(a){case i.o.TOP:s=t.paddingTop;break;case i.o.MIDDLE:s=(r-n)/2;break;case i.o.BOTTOM:s=r-n-t.paddingBottom;break;default:console.error("verticalAlign: ",this._cell.style.verticalAlign)}for(var l=s,c=0;c<e.length;c++){var h=e[c].height,d=l+3*h/4;e[c].offsetY=Math.round(100*d)/100,l+=h>>0}}(_,e,(0,n.E)(r,e,c),t.height,u),function(e,t,r,i){var n=t.style.horizontalAlign.value;i&&(n=s.Z.CENTER);for(var o=0;o<e.length;o++){var a=e[o];a.offsetX=h(t,n,a,r)}}(_,e,(0,n.o)(r,e,d),u)),_}function h(e,t,r,i){var n=0;switch(t){case s.Z.LEFT:n=e.paddingLeft;break;case s.Z.CENTER:n=(i-r.width)/2;break;case s.Z.RIGHT:n=i-r.width-e.paddingRight}return n}},72084:function(e,t,r){function i(e,t,r){for(var i,n=e.getColCount(),o=e.data.colMetadata;(t+=1)<n;)if(!(i=o[t])||!i.hiddenByFilter&&!i.hiddenByUser)return e.getCellDataAtPosition(r,t);return null}function n(e,t,r){for(var i,n=e.getRowCount(),o=e.data.rowMetadata;(r+=1)<n;)if(!(i=o[r])||!i.hiddenByFilter&&!i.hiddenByUser)return e.getCellDataAtPosition(r,t);return null}function o(e){var t;if(!e)return!1;var r=null===(t=e.getEffectiveValue())||void 0===t?void 0:t.value;return"string"===typeof r?!/^\s*$/.test(r):null!==r&&void 0!==r}r.d(t,{F5:function(){return n},FE:function(){return o},Iv:function(){return i}}),r(52865)},24245:function(e,t,r){r.d(t,{E:function(){return o},o:function(){return n}});var i=r(24352);function n(e,t,r){if(!t)return i.DEFAULT_COL_WIDTH;var n=0;if(!t.mergeData)return e.getColSetWidth(r);for(var o=0;o<t.mergeData.colCount;o++)e.isColHidden(r+o)||(n+=e.getColSetWidth(r+o));return n}function o(e,t,r){if(!t)return i.DEFAULT_ROW_HEIGHT;var n=0;if(!t.mergeData)return e.getRowDisplayHeight(r);for(var o=0;o<t.mergeData.rowCount;o++)e.isRowHidden(r+o)||(n+=e.getRowDisplayHeight(r+o));return n}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_core_part_2.f29fd660ee3d37cefcea.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_core_part_2.f29fd660ee3d37cefcea.js.map