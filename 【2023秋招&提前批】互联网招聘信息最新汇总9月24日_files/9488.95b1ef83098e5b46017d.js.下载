self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[9488],{21740:function(t,e,n){n(52865),n(64425),n(93984),n(38934),n(75793);var i=n(80067),o=n(4175),r=n(62986),a=window,u={replace:function(t){var e=a.location.href.split("?")[1],n="",i=a.location.hash;n=e&&(e=(e=e.split("&")).filter((function(t){return t.indexOf("tab=")<0&&t.indexOf("#")<0}))).length?"?"+e.join("&")+"&tab="+t:"?tab="+t,i&&(n+=i),a.history.replaceState(t,"",n)},pop:function(t){o.ZP.windowEvent.listen("popState",t)}},s={window:a,document:a.document,event:o.ZP,setHash:function(t){a.location.hash=t},getXsrf:r.f,getUrl:function(){return a.clientVars.shortLink},getQuery:i.IZ,resized:function(t){o.ZP.windowEvent.listen("resize",(function(){t()}))},sheetNode:a.sheetNode,clientVars:a.clientVars,windowEvent:o.ZP.windowEvent,bodyEvent:o.ZP.bodyEvent,pad:a.pad,History:u};e.Z=s},98918:function(t,e,n){var i,o=n(73543),r=n(38808),a=n(71217),u=n(62962),s=n(75832),l=n(49902),c=n(42427),d=n(10272),h=n(48885);!function(t){t.MutationBehavior=o.Z,function(t){t.MUTATION_ID=r.ZP,t.MUTATION_OPERATION_TYPE=a.Z,t.SetRangeMutation=s.Z,t.SetCellPropertiesMutation=l.Z}(t.Mutation||(t.Mutation={})),function(t){t.REQUEST_ID=h.Z}(t.Request||(t.Request={})),function(t){t.ReorderType=c.Z,t.DIMENSION_PROPERTIES_SLOT=u.P8}(t.Interface||(t.Interface={})),function(t){t.searchCloseDataArea=d.ZP}(t.Utils||(t.Utils={}))}(i||(i={})),e.Z=i},54552:function(t,e,n){n(38934),n(48845);var i={};if("undefined"!==typeof document&&document.addEventListener){i={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};try{i.copy=function(){function t(){e=!1,n=null,i&&window.getSelection().removeAllRanges(),i=!1}var e=!1,n=null,i=!1,o=!1;return function(r){return o||(document.addEventListener("copy",(function(t){if(e){for(var i in n)try{t.clipboardData.setData(i,n[i])}catch(i){console.error(i)}t.preventDefault()}})),o=!0),new Promise((function(o,a){e=!0,n="string"===typeof r?{"text/plain":r}:r instanceof Node?{"text/html":(new XMLSerializer).serializeToString(r)}:r;try{var u=document.getSelection();if(!document.queryCommandEnabled("copy")&&u.isCollapsed){var s=document.createRange();s.selectNodeContents(document.body),u.addRange(s),i=!0}if(!document.execCommand("copy"))throw Error("Unable to copy. Perhaps it's not available in your browser?");t(),o()}catch(l){t(),a(l)}}))}}(),i.paste=function(){var t,e,n=!1,i=!1;return function(o){return i||(document.addEventListener("paste",(function(i){if(n){n=!1,i.preventDefault();var o=t;t=null,o(i.clipboardData.getData(e))}})),i=!0),new Promise((function(i,r){n=!0,t=i,e=o||"text/plain";try{document.execCommand("paste")||(n=!1,r(Error("Unable to paste. Pasting only works in Internet Explorer at the moment.")))}catch(a){n=!1,r(Error(a))}}))}}(),"undefined"===typeof ClipboardEvent&&"undefined"!==typeof window.clipboardData&&"undefined"!==typeof window.clipboardData.setData&&(i.copy=function(t){return new Promise((function(e,n){if("string"!==typeof t&&!("text/plain"in t))throw Error("You must provide a text/plain type.");window.clipboardData.setData("Text","string"===typeof t?t:t["text/plain"])?e():n(Error("Copying was rejected."))}))},i.paste=function(){return new Promise((function(t,e){var n=window.clipboardData.getData("Text");n?t(n):e(Error("Pasting was rejected."))}))})}catch(o){console.error(o)}}else i={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};e.Z=i},76744:function(t,e){var n=function(){function t(){this.isAppended=!1,this.refCounter=0}t.getSingleton=function(){return i.append(),i};var e=t.prototype;return e.append=function(){this.hasBeenDestroyed()&&this.create(),this.refCounter++,!this.isAppended&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))},e.changeParentNode=function(t){this.element&&(this.element.remove(),t.appendChild(this.element))},e.create=function(){var t;this.element=document.createElement("textarea"),this.element.id="CopyPasteDiv",(t=this.element.style).position="fixed",t.top="-10000px",t.left="-10000px",this.element.className="copyPaste",this.element.tabIndex=-1,this.element.autocomplete="off",this.element.wrap="hard",this.element.value=" "},e.deselect=function(){this.element===document.activeElement&&document.activeElement.blur()},e.destroy=function(){this.refCounter--,this.refCounter=this.refCounter<0?0:this.refCounter,this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=void 0,this.isAppended=!1)},e.getValue=function(){return this.element.value},e.hasBeenDestroyed=function(){return this.refCounter<1},e.isActive=function(){return this.element===document.activeElement},e.select=function(){this.element.focus(),this.element.select()},e.setValue=function(t){this.element.value=t},t}(),i=new n;e.Z=n},9493:function(t,e,n){var i=n(14831),o=n.n(i),r=new(function(){function t(){}var e=t.prototype;return e.copyToSystem=function(t){var e=document.createElement("textarea");e.readOnly=!0,e.style.zIndex="0",e.style.opacity="0",e.style.top="-9999px",e.style.left="-9999px",e.style.position="fixed",document.body.appendChild(e),e.value=t;var n=document.createRange();n.selectNode(e),window.getSelection().addRange(n),e.select(),document.execCommand("SelectAll"),document.execCommand("copy"),document.body.removeChild(e)},e.isCopyOutEnv=function(){return(o().isMobilePhone||o().isAndroidPad||o().isIPad)&&this.isSupportExecCommand()&&(o().isWeChat||o().isMiniProgram)},e.isCopyInEnv=function(){return o().isQQMiniProgram},e.isSupportExecCommand=function(){var t,e;return(null===(t=document.queryCommandSupported)||void 0===t?void 0:t.call(document,"copy"))&&(null===(e=document.queryCommandSupported)||void 0===e?void 0:e.call(document,"SelectAll"))},t}());e.Z=r},82449:function(t,e,n){n.d(e,{BQ:function(){return v},JY:function(){return c.J},VH:function(){return d},n_:function(){return p},pq:function(){return h}}),n(52865),n(64425),n(85932),n(53923),n(77468);var i,o=n(11376),r=n(14831),a=n.n(r),u=n(66176),s=n(35501),l=n(69351),c=n(20241),d=(a().isWeChat,!0),h=(!a().isWeChat&&a().isMiniProgram,(null===(i=window)||void 0===i?void 0:i.tdocs)||{}),p=function(){return/mobile/.test(navigator.userAgent.toLowerCase())?f("wdocs","1.0.0")>=0:!function(){var t=navigator.userAgent.toLowerCase();return/wxdrive/.test(t)}()&&!(f("wxwork","3.1.18")<0)};function f(t,e){var n=function(t){var e=navigator.userAgent.toLowerCase(),n=e.match(new RegExp(t+"\\/(\\d+\\.\\d+\\.\\d+)"))||e.match(new RegExp(t+"\\/(\\d+\\.\\d+)"));return n?n[1]:""}(t);if(n==e)return 0;for(var i=n.split("."),o=e.split("."),r=0;i[r]&&o[r];){if(+i[r]!=+o[r])return+i[r]>+o[r]?1:-1;r+=1}return i[r]?1:o[r]?-1:0}function v(t){var e,n;if(p()&&(null===window||void 0===window?void 0:window.tdocs))a().isMobile?null===(e=window.tdocs)||void 0===e||e.openUrl({url:t,target:1}):null===(n=window.tdocs)||void 0===n||n.openInTab({url:t});else{if(a().isWeChat&&!a().isWxWork)return;a().isMiniProgram?(a().isMobile?s.default:u.Modal).confirm({title:o.ZP.t("提示"),content:o.ZP.t("因小程序限制无法直接打开链接，请将链接粘贴至浏览器查看"),onOk:function(){(0,l.T_)(t)}}):window.open(t)}}},97611:function(t,e,n){n.d(e,{ce:function(){return a},jX:function(){return c},rN:function(){return s},uv:function(){return l}}),n(46396);var i,o,r,a,u=n(11376);!function(t){t.SIMPLE="SIMPLE",t.RADIO="RADIO",t.CHECKBOX="CHECKBOX",t.SELECT="SELECT",t.DATE="DATE",t.TIME="TIME",t.TEMPERATURE="TEMPERATURE",t.LOCATION="LOCATION",t.IMAGE="IMAGE",t.CANVAS="CANVAS"}(r||(r={})),function(t){t[t.SIMPLE=0]="SIMPLE",t[t.RADIO=1]="RADIO",t[t.CHECKBOX=2]="CHECKBOX",t[t.SELECT=3]="SELECT",t[t.DATE=4]="DATE",t[t.TIME=5]="TIME",t[t.TEMPERATURE=6]="TEMPERATURE",t[t.LOCATION=7]="LOCATION",t[t.IMAGE=8]="IMAGE",t[t.CANVAS=9]="CANVAS"}(a||(a={}));var s=((i={})[a.SIMPLE]=["SIMPLE",u.ZP.t("问答题")],i[a.RADIO]=["RADIO",u.ZP.t("单选题")],i[a.CHECKBOX]=["CHECKBOX",u.ZP.t("多选题")],i[a.SELECT]=["SELECT",u.ZP.t("下拉选择题")],i[a.DATE]=["DATE",u.ZP.t("日期题")],i[a.TIME]=["TIME",u.ZP.t("时间题")],i[a.TEMPERATURE]=["TEMPERATURE",u.ZP.t("温度题")],i[a.LOCATION]=["LOCATION",u.ZP.t("地理位置题")],i[a.IMAGE]=["IMAGE",u.ZP.t("收集图片")],i[a.CANVAS]=["CANVAS",u.ZP.t("签名题")],i),l=((o={})[a.SIMPLE]={section:0,subtitle:"",placeholder:u.ZP.t("输入问题，例如“你的姓名”"),isDirty:!1,type:"SIMPLE",qdata:{placeholder:u.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:u.ZP.t("输入内容需不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},o[a.RADIO]={section:0,subtitle:"",placeholder:u.ZP.t("输入问题，例如“你的性别”"),isDirty:!1,type:"RADIO",qdata:{options:[{id:"111",title:u.ZP.t("选项 1")},{id:"222",title:u.ZP.t("选项 2")}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}},o[a.CHECKBOX]={type:"CHECKBOX",subtitle:"",isDirty:!1,placeholder:u.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:u.ZP.t("添加选项"),options:[{id:"1",title:u.ZP.t("选项 1"),isExtend:!1},{id:"2",title:u.ZP.t("选项 2"),isExtend:!1}]},validateInput:{type:"MIN",number:1}},o[a.SELECT]={type:"SELECT",subtitle:"",isDirty:!1,placeholder:u.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:u.ZP.t("请选择"),options:[{id:"1",title:u.ZP.t("选项 1"),isExtend:!1},{id:"2",title:u.ZP.t("选项 2"),isExtend:!1}]}},o[a.DATE]={type:"DATE",subtitle:"",isDirty:!1,placeholder:u.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:u.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"datetime",format:u.ZP.t('yyyy"年"m"月"d"日" hh:mm')}},o[a.TIME]={type:"TIME",subtitle:"",isDirty:!1,placeholder:u.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:u.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"timetype",format:"hh:mm"}},o[a.TEMPERATURE]={type:"TEMPERATURE",subtitle:"",isDirty:!1,placeholder:u.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:u.ZP.t("请输入小于 200 的正整数或携带一位小数的正值。"),ruletype:90}],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{unit:"celsius"}},o[a.LOCATION]={type:"LOCATION",subtitle:"",isDirty:!1,placeholder:u.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},o[a.IMAGE]={type:"IMAGE",subtitle:"",isDirty:!1,placeholder:u.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},o[a.CANVAS]={type:"CANVAS",subtitle:"",isDirty:!0,placeholder:u.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},o),c=[Object.assign(Object.assign({},l[a.SIMPLE]),{id:"1",title:u.ZP.t("未命名的问题")}),Object.assign(Object.assign({},l[a.RADIO]),{id:"2",title:u.ZP.t("未命名的问题")})]},23545:function(t,e,n){var i,o;n.d(e,{Wj:function(){return o}}),function(t){t[t.Unknow=0]="Unknow",t[t.Text=1]="Text",t[t.Radio=2]="Radio",t[t.Checkbox=3]="Checkbox",t[t.StudentKey=4]="StudentKey",t[t.Location=5]="Location",t[t.NameAutoFill=6]="NameAutoFill",t[t.DepartmentAutoFill=7]="DepartmentAutoFill",t[t.Exception=8]="Exception",t[t.Image=9]="Image",t[t.File=10]="File",t[t.Date=11]="Date"}(i||(i={})),function(t){t[t.draft=1]="draft",t[t.vote=4]="vote",t[t.queue=8]="queue",t[t.customDocTpl=128]="customDocTpl"}(o||(o={}))},43500:function(t,e,n){n.d(e,{Z:function(){return M}}),n(19553),n(38934),n(81144),n(25594),n(15770),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(31688),n(12024),n(81502),n(90109),n(52865),n(64425),n(62883),n(26894),n(93984),n(41031),n(84919),n(13857),n(54371),n(95019);var i=n(89577),o=n(86280),r=n(74140),a=n(58926),u=(n(8195),n(20589));function s(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var c=/(序号|编号|姓名|名字|名称|人员|成员|商品名称|负责人|岗位|职位|性别|电话|联系方式|号码|手机号|民族|籍贯|毕业院校|专业|学位|学历|身份证|身份证号码|户口所在地|金额|类型|工作单位|年龄|项目|类别|分类|事项|产品|日期|时间|日期时间|星期|生日|出生月日|进展|阶段进展|阶段成果|项目进展|项目成果|状态|下周计划|目标|任务|KPI|OKR|备注|说明|价格|售价|单价|部门|语文|数学|英语|政治|历史|地理|物理|化学|生物)/i;function d(t){return t.values.map((function(t){var e;if(!t||(null===(e=t.getMetadata())||void 0===e?void 0:e.customDataType))return null;var n=null===t||void 0===t?void 0:t.getEditValue(),i=null===t||void 0===t?void 0:t.getFormattedValue();return(null===i||void 0===i?void 0:i.value)||n}))}var h=function(t,e){for(var n=e;n>=0;n--)if(t[n])return t[n];return null},p=function(t){for(var e=t[t.length-1];!e;)t.pop(),e=t[t.length-1]},f=function(t,e){for(var n=[],i=0;i<e.length;i++){var o=e[i];n.push({col:i,row:t,value:(o||"-").substr(0,100)})}return n};function v(t,e){var n=e.slice(0);n=function(t,e){var n=[],i=function(t){return null===t||void 0===t?void 0:t.getMergeReference()};return e.forEach((function(e){var o=t[e],r=d(o),a=o.values.some(i),u="",s=new Map;r.forEach((function(t){var e=t||"";s.set(e,1),u+=e}));for(var l=0,c=u.length,h=0;h<c;h++)u.charCodeAt(h)>128&&(l+=1);(!a&&l/c<.2||s.size<2)&&n.push(e)})),n.forEach((function(t){var n=e.indexOf(t);e.splice(n,1)})),e}(t,n);var i=new Map,o=[],r=[],u=0;return n.forEach((function(e,n){var s=d(t[e]),l=[].concat(r),c=u;u=s.length,p(s),r.length=0,t[e].values.forEach((function(t){return function(t,e){var n=null===e||void 0===e?void 0:e.getMergeReference();if(n&&!(n.endRowIndex>10)){var i=n.startRowIndex+","+n.endRowIndex;t.includes(i)||t.push(i)}}(r,t)})),r.forEach((function(t){return o.includes(t)?null:o.push(t)}));var f=!!o.length,v=!!l.length,m=i.get(n-1);if(f&&v&&o.some((function(t){return l.includes(t)}))&&m){var g=function(t,e,n){for(var i=(0,a.Z)(t),o=0;o<n;o++){var r=e[o],u=t[o]?t[o]:h(t,o);r&&u&&(i[o]=u+" - "+r)}return i}(m,s,c);i.set(n-1,g)}else i.set(n,s)})),{cellIndexMap:i,indexs:n,mergeRanges:o}}function m(t,e){for(var n=[],i=0;i<10;i++){var o=e[i];!t[i]||o&&o.hiddenByUser||n.push(i)}for(var r=[],a=0;a<n.length;a++)for(var u=n[a],s=t[u].values,l=0,c=0;c<s.length;c++){var d=s[c];if(null===d||void 0===d?void 0:d.getEditValue()){if((l+=1)>=2){r.push(u);break}}else l=0}return r}function g(t,e,n){for(var i,o=e.cellIndexMap,r=e.indexs,a=e.mergeRanges.map((function(t){return t.split(",").map((function(t){return Number(t)}))})),u=new Map,l=s(o);!(i=l()).done;){var d=i.value,f=d[0],v={emptys:0,solids:0,keywords:0,total:0},m=d[1].slice(0);p(m);for(var g=0;g<m.length;g++){var E=m[g];E||0===g?v.solids+=1:v.emptys-=1,c.test(E)&&(v.keywords+=2)}v.total=v.emptys+v.solids+v.keywords,u.set(f,v)}for(var w,y=[],I=s(u.values());!(w=I()).done;){var A=w.value;y.push(A.total)}var b=y.indexOf(Math.max.apply(null,y)),C=Array.from(u.keys())[b],D=r[C];a=a.filter((function(t){var e=t[0],n=t[1];return D>=e&&D<=n}));var R=o.get(C)||[];return a.length&&a.some((function(t){return t[0]===t[1]&&t[0]===D}))&&t[D].values.forEach((function(t,e){if((null===t||void 0===t?void 0:t.getMergeReference())&&e<R.length&&null===R[e]){var i=h(R,e);i&&n?R.splice(e,1,i):R.splice(e,1)}})),{headData:R,hitLine:D,merges:a}}n.n(u)()((function(t){try{var e=function(t,e){void 0===e&&(e=!1);var n=t.data;if(!n||!n.rowData||!n.rowMetadata)return null;var i=n.rowData,o=g(i,v(i,m(i,n.rowMetadata)),e),r=o.headData,a=o.hitLine,u=o.merges;return a>=0?{headDatas:f(a,r),merges:u}:null}(t,!0);if(!e||0===e.headDatas.length)return null;var n=e.headDatas,o=e.merges,r=n[0],u=r.row,s=r.col,l=n[n.length-1].col,c=0===o.length?u:Math.max.apply(Math,(0,a.Z)(o.map((function(t){return t[t.length-1]}))));return new i.Z(t.getSheetId(),u,c,s,l)}catch(d){return console.error(d),null}}),15);var E=n(67465),w=n(85624);function y(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return I(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var A=function(t,e){for(var n=e;n>=0;n--)if(t[n])return t[n];return null},b=function(t){for(var e=t[t.length-1];!e;)t.pop(),e=t[t.length-1]},C=function(t,e,n,o,a){for(var u,s=[],l=n[e],c=(null===l||void 0===l?void 0:l.values)||[],d=Math.max(o,c.length),h=0;h<d;h++){var p=c[h],f=(null===p||void 0===p?void 0:p.getEditValue())||"",v=null===p||void 0===p?void 0:p.getFormula(),m=null===p||void 0===p?void 0:p.getMergeReference(),g=null===p||void 0===p?void 0:p.getDataValidation(),E=null===p||void 0===p?void 0:p.getMetadata();if(!f&&m){var y=m.startRowIndex,I=m.startColIndex,A=null===(u=n[y])||void 0===u?void 0:u.values[I];A&&(f=A.getEditValue()||"")}var b=T(t,e,h,m),C=!(0,w.Nb)(t,[m||new i.Z(t.spreadsheet.activeSheetId,e,e,h,h)]),M=D(t,e,h),x=(null===g||void 0===g?void 0:g.ruleType)||null,O=void 0,P=null;(null===E||void 0===E?void 0:E.customDataType)===r.ZP.IMAGE&&(P={url:t.spreadsheet.activeSheet.imageManager.getImage(p.getRefIds()[0]).url}),a&&(O=R(a,e,h)),s.push({col:h,row:e,value:f,isFormula:!!v,isMerge:!!m,dvRule:x,isRangeAuth:b,isRangeAuthRead:C,isInHighWater:M,cellImage:P,floatImage:O})}return s};function D(t,e,n){var o=t.spreadsheet.activeSheetId;return t.sheetStatus.isRangeCanEditByHighWater(new i.Z(o,e,e,n,n))}function R(t,e,n){var i=t.getCellFloatImages(e,n);return i.length>0?i:void 0}function T(t,e,n,r){var a,u,s=t.spreadsheet.activeSheetId,l=null===(a=t.serviceCollection.services.get(o.Z.MOBILE_RANGE_AUTH))||void 0===a?void 0:a.instance,c=null===(u=null===l||void 0===l?void 0:l.rangeAuthUtil.getActiveSheetRangeIds())||void 0===u?void 0:u.rangeIds;if(!(null===c||void 0===c?void 0:c.length))return!0;var d=r||{startRowIndex:e,endRowIndex:e,startColIndex:n,endColIndex:n},h=d.startRowIndex,p=d.endRowIndex,f=d.startColIndex,v=d.endColIndex;return t.sheetStatus.getRangeCanEdit(new i.Z(s,h,p,f,v))}var M=function(){function t(t){var e=this;this.onMutationChange=function(){e.panelUpdateFn&&e.panelUpdateFn()},this.onCooperationAddNewRangeDone=function(){e.onMutationChange()},this.app=t,this.initConfig()}var e=t.prototype;return e.isFillAble=function(){var t=this;if(this.getHeader(),!this.isHit()||this.activeRow<0)return!1;if(this.merges[0]){if(!this.merges.every((function(e){var n=e[1];return t.activeRow>n})))return!1}else if(this.activeRow<=this.hitLine)return!1;return!0},e.isQuicklookAble=function(){return this.getHeader(),this.isHit()},e.getHeader=function(t){this.activeCol=-1,this.activeRow=-1,this.hitLine=-1,this.merges=[],this.isQuickFill=!!t;try{return this.find()}catch(e){return console.error(e),this.getResult()}},e.getRowData=function(t){var e=this.getData().rowData||[];return t<e.length&&t>=0?e[t]:[]},e.addListener=function(t){this.panelUpdateFn=t,this.app.mutationBehavior.emitter.addListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.listen(E.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},e.removeListener=function(){this.panelUpdateFn=null,this.app.mutationBehavior.emitter.removeListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.remove(E.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},e.getQuickFillRange=function(){var t=this.getHeader(),e=t.activeCol,n=t.activeRow,i=this.app.spreadsheet.activeSheet.getRowCount();return{fillRowRange:[this.hitLine+1,i-1],activeCol:e,activeRow:n}},e.getQuickFillData=function(t,e){var n=this.getHeader(),i=n.headDatas,o=n.activeCol,r=n.activeRow,a=this.app.spreadsheet.activeSheet.data;return{headDatas:i,activeCol:o,activeRow:r,rowData:C(this.app,t,a.rowData,i.length,e)}},e.isHit=function(){return this.hitLine>=0},e.initConfig=function(){this.MAX_FIND_ROWS=10,this.VALID_CONTINUES=2,this.KEYWORD_REG=/(序号|编号|姓名|名字|名称|人员|成员|商品名称|负责人|岗位|职位|性别|电话|联系方式|号码|手机号|民族|籍贯|毕业院校|专业|学位|学历|身份证|身份证号码|户口所在地|金额|类型|工作单位|城市|地点|年龄|项目|类别|分类|事项|产品|日期|时间|日期时间|星期|生日|出生月日|进展|阶段进展|阶段成果|项目进展|项目成果|状态|下周计划|目标|任务|KPI|OKR|备注|说明|价格|售价|单价|部门|语文|数学|英语|政治|历史|地理|物理|化学|生物)/i},e.getResult=function(t){return void 0===t&&(t=[]),{headDatas:t,line:this.hitLine,merges:this.merges,activeCol:this.activeCol,activeRow:this.activeRow,activeRowDatas:this.activeRowDatas||[]}},e.find=function(){var t=this.getData();if(!t||!t.rowData||!t.rowMetadata)return this.getResult();var e=this.app.view.getSelection();this.activeRow=e.activeCell.rowIndex,this.activeCol=e.activeCell.colIndex;var n=t.rowData,i=g(n,v(n,m(n,t.rowMetadata)),this.isQuickFill),o=i.headData,r=i.hitLine,a=i.merges;return this.hitLine=r,this.merges=a,this.isQuickFill&&-1!==this.activeRow?this.activeRowDatas=C(this.app,this.activeRow,n,o.length):this.activeRowDatas=[],this.isHit()?this.getResult(function(t,e){for(var n=[],i=0;i<e.length;i++){var o=e[i];n.push({col:i,row:t,value:o||"-"})}return n}(this.hitLine,o)):this.getResult()},e.getData=function(){return this.app.spreadsheet.sheetManager.getSheetBySheetId(this.app.spreadsheet.getActiveSheetId()).data},e.getValidRowIndexs=function(t,e){for(var n=[],i=0;i<this.MAX_FIND_ROWS;i++)if(t[i]){var o=e[i];o&&o.hiddenByUser||n.push(i)}for(var r=[],a=0;a<n.length;a++){for(var u=n[a],s=t[u].values,l=0,c=0,d=0;d<s.length;d++){var h=s[d];(null===h||void 0===h?void 0:h.getEditValue())?(c+=1)>=this.VALID_CONTINUES&&(l+=1):c=0}l&&r.push(u)}return r},e.getHeadFromValidRows=function(t,e){var n=this,i=e.slice(0);i=this.filterInvalidContents(t,i);for(var o=this.getLineValues(t,i),r=this.getMergeValues(t,i),a=new Map,u=function(t){var e=o[t],i=r[t],u=r[t-1],s=[],l=[];i.forEach((function(t){if(t){var e=t.startRowIndex+","+t.endRowIndex;s.push(e),n.merges.includes(e)||n.merges.push(e)}})),u&&u.forEach((function(t){t&&l.push(t.startRowIndex+","+t.endRowIndex)}));var c=!!s.length,d=!!l.length,h=a.get(t-1);c&&d&&s.some((function(t){return l.includes(t)}))&&h?(h.push(e),a.set(t-1,h)):a.set(t,[e])},s=0;s<o.length;s++)u(s);for(var l,c=new Map,d=y(a);!(l=d()).done;){var h=l.value,p=h[0],f=h[1],v=f[0].slice(0),m=this.getMergeCombines(v,f);b(m),c.set(p,m)}return{cellIndexMap:c,indexs:i}},e.getMergeCombines=function(t,e){var n=t.slice(0);if(e.length>1)for(var i=1;i<e.length;i++)for(var o=e[i],r=0;r<t.length;r++){var a=o[r],u=t[r]?t[r]:A(t,r);a&&u&&(n[r]=u+" - "+a)}return n},e.getMatching=function(t,e){var n=this,i=e.cellIndexMap,o=e.indexs;this.merges=this.merges.map((function(t){return t.split(",").map((function(t){return Number(t)}))}));for(var r,a=new Map,u=y(i);!(r=u()).done;){var s=r.value,l=s[0],c={emptys:0,solids:0,keywords:0,total:0},d=s[1].slice(0);b(d);for(var h=0;h<d.length;h++){var p=d[h];p?c.solids+=1:c.emptys-=1,this.KEYWORD_REG.test(p)&&(c.keywords+=2)}c.total=c.emptys+c.solids+c.keywords,a.set(l,c)}for(var f,v=[],m=y(a.values());!(f=m()).done;){var g=f.value;v.push(g.total)}var E=v.indexOf(Math.max.apply(null,v)),w=Array.from(a.keys())[E];this.hitLine=o[w],this.merges=this.merges.filter((function(t){var e=t[0],i=t[1];return n.hitLine>=e&&n.hitLine<=i}));var I=i.get(w)||[];return this.merges.length&&this.merges.some((function(t){return t[0]===t[1]&&t[0]===n.hitLine}))&&this.getMergeValues(t,[this.hitLine])[0].forEach((function(t,e){if(t&&e<I.length&&null===I[e]){var i=A(I,e);i&&n.isQuickFill?I.splice(e,1,i):I.splice(e,1)}})),I},e.filterInvalidContents=function(t,e){var n=this.getLineValues(t,e),i=this.getMergeValues(t,e),o=[];return n.forEach((function(t,n){var r=!i[n].every((function(t){return null===t})),a="",u=new Map;t.forEach((function(t){var e=t||"";u.set(e,1),a+=e}));for(var s=0,l=a.length,c=0;c<l;c++)a.charCodeAt(c)>128&&(s+=1);if(!r&&s/l<.2||u.size<2){var d=e[n];o.push(d)}})),o.forEach((function(t){var n=e.indexOf(t);e.splice(n,1)})),e},e.getLineValues=function(t,e){return e.map((function(e){return t[e].values.map((function(t){var e=null===t||void 0===t?void 0:t.getEditValue(),n=null===t||void 0===t?void 0:t.getFormattedValue();return(null===n||void 0===n?void 0:n.value)||e}))}))},e.getMergeValues=function(t,e){return e.map((function(e){return t[e].values.map((function(t){return null===t||void 0===t?void 0:t.getMergeReference()}))}))},t}()},40182:function(t,e,n){n.d(e,{uH:function(){return s},Yq:function(){return l},Fd:function(){return c},Bk:function(){return d},gB:function(){return h}}),n(38934),n(48845),n(19553),n(71091),n(81144),n(25594);var i=n(11376),o=n(80067),r=n(14831),a=n.n(r),u=function(){function t(t){this.buttonMenuDom=$(".hp-ui-button-menu"),this.menuDom=$(".hp-ui-button-menu-wrapper a"),this.type=t.type,this.title=t.title,this.content=t.content,this.inputMaxLength=t.inputMaxLength,this.inputOverflowTips=t.inputOverflowTips,this.buttons=t.buttons,this.onClose=t.onClose,this.dialogDom=null,this.dialogInputDom=null,this.dialogInputErrorDom=null,this.init()}var e=t.prototype;return e.createDom=function(t,e,n){var i=$(document.createElement(e));return i.addClass(n),t.append(i),i},e.show=function(){var t=this;this.dialogDom=this.createDom($(document.body),"div","m-component-dialog"),this.dialogDom.on("touchmove",(function(t){t.preventDefault()})),this.createDom(this.dialogDom,"div","m-component-dialog-mask").on("touchstart touchend",(function(t){t.preventDefault()}));var e=this.createDom(this.dialogDom,"div","m-component-dialog-body"),n=this.createDom(e,"div","m-component-dialog-title");this.title&&this.title.length>0&&n.text(this.title),n.on("touchstart touchend",(function(t){t.preventDefault()}));var i=this.createDom(e,"div","m-component-dialog-content");if("InputBox"===this.type){e.addClass("m-component-dialog-body-input"),document.body.clientHeight<500&&((0,o.gr)()?e.css("top",96):e.css("top",72));var r=this.createDom(i,"div","m-component-dialog-input-box"),a=r[0].clientWidth-28;this.dialogInputDom=this.createDom(r,"input","m-component-dialog-input"),this.dialogInputDom.css("width",a),this.dialogInputDom.attr("spellcheck","false"),this.dialogInputDom.attr("required","required"),this.content&&this.content.length>0&&this.dialogInputDom.val(this.content),this.bindInputListener(this.dialogInputDom);var u=this.createDom(r,"div","m-component-dialog-input-clear");this.addTap(u,(function(){t.dialogInputDom.val(""),t.inputBoxValChange()})),this.dialogInputErrorDom=this.createDom(i,"div","m-component-dialog-input-error-hidden");var s=document.createElement("p");this.dialogInputErrorDom.append(s),i.append(this.dialogInputErrorDom)}else this.content&&this.content.length>0&&this.createDom(i,"div","m-component-dialog-message").text(this.content);for(var l=this.createDom(e,"div","m-component-dialog-footer"),c=0;c<this.buttons.length;c++){var d=this.buttons[c];if(d.label&&d.label.length>0){var h=$(document.createElement("a"));h.addClass("m-component-dialog-button");var p="m-component-dialog-btn-default";"primary"===d.type?p="m-component-dialog-btn-primary":"danger"===d.type&&(p="m-component-dialog-btn-danger"),h.addClass(p),h.text(d.label),l.append(h),this.bindButtonListener(h,d)}}"InputBox"===this.type&&this.focusInputBox()},e.close=function(){var t;null===(t=this.onClose)||void 0===t||t.call(this),this.dialogDom.remove()},e.getInputText=function(){return this.dialogInputDom.val()},e.showInputErrorTips=function(t){this.dialogInputErrorDom.addClass("m-component-dialog-input-error"),this.dialogInputErrorDom.children("p").text(t),this.focusInputBox()},e.checkInputError=function(){var t=!1;if(this.inputMaxLength&&this.inputMaxLength>0&&this.dialogInputDom.val().length>this.inputMaxLength){var e=i.ZP.t("输入内容过长。");this.inputOverflowTips&&this.inputOverflowTips.length>0&&(e=this.inputOverflowTips),this.showInputErrorTips(e),t=!0}return t},e.focusInputBox=function(){var t=this;a().isIOS?this.dialogInputDom.focus():setTimeout((function(){t.dialogInputDom.focus().click()}),100)},e.inputBoxValChange=function(){this.checkInputError()&&this.dialogInputErrorDom.removeClass("m-component-dialog-input-error")},e.bindInputListener=function(t){var e=this;t.on("input propertychange change",(function(){e.inputBoxValChange()})),t.blur((function(){if(a().isIOS)for(var t=0;t<e.buttons.length;t++){var n=e.buttons[t];if("primary"===n.type){n.onclick&&"function"===typeof n.onclick&&n.onclick(e);break}}}))},e.bindButtonListener=function(t,e){var n=this,i=!1,o=function(t){i||(i=!0,e.onclick&&"function"===typeof e.onclick?e.onclick(n,t):n.close())};t.on("touchend",o),t.on("click",o)},e.addTap=function(t,e){t.on("touchstart",(function(t){var e=t.originalEvent.touches[0];this.touchX=e.clientX,this.touchY=e.clientY,this.touchT=Date.now()})),t.on("touchend",(function(t){t.preventDefault();var n=t.originalEvent.changedTouches[0],i=n.clientX,o=n.clientY;void 0===this.touchT||Date.now()>this.touchT+400||Math.abs(o-this.touchY)>30||Math.abs(i-this.touchX)>30||e()}))},e.init=function(){var t=this;this.buttonMenuDom.on("click",(function(){var e=t.buttonMenuDom;if(!e.attr("disabled")){$("#tooltip").remove();var n=e.hasClass("hp-ui-button-menu-reverse"),i=e.find(".hp-ui-button-menu-wrapper"),o=e.find(".hp-ui-button-list-ul"),r=e.find(".hp-ui-button-list-ul li"),a=-1;if(e.data("close",t.buttonCloseMenu),i.is(":visible"))t.buttonCloseMenu(e);else{o.css("min-width",e.outerWidth()+"px"),i.show(),e.addClass("hp-ui-button-active");var u=Math.max(200,Math.min($("body").height()-o.offset().top-50,435));o.css("max-height",u+"px"),n&&o.css("top","-"+(o.outerHeight()+e.outerHeight()+10)+"px"),window.setTimeout((function(){$("body").on("keydown.hp-ui-button-menu",(function(n){if(i.is(":hidden"))return!0;var u=a;switch(n.keyCode){case 13:return o.find("li.hp-ui-button-menuitem-selected > a").trigger("click"),!1;case 27:return t.buttonCloseMenu(e),!1;case 38:a=a-1<0?r.length-1:a-1;break;case 40:a=(a+1)%r.length;break;default:return!0}return o.find("li:nth-child("+(u+1)+")").removeClass("hp-ui-button-menuitem-selected"),o.find("li:nth-child("+(a+1)+")").addClass("hp-ui-button-menuitem-selected"),!1})).on("click.hp-ui-button-menu",(function(){t.buttonCloseMenu(e)}))}),0)}}})),this.menuDom.on("click",(function(){if(!t.menuDom.hasClass("hp-ui-button-menu-disabled")){var e=t.menuDom.closest(".hp-ui-button");e.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),t.buttonCloseMenu(e)}}))},e.buttonCloseMenu=function(t){$("body").off(".hp-ui-button-menu"),t.find(".hp-ui-button-menu-wrapper").hide(),t.removeClass("hp-ui-button-active"),t.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),t.trigger("menu-closed")},t}(),s=function(){return Promise.resolve().then((function(){return{default:u}}))},l=function(){return n.e(3936).then(n.bind(n,36918))},c=function(){return n.e(1182).then(n.bind(n,49932))},d=function(){return Promise.resolve().then(n.bind(n,78216))},h=function(){return n.e(3536).then(n.bind(n,48146))}},67465:function(t,e,n){n.d(e,{J:function(){return o},k:function(){return i}});var i={PROTECT_RANGE:"protectRange",PROTECT_SHEET:"protectSheet",CHECK_ALL_RANGE_AUTH:"checkAllRangeAuth",SHOW_EXIT_RANGE_SELECTOR:"showExitRangeSelector",SHOW_RANGE_AUTH:"showRangeAuth",HIDE_RANGE_AUTH:"hideRangeAuth",SWITCH_SHEET_AND_CHANGE_RANGED_ID:"switchSheetAndChangeRangedId",ADD_NEW_RANGE_AUTH:"addNewRangeAuth",DIMENSION_CHANGE:"dimensionChange",DELETE_RANGE_AUTH:"deleteRangeAuth",UPDATE_RANGE_AUTH:"updateRangeAuth",COOERATION_ADD_NEW_RANGE_DONE:"cooperationAddNewRangeDone",RANGE_AUTH_CHANGE:"rangeAuthChange",COOPERATION_INITED:"cooperation_inited",OWNER_INITED:"ownerInited",AUTH_INITED:"authInited",SHOW_RANGE_AUTH_SELECT_AREA:"showRangeAuthSelectArea"},o={SHOW_RANGE_AUTH_ICO:"showRangeAuthIco",HIDE_RANGE_AUTH_ICO:"hideRangeAuthIco"}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/9488.95b1ef83098e5b46017d.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=9488.95b1ef83098e5b46017d.js.map