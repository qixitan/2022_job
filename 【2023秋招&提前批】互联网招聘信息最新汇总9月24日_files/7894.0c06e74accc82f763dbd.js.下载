self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[7894],{89776:function(t,e,n){n.d(e,{ES:function(){return b},Hu:function(){return y},_Y:function(){return E},c_:function(){return x},e7:function(){return w},jZ:function(){return _},px:function(){return k},q2:function(){return g}}),n(38934),n(48845),n(52865),n(20670),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(54552),o=n(30516),i=n(9493),a=n(75227),c=n(14831),u=n.n(c),l=n(76744),s=n(12591);function f(){"use strict";f=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(S){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new E(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=x(a,n);if(c){if(c===s)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=u;var s={};function h(){}function d(){}function v(){}var p={};c(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(L([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=v.prototype=h.prototype=Object.create(p);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function x(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return s;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,s;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return d.prototype=v,c(y,"constructor",v),c(v,"constructor",d),d.displayName=c(v,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},w(_.prototype),c(_.prototype,i,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new _(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=L,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),s}},t}var h,d,v=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function c(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}u((r=r.apply(t,e||[])).next())}))},p={html:null,plain:null,json:null,timeStamp:0},m=l.Z.getSingleton();function g(t){return v(this,void 0,void 0,f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u().isMac&&m.select(),e.abrupt("return",(0,s.writeInClipBoard)(t));case 2:case"end":return e.stop()}}),e)})))}var y=function(){p={html:null,plain:null,json:null,timeStamp:0}},w=function(){return p},_=function(){return d},x=function(t,e,n,r){(p={html:t,plain:e,json:n}).timeStamp=Date.now(),function(t){d=t}(r)},b=function(t){var e=t.copyContent,o=t.type,c=e.html,u=e.plain,l=e.json,s=void 0===l?"":l;if(i.Z.isCopyOutEnv())return i.Z.copyToSystem(u),void x(c,u,s,o);try{r.Z.copy({"text/plain":u,"text/html":c,"text/json":s}).catch((function(t){console.error(t)})).then((function(){var t,e;0!==(null===(e=null===(t=null===n.g||void 0===n.g?void 0:n.g.tdocs)||void 0===t?void 0:t.compare)||void 0===e?void 0:e.call(t,"0"))&&a.Z.wait(0).run((function(){var t,e;c&&c.length>492426&&console.warn("安卓手Q可能写入富文本剪贴板失败"),null===(e=null===(t=n.g.tdocs)||void 0===t?void 0:t.setClipboardData)||void 0===e||e.call(t,{plain:u,html:c})})),x(c,u,s,o)}))}catch(f){}},k=function(){return v(void 0,void 0,void 0,f().mark((function t(){var e,r;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,s.readInClipBoard)();case 3:return r=t.sent,t.abrupt("return",r);case 7:return t.prev=7,t.t0=t.catch(0),null===(e=n.g.log)||void 0===e||e.error("syncMobileClipboard error",t.t0),t.abrupt("return",{html:"",plain:""});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))};try{null===(h=n.g.mqq)||void 0===h||h.addEventListener("qbrowserVisibilityChange",(function(t){t.hidden||k()}))}catch(L){}var E=function(t,e,n,r){return!t&&!e&&0===(null===r||void 0===r?void 0:r.length)||!function(t,e,n){return!t&&!n&&e&&_()===o.GI.input&&e===w().plain}(t,e,n)&&function(t,e){return!!p.html&&!!t&&-1!==t.indexOf(p.html)&&void 0!==p.html&&void 0!==p.plain&&e.replace(/\r\n/g,"\n")===p.plain.replace(/\r\n/g,"\n")}(t.replace(/&amp;/g,"&"),e)}},30516:function(t,e,n){n.d(e,{GI:function(){return l},Gu:function(){return r},P0:function(){return s},XE:function(){return c},gN:function(){return a},lb:function(){return u},lr:function(){return o},o_:function(){return i},yM:function(){return h}});var r,o,i,a,c,u,l,s,f=n(76138);!function(t){t.TEXT="text/plain",t.HTML="text/html",t.IMAGE="image/png",t.JPEG="image/jpeg"}(r||(r={})),function(t){t.all="all",t.row="row",t.col="col",t.cells="cells"}(o||(o={})),function(t){t[t.tencent=0]="tencent",t[t.excel=1]="excel",t[t.unknown=2]="unknown"}(i||(i={})),function(t){t[t.COPY_CACHE=0]="COPY_CACHE",t[t.OUTER=1]="OUTER",t[t.TRANSPOSE=2]="TRANSPOSE",t[t.ONLYVALUE=3]="ONLYVALUE",t[t.CLEAR_AUTO_PARSE=4]="CLEAR_AUTO_PARSE",t[t.MERGE_STYLES=5]="MERGE_STYLES"}(a||(a={})),function(t){t[t.illegal=-1]="illegal",t[t.richText=3]="richText",t[t.text=4]="text"}(c||(c={})),function(t){t[t.copy=0]="copy",t[t.cut=1]="cut"}(u||(u={})),function(t){t[t.table=1]="table",t[t.shapes=2]="shapes",t[t.input=3]="input"}(l||(l={})),function(t){t[t.NONE=1]="NONE",t[t.CACHE=2]="CACHE",t[t.CLIPBOARD=3]="CLIPBOARD"}(s||(s={}));var h=(0,f.yh)("ICopyPaste")},69351:function(t,e,n){n.d(e,{Gq:function(){return k},IG:function(){return _},Mg:function(){return x},NM:function(){return b},T_:function(){return L},V3:function(){return w},VA:function(){return y},_8:function(){return g}}),n(38934),n(48845),n(15770),n(90109),n(52865),n(85932),n(33552),n(53923),n(77468),n(75793),n(74686),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425);var r=n(11376),o=n(91508),i=(n(14831),n(62986),n(56592)),a=n.n(i),c=n(53613),u=n(49406),l=n(82449),s=n(84701),f=n(89776),h=n(30516),d=(n(8326),n(38246));function v(){"use strict";v=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(S){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof f?e:f,i=Object.create(o.prototype),a=new E(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=x(a,n);if(c){if(c===s)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(S){return{type:"throw",arg:S}}}t.wrap=u;var s={};function f(){}function h(){}function d(){}var p={};c(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(L([])));g&&g!==e&&n.call(g,o)&&(p=g);var y=d.prototype=f.prototype=Object.create(p);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function x(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return s;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,s;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function L(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return h.prototype=d,c(y,"constructor",d),c(d,"constructor",h),h.displayName=c(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},w(_.prototype),c(_.prototype,i,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new _(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=L,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),s}},t}var p=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function c(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}u((r=r.apply(t,e||[])).next())}))},m=window;function g(t,e,n){var r;"link"===t&&(r="func=8"),"relink"===t&&(r="func=10&auto_sync_source=n_xls_form_link_old_done"),"unlink"===t&&(r="func=7");var o="/formcol/export_data?"+r+"&form_id="+e+"&"+(n&&"unlink"!==t?"docid="+n:"");return new Promise((function(t,e){(0,c.wq)().then((function(){return a().post(o).then((function(n){var r,o,i=n.data;return 0===(null===(r=null===i||void 0===i?void 0:i.head)||void 0===r?void 0:r.ret)?t(""):e(null===(o=null===i||void 0===i?void 0:i.head)||void 0===o?void 0:o.stack)})).catch((function(){return e()}))}))}))}function y(t){var e="/formcol/smartcollect_detail_list?type=3&sync_excel_id="+t;return new Promise((function(t,n){a().post(e).then((function(e){var r,o,i,a=e.data;0===(null===(r=null===a||void 0===a?void 0:a.head)||void 0===r?void 0:r.ret)?t((null===(o=null===a||void 0===a?void 0:a.body)||void 0===o?void 0:o.form_items)||[]):n(null===(i=null===a||void 0===a?void 0:a.head)||void 0===i?void 0:i.ret)})).catch((function(t){n(t)}))}))}function w(){var t=function(){var t=o.q.getConfig("padId"),e=function(t){var e=window.location.search.match(new RegExp("(\\?|&)"+t+"=([^&]*)(&|$)"));return e?decodeURIComponent(e[2]):""}("scode");return"/txdoc/getinfo?docid="+t+"&scode="+e+"&with_rev=true&nocache=true&ignorlocaldiff=true"}();return new Promise((function(e,n){a().post(t).then((function(t){var r,o,i,a,c=t.data;0===(null===(r=null===c||void 0===c?void 0:c.head)||void 0===r?void 0:r.ret)&&(null===(o=null===c||void 0===c?void 0:c.body)||void 0===o?void 0:o.fileInfo)?e(null===(i=null===c||void 0===c?void 0:c.body)||void 0===i?void 0:i.fileInfo):n(null===(a=null===c||void 0===c?void 0:c.head)||void 0===a?void 0:a.ret)})).catch((function(t){n(t)}))}))}function _(t){var e=new FormData;return e.append("func","13"),e.append("form",JSON.stringify(t)),e.append("f","json"),(0,c.wq)().then((function(){return new Promise((function(t,n){a().post("/formcol/mgr",e).then((function(e){var r,o,i,a,c=e.data;0===(null===(r=null===c||void 0===c?void 0:c.head)||void 0===r?void 0:r.ret)&&(null===(o=null===c||void 0===c?void 0:c.body)||void 0===o?void 0:o.form)?t(null===(i=null===c||void 0===c?void 0:c.body)||void 0===i?void 0:i.form):n(null===(a=null===c||void 0===c?void 0:c.head)||void 0===a?void 0:a.ret)})).catch((function(t){n(t)}))}))}))}function x(){return new Promise((function(t,e){a().post("/formcol/select_list?func=1").then((function(n){var r,o,i,a=n.data;if(0===(null===(r=null===a||void 0===a?void 0:a.head)||void 0===r?void 0:r.ret)){var c=(null===(i=null===(o=null===a||void 0===a?void 0:a.body)||void 0===o?void 0:o.sync_form_list)||void 0===i?void 0:i.items)||[];t(c)}else e()})).catch((function(){e()}))}))}function b(t){var e="/formcol/export_data?func=11&form_id="+t;return new Promise((function(t,n){a().post(e).then((function(e){var r,o,i,a,c=e.data;0===(null===(r=null===c||void 0===c?void 0:c.head)||void 0===r?void 0:r.ret)&&(null===(o=null===c||void 0===c?void 0:c.body)||void 0===o?void 0:o.doc_url)?t(null===(i=null===c||void 0===c?void 0:c.body)||void 0===i?void 0:i.doc_url):n(null===(a=null===c||void 0===c?void 0:c.head)||void 0===a?void 0:a.stack)})).catch((function(t){n(t)}))}))}function k(t){var e;return p(this,void 0,void 0,v().mark((function n(){var i,a,c,u,s,f,h,p,m,g,y,w;return v().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(e=null===window||void 0===window?void 0:window.tdocs)||void 0===e?void 0:e.forwardFormsToWXWork){n.next=2;break}return n.abrupt("return",-1);case 2:return i=t.form_id,a=t.fill_cnt,c=t.title,u=t.share_url,s=t.note,(f=s)||(h=o.q.getConfig("userName"),f=r.ZP.t('"{{nickName}}" 邀请大家参与收集表',{nickName:h})),n.next=7,E({doc_id:[i]});case 7:p=n.sent,m=null===p||void 0===p?void 0:p[0],g=m.str_vote_card,y=m.str_source_app,w=[{form_id:i,fill_cnt:a,title:c,link:u,desc:f,imgUrl:d,str_vote_card:g,str_source_app:y}];try{null===l.pq||void 0===l.pq||l.pq.forwardFormsToWXWork({forms:w})}catch(v){console.error(v)}case 11:case"end":return n.stop()}}),n)})))}function E(t){var e=t.doc_id.map((function(t){return t.startsWith("c2_")?"doc_id="+t:"doc_id=c2_"+t})).join("&");return a().get("/diskshare/get_form_forward_data?"+e).then((function(t){var e,n,r,o=t.data;return 0===(null===(e=null===o||void 0===o?void 0:o.head)||void 0===e?void 0:e.ret)&&(null===(n=null===o||void 0===o?void 0:o.body)||void 0===n?void 0:n.items)?null===(r=null===o||void 0===o?void 0:o.body)||void 0===r?void 0:r.items:[{}]})).catch((function(){return[{}]}))}function L(t){t?((0,f.ES)({copyContent:{html:t,plain:t},type:h.GI.input}),s.Snackbar.show({type:"success",message:r.ZP.t("已复制分享链接"),autoClose:!0,closable:!0})):m.T_SHEET.CoreUI.toast.showToast(r.ZP.t("获取分享链接失败"),void 0,{toolToastCloseTime:3e3}),(0,u.KVR_Report)("n_xls_form_share",{Channel1:"link",Channel2:""})}},53613:function(t,e,n){function r(){return Promise.resolve()}function o(t,e){return void 0===e&&(e=0),!!(t&e)}n.d(e,{l6:function(){return o},wq:function(){return r}}),n(53923),n(52865),n(77468),n(85932),n(38934),n(31688),n(62883),n(48845)},49406:function(t,e,n){n.r(e),n.d(e,{KVR_Report:function(){return P}}),n(38934),n(48845),n(46396),n(71096),n(19553),n(71091),n(81144),n(90109),n(10012),n(31688),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(84919),n(11425),n(15770);var r=n(11376),o=n(26178),i=n(98161),a=n(98918),c=n(14831),u=n.n(c),l=n(8326),s=n(84701),f=n(69351),h=n(91508),d=n(78216),v=n(53613),p=n(43500),m=n(23545),g=n(21740),y=n(66176),w=n(35501),_=n(82449),x=n(97611),b=n(31973),k=n(89307),E=n(80067),L=n(4175),C=n(76852);function S(){"use strict";S=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(C){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof f?e:f,i=Object.create(o.prototype),a=new k(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=_(a,n);if(c){if(c===s)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=u;var s={};function f(){}function h(){}function d(){}var v={};c(v,o,(function(){return this}));var p=Object.getPrototypeOf,m=p&&p(p(E([])));m&&m!==e&&n.call(m,o)&&(v=m);var g=d.prototype=f.prototype=Object.create(v);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,c){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return s;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,s;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function E(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:L}}function L(){return{value:void 0,done:!0}}return h.prototype=d,c(g,"constructor",d),c(d,"constructor",h),h.displayName=c(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(w.prototype),c(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),c(g,a,"Generator"),c(g,o,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=E,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;b(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),s}},t}var T=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(e){i(e)}}function c(t){try{u(r.throw(t))}catch(e){i(e)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}u((r=r.apply(t,e||[])).next())}))},O=u().isMobile?w.default:y.Modal,I=n.g,P=function(t,e){b.ZP.kvrOss(Object.assign({itemname:t,CropID:h.q.getConfig("corpId"),DocID:h.q.getConfig("padId"),biz:"personal"},e))},D=function(){function t(t){this.initDialogPromise=null,t&&this.init(t)}var e=t.prototype;return e.init=function(t){this.app=t,this.initRelation(),this.initToolbarEntry(),this.afterHandleCallbacks=[],this.seeker=new p.Z(t),this.initUrlChange(),g.Z.event.formRelationEvent.listen("formRelationChange",this.updateRelation.bind(this))},e.handle=function(t,e,n,r,o){var i,a,c=(null===o||void 0===o?void 0:o.formId)||(null===(i=null===o||void 0===o?void 0:o.form)||void 0===i?void 0:i.sync_form_id)||(null===(a=this.getRelation(e||""))||void 0===a?void 0:a.form_id),u=null===o||void 0===o?void 0:o.activeArea;switch(t){case"new_to_form":this.handleNewToFormWedoc(null===o||void 0===o?void 0:o.questions,null===o||void 0===o?void 0:o.title);break;case"new_to_form_mobile":this.handleNewToFormWedocMobile(null===o||void 0===o?void 0:o.questions,null===o||void 0===o?void 0:o.title);break;case"convert_to_form":this.handleConvertToFormWedoc();break;case"check_form":this.handleCheckForm(c,u);break;case"cancel_form":case"cancel_form_sheetbar":this.handleCancelForm(c,n);break;case"change_header":this.updateToolbar();break;case"wedoc_cancelform_all":this.handleCancelAllForm();break;case"wedoc_get_form_by_user":this.handleCheckAllFormByUser(n);break;case"wedoc_link_form_by_user":this.linkOwnerForm(c||"",n,o.relink);break;case"wedoc_checkform_in_doc":this.handleCheckAllFormInDoc(n);break;case"wedoc_send_wxwork":this.handleShareWxwork(c);break;case"wedoc_copy_link":this.handleCopyLink(c);break;case"wedoc_qrcode":this.handleShowQRCode(c)}n&&this.afterHandleCallbacks.push(n)},e.initUrlChange=function(){var t;null===(t=null===k.DI||void 0===k.DI?void 0:k.DI.onUrlChange)||void 0===t||t.call(k.DI,(function(t){var e=t.url,n=(0,E.IZ)("tab",e),r=I.SpreadsheetApp.spreadsheet.getActiveSheetId();n!==r&&L.ZP.sheetsBar.trigger("switchSheet",n,r)}))},e.isRelated=function(t){return t in this.relateMap},e.getFormDetails=function(t){return t in this.formDetailsMap?this.formDetailsMap[t]:null},e.isLoading=function(){return this.needShowLoading},e.getRelatedSheetId=function(){return Object.keys(this.relateMap)[0]},e.getRelatedNumber=function(){return Object.keys(this.relateMap).length},e.updateFromSheetHeaderSync=function(t,e){var n=this.isRelated(t),r=e===o.Sheet.SHEET_TYPE.FORM;r&&!n?(this.updateRelateMap(t,{}),this.updateUI()):!r&&n&&(this.updateRelateMap(t,null),this.updateUI())},e.updateFromSyncMutations=function(t,e){for(var n=!1,r=0;r<t.length&&!n;r++){var o=t[r];if(!Array.isArray(o))break;for(var i=0;i<o.length;i++){var c=this.app.mutationBehavior.deserializeMutation(o[i]),u=a.Z.Mutation.MUTATION_ID.DELETE_SHEET_RANGE_MUTATION,l=["<author>","<time>"].indexOf(c.workbookRangeId)>-1;if((null===c||void 0===c?void 0:c.workbookRangeId)&&c.id===u&&l){n=!0;break}}}n&&(this.updateRelateMap(e,null),this.updateUI())},e.checkFormSyncExceptions=function(){return!1},e.continueCheck=function(){},e.stopCheckSync=function(){i.Z.util.timer.erase(this.checkTimeFlag)},e.isOpenDialog=function(){return!1},e.updateSelectedData=function(){},e.hideSelectQuestionDialog=function(){},e.getRelation=function(t){var e;return(null===(e=this.relateMap)||void 0===e?void 0:e[t])||null},e.isRelateFormPublished=function(){return T(this,void 0,void 0,S().mark((function t(){return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",!0);case 1:case"end":return t.stop()}}),t)})))},e.checkCollectSheetType=function(){return!0},e.getRelatedIn=function(){return null},e.getRelatedSheetIdByDocId=function(){return""},e.getRelatedInfos=function(){return[]},e.checkReleaseCell=function(t,e,n){var r=n||this.app.spreadsheet.activeSheet,o=r.data.colMetadata,i=r.data.rowMetadata,a=null===o||void 0===o?void 0:o[e],c=null===i||void 0===i?void 0:i[t],u=null===a||void 0===a?void 0:a.formData,l=null===c||void 0===c?void 0:c.formData;if(u&&l){if("question"===l.formDataId)return 1;if(l.formDataId.indexOf("record")>=0)return 2}return 0},e.checkReleaseRange=function(t,e,n,r){for(var o=t.startColIndex,i=t.startRowIndex,a=t.endColIndex,c=t.endRowIndex,u=0,l=i;l<c;l++)for(var s=o;s<a;s++){var f=null===n||void 0===n?void 0:n[s],h=null===e||void 0===e?void 0:e[l],d=null===f||void 0===f?void 0:f.formData,v=null===h||void 0===h?void 0:h.formData;if(d&&v&&0!==(u=this.getRelatedRangeType(v.formDataId,r)))return u}return u},e.getRelatedRangeType=function(t,e){var n=0;return"question"===t&&(n=1),t.indexOf("record")>=0&&(n=2),!n||3!==e&&4!==e&&e!==n?0:e},e.initRelation=function(){this.relateMap=Object.create(null),this.updateRelation()},e.initToolbarEntry=function(){var t=this;I.addEventListener("load",(function(){t.updateToolbar()}),!1),this.updateToolbar()},e.getToolbarEntryElement=function(){var t=this.toolbarEntryElement;return t||(t=document.querySelector("#toolbar-form-dropdown-group"),this.toolbarEntryElement=t),t},e.showToolbarEntry=function(){var t=this.getToolbarEntryElement();t&&(t.style.display="")},e.hideToolbarEntry=function(){var t=this.getToolbarEntryElement();t&&(t.style.display="none")},e.getSheetTitle=function(){return h.q.getConfig("isUserChangeTitle")?h.q.getConfig("title"):""},e.getTitle=function(){var t=this.getSheetTitle()||r.ZP.t("无标题收集表");return t.length>32?t.substr(0,32):t},e.createFail=function(t,e){var n=e&&(e.msg||e.errmsg);this.showToolToast(n?r.ZP.t("创建关联收集表失败：{{msg}}。",{msg:n}):r.ZP.t("网络异常，创建失败。")),i.Z.event.sheetsBar.trigger("deleteSheet",t)},e.handleDone=function(){for(;this.afterHandleCallbacks.length;){var t=this.afterHandleCallbacks.shift();t&&t()}},e.updateUI=function(){this.updateToolbar(),this.updateSheetbar()},e.updateSheetbar=function(){i.Z.event.sheetsBar.trigger("bindStatusChange")},e.updateToolbar=function(){var t=this.getRelatedNumber();h.q.getConfig("isCreator")&&t?this.showToolbarEntry():this.hideToolbarEntry()},e.updateRelateMap=function(t,e){e?this.relateMap[t]=e:delete this.relateMap[t]},e.initDialog=function(){return T(this,void 0,void 0,S().mark((function t(){var e=this;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initDialogPromise){t.next=2;break}return t.abrupt("return",this.initDialogPromise);case 2:return this.initDialogPromise=T(e,void 0,void 0,S().mark((function t(){var e,r,o;return S().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e(3298),n.e(6929)]).then(n.bind(n,48351));case 2:return e=t.sent,this.formSelectDialog=new e.default({linkOwnerForm:this.linkOwnerForm.bind(this),openFormSheet:this.handleOpenFormSheet.bind(this)}),t.next=6,Promise.all([n.e(3298),n.e(6929)]).then(n.bind(n,93998));case 6:return r=t.sent,this.questionListDialog=new r.default({app:this.app,creatDraft:this.handleNewToFormWedoc.bind(this)}),t.next=10,Promise.all([n.e(3298),n.e(6929)]).then(n.bind(n,29827));case 10:return o=t.sent,this.qrDialog=new o.default({app:this.app}),t.abrupt("return",!0);case 13:case"end":return t.stop()}}),t,this)}))),t.abrupt("return",this.initDialogPromise);case 4:case"end":return t.stop()}}),t,this)})))},e.handleNewToFormWedocMobile=function(t,e){void 0===t&&(t=[]),void 0===e&&(e="新建收集表");var n,r=this.app.spreadsheet.getSpreadsheetId();if(0===t.length){if(n="n_xls_form_link_new_done",P("n_xls_form_link_click",{Channel1:"new",Channel2:"mobile",Extra1:""}),_.VH){var o="https://"+l.Z.getConfig("runtime.domainName")+"/mall/m/index/form/collect",i=u().isWxWork?"&from_page=related_form":"";return void(0,v.wq)().then((function(){var t=o+"?excel_id="+r+i;(0,C.tencentDocOpenUrlForAll)({url:t})})).catch((function(t){console.error("addtolist check failed. details: "+t)}))}t=x.jX}else n="n_xls_form_link_sheet_done",P("n_xls_form_link_click",{Channel1:"sheet",Channel2:"mobile",Extra1:""});var a={sections:[{sid:"0",title:"",qlist:t.map((function(t,e){return""+(e+1)}))}],questions:t},c={title:e,note:"",cover_img:"",draft_ext:{from_excel:r,from_excel_n_xls_form_link:n},tx_question:JSON.stringify(a)};(0,f.IG)(c).then((function(t){var e="https://"+l.Z.getConfig("runtime.domainName")+"/forms/"+t.form_id+"?page=1";(0,_.BQ)(e)})).catch((function(e){console.error("new form from wedoc error: "+e+", question list: "+t+", form: "+c)}))},e.handleNewToFormWedoc=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e="新建收集表"),T(this,void 0,void 0,S().mark((function n(){var r,o,i,a,c=this;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.app.spreadsheet.getSpreadsheetId(),0!==t.length){n.next=11;break}if(o="n_xls_form_link_new_done",P("n_xls_form_link_click",{Channel1:"new",Channel2:"pc",Extra1:""}),!_.VH){n.next=8;break}return i="https://"+l.Z.getConfig("runtime.domainName")+"/mall/index/form/collect",(0,v.wq)().then((function(){(0,_.BQ)(i+"?excel_id="+r)})),n.abrupt("return");case 8:t=x.jX,n.next=13;break;case 11:o="n_xls_form_link_sheet_done",P("n_xls_form_link_click",{Channel1:"sheet",Channel2:"pc",Extra1:""});case 13:a={title:e,note:"",cover_img:"",draft_ext:{from_excel:r,from_excel_n_xls_form_link:o},tx_question:JSON.stringify({sections:[{sid:"0",title:"",qlist:t.map((function(t,e){return""+(e+1)}))}],questions:t})},(0,f.IG)(a).then((function(t){var e;I.open("https://"+l.Z.getConfig("runtime.domainName")+"/forms/"+t.form_id+"?page=1"),null===(e=c.formSelectDialog)||void 0===e||e.close()})).catch((function(e){console.error("new form from wedoc error: "+e+", question list: "+t+", form: "+a)}));case 15:case"end":return n.stop()}}),n,this)})))},e.handleConvertToFormWedoc=function(){var t;return T(this,void 0,void 0,S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initDialog();case 2:null===(t=null===this||void 0===this?void 0:this.questionListDialog)||void 0===t||t.show();case 3:case"end":return e.stop()}}),e,this)})))},e.handleCheckForm=function(t,e){var n;return T(this,void 0,void 0,S().mark((function r(){var o,i,a,c,s,f,h,d,p,g;return S().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=2;break}return r.abrupt("return");case 2:if(this.formDetailsMap){r.next=5;break}return r.next=5,this.updateDetails();case 5:if(null===(n=this.formDetailsMap)||void 0===n?void 0:n[t]){r.next=7;break}return r.abrupt("return");case 7:o=this.formDetailsMap[t],i=o.form_flag,a=void 0===i?0:i,c=o.form_id,s=(0,v.l6)(a,m.Wj.vote),f=(0,v.l6)(a,m.Wj.queue),h=e?"&active_area="+e:"",d="",d=s?"https://"+l.Z.getConfig("runtime.domainName")+"/forms/v/"+c+"?page=1"+h:f?"https://"+l.Z.getConfig("runtime.domainName")+"/forms/q/"+c+"?page=1"+h:"https://"+l.Z.getConfig("runtime.domainName")+"/forms/"+c+"?page=1"+h,p="menu","filled"===e&&(p="fill"),"detail"===e&&(p="result"),"unfilled"===e&&(p="unfill"),"shareSheet"===e&&(p="shareSheet"),(0,_.BQ)(d),g=u().isMobile?"mobile":"pc",P("n_xls_form_jump",{Channel1:p,Channel2:g,Extra1:""});case 21:case"end":return r.stop()}}),r,this)})))},e.handleCancelAllForm=function(){var t=this;i.Z.event.default.trigger("link_sheet_delete",(function(){t.relateMap=Object.create(null),t.updateUI()}))},e.handleCheckAllFormByUser=function(t){var e;return T(this,void 0,void 0,S().mark((function n(){return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.updateOwnerFormList();case 2:if(!t){n.next=6;break}t(this.ownerFormList),n.next=9;break;case 6:return n.next=8,this.initDialog();case 8:null===(e=null===this||void 0===this?void 0:this.formSelectDialog)||void 0===e||e.show(this.ownerFormList);case 9:case"end":return n.stop()}}),n,this)})))},e.handleShowQRCode=function(t){var e;return T(this,void 0,void 0,S().mark((function n(){var r,o,i;return S().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=6;break}if(r=null===(e=this.formDetailsMap)||void 0===e?void 0:e[t],o=r.title,i=r.share_url,!o||!i){n.next=6;break}return n.next=5,this.initDialog();case 5:this.qrDialog.show(o,i);case 6:case"end":return n.stop()}}),n,this)})))},e.handleOpenFormSheet=function(t){t&&(0,f.NM)(t).then((function(t){I.open(t)}),(function(){s.default.show({type:"error",message:r.ZP.t("获取链接失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}})}))},e.handleWaitingForm=function(){var t=this;if(this.waitingFormId)for(var e in this.relateMap)this.relateMap[e].form_id===this.waitingFormId&&(t.app.spreadsheet.activeSheetId,setTimeout((function(){}),500),t.waitingFormId="")},e.linkOwnerForm=function(t,e,n){var o=this;void 0===n&&(n=!1);var i=this.app.spreadsheet.getSpreadsheetId(),a=n?"relink":"link",c=u().isMobile?"mobile":"pc";return P("n_xls_form_link_click",{Channel1:"old",Channel2:c,Extra1:""}),(0,f._8)(a,t,i).then((function(){var n;s.default.show({type:"success",message:r.ZP.t("已关联"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===(n=null===o||void 0===o?void 0:o.formSelectDialog)||void 0===n||n.close(),o.waitingFormId=t,setTimeout((function(){o.waitingFormId=""}),1500),null===e||void 0===e||e(!0)})).catch((function(t){s.default.show({type:"error",message:r.ZP.t(t)||r.ZP.t("关联失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===e||void 0===e||e(!1)}))},e.handleCheckAllFormInDoc=function(t){return T(this,void 0,void 0,S().mark((function e(){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateDetails();case 2:n=Object.values(this.formDetailsMap),null===t||void 0===t||t(n);case 4:case"end":return e.stop()}}),e,this)})))},e.handleShareWxwork=function(t){return T(this,void 0,void 0,S().mark((function e(){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,(0,f.Gq)(this.formDetailsMap[t]);case 3:P("n_xls_form_share",{Channel1:"forward",Channel2:"",Extra1:""});case 4:case"end":return e.stop()}}),e,this)})))},e.handleCopyLink=function(t){var e;t&&(0,f.T_)(null===(e=this.formDetailsMap[t])||void 0===e?void 0:e.share_url)},e.updateRelation=function(){var t=this;return(0,f.V3)().then((function(e){var n=e.sync_form_id,r=e.form_list;t.relateMap=Object.create(null),n&&(t.relateMap.BB08J2={form_id:n,form_status:1,subid:"BB08J2"}),r&&r.forEach((function(e){1===e.form_status&&(t.relateMap[e.subid]={form_id:e.form_id,form_status:e.form_status,subid:e.subid})})),t.handleWaitingForm(),t.updateSheetbar()}))},e.updateDetails=function(){var t=this,e=this.app.spreadsheet.getSpreadsheetId();return(0,f.VA)(e).then((function(e){for(var n in t.formDetailsMap=Object.create(null),e.length>0&&e.forEach((function(e){t.formDetailsMap[e.sync_id||e.form_id]=Object.assign({},e)})),t.relateMap){var r=t.relateMap[n].form_id;r in t.formDetailsMap&&(t.formDetailsMap[r].subid=n)}return e}))},e.updateOwnerFormList=function(){var t=this;return(0,f.Mg)().then((function(e){t.ownerFormList=[],e.forEach((function(e){t.ownerFormList.push(Object.assign({},e))}))}))},e.handleCancelForm=function(t,e){var n=this;if(t){var o=function(){(0,f._8)("unlink",t).then((function(){var t;s.default.show({type:"success",message:r.ZP.t("已取消关联"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===(t=null===n||void 0===n?void 0:n.formSelectDialog)||void 0===t||t.close(),null===e||void 0===e||e()}),(function(){s.default.show({type:"error",message:r.ZP.t("取消关联失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),null===e||void 0===e||e()}));var o=u().isMobile?"mobile":"pc";P("n_xls_form_unlink",{Channel1:"",Channel2:o,Extra1:""})};if(e)o();else{var i=r.ZP.t("确定取消关联收集表吗？取消关联后，收集的结果将不再自动更新到当前表格。");O.confirm({className:"unlink-confirm-dialog",title:r.ZP.t("取消关联收集表"),content:i,okText:r.ZP.t("取消关联"),cancelText:r.ZP.t("保留"),onOk:function(){o()}})}}},e.showToolToast=function(t){(0,d.showToast)(t,{},{toolToastCloseTime:3e3})},t}();e.default=D}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/7894.0c06e74accc82f763dbd.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=7894.0c06e74accc82f763dbd.js.map