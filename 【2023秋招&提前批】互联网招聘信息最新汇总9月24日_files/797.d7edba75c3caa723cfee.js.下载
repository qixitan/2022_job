self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[797],{79047:function(t,e,n){if(n.d(e,{Ar:function(){return a},DZ:function(){return s},Mi:function(){return i}}),n(53923),n(52865),n(77468),n(85932),n(38934),n(31688),n(62883),6042==n.j)var r=n(91508);var o=n(35100);function i(t,e){var n=new RegExp("(.*)\\((\\d*)\\)"),r="",o=0;if(n.test(e)){var i=e.match(n);i&&(r=i[1])}else r=e;return t.forEach((function(t){var e=t.match(n);if(e&&r===e[1]){var i=e[2];if(i){var a=Number(i);a>=o&&(o=a+1)}else o=o||1}})),o?r+"("+o+")":e}function a(){return!r.q.getConfig("creatorCorpId")&&(0,o.c)()}function s(t,e){return""+t.domain_id+t.pad_id===""+e.domain_id+e.pad_id}},40797:function(t,e,n){n.r(e),n.d(e,{default:function(){return ne}}),n(38934),n(48845),n(46396),n(26894),n(71091),n(19553),n(81144),n(30980),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(31688),n(52865),n(64425),n(12024),n(81502),n(90109),n(25594),n(15770),n(84919),n(13857),n(54371),n(95019),n(31575),n(5570),n(64656),n(43125),n(27849),n(11425);var r,o,i=n(11376),a=n(26178),s=n(98161),c=n(60202),u=n(17483),l=n(98918),h=n(76852),d=n(58926),f=(n(93984),n(63313)),p=n.n(f),v=n(66176),m=n(13504),g=function(t){function e(){return t.apply(this,arguments)||this}return(0,m.Z)(e,t),e.prototype.render=function(){return p().createElement("div",{className:"form-select-dialog-title"},p().createElement("div",{className:"text-wrapper"},i.ZP.t("选择收集表")))},e}(p().Component),y=n(19183),w=n(91508),E=n(88666),_=function(t){var e=t.isLoading,n=t.isComplete,r=t.onLoadMore,o=t.children,i=(0,f.useRef)();(0,f.useEffect)((function(){if(i&&null!==i.current){var t=function(){var t=i;!n&&t&&t.current&&t.current.scrollHeight-t.current.scrollTop<=t.current.clientHeight&&r()};return i.current.addEventListener("scroll",t),function(){i.current.removeEventListener("scroll",t)}}}),[i,n]);var a=e?p().createElement("div",{style:{position:"absolute",left:0,right:0,top:0,bottom:0,margin:"auto",fontSize:50,display:"flex",justifyContent:"center",alignItems:"center",background:"rgba(255,255,255,0.2)",pointerEvents:"none"}},p().createElement(E.Z,null)):void 0;return p().createElement("div",null,o({ref:i,spinner:a}))},x=function(t){function e(e){var n;return(n=t.call(this,e)||this).state={selectIndex:-1,list:e.list},n}(0,m.Z)(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props,n=e.isLoading,r=e.isComplete,o=e.handleLoadMore,a=this.state,s=a.list,c=a.selectIndex;return p().createElement("div",null,p().createElement(_,{isLoading:n,isComplete:r,onLoadMore:o},(function(e){var n=e.ref,r=e.spinner;return p().createElement("div",{className:"form-select-dialog-content",ref:n},s.length>0?s.map((function(e,n){var r,o=w.q.getConfig("padId")===(null===(r=e.relativeDoc)||void 0===r?void 0:r.doc_id.pad_id),a=o?"unactive":n===c?"selected":"";return p().createElement("div",{className:"content-list-item "+a,onClick:function(){o||t.select(n)}},p().createElement("div",{className:"icon-wrapper"},p().createElement(y.Z,null)),p().createElement("div",{className:"text-wrapper"},p().createElement("p",null,e.title)),p().createElement("div",null,o?p().createElement("div",{className:"linked-tag"},i.ZP.t("已关联")):null))})):p().createElement("p",{className:"content-empty"},i.ZP.t("暂无收集表")),r)})))},n.select=function(t){var e=this.props,n=e.handleSelectChange,r=e.handleClickConfirm;t===this.state.selectIndex?r():(this.setState({selectIndex:t}),n(t))},e}(p().Component),b=function(t){function e(e){var n;return(n=t.call(this,e)||this).changeEnable=function(t){n.setState({enable:t})},n.state={enable:!1},n}return(0,m.Z)(e,t),e.prototype.render=function(){var t=this.props,e=t.handleClickConfirm,n=t.handleClickCancel;return p().createElement("div",{className:"form-select-dialog-footer"},p().createElement("button",{className:"desktop-cta-button size-m type-gray",onClick:function(){n()}},i.ZP.t("取消")),p().createElement("button",{className:"desktop-cta-button size-m type-primary",onClick:function(){e()}},i.ZP.t("确定")))},e}(p().Component),I=n(56592),S=n.n(I),T=n(62986),C=n(60014);!function(t){t[t.Doc=0]="Doc",t[t.Sheet=1]="Sheet",t[t.Form=2]="Form"}(r||(r={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.REMOVED=1]="REMOVED",t[t.IN_TRASHCAN=2]="IN_TRASHCAN"}(o||(o={}));var P=n(39702),L=n(8326);function O(){"use strict";O=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(T){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new b(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(T){return{type:"throw",arg:T}}}t.wrap=c;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(I([])));m&&m!==e&&n.call(m,o)&&(p=m);var g=f.prototype=h.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function I(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=f,s(g,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),s(g,a,"Generator"),s(g,o,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=I,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:I(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var R=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))},k=function(t,e){t.length>C.$l&&(t=t.slice(0,C.$l));var n,r=Date.now(),o=!t.length,a=w.q.getConfig("isUserChangeTitle")?w.q.getConfig("title"):"",s={formName:i.ZP.t("无标题收集表"),updateTime:r,title:a,subtitle:"",author:w.q.getConfig("userName"),themeClass:"default",padId:w.q.getConfig("padId"),isDirty:!0,rightBarClicked:!1,globalPadId:w.q.getConfig("globalPadId")};return n=o?function(t){return[{id:"blank-1",section:0,title:i.ZP.t("未命名的问题"),subtitle:"",placeholder:i.ZP.t("输入问题，例如“你的姓名”"),isDirty:!1,createTime:t,updateTime:t,type:"SIMPLE",qdata:{placeholder:i.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:i.ZP.t("输入内容需不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},{id:"blank-2",section:0,title:i.ZP.t("未命名的问题"),subtitle:"",placeholder:i.ZP.t("输入问题，例如“你的性别”"),isDirty:!1,createTime:t,updateTime:t,type:"RADIO",qdata:{options:[{id:111,title:i.ZP.t("选项 1")},{id:222,title:i.ZP.t("选项 2")}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}}]}(r):t.map((function(t,e){return function(t,e,n){var r=n.title,o=n.type,a=void 0===o?P.c.SIMPLE:o;return{id:"blank-"+t,section:0,title:r.substr(0,C.er),subtitle:"",placeholder:i.ZP.t("输入问题，例如“你的姓名”"),isDirty:!0,createTime:e,updateTime:e,type:a,qdata:{placeholder:i.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:i.ZP.t("输入内容不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}}}(e,r,t)})),o&&!e||(s.questions=n,s.sections=[{sid:0,title:"",qlist:n.map((function(t){return null===t||void 0===t?void 0:t.id}))}]),s};function N(t,e,n,r,o){var i={sheet_id:{doc_id:w.q.getConfig("globalPadId"),sub_id:t},form_text:"",form_title:e||"",need_create_sub_sheet:!0,sub_sheet_name:e,isFromLeadBanner:o},a=k(n||[],r);return a.title=i.form_title,i.form_text=JSON.stringify(a),new Promise((function(t,e){$.ajax({url:"//"+L.Z.getConfig("runtime.domainName")+"/form/collect/from_sheet",type:"POST",xhrFields:{withCredentials:!0},data:{data:JSON.stringify(i),xsrf:(0,T.f)()},success:function(e){t(e)},error:function(t){e(t)}})}))}function Z(t){var e={bind:!1,sheet_id:{doc_id:t.sheetGlobalId,sub_id:t.sheetSubId},form_id:t.formGlobalId};return new Promise((function(t,n){$.ajax({url:"//"+L.Z.getConfig("runtime.domainName")+"/form/collect/bind_sheet",type:"POST",xhrFields:{withCredentials:!0},data:{data:JSON.stringify(e),xsrf:(0,T.f)()},success:function(e){t(e)},error:function(t){n(t)}})}))}function F(t){var e="//"+L.Z.getConfig("runtime.domainName")+"/form/data/getpubrev";return S().get(e,{params:{padId:t,xsrf:(0,T.f)()},withCredentials:!0}).then((function(t){var e=t.data;return 0===e.retcode?e.data:e})).catch((function(t){var e;null===(e=n.g.log)||void 0===e||e.error("getStateOfRelateForm",null===t||void 0===t?void 0:t.stack)}))}function D(t){var e="//"+L.Z.getConfig("runtime.domainName")+"/form/collect/recordcnt",r=JSON.stringify({global_padid:t,need_self_sid:!0,need_uid_sid:0}),o=new FormData;return o.append("data",r),S().post(e,o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){return t.data})).catch((function(t){var e;null===(e=n.g.log)||void 0===e||e.error("getRecordCount",null===t||void 0===t?void 0:t.stack)}))}function M(t,e){return R(this,void 0,void 0,O().mark((function n(){var r,o,i,a,s,c,u,l;return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="/form/collect/to_sheet",o=w.q.getConfig("domainId"),i=w.q.getConfig("localPadId"),n.next=5,G(o,i);case 5:return a=n.sent,s={form_id:{doc_id:t},sheet_id:o+"$"+i,sheet_url:a.docUrl,export_to_local:!1},e&&(s.sheet_type=e),(c=new FormData).append("data",JSON.stringify(s)),n.next=13,S()({url:r,data:c,method:"POST",withCredentials:!0});case 13:return u=n.sent,l=u.data,n.abrupt("return",l);case 16:case"end":return n.stop()}}),n)})))}function A(t){return R(this,void 0,void 0,O().mark((function e(){var n,r,o,i;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={form_id:{doc_id:t},export_to_local:!0},(r=new FormData).append("data",JSON.stringify(n)),e.next=6,S()({url:"/form/collect/to_sheet",data:r,method:"POST",withCredentials:!0});case 6:return o=e.sent,i=o.data,e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})))}function j(t){return R(this,void 0,void 0,O().mark((function e(){var n,r,o,i;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={global_padid:t},(r=new FormData).append("data",JSON.stringify(n)),e.next=6,S()({url:"/form/collect/export_process",data:r,method:"POST",withCredentials:!0});case 6:return o=e.sent,i=o.data,e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})))}function U(t){return R(this,void 0,void 0,O().mark((function e(){var n,r,o,i;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={global_id:t},(r=new FormData).append("data",JSON.stringify(n)),e.next=6,S()({url:"/form/collect/get_conf",data:r,method:"POST",withCredentials:!0});case 6:return o=e.sent,i=o.data,e.abrupt("return",i.syn_limit_cnt||C.Vh);case 9:case"end":return e.stop()}}),e)})))}function G(t,e){return R(this,void 0,void 0,O().mark((function n(){var r,o,i;return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={domainId:t,localPadId:e,xsrf:(0,T.f)()},n.next=4,S()({url:"/cgi-bin/online_docs/doc_info",params:r,method:"POST",withCredentials:!0});case 4:return o=n.sent,i=o.data,n.abrupt("return",{meta:i.doc_meta,docUrl:""+location.protocol+i.doc_url,creatorNick:i.creator_nick});case 7:case"end":return n.stop()}}),n)})))}function q(t){return R(this,void 0,void 0,O().mark((function e(){var n,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,S()({url:"/form/collect/get_unsubmit_users",method:"POST",data:{global_padid:t}});case 3:return n=e.sent,r=n.data,e.abrupt("return",r.users||[]);case 6:case"end":return e.stop()}}),e)})))}function V(t){var e=t.index,n=void 0===e?0:e,r=t.limit,o=void 0===r?15:r;return R(this,void 0,void 0,O().mark((function t(){var e,r,i,a,s=this;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=new FormData).append("xsrf",(0,T.f)()),e.append("list_type","6"),e.append("owner_filter","true"),e.append("is_owner","1"),e.append("type_filter","true"),e.append("doc_type","2"),e.append("sort_type","2"),e.append("start",""+n),e.append("limit",""+o),t.next=13,S()({url:"/cgi-bin/online_docs/doclist",method:"POST",data:e});case 13:if(r=t.sent,0!==(i=r.data).list_info.length){t.next=17;break}return t.abrupt("return",{list:[],hasNextPage:!1,nextPageIndex:i.next});case 17:return t.next=19,Promise.all(i.list_info.map((function(t){return R(s,void 0,void 0,O().mark((function e(){var n,r,o;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t.domain_id,t.pad_id);case 2:return r=e.sent,o={title:t.title,docId:{pad_id:t.pad_id,domain_id:t.domain_id},relativeDoc:null===(n=r.meta.relative_doc)||void 0===n?void 0:n[0]},e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))})));case 19:return a=t.sent,t.abrupt("return",{list:a||[],nextPageIndex:i.next,hasNextPage:0!==i.next});case 21:case"end":return t.stop()}}),t)})))}function B(t,e){return R(this,void 0,void 0,O().mark((function n(){var i,a,s,c,u,l,h,d,f,p,v,m,g,y,w;return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,G(t.domain_id,t.pad_id);case 2:if((i=n.sent).meta.doc_type===r.Form){n.next=5;break}return n.abrupt("return",void 0);case 5:if(i.meta.doc_status===o.NORMAL){n.next=7;break}return n.abrupt("return",void 0);case 7:return a=i.meta,s=i.creatorNick,c=i.docUrl,u=a.doc_id,l=a.creator_uid,h=u.domain_id+"$"+u.pad_id,d=void 0!==l&&e===l,n.next=13,Promise.all([d?q(h):[],D(h),U(h)]);case 13:return f=n.sent,p=f[0],v=f[1],m=f[2],g=v.user_cnt||v.total_cnt-v.del_cnt||0,y=v.total_cnt-v.del_cnt||0,w=p.length,n.abrupt("return",Object.assign(Object.assign({},Y(a)),{docUrl:c,fillUserCount:g,fillAnswerCount:y,unFillUserCount:w,isClosed:v.is_closed,creatorNickName:s,syncLimit:m}));case 21:case"end":return n.stop()}}),n)})))}function H(t){return R(this,void 0,void 0,O().mark((function e(){var n,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(w.q.getConfig("domainId"),w.q.getConfig("padId"));case 2:if(n=e.sent,0!==(r=(n.meta.relative_doc||[]).map((function(t){return t.doc_id}))).length){e.next=6;break}return e.abrupt("return",[]);case 6:return e.next=8,Promise.all(r.map((function(e){return B(e,t)})));case 8:return e.abrupt("return",e.sent.filter((function(t){return void 0!==t})));case 9:case"end":return e.stop()}}),e)})))}function Y(t){var e=t.title,n=t.relative_doc;return{title:e,docId:t.doc_id,relatedSheet:n&&{subId:n[0].sub_id,docId:{padId:n[0].doc_id.pad_id,domainId:n[0].doc_id.domain_id},docUrl:n[0].doc_url}}}var z=n(6655),W=n.n(z);function X(){"use strict";X=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(T){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new b(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(T){return{type:"throw",arg:T}}}t.wrap=c;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(I([])));m&&m!==e&&n.call(m,o)&&(p=m);var g=f.prototype=h.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function I(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=f,s(g,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),s(g,a,"Generator"),s(g,o,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=I,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:I(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var Q=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))},J=function(){function t(t){var e=this;this.handleLoadMore=W()((function(){return Q(e,void 0,void 0,X().mark((function t(){var e,n,r,o,i,a=this;return X().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._isLoading=!0,this._dialogModal.update({content:this.renderFormDialogContent()}),t.next=4,V({index:this._currentPageIndex});case 4:n=t.sent,r=n.list,o=n.nextPageIndex,i=n.hasNextPage,this._isLoading=!1,this._isComplete=!i,this._currentPageIndex=o,(e=this._list).push.apply(e,(0,d.Z)(r.filter((function(t){return!a._list.find((function(e){return e.docId.pad_id===t.docId.pad_id}))})))),this._dialogModal.update({content:this.renderFormDialogContent()});case 13:case"end":return t.stop()}}),t,this)})))}),500),this.handleLinkOwnerForm=W()((function(t,n){e._linkOwnerForm({form:t,relink:n})}),500),this.show=function(t,n){e._show||(e._show=!0,e.resetListStatus(),e._list=t,e._currentPageIndex=n,e._dialogModal=v.default.confirm({title:e.renderFormDialogTitle(),className:"form-select-dialog",maskClassName:"blurmask",destroyOnClose:!0,style:{width:540,height:484,boxSizing:"border-box"},content:e.renderFormDialogContent(),footer:e.renderFormDialogFooter(),onCancel:function(){e._show=!1}}))},this._linkOwnerForm=t.linkOwnerForm,this._openFormSheet=t.openFormSheet,this._title=p().createRef(),this._content=p().createRef(),this._footer=p().createRef(),this.resetListStatus()}var e=t.prototype;return e.close=function(){var t;this._show=!1,null===(t=this._dialogModal)||void 0===t||t.close()},e.resetListStatus=function(){this._list=[],this._selected=-1,this._currentPageIndex=0,this._isLoading=!1,this._isComplete=!1},e.renderFormDialogTitle=function(){return p().createElement(g,{ref:this._title})},e.renderFormDialogContent=function(){return p().createElement(x,{ref:this._content,list:this._list,isLoading:this._isLoading,isComplete:this._isComplete,handleLoadMore:this.handleLoadMore.bind(this),handleSelectChange:this.handleSelectChange.bind(this),handleClickConfirm:this.handleClickConfirm.bind(this)})},e.renderFormDialogFooter=function(){return p().createElement(b,{ref:this._footer,handleClickConfirm:this.handleClickConfirm.bind(this),handleClickCancel:this.handleClickCancel.bind(this)})},e.handleSelectChange=function(t){var e;this._selected=t;var n=-1!==t;null===(e=this._footer.current)||void 0===e||e.changeEnable(n)},e.handleClickConfirm=function(){var t=this;if(-1!==this._selected){var e=this._list[this._selected],n=e.title,r=e.relativeDoc,o=e.docId;r?v.default.confirm({className:"form-select-dialog-alert",maskClassName:"blurmask",destroyOnClose:!0,style:{width:340,boxSizing:"border-box"},content:this.reConfirmContent(n,o),okText:i.ZP.t("解除并重新关联"),onOk:function(){t.handleLinkOwnerForm(t._list[t._selected],!0),t.close()},onCancel:function(){}}):(this.handleLinkOwnerForm(this._list[this._selected],!1),this.close())}},e.reConfirmContent=function(t,e){var n=this;return p().createElement("div",null,'"',t,'"',i.ZP.t("已关联至"),p().createElement("a",{onClick:function(){n._openFormSheet(e)},className:"form-select-dialog-alert-link",target:"_blank"},i.ZP.t("其他表格")),i.ZP.t("。 是否解除原来的关联关系，并重新关联到这个表格？"))},e.handleClickCancel=function(){this.close()},t}(),K=n(84701),tt=n(78216),et=n(14831),nt=n.n(et),rt=n(87485),ot=n(79047),it=n(89577),at=n(86280),st=n(19031),ct=n(74140),ut=n(67465),lt=n(85624),ht=function(t,e,n,r,o){for(var i,a,s,c=[],u=n[e],l=(null===u||void 0===u?void 0:u.values)||[],h=Math.max(r,l.length),d=0;d<h;d++){var f=l[d],p=(null===f||void 0===f?void 0:f.getEditValue())||"",v=null===f||void 0===f?void 0:f.getFormula(),m=null===f||void 0===f?void 0:f.getMergeReference(),g=null===f||void 0===f?void 0:f.getDataValidation(),y=null===f||void 0===f?void 0:f.getMetadata(),w=null===f||void 0===f?void 0:f.getPivotTableRef();if(v&&(p=null!==(a=null===(i=null===f||void 0===f?void 0:f.getFormattedValue())||void 0===i?void 0:i.value)&&void 0!==a?a:""),!p&&m){var E=m.startRowIndex,_=m.startColIndex,x=null===(s=n[E])||void 0===s?void 0:s.values[_];x&&(p=x.getEditValue()||"")}var b=ft(t,e,d,m),I=!(0,lt.Nb)(t,[m||new it.Z(t.spreadsheet.activeSheetId,e,e,d,d)]),S=pt(t,e,d),T=(null===g||void 0===g?void 0:g.ruleType)||null,C=void 0,P=null;(null===y||void 0===y?void 0:y.customDataType)===ct.ZP.IMAGE&&(P={url:t.spreadsheet.activeSheet.imageManager.getImage(f.getRefIds()[0]).url}),o&&(C=dt(o,e,d)),c.push({col:d,row:e,value:p,isFormula:!!v,isMerge:!!m,dvRule:T,isRangeAuth:b,isRangeAuthRead:I,isInHighWater:S,cellImage:P,floatImage:C,pivotTableRef:w})}return c};function dt(t,e,n){var r=t.getCellFloatImages(e,n);return r.length>0?r:void 0}function ft(t,e,n,r){var o,i,a=t.spreadsheet.activeSheetId,s=null===(o=t.serviceCollection.services.get(at.Z.MOBILE_RANGE_AUTH))||void 0===o?void 0:o.instance,c=null===(i=null===s||void 0===s?void 0:s.rangeAuthUtil.getActiveSheetRangeIds())||void 0===i?void 0:i.rangeIds;if(!(null===c||void 0===c?void 0:c.length))return!0;var u=r||{startRowIndex:e,endRowIndex:e,startColIndex:n,endColIndex:n},l=u.startRowIndex,h=u.endRowIndex,d=u.startColIndex,f=u.endColIndex;return t.sheetStatus.getRangeCanEdit(new it.Z(a,l,h,d,f))}function pt(t,e,n){var r=t.spreadsheet.activeSheetId;return t.sheetStatus.isRangeCanEditByHighWater(new it.Z(r,e,e,n,n))}var vt,mt,gt,yt,wt=function(){function t(t){var e=this;this.onCooperationAddNewRangeDone=function(){e.onMutationChange()},this.onMutationChange=function(){e.panelUpdateFn&&e.panelUpdateFn()},this.app=t}var e=t.prototype;return e.isFillAble=function(){return this.getHeader(),!(!this.isTitleLine()||this.activeRow<0)},e.getHeader=function(t){this.activeCol=-1,this.activeRow=-1,this.titleLine=-1,this.isQuickFill=!!t;try{return this.find()}catch(e){return console.error(e),this.getResult()}},e.addListener=function(t){this.panelUpdateFn=t,this.app.mutationBehavior.emitter.addListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.listen(ut.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},e.removeListener=function(){this.panelUpdateFn=null,this.app.mutationBehavior.emitter.removeListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.remove(ut.k.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)},e.getQuickFillRange=function(){var t=this.getHeader(),e=t.activeCol,n=t.activeRow,r=this.app.spreadsheet.activeSheet.getRowCount();return{fillRowRange:[this.titleLine+1,r-1],activeCol:e,activeRow:n}},e.getQuickFillData=function(t,e){var n=this.getHeader(),r=n.headDatas,o=n.activeCol,i=n.activeRow,a=this.app.spreadsheet.activeSheet.data;return{headDatas:r,activeCol:o,activeRow:i,rowData:ht(this.app,t,a.rowData,r.length,e)}},e.isTitleLine=function(){return this.titleLine>=0},e.getResult=function(t){return void 0===t&&(t=[]),{headDatas:t,line:this.titleLine,activeCol:this.activeCol,activeRow:this.activeRow,activeRowDatas:this.activeRowDatas||[]}},e.find=function(){var t=this.app.spreadsheet.activeSheet.data;if(!t||!t.rowData||!t.rowMetadata)return this.getResult();var e=this.app.view.getSelection();this.activeRow=e.activeCell.rowIndex,this.activeCol=e.activeCell.colIndex;var n=t.rowData,r=t.rowMetadata,o=(0,st.o_)(n,r),i=(0,st.Fh)(n,o),a=i.cellIndexMap,s=i.titleLine,c=(0,st.g8)(a,s).headData;return this.titleLine=s,this.activeRow<=this.titleLine&&(this.activeRow=this.titleLine+1),this.activeCol<0&&(this.activeCol=0),this.isQuickFill&&-1!==this.activeRow?this.activeRowDatas=ht(this.app,this.activeRow,n,c.length):this.activeRowDatas=[],c.length=Math.max(c.length,(0,st.Ot)()),this.isTitleLine()?this.getResult((0,st.CV)(this.titleLine,c)):this.getResult()},t}(),Et=n(31973),_t=n(59021),xt=n(86673),bt=n(12337),It=n(38808),St=n(32869),Tt=n(26804),Ct=n(16486);!function(t){t.SIMPLE="SIMPLE",t.RADIO="RADIO",t.CHECKBOX="CHECKBOX",t.SELECT="SELECT",t.DATE="DATE",t.TIME="TIME",t.TEMPERATURE="TEMPERATURE",t.LOCATION="LOCATION",t.IMAGE="IMAGE",t.CANVAS="CANVAS"}(gt||(gt={})),function(t){t[t.SIMPLE=0]="SIMPLE",t[t.RADIO=1]="RADIO",t[t.CHECKBOX=2]="CHECKBOX",t[t.SELECT=3]="SELECT",t[t.DATE=4]="DATE",t[t.TIME=5]="TIME",t[t.TEMPERATURE=6]="TEMPERATURE",t[t.LOCATION=7]="LOCATION",t[t.IMAGE=8]="IMAGE",t[t.CANVAS=9]="CANVAS"}(yt||(yt={}));var Pt=((vt={})[yt.SIMPLE]=["SIMPLE",i.ZP.t("问答题")],vt[yt.RADIO]=["RADIO",i.ZP.t("单选题")],vt[yt.CHECKBOX]=["CHECKBOX",i.ZP.t("多选题")],vt[yt.SELECT]=["SELECT",i.ZP.t("下拉选择题")],vt[yt.DATE]=["DATE",i.ZP.t("日期题")],vt[yt.TIME]=["TIME",i.ZP.t("时间题")],vt[yt.TEMPERATURE]=["TEMPERATURE",i.ZP.t("温度题")],vt[yt.LOCATION]=["LOCATION",i.ZP.t("地理位置题")],vt[yt.IMAGE]=["IMAGE",i.ZP.t("收集图片")],vt[yt.CANVAS]=["CANVAS",i.ZP.t("签名题")],vt),Lt=((mt={})[yt.SIMPLE]={section:0,subtitle:"",placeholder:i.ZP.t("输入问题，例如“你的姓名”"),isDirty:!1,type:"SIMPLE",qdata:{placeholder:i.ZP.t("请填写")},validate:[{type:12,rules:{max:100,open:!1},message:i.ZP.t("输入内容需不超过100个字符。")}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},mt[yt.RADIO]={section:0,subtitle:"",placeholder:i.ZP.t("输入问题，例如“你的性别”"),isDirty:!1,type:"RADIO",qdata:{options:[{id:"111",title:i.ZP.t("选项 1")},{id:"222",title:i.ZP.t("选项 2")}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}},mt[yt.CHECKBOX]={type:"CHECKBOX",subtitle:"",isDirty:!1,placeholder:i.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:i.ZP.t("添加选项"),options:[{id:"1",title:i.ZP.t("选项 1"),isExtend:!1},{id:"2",title:i.ZP.t("选项 2"),isExtend:!1}]},validateInput:{type:"MIN",number:1}},mt[yt.SELECT]={type:"SELECT",subtitle:"",isDirty:!1,placeholder:i.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{placeholder:i.ZP.t("请选择"),options:[{id:"1",title:i.ZP.t("选项 1"),isExtend:!1},{id:"2",title:i.ZP.t("选项 2"),isExtend:!1}]}},mt[yt.DATE]={type:"DATE",subtitle:"",isDirty:!1,placeholder:i.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:i.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"datetime",format:i.ZP.t('yyyy"年"m"月"d"日" hh:mm')}},mt[yt.TIME]={type:"TIME",subtitle:"",isDirty:!1,placeholder:i.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:i.ZP.t("请输入有效的时间"),ruletype:70}],dataType:3,toggle:{required:!0,showValidate:!1},qdata:{subType:"timetype",format:"hh:mm"}},mt[yt.TEMPERATURE]={type:"TEMPERATURE",subtitle:"",isDirty:!1,placeholder:i.ZP.t("请输入问题"),validate:[{type:13,rules:{},message:i.ZP.t("请输入小于 200 的正整数或携带一位小数的正值。"),ruletype:90}],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{unit:"celsius"}},mt[yt.LOCATION]={type:"LOCATION",subtitle:"",isDirty:!1,placeholder:i.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},mt[yt.IMAGE]={type:"IMAGE",subtitle:"",isDirty:!1,placeholder:i.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},mt[yt.CANVAS]={type:"CANVAS",subtitle:"",isDirty:!0,placeholder:i.ZP.t("请输入问题"),validate:[],dataType:1,toggle:{required:!0,showValidate:!1},qdata:{}},mt);function Ot(t){var e=t.list,n=t.update;return p().createElement("div",{className:"question-list-container"},e.map((function(t,e){return p().createElement(kt,{index:e,item:t,update:n})})))}Object.assign(Object.assign({},Lt[yt.SIMPLE]),{id:"1",title:i.ZP.t("未命名的问题")}),Object.assign(Object.assign({},Lt[yt.RADIO]),{id:"2",title:i.ZP.t("未命名的问题")});var Rt=[yt.SIMPLE,yt.RADIO,yt.CHECKBOX,yt.SELECT,yt.DATE,yt.TIME,yt.TEMPERATURE,yt.LOCATION,yt.IMAGE,yt.CANVAS],kt=function(t){function e(e){var n;return(n=t.call(this,e)||this).state=Object.assign({},e.item),n}(0,m.Z)(e,t);var n=e.prototype;return n.handleSelectChange=function(t){this.setState({select:t});var e=this.props;(0,e.update)(e.index,{select:t})},n.handleTypeChange=function(t){var e=Rt[+t];this.setState({type:e});var n=this.props;(0,n.update)(n.index,{type:e})},n.render=function(){var t=this,e=this.state,n=e.select,r=e.title,o=e.type;return p().createElement(p().Fragment,null,p().createElement("div",{className:"question-list-item"},p().createElement(Tt.default,{checked:n,onChange:function(e){return t.handleSelectChange(e)}},"                    ",p().createElement("div",{className:"question-title"},r)),p().createElement(Ct.default,{className:"question-list-select",arrowClassName:"question-list-select-arrow",listClassName:"question-list-select-list",value:""+Rt.indexOf(o),onChange:this.handleTypeChange.bind(this)},Rt.map((function(t,e){return p().createElement(Ct.default.Option,{className:"question-list-option",value:""+e},Pt[t][1])})))),p().createElement("div",{className:"question-list-divider"}))},e}(p().Component),Nt=function(t){function e(){return t.apply(this,arguments)||this}return(0,m.Z)(e,t),e.prototype.render=function(){var t=this.props,e=t.handleClickConfirm,n=t.handleClickCancel;return p().createElement("div",{className:"question-select-dialog-footer"},p().createElement("button",{className:"desktop-cta-button size-m type-gray",onClick:function(){n()}},i.ZP.t("取消")),p().createElement("button",{className:"desktop-cta-button size-m type-primary",onClick:function(){e()}},i.ZP.t("创建收集表")))},e}(p().Component),Zt=[[yt.IMAGE,/(上传|图片|拍照|文件|照片)/i],[yt.LOCATION,/(定位|位置|城市|地址)/i],[yt.DATE,/(日期|时间)/i],[yt.RADIO,/(是否|性别|选择)/i],[yt.SIMPLE,/[\s\S]*/i]],Ft=function(){function t(t){var e=this;this.show=function(t){void 0===t&&(t=0),e._show||(e._show=!0,e.loadRowData(t),e._list.length>0?e._dialogModal=v.default.confirm({title:i.ZP.t("将以下内容设置为题目"),className:"question-select-dialog",maskClassName:"blurmask",destroyOnClose:!0,style:{width:480,height:408},content:p().createElement(Ot,{list:e._list,update:e.update.bind(e)}),footer:p().createElement(Nt,{handleClickCancel:e.handleClickCancel.bind(e),handleClickConfirm:e.handleClickConfirm.bind(e)}),onCancel:function(){e.close()}}):e._dialogModal=v.default.confirm({title:i.ZP.t("提示"),maskClassName:"blurmask",content:i.ZP.t("表头内容为空，是否新建空白收集表？"),okText:i.ZP.t("新建"),onOk:function(){var t=e._app.spreadsheet.activeSheet.getTitle();e._creatDraft([],t),e.close()},onCancel:function(){e.close()}}))},this._app=t.app,this._creatDraft=t.creatDraft,this._list=[],this._content=p().createRef(),this._footer=p().createRef()}var e=t.prototype;return e.close=function(){var t;this._show=!1,null===(t=this._dialogModal)||void 0===t||t.close()},e.isShow=function(){return this._show},e.update=function(t,e){var n=this._list[t],r=Object.assign(Object.assign({},n),e);this._list[t]=r},e.getCurrentSheetDataByRow=function(t){void 0===t&&(t=0);var e=this._app.spreadsheet.activeSheet,n=null===e||void 0===e?void 0:e.data;return(null===n||void 0===n?void 0:n.rowData)[t]},e.handleClickConfirm=function(){var t=[],e=1;this._list.forEach((function(n){n.select&&(t.push(Object.assign(Object.assign({},Lt[n.type]),{id:""+e,title:n.title})),e+=1)}));var n=this._app.spreadsheet.activeSheet.getTitle();this._creatDraft(t,n),this.close()},e.handleClickCancel=function(){this.close()},e.loadRowData=function(t){var e=this;this._questionRow=t;var n=this.getCurrentSheetDataByRow(t),r=[];n&&n.values.forEach((function(t){if(null===t||void 0===t?void 0:t.getEditValue()){var n=t.getEditValue(),o=e.getTypeByTitle(n);r.push({select:!0,title:n,type:o})}})),this._list=r},e.getTypeByTitle=function(t){var e=null;return Zt.some((function(n){var r=n[0];if(n[1].test(t))return e=r,!0})),e||yt.SIMPLE},t}(),Dt=n(19474),Mt=n.n(Dt),At=function(){function t(t){var e=this;this.show=function(t,n){e._show||(e._show=!0,e._title=t,e._url=n,e._dialogModal=v.default.confirm({className:"qr-dialog",maskClassName:"blurmask",destroyOnClose:!0,style:{width:340,height:421},content:e.getQRContent(),footer:null,onCancel:function(){e._show=!1}}))},this.getQRContent=function(){return p().createElement("div",{className:"dialog-content"},p().createElement("div",{className:"qr-card"},p().createElement("div",{className:"qr-card-title"},p().createElement("div",{className:"qr-card-title-icon"},p().createElement(y.Z,null)),p().createElement("div",{className:"qr-card-title-text"},p().createElement("div",{className:"main-text"},e._title),p().createElement("div",{className:"sub-text"},i.ZP.t("扫一扫，填写收集表")))),p().createElement("div",{className:"qr-card-qr"},p().createElement(Mt(),{value:e._url,includeMargin:!0,id:"qrCode",size:200,fgColor:"#000000"}))),p().createElement("a",{className:"desktop-cta-button size-m type-primary",ref:e._downAnchor,onClick:function(){e.saveQRcode()},style:{color:"#ffffff"}},i.ZP.t("保存二维码")))},this._app=t.app,this._downAnchor=p().createRef()}return t.prototype.saveQRcode=function(){var t,e=null===(t=this._downAnchor)||void 0===t?void 0:t.current;if(e){var n=document.getElementById("qrCode");if(n){var r=n.toDataURL("image/png");e.href=r,e.download=this._title||i.ZP.t("收集表")}}},t}(),jt=n(89776),Ut=n(30516),Gt=n(9969),qt=n(2838),Vt=n(83311),Bt=n(89074),Ht=n(4781),Yt=n(41510);function zt(){"use strict";zt=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(T){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new b(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(T){return{type:"throw",arg:T}}}t.wrap=c;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(I([])));m&&m!==e&&n.call(m,o)&&(p=m);var g=f.prototype=h.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function I(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=f,s(g,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),s(g,a,"Generator"),s(g,o,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=I,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:I(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function Wt(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"===typeof t)return Xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xt(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Qt=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))},Jt=n.g,$t=function(t,e){void 0===e&&(e={}),Et.ZP.tdwReport(Object.assign({opername:"doc_form",module:"excel",action:t},e))},Kt=function(t){var e,n=Jt.mqq;if(nt().isQQMiniProgram){var r=t;t.indexOf("//")>=0&&-1===t.indexOf("https")&&(r="https:"+t);var o="/pages/detail/detail?url="+encodeURIComponent(r);Jt.wx.miniProgram.navigateTo({url:"/pages/jump/jump?url="+encodeURIComponent(o)})}else nt().isWxMiniProgram?Jt.wx.miniProgram.navigateTo({url:"/pages/detail/detail?url="+encodeURIComponent(t)}):nt().isIPad&&nt().isTencentDocsApp?(0,h.tencentDocOpenUrlForAll)({url:t}):(null===(e=null===n||void 0===n?void 0:n.ui)||void 0===e?void 0:e.openUrl)?n.ui.openUrl({url:t,target:1,style:3}):(0,h.tencentDocOpenUrlForAll)({url:t,replace:!1});return!0},te=[i.ZP.t("报名"),i.ZP.t("报备"),i.ZP.t("统计"),i.ZP.t("登记"),i.ZP.t("收集"),i.ZP.t("汇总"),i.ZP.t("计划"),i.ZP.t("明细"),i.ZP.t("月份"),i.ZP.t("信息表"),i.ZP.t("打卡"),i.ZP.t("周报"),i.ZP.t("排期"),i.ZP.t("绩效考核"),"okr",i.ZP.t("项目计划"),i.ZP.t("进度"),i.ZP.t("待办事项"),i.ZP.t("项目"),i.ZP.t("记录"),i.ZP.t("排班"),i.ZP.t("审核"),i.ZP.t("汇总"),i.ZP.t("每日反馈"),i.ZP.t("上报"),i.ZP.t("日报"),i.ZP.t("日程"),i.ZP.t("清单"),i.ZP.t("签到"),i.ZP.t("安排"),i.ZP.t("每日更新"),i.ZP.t("跟进"),i.ZP.t("资产盘点"),i.ZP.t("考勤"),i.ZP.t("更新"),i.ZP.t("签到"),i.ZP.t("管理"),i.ZP.t("课程"),i.ZP.t("共享"),i.ZP.t("明细"),i.ZP.t("报表"),i.ZP.t("通讯录"),i.ZP.t("看板"),i.ZP.t("进度"),i.ZP.t("值班"),i.ZP.t("排课"),i.ZP.t("进度"),i.ZP.t("展示"),i.ZP.t("纪要"),i.ZP.t("采集"),i.ZP.t("摸底"),i.ZP.t("接龙"),i.ZP.t("征集"),i.ZP.t("名单"),i.ZP.t("花名册"),i.ZP.t("订购"),i.ZP.t("信息"),i.ZP.t("调研"),i.ZP.t("反馈"),i.ZP.t("清单"),i.ZP.t("联系方式"),i.ZP.t("安排"),i.ZP.t("申请"),i.ZP.t("打卡"),i.ZP.t("排班")],ee=function(){function t(t){var e=this;this.onMutationChange=function(t,n){t.mutation.id===It.ZP.INSERT_SHEET_MUTATION&&n===t.sheetId&&s.Z.event.sheetsBar.trigger("switchSheet",n,e.getCurrentSheetId())},t&&(this.app=t,this.seeker=new wt(t),this.afterHandleCallbacks=[],this.initRelation(),this.initFormSelectDialog(),this.initQuestionListDialog(),this.initQRCodeDialog())}var e=t.prototype;return e.init=function(t){this.app=t,this.initRelation(),this.afterHandleCallbacks=[],this.seeker=new wt(t)},e.handle=function(t,e,n,r,o){var i=this,a=e||(null===o||void 0===o?void 0:o.sheetId),s={new_to_form:function(){return i.handleNewToForm()},new_to_form_mobile:function(){return i.handleNewToForm()},convert_to_form:function(){return i.handleConvertToForm()},new_to_form_with_questions:function(){return i.handleNewToFormWithQuestions(o)},bind_form_to_sheet:function(){return i.handleBindFormToSheet(o,n)},check_form:function(){return i.handleCheckForm(a)},switch_tips_to_form:function(){return i.handleSwitchTipsToForm(a)},cancel_form:function(){return i.handleCancelForm(a,!!n)},cancel_form_sheetbar:function(){return i.handleCancelForm(a,!!n,!0)},share_form:function(){return i.handleShareForm(a)},result_form:function(){return i.handleResultForm(a)},get_form_by_user:function(){return i.handleCheckAllFormByUser(n)},show_form_qrcode:function(){return i.handleShowQRCode(a)},get_form_details:function(){return i.handleGetFormDetails(n)},copy_form_link:function(){return i.handleCopyFormLink(a)},export_form:function(){return i.handleExportForm(o)}};t in s&&s[t](),n&&this.afterHandleCallbacks.push(n)},e.checkReleaseCell=function(t,e,n){var r=n||this.app.spreadsheet.activeSheet,o=r.data.colMetadata,i=r.data.rowMetadata,a=null===o||void 0===o?void 0:o[e],s=null===i||void 0===i?void 0:i[t],c=null===a||void 0===a?void 0:a.formData,u=null===s||void 0===s?void 0:s.formData;if(c&&u){if("question"===u.formDataId)return 1;if(u.formDataId.indexOf("record")>=0)return 2}return 0},e.checkReleaseRange=function(t,e,n,r){for(var o=t.startColIndex,i=t.startRowIndex,a=t.endColIndex,s=t.endRowIndex,c=0,u=i;u<=s;u++)for(var l=o;l<=a;l++){var h=null===n||void 0===n?void 0:n[l],d=null===e||void 0===e?void 0:e[u],f=null===h||void 0===h?void 0:h.formData,p=null===d||void 0===d?void 0:d.formData;if(f&&p&&0!==(c=this.getRelatedRangeType(p.formDataId,r)))return c}return c},e.isRelated=function(t){return this.relateMap.has(t)},e.isLoading=function(){return this.needShowLoading},e.getRelatedSheetId=function(){return Array.from(this.relateMap.keys())[0]},e.getRelatedNumber=function(){return this.relateMap?this.relateMap.size:0},e.getRelatedInfos=function(){return this.relatedFormInfos},e.updateFromSyncMutations=function(t,e,n){for(var r=!1,o=0;o<t.length&&!r;o++){var i=t[o];if(!Array.isArray(i))break;for(var a=0;a<i.length;a++){var s=(0,St.Xe)(i[a],n),c=l.Z.Mutation.MUTATION_ID.DELETE_SHEET_RANGE_MUTATION,u=["<author>","<time>"].indexOf(s.workbookRangeId)>-1;if((null===s||void 0===s?void 0:s.workbookRangeId)&&s.id===c&&u){r=!0;break}}}r&&this.unbindSubSheetRelatedForm(e)},e.stopCheckSync=function(){s.Z.util.timer.erase(this.checkTimeFlag)},e.isOpenDialog=function(){var t;return!0===(null===(t=this.questionListDialog)||void 0===t?void 0:t.isShow())},e.hideSelectQuestionDialog=function(){var t;null===(t=this.questionListDialog)||void 0===t||t.close()},e.checkCollectSheetType=function(){for(var t,e=!1,n=Jt.spreadConfig.getConfig("title")||"",r=Wt(te);!(t=r()).done;){var o=t.value;if(n.indexOf(o)>-1){e=!0;break}}return e},e.isRelateFormPublished=function(){return Qt(this,void 0,void 0,zt().mark((function t(){var e,n,r;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(this.globalId);case 2:if(e=t.sent,n=e.pub,r=e.rev,n&&r){t.next=6;break}return t.abrupt("return",!1);case 6:return t.abrupt("return",n===r);case 7:case"end":return t.stop()}}),t,this)})))},e.getRecordUserCount=function(){return Qt(this,void 0,void 0,zt().mark((function t(){var e,n;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D(this.globalId);case 2:if(e=t.sent,n=e.user_cnt){t.next=6;break}return t.abrupt("return",0);case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t,this)})))},e.getRelatedSheetIdByDocId=function(t){for(var e,n=Wt(this.relateMap.entries());!(e=n()).done;){var r=e.value,o=r[0],i=r[1];if(i.docId.domain_id===t.domain_id&&i.docId.pad_id===t.pad_id)return o}return""},e.bindRelatedFormToSubSheet=function(t,e){this.relateMap.set(t,e),this.updateRelatedInfos(e.docId),(0,_t.yg)()},e.unbindSubSheetRelatedForm=function(t){this.relateMap.delete(t),this.updateRelatedInfos(),(0,_t.yg)()},e.handleCancelFormWithoutTips=function(t){return Qt(this,void 0,void 0,zt().mark((function e(){var n=this;return zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=t||n.getCurrentSheetId(),a=n.getRelation(o);a&&Z({sheetSubId:a.subId,sheetGlobalId:w.q.getConfig("globalPadId"),formGlobalId:a.docId.domain_id+"$"+a.docId.pad_id}).then((function(){e()})).catch((function(){n.showToolToast(i.ZP.t("取消关联收集表失败，请稍后重试。")),r()}))})));case 1:case"end":return e.stop()}}),e)})))},e.switchToRelatedSheet=function(t,e){var n=this;this.app.spreadsheet.sheetManager.hasSheetId(t)?(s.Z.event.sheetsBar.trigger("switchSheet",t,this.getCurrentSheetId()),s.Z.event.sheetsBar.one("switchActiveSheetEnd",(function(n){n===t&&(null===e||void 0===e||e())}))):this.app.mutationBehavior.emitter.once(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(e){return n.onMutationChange(e,t)}))},e.initFormSelectDialog=function(){var t=this;this.formSelectDialog=new J({linkOwnerForm:function(){return t.handleBindFormToSheet.apply(t,arguments)},openFormSheet:function(){return t.handleOpenFormRelatedSheet.apply(t,arguments)}})},e.handleOpenFormRelatedSheet=function(t){var e;return Qt(this,void 0,void 0,zt().mark((function n(){var r,o,a;return zt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,G(t.domain_id,t.pad_id);case 2:if(r=n.sent,o=r.meta,a=null===(e=o.relative_doc)||void 0===e?void 0:e[0].doc_url){n.next=8;break}return K.default.show({type:"error",message:i.ZP.t("获取链接失败"),autoClose:!0,duration:3e3,style:{zIndex:10004}}),n.abrupt("return");case 8:Kt(a);case 9:case"end":return n.stop()}}),n)})))},e.initQuestionListDialog=function(){var t=this;this.questionListDialog=new Ft({app:this.app,creatDraft:function(e){0===e.length?t.handle("new_to_form"):t.handle("new_to_form_with_questions",void 0,void 0,void 0,e)}})},e.initQRCodeDialog=function(){this.qrCodeDialog=new At({app:this.app})},e.initRelation=function(){var t=this;this.relateMap=new Map,this.relatedFormInfos=[];var e=w.q.getConfig("relative")||[];this.globalId=e[0]?e[0].doc_id.domain_id+"$"+e[0].doc_id.pad_id:"",e.forEach((function(e){t.isRelatedForm(e)&&t.relateMap.set(e.sub_id,{docUrl:e.doc_url,docId:e.doc_id,subId:e.sub_id})})),this.updateRelatedInfos(),this.getRelatedNumber()&&Et.ZP.tdwReport({opername:"doc_core",module:"visit",action:"detail_page",ver6:1})},e.updateRelatedFormDetail=function(){return Qt(this,void 0,void 0,zt().mark((function t(){var e,n,r=this;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=w.q.getConfig("uid"),t.next=3,H(e);case 3:n=t.sent,this.relateFormDetailMap=new Map,n.forEach((function(t){t.relatedSheet&&t.relatedSheet&&r.relateFormDetailMap.set(t.relatedSheet.subId,t)}));case 6:case"end":return t.stop()}}),t,this)})))},e.isRelatedForm=function(t){return!!(t.doc_id&&t.sub_id&&t.doc_url)&&-1!==[bt.Z.FORM,0,void 0].indexOf(t.doc_type)&&this.app.spreadsheet.sheetManager.hasSheetId(t.sub_id)},e.getRelation=function(t){return this.relateMap.get(t)||null},e.getSheetName=function(t){var e=t||this.getTitle();return(0,ot.Mi)(this.app.spreadsheet.sheetManager.getSheetTitleList(),e)},e.getSheetTitle=function(){return w.q.getConfig("isUserChangeTitle")?w.q.getConfig("title"):""},e.getTitle=function(){var t=this.getSheetTitle()||i.ZP.t("无标题收集表");return t.length>32?t.substr(0,32):t},e.getCurrentSheet=function(){var t=this.app.spreadsheet.activeSheetId;return this.app.spreadsheet.sheetManager.getSheetBySheetId(t)},e.getCurrentSheetId=function(){var t=this.getCurrentSheet();return(null===t||void 0===t?void 0:t.getSheetId())||""},e.createSuccess=function(t,e,n){(null===e||void 0===e?void 0:e.url)?(this.bindRelatedFormToSubSheet(t,{subId:t,docUrl:e.url,docId:(0,_t.QP)(e.global_padid)}),this.gotoFormEditPage(e.url,!0),this.handleDone(),$t("expo_formbar",{ver5:n?1:2})):this.createFail(t,e)},e.createFail=function(t,e){var n=e&&(e.msg||e.errmsg);this.showToolToast(n?i.ZP.t("创建关联收集表失败：{{msg}}。",{msg:n}):i.ZP.t("网络异常，创建失败。"))},e.handleDone=function(){for(;this.afterHandleCallbacks.length;){var t=this.afterHandleCallbacks.shift();t&&t()}},e.resetSheetType=function(t){var e=this.app.spreadsheet.sheetManager.getSheetBySheetId(t);if(e){if(e.getSheetType()===a.Sheet.SHEET_TYPE.SMART_SHEET)return;e.setSheetType(a.Sheet.SHEET_TYPE.GRID);var n=this.app.spreadsheet.sheetManager.sheetList,r=u.Z.sheet.getAllSheets(n);this.app.requestApi.setSheet({opt:{sheetId:t,behaviors:r,oSubId:!1,withKeyData:!1}})}},e.getFormUrl=function(t,e){var n=this.getRelation(t);return(null===n||void 0===n?void 0:n.docUrl)+(e||"")},e.getRealUrl=function(t){var e=t.split("#");return t.includes("?")?"https:"+t:2===e.length?"https:"+e[0]+"?form=sheet#"+e[1]:"https:"+t+"?form=sheet#/edit"},e.gotoFormEditPage=function(t,e){var n=this,r=this.getRealUrl(t),o=Kt(r);if(e){var a=this.getRelatedSheetId();if(o)this.switchToRelatedSheet(a);else{var s=function(t){return f.createElement("span",null,i.ZP.t("收集表已创建。"),f.createElement("a",{id:"relate-form-url",href:t,style:{color:"#0086ff"},target:"_blank"},i.ZP.t("编辑收集表")))}(t);(0,tt.showToast)(s,void 0,{showCloseBtn:!0});var u=document.querySelector("#relate-form-url");u&&u.addEventListener("click",(function(){n.switchToRelatedSheet(a),c.Z.toast.hideToast()}))}}},e.loadSheetSilent=function(t){var e=this.app.spreadsheet.sheetManager.getSheetBySheetId(t);e&&(e.isLoaded||this.app.dataCenter.loadSheetData({sheetId:t}))},e.handleGetFormDetails=function(t){return Qt(this,void 0,void 0,zt().mark((function e(){var n;return zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateRelatedFormDetail();case 2:n=Array.from(this.relateFormDetailMap.values()),null===t||void 0===t||t(n);case 4:case"end":return e.stop()}}),e,this)})))},e.handleCopyFormLink=function(t){return Qt(this,void 0,void 0,zt().mark((function e(){var n;return zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}if(void 0!==(null===(n=this.relateFormDetailMap.get(t))||void 0===n?void 0:n.docUrl)){e.next=5;break}return(0,tt.showToast)(i.ZP.t("获取分享链接失败")),e.abrupt("return");case 5:(0,jt.ES)({copyContent:{html:"",plain:n.docUrl},type:Ut.GI.input}),K.default.show({type:"success",message:i.ZP.t("已复制分享链接"),autoClose:!0,closable:!0});case 7:case"end":return e.stop()}}),e,this)})))},e.handleBindFormToSheet=function(t,e){var n=t.form,r=t.relink;return Qt(this,void 0,void 0,zt().mark((function t(){var o,a,s,c,u,l,h,d;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=w.q.getConfig("uid"),t.next=3,B(n.docId,o);case 3:if(a=t.sent){t.next=8;break}return this.showToolToast(i.ZP.t("RELATE_FORM_BIND_FAILED")),null===e||void 0===e||e(),t.abrupt("return");case 8:if(!(a.fillAnswerCount>=a.syncLimit)){t.next=12;break}return this.showToolToast(i.ZP.t("RELATE_FORM_BIND_FAILED_OVER_LIMIT",{count:a.syncLimit})),null===e||void 0===e||e(),t.abrupt("return");case 12:if(s=n.docId.domain_id+"$"+n.docId.pad_id,!r||!n.relativeDoc){t.next=17;break}return c=n.relativeDoc,u=c.sub_id,l=c.doc_id,h=l.domain_id,d=l.pad_id,t.next=17,Z({formGlobalId:s,sheetGlobalId:h+"$"+d,sheetSubId:u});case 17:return t.next=19,M(s);case 19:if(t.sent.retcode!==C._I){t.next=25;break}return null===e||void 0===e||e(),(0,Ht.S)(Yt.iR.SIZE_LIMIT_OWNER),t.abrupt("return");case 25:null===e||void 0===e||e(),(0,_t.yg)();case 27:case"end":return t.stop()}}),t,this)})))},e.handleNewToForm=function(){return Qt(this,void 0,void 0,zt().mark((function t(){var e,n;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=w.q.getConfig("globalPadId"),n=C.qF+"?sheet_id="+e,$t("clk_new_to_form"),Kt(n);case 4:case"end":return t.stop()}}),t)})))},e.handleConvertToForm=function(){return Qt(this,void 0,void 0,zt().mark((function t(){return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.questionListDialog.show(),$t("clk_sheetcon_create");case 2:case"end":return t.stop()}}),t,this)})))},e.handleNewToFormWithQuestions=function(t){return Qt(this,void 0,void 0,zt().mark((function e(){var n,r,o,i;return zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,rt.generateSheetId)(),r=this.getSheetTitle(),o=this.getSheetName(r),e.prev=3,e.next=6,N(n,o,t);case 6:i=e.sent,this.createSuccess(n,i,!1),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),this.createFail(n,e.t0);case 13:$t("clk_sheet_create");case 14:case"end":return e.stop()}}),e,this,[[3,10]])})))},e.handleCheckForm=function(t){var e=t||this.getCurrentSheetId();if(this.isRelated(e)){var n=this.getFormUrl(e,"?openfrom=sheet_check");this.gotoFormEditPage(n),$t("clk_formbar_view")}},e.handleSwitchTipsToForm=function(t){var e=t||this.getCurrentSheetId();if(this.isRelated(e)){var n=this.getFormUrl(e,"?openfrom=switch_tips");this.gotoFormEditPage(n)}},e.handleCancelForm=function(t,e,n){var r=this,o=t||this.getCurrentSheetId(),a=this.getRelation(o);if(a){var s=a.subId,u=w.q.getConfig("globalPadId"),l=a.docId.domain_id+"$"+a.docId.pad_id,h=function(){return Z({sheetSubId:s,sheetGlobalId:u,formGlobalId:l}).then((function(t){r.cancelSuccess(o,t,n)})).catch((function(){r.showToolToast(i.ZP.t("取消关联收集表失败，请稍后重试。"))}))};if(e)h();else{var d=i.ZP.t("取消关联后，收集结果将不再自动更新到表格。确定取消吗？");c.Z.dialog.dialog.confirm({title:i.ZP.t("取消关联收集表"),content:d,onOk:function(){h(),$t(n?"clk_sheet_cancel":"clk_formbar_cancel")}})}}},e.cancelSuccess=function(t,e,n){e&&0===e.retcode?(this.unbindSubSheetRelatedForm(t),this.resetSheetType(t),this.handleDone(),n||this.showToolToast(i.ZP.t("取消关联收集表成功。"))):this.showToolToast(i.ZP.t("取消关联收集表失败，请稍后重试。"))},e.showToolToast=function(t){(0,tt.showToast)(t,{},{toolToastCloseTime:3e3})},e.handleShareForm=function(t){var e=t||this.getCurrentSheetId();if(this.isRelated(e)){var n=this.getFormUrl(e,"?openfrom=sheet_share");this.gotoFormEditPage(n),$t("clk_formbar_share")}},e.handleResultForm=function(t){var e=t||this.getCurrentSheetId();if(this.isRelated(e)){var n=this.getFormUrl(e,"#/result");this.gotoFormEditPage(n),$t("clk_formbar_result")}},e.handleCheckAllFormByUser=function(t){return Qt(this,void 0,void 0,zt().mark((function e(){var n,r,o;return zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V({index:0});case 2:n=e.sent,r=n.list,o=n.nextPageIndex,t?t(r,o):this.formSelectDialog.show(r,o);case 6:case"end":return e.stop()}}),e,this)})))},e.handleShowQRCode=function(t){if(t){var e=this.relateFormDetailMap.get(t);(null===e||void 0===e?void 0:e.title)&&(null===e||void 0===e?void 0:e.docUrl)&&this.qrCodeDialog.show(e.title,e.docUrl)}},e.handleExportForm=function(t){var e=t.formGlobalPadId,r=function(t,e){void 0===e&&(e=!1),K.default.show({type:e?"error":"info",message:t,duration:5e3,autoClose:!0})},o=function(t,e){void 0===e&&(e=!1);var n=i.ZP.t("正在导出...{{rate}}%",{rate:t});!0===e?Gt.Z.showToast(n,{"z-index":"10001"},{alwayOn:!0}):Gt.Z.changeToastInnerText(n,t<100?"info":"success"),100===t&&setTimeout(Gt.Z.hideToast,5e3)};nt().isPC||nt().isTencentDocsApp?!nt().isTencentDocsApp||nt().isTencentDocsAppVersionAboveOrEqual("2.5.0")?(o(0,!0),function(t,e){R(this,void 0,void 0,O().mark((function n(){var r,o,i,a,s,c=this;return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=1e4,o=1e3,i=36e5,a=Date.now(),n.next=6,A(t);case 6:if(0===n.sent.retcode){n.next=11;break}return e({isFailed:!0,rate:0}),n.abrupt("return");case 11:s=!1,function n(){return R(c,void 0,void 0,O().mark((function c(){var u,l,h,d,f,p,v;return O().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!(Date.now()-a>=i)){c.next=3;break}return e({isFailed:!0,rate:0}),c.abrupt("return");case 3:return u=setTimeout((function(){s=!0,e({isFailed:!0,rate:0})}),r),c.next=6,j(t);case 6:if(l=c.sent,h=l.rate,d=void 0===h?0:h,f=l.url,p=l.retcode,clearTimeout(u),!s){c.next=14;break}return c.abrupt("return");case 14:if(0===p){c.next=17;break}return e({isFailed:!0,rate:0}),c.abrupt("return");case 17:v=Math.min(100,d),e({fileUrl:f,rate:v=f?100:v,isFailed:!1}),v<100&&setTimeout(n,o);case 21:case"end":return c.stop()}}),c)})))}();case 14:case"end":return n.stop()}}),n)})))}(e,(function(t){var e,a=t.rate,s=t.fileUrl;if(t.isFailed)return r(i.ZP.t("RELATE_FORM_EXPORT_FAILED"),!0),void Gt.Z.hideToast();o(a),a<100||!s||(nt().isTencentDocsApp?null===(e=null===n.g||void 0===n.g?void 0:n.g.mqq)||void 0===e||e.invoke("docx","fileDownload",s):(0,qt.ZP)(s))}))):r(i.ZP.t("RELATE_FORM_EXPORT_SHOULD_USE_NEW_VERSION_APP")):r(i.ZP.t("RELATE_FORM_EXPORT_PLATFORM_NOT_SUPPORTED"))},e.updateRelatedInfos=function(t){var e=this;if(0===this.getRelatedNumber())return this.relatedFormInfos=[],void this.updateRelatedFormInfos();var r=Array.from(this.relateMap.values()).map((function(t){return t.docId}));(0,xt.eB)(r).then((function(n){e.relatedFormInfos=n,e.trySwitchToRelatedForm(t),e.updateRelatedFormInfos()})).catch((function(t){for(var o=[],a=0;a<r.length;a++)o.push({doc_meta:{title:i.ZP.t("收集表{{value}}",{value:a+1}),doc_id:r[a]}});e.relatedFormInfos=o,e.updateRelatedFormInfos(),n.g.log.error("relateForm 获取关联收集表信息失败: "+t)}))},e.trySwitchToRelatedForm=function(t){var e,n=this;if(t){var r=this.relatedFormInfos.find((function(e){var n=e.doc_meta.doc_id;return(0,ot.DZ)(n,t)}));if(r&&r.doc_meta.creator_uid===w.q.getConfig("uid")){var o=null===(e=r.doc_meta.relative_doc)||void 0===e?void 0:e[0].sub_id;if(o){var i=this.app.spreadsheet.sheetManager.getSheetBySheetId(o),a=void 0;(null===i||void 0===i?void 0:i.getSheetType())===Vt.SHEET_TYPE.SMART_SHEET&&(a=function(){new Bt.default(n.app,n.app.spreadsheet.activeSheetId).handleSmartSheetForm(!0)}),this.switchToRelatedSheet(o,a)}}}},e.updateRelatedFormInfos=function(){s.Z.event.header.trigger("relatedFormInfosUpdate")},e.getRelatedRangeType=function(t,e){var n=0;return"question"===t&&(n=1),t.indexOf("record")>=0&&(n=2),!n||3!==e&&4!==e&&e!==n?0:e},t}(),ne=ee},39702:function(t,e,n){n.d(e,{c:function(){return r},e:function(){return o}});var r,o=(0,n(76138).yh)("IRelateForm");!function(t){t.SIMPLE="SIMPLE",t.RADIO="RADIO",t.CHECKBOX="CHECKBOX",t.SELECT="SELECT",t.DATE="DATE",t.TIME="TIME",t.TEMPERATURE="TEMPERATURE",t.LOCATION="LOCATION",t.IMAGE="IMAGE",t.CANVAS="CANVAS"}(r||(r={}))},60202:function(t,e,n){n.d(e,{Z:function(){return T}});var r={};n.r(r),n.d(r,{hideModal:function(){return u},showModal:function(){return c}});var o={};n.r(o),n.d(o,{Progress:function(){return b},default:function(){return S}});var i=n(46086),a=n(2980),s=n(40182),c=function(t,e,n){(0,s.Fd)().then((function(r){r.default.showModal(t,e,n)}))},u=function(t,e){(0,s.Fd)().then((function(n){n.default.hideModal(t,e)}))},l=n(41415),h=n(8049),d=(n(13857),n(54371),n(95019),n(71091),n(31575),n(5570),n(64656),n(43125),n(27849),n(84919),n(11425),n(15770),n(85952)),f=(n(38934),n(48845),n(46396),n(12024),n(81502),n(90109),n(44904),n(31688),n(71096),n(19553),n(81144),n(24245)),p=n(10531),v=n(63313),m=n.n(v),g=n(74012),y=n.n(g),w=function(t){var e=t.progress;if(e<=.05)return m().createElement("img",{style:{width:"16px",height:"16px"},src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46YXV0byIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIGRpc3BsYXk9ImJsb2NrIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjZGFlOWZmODAiIHN0cm9rZS13aWR0aD0iMTAiIGZpbGw9Im5vbmUiLz48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSIzMCIgc3Ryb2tlPSIjNDg5MmZlIiBzdHJva2Utd2lkdGg9IjEwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiIHRyYW5zZm9ybT0icm90YXRlKDcwOC45NTIgNTAgNTApIj48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiIGR1cj0iMS4yNXMiIHZhbHVlcz0iMCA1MCA1MDsxODAgNTAgNTA7NzIwIDUwIDUwIiBrZXlUaW1lcz0iMDswLjU7MSIvPjxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InN0cm9rZS1kYXNoYXJyYXkiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjEuMjVzIiB2YWx1ZXM9IjE4Ljg0OTU1NTkyMTUzODc2IDE2OS42NDYwMDMyOTM4NDg4Mjs3NS4zOTgyMjM2ODYxNTUwMyAxMTMuMDk3MzM1NTI5MjMyNTQ7MTguODQ5NTU1OTIxNTM4NzYgMTY5LjY0NjAwMzI5Mzg0ODgyIiBrZXlUaW1lcz0iMDswLjU7MSIvPjwvY2lyY2xlPjwvc3ZnPg=="});var n=6.28*55*e;return m().createElement("svg",{width:"14px",height:"14px",version:"1.1",viewBox:"0 0 120 120",preserveAspectRatio:"none"},m().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#D4D5D9",strokeWidth:"14",strokeDasharray:"360,20000",transform:"rotate(-90,100,100)"}),m().createElement("circle",{cx:"140",cy:"60",r:"52",fill:"none",stroke:"#0082EF",strokeWidth:"14",strokeDasharray:n+",20000",transform:"rotate(-90,100,100)",strokeLinecap:"round"}))},E=function(t,e){void 0===t&&(t=0),y().render(m().createElement(w,{progress:t}),e)};function _(){"use strict";_=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(C){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof h?e:h,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=c;var l={};function h(){}function d(){}function f(){}var p={};s(p,o,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==e&&n.call(m,o)&&(p=m);var g=f.prototype=h.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function r(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return d.prototype=f,s(g,"constructor",f),s(f,"constructor",d),d.displayName=s(f,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(w.prototype),s(w.prototype,i,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},y(g),s(g,a,"Generator"),s(g,o,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;b(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}var x=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))},b=function(){function t(t){var e=this;this.translateX=0,this.translateY=0,this._eventDisposes=[],this.show=function(){return x(e,void 0,void 0,_().mark((function t(){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.initPosition(),Object.assign(this.progressView.style,{position:"absolute",backgroundColor:"white",zIndex:1,display:"flex",alignItems:"center",overflow:"hidden",fontSize:"13px",pointerEvents:"none",borderWidth:"0px",boxShadow:"0 0 0 1px #E2E4E8",boxSizing:"border-box"}),this.visibile=!0,this.valid=!0,this.container.appendChild(this.progressView);case 5:case"end":return t.stop()}}),t,this)})))},this.updateProgress=function(t){E(t,e.iconSpan)},this.hide=function(){e.visibile=!1,e.container.contains(e.progressView)&&e.container.removeChild(e.progressView),e.handleEvent(!1)},this.cancelUpload=function(){e.valid=!1,e.hide()},this.getPositionInfo=function(){return{sheetId:e.sheetId,row:e.row,col:e.col}},this.setVisible=function(){e.visibile=!0,e.progressView.style.display="flex"},this.setHidden=function(){e.visibile=!1,e.progressView.style.display="none"},this.handleUpdateCells=function(t){var n=t.startRow,r=t.endRow,o=t.startCol,i=t.endCol;e.row>=n&&e.row<=r&&e.col>=o&&e.col<=i&&e.onRemove(e.id)},this.handleChange=function(t){return function(n){var r=n.sheetId,o=n.index,i=n.amount,a=n.type;if(r===e.sheetId){var s=a===p.DIMENSION_TYPE.ROWS?"row":"col";t&&new Array(i).fill(o).map((function(t,e){return t+e})).includes(e[s])?e.onRemove(e.id):(t&&o+i-1>e[s]&&(e[s]=Math.max(0,e[s]-i)),!t&&o+i-1<=e[s]&&(e[s]=e[s]+i),e.initPosition())}}},this.toggleVisible=function(t){if(t===e.sheetId)return e.setVisible();e.setHidden()},this.handleEvent=function(t){var n=e._eventDisposes;if(!t)return n.forEach((function(t){t.dispose()})),e._eventDisposes=[],void e.app.event.sheetsBar.remove("switchSheet",e.toggleVisible);var r=e.app.view.canvas,o=r.areaData,i=r.resize,a=r.scale,s=r.dataCallView;n.push(o.onUpdateOffset(e.updatePosition)),n.push(i.onResize(e.initPosition)),n.push(a.onScale(e.initPosition)),n.push(s.onSetRowHeight(e.initPosition)),n.push(s.onSetRowVisible(e.initPosition)),n.push(s.onSetColWidth(e.initPosition)),n.push(s.onSetColVisible(e.initPosition)),n.push(s.onMergeUnmerge(e.initPosition)),n.push(s.onUpdateChart(e.initPosition)),n.push(s.onUpdateFreeze(e.initPosition)),n.push(s.onUpdateCells(e.handleUpdateCells)),n.push(s.onDeleteRow(e.handleChange(!0))),n.push(s.onDeleteCol(e.handleChange(!0))),n.push(s.onInsertRow(e.handleChange(!1))),n.push(s.onInsertCol(e.handleChange(!1))),e.app.event.sheetsBar.listen("switchSheet",e.toggleVisible)},this.initDOM=function(){e.iconSpan=document.createElement("span"),e.iconSpan.style.margin="0 4px",e.iconSpan.style.width="14px",e.iconSpan.style.height="14px",e.progressView.appendChild(e.iconSpan),E(0,e.iconSpan),e.textSpan=document.createElement("span"),e.textSpan.style.color="#3677FD",e.textSpan.style.textDecoration="underline",e.textSpan.style.textDecorationColor="#3677FD",e.textSpan.style.whiteSpace="nowrap",e.textSpan.style.textOverflow="ellipsis",e.textSpan.style.overflow="hidden",e.progressView.appendChild(e.textSpan),e.textSpan.textContent=e.text},this.initPosition=function(){var t=e.app.view.canvas,n=t.tableView,r=t.areaData,o=t.headSize,i=t.rowcolAccessor,a=t.clientRect,s=n.getCellViewAtPosition(e.row,e.col),c=e.col,u=e.row,l=(0,f.E)(i,s,e.row),h=(0,f.o)(i,s,e.col),d=r.getDisplayViewTopByRow(u);(null===s||void 0===s?void 0:s.mergeData)&&(u+=s.mergeData.rowCount-1);var p=r.getDisplayViewBottomByRow(u),v=a.height-o.displayColHeadHeight;e.progressView.style.bottom=v-d+"px",e.progressView.style.top=p-l+"px";var m=r.getDisplayViewLeftByCol(c);e.progressView.style.left=m+"px",e.progressView.style.width=h-1+"px",e.progressView.style.height=l-1+"px",e.progressView.style.backgroundSize=Math.min(h,40)+"px "+Math.min(l,40)+"px",e.translateX=r.getDisplayViewLeftByCol(c),e.translateY=r.getDisplayViewTopByRow(u)},this.updatePosition=function(){var t=e.app.view.canvas,n=t.tableView,r=t.areaData,o=n.getCellViewAtPosition(e.row,e.col),i=e.col,a=e.row;(null===o||void 0===o?void 0:o.mergeData)&&(a+=o.mergeData.rowCount-1);var s=r.getDisplayViewLeftByCol(i),c=r.getDisplayViewTopByRow(a);e.progressView.style.transform="translate("+(s-e.translateX)+"px, "+(c-e.translateY)+"px)"},this.id=t.id,this.app=t.app,this.container=t.app.view.canvas.mainBoard.element,this.row=t.row,this.col=t.col,this.sheetId=t.sheetId,this.visibile=!1,this.progressView=document.createElement("div"),this.text=t.text,this.onRemove=t.onRemove,this.initDOM(),this.handleEvent(!0)}return t.prototype.getProgressView=function(){return this.progressView},(0,d.Z)(t,[{key:"isVisible",get:function(){return this.visibile}},{key:"isValid",get:function(){return this.valid}}]),t}(),I=function(){function t(){}return t.createInstance=function(e,n,r,o,i,a,s){if(null===n.view.getSelection())return null;var c=new b({id:e,app:n,row:r,col:o,sheetId:i,text:a,onRemove:s});return t.value[e]=c},t.getInstance=function(e){return t.value[e]},t.removeInstance=function(e){var n;Object.keys(t.value).includes(e)&&(null===(n=t.value[e])||void 0===n||n.cancelUpload(),t.value[e]=void 0)},t.keys=function(){return Object.keys(t.value)},t}();I.value={};var S=I,T={dialog:i,alert:a,modal:r,toast:l,tooltip:h,progress:o}},8049:function(t,e,n){n.r(e),n.d(e,{changeTooltipText:function(){return l},default:function(){return d},hideTooltip:function(){return u},horizontalTooltip:function(){return h},showTooltip:function(){return c},toolTip:function(){return s}});var r=n(40182),o=n(14831),i=n.n(o),a=n(4175),s=function(t,e){(0,r.gB)().then((function(n){n.tooltip(t,e)}))},c=function(t,e){(0,r.gB)().then((function(n){n.tooltip(t,e)}))},u=function(){(0,r.gB)().then((function(t){t.hideTooltip()}))},l=function(t){(0,r.gB)().then((function(e){e.changeTooltipText(t)}))},h=function(t,e,n){(0,r.gB)().then((function(r){r.horizontalTooltip(t,e,n)}))};function d(){a.ZP.windowEvent.listen("resize",(function(){$("#tooltip").remove()})),a.ZP.windowEvent.listen("keydown",(function(){$("#tooltip").remove()})),i().isMobilePhone||i().isAndroidPad||!window.SpreadsheetApp.sheetStatus.canEdit||s("#toolbar [data-tooltip]")}},12337:function(t,e){var n;!function(t){t[t.FORM=2]="FORM",t[t.AIO=7]="AIO"}(n||(n={})),e.Z=n},86673:function(t,e,n){n.d(e,{LO:function(){return s},eB:function(){return a}}),n(38934),n(48845);var r=n(56592),o=n.n(r),i=n(62986);function a(t){var e={doc_ids:JSON.stringify(t),xsrf:(0,i.f)()};return new Promise((function(t,n){o().get("/cgi-bin/online_docs/doc_infosguest",{params:e,withCredentials:!0}).then((function(e){var r=e.data;0===r.cgicode&&0===r.retcode||n(r.msg),t(r.doc_info)})).catch((function(t){n(t)}))}))}function s(t){var e={relation:t,xsrf:(0,i.f)()};return new Promise((function(t,n){o().post("/v2/file/relation/dissociate",e).then((function(e){var r=e.data;0===r.cgicode&&0===r.retcode||n(r.msg),t(r)})).catch((function(t){n(t)}))}))}},59021:function(t,e,n){n.d(e,{QP:function(){return c},tZ:function(){return u},yg:function(){return s}}),n(38934),n(48845),n(52865),n(64425),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(12337),o=n(4175);function i(){"use strict";i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(C){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=u;var h={};function d(){}function f(){}function p(){}var v={};c(v,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(S([])));g&&g!==e&&n.call(g,o)&&(v=g);var y=p.prototype=d.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},w(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(y),c(y,s,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;b(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}n(11278);var a=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};function s(){return a(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.ZP.header.trigger("relateBtnUpdate"),o.ZP.sheetsBar.trigger("bindStatusChange"),o.ZP.formRelationEvent.trigger("formRelationChange");case 3:case"end":return t.stop()}}),t)})))}function c(t){var e=t.split("$");return{domain_id:+e[0],pad_id:e[1]}}function u(t,e){if(t&&t.relateForm&&t.relateAio)return t.relateForm.isRelated(e)?r.Z.FORM:t.relateAio.isRelated(e)?r.Z.AIO:void 0}},9969:function(t,e,n){var r=n(50267),o=n(78216),i=new function t(){var e=this;this.showToast=function(t,n,r){return e.isMobile()?e.mobileShowToast(t,r):(0,o.showToast)(t,n,r)},this.hideToast=function(){return e.isMobile()?e.mobileHideToast():(0,o.hideToast)()},this.changeToastInnerText=function(t,n){return e.isMobile()?e.mobileChangeToastInnerText(t):(0,o.changeToastInnerText)(t,n)},this.isMobile=function(){return!1},this.mobileShowToast=function(e,n){t.toastInstance&&(t.toastInstance.close(),t.toastInstance=void 0),t.toastInstance=r.default.show({content:e,duration:n.toolToastCloseTime||5e3,autoClose:!n.alwayOn,position:"bottom"})},this.mobileHideToast=function(){t.toastInstance&&(t.toastInstance.close(),t.toastInstance=void 0)},this.mobileChangeToastInnerText=function(e){t.toastInstance&&t.toastInstance.update&&t.toastInstance.update({content:e})}};e.Z=i},89074:function(t,e,n){n.r(e),n.d(e,{default:function(){return l}}),n(38934),n(48845),n(25594),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(30628),o=n(41415),i=n(31973),a=n(11376);function s(){"use strict";s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(C){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=u;var h={};function d(){}function f(){}function p(){}var v={};c(v,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(S([])));g&&g!==e&&n.call(g,o)&&(v=g);var y=p.prototype=d.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},w(E.prototype),c(E.prototype,i,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;b(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}n(36156);var c,u=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.UNINIT=1]="UNINIT",t[t.FAIL=2]="FAIL"}(c||(c={}));var l=function(){function t(t,e,n){var s=this;void 0===n&&(n=c.UNINIT),this.app=t,this.sheetId=e,this.status=n,this.handleSmartSheetForm=function(t){var e=(0,r.IZ)("from"),n="form"===e||t;"form"===e&&s.removeUrl();var c=s.checkIsSmartSheetForm();if(n&&c){s.initEvent(),(0,o.showToast)(a.ZP.t("如需重新关联传统工作表，可在收集表中设置"),void 0,{isNeedBtn:!0,btnText:a.ZP.t("去设置"),btnTextAfter:"",btnCallBack:function(){s.switchToSheet(),(0,o.hideToast)()},toolToastCloseTime:5e3});var u=s.app.spreadsheet.sheetManager.getSheetList().length>1;i.ZP.tdwReport({opername:"doc_sheet",module:"form_to_ssheet",action:"switch_view",ver5:t?3:u?2:1})}}}var e=t.prototype;return e.checkIsSmartSheetForm=function(){var t,e;return!!this.app.spreadsheet.isExternalSheet()&&!!(null===(e=(t=this.app.feature.relateForm).isRelated)||void 0===e?void 0:e.call(t,this.sheetId))},e.switchToSheet=function(){var t;return u(this,void 0,void 0,s().mark((function e(){var r,o,a=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null===(t=this.app.feature.relateForm)||void 0===t?void 0:t.getRelatedInfos(),o=r.find((function(t){var e,n,r;return(null===(r=null===(n=null===(e=null===t||void 0===t?void 0:t.doc_meta)||void 0===e?void 0:e.relative_doc)||void 0===n?void 0:n[0])||void 0===r?void 0:r.sub_id)===a.sheetId})),o){e.next=4;break}return e.abrupt("return");case 4:try{this.goToFormPage(),this.status=c.SUCCESS}catch(s){n.g.log.error("smartsheet","跳转收集表页面失败",s),this.status=c.FAIL}i.ZP.tdwReport({opername:"doc_sheet",module:"form_to_ssheet",action:"switch_click"});case 6:case"end":return e.stop()}}),e,this)})))},e.goToFormPage=function(){this.app.feature.relateForm.handle("switch_tips_to_form",this.sheetId)},e.removeUrl=function(){var t=document.location.href;t=(0,r.oW)(t,"from"),history.replaceState(null,"",t)},e.initEvent=function(){var t=this;setTimeout((function(){t.app.event.sheetsBar.one("switchActiveSheetEnd",(function(){t.status===c.UNINIT&&(0,o.hideToast)()}))}),0)},t}()},4781:function(t,e,n){n.d(e,{S:function(){return s}}),n(38934),n(48845),n(84919),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(11425),n(15770);var r=n(48237),o=n(41510);function i(){"use strict";i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(C){c=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new I(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=u;var h={};function d(){}function f(){}function p(){}var v={};c(v,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(S([])));g&&g!==e&&n.call(g,o)&&(v=g);var y=p.prototype=d.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function b(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},w(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(y),c(y,s,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),b(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;b(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}var a=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}c((r=r.apply(t,e||[])).next())}))};function s(t,e,n){return void 0===e&&(e=void 0),void 0===n&&(n=!1),a(this,void 0,void 0,i().mark((function a(){var s,u;return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.default.getExtension(o.XM.name);case 2:s=i.sent,u=c(o.XM.name),s.show({type:t,container:u,needReturnToTrash:n,report:e?{ver9:e}:void 0});case 5:case"end":return i.stop()}}),a)})))}function c(t){var e=document.getElementById(t);if(e)return e;var n=document.createElement("div");return n.id=t,document.body.appendChild(n),n}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/797.d7edba75c3caa723cfee.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=797.d7edba75c3caa723cfee.js.map