self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[9493],{66675:function(){},3332:function(e,t,n){var r,a;n.d(t,{U:function(){return o},k:function(){return a}}),n(19553),n(38934),n(48845),n(71091),n(81144),n(36156),function(e){e.ACCESSIBILITY="ACCESSIBILITY",e.CONTEXT_MENU_CENTER="CONTEXT_MENU_CENTER",e.SHAPE_EDIT_CENTER="SHAPE_EDIT_CENTER",e.SMART_DRAG="SMART_DRAG",e.COLLAB_CURSOR="COLLAB_CURSOR",e.RENDER_PLUGIN_EXTENSION="RENDER_PLUGIN_EXTENSION",e.CARD_CENTER="CARD_CENTER",e.LINK_CENTER="LINK_CENTER",e.COMMENT_CENTER="COMMENT_CENTER",e.AREA_OVERLAY="AREA_OVERLAY",e.SHAPE_UPLOAD="SHAPE_UPLOAD",e.PC_DIMENSION_EDIT="PC_DIMENSION_EDIT",e.DIMENSION_COLOR="DIMENSION_COLOR",e.FREEZE_PREVIEW="FREEZE_PREVIEW",e.TEST_API="TEST_API",e.FILTER_CENTER="FILTER_CENTER",e.PC_DATA_VALIDATION_CENTER="PC_DATA_VALIDATION_CENTER",e.COLLAB_FILTER_TOAST="COLLAB_FILTER_TOAST",e.PC_FORMULA_UI_CENTER="PC_FORMULA_UI_CENTER",e.COPY_FRAME="COPY_FRAME",e.CORNER_TRIANGLE_RENDER_PLUGIN="CORNER_TRIANGLE_RENDER_PLUGIN",e.MENTION_CENTER="MENTION_CENTER",e.PREVIEW_IMAGE_ICON="PREVIEW_IMAGE_ICON",e.CHART_CENTER="CHART_CENTER",e.TABLE_KEYBOARD="TABLE_KEYBOARD",e.FILE_SELECTOR="FILE_SELECTOR",e.FILE_UPLOADER="FILE_UPLOADER",e.POSITION_API="POSITION_API",e.HOVER_CARD_CENTER="HOVER_CARD_CENTER",e.SEARCH_REPLACE="SEARCH_REPLACE",e.RANGE_AUTH_RENDER_PLUGIN="RANGE_AUTH_RENDER_PLUGIN",e.INPUT_SMART_SPLIT="INPUT_SMART_SPLIT",e.CONDITION_FORMAT_CENTER="CONDITION_FORMAT_CENTER",e.ERROR_TIP="ERROR_TIP",e.CELL_CORNER_PLUGIN="CELL_CORNER_PLUGIN",e.CELL_EDITOR_MANAGER="CELL_EDITOR_MANAGER",e.CELL_IMAGE_VIEWER="CELL_IMAGE_VIEWER",e.RANGE_MOVE="RANGE_MOVE",e.TABLE_PRINT_CENTER="TABLE_PRINT_CENTER",e.READONLY_DATE_REMINDER_CENTER="READONLY_DATE_REMINDER_CENTER",e.DATE_REMINDER_CENTER="DATE_REMINDER_CENTER",e.CHART_RANGE="CHART_RANGE",e.CANVAS_PROVIDER="CANVAS_PROVIDER",e.SELECT_ROW_COL_HIGHLIGHT="SELECT_ROW_COL_HIGHLIGHT",e.HISTORY_REVIEW_CENTER="HISTORY_REVIEW_CENTER",e.WEDOC_DISCUSS="WEDOC_DISCUSS",e.AREA_TEXTURE_PLUGIN="AREA_TEXTURE_PLUGIN",e.PRIVATE_RANGE_RENDER_PLUGIN="PRIVATE_RANGE_RENDER_PLUGIN",e.FILTER_VIEW_CENTER="FILTER_VIEW_CENTER",e.COLLAB="COLLAB",e.DISCUSSION="DISCUSSION",e.WEWORK_COMPONENT="WEWORK_COMPONENT",e.TODO_CENTER="TODO_CENTER",e.RECORD_HOVER="RECORD_HOVER",e.ADDON_CENTER="ADDON_CENTER",e.COLLAB_AREA_CURSOR="COLLAB_AREA_CURSOR",e.PIVOT_TABLE_CENTER="PIVOT_TABLE_CENTER",e.FORMULA_ERROR_CENTER="FORMULA_ERROR_CENTER",e.INPUT_MANAGER="INPUT_MANAGER",e.USER_CUSTOM_THEME_CENTER="USER_CUSTOM_THEME_CENTER"}(a||(a={}));var o=((r={})[a.ACCESSIBILITY]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(1823),n.e(3107),n.e(7829),n.e(1159),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(9656),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(1861),n.e(882),n.e(9700),n.e(8123),n.e(3387)]).then(n.bind(n,62223))},r[a.CHART_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(1823),n.e(3107),n.e(7829),n.e(1159),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(9656),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(1861),n.e(882),n.e(9700),n.e(8123),n.e(3387)]).then(n.bind(n,63494))},r[a.ADDON_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,52103))},r[a.FREEZE_PREVIEW]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,45168))},r[a.TEST_API]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(1823),n.e(3107),n.e(7829),n.e(1159),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(9656),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(1861),n.e(882),n.e(9700),n.e(8123),n.e(3387)]).then(n.bind(n,90163))},r[a.SHAPE_EDIT_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,96902))},r[a.SMART_DRAG]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,1691))},r[a.CORNER_TRIANGLE_RENDER_PLUGIN]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,82990))},r[a.MENTION_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(1823),n.e(3107),n.e(7829),n.e(1159),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(9656),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(1861),n.e(882),n.e(9700),n.e(8123),n.e(3387)]).then(n.bind(n,51195))},r[a.CELL_EDITOR_MANAGER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(1823),n.e(3107),n.e(7829),n.e(1159),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(9656),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(1861),n.e(882),n.e(9700),n.e(8123),n.e(3387)]).then(n.bind(n,11019))},r[a.CELL_IMAGE_VIEWER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,53762))},r[a.PREVIEW_IMAGE_ICON]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,34470))},r[a.TABLE_KEYBOARD]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,201))},r[a.CELL_CORNER_PLUGIN]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,18129))},r[a.COLLAB_CURSOR]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,68254))},r[a.RENDER_PLUGIN_EXTENSION]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,40972))},r[a.CARD_CENTER]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,62484))},r[a.FORMULA_ERROR_CENTER]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,46171))},r[a.LINK_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,73265))},r[a.COMMENT_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(8738),n.e(8882),n.e(7058),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(3437),n.e(190),n.e(7722)]).then(n.bind(n,40187))},r[a.CONTEXT_MENU_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(1823),n.e(3107),n.e(7829),n.e(1159),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(9656),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(1861),n.e(882),n.e(9700),n.e(8123),n.e(3387)]).then(n.bind(n,50939))},r[a.AREA_OVERLAY]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,53388))},r[a.SHAPE_UPLOAD]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(5620),n.e(3107),n.e(1407),n.e(1470),n.e(505),n.e(9488),n.e(7894),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(4542),n.e(9700),n.e(9422),n.e(6972),n.e(983)]).then(n.bind(n,49517))},r[a.INPUT_MANAGER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(5620),n.e(3107),n.e(1407),n.e(1470),n.e(505),n.e(9488),n.e(7894),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(4542),n.e(9700),n.e(9422),n.e(6972),n.e(983)]).then(n.bind(n,36075))},r[a.PC_DIMENSION_EDIT]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,19011))},r[a.DIMENSION_COLOR]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,38430))},r[a.FILTER_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(1823),n.e(3107),n.e(7829),n.e(1159),n.e(505),n.e(2926),n.e(9488),n.e(7894),n.e(9656),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(1861),n.e(882),n.e(9700),n.e(8123),n.e(3387)]).then(n.bind(n,5126))},r[a.PC_DATA_VALIDATION_CENTER]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,381))},r[a.COLLAB_FILTER_TOAST]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(1449),n.e(7935),n.e(7747),n.e(9488),n.e(7894),n.e(5982),n.e(6739),n.e(5314),n.e(3100),n.e(5556)]).then(n.bind(n,22772))},r[a.PC_FORMULA_UI_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(5620),n.e(3107),n.e(1407),n.e(1470),n.e(505),n.e(9488),n.e(7894),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(4542),n.e(9700),n.e(9422),n.e(6972),n.e(983)]).then(n.bind(n,72556))},r[a.COPY_FRAME]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(1756),n.e(5620),n.e(3107),n.e(1407),n.e(1470),n.e(505),n.e(9488),n.e(7894),n.e(2941),n.e(3437),n.e(2980),n.e(1502),n.e(4542),n.e(9700),n.e(9422),n.e(6972),n.e(983)]).then(n.bind(n,17991))},r[a.SEARCH_REPLACE]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,18736))},r[a.RANGE_AUTH_RENDER_PLUGIN]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,1450))},r[a.INPUT_SMART_SPLIT]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,41588))},r[a.CONDITION_FORMAT_CENTER]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,56609))},r[a.ERROR_TIP]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,26950))},r[a.RANGE_MOVE]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,48545))},r[a.SELECT_ROW_COL_HIGHLIGHT]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(1449),n.e(7935),n.e(7747),n.e(9488),n.e(7894),n.e(5982),n.e(6739),n.e(5314),n.e(3100),n.e(5556)]).then(n.bind(n,90891))},r[a.TABLE_PRINT_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(8738),n.e(818),n.e(3541),n.e(7495)]).then(n.bind(n,92997))},r[a.CHART_RANGE]=function(){return Promise.all([n.e(5672),n.e(4335),n.e(1485)]).then(n.bind(n,10307))},r[a.CANVAS_PROVIDER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(1449),n.e(7935),n.e(7747),n.e(9488),n.e(7894),n.e(5982),n.e(6739),n.e(5314),n.e(3100),n.e(5556)]).then(n.bind(n,55164))},r[a.AREA_TEXTURE_PLUGIN]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,16819))},r[a.PRIVATE_RANGE_RENDER_PLUGIN]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,89530))},r[a.FILTER_VIEW_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(1449),n.e(7935),n.e(7747),n.e(9488),n.e(7894),n.e(5982),n.e(6739),n.e(5314),n.e(3100),n.e(5556)]).then(n.bind(n,87745))},r[a.PIVOT_TABLE_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(1449),n.e(7935),n.e(7747),n.e(9488),n.e(7894),n.e(5982),n.e(6739),n.e(5314),n.e(3100),n.e(5556)]).then(n.bind(n,69786))},r[a.COLLAB_AREA_CURSOR]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,54425))},r[a.HISTORY_REVIEW_CENTER]=function(){return Promise.all([n.e(3188),n.e(3298),n.e(5672),n.e(1449),n.e(7935),n.e(7747),n.e(9488),n.e(7894),n.e(5982),n.e(6739),n.e(5314),n.e(3100),n.e(5556)]).then(n.bind(n,1575))},r[a.RECORD_HOVER]=function(){return n.e(9306).then(n.bind(n,81706))},r[a.TODO_CENTER]=function(){return null},r[a.WEDOC_DISCUSS]=function(){return null},r[a.WEWORK_COMPONENT]=function(){return null},r[a.READONLY_DATE_REMINDER_CENTER]=function(){return null},r[a.DATE_REMINDER_CENTER]=function(){return null},r[a.FILE_UPLOADER]=function(){return null},r[a.COLLAB]=function(){return null},r[a.DISCUSSION]=function(){return null},r[a.FILE_SELECTOR]=function(){return null},r[a.HOVER_CARD_CENTER]=function(){return null},r[a.POSITION_API]=function(){return null},r[a.USER_CUSTOM_THEME_CENTER]=function(){return Promise.all([n.e(3298),n.e(5672),n.e(6551),n.e(4335),n.e(8738),n.e(4490),n.e(1823),n.e(599),n.e(9656),n.e(4542),n.e(87),n.e(9324)]).then(n.bind(n,80355))},r)},16900:function(e,t,n){n.d(t,{Q:function(){return a},_:function(){return r}});var r="addon_embed_",a=["e0b026441751437d8b0c45ff29b508c3","f4e3fba49a264e12891735d006af46ca"]},44365:function(e,t,n){var r=n(85952),a=(n(38934),n(31688),n(41031),n(77832)),o=n(5004),i=n(75227),c=n(80067),l=n(421),s=n(60973),u=function(){function e(e){var t=this;this._users=[],this._cacheImage=new Image,this._textWidth=0,this._cardVisiable=!1,this._position="none",this._hideCard=function(e){t._cardVisiable=!1,t._position="none",t.hideTimer&&t.hideTimer.stop(),t.hideTimer=null,e&&e()},this._users=[],this._drawCacheCard=(0,c.Ds)(this._drawCacheCard,0),e.users&&e.users.forEach((function(e){t.insertUser(e)}))}e.init=function(){e.canvas=document.createElement("canvas"),e.canvas.height=l.FP*l.cL,e.canvas.width=500*l.cL,e.canvas.style.height=l.FP+"px",e.canvas.style.width="500px",e.canvas.dir="ltr",e.ctx=e.canvas.getContext("2d"),e.ctx.font=13*l.cL+"px "+s.em,e.ctx.textAlign="left",e.ctx.textBaseline="middle"};var t=e.prototype;return t.insertUser=function(e){e.isEditing?this._users.unshift(e):this._users.push(e),this._drawCacheCard()},t.eraseUser=function(e){var t=this._users.indexOf(e);t>-1&&this._users.splice(t,1),0!==this._users.length?this._drawCacheCard():this._hideCard()},t.usersAmount=function(){return this._users.length},t.usersEditingAmount=function(){var e=0;return this._users.forEach((function(t){t.isEditing&&(e+=1)})),e},t.active=function(e){this._showCard(!0,e)},t.inactive=function(){this._hideCard()},t._drawCacheCard=function(){var e=this._users[0];if(e){this._color=o.Z.newInstanceByHex(e.color);var t=(0,a.Pb)(this._users),n=(0,a.mY)(t),r=(0,a.Jn)(t,e.color);this.cacheImage.src=r,this._textWidth=n/l.cL>>0,this._showCard()}},t._showCard=function(e,t){var n=this;void 0===e&&(e=!0),this._cardVisiable=!0,this.hideTimer&&this.hideTimer.stop(),e&&(this.hideTimer=i.Z.wait(l.rq).run((function(){return n._hideCard(t)})))},(0,r.Z)(e,[{key:"cacheImage",get:function(){return this._cacheImage}},{key:"color",get:function(){return this._color}},{key:"cardVisiable",get:function(){return this._cardVisiable}},{key:"textWidth",get:function(){return this._textWidth}},{key:"position",get:function(){return this._position},set:function(e){this._position=e}}]),e}();u.cardHeight=l.FP,u.DPR=l.cL,t.Z=u},421:function(e,t,n){n.d(t,{FP:function(){return a},cL:function(){return r},de:function(){return l},ou:function(){return i},rq:function(){return o},tr:function(){return c},yu:function(){return s}});var r=Math.max(window.devicePixelRatio||1,2),a=24,o=5e3,i="#ffffff",c=11,l="#ffb400",s="collab-area-border-collector"},77832:function(e,t,n){n.d(t,{Jn:function(){return i},Pb:function(){return f},db:function(){return s},ji:function(){return l},mY:function(){return c}}),n(44904),n(15770),n(84919),n(75793),n(91508);var r=n(11376),a=n(44365),o=(n(36156),n(421));function i(e,t){var n=c(e),r=a.Z.cardHeight*a.Z.DPR,i=a.Z.canvas,l=a.Z.ctx;return l.clearRect(0,0,n,r),l.save(),l.beginPath(),l.fillStyle=t,l.rect(0,0,n,r),l.fill(),l.closePath(),l.beginPath(),l.fillStyle=o.ou,l.fillText(e,o.tr*a.Z.DPR,r/2),l.closePath(),l.restore(),i.toDataURL("image/jpeg")}function c(e){return a.Z.ctx.measureText(e).width+o.tr*a.Z.DPR*2}function l(e,t){return function(e,t){for(var n=e.startRowIndex,r=e.endRowIndex,a=e.sheetId,o=n;o<=r;o++)if(!t.isRowHidden(o,a))return!1;return!0}(e,t)||function(e,t){for(var n=e.startColIndex,r=e.endColIndex,a=e.sheetId,o=n;o<=r;o++)if(!t.isColHidden(o,a))return!1;return!0}(e,t)}function s(e,t){return e.slice(0,t)+(e.length>t?"...":"")}function u(e){return e.name}function _(e,t){for(var n=0,r=[];n<t;n++)e[n]&&r.push(s(u(e[n]),10));return r.join("、")}function f(e){var t="",n=function(e){var t=u(e);return t=s(t,16),e.isEditing&&(t=r.ZP.t("{{text}} 正在输入 ",{text:t})),t};if(e.length<=1)t=n(e[0]);else if(e[0].isEditing)if(e[1].isEditing){for(var a=0,o=0;o<e.length&&e[o].isEditing;o++)a+=1;t=r.ZP.t("{{value0}}等{{count}}人正在输入",{value0:_(e,2),count:a})}else t=n(e[0]);else t=""+_(e,2)+(e.length>2?r.ZP.t("等"):"");return t}},72413:function(e,t,n){n.d(t,{AL:function(){return r},Lu:function(){return i},e5:function(){return c},kI:function(){return a},mt:function(){return o}});var r=[2,4,8,4,5];function a(e,t,n){var r=t+n;if(-1===n){for(;r>=0;--r)if(!e.isRowHidden(r))return r}else for(;r<e.getRowCount();++r)if(!e.isRowHidden(r))return r;return-1}function o(e,t,n){var r=t+n;if(-1===n){for(;r>=0;--r)if(!e.isColHidden(r))return r}else for(;r<e.getColCount();++r)if(!e.isColHidden(r))return r;return-1}function i(e,t){for(var n=1;e.isRowHidden(t-n)&&t-n>=0;){if(e.isRowHiddenByUser(t-n))return!0;n+=1}return!1}function c(e,t){for(var n=1;e.isRowHidden(t+n)&&t+n<e.getRowCount();){if(e.isRowHiddenByUser(t+n))return!0;n+=1}return!1}},82249:function(e,t,n){function r(){"use strict";r=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(T){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=t&&t.prototype instanceof f?t:f,o=Object.create(a.prototype),i=new C(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var c=p(i,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===_)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,i),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(T){return{type:"throw",arg:T}}}e.wrap=s;var _={};function f(){}function h(){}function d(){}var E={};l(E,o,(function(){return this}));var v=Object.getPrototypeOf,R=v&&v(v(A([])));R&&R!==t&&n.call(R,o)&&(E=R);var w=d.prototype=f.prototype=Object.create(E);function g(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function D(e,t){function r(a,o,i,c){var l=u(e[a],e,o);if("throw"!==l.type){var s=l.arg,_=s.value;return _&&"object"==typeof _&&n.call(_,"__await")?t.resolve(_.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(_).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;this._invoke=function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}}function p(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,p(e,t),"throw"===t.method))return _;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,_;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,_):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_)}function m(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(m,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:y}}function y(){return{value:void 0,done:!0}}return h.prototype=d,l(w,"constructor",d),l(d,"constructor",h),h.displayName=l(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},g(D.prototype),l(D.prototype,i,(function(){return this})),e.AsyncIterator=D,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new D(s(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},g(w),l(w,c,"Generator"),l(w,o,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),_}},e}n.d(t,{Du:function(){return c},eo:function(){return o},sd:function(){return i}}),n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var a=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{l(r.next(e))}catch(t){o(t)}}function c(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((r=r.apply(e,t||[])).next())}))};function o(){return window.isTimelineMode}function i(){return window.isHideCollab}function c(e){return a(this,void 0,void 0,r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.discussionExt){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,new Promise((function(t){e.emitter.once(e.EVENT.DISCUSSION_LOADED,t)}));case 4:case"end":return t.stop()}}),t)})))}},23075:function(e,t,n){n.d(t,{Dh:function(){return f},OH:function(){return R},WA:function(){return _},bU:function(){return h},h9:function(){return w},pv:function(){return g}});var r=n(3205),a=n(91508),o=n(8326),i=n(27571),c=n(85130),l=n(85624),s=n(54996),u=n(77717),_=function(e){var t=e.spreadsheet.activeSheet.getBasicFilter();return!!t&&t.getIsLocalView()},f=function(e){if(!1!==o.Z.getConfig("custom.viewFilter")&&!e.sheetStatus.workbookStatus.canEdit){var t=e.spreadsheet.activeSheet.filterViewManager.getActiveFilterView();if(!t&&!e.spreadsheet.activeSheet.getBasicFilterInSheet())return!0;if(!t&&_(e))return!0;if(t&&!t.getBasicFilter())return!0}return!1},h=function(e,t){var n;return e.length>0&&!t.sheetStatus.workbookStatus.canEdit&&!1!==(null===(n=t.spreadsheet.activeSheet.getBasicFilter())||void 0===n?void 0:n.getIsLocalView())};function d(e,t){var n=e.activeSheet.getBasicFilter();if(!n)return null;var r=n.range,a=r.sheetId,o=r.startRowIndex,c=r.endRowIndex;return new i.GridRange(a,o,c,t,t)}function E(e,t){var n=d(e,t);return!!n&&!a.q.getConfig("isOwner")&&(0,c.Up)(e.workbookRangeManager,[n])}function v(e,t){var n=d(e,t);return!!n&&!a.q.getConfig("isOwner")&&(0,l.Nb)(e.parent,[n])}function R(e){var t=e.sheet,n=e.col,r=e.isForSSR,a=e.isActive,o=e.isHover,i=w(t,n);if(!i)return null;var c=i.setFilter,l=i.setSort,u=i.sortState,f=i.isPrivate,h=i.isCanNotRead,d=_(t.spreadsheetReference.parent)||!t.spreadsheetReference.isFilterSync,E=c?s.M4.PART:s.M4.ALL,v=s.n7.NONE;l&&(v=u===s.n7.DESC?s.n7.DESC:s.n7.ASCE);var R=s.WR.NORMAL;o&&(R=s.WR.HOVER),a&&(R=s.WR.ACTIVE),r&&(R=s.WR.NORMAL);var g=s.wR.SYNC;return f||h?g=s.wR.PRIVATE:d&&(g=s.wR.NOT_SYNC),{conditionStatus:E,sortStatus:v,hoverStatus:R,syncStatus:g}}function w(e,t){var n,a=e.getBasicFilter();if(!a)return null;var o=!!a.criteriaMap.get(t)||!1,i=!1,c=-1;if(null===(n=a.sortSpecs)||void 0===n?void 0:n.length){var l=a.sortSpecs[0];(i=l.dimensionIndex===t)&&(c=l.sortOrder===r.SORT_ORDER.DESCENDING?0:1)}return{setFilter:o,setSort:i,sortState:c,isPrivate:E(e.spreadsheetReference,t),isCanNotRead:v(e.spreadsheetReference,t)}}function g(e,t,n){var r=R({sheet:e,col:n,isForSSR:!0,isHover:!1,isActive:!1});if(!r)return null;var a=r.conditionStatus+":"+r.sortStatus+":"+r.hoverStatus+":"+r.syncStatus;return u.s[a]||null}},78173:function(e,t,n){n.d(t,{E8:function(){return l},fg:function(){return o},h5:function(){return s},pg:function(){return i},vJ:function(){return c}}),n(19553),n(30980),n(38934),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144);var r=n(45841),a=n(72291),o=[r.B.FILTER_BUTTON,r.B.ROW_NAME,r.B.COL_NAME],i=[r.B.ROW_PARENT,r.B.COL_PARENT],c=[r.B.ROW_GRAND_TOTAL,r.B.ROW_LEAF,r.B.ROW_NAME,r.B.ROW_PARENT,r.B.ROW_SUBTOTAL],l=[r.B.COL_GRAND_TOTAL,r.B.COL_HEAD,r.B.COL_LEAF,r.B.COL_NAME,r.B.COL_PARENT,r.B.COL_SUBTOTAL],s=new Map([[a.KK.FILTER,[r.B.FILTER_BUTTON,r.B.FILTER_NAME]],[a.KK.COLUMN,l],[a.KK.ROW,c],[a.KK.VALUE,[r.B.DATA,r.B.DATA_LEAF]]])},65367:function(e,t,n){n.d(t,{$:function(){return a},h:function(){return r}});var r={expansion:n(59985),collapse:n(80725)},a=18},38639:function(e,t,n){n.d(t,{C5:function(){return h},JY:function(){return f},LC:function(){return s},fC:function(){return d},ko:function(){return u},uP:function(){return _}}),n(12024),n(81502),n(25594),n(38934);var r=n(78173),a=n(33810),o=n(65367),i=n(54996),c=n(2555),l=n(77717);function s(e,t,n){var a=e.getPrimaryCellDataAtPosition(t,n);if(!a||!a.getPivotTableRef())return!1;var o=a.getPivotTableRef();return r.fg.includes(o.pivotCellType)}function u(e){return e===a.L.Ascending?i.n7.ASCE:e===a.L.Descending?i.n7.DESC:i.n7.NONE}function _(e,t,n){var r=e.getCellDataAtPosition(t,n);if(!r||!r.getPivotTableRef())return null;var a=r.getPivotTableRef(),o=a.id,i=a.fieldIndex,c=a.itemIndex;if("number"!==typeof i||"number"!==typeof c)return null;var l=e.pivotTableManager.getPivotTable(o).tableDefinition.pivotFields.pivotField[i].items.item.find((function(e){return e.x===c}));return l?!1===l.sd?"collapse":"expansion":null}function f(e,t,n){var r=_(e,t,n);return r&&o.h[r]||null}function h(e){var t=e.sheet,n=e.row,a=e.col,o=e.isHover,l=e.isActive,s=e.isForSSR,_=t.getCellDataAtPosition(n,a);if(!_||!_.getPivotTableRef())return null;var f=_.getPivotTableRef(),h=f.pivotCellType,d=f.id,E=f.fieldIndex;if(!r.fg.includes(h))return null;var v=t.pivotTableManager.getPivotTable(d);if(!v||void 0===E)return null;var R=(0,c.XD)(v,E)?i.M4.PART:i.M4.ALL,w=u((0,c.ny)(v,E)),g=i.WR.NORMAL;return o&&(g=i.WR.HOVER),l&&(g=i.WR.ACTIVE),s&&(g=i.WR.NORMAL),{conditionStatus:R,sortStatus:w,hoverStatus:g,syncStatus:i.wR.SYNC}}function d(e,t,n){var r=h({sheet:e,row:t,col:n,isActive:!1,isHover:!1,isForSSR:!0});if(!r)return null;var a=r.conditionStatus+":"+r.sortStatus+":"+r.hoverStatus+":"+r.syncStatus;return l.s[a]||null}},536:function(e,t,n){var r=n(72104);t.Z=function(e){this.emitter=new r.Z,this._alloyExcel=e.alloyExcel}},31360:function(e,t,n){n.d(t,{Z:function(){return J}});var r,a=n(85952),o=n(13504),i=(n(46396),n(72104)),c=(n(67196),n(62883),n(38934),n(31688),n(80828),n(52083)),l=n(597),s=function(){function e(e){var t=this;this._originRow=null,this._originCol=null,this._focusRow=null,this._focusCol=null,this._mouseDisposeEvent=[],this._handleDown=function(e){if(t._checkDownValid())if(e.e.shiftKey)t._handleDownWithShift(e);else{var n,r=e.currRow,a=e.currCol;e.e.which&&1===e.e.which&&(t._mouseDisposeEvent.push(t._mouseOperate.onMousemove(t._handleMove)),t._mouseDisposeEvent.push(t._mouseOperate.onMouseup(t._handleUp))),t._originRow=r,t._originCol=a,-1===r&&-1===a?(t._cacheActivation={row:0,col:0},n={activation:t._cacheActivation}):-1===a?(t._cacheActivation={row:r,col:0},n={yRange:[r,r],activation:t._cacheActivation}):-1===r?(t._cacheActivation={row:0,col:a},n={xRange:[a,a],activation:t._cacheActivation}):(a===Number.MAX_SAFE_INTEGER&&(a=t._areaData.getLastColInView()),r===Number.MAX_SAFE_INTEGER&&(r=t._areaData.getLastRowInView()),t._cacheActivation={row:r,col:a},n={yRange:[r,r],xRange:[a,a],activation:t._cacheActivation}),t._startSelect(t._selectData,n,e.e[c.jQ]),t._readySelect(t._selectData)}},this._handleMove=function(){if(null===t._selectData)throw new Error("must bind selectData in SelectCells module");if(!t._operateData.stopPropagation){var e=t._operateData.currRow,n=t._operateData.currCol;if(-1!==t._originRow||-1!==t._originCol){var r=void 0,a=void 0;-1!==t._originCol&&(r=t._handleMoveCalcXRange(n)),-1!==t._originRow&&(a=t._handleMoveCalcYRange(e));var o={xRange:r,yRange:a,activation:t._cacheActivation};t._updateSelect(t._selectData,o)}}},this._handleUp=function(){t._originRow=null,t._originCol=null,t._focusRow=null,t._focusCol=null,t._endSelect(t._selectData),t._mouseDisposeEvent.forEach((function(e){return e.dispose()})),t._mouseDisposeEvent.length=0},this._mouseOperate=e.mouseOperate,this._operateData=e.operateData,this._selectData=e.selectData,this._areaData=e.areaData,this._rowcolAccessor=e.rowcolAccessor,this._readySelect=e.readySelect,this._startSelect=e.startSelect,this._updateSelect=e.updateSelect,this._endSelect=e.endSelect,this._mouseOperate.onMousedown(this._handleDown)}var t=e.prototype;return t.changeSelectData=function(e){this._selectData=e},t._checkDownValid=function(){if(null===this._selectData)throw new Error("must bind selectData in SelectCells module");return!this._operateData.stopPropagation&&!this._operateData.isOverTable()&&(2!==this._operateData.e.button||!(0,l.Kt)(this._operateData.currRow,this._operateData.currCol,this._selectData))},t._handleDownWithShift=function(e){if(this._selectData){var t,n,r=this._selectData.activeRow,a=this._selectData.activeCol,o=e.currRow,i=e.currCol;-1===r&&(r=o),-1===a&&(a=i),-1!==i&&(t=i>a?[a,i]:[i,a]),-1!==o&&(n=o>r?[r,o]:[o,r]);var c={xRange:t,yRange:n};0===this._selectData.selectQueue.length?this._startSelect(this._selectData,c,!1):this._updateSelect(this._selectData,c)}},t._handleMoveCalcXRange=function(e){var t=[0,0];return e===Number.MAX_SAFE_INTEGER?e=this._areaData.getLastColInView():e!==Number.MIN_SAFE_INTEGER&&-1!==e||(e=this._areaData.getFirstColInView()),this._focusCol,this._originCol>e?(t[0]=e,t[1]=Math.min(this._rowcolAccessor.getColCount()-1,this._originCol)):(t[0]=this._originCol,t[1]=Math.min(this._rowcolAccessor.getColCount()-1,e)),this._focusCol=e,t},t._handleMoveCalcYRange=function(e){var t=[0,0];return e===Number.MAX_SAFE_INTEGER?e=this._areaData.getLastRowInView():e!==Number.MIN_SAFE_INTEGER&&-1!==e||(e=this._areaData.getFirstRowInView()),this._focusRow,this._originRow>=e?(t[0]=e,t[1]=Math.min(this._rowcolAccessor.getRowCount()-1,this._originRow)):(t[0]=this._originRow,t[1]=Math.min(this._rowcolAccessor.getRowCount()-1,e)),this._focusRow=e,t},e}(),u=(n(75793),n(79506)),_=n(77171),f=n(86495);function h(e){var t=e.activeRow,n=e.activeCol;if(t<0||n<0)throw new Error("移动激活区域异常")}function d(e,t,n,r,a){var o=e.getCellViewAtPosition(n,r);if(!o)return null;var i=null,c=a>0?l.BS:l.lP,s=a>0?(0,_.HN)(t):(0,_.kq)(t);if(null===s)return null;if(o.isEmpty())i=c({tableView:e,accessor:t},n+a,r,s,m);else{var f=c(t,n+a,r,s,u.hZ);if(null===f)return null;var h=e.getCellViewAtPosition(f,r);if(!h)return null;h.isEmpty()?i=c({tableView:e,accessor:t},f+a,r,s,m):null!==(i=c({tableView:e,accessor:t},n,r,s,S))&&(i=(a>0?l.lP:l.BS)({tableView:e,accessor:t},i-a,r,n,m))}return null==i&&(i=s),i}function E(e,t,n,r,a){var o=e.getCellViewAtPosition(n,r);if(!o)return null;var i=null,c=a>0?l.Q8:l.Xe,s=a>0?(0,_.qA)(t):(0,_.Ho)(t);if(null===s)return null;if(o.isEmpty())i=c({tableView:e,accessor:t},n,r+a,s,D);else{var f=c(t,n,r+a,s,u.hZ);if(null===f)return null;var h=e.getCellViewAtPosition(n,f);if(!h)return null;h.isEmpty()?i=c({tableView:e,accessor:t},n,f+a,s,D):null!==(i=c({tableView:e,accessor:t},n,r,s,p))&&(i=(a>0?l.Xe:l.Q8)({tableView:e,accessor:t},n,i-a,r,D))}return null==i&&(i=s),i}function v(e,t,n){var r=e.tableView,a=e.accessor,o=r.getCellViewAtPosition(n,t);if(null===o)throw new Error("getCellViewAtPosition error!");return(!o.mergeParent||0===o.mergeParent.x)&&(0,u.hZ)(a,t,n)}function R(e,t,n){var r=e.tableView,a=e.accessor,o=r.getCellViewAtPosition(n,t);if(null===o)throw new Error("getCellViewAtPosition error!");return(!o.mergeParent||r.getCellViewAtPosition(n+o.mergeParent.y,t+o.mergeParent.x).mergeData.colCount===1-o.mergeParent.x)&&(!(o.mergeData&&o.mergeData.colCount>1)&&(0,u.hZ)(a,t,n))}function w(e,t,n){var r=e.tableView,a=e.accessor,o=r.getCellViewAtPosition(n,t);if(null===o)throw new Error("getCellViewAtPosition error!");return(!o.mergeParent||0===o.mergeParent.y)&&(0,u.hZ)(a,t,n)}function g(e,t,n){var r=e.tableView,a=e.accessor,o=r.getCellViewAtPosition(n,t);if(null===o)throw new Error("getCellViewAtPosition error!");return(!o.mergeParent||r.getCellViewAtPosition(n+o.mergeParent.y,t+o.mergeParent.x).mergeData.rowCount===1-o.mergeParent.y)&&(!(o.mergeData&&o.mergeData.rowCount>1)&&(0,u.hZ)(a,t,n))}function D(e,t,n){var r=e.tableView,a=e.accessor;return(0,u.eN)(r,t,n)&&(0,u.hZ)(a,t,n)&&(0,u.PA)(r,t,n)}function p(e,t,n){var r=e.tableView,a=e.accessor;return(0,u.eN)(r,t,n)&&(0,u.hZ)(a,t,n)&&(0,u.AS)(r,t,n)}function m(e,t,n){var r=e.tableView,a=e.accessor;return(0,u.eN)(r,t,n)&&(0,u.hZ)(a,t,n)&&(0,u.PA)(r,t,n)}function S(e,t,n){var r=e.tableView,a=e.accessor;return(0,u.eN)(r,t,n)&&(0,u.hZ)(a,t,n)&&(0,u.AS)(r,t,n)}function C(e,t){e.getIsInsertion()?function(e,t){h(t),e.addSelection({xRange:[t.activeCol,t.activeCol],yRange:[t.activeRow,t.activeRow]}),e.setIsInsertion(!1)}(e,t):e.select instanceof f.Z&&function(e,t){h(t),e.updateSelection(e.currentSelectIndex,{xRange:[t.activeCol,t.activeCol],yRange:[t.activeRow,t.activeRow],activation:{row:t.activeRow,col:t.activeCol}})}(e,t)}function A(e,t,n,a,o){h(n);var i=n.activation;if(!i)throw new Error("移动选区异常");var c=i.col,s=i.row,u={row:s,col:c};if(a===r.X)if(o>0){var _=(0,l.Q8)({tableView:e,accessor:t},s,c+1,t.getColCount()-1,v);null!==_&&(u.col=_)}else{var f=(0,l.Xe)({tableView:e,accessor:t},s,c-1,0,R);null!==f&&(u.col=f)}else if(o>0){var d=(0,l.BS)({tableView:e,accessor:t},s+1,c,t.getRowCount()-1,w);null!==d&&(u.row=d)}else{var E=(0,l.lP)({tableView:e,accessor:t},s-1,c,0,g);null!==E&&(u.row=E)}return{xRange:[u.col,u.col],yRange:[u.row,u.row],activation:u}}!function(e){e[e.X=0]="X",e[e.Y=1]="Y"}(r||(r={}));var y=n(22696),T=n(90505),N=n(57991),I=n(77295);function b(e,t,n,a,o){return h(n),a===r.X?function(e,t,n,r){var a,o,i,c,s=n.selectQueue[n.currentSelectIndex],_=n.activeRow,f=n.activeCol;if(s instanceof y.Z||s instanceof N.Z)return null;if(!(s instanceof T.Z||s instanceof I.Z))throw new Error("不可用的选区类型");if(a=s.xRange[0],o=s.xRange[1],s instanceof T.Z?(i=0,c=t.getRowCount()-1):(i=s.yRange[0],c=s.yRange[1]),s instanceof T.Z){var h=function(e,t,n,r,a){var o;if(t>0){var i=function(e,t,n,r){var a,o,i=[t,n];if(r>t){if(a=t,null===(o=(0,l.Q8)(e,0,a+1,n,u.Sl)))return null;i[0]=o}else{if(a=n,null===(o=(0,l.Q8)(e,0,a+1,e.getColCount()-1,u.Sl)))return null;i[1]=o}return i}(e,n,r,a);if(!i)return;o=i}else{var c=function(e,t,n,r){var a,o,i=[t,n];if(r<n){if(a=n,null===(o=(0,l.Xe)(e,0,a-1,t,u.Sl)))return null;i[1]=o}else{if(a=t,null===(o=(0,l.Xe)(e,0,a-1,0,u.Sl)))return null;i[0]=o}return i}(e,n,r,a);if(!c)return;o=c}return o}(t,r,a,o,f);return h?{xRange:h,activation:{row:_,col:f}}:null}var d=function(e,t,n,r,a,o,i,c){var s;s=n>0?function(e,t,n,r,a,o,i){for(var c,s,_=[o,i],f=[r,a];;){var h=void 0;if(n>o){if(s=o,null===(h=(0,l.Q8)(t,0,s+1,i,u.Sl)))break;_[0]=h,c=l.mk.DISCARD}else{if(s=i,null===(h=(0,l.Q8)(t,0,s+1,t.getColCount()-1,u.Sl)))break;_[1]=h,c=l.mk.EXTEND}if(P(e,n,f,_,o,i,c))break;o=n,i=_[1]}return{xRange:_,yRange:f}}(e,t,c,r,a,o,i):function(e,t,n,r,a,o,i){for(var c,s,_=[o,i],f=[r,a];;){var h=void 0;if(n<i){if(s=i,null===(h=(0,l.Xe)(t,0,s-1,o,u.Sl)))break;_[1]=h,c=l.mk.DISCARD}else{if(s=o,null===(h=(0,l.Xe)(t,0,s-1,0,u.Sl)))break;_[0]=h,c=l.mk.EXTEND}if(P(e,n,f,_,o,i,c))break;o=_[0],i=n}return{xRange:_,yRange:f}}(e,t,c,r,a,o,i);var _=s.xRange,f=s.yRange;return{xRange:_,yRange:f}}(e,t,r,i,c,a,o,f),E=d.xRange,v=d.yRange;return{xRange:E,yRange:v,activation:{row:_,col:f}}}(e,t,n,o):function(e,t,n,r){var a,o,i,c,s=n.selectQueue[n.currentSelectIndex],_=n.activeRow,f=n.activeCol;if(s instanceof y.Z||s instanceof T.Z)return null;if(!(s instanceof N.Z||s instanceof I.Z))throw new Error("不可用的选区类型");if(i=s.yRange[0],c=s.yRange[1],s instanceof N.Z?(a=0,o=t.getColCount()-1):(a=s.xRange[0],o=s.xRange[1]),s instanceof N.Z){var h=function(e,t,n,r,a){var o;if(t>0){var i=function(e,t,n,r){var a,o,i=[t,n];if(r>t){if(a=t,null===(o=(0,l.BS)(e,a+1,0,n,u.So)))return null;i[0]=o}else{if(a=n,null===(o=(0,l.BS)(e,a+1,0,e.getRowCount()-1,u.So)))return null;i[1]=o}return i}(e,n,r,a);if(!i)return;o=i}else{var c=function(e,t,n,r){var a,o,i=[t,n];if(r<n){if(a=n,null===(o=(0,l.lP)(e,a-1,0,t,u.So)))return null;i[1]=o}else{if(a=t,null===(o=(0,l.lP)(e,a-1,0,0,u.So)))return null;i[0]=o}return i}(e,n,r,a);if(!c)return;o=c}return o}(t,r,i,c,_);return h?{yRange:h,activation:{row:_,col:f}}:null}var d=function(e,t,n,r,a,o,i,c){var s;s=n>0?function(e,t,n,r,a,o,i){for(var c,s,_=[o,i],f=[r,a];;){var h=void 0;if(n>r){if(s=r,null===(h=(0,l.BS)(t,s+1,0,a,u.So)))break;f[0]=h,c=l.mk.DISCARD}else{if(s=a,null===(h=(0,l.BS)(t,s+1,0,t.getRowCount()-1,u.So)))break;f[1]=h,c=l.mk.EXTEND}if(L(e,n,f,_,r,a,c))break;r=n,a=f[1]}return{xRange:_,yRange:f}}(e,t,c,r,a,o,i):function(e,t,n,r,a,o,i){for(var c,s,_=[o,i],f=[r,a];;){var h=void 0;if(n<a){if(s=a,null===(h=(0,l.lP)(t,s-1,0,r,u.So)))break;f[1]=h,c=l.mk.DISCARD}else{if(s=r,null===(h=(0,l.lP)(t,s-1,0,0,u.So)))break;f[0]=h,c=l.mk.EXTEND}if(L(e,n,f,_,r,a,c))break;r=f[0],a=n}return{xRange:_,yRange:f}}(e,t,c,r,a,o,i);var _=s.xRange,f=s.yRange;return{xRange:_,yRange:f}}(e,t,r,i,c,a,o,_),E=d.xRange,v=d.yRange;return{xRange:E,yRange:v,activation:{row:_,col:f}}}(e,t,n,o)}function P(e,t,n,r,a,o,i){if((0,l.nM)(e,n,r,i))if(t<r[0])r[0]=t;else if(t>r[1])r[1]=t;else if(r[0]!==a||r[1]!==o)return!0;return!1}function L(e,t,n,r,a,o,i){if((0,l.nM)(e,n,r,i))if(t<n[0])n[0]=t;else if(t>n[1])n[1]=t;else if(n[0]!==a||n[1]!==o)return!0;return!1}function O(e,t,n,r,a){h(n);var o,i,c,l=n.selectQueue[n.currentSelectIndex],s=n.activeRow,u=n.activeCol;if(l instanceof y.Z)o=x(e,t,r,a,0,t.getRowCount()-1,0,t.getColCount()-1,s,u);else if(l instanceof N.Z)o=x(e,t,r,a,l.yRange[0],l.yRange[1],0,t.getColCount()-1,s,u),c=[l.yRange[0],l.yRange[1]];else if(l instanceof T.Z)o=x(e,t,r,a,0,t.getRowCount()-1,l.xRange[0],l.xRange[1],s,u),i=[l.xRange[0],l.xRange[1]];else{if(!(l instanceof I.Z))throw new Error("不可用的选区类型");o=x(e,t,r,a,l.yRange[0],l.yRange[1],l.xRange[0],l.xRange[1],s,u),c=[l.yRange[0],l.yRange[1]],i=[l.xRange[0],l.xRange[1]]}return{activation:o,xRange:i,yRange:c}}function x(e,t,n,a,o,i,c,s,_,f){return n===r.X?function(e,t,n,r,a,o,i,c,s){var _=function(e,n,r){return(0,u.eN)(e,n,r)&&(0,u.hZ)(t,n,r)},f=c,h=s;if(n>0)for(h+=1;;){var d=(0,l.Q8)(e,f,h,i,_);if(null!==d){h=d;break}h=o,(f+=1)>a&&(f=r)}else for(h-=1;;){var E=(0,l.Xe)(e,f,h,o,_);if(null!==E){h=E;break}h=i,(f-=1)<r&&(f=a)}return{row:f,col:h}}(e,t,a,o,i,c,s,_,f):function(e,t,n,r,a,o,i,c,s){var _=function(e,n,r){return(0,u.eN)(e,n,r)&&(0,u.hZ)(t,n,r)},f=c,h=s;if(n>0)for(f+=1;;){var d=(0,l.BS)(e,f,h,a,_);if(null!==d){f=d;break}f=r,(h+=1)>i&&(h=o)}else for(f-=1;;){var E=(0,l.lP)(e,f,h,r,_);if(null!==E){f=E;break}f=a,(h-=1)<o&&(h=i)}return{row:f,col:h}}(e,t,a,o,i,c,s,_,f)}function M(e,t,n,a,o){return h(n),a===r.X?function(e,t,n,r){var a,o,i,c,l,s=n.selectQueue[n.currentSelectIndex],u=n.activeRow,_=n.activeCol;if(s instanceof y.Z||s instanceof N.Z)return null;if(!(s instanceof T.Z||s instanceof I.Z))throw new Error("不可用的选区类型");a=s.xRange[0],o=s.xRange[1],s instanceof T.Z?(i=0,c=t.getRowCount()-1):(i=s.yRange[0],c=s.yRange[1]),l=o>_?o:a;var f=E(e,t,n.activeRow,l,r);if(null===f)return null;var h=[Math.min(_,f),Math.max(_,f)];return s instanceof T.Z?{xRange:h,activation:{row:u,col:_}}:{xRange:h,yRange:[i,c],activation:{row:u,col:_}}}(e,t,n,o):function(e,t,n,r){var a,o,i,c,l=n.selectQueue[n.currentSelectIndex],s=n.activeRow,u=n.activeCol;if(l instanceof y.Z||l instanceof T.Z)return null;if(!(l instanceof N.Z||l instanceof I.Z))throw new Error("不可用的选区类型");i=l.yRange[0],c=l.yRange[1],l instanceof N.Z?(a=0,o=t.getColCount()-1):(a=l.xRange[0],o=l.xRange[1]);var _=d(e,t,c>s?c:i,n.activeCol,r);if(null===_)return null;var f=[Math.min(s,_),Math.max(s,_)];return l instanceof N.Z?{yRange:f,activation:{row:s,col:u}}:{xRange:[a,o],yRange:f,activation:{row:s,col:u}}}(e,t,n,o)}var V=n(31973),k=n(14831),Z=n.n(k);function U(e,t,n,a,o){return h(n),a===r.X?function(e,t,n,r){var a=E(e,t,n.activeRow,n.activeCol,r);if(null===a)return null;var o=n.activeRow;return{yRange:[o,o],xRange:[a,a],activation:{col:a,row:o}}}(e,t,n,o):function(e,t,n,r){var a=d(e,t,n.activeRow,n.activeCol,r);if(null===a)return null;var o=n.activeCol;return{xRange:[o,o],yRange:[a,a],activation:{row:a,col:o}}}(e,t,n,o)}var B=n(10272),G=n(89577),F=n(80737),Y=function(e){return e>=0?e:void 0},K=function(){function e(e){var t=this;this._right=function(){var e;if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var n=A(t._tableView,t._rowcolAccessor,t._selectData,r.X,1);if(t._startSelect(t._selectData,n),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");return t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol}),null===(e=t._spreadsheet.parent.view.canvas.inputManager)||void 0===e||e.switchFocusDomNode(),!1}},this._left=function(){var e;if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var n=A(t._tableView,t._rowcolAccessor,t._selectData,r.X,-1);if(t._startSelect(t._selectData,n),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");return t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol}),null===(e=t._spreadsheet.parent.view.canvas.inputManager)||void 0===e||e.switchFocusDomNode(),!1}},this._down=function(){var e;if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var n=A(t._tableView,t._rowcolAccessor,t._selectData,r.Y,1);if(t._startSelect(t._selectData,n),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");return t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol}),null===(e=t._spreadsheet.parent.view.canvas.inputManager)||void 0===e||e.switchFocusDomNode(),!1}},this._up=function(){var e;if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var n=A(t._tableView,t._rowcolAccessor,t._selectData,r.Y,-1);if(t._startSelect(t._selectData,n),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");return t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol}),null===(e=t._spreadsheet.parent.view.canvas.inputManager)||void 0===e||e.switchFocusDomNode(),!1}},this._shiftRight=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=b(t._tableView,t._rowcolAccessor,t._selectData,r.X,1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.xRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({col:t._selectData.select.xRange[1]})}}},this._shiftLeft=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=b(t._tableView,t._rowcolAccessor,t._selectData,r.X,-1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.xRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({col:t._selectData.select.xRange[0]})}}},this._shiftDown=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=b(t._tableView,t._rowcolAccessor,t._selectData,r.Y,1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.yRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.select.yRange[1]})}}},this._shiftUp=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=b(t._tableView,t._rowcolAccessor,t._selectData,r.Y,-1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.yRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.select.yRange[0]})}}},this._enter=function(){if(t._normalSelectData.select){if((0,l.CK)(t._tableView,t._normalSelectData)){var e=A(t._tableView,t._rowcolAccessor,t._normalSelectData,r.Y,1);t._startSelect(t._normalSelectData,e)}else{var n=t._rowcolAccessor.isRowHidden(t._normalSelectData.activeRow),a=t._rowcolAccessor.isColHidden(t._normalSelectData.activeCol);if(n||a)return;var o=O(t._tableView,t._rowcolAccessor,t._normalSelectData,r.Y,1);t._updateSelect(t._normalSelectData,o)}if(t._normalSelectData.activeRow<0||t._normalSelectData.activeCol<0)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._normalSelectData.activeRow,col:t._normalSelectData.activeCol})}},this._shiftEnter=function(){if(t._normalSelectData.select){if((0,l.CK)(t._tableView,t._normalSelectData)){var e=A(t._tableView,t._rowcolAccessor,t._normalSelectData,r.Y,-1);t._startSelect(t._normalSelectData,e)}else{var n=O(t._tableView,t._rowcolAccessor,t._normalSelectData,r.Y,-1);t._updateSelect(t._normalSelectData,n)}if(t._normalSelectData.activeRow<0||t._normalSelectData.activeCol<0)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._normalSelectData.activeRow,col:t._normalSelectData.activeCol})}},this._tab=function(){if(t._selectData.select&&t._selectData.select){if((0,l.CK)(t._tableView,t._selectData)){var e=A(t._tableView,t._rowcolAccessor,t._selectData,r.X,1);t._startSelect(t._selectData,e)}else{var n=O(t._tableView,t._rowcolAccessor,t._selectData,r.X,1);t._updateSelect(t._selectData,n)}if(t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");return t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol}),!1}},this._shiftTab=function(){if(t._selectData.select&&t._selectData.select){if((0,l.CK)(t._tableView,t._selectData)){var e=A(t._tableView,t._rowcolAccessor,t._selectData,r.X,-1);t._startSelect(t._selectData,e)}else{var n=O(t._tableView,t._rowcolAccessor,t._selectData,r.X,-1);t._updateSelect(t._selectData,n)}if(t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");return t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol}),!1}},this._shortRight=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=U(t._tableView,t._rowcolAccessor,t._selectData,r.X,1);if(e){if(t._startSelect(t._selectData,e),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol})}}},this._shortLeft=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=U(t._tableView,t._rowcolAccessor,t._selectData,r.X,-1);if(e){if(t._startSelect(t._selectData,e),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol})}}},this._shortDown=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=U(t._tableView,t._rowcolAccessor,t._selectData,r.Y,1);if(e){if(t._startSelect(t._selectData,e),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol})}}},this._shortUp=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=U(t._tableView,t._rowcolAccessor,t._selectData,r.Y,-1);if(e){if(t._startSelect(t._selectData,e),t._selectData.activeRow<0||t._selectData.activeCol<0)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.activeRow,col:t._selectData.activeCol})}}},this._shortShiftRight=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=M(t._tableView,t._rowcolAccessor,t._selectData,r.X,1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.xRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({col:t._selectData.select.xRange[1]})}}},this._shortShiftLeft=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=M(t._tableView,t._rowcolAccessor,t._selectData,r.X,-1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.xRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({col:t._selectData.select.xRange[0]})}}},this._shortShiftDown=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=M(t._tableView,t._rowcolAccessor,t._selectData,r.Y,1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.yRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.select.yRange[1]})}}},this._shortShiftUp=function(){if(t._selectData instanceof F.Z&&C(t._selectData,t._normalSelectData),t._selectData.select){var e=M(t._tableView,t._rowcolAccessor,t._selectData,r.Y,-1);if(e){if(t._updateSelect(t._selectData,e),!t._selectData.select.yRange)throw new Error("移动选区异常");t._scrollApi.scrollToVisible({row:t._selectData.select.yRange[0]})}}},this._disableSelectAll=function(){var e;return!t._selectData.select||(null===(e=t._selectData.select)||void 0===e?void 0:e.selectAll)},this._needSelectAll=function(e,n){return e.selectRow||e.selectCol||t._isRangeUnchanged(e,n)},this._isRangeUnchanged=function(e,t){return e.xRange.join(",")===t.xRange.join(",")&&e.yRange.join(",")===t.yRange.join(",")},this._computeSelectRange=function(e,n,r){var a;if(e.length>1)return{activation:{row:t._selectData.activeRow,col:t._selectData.activeCol}};var o=(0,B.Jz)(t._spreadsheet.activeSheet,r,!0),i=t._selectData.select;return a={xRange:[o.startColIndex,o.endColIndex],yRange:[o.startRowIndex,o.endRowIndex],activation:n},t._needSelectAll(i,a)&&(a={activation:{row:t._selectData.activeRow,col:t._selectData.activeCol}}),a},this._shortA=function(){var e,n,r,a,o,i,c,l;if(t._disableSelectAll())return!1;var s=t._selectData,u=s.activation,_=s.selectQueue,f=void 0===_?[]:_,h=null===(n=null===(e=f[0])||void 0===e?void 0:e.yRange)||void 0===n?void 0:n[0],d=null===(a=null===(r=f[0])||void 0===r?void 0:r.yRange)||void 0===a?void 0:a[1],E=null===(i=null===(o=f[0])||void 0===o?void 0:o.xRange)||void 0===i?void 0:i[0],v=null===(l=null===(c=f[0])||void 0===c?void 0:c.xRange)||void 0===l?void 0:l[1],R=new G.Z("",Y(h),Y(d),Y(E),Y(v)),w=t._computeSelectRange(f,u,R);return t._updateSelect(t._selectData,w),!1},this._shortHome=function(){if(t._selectData.select){var e=(0,l.BS)(t._rowcolAccessor,0,0,t._rowcolAccessor.getRowCount()-1,u.hZ),n=(0,l.Q8)(t._rowcolAccessor,0,0,t._rowcolAccessor.getColCount()-1,u.hZ);if(null!==e&&null!==n){var r={xRange:[n,n],yRange:[e,e],activation:{row:e,col:n}};return t._updateSelect(t._selectData,r),t._scrollApi.scrollToVisible({row:e,col:n}),V.ZP.tdwReport({module:"excel_shortcuts",opername:"doc_excel_editor",action:Z().isMac||Z().isIPad?"select_shortcuts_Control+Fn+Left":"select_shortcuts_Ctrl+Home"}),!1}}},this._shortEnd=function(){if(t._selectData.select){var e=(0,l.lP)(t._rowcolAccessor,t._rowcolAccessor.getRowCount()-1,t._rowcolAccessor.getColCount()-1,0,u.hZ),n=(0,l.Xe)(t._rowcolAccessor,t._rowcolAccessor.getRowCount()-1,t._rowcolAccessor.getColCount()-1,0,u.hZ);if(null!==e&&null!==n){var r={xRange:[n,n],yRange:[e,e],activation:{row:e,col:n}};return t._updateSelect(t._selectData,r),t._scrollApi.scrollToVisible({row:e,col:n}),V.ZP.tdwReport({module:"excel_shortcuts",opername:"doc_excel_editor",action:Z().isMac||Z().isIPad?"select_shortcuts_Control+;":"select_shortcuts_Ctrl+;"}),!1}}},this._end=function(){if(t._selectData.select){var e=t._selectData.activeRow,n=t._rowcolAccessor.getColCount()-1,r=(0,l.Xe)(t._rowcolAccessor,e,n,0,u.hZ);if(null!==e&&null!==r){var a={xRange:[r,r],yRange:[e,e],activation:{row:e,col:r}};return t._startSelect(t._selectData,a),t._scrollApi.scrollToVisible({row:e,col:r}),!1}}},this._home=function(){if(t._selectData.select){var e=t._selectData.activeRow,n=(0,l.Q8)(t._rowcolAccessor,e,0,t._rowcolAccessor.getColCount()-1,u.hZ);if(null!==e&&null!==n){var r={xRange:[n,n],yRange:[e,e],activation:{row:e,col:n}};return t._startSelect(t._selectData,r),t._scrollApi.scrollToVisible({row:e,col:n}),!1}}},this._selectRow=function(){var e;if(t._selectData.select&&!(null===(e=t._selectData.select)||void 0===e?void 0:e.selectAll)){var n=t._selectData,r=n.activation,a=n.selectQueue,o=void 0===a?[]:a,i=o[o.length-1].yRange,c={yRange:i?[i[0],i[1]]:void 0,activation:r};return t._updateSelect(t._selectData,c),!1}},this._selectCol=function(){var e;if(t._selectData.select&&!(null===(e=t._selectData.select)||void 0===e?void 0:e.selectAll)){var n=t._selectData,r=n.activation,a=n.selectQueue,o=void 0===a?[]:a,i=o[o.length-1].xRange,c={xRange:i?[i[0],i[1]]:void 0,activation:r};return t._updateSelect(t._selectData,c),!1}},this._tableView=e.tableView,this._rowcolAccessor=e.rowcolAccessor,this._selectData=e.selectData,this._normalSelectData=e.normalSelectData,this._scrollApi=e.scrollApi,this._keyboardMount=e.keyboardMount,this._startSelect=e.startSelect,this._updateSelect=e.updateSelect,this._spreadsheet=e.spreadsheet,this._bindings=[{key:c.ZP.KEYS.RIGHT,handler:this._right},{key:c.ZP.KEYS.LEFT,handler:this._left},{key:c.ZP.KEYS.DOWN,handler:this._down},{key:c.ZP.KEYS.UP,handler:this._up},{key:c.ZP.KEYS.RIGHT,shiftKey:!0,handler:this._shiftRight},{key:c.ZP.KEYS.LEFT,shiftKey:!0,handler:this._shiftLeft},{key:c.ZP.KEYS.UP,shiftKey:!0,handler:this._shiftUp},{key:c.ZP.KEYS.DOWN,shiftKey:!0,handler:this._shiftDown},{key:c.ZP.KEYS.RIGHT,shortKey:!0,handler:this._shortRight},{key:c.ZP.KEYS.LEFT,shortKey:!0,handler:this._shortLeft},{key:c.ZP.KEYS.DOWN,shortKey:!0,handler:this._shortDown},{key:c.ZP.KEYS.UP,shortKey:!0,handler:this._shortUp},{key:c.ZP.KEYS.ENTER,handler:this._enter},{key:c.ZP.KEYS.ENTER,shiftKey:!0,handler:this._shiftEnter},{key:c.ZP.KEYS.TAB,handler:this._tab},{key:c.ZP.KEYS.TAB,shiftKey:!0,handler:this._shiftTab},{key:c.ZP.KEYS.RIGHT,shortKey:!0,shiftKey:!0,handler:this._shortShiftRight},{key:c.ZP.KEYS.LEFT,shortKey:!0,shiftKey:!0,handler:this._shortShiftLeft},{key:c.ZP.KEYS.DOWN,shortKey:!0,shiftKey:!0,handler:this._shortShiftDown},{key:c.ZP.KEYS.UP,shortKey:!0,shiftKey:!0,handler:this._shortShiftUp},{key:"a",shortKey:!0,handler:this._shortA},{key:c.ZP.KEYS.HOME,shortKey:!0,handler:this._shortHome},{key:c.ZP.KEYS.END,shortKey:!0,handler:this._shortEnd},{key:c.ZP.KEYS.HOME,handler:this._home},{key:c.ZP.KEYS.END,handler:this._end},{key:c.ZP.KEYS.SPACE,shiftKey:!0,ctrlKey:!Z().isMac,handler:this._selectRow},{key:c.ZP.KEYS.SPACE,altKey:!0,ctrlKey:!Z().isMac,handler:this._selectCol},{key:c.ZP.KEYS.SPACE_SAFARI,altKey:!0,handler:this._selectCol}],this._keymaster=new c.ZP({root:this._keyboardMount,bindings:this._bindings,shouldDisable:this._spreadsheet.isExternalSheet})}var t=e.prototype;return t.triggerKeyDownEvent=function(e){this._bindings.forEach((function(t){e.key===t.key&&e.shortKey===t.shortKey&&e.shiftKey===t.shiftKey&&e.altKey===t.altKey&&t.handler()}))},t.changeSelectData=function(e){this._selectData=e},e}(),H=function(e){this._selectData=e.selectData,this._normalSelectData=e.normalSelectData,this._formulaSelectData=e.formulaSelectData,this._spreadsheet=e.spreadsheet};H.EVENT={READY_SELECT:"readySelect",START_SELECT:"startSelect",UPDATE_SELECT:"updateSelect",END_SELECT:"endSelect"};var j=H,W=function(){function e(e){var t=this;this._handleTap=function(e){if(t._checkDownValid()){var n,r=t._operateData.currRow,a=t._operateData.currCol;n=-1===r&&-1===a?{activation:{row:0,col:0}}:-1===a?{yRange:[r,r],activation:{row:r,col:0}}:-1===r?{xRange:[a,a],activation:{row:0,col:a}}:{yRange:[r,r],xRange:[a,a],activation:{row:r,col:a}},e.e.preventDefault(),t._startSelect(t._selectData,n)}},this._touchOperate=e.touchOperate,this._operateData=e.operateData,this._selectData=e.selectData,this._startSelect=e.startSelect,this._touchOperate.onTap(this._handleTap)}var t=e.prototype;return t.changeSelectData=function(e){this._selectData=e},t._checkDownValid=function(){if(null===this._selectData)throw new Error("must bind selectData in SelectCells module");return!this._operateData.stopPropagation&&!this._operateData.isOverTable()},e}(),X=function(e){function t(n){var r;return(r=e.call(this,n)||this)._readySelect=function(e){r.emitter.emit(t.EVENT.READY_SELECT,e)},r._startSelect=function(e,n,a){void 0===a&&(a=!1),r.emitter.emit(t.EVENT.START_SELECT,e,n,a)},r._updateSelect=function(e,n){r.emitter.emit(t.EVENT.UPDATE_SELECT,e,n)},r._endSelect=function(e){r.emitter.emit(t.EVENT.END_SELECT,e)},r.emitter=new i.Z,r._tableView=n.tableView,r._rowcolAccessor=n.rowcolAccessor,r._areaData=n.areaData,r._touchOperate=n.touchOperate,r._mouseOperate=n.mouseOperate,r._operateData=n.operateData,r._scrollApi=n.scrollApi,r._keyboardMount=n.keyboardMount,r._tapSelect=new W({touchOperate:r._touchOperate,operateData:r._operateData,selectData:r._selectData,startSelect:r._startSelect}),r._mouseSelect=new s({mouseOperate:r._mouseOperate,operateData:r._operateData,selectData:r._selectData,areaData:r._areaData,rowcolAccessor:r._rowcolAccessor,readySelect:r._readySelect,startSelect:r._startSelect,updateSelect:r._updateSelect,endSelect:r._endSelect}),r._keyboardSelect=new K({tableView:r._tableView,rowcolAccessor:r._rowcolAccessor,selectData:r._selectData,normalSelectData:r._normalSelectData,startSelect:r._startSelect,updateSelect:r._updateSelect,scrollApi:r._scrollApi,keyboardMount:window.document.querySelector("#mainContainer"),spreadsheet:r._spreadsheet}),r}return(0,o.Z)(t,e),t.prototype.bindSelectData=function(e){this._selectData=e,this._tapSelect.changeSelectData(this._selectData),this._mouseSelect.changeSelectData(this._selectData),this._keyboardSelect.changeSelectData(this._selectData)},(0,a.Z)(t,[{key:"EVENT",get:function(){return t.EVENT}},{key:"selectData",get:function(){return this._selectData}}]),t}(j);X.EVENT=Object.assign({},j.EVENT);var Q=X,z=n(39677),q=function(e,t){var n=this;this._handleStartSelect=function(e,t,r){void 0===r&&(r=!1),r?n._multipleMode=!0:(n._multipleMode&&e===n._normalSelectData&&e.resetSelection(),n._multipleMode=!1);var a=e.currentSelectIndex;n._multipleMode||e.getIsInsertion()||0===e.selectQueue.length?e.addSelection(t,null):e.updateSelection(a,t,null),e===n._normalSelectData?n._normalSelectionStage.show():e===n._formulaSelectData&&(n._operateData.preventAutoTapFocus=!0,n._formulaSelectionStage.show())},this._handleUpdateSelect=function(e,t){var n=e.currentSelectIndex;e.updateSelection(n,t,null)},this._selectCells=e,this._normalSelectData=t.normalSelectData,this._formulaSelectData=t.formulaSelectData,this._normalSelectionStage=t.normalSelectionStage,this._formulaSelectionStage=t.formulaSelectionStage,this._autoScroll=t.autoScroll,this._clientRect=t.clientRect,this._areaData=t.areaData,this._mutexManagement=t.mutexManagement,this._operateData=t.operateData,this._selectCells.emitter.on(this._selectCells.EVENT.START_SELECT,this._handleStartSelect),this._selectCells.emitter.on(this._selectCells.EVENT.UPDATE_SELECT,this._handleUpdateSelect),this._selectCells.emitter.on(this._selectCells.EVENT.READY_SELECT,(function(e){var t=e.select;null!==t&&(t.selectCol?n._autoScroll.ready(z.OD.X,n._clientRect.width-z.gn):t.selectRow?n._autoScroll.ready(z.OD.Y,void 0,n._clientRect.height-n._areaData.row.flow.displayPadding-z.Iq):t.selectCell&&n._autoScroll.ready(z.OD.ALL,n._clientRect.width-z.gn,n._clientRect.height-n._areaData.row.flow.displayPadding-z.Iq))}))},J=function(){function e(e){this._selectCells=new Q(e),this._feature=new q(this._selectCells,e)}return(0,a.Z)(e,[{key:"selectOperate",get:function(){return this._selectCells}}]),e}()},66105:function(e,t,n){function r(){"use strict";r=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(T){l=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=t&&t.prototype instanceof f?t:f,o=Object.create(a.prototype),i=new C(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var c=p(i,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===_)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,i),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(T){return{type:"throw",arg:T}}}e.wrap=s;var _={};function f(){}function h(){}function d(){}var E={};l(E,o,(function(){return this}));var v=Object.getPrototypeOf,R=v&&v(v(A([])));R&&R!==t&&n.call(R,o)&&(E=R);var w=d.prototype=f.prototype=Object.create(E);function g(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function D(e,t){function r(a,o,i,c){var l=u(e[a],e,o);if("throw"!==l.type){var s=l.arg,_=s.value;return _&&"object"==typeof _&&n.call(_,"__await")?t.resolve(_.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(_).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,c)}))}c(l.arg)}var a;this._invoke=function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}}function p(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,p(e,t),"throw"===t.method))return _;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,_;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,_):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_)}function m(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(m,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:y}}function y(){return{value:void 0,done:!0}}return h.prototype=d,l(w,"constructor",d),l(d,"constructor",h),h.displayName=l(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},g(D.prototype),l(D.prototype,i,(function(){return this})),e.AsyncIterator=D,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new D(s(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},g(w),l(w,c,"Generator"),l(w,o,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),_}},e}n.d(t,{Gp:function(){return c},ki:function(){return o},rw:function(){return i}}),n(38934),n(48845),n(77468),n(52865),n(64425),n(47794),n(45948),n(19553),n(64454),n(91768),n(14422),n(74053),n(23976),n(78541),n(42056),n(84348),n(31771),n(74041),n(29553),n(79927),n(93134),n(54900),n(37732),n(16795),n(2657),n(93069),n(2951),n(98457),n(40480),n(10839),n(20726),n(10913),n(13857),n(54371),n(95019),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var a=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{l(r.next(e))}catch(t){o(t)}}function c(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((r=r.apply(e,t||[])).next())}))};function o(){return"attachment-"+Date.now()+"-"+function(e){var t,n="";for(e=void 0!==e?e:4,t=0;t<e;t++)n+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return n}()}var i=function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),a=new Uint8Array(r),o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return new Blob([r],{type:n})},c=function(e){return a(void 0,void 0,void 0,r().mark((function t(){var n,a,o,c,l,s,u,_;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Image,t.prev=1,t.next=4,new Promise((function(t,n){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=function(){return n(r.error)},r.readAsDataURL(e)}));case 4:return a=t.sent,t.next=7,new Promise((function(e,t){n.style.imageOrientation="from-image",n.onload=e,n.onerror=t,n.src=a}));case 7:t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(1),console.warn("autoRotateAndShrink image load error",t.t0),t.abrupt("return",{file:e});case 13:if(o=n.naturalWidth,c=n.naturalHeight,o&&c){t.next=17;break}return t.abrupt("return",{file:e});case 17:if("image/gif"!==e.type){t.next=19;break}return t.abrupt("return",{file:e,width:o,height:c});case 19:return u=(l=c>3*o)?c:4096,o>(s=l?1024:4096)&&(c=Math.max(1,Math.round(c/o*s)),o=s),c>u&&(o=Math.max(1,Math.round(o/c*u)),c=u),(_=document.createElement("canvas")).width=o,_.height=c,_.getContext("2d").drawImage(n,0,0,o,c),e=i(_.toDataURL(e.type,.8)),t.abrupt("return",{file:e,width:o,height:c});case 31:case"end":return t.stop()}}),t,null,[[1,9]])})))}},1195:function(e,t,n){var r;function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{r:function(){return r}}),n(38934),n(31688),n(77468),n(26894),n(71091),n(15770),n(84919),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144),function(e){e.DressUp="dress-up",e.Container="user-custom-theme-container",e.ContainerBox="user-custom-theme-container-box",e.ContainerBoxItem="user-custom-theme-container-box-item",e.BackdropFilter="dress-up-backdrop-filter"}(r||(r={}));var i=function(){function e(e){this.getMultiPictureModeIntervalByIndex=e}var t=e.prototype;return t.findActiveBackground=function(e){for(var t=-1,n=this.getBackgroundLiDoms(),r=0;r<n.length;r++)if(n[r].id===e){t=r;break}return t},t.createDressUpContainer=function(e,t,n){void 0===n&&(n=[]);var a=this.getUserCustomThemeContainerDom();if(a)return a;(a=document.createElement("div")).className=r.Container;var o=document.createElement("ul");o.className=r.ContainerBox;var i="dress-up-"+e;if(t){var c=document.createElement("li");c.id=i,c.className=r.ContainerBoxItem;var l=document.createElement("ul");null===n||void 0===n||n.forEach((function(e){var t,n=document.createElement("li"),r=document.createElement("img");r.src=null===(t=e)||void 0===t?void 0:t.image_url,n.appendChild(r),l.appendChild(n)})),c.appendChild(l),o.appendChild(c)}else null===n||void 0===n||n.forEach((function(e){var t=document.createElement("li"),n=document.createElement("img");t.id=i,t.className=r.ContainerBoxItem,n.src="string"===typeof e?e:e.image_url,t.appendChild(n),o.appendChild(t)}));a.appendChild(o),document.body.appendChild(a)},t.dynamicUpdateForSingleMode=function(e,t){this.clearInterval();var n="dress-up-"+e,a=this.findActiveBackground(n);if(-1!==a)this.changeImgToVisible(a,this.getBackgroundLiDoms());else{var o=document.createElement("li"),i=document.createElement("img");o.id=n,o.className=r.ContainerBoxItem,i.src=t,o.appendChild(i);var c=document.querySelector("."+r.ContainerBox);null===c||void 0===c||c.appendChild(o);var l=this.getBackgroundLiDoms();this.changeImgToVisible(l.length-1,l)}},t.dynamicUpdateForMultiPicMode=function(e,t){this.clearInterval();var n="dress-up-"+e;if(-1===this.findActiveBackground(n)){var a=document.createElement("li");a.id=n,a.className=r.ContainerBoxItem;var o=document.createElement("ul");null===t||void 0===t||t.forEach((function(e){var t,n=document.createElement("li"),r=document.createElement("img");r.src=null===(t=e)||void 0===t?void 0:t.image_url,n.appendChild(r),o.appendChild(n)})),a.appendChild(o);var i=document.querySelector("."+r.ContainerBox);null===i||void 0===i||i.appendChild(a)}this.startMultiPictureMode(e)},t.startMultiPictureMode=function(e){var t=this.getBackgroundLiDoms();this.changeImgToVisible(t.length-1,t),this.loopSwitchTheme(e)},t.getUserCustomThemeContainerDom=function(){return document.querySelector("."+r.Container)},t.clearInterval=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){this.timer&&clearInterval(this.timer)})),t.getBackgroundLiDoms=function(){var e;return Array.from(null!==(e=document.querySelectorAll("."+r.ContainerBox+" ."+r.ContainerBoxItem))&&void 0!==e?e:[])},t.changeImgToVisible=function(e,t){for(var n,r=a(t);!(n=r()).done;)n.value.style.opacity="0";t[e].style.opacity="1"},t.loopSwitchTheme=function(e){var t,n=this,a=Array.from(null!==(t=document.querySelectorAll("."+r.ContainerBox+" #dress-up-"+e+" li"))&&void 0!==t?t:[]),o=a.length,i=0,c=this.getMultiPictureModeIntervalByIndex(0);c&&(this.changeImgToVisible(this.findActiveBackground("dress-up-"+e),this.getBackgroundLiDoms()),n.changeImgToVisible(i,a),i+=1,n.timer=setInterval((function(){n.changeImgToVisible(i,a),i+=1,c=n.getMultiPictureModeIntervalByIndex(i),i===o&&(i=0,c=n.getMultiPictureModeIntervalByIndex(0))}),60*c*60*1e3))},e}();t.Z=i},80725:function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05Ljc4NjY3IDcuODRDOS44OTMzMyA3LjkyIDkuODkzMzMgOC4wOCA5Ljc4NjY3IDguMTZMNi4zMiAxMC43NkM2LjE4ODE1IDEwLjg1ODkgNiAxMC43NjQ4IDYgMTAuNkw2IDUuNEM2IDUuMjM1MTkgNi4xODgxNSA1LjE0MTExIDYuMzIgNS4yNEw5Ljc4NjY3IDcuODRaIiBmaWxsPSIjODE4NjhGIi8+Cjwvc3ZnPgo="},59985:function(e){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03Ljg0IDkuNzg2NjdDNy45MiA5Ljg5MzMzIDguMDggOS44OTMzMyA4LjE2IDkuNzg2NjdMMTAuNzYgNi4zMkMxMC44NTg5IDYuMTg4MTUgMTAuNzY0OCA2IDEwLjYgNkg1LjRDNS4yMzUxOSA2IDUuMTQxMTEgNi4xODgxNSA1LjI0IDYuMzJMNy44NCA5Ljc4NjY3WiIgZmlsbD0iIzgxODY4RiIvPgo8L3N2Zz4K"}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_core_part_4.d400bd84a6989ed6e3e6.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_core_part_4.d400bd84a6989ed6e3e6.js.map