self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[4335],{43367:function(e,t,n){"use strict";function r(e){var t=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),r="";return n.g.document&&(r=n.g.document.cookie.match(t)),r?decodeURIComponent(r[1]):""}function i(e,t,r,i,o){var s=new Date;s.setTime(s.getTime()+(r?36e5*r:2592e6)),n.g.document&&(document.cookie=e+"="+t+";expires="+s.toGMTString()+";path="+(o||"/")+";"+(i?"domain="+i+";":""))}function o(e,t,r){var i=new Date(0);n.g.document&&(document.cookie=e+"=;expires="+i.toUTCString()+";path="+(r||"/")+";"+(t?"domain="+t+";":""))}n.d(t,{A0:function(){return o},d8:function(){return i},ej:function(){return r}}),n(53923),n(52865),n(77468),n(85932)},30628:function(e,t,n){"use strict";function r(e,t){if(!e)return"";var n=e.match(new RegExp("(\\?|&)"+t+"=([^&]*)(&|$)"));return n?decodeURIComponent(n[2].replace(/%/g,"%25")):""}function i(e){return e?"?"+(e.split("?")[1]||""):""}function o(e,t){var o,s,a=r(i(t||(null===(o=n.g.location)||void 0===o?void 0:o.href)),e);return a||(t||a?"":r(i(null===(s=null===n.g||void 0===n.g?void 0:n.g.clientVars)||void 0===s?void 0:s.originalUrl),e))}function s(e,t){var n=o(e,null!==t&&void 0!==t?t:location.href);if(""!==n){var r=Number(n);if(!isNaN(r))return r}}function a(e){void 0===e&&(e="");for(var t={},n=(e.split("?")[1]||"").split("&"),r=0,i=n.length;r<i;r++)if(n[r]){var o=n[r].split("=");if(o.length>1){var s=o[0],a=o[1];t[s]=decodeURIComponent(a)}}return t}function d(e,t){var n=e.split("?"),r=n[0],i=n[1],o=Array.isArray(t)?t:[t];if(n.length>=2){for(var s=i.split(/[&;]/g),a=0,d=o.length;a<d;a++)for(var h=encodeURIComponent(o[a])+"=",u=s.length-1;u>=0;u--)-1!==s[u].lastIndexOf(h,0)&&s.splice(u,1);return r+(s.length>0?"?"+s.join("&"):"")}return e}function h(e,t){var n=e;return Object.keys(t).forEach((function(e){var r=new RegExp("([?&#])"+e+"=?.*?(&|#|$)","i"),i=t[e],o=-1!==n.indexOf("?")?"&":"?";n=n.match(r)?n.replace(r,"$1"+e+"="+encodeURIComponent(i)+"$2"):n+o+e+"="+encodeURIComponent(i)})),n}n.d(t,{DC:function(){return s},IZ:function(){return o},XK:function(){return h},oW:function(){return d},ol:function(){return a}}),n(52865),n(85932),n(53923),n(77468),n(20670),n(64425),n(62883),n(41031),n(75793),n(38934),n(31688),n(71096)},32538:function(e,t,n){"use strict";function r(e){try{return(e||"").replace(/^(http:)|(https:)/g,"")}catch(t){console.error(t)}return e}n.d(t,{k:function(){return r}}),n(52865),n(20670)},79298:function(e,t,n){"use strict";function r(e,t,n){var r,i,o;void 0===n&&(n={});var s=null,a=0,d=function(){a=!1===(null===n||void 0===n?void 0:n.leading)?0:Number(new Date),s=null,o=e.apply(r,i)};return function(){var h=Number(new Date);a||!1!==(null===n||void 0===n?void 0:n.leading)||(a=h);var u=t-(h-a);r=this;for(var l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return i=c,u<=0?(clearTimeout(s),s=null,a=h,o=e.apply(r,i)):s||!1===(null===n||void 0===n?void 0:n.trailing)||(s=window.setTimeout(d,u)),o}}function i(e,t){var n=null;return function(){var r=this,i=arguments;n&&(clearTimeout(n),n=null),n=window.setTimeout((function(){e.apply(r,i)}),t)}}n.d(t,{Ds:function(){return i},nE:function(){return o.n},hj:function(){return s},Kn:function(){return d},HD:function(){return a},o8:function(){return h},P2:function(){return r}}),n(62883);var o=n(68599);function s(e){return"[object Number]"===Object.prototype.toString.call(e)&&!isNaN(e)}function a(e){return"[object String]"===Object.prototype.toString.call(e)}function d(e){return"[object Object]"===Object.prototype.toString.call(e)}function h(e){return"[object Undefined]"===Object.prototype.toString.call(e)}n(38934),n(32538)},68599:function(e,t,n){"use strict";function r(e,t,n){void 0===n&&(n="..");for(var r=e.length,i="",o=0,s=0;s<r;){var a=e.charCodeAt(s),d=e[s];if(i+=a>=55296&&a<=56319?d+e[s+=1]:d,s+=1,(o+=1)>=t)break}return s<r&&(i+=n),i}n.d(t,{n:function(){return r}})},80067:function(e,t,n){"use strict";n.d(t,{Ds:function(){return h.Ds},A0:function(){return r.A0},nE:function(){return h.nE},r:function(){return o},R5:function(){return a},ej:function(){return r.ej},DC:function(){return d.DC},IZ:function(){return d.IZ},ol:function(){return d.ol},hj:function(){return h.hj},Kn:function(){return h.Kn},gr:function(){return s},HD:function(){return h.HD},o8:function(){return h.o8},ve:function(){return i},oW:function(){return d.oW},d8:function(){return r.d8},P2:function(){return h.P2},XK:function(){return d.XK}});var r=n(43367),i=(n(38934),n(48845),function(e,t){return new Promise((function(n,r){var i=document.createElement("script");i.src=e,i.onload=function(){null===t||void 0===t||t(),n()},i.onerror=function(e){r(e)},document.head.appendChild(i)}))});function o(e){if("string"!==typeof e)return"";var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"};return e.replace(/[&<>'"]/g,(function(e){return t[e]}))}function s(){var e;if("number"===typeof n.g.orientation)return n.g.orientation/90%2===0;if("undefined"===typeof n.g.screen.orientation)return!0;try{var t=n.g.screen.orientation.angle;if("number"===typeof t)return t/90%2===0}catch(r){null===(e=n.g.log)||void 0===e||e.error(r)}return!0}function a(){var e,t;null===(t=null===(e=n.g.mqq)||void 0===e?void 0:e.ui)||void 0===t||t.setWebViewBehavior({orientation:0})}n(52865),n(20670),n(14831),n(52527);var d=n(30628),h=n(79298);n(55100)},55100:function(e,t,n){"use strict";function r(e,t){void 0===t&&(t="yyyy/MM/dd hh:mm:ss");var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},r=t;return/(y+)/.test(r)&&(r=r.replace(RegExp.$1,String(e.getFullYear()).substr(4-RegExp.$1.length))),Object.keys(n).forEach((function(e){new RegExp("("+e+")").test(r)&&(r=r.replace(RegExp.$1,1===RegExp.$1.length?n[e]:("00"+n[e]).substr(String(n[e]).length)))})),r}n.d(t,{W:function(){return r}}),n(52865),n(20670),n(53923),n(77468),n(38934),n(31688),n(71096)},52527:function(e,t,n){"use strict";var r=n(58926),i=(n(29816),n(62883),n(38934),n(31688),n(93984),n(41031),function(){function e(e,t){this.timer=e,this.done=!1,this.callback=function(){},this.frames=t/e.interval|0}var t=e.prototype;return t.setFrame=function(e){this.frames=e,0!==this.frames&&(this.frames=Number.isInteger(this.frames)?this.frames:1+(0|this.frames))},t.run=function(e){return this.callback=e,this.setFrame(this.frames+this.timer.currFrame),this.timer.push(this),this},t.stop=function(){this.timer.erase(this)},e}()),o=function(){function e(){this.zeroFrameDone=!1,this.times=0,this.started=!1,this.interval=500,this.t=null,this.cache={},this.currFrame=0,this.maxFrame=0}var t=e.prototype;return t.pause=function(){clearInterval(this.t)},t.restart=function(){this.started=!1,this.start()},t.clear=function(){this.cache={},this.started=!1,this.currFrame=0,this.maxFrame=0,clearInterval(this.t),this.t=null},t.execNextFrame=function(){if(this.currFrame>this.maxFrame)return this.clear();var e=this.cache[this.currFrame];if(e){e.forEach((function(e){var t;if(e){e.done=!0;try{null===e||void 0===e||e.callback()}catch(r){console.error(r),null===(t=n.g.log)||void 0===t||t.error(r.stack)}}e=null}));var t,i=e.filter((function(e){return!e.done}));i.length&&(this.cache[this.currFrame+1]||(this.cache[this.currFrame+1]=[]),(t=this.cache[this.currFrame+1]).push.apply(t,(0,r.Z)(i)),this.maxFrame+=1),delete this.cache[this.currFrame]}},t.push=function(e){this.cache[e.frames]||(this.cache[e.frames]=[]),this.cache[e.frames].push(e),this.maxFrame=Math.max(this.maxFrame,e.frames),this.start()},t.erase=function(e){if(e){var t=e.frames;if(void 0!==this.cache[t]){var n=this.cache[t].indexOf(e);n>-1&&this.cache[t].splice(n,1)}}},t.wait=function(e){return new i(this,e)},t.start=function(){var e=this;if(!this.started){if(this.started=!0,this.cache[0]&&!this.zeroFrameDone)return this.zeroFrameDone=!0,setTimeout((function(){try{e.execNextFrame()}catch(t){console.error(t)}}),0),this.started=!1;this.t=setInterval((function(){try{e.execNextFrame()}catch(t){console.error(t)}e.currFrame+=1}),this.interval)}},e}();t.Z=new o},90096:function(e,t,n){"use strict";n.d(t,{d9:function(){return o},kP:function(){return i},x8:function(){return r}});var r="alloy-rich-text-editor",i="alloy-mention-block",o={bold:!1,italic:!1,fontFamily:"Helvetica Neue, Helvetica, PingFang SC, Microsoft YaHei, Source Han Sans SC, Noto Sans CJK SC, WenQuanYi Micro Hei, sans-serif",fontSize:10,color:"rgba(0,0,0,1)",themeColor:"",strikethrough:!1,underline:!1}},66165:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=function(){function e(e,t){void 0===t&&(t=e),this.start=Math.min(e,t),this.end=Math.max(e,t)}var t=e.prototype;return t.getStart=function(){return this.start},t.getEnd=function(){return this.end},t.getLength=function(){return this.end-this.start},t.equals=function(e){return e.start===this.start&&e.end===this.end},t.isCollapsed=function(){return this.start===this.end},e}()},98585:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}}),n(71096),n(41031),n(93984),n(38934),n(31688),n(90109),n(15770),n(8195),n(75793);var r,i=n(40949),o=n.n(i),s=n(39033),a=n.n(s),d=n(36130),h=n.n(d);!function(e){e.compose=function(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),"object"!==typeof e&&(e={}),"object"!==typeof t&&(t={});var r=a()(t);for(var i in n||(r=Object.keys(r).reduce((function(e,t){return null!=r[t]&&(e[t]=r[t]),e}),{})),e)void 0!==e[i]&&void 0===t[i]&&(r[i]=e[i]);return Object.keys(r).length>0?r:void 0},e.diff=function(e,t){void 0===e&&(e={}),void 0===t&&(t={}),"object"!==typeof e&&(e={}),"object"!==typeof t&&(t={});var n=Object.keys(e).concat(Object.keys(t)).reduce((function(n,r){return h()(e[r],t[r])||(n[r]=void 0===t[r]?null:t[r]),n}),{});return Object.keys(n).length>0?n:void 0},e.invert=function(e,t){void 0===e&&(e={}),void 0===t&&(t={}),e=e||{};var n=Object.keys(t).reduce((function(n,r){return t[r]!==e[r]&&void 0!==e[r]&&(n[r]=t[r]),n}),{});return Object.keys(e).reduce((function(n,r){return e[r]!==t[r]&&void 0===t[r]&&(n[r]=null),n}),n)},e.transform=function(e,t,n){if(void 0===n&&(n=!1),"object"!==typeof e)return t;if("object"===typeof t){if(!n)return t;var r=Object.keys(t).reduce((function(n,r){return void 0===e[r]&&(n[r]=t[r]),n}),{});return Object.keys(r).length>0?r:void 0}}}(r||(r={}));var u=r,l=n(41871),c=function(){function e(e){this.ops=e,this.index=0,this.offset=0}var t=e.prototype;return t.hasNext=function(){return this.peekLength()<1/0},t.next=function(e){e||(e=1/0);var t=this.ops[this.index];if(t){var n=this.offset,r=l.Z.length(t);if(e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,"number"===typeof t.delete)return{delete:e};var i={};return t.attributes&&(i.attributes=t.attributes),"number"===typeof t.retain?i.retain=e:"string"===typeof t.insert?i.insert=t.insert.substr(n,e):i.insert=t.insert,i}return{retain:1/0}},t.peek=function(){return this.ops[this.index]},t.peekLength=function(){return this.ops[this.index]?l.Z.length(this.ops[this.index])-this.offset:1/0},t.peekType=function(){return this.ops[this.index]?"number"===typeof this.ops[this.index].delete?"delete":"number"===typeof this.ops[this.index].retain?"retain":"insert":"retain"},t.rest=function(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);var e=this.offset,t=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}return[]},e}(),f=String.fromCharCode(0),I=function(){function e(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]}var t=e.prototype;return t.insert=function(e,t){var n={};return"string"===typeof e&&0===e.length?this:(n.insert=e,null!=t&&"object"===typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n))},t.delete=function(e){return e<=0?this:this.push({delete:e})},t.retain=function(e,t){if(e<=0)return this;var n={retain:e};return null!=t&&"object"===typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n)},t.push=function(e){var t=this.ops.length,n=this.ops[t-1];if(e=a()(e),"object"===typeof n){if("number"===typeof e.delete&&"number"===typeof n.delete)return this.ops[t-1]={delete:n.delete+e.delete},this;if("number"===typeof n.delete&&null!=e.insert&&(t-=1,"object"!==typeof(n=this.ops[t-1])))return this.ops.unshift(e),this;if(h()(e.attributes,n.attributes)){if("string"===typeof e.insert&&"string"===typeof n.insert)return this.ops[t-1]={insert:n.insert+e.insert},"object"===typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this;if("number"===typeof e.retain&&"number"===typeof n.retain)return this.ops[t-1]={retain:n.retain+e.retain},"object"===typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this},t.chop=function(){var e=this.ops[this.ops.length-1];return(null===e||void 0===e?void 0:e.retain)&&!e.attributes&&this.ops.pop(),this},t.filter=function(e){return this.ops.filter(e)},t.forEach=function(e){this.ops.forEach(e)},t.map=function(e){return this.ops.map(e)},t.partition=function(e){var t=[],n=[];return this.forEach((function(r){(e(r)?t:n).push(r)})),[t,n]},t.reduce=function(e,t){return this.ops.reduce(e,t)},t.changeLength=function(){return this.reduce((function(e,t){return t.insert?e+l.Z.length(t):t.delete?e-t.delete:e}),0)},t.length=function(){return this.reduce((function(e,t){return e+l.Z.length(t)}),0)},t.slice=function(t,n){void 0===t&&(t=0),void 0===n&&(n=1/0);for(var r=[],i=new c(this.ops),o=0;o<n&&i.hasNext();){var s=void 0;o<t?s=i.next(t-o):(s=i.next(n-o),r.push(s)),o+=l.Z.length(s)}return new e(r)},t.compose=function(t){var n=new c(this.ops),r=new c(t.ops),i=[],o=r.peek();if(null!=o&&"number"===typeof o.retain&&null==o.attributes){for(var s=o.retain;"insert"===n.peekType()&&n.peekLength()<=s;)s-=n.peekLength(),i.push(n.next());o.retain-s>0&&r.next(o.retain-s)}for(var a=new e(i);n.hasNext()||r.hasNext();)if("insert"===r.peekType())a.push(r.next());else if("delete"===n.peekType())a.push(n.next());else{var d=Math.min(n.peekLength(),r.peekLength()),l=n.next(d),f=r.next(d);if("number"===typeof f.retain){var I={};"number"===typeof l.retain?I.retain=d:I.insert=l.insert;var g=u.compose(l.attributes,f.attributes,"number"===typeof l.retain);if(g&&(I.attributes=g),a.push(I),!r.hasNext()&&h()(a.ops[a.ops.length-1],I)){var p=new e(n.rest());return a.concat(p).chop()}}else"number"===typeof f.delete&&"number"===typeof l.retain&&a.push(f)}return a.chop()},t.concat=function(t){var n=new e(this.ops.slice());return t.ops.length>0&&(n.push(t.ops[0]),n.ops=n.ops.concat(t.ops.slice(1))),n},t.diff=function(t,n){if(this.ops===t.ops)return new e;var r=[this,t].map((function(e){return e.map((function(n){if(null!=n.insert)return"string"===typeof n.insert?n.insert:f;throw new Error("diff() called "+(e===t?"on":"with")+" non-document")})).join("")})),i=new e,s=o()(r[0],r[1],n),a=new c(this.ops),d=new c(t.ops);return s.forEach((function(e){for(var t=e[1].length;t>0;){var n=0;switch(e[0]){case o().INSERT:n=Math.min(d.peekLength(),t),i.push(d.next(n));break;case o().DELETE:n=Math.min(t,a.peekLength()),a.next(n),i.delete(n);break;case o().EQUAL:n=Math.min(a.peekLength(),d.peekLength(),t);var r=a.next(n),s=d.next(n);h()(r.insert,s.insert)?i.retain(n,u.diff(r.attributes,s.attributes)):i.push(s).delete(n)}t-=n}})),i.chop()},t.eachLine=function(t,n){void 0===n&&(n="\n");for(var r=new c(this.ops),i=new e,o=0;r.hasNext();){if("insert"!==r.peekType())return;var s=r.peek(),a=l.Z.length(s)-r.peekLength(),d="string"===typeof s.insert?s.insert.indexOf(n,a)-a:-1;if(d<0)i.push(r.next());else if(d>0)i.push(r.next(d));else{if(!1===t(i,r.next(1).attributes||{},o))return;o+=1,i=new e}}i.length()>0&&t(i,{},o)},t.invert=function(t){var n=new e;return this.reduce((function(e,r){if(r.insert)n.delete(l.Z.length(r));else{if(r.retain&&null==r.attributes)return n.retain(r.retain),e+r.retain;if(r.delete||r.retain&&r.attributes){var i=r.delete||r.retain;return t.slice(e,e+i).forEach((function(e){r.delete?n.push(e):r.retain&&r.attributes&&n.retain(l.Z.length(e),u.invert(r.attributes,e.attributes))})),e+i}}return e}),0),n.chop()},t.transform=function(t,n){if(void 0===n&&(n=!1),n=!!n,"number"===typeof t)return this.transformPosition(t,n);for(var r=t,i=new c(this.ops),o=new c(r.ops),s=new e;i.hasNext()||o.hasNext();)if("insert"!==i.peekType()||!n&&"insert"===o.peekType())if("insert"===o.peekType())s.push(o.next());else{var a=Math.min(i.peekLength(),o.peekLength()),d=i.next(a),h=o.next(a);if(d.delete)continue;h.delete?s.push(h):s.retain(a,u.transform(d.attributes,h.attributes,n))}else s.retain(l.Z.length(i.next()));return s.chop()},t.transformPosition=function(e,t){void 0===t&&(t=!1),t=!!t;for(var n=new c(this.ops),r=0;n.hasNext()&&r<=e;){var i=n.peekLength(),o=n.peekType();n.next(),"delete"!==o?("insert"===o&&(r<e||!t)&&(e+=i),r+=i):e-=Math.min(i,e-r)}return e},e}();I.Op=l.Z,I.OpIterator=c,I.AttributeMap=u;var g=I},41871:function(e,t){"use strict";var n;!function(e){e.length=function(e){return"number"===typeof e.delete?e.delete:"number"===typeof e.retain?e.retain:"string"===typeof e.insert?e.insert.length:1}}(n||(n={})),t.Z=n},68236:function(e,t,n){"use strict";n.d(t,{Z:function(){return B}}),n(38934),n(31688),n(79690),n(46396),n(91877),n(60113),n(75793),n(52865),n(64425);var r=n(58926),i=(n(90109),n(8195),n(26894),n(71091),n(23669)),o=n(66165);function s(e,t,n){var r,i,o,s,a;return(null===(r=e.ops[e.ops.length-1])||void 0===r?void 0:r.attributes)&&(null===(o=null===(i=e.ops[e.ops.length-1])||void 0===i?void 0:i.attributes)||void 0===o?void 0:o[t])?null===(a=null===(s=e.ops[e.ops.length-1])||void 0===s?void 0:s.attributes)||void 0===a?void 0:a[t]:n}function a(e,t){try{t.parentNode}catch(n){return!1}return function(e,t){for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}(e,t)}var d,h=n(60119),u=n(83139),l=n(36130),c=n.n(l),f=n(42433),I=function(){function e(e){this.editor=e.editor,this.input=e.input,this.deltaManager=e.deltaManager,this.vRoot=e.vRoot,this.emitter=e.emitter,this.cursor=new h.Z(h.Z.createDomNode()),this.lastRange=new o.Z(0,0),this.savedRange=this.lastRange,this.initEvents()}var t=e.prototype;return t.clear=function(){this.cursor.restore(),this.lastRange=new o.Z(0,0),this.savedRange=this.lastRange},t.hasFocus=function(){var e=document.activeElement===this.input||a(this.input,document.activeElement),t=document.getSelection(),n=!!(t&&t.rangeCount>0);return e&&n},t.focus=function(){if(!this.hasFocus()){this.input.focus();var e=document.getSelection();e&&!e.rangeCount&&this.setRange(new o.Z(0,0))}},t.blur=function(){this.input.blur()},t.format=function(e,t){var n=this.getNativeRange();if(null===n||void 0===n?void 0:n.native.collapsed){if(n.start.node!==this.cursor.textNode){var r=(0,i.n2)(n.start.node,!0);if(!r)return;var o=r.split(n.start.offset);r.parent.insertBefore(this.cursor,o)}var s;this.cursor.formatCursor(e,t),0===this.editor.getLength()&&this.setTempCursorStyle(Object.assign(Object.assign({},this.getTempCursorStyle()),((s={})[e]=t,s))),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length)}},t.setTempCursorStyle=function(e){this.tempCurSorStyle=e},t.setInitCursorStyle=function(e){this.initCursorStyle=e},t.getTempCursorStyle=function(){return this.tempCurSorStyle},t.getInitCursorStyle=function(){return this.initCursorStyle},t.isCollapsed=function(){var e=document.getSelection();return!(!e||e.rangeCount<=0)&&e.getRangeAt(0).collapsed},t.collapseToEnd=function(){var e=this.deltaManager.getLength();this.setRange(new o.Z(e,e))},t.collapseToPoint=function(e){var t=this.deltaManager.getLength();e>t&&(e=t),this.setRange(new o.Z(e,e))},t.scrollIntoView=function(){var e,t=null===(e=this.getNativeRange())||void 0===e?void 0:e.native.endContainer;if(t){for(var n=(0,i.n2)(t,!0);n&&!(0,i.Gr)(n);)n=n.parent;if(n){t=n.domNode;var r=this.input.scrollTop,o=this.input.clientHeight,s=t.offsetTop,a=t.offsetHeight,d=null;(s<r||s+a-o>r)&&(d=s+a-o),null!==d&&this.input.scrollTo(0,d)}}},t.setRange=function(e){var t=this.rangeToNative(e);this.setNativeRange.apply(this,(0,r.Z)(t))},t.getRange=function(){var e=this.getNativeRange();return e?[this.nativeToRange(e),e]:[null,null]},t.restoreSelection=function(e){if(e)this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset);else if(this.rangeBeforeOptimize){var t=this.getRange()[0];if(c()(t,this.rangeBeforeOptimize))return;this.setRange(this.rangeBeforeOptimize)}this.rangeBeforeOptimize=null},t.rangeToNative=function(e){var t=this,n=e.isCollapsed()?[e.getStart()]:[e.getStart(),e.getEnd()],r=[],i=this.vRoot.length();return n.forEach((function(e){e=Math.max(0,Math.min(i-1,e));var n=t.vRoot.getLeaf(e),o=n[0],s=n[1],a=o.getNativeRangePos(s),d=a[0],h=a[1];r.push(d,h)})),r},t.nativeToRange=function(e){var t=this,n=[[e.start.node,e.start.offset]];e.native.collapsed||n.push([e.end.node,e.end.offset]);var s=n.map((function(e){var n=e[0],r=e[1],o=(0,i.n2)(n,!0),s=r;return o instanceof f.Z&&(s=o.getOffsetFromNativeRangePos(n,r)),o.offset(t.vRoot)+s})),a=Math.min(Math.max.apply(Math,(0,r.Z)(s)),this.vRoot.length()-1),d=Math.min.apply(Math,[a].concat((0,r.Z)(s)));return new o.Z(d,a)},t.setNativeRange=function(e,t,n,r,i){if(void 0===n&&(n=e),void 0===r&&(r=t),void 0===i&&(i=!1),!e||this.input.parentNode&&e.parentNode&&n.parentNode){var o=document.getSelection();if(o){if(!e)return o.removeAllRanges(),void this.blur();this.hasFocus()||this.input.focus();var s=(this.getNativeRange()||{}).native;if(!s||i||e!==s.startContainer||t!==s.startOffset||n!==s.endContainer||r!==s.endOffset){"BR"===e.tagName&&(t=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),"BR"===n.tagName&&(r=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);var a=document.createRange();a.setStart(e,t),a.setEnd(n,r),o.removeAllRanges(),o.addRange(a)}}}},t.getNativeRange=function(){var e=document.getSelection();if(!e||e.rangeCount<=0)return null;var t=e.getRangeAt(0);return a(this.input,t.startContainer)&&(t.collapsed||a(this.input,t.endContainer))?function(e){var t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach((function(e){for(var t=e.node,n=e.offset;!(t instanceof Text)&&t.childNodes.length>0;)if(t.childNodes.length>n)t=t.childNodes[n],n=0;else{if(t.childNodes.length!==n)break;n=(t=t.lastChild)instanceof Text?t.data.length:t.childNodes.length>0?t.childNodes.length:1}e.node=t,e.offset=n})),t}(t):null},t.update=function(){var e=this.lastRange,t=this.getRange(),n=t[0],r=t[1];this.lastRange=n,this.lastRange&&(this.savedRange=this.lastRange),n&&r&&(c()(e,this.lastRange)||n.isCollapsed()&&r.native.startContainer!==this.cursor.textNode&&this.cursor.restore())},t.initEvents=function(){var e=this;this.emitter.selectionChangeEvent((function(t){t.source===u.Hx.EDITOR&&(e.editor.isComposing()||setTimeout((function(){e.update()})))})),this.emitter.viewChangeStartEvent((function(){var t=e.getRange()[0];t&&(e.rangeBeforeOptimize=t)}))},e}(),g=n(98585);n(25136),function(e){e[e.insertCommand=0]="insertCommand",e[e.deleteCommand=1]="deleteCommand",e[e.replaceCommand=2]="replaceCommand",e[e.formatCommand=3]="formatCommand"}(d||(d={}));var p=function(){function e(e){this.redoStack=[],this.undoStack=[],this.lastOperationPosition=0,this.previousCommand=void 0,this.currCommand=void 0,this.isPreviousInsertEmbed=!1,this.isPreviousInputDirty=!1,this.isRedoLock=!0,this.isInputSourceDirty=!1,this.firstInsertChar=void 0,this.secondInsertChar=void 0,this.isInsertBug=!1,this.editor=e.editor,this.deltaManager=e.deltaManager,this.emitter=e.emitter,this.clear(),this.setBaseHistoryDelta(this.deltaManager.getDelta()),this.initEventListeners()}var t=e.prototype;return t.clear=function(){this.redoStack=[],this.undoStack=[],this.previousCommand=void 0,this.currCommand=void 0,this.setBaseHistoryDelta(new g.Z)},t.hasUndo=function(){if(this.editor.isComposing())return this.undoStack.length>0;var e=!this.deltaManager.compareDelta(this.deltaManager.getDelta(),this.initDelta);return this.undoStack.length>0||e},t.hasRedo=function(){return this.redoStack.length>0},t.setBaseHistoryDelta=function(e){this.initDelta=e,this.lastSaveDelta=e,this.potentialSaveDelta=e},t.undo=function(){if(this.hasUndo()){var e,t,n=this.deltaManager.getDelta();this.isInputSourceDirty?(this.redoStack=[],e=(t=this.lastSaveDelta.diff(n)).invert(this.lastSaveDelta)):t=null===(e=this.undoStack.pop())||void 0===e?void 0:e.invert(n),this.redoStack.push(t),this.editor.updateContents(e,u.Hx.HISTORY),this.lastSaveDelta=n.compose(e),this.lastOperationPosition=this.getCursorIndex(e),this.editor.collapseToPoint(this.lastOperationPosition),this.isInputSourceDirty=!1,this.isRedoLock=!1,this.emitter.undoredoEmitter.fire({canUndo:this.hasUndo(),canRedo:this.hasRedo()})}},t.redo=function(){if(0!==this.redoStack.length&&!this.isRedoLock){var e=this.redoStack.pop(),t=this.deltaManager.getDelta(),n=null===e||void 0===e?void 0:e.invert(t);this.undoStack.push(n),this.editor.updateContents(e,u.Hx.HISTORY),this.lastSaveDelta=t.compose(e),this.lastOperationPosition=this.getCursorIndex(e),this.editor.collapseToPoint(this.lastOperationPosition),this.isInputSourceDirty=!1,this.emitter.undoredoEmitter.fire({canUndo:this.hasUndo(),canRedo:this.hasRedo()})}},t.save=function(t){this.redoStack=[];var n=this.lastSaveDelta.diff(t).invert(this.lastSaveDelta);0===n.ops.length&&(n=(new g.Z).delete(1)),this.undoStack.push(n),this.lastSaveDelta=t,this.undoStack.length>e.maxStack&&this.undoStack.shift(),this.emitter.undoredoEmitter.fire({canUndo:this.hasUndo(),canRedo:this.hasRedo()})},t.initEventListeners=function(){var e=this;this.emitter.textChangeEvent((function(t){e.textChangeEventHandler(t)}))},t.handleInsertFromStart=function(e){this.firstInsertChar?this.secondInsertChar=e.ops[0].insert:this.firstInsertChar=e.ops[0].insert,this.firstInsertChar===this.secondInsertChar&&(this.isInsertBug=!0)},t.clearInsertFromStartVars=function(){this.firstInsertChar=void 0,this.secondInsertChar=void 0,this.isInsertBug=!1},t.convertChangetoCommand=function(e){return 1===e.ops.length?Object.prototype.hasOwnProperty.call(e.ops[0],"insert")?(this.handleInsertFromStart(e),d.insertCommand):(this.clearInsertFromStartVars(),Object.prototype.hasOwnProperty.call(e.ops[0],"delete")?d.deleteCommand:d.formatCommand):(this.clearInsertFromStartVars(),2===e.ops.length&&Object.prototype.hasOwnProperty.call(e.ops[0],"retain")&&Object.prototype.hasOwnProperty.call(e.ops[1],"delete")?d.deleteCommand:e.ops.every((function(e){return Object.prototype.hasOwnProperty.call(e,"retain")}))?d.formatCommand:e.ops.some((function(e){return Object.prototype.hasOwnProperty.call(e,"delete")}))?d.replaceCommand:d.insertCommand)},t.compareCommand=function(e,t,n){return t===d.replaceCommand||!!(n.ops.some((function(e){return"object"===typeof(null===e||void 0===e?void 0:e.insert)===!0}))||n.ops.some((function(e){return(null===e||void 0===e?void 0:e.insert)===i.gp}))&&!this.deltaManager.compareDelta(this.potentialSaveDelta,this.initDelta))||e===d.deleteCommand&&t!==d.deleteCommand||t===d.deleteCommand&&e===d.insertCommand||!!this.checkContinuousInsertSave(t,e,n)||!(t!==d.deleteCommand||e!==d.deleteCommand||!this.compareDeletePosition(n))},t.checkContinuousInsertSave=function(e,t,n){return!(e!==d.insertCommand||t!==d.insertCommand||!this.compareInsertPosition(n)||this.isInsertBug)||!(e!==d.insertCommand||t!==d.insertCommand||!this.isPreviousInsertEmbed)},t.compareDeletePosition=function(e){return!!Object.prototype.hasOwnProperty.call(e.ops[0],"delete")||!!(Object.prototype.hasOwnProperty.call(e.ops[0],"retain")&&e.ops.length>=2&&e.ops[0].retain!==this.lastOperationPosition-e.ops[1].delete)},t.compareInsertPosition=function(e){return!!Object.prototype.hasOwnProperty.call(e.ops[0],"insert")||!(!Object.prototype.hasOwnProperty.call(e.ops[0],"retain")||e.ops[0].retain===this.lastOperationPosition)},t.textChangeEventHandler=function(e){if(this.editor.getActive()){e.source===u.Hx.HISTORY?(this.isInputSourceDirty=!1,this.isRedoLock=!1):(this.isInputSourceDirty=!0,this.isRedoLock=!0);var t=e.diffDelta;0!==t.ops.length&&!0!==this.editor.isComposing()&&(this.currCommand=this.convertChangetoCommand(t),this.isInputSourceDirty&&this.isPreviousInputDirty&&this.compareCommand(this.previousCommand,this.currCommand,t)&&this.save(this.potentialSaveDelta),this.potentialSaveDelta=this.potentialSaveDelta.compose(t),this.previousCommand=this.currCommand,this.isPreviousInsertEmbed=t.ops.some((function(e){return"object"===typeof(null===e||void 0===e?void 0:e.insert)})),this.isPreviousInputDirty=this.isInputSourceDirty,this.isInsertBug?this.lastOperationPosition=2:this.lastOperationPosition=this.getCursorIndex(t),this.emitter.undoredoEmitter.fire({canUndo:this.hasUndo(),canRedo:this.hasRedo()}))}},t.getCursorIndex=function(e){var t=e.reduce((function(e,t){return e+(t.delete||0)}),0),n=e.length()-t;return this.endsWithNewlineChange(e)&&(n-=1),n},t.endsWithNewlineChange=function(e){var t=e.ops[e.ops.length-1];return null!==t&&null!==t.insert&&t.insert!==i.gp&&"string"===typeof t.insert&&t.insert.endsWith("\n")},e}();p.maxStack=100;var m=p,v=n(52083),R=n(49444),x=function(){function e(e){var t=this;this.addKeyboardBindingsHandler=function(e){void 0===e&&(e=t.getDefaultKeyboardBindings()),t.baseKeyboard.addBindings(e)},this.removeKeyboardBindingsHandler=function(e){void 0===e&&(e=t.getDefaultKeyboardBindings()),t.baseKeyboard.removeBindings(e)},this.arrowKeyHandler=function(e){return function(n){var r=t.editor.getSelection();r&&r.isCollapsed()&&(-1===e&&0===r.getStart()||1===e&&r.getEnd()>=t.editor.getLength()||t.vRoot.getLeaf(r.getEnd()+(1===e?0:-1))[0]instanceof R.Z&&(n.preventDefault(),t.editor.setSelection(new o.Z(r.getEnd()+e))))}},this.insertNewline=function(e){e.preventDefault(),t.editor.getActive()&&(e.stopPropagation(),t.editor.insertNewLine(u.Hx.EDITOR))},this.delete=function(e){return function(n){if(n.preventDefault(),!(t.editor.getLength()<=0)){var r=t.editor.getSelection();if(r)if(r.isCollapsed()){if(!(e&&0===r.getStart()||!e&&r.getEnd()>=t.editor.getLength())){var i=e?-1:0;t.editor.deleteText(Math.max(r.getStart()+i,0),1,u.Hx.EDITOR)}}else t.editor.deleteText(r.getStart(),r.getLength(),u.Hx.EDITOR)}}},this.boldFormatHandler=function(e){e.preventDefault(),t.editor.setFormat("bold")},this.italicFormatHandler=function(e){e.preventDefault(),t.editor.setFormat("italic")},this.underlineFormatHandler=function(e){e.preventDefault(),t.editor.setFormat("underline")},this.strikeThroughFormatHandler=function(e){e.preventDefault(),t.editor.setFormat("strikethrough")},this.fontSizeDecrease=function(){var e=t.editor.getFormatWithBaseStyle().fontSize,n=e-2<=9?9:e-2;t.editor.setFormat("fontSize",n)},this.fontSizeIncrease=function(){var e=t.editor.getFormatWithBaseStyle().fontSize+2;t.editor.setFormat("fontSize",e)},this.handleUndo=function(e){e.preventDefault(),t.editor.getActive()&&t.editor.undo()},this.handleRedo=function(e){e.preventDefault(),t.editor.getActive()&&t.editor.redo()},this.editor=e.editor,this.vRoot=e.vRoot,this.baseKeyboard=new v.ZP({root:this.editor.getInput()}),this.addKeyboardBindingsHandler()}var t=e.prototype;return t.clear=function(){this.baseKeyboard.destroy()},t.getDefaultKeyboardBindings=function(){return[{key:v.ZP.KEYS.LEFT,handler:this.arrowKeyHandler(-1)},{key:v.ZP.KEYS.RIGHT,handler:this.arrowKeyHandler(1)},{key:v.ZP.KEYS.BACKSPACE,handler:this.delete(!0)},{key:v.ZP.KEYS.DELETE,handler:this.delete(!1)},{key:v.ZP.KEYS.ENTER,handler:this.insertNewline},{key:v.ZP.KEYS.ENTER,shiftKey:!0,handler:this.insertNewline},{key:v.ZP.KEYS.ENTER,ctrlKey:!0,handler:this.insertNewline},{key:v.ZP.KEYS.ENTER,metaKey:!0,handler:this.insertNewline},{key:v.ZP.KEYS.ENTER,altKey:!0,handler:this.insertNewline},{key:"z",shortKey:!0,handler:this.handleUndo},{key:"z",shortKey:!0,shiftKey:!0,handler:this.handleRedo},{key:"y",shortKey:!0,handler:this.handleRedo},{key:"b",shortKey:!0,handler:this.boldFormatHandler},{key:"i",shortKey:!0,handler:this.italicFormatHandler},{key:"u",shortKey:!0,handler:this.underlineFormatHandler},{key:"d",shortKey:!0,handler:this.strikeThroughFormatHandler},{key:"5",ctrlKey:!0,handler:this.strikeThroughFormatHandler},{key:v.ZP.KEYS.PERIOD,shiftKey:!0,shortKey:!0,handler:this.fontSizeIncrease},{key:v.ZP.KEYS.COMMA,shiftKey:!0,shortKey:!0,handler:this.fontSizeDecrease}]},e}(),T=function(){function e(e){var t=this;this.editor=e.editor,this.emitter=e.emitter,this.input=e.input,this.input.addEventListener("copy",(function(e){t.copyEventHandler(e)})),this.input.addEventListener("cut",(function(e){t.copyEventHandler(e)})),this.input.addEventListener("paste",(function(e){t.pasteEventHandler(e)}))}var t=e.prototype;return t.copyEventHandler=function(e){var t;e.preventDefault();var n=this.editor.getSelection();if(n&&!n.isCollapsed()){var r=this.editor.getText(n.getStart(),n.getLength());null===(t=e.clipboardData)||void 0===t||t.setData("text/plain",r),"cut"===e.type&&this.editor.deleteText(n.getStart(),n.getLength()),this.emitter.copyEmitter.fire(e)}},t.pasteEventHandler=function(e){var t;if(e.preventDefault(),this.editor.getActive()){var n=null===(t=null===e||void 0===e?void 0:e.clipboardData)||void 0===t?void 0:t.getData("text/plain");if(n){var r=this.editor.getSelection().getStart(),i=this.editor.getSelection().getEnd();this.editor.replaceText(r,n,i-r,this.editor.getCursorBaseStyle())}this.emitter.pasteEmitter.fire(e)}else this.emitter.pasteEmitter.fire(e)},e}(),E=n(90096),w=(n(15770),n(93984),n(10012),n(71096),n(39033)),y=n.n(w),S=n(41871);function O(e){return e.replace(/\r\n/g,i.gp).replace(/\r/g,i.gp)}n(20670);var D=function(){function e(e){this.delta=(new g.Z).insert(i.gp),this.vRoot=e}var t=e.prototype;return t.getDelta=function(){return this.delta.slice(0,this.getLength())},t.getDeltaFromView=function(){return(0,i.hq)(this.vRoot).reduce((function(e,t){return e.concat((0,i.iA)(t))}),new g.Z)},t.getLength=function(){return this.delta.length()-i.s$},t.getLastOp=function(e){var t=e.ops.length;if(0!==t)return e.ops[t-1]},t.getText=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.getLength()-e),this.getDelta().slice(e,e+t).filter((function(e){return"string"===typeof e.insert||"object"===typeof e.insert})).map((function(e){return"string"===typeof e.insert?e.insert:"object"===typeof e.insert&&Object.values(e.insert)[0].text||""})).join("")},t.insertText=function(e,t,n){void 0===n&&(n={});var r=O(t);this.vRoot.insertTextAt(e,r);for(var i=0,o=Object.entries(n);i<o.length;i++){var s=o[i],a=s[0],d=s[1];this.vRoot.formatAt(e,r.length,a,d)}return this.update((new g.Z).retain(e).insert(r,y()(n)))},t.deleteText=function(e,t){return this.vRoot.deleteAt(e,t),this.update((new g.Z).retain(e).delete(t))},t.replaceText=function(e,t,n,r){void 0===r&&(r={});var i=O(t);this.vRoot.deleteAt(e,n),this.vRoot.insertTextAt(e,i);for(var o=0,s=Object.entries(r);o<s.length;o++){var a=s[o],d=a[0],h=a[1];this.vRoot.formatAt(e,i.length,d,h)}return this.update((new g.Z).retain(e).insert(i,y()(r)).delete(n))},t.insertEmbeds=function(e,t,n){var r=this;return n.forEach((function(n){r.vRoot.insertEmbedAt(e,t,n)})),this.update(n.reduce((function(e,n){var r;return e.insert(((r={})[t]=n,r))}),(new g.Z).retain(e)))},t.setFormat=function(e,t,n,r){this.vRoot.formatAt(e,t,n,r);var i=(new g.Z).retain(e).retain(t,{key:r});return this.update(i)},t.compareDelta=function(e,t){return 0===e.length()&&0===t.length()||c()(e,t)},t.clearFormat=function(){var e=this.getText(),t=(new g.Z).insert(e).invert(this.getDelta());return this.update(t)},t.formatLine=function(e,t,n){void 0===n&&(n={});var r=(new g.Z).retain(e).retain(t,y()(n));return this.update(r)},t.applyDelta=function(e){var t=this,n=function(e){return e.reduce((function(e,t){if("string"===typeof t.insert){var n=t.insert.replace(/\r\n/g,i.gp).replace(/\r/g,i.gp);return e.insert(n,t.attributes)}return e.push(t)}),new g.Z)}(e),r=new g.Z;return n.reduce((function(e,n){var i=S.Z.length(n),o=n.attributes||{};if(n.insert){if(r.retain(i),"string"===typeof n.insert){var s=n.insert;t.vRoot.insertTextAt(e,s)}else if("object"===typeof n.insert){var a=Object.keys(n.insert)[0];if(!a)return e;t.vRoot.insertEmbedAt(e,a,n.insert[a])}}else r.push(n);return Object.keys(o).forEach((function(n){t.vRoot.formatAt(e,i,n,o[n])})),e+i}),0),r.reduce((function(e,n){return"number"===typeof n.delete?(t.vRoot.deleteAt(e,n.delete),e):e+S.Z.length(n)}),0),this.vRoot.optimize(),this.update(n)},t.update=function(e){var t=this.delta,n=e;return this.delta=this.getDeltaFromView(),n&&c()(t.compose(n),this.delta)||(n=t.diff(this.delta)),n||new g.Z},e}(),M=n(17093),C=(n(12024),n(81502),n(7157)),_=function(){function e(e){this.formats={},this.shouldReverseColorWhenNeeded=e.shouldReverseColorWhenNeeded}var t=e.prototype;return t.getFormats=function(){return this.formats},t.getShouldReverseColorWhenNeeded=function(){return this.shouldReverseColorWhenNeeded},t.addFormat=function(e,t){this.formats[e]=t},t.setStyle=function(e,t,n){var r,i,o=null===(r=C.ar[t])||void 0===r?void 0:r.call(C.ar,this,e,n),s=void 0!==(null===o||void 0===o?void 0:o.value)?null===o||void 0===o?void 0:o.value:n;null===(i=this.formats[t])||void 0===i||i.format(e,s)},t.getStyle=function(e,t){var n;return null===(n=this.formats[t])||void 0===n?void 0:n.getFormat(e)},t.removeStyle=function(e,t){var n;null===(n=this.formats[t])||void 0===n||n.remove(e)},t.getStyles=function(e,t){void 0===t&&(t=[]);for(var n={},r=0,i=Object.entries(this.formats);r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(!t.includes(s)){var d=a.getFormat(e);d&&(n[s]=d)}}return n},e}(),A=n(13504),N=n(20007),b=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="fontWeight",t.styleValue="bold",t}(0,A.Z)(t,e);var n=t.prototype;return n.format=function(t,n){!1!==n?e.prototype.format.call(this,t,this.styleValue):this.remove(t)},n.getFormat=function(e){return(this.isHidden?e.dataset[this.styleKey]:e.style[this.styleKey])===this.styleValue},t}(N.Z);b.key="bold";var P=n(39521),k=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="fontStyle",t.styleValue="italic",t}(0,A.Z)(t,e);var n=t.prototype;return n.format=function(t,n){!1!==n?e.prototype.format.call(this,t,this.styleValue):this.remove(t)},n.getFormat=function(e){return(this.isHidden?e.dataset[this.styleKey]:e.style[this.styleKey])===this.styleValue},t}(N.Z);k.key="italic",n(62077);var L=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="textDecoration",t.styleValue="underline",t}(0,A.Z)(t,e);var n=t.prototype;return n.format=function(t,n){if(!1!==n){var r=(this.isHidden?t.dataset[this.styleKey]:t.style[this.styleKey])+" "+this.styleValue;e.prototype.format.call(this,t,r)}else this.remove(t)},n.remove=function(t){var n=this.isHidden?t.dataset[this.styleKey]:t.style[this.styleKey];if((null===n||void 0===n?void 0:n.trim())===this.styleValue)e.prototype.remove.call(this,t);else{var r=null===n||void 0===n?void 0:n.replace(this.styleValue,"").trim();e.prototype.format.call(this,t,r)}},n.getFormat=function(e){var t=this.isHidden?e.dataset[this.styleKey]:e.style[this.styleKey];return!!(null===t||void 0===t?void 0:t.includes(this.styleValue.trim()))},t}(N.Z);L.key="underline";var Z=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="textDecoration",t.styleValue="line-through",t}(0,A.Z)(t,e);var n=t.prototype;return n.format=function(t,n){if(!1!==n){var r=(this.isHidden?t.dataset[this.styleKey]:t.style[this.styleKey])+" "+this.styleValue;e.prototype.format.call(this,t,r)}else this.remove(t)},n.remove=function(t){var n=this.isHidden?t.dataset[this.styleKey]:t.style[this.styleKey];if((null===n||void 0===n?void 0:n.trim())===this.styleValue)e.prototype.remove.call(this,t);else{var r=null===n||void 0===n?void 0:n.replace(this.styleValue,"").trim();e.prototype.format.call(this,t,r)}},n.getFormat=function(e){var t=this.isHidden?e.dataset[this.styleKey]:e.style[this.styleKey];return!!(null===t||void 0===t?void 0:t.includes(this.styleValue.trim()))},t}(N.Z);Z.key="strikethrough";var U=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="fontFamily",t}return(0,A.Z)(t,e),t}(N.Z);U.key="fontFamily",n(62883);var F=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="fontSize",t}(0,A.Z)(t,e);var n=t.prototype;return n.format=function(t,n){var r=n+"pt";e.prototype.format.call(this,t,r)},n.getFormat=function(t){var n=e.prototype.getFormat.call(this,t);return Number(null===n||void 0===n?void 0:n.replace("pt",""))},t}(N.Z);F.key="fontSize";var W=n(7621),V=n(51527),j=[],B=function(){function e(e){var t,n;this.isComposingStatus=!1,this.readOnly=!1,this.isAutoScroll=!0,this.isActive=!1,this.readOnly=null!==(t=e.readOnly)&&void 0!==t&&t,this.hiddenStyles=e.hiddenStyles,this.baseStyle=E.d9,this.shouldReverseColorWhenNeeded=null!==(n=e.shouldReverseColorWhenNeeded)&&void 0!==n&&n,this.initInputDom(e.inputContainer,e.id,e.className),this.initComponents(),this.initEvents()}var t=e.prototype;return t.getEmitter=function(){return this.emitter},t.getDelta=function(){return this.deltaManager.getDelta()},t.getInput=function(){return this.input},t.commit=function(){return this.sync(!0),this.mergeDeltaWithBaseStyle(this.getDelta(),this.baseStyle)},t.clear=function(){this.selection.clear(),this.setContents(new g.Z,u.Hx.SILENT),this.history.clear(),this.isComposingStatus=!1},t.setInputMode=function(e){this.input.inputMode=e},t.setActive=function(e){this.isActive=e},t.getActive=function(){return this.isActive},t.setAutoScroll=function(e){this.isAutoScroll=e},t.getReadOnly=function(){return this.readOnly},t.getContentHeight=function(){var e=0;return this.input.childNodes.forEach((function(t){e+=t.offsetHeight})),e},t.hasFocus=function(){return this.selection.hasFocus()},t.focus=function(){this.selection.focus()},t.blur=function(){this.selection.blur()},t.isCollapsed=function(){return this.selection.isCollapsed()},t.collapseToEnd=function(){this.selection.collapseToEnd(),this.selection.scrollIntoView()},t.collapseToPoint=function(e){this.selection.collapseToPoint(e),this.selection.scrollIntoView()},t.scrollIntoView=function(){this.selection.scrollIntoView()},t.getSelection=function(){var e;return(null===(e=this.selection.getRange())||void 0===e?void 0:e[0])||null},t.setSelection=function(e,t){void 0===t&&(t=u.Hx.API),this.sync(),null!==e&&(this.selection.setRange(e),t!==u.Hx.SILENT&&this.internalEmitter.selectionChangeEmitter.fire({source:t,range:e}))},t.getCursorBaseStyle=function(){return this.selection.getTempCursorStyle()},t.addKeyBindings=function(e){return this.keyboard.addKeyboardBindingsHandler(e)},t.removeKeyBindings=function(e){return this.keyboard.removeKeyboardBindingsHandler(e)},t.hasUndo=function(){return this.history.hasUndo()},t.hasRedo=function(){return this.history.hasRedo()},t.undo=function(){return this.sync(),this.history.undo()},t.redo=function(){return this.sync(),this.history.redo()},t.isComposing=function(){return this.isComposingStatus},t.sync=function(e){void 0===e&&(e=!1),this.vRoot.sync(void 0,e)},t.insertNewLine=function(e){void 0===e&&(e=u.Hx.API),this.sync();var t=this.getSelection();if(t){var n=this.getFormat(),r=(new g.Z).retain(t.getStart()).delete(t.getLength()).insert(i.gp);this.updateContents(r,e);for(var o=0,s=Object.entries(n);o<s.length;o++){var a=s[o],d=a[0],h=a[1];h&&this.selection.format(d,h)}this.isAutoScroll&&this.scrollIntoView()}},t.setEditable=function(e){this.readOnly=!e,this.input.setAttribute("contenteditable",String(e))},t.setInputStyles=function(e){var t=(0,V.yy)(this.hiddenStyles,e),n=t.editorStyleObj,r=t.editorDataSetObj;(0,V.Y7)(this.input,n,r,this.shouldReverseColorWhenNeeded)},t.setContents=function(e,t){var n=this;return void 0===t&&(t=u.Hx.API),this.sync(),e.diff(this.getDelta())===new g.Z?e:this.modify((function(){var t=n.getLength(),r=n.deltaManager.deleteText(0,t),i=n.deltaManager.applyDelta(e);return r.compose(i)}),t)},t.updateContents=function(e,t){var n=this;return void 0===t&&(t=u.Hx.API),this.sync(),this.modify((function(){return n.deltaManager.applyDelta(e)}),t,{useRange:!0})},t.getText=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.getLength()-e),this.deltaManager.getText(e,t)},t.setText=function(e,t,n){void 0===t&&(t=u.Hx.API),void 0===n&&(n=!1),this.sync();var r=(new g.Z).insert(e);this.setContents(r,t),n&&this.collapseToEnd()},t.insertText=function(e,t,n,r){var i=this;return void 0===n&&(n={}),void 0===r&&(r=u.Hx.API),this.sync(),this.modify((function(){return i.deltaManager.insertText(e,t,n)}),r,{index:e})},t.replaceText=function(e,t,n,r,i){var o=this;return void 0===r&&(r={}),void 0===i&&(i=u.Hx.API),this.sync(),this.modify((function(){return o.deltaManager.replaceText(e,t,n,r)}),i,{index:e})},t.deleteText=function(e,t,n){var r=this;return void 0===n&&(n=u.Hx.API),this.sync(),this.modify((function(){return r.deltaManager.deleteText(e,t)}),n,{index:e})},t.insertEmbeds=function(e,t,n,r){var i=this;return void 0===r&&(r=u.Hx.API),this.sync(),this.modify((function(){return i.deltaManager.insertEmbeds(e,t,n)}),r,{index:e})},t.getFormatWithBaseStyle=function(){var e=this.getFormat(),t=Object.assign(Object.assign({},e),{bold:e.bold||!1,italic:e.italic||!1,strikethrough:e.strikethrough||!1,underline:e.underline||!1});return Object.assign(Object.assign({},this.baseStyle),t)},t.getFormat=function(){var e=this.selection.getRange()[1];if(!e)return{};var t=(0,i.n2)(e.start.node,!0);return t?(0,i.E2)(t):{}},t.setFormat=function(e,t,n){var r,i,o,s=this;void 0===n&&(n=u.Hx.API),this.sync();var a=this.getFormatWithBaseStyle(),d=(null===(r=C.gQ[e])||void 0===r?void 0:r.call(C.gQ,a))||{},h=null!==(i=d.key)&&void 0!==i?i:e,l=null!==(o=d.value)&&void 0!==o?o:t;return this.modify((function(){var e=s.getSelection(),t=new g.Z;return e?e.getStart()===e.getEnd()?(s.selection.format(h,l),t):(t=s.deltaManager.setFormat(e.getStart(),e.getLength(),h,l),s.setSelection(e,u.Hx.SILENT),t):t}),n)},t.setFormatWithRange=function(e,t,n,r,i){var o=this;return void 0===i&&(i=u.Hx.API),this.sync(),this.modify((function(){return new g.Z,o.deltaManager.setFormat(e,e+t,n,r)}),i)},t.getLength=function(){return this.deltaManager.getLength()},t.setBaseStyle=function(e){this.baseStyle=e||E.d9},t.getBaseStyle=function(){return this.baseStyle},t.setUpEditor=function(e){void 0===e&&(e=this.getDelta());var t=function(e,t){return 0===e.ops.length?{bold:t.bold,italic:t.italic,strikethrough:t.strikethrough,underline:t.underline}:{bold:t.bold,italic:t.italic,strikethrough:s(e,"strikethrough",t.strikethrough),underline:s(e,"underline",t.underline)}}(e,this.baseStyle);this.selection.setTempCursorStyle(t),this.selection.setInitCursorStyle(t),this.history.setBaseHistoryDelta(e),this.setContents(e,u.Hx.SILENT)},t.initInputDom=function(e,t,n){var r=this;this.input=document.createElement("div"),this.input.setAttribute("id",t||E.x8),this.input.setAttribute("contenteditable",String(!this.readOnly)),this.input.setAttribute("spellcheck","false"),n&&n.length>0&&n.forEach((function(e){r.input.classList.add(e)})),this.input.setAttribute("tabindex","0"),this.input.setAttribute("role","combobox"),this.input.style.display="block",this.input.style.position="relative",this.input.style.width="100%",this.input.style.height="100%",this.input.style.overflowY="auto",this.input.style.overflowX="hidden",this.input.style.boxSizing="border-box",this.input.style.outline="none",this.input.style.padding="0px 4px",this.input.style.textDecorationSkipInk="none",this.input.style.lineHeight="20px",this.input.style.fontSize="14px",this.input.style.whiteSpace="pre-wrap",this.input.style.wordBreak="break-word",this.input.style.wordWrap="break-word",function(e){if(!e)return!1;if(j.some((function(t){return t.scrollable===e})))return!0;var t,n={scrollable:e,enable:!0},r=!1,i=!1;e.addEventListener("touchstart",(function(o){!1!==n.enable&&(o.stopPropagation(),1===o.targetTouches.length&&(t=o.touches[0].clientY,0===e.scrollTop&&(r=!0),e.scrollHeight-e.clientHeight<=e.scrollTop&&(i=!0)))})),e.addEventListener("touchmove",(function(e){if(!1!==n.enable){e.stopPropagation();var o=e.touches[0].clientY-t;(o>0&&r||o<0&&i)&&e.preventDefault()}})),e.addEventListener("touchend",(function(e){e.stopPropagation(),r=!1,i=!1})),j.push(n)}(this.input),e.appendChild(this.input)},t.initComponents=function(){this.internalEmitter=new u.ZP,this.emitter=new u.$Y;var e=this.initStyler(this.hiddenStyles);this.vRoot=new M.Z(this.input,e,this,this.internalEmitter),this.deltaManager=new D(this.vRoot),this.selection=new I({editor:this,input:this.input,deltaManager:this.deltaManager,vRoot:this.vRoot,emitter:this.internalEmitter}),this.history=new m({editor:this,deltaManager:this.deltaManager,emitter:this.internalEmitter}),this.keyboard=new x({editor:this,vRoot:this.vRoot}),new T({editor:this,emitter:this.internalEmitter,input:this.input})},t.initStyler=function(e){var t=new _({shouldReverseColorWhenNeeded:this.shouldReverseColorWhenNeeded}),n=(0,V.$s)(e);return t.addFormat(b.key,new b(n[b.key])),t.addFormat(k.key,new k(n[k.key])),t.addFormat(L.key,new L(n[L.key])),t.addFormat(Z.key,new Z(n[Z.key])),t.addFormat(U.key,new U(n[U.key])),t.addFormat(P.Z.key,new P.Z(n[P.Z.key])),t.addFormat(F.key,new F(n[F.key])),t.addFormat(W.Z.key,new W.Z(n[W.Z.key])),t},t.initEvents=function(){var e=this;this.input.addEventListener("focus",(function(t){e.emitter.focusEmitter.fire(t)})),this.input.addEventListener("blur",(function(t){e.emitter.blurEmitter.fire(t)})),this.input.addEventListener("compositionstart",(function(t){e.internalEmitter.compositionEmitter.fire(t)})),this.input.addEventListener("compositionupdate",(function(t){e.internalEmitter.compositionEmitter.fire(t)})),this.input.addEventListener("compositionend",(function(t){e.internalEmitter.compositionEmitter.fire(t)})),this.internalEmitter.compositionEvent((function(t){"compositionstart"===t.type?e.isComposingStatus=!0:"compositionend"===t.type&&(e.isComposingStatus=!1,e.vRoot.sync()),e.emitter.compositionEmitter.fire(t)})),document.addEventListener("selectionchange",(function(){e.hasFocus()&&(e.sync(),e.internalEmitter.selectionChangeEmitter.fire({source:u.Hx.EDITOR}))})),this.internalEmitter.pasteEvent((function(t){e.emitter.pasteEmitter.fire(t)})),this.internalEmitter.copyEvent((function(t){e.emitter.copyEmitter.fire(t)})),this.internalEmitter.viewChangeEvent((function(t){var n=t.context;e.hasFocus()&&e.getLength()>0&&e.selection.restoreSelection(null===n||void 0===n?void 0:n.range),e.modify((function(){return e.deltaManager.update()}),u.Hx.EDITOR)})),this.internalEmitter.textChangeEvent((function(t){if(e.deltaManager.compareDelta(t.delta,t.diffDelta)){for(var n=e.getCursorBaseStyle(),r=0,i=Object.entries(n);r<i.length;r++){var o=i[r],s=o[0],a=o[1];e.setFormatWithRange(0,t.delta.length(),s,a)}e.collapseToEnd(),e.selection.setTempCursorStyle(e.selection.getInitCursorStyle())}e.emitter.textChangeEmitter.fire(t)})),this.internalEmitter.selectionChangeEvent((function(t){e.emitter.selectionChangeEmitter.fire(t)})),this.internalEmitter.undoredoEvent((function(t){e.emitter.undoredoEmitter.fire(t)}))},t.mergeDeltaWithBaseStyle=function(e,t){var n=new g.Z;return 0===e.ops.length||e.forEach((function(e){var r=e.attributes?Object.assign({},e.attributes):{},i=Object.assign(Object.assign({},r),{bold:r.bold||!1,italic:r.italic||!1,strikethrough:r.strikethrough||!1,underline:r.underline||!1}),o=Object.assign(Object.assign({},t),i);o.fontFamily=o.fontFamily.split('"').join(""),void 0!==e.insert&&n.insert(e.insert,o)})),n},t.modify=function(e,t,n){var r=n?this.getSelection():null,i=e();if(0===i.ops.length)return new g.Z;if(r){var s=n||{},a=s.useRange,d=s.index,h=s.shift,l=a?r.getStart():d;void 0===h?r=function(e,t){var n=[e.getStart(),e.getEnd()].map((function(e){return t.transformPosition(e)})),r=n[0],i=n[1];return new o.Z(r,i)}(r,i):void 0!==l&&0!==h&&(r=function(e,t,n){var r=[e.getStart(),e.getEnd()].map((function(e){return e<t?e:n>=0?e+n:Math.max(t,e+n)})),i=r[0],s=r[1];return new o.Z(i,s)}(r,l,h)),this.setSelection(r,u.Hx.SILENT)}return t!==u.Hx.SILENT&&this.internalEmitter.textChangeEmitter.fire({diffDelta:i,delta:this.getDelta(),source:t}),i},e}()},83139:function(e,t,n){"use strict";n.d(t,{$Y:function(){return s},Hx:function(){return r},ZP:function(){return o}});var r,i=n(28280);!function(e){e.API="api",e.EDITOR="editor",e.HISTORY="history",e.SILENT="silent"}(r||(r={}));var o=function(){this.viewChangeEmitter=new i.Q5,this.viewChangeEvent=this.viewChangeEmitter.event,this.viewChangeStartEmitter=new i.Q5,this.viewChangeStartEvent=this.viewChangeStartEmitter.event,this.textChangeEmitter=new i.Q5,this.textChangeEvent=this.textChangeEmitter.event,this.compositionEmitter=new i.Q5,this.compositionEvent=this.compositionEmitter.event,this.selectionChangeEmitter=new i.Q5,this.selectionChangeEvent=this.selectionChangeEmitter.event,this.copyEmitter=new i.Q5,this.copyEvent=this.copyEmitter.event,this.pasteEmitter=new i.Q5,this.pasteEvent=this.pasteEmitter.event,this.undoredoEmitter=new i.Q5,this.undoredoEvent=this.undoredoEmitter.event},s=function(){this.textChangeEmitter=new i.Q5,this.textChangeEvent=this.textChangeEmitter.event,this.selectionChangeEmitter=new i.Q5,this.selectionChangeEvent=this.selectionChangeEmitter.event,this.compositionEmitter=new i.Q5,this.compositionEvent=this.compositionEmitter.event,this.focusEmitter=new i.Q5,this.focusEvent=this.focusEmitter.event,this.blurEmitter=new i.Q5,this.blurEvent=this.blurEmitter.event,this.copyEmitter=new i.Q5,this.copyEvent=this.copyEmitter.event,this.pasteEmitter=new i.Q5,this.pasteEvent=this.pasteEmitter.event,this.undoredoEmitter=new i.Q5,this.undoredoEvent=this.undoredoEmitter.event}},20007:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=function(){function e(e){this.isHidden=e||!1}var t=e.prototype;return t.format=function(e,t){this.isHidden?e.dataset[this.styleKey]=t:e.style[this.styleKey]=t},t.remove=function(e){delete e.dataset[this.styleKey],delete e.style[this.styleKey]},t.getFormat=function(e){return this.isHidden?e.dataset[this.styleKey]:e.style[this.styleKey]},e}()},39521:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(13504),i=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="color",t}(0,r.Z)(t,e);var n=t.prototype;return n.format=function(e,t){e.dataset[this.styleKey]=t,this.isHidden||(e.style[this.styleKey]=t)},n.getFormat=function(e){return e.dataset[this.styleKey]},n.remove=function(e){delete e.dataset[this.styleKey],delete e.style[this.styleKey]},t}(n(20007).Z);i.key="color"},7621:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(13504),i=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).styleKey="color",t}(0,r.Z)(t,e);var n=t.prototype;return n.format=function(e,n){e.dataset[t.key]=n,this.isHidden||(e.style[this.styleKey]=n)},n.getFormat=function(e){return e.dataset[t.key]},n.remove=function(e){delete e.dataset[t.key],delete e.style[this.styleKey]},t}(n(20007).Z);i.key="themeColor"},63072:function(e,t,n){"use strict";n.d(t,{X:function(){return o},k:function(){return i}}),n(8195);var r,i={error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,["error"].concat(t))},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,["warn"].concat(t))},info:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,["info"].concat(t))},log:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,["log"].concat(t))},debug:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,["debug"].concat(t))},trace:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,["trace"].concat(t))}};function o(e){if(r)throw new Error("Logger is already registered");r=e}function s(e){var t;if(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=r)[e].apply(t,i)}}},51527:function(e,t,n){"use strict";n.d(t,{$s:function(){return o},Y7:function(){return a},ll:function(){return i},yy:function(){return s}}),n(52865),n(20670),n(62883),n(38934),n(31688),n(71096),n(12024),n(81502),n(90096);var r=n(7157);function i(e){return e.prototype?e:e.constructor}function o(e){var t={bold:!1,italic:!1,underline:!1,strikeThrough:!1,color:!1,themeColor:!1,fontSize:!1,fontFamily:!1};return e?(e.forEach((function(e){t[e]=!0})),t):t}function s(e,t){var n=["fontWeight","fontStyle","textDecoration","textDecorationSkipInk"],r=["themeColor"];e&&e.length>0&&e.forEach((function(e){n.push(e),r.push(e)}));var i={},o={};return Object.keys(t).forEach((function(e){-1===n.indexOf(e)&&void 0!==t[e]&&(i[e]=t[e]),r.includes(e)&&void 0!==t[e]&&(o[e]=t[e])})),{editorStyleObj:i,editorDataSetObj:o}}function a(e,t,n,i){for(var o in t)e.style[o]=t[o];for(var s in n)e.dataset[s]=n[s];i&&(null===t||void 0===t?void 0:t.color)&&r.Yf.includes(t.color)&&(e.dataset.color=r.Yf[0],e.style.color=r.Sx[0])}},7157:function(e,t,n){"use strict";n.d(t,{Sx:function(){return s},Yf:function(){return a},ar:function(){return h},gQ:function(){return u},xC:function(){return d}}),n(12024),n(91877),n(60113);var r,i=n(39521),o=n(7621),s=["rgba(0,0,0,1)","#000000"],a=["rgba(255,255,255,1)","#ffffff"],d="data-theme-color",h=((r={})[i.Z.key]=function(e,t,n){return e.removeStyle(t,o.Z.key),{value:e.getShouldReverseColorWhenNeeded()&&a.includes(n)?s:n}},r[o.Z.key]=function(e,t,n){return e.removeStyle(t,i.Z.key),{value:e.getShouldReverseColorWhenNeeded()&&a.includes(n)?s:n}},r),u={bold:function(e){return{value:!e.bold}},italic:function(e){return{value:!e.italic}},underline:function(e){return{value:!e.underline}},strikethrough:function(e){return{value:!e.strikethrough}},strikeThrough:function(e){return{key:"strikethrough",value:!e.strikethrough}},fontName:function(){return{key:"fontFamily"}},foreColor:function(){return{key:"color"}}}},23669:function(e,t,n){"use strict";n.d(t,{AF:function(){return s},Cq:function(){return c},E2:function(){return p},Gr:function(){return m},LU:function(){return f},gp:function(){return d},hq:function(){return I},iA:function(){return g},kW:function(){return o},n2:function(){return h},o0:function(){return l},s$:function(){return a}}),n(62077),n(62883),n(38934),n(46396);var r=n(98585),i=n(11245),o="\ufeff",s="__vnode",a=1,d="\n";function h(e,t){return void 0===t&&(t=!1),e?e[s]?e[s]:t?h(e.parentNode,t):null:null}var u={};function l(e,t){if(u[e])throw new Error("registerEmbed failed: embed with key "+e+" already exists");u[e]=t}function c(e,t){if(e instanceof Node){if(e.tagName===i.hJ.tagName)return new i.hJ(e);if(e.nodeType===Node.TEXT_NODE)return new i.Jj(e);if(e.tagName===i.yL.tagName)return new i.yL(e);if(e.tagName===i.NP.tagName)return new i.NP(e)}if("string"===typeof e&&t){var n=u[e];if(n)return new n(n.createDomNode(t),t)}throw new Error("Cannot create VNode with given params")}function f(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}function I(e,t,n){void 0===t&&(t=0),void 0===n&&(n=Number.MAX_VALUE);var r=[];return e.children.forEachAt(t,n,(function(e){if(!(e instanceof i.yL))throw new Error("VRoot has a child that is not a VBlock");r.push(e)})),r}function g(e){return e.getLeaves().reduce((function(e,t){return 0===t.length()?e:e.insert(t.value(),p(t))}),new r.Z).insert(d,p(e))}function p(e,t){return void 0===t&&(t={}),e?(e instanceof i.KI&&(t=Object.assign(Object.assign({},e.getFormats()),t)),!e.parent||e.parent instanceof i.xm?t:p(e.parent,t)):t}function m(e){return e instanceof i.yL}},49444:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(13504),i=(n(38934),n(31688),n(26894),n(71091),n(75793),n(52865),n(64425),n(51527)),o=n(23669),s=n(11245),a=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).savedValue=n,r.contentNode=document.createElement("span"),r.contentNode.setAttribute("contenteditable","false"),r.contentNode.style.whiteSpace="nowrap",Array.from(r.domNode.childNodes).forEach((function(e){r.contentNode.appendChild(e)})),r.leftGuard=document.createTextNode(o.kW),r.rightGuard=document.createTextNode(o.kW),r.domNode.appendChild(r.leftGuard),r.domNode.appendChild(r.contentNode),r.domNode.appendChild(r.rightGuard),r}(0,r.Z)(t,e),t.createDomNode=function(e){return document.createElement(this.tagName)};var n=t.prototype;return n.value=function(){var e;return(e={})[(0,i.ll)(this).key]=this.savedValue,e},n.getOffsetFromNativeRangePos=function(t,n){return t===this.leftGuard?0:t===this.rightGuard?1:e.prototype.getOffsetFromNativeRangePos.call(this,t,n)},n.restore=function(e){var t,n=null,r=e.data.split(o.kW).join("");if(0===r.length)return null;if(e===this.leftGuard)if(this.prev instanceof s.Jj){var i=this.prev.length();this.prev.insertTextAt(i,r),n={startNode:this.prev.domNode,startOffset:i+r.length}}else t=document.createTextNode(r),this.parent.insertBefore((0,o.Cq)(t),this),n={startNode:t,startOffset:r.length};else e===this.rightGuard&&(this.next instanceof s.Jj?(this.next.insertTextAt(0,r),n={startNode:this.next.domNode,startOffset:r.length}):(t=document.createTextNode(r),this.parent.insertBefore((0,o.Cq)(t),this.next),n={startNode:t,startOffset:r.length}));return e.data=o.kW,n},n.update=function(e){var t=this;void 0===e&&(e={});var n=this.mutations;n&&n.forEach((function(n){if("characterData"===n.type&&(n.target===t.leftGuard||n.target===t.rightGuard)){var r=t.restore(n.target);r&&(e.range=r)}}))},t}(s.bt);a.tagName="SPAN"},11245:function(e,t,n){"use strict";n.d(t,{yL:function(){return l.Z},hJ:function(){return u.Z},KI:function(){return s.Z},bt:function(){return I.Z},NP:function(){return h},xm:function(){return f.Z},Jj:function(){return c.Z}}),n(55269),n(15770),n(38934),n(84919),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(13504),i=n(36130),o=n.n(i),s=n(34948);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var h=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.createDomNode=function(){return document.createElement(this.tagName)},t.prototype.optimize=function(n){if(e.prototype.optimize.call(this,n),0===this.children.getSize())return this.unwrap();if(this.next instanceof t&&o()(this.getStyler().getStyles(this.domNode),this.next.getStyler().getStyles(this.next.domNode))){for(var r,i=a(this.next.children);!(r=i()).done;){var s=r.value;this.insertBefore(s)}this.next.remove()}},t}(s.Z);h.tagName="SPAN";var u=n(70849),l=n(16058),c=n(19910),f=n(17093),I=n(82966);n(60119),n(42433),n(49444)},16058:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(13504),i=(n(52865),n(64425),n(38934),n(11245)),o=n(23669),s=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e),t.createDomNode=function(){return document.createElement(this.tagName)};var n=t.prototype;return n.length=function(){return e.prototype.length.call(this)+o.s$},n.insertTextAt=function(t,n){var r=n.split(o.gp),i=r.shift();i&&i.length>0&&(t<this.length()||!this.children.getTail()?e.prototype.insertTextAt.call(this,t,i):this.children.getTail().insertTextAt(this.children.getTail().length(),i));var s=this;r.reduce((function(e,t){return(s=s.split(e,!0)).insertTextAt(0,t),t.length}),t+((null===i||void 0===i?void 0:i.length)||0))},n.getLeaf=function(t){void 0===t&&(t=0);var n=t===this.length()-o.s$;return e.prototype.getLeaf.call(this,t,n)},n.optimize=function(t){if(e.prototype.optimize.call(this,t),0===this.children.getSize()){var n;n=1===this.domNode.childNodes.length&&"BR"===this.domNode.lastChild.tagName?this.domNode.lastChild:i.hJ.createDomNode();var r=new i.hJ(n);this.insertBefore(r),r.optimize()}},t}(i.KI);s.tagName="P"},70849:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(13504),i=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e),t.createDomNode=function(){return document.createElement(this.tagName)};var n=t.prototype;return n.optimize=function(){(this.prev||this.next)&&this.remove()},n.length=function(){return 0},t}(n(82966).Z);i.tagName="BR"},34948:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}}),n(15770),n(84919),n(26894),n(71091),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(13504),i=(n(38934),n(52865),n(64425),n(62883),n(8195),n(31688),n(49502),n(93984),n(69738)),o=n.n(i),s=n(23669),a=n(42433),d=n(55269),h=n(19910),u=n(63072);function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e),t.createDomNode=function(e){return document.createElement(e)};var n=t.prototype;return n.insertBefore=function(e,t){e.parent&&e.parent.children.remove(e),this.children.insertBefore(e,t),e.parent=this,e.root=this.root;var n=null;t&&(n=t.domNode),e.domNode.parentNode===this.domNode&&e.domNode.nextSibling===n||this.domNode.insertBefore(e.domNode,n)},n.length=function(){return this.children.reduce((function(e,t){return e+t.length()}),0)},n.split=function(e,t){if(void 0===t&&(t=!1),!t){if(0===e)return this;if(e===this.length())return this.next}var n=this.clone();return this.parent.insertBefore(n,this.next),this.children.forEachAt(e,this.length(),(function(e,t){var r=e.split(t);r&&n.insertBefore(r)})),n},n.unwrap=function(){for(var e,t=l(this.children);!(e=t()).done;){var n=e.value;this.parent.insertBefore(n,this.next)}this.remove()},n.insertTextAt=function(e,t){var n=this.children.get(e),r=n[0],i=n[1];if(r)r.insertTextAt(i,t);else{var o=(0,s.Cq)(h.Z.createDomNode(t));this.insertBefore(o)}},n.insertEmbedAt=function(e,t,n){var r=this.children.get(e),i=r[0],o=r[1];if(i)i.insertEmbedAt(o,t,n);else{var a=(0,s.Cq)(t,n);this.insertBefore(a)}},n.deleteAt=function(e,t){if(0===e&&t===this.length())return this.remove();this.children.forEachAt(e,t,(function(e,t,n){e.deleteAt(t,n)}))},n.format=function(e,t){t||!o()(this.getStyler().getStyles(this.domNode,[e]))?this.getStyler().setStyle(this.domNode,e,t):this.unwrap()},n.formatAt=function(e,t,n,r){var i=this.getStyler().getStyle(this.domNode,n);if(i){if(i===r)return;this.isolate(e,t).format(n,r)}else this.children.forEachAt(e,t,(function(e,t,i){e.formatAt(t,i,n,r)}))},n.getFormats=function(){return this.getStyler().getStyles(this.domNode)},n.getLeaf=function(e,n){void 0===e&&(e=0),void 0===n&&(n=!1);var r=this.children.get(e,n),i=r[0],o=r[1];return i instanceof t?i.getLeaf(o,n):[i,o]},n.getLeaves=function(e,n){void 0===e&&(e=0),void 0===n&&(n=Number.MAX_VALUE);var r=[];return this.children.forEachAt(e,n,(function(e,n,i){e instanceof a.Z?r.push(e):e instanceof t&&(r=r.concat(e.getLeaves(n,i)))})),r},n.update=function(){var e=this.mutations;if(e){var t=[],n=[];e.forEach((function(e){"childList"===e.type&&(t.push.apply(t,e.addedNodes),n.push.apply(n,e.removedNodes))})),n.forEach((function(e){var t=(0,s.n2)(e);t&&(t.domNode.parentNode||t.detach())})),t.filter((function(e){return!!e.parentNode})).sort((function(e,t){return e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINS?1:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING?-1:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?1:0})).forEach((function(e){var t;try{var n=(0,s.n2)(e.parentNode);if(!n)throw new Error("Error processing addedNodes");var r=null;e.nextSibling&&(r=(0,s.n2)(e.nextSibling));var i=(0,s.n2)(e);if(i||(i=(0,s.Cq)(e)),!i)throw new Error("Error processing addedNodes");i.next===r&&i.parent===n||n.insertBefore(i,r)}catch(o){if(u.k.error(o),"Error processing addedNodes"===o.message)return void(null===(t=e.parentNode)||void 0===t||t.removeChild(e));throw o}}))}},n.optimize=function(t){e.prototype.optimize.call(this,t);for(var n,r=l(this.children);!(n=r()).done;)n.value.optimize(t)},t}(d.Z)},60119:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(13504),i=(n(75793),n(52865),n(64425),n(38934),n(23669)),o=n(16058),s=n(82966),a=n(19910),d=function(e){function t(t){var n;return(n=e.call(this,t)||this).savedLength=0,n.textNode=document.createTextNode(i.kW),n.domNode.appendChild(n.textNode),n}(0,r.Z)(t,e),t.createDomNode=function(){return document.createElement(this.tagName)};var n=t.prototype;return n.length=function(){return this.savedLength},n.detach=function(){this.parent.children.remove(this)},n.formatCursor=function(e,t){for(var n=this,r=0;n&&!(n instanceof o.Z);)r+=n.offset(n.parent),n=n.parent;n&&(this.savedLength=1,n.formatAt(r,this.length(),e,t),this.savedLength=0)},n.getOffsetFromNativeRangePos=function(){return 0},n.restore=function(){if(this.parent){for(;this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);var e,t=this.prev instanceof a.Z?this.prev:null,n=this.next instanceof a.Z?this.next:null,r=(null===n||void 0===n?void 0:n.value())||"",o=this.textNode.data.split(i.kW).join("");if(this.textNode.data!==i.kW&&(this.textNode.data=i.kW),t)e=t,(o||n)&&(t.insertTextAt(t.length(),o+r),n&&n.remove());else if(n)e=n,n.insertTextAt(0,o);else{var s=document.createTextNode(o);e=new a.Z(s),this.parent.insertBefore(e,this)}this.remove()}},n.update=function(){var e=this,t=this.mutations;t&&t.some((function(t){return"characterData"===t.type&&t.target===e.textNode}))&&this.restore()},t}(s.Z);d.tagName="SPAN"},82966:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(13504),i=(n(52865),n(64425),n(23669)),o=n(42433),s=n(19910),a=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e),t.createDomNode=function(){return document.createElement(this.tagName)};var n=t.prototype;return n.insertBefore=function(){throw new Error("embed node cannot insert child node")},n.value=function(){return""},n.length=function(){return 1},n.getNativeRangePos=function(e){var t=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return e>0&&(t+=1),[this.parent.domNode,t]},n.getOffsetFromNativeRangePos=function(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1},n.split=function(e){return 0===e?this:this.next},n.insertTextAt=function(e,t){var n=(0,i.Cq)(s.Z.createDomNode(t)),r=this.split(e);this.parent.insertBefore(n,r)},n.wrap=function(){var e=document.createElement("span"),t=(0,i.Cq)(e);return this.parent.insertBefore(t,this.next),t.insertBefore(this),t},n.deleteAt=function(e,t){var n=this.isolate(e,t);n&&n.remove()},n.format=function(e,t){this.wrap().format(e,t)},n.formatAt=function(e,t,n,r){0===e&&t===this.length()&&this.format(n,r)},n.update=function(){},t}(o.Z);a.tagName="SPAN"},42433:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(13504),i=(n(52865),n(64425),n(23669)),o=function(e){function t(){return e.apply(this,arguments)||this}(0,r.Z)(t,e);var n=t.prototype;return n.value=function(){return""},n.insertEmbedAt=function(e,t,n){var r=(0,i.Cq)(t,n),o=this.split(e);this.parent.insertBefore(r,o)},t}(n(55269).Z)},55269:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}}),n(15770),n(38934),n(84919),n(26894),n(71091),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(38661),i=n(13504),o=(n(52865),n(64425),n(51527)),s=n(23669);function a(){a=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(D){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var i=t&&t.prototype instanceof c?t:c,o=Object.create(i.prototype),s=new y(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=T(s,n);if(a){if(a===l)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var d=u(e,t,n);if("normal"===d.type){if(r=n.done?"completed":"suspendedYield",d.arg===l)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r="completed",n.method="throw",n.arg=d.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(D){return{type:"throw",arg:D}}}e.wrap=h;var l={};function c(){}function f(){}function I(){}var g={};d(g,i,(function(){return this}));var p=Object.getPrototypeOf,m=p&&p(p(S([])));m&&m!==t&&n.call(m,i)&&(g=m);var v=I.prototype=c.prototype=Object.create(g);function R(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(i,o,s,a){var d=u(e[i],e,o);if("throw"!==d.type){var h=d.arg,l=h.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){h.value=e,s(h)}),(function(e){return r("throw",e,s,a)}))}a(d.arg)}var i;this._invoke=function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}}function T(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function S(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=I,d(v,"constructor",I),d(I,"constructor",f),f.displayName=d(I,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,d(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},R(x.prototype),d(x.prototype,o,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new x(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},R(v),d(v,s,"Generator"),d(v,i,(function(){return this})),d(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),d=n.call(o,"finallyLoc");if(a&&d){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(11425),n(48845);var u=function(){this.next=null,this.prev=null},l=function(e){function t(){this.head=null,this.tail=null,this.size=0}var n=t.prototype;return n.getHead=function(){return this.head},n.getTail=function(){return this.tail},n.getSize=function(){return this.size},n.isEmpty=function(){return 0===this.size},n.clear=function(){this.head=null,this.tail=null,this.size=0},n.get=function(e,t){void 0===t&&(t=!1);for(var n,r=0,i=d(this);!(n=i()).done;){var o=n.value,s=o.length();if(r===e||r+s>e||t&&r+s===e)return[o,e-r];r+=s}return[null,0]},n.contains=function(e){for(var t,n=d(this);!(t=n()).done;)if(t.value===e)return!0;return!1},n.unshift=function(e){this.insertBefore(e,this.head)},n.push=function(e){this.insertBefore(e)},n.insertBefore=function(e,t){return void 0===t&&(t=null),0===this.size?(this.head=e,this.tail=e,e.prev=null,e.next=null,void(this.size+=1)):null===t?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,void(this.size+=1)):(e.next=t,e.prev=t.prev,t.prev&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e),void(this.size+=1))},n.remove=function(e){this.contains(e)&&(null!=e.prev&&(e.prev.next=e.next),null!=e.next&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.size-=1)},n.reduce=function(e,t){for(var n,r=d(this);!(n=r()).done;)t=e(t,n.value);return t},n.forEachAt=function(e,t,n){if(!(t<=0))for(var r,i,o=0,s=d(this);!(i=s()).done;){var a=(r=i.value).length();if(o>=e+t)break;o>e?n(r,0,Math.min(e+t-o,r.length())):o+r.length()>e&&n(r,e-o,Math.min(t,o+r.length()-e)),o+=a}},n.iterator=function(){return this[Symbol.iterator]()},n[e]=a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=8;break}return n=t.next,e.next=5,t;case 5:t=n,e.next=1;break;case 8:case"end":return e.stop()}}),e,this)})),t}(Symbol.iterator);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){function t(t){var n;return(n=e.call(this)||this).children=new l,n.domNode=t,t[s.AF]=(0,r.Z)(n),n}(0,i.Z)(t,e);var n=t.prototype;return n.getStyler=function(){return this.root.styler},n.remove=function(){var e;null===(e=this.domNode.parentNode)||void 0===e||e.removeChild(this.domNode),this.detach()},n.detach=function(){this.parent.children.remove(this),delete this.domNode[s.AF]},n.offset=function(e){if(void 0===e&&(e=this.parent),e===this)return 0;for(var t,n=0,r=c(this.parent.children);!(t=r()).done;){var i=t.value;if(i===this)break;n+=i.length()}return n+this.parent.offset(e)},n.clone=function(){var e=this.domNode.cloneNode(!1);return new((0,o.ll)(this))(e)},n.isolate=function(e,t){var n=this.split(e);return n?(n.split(t),n):n},n.optimize=function(e){this.mutations=void 0},t}(u)},17093:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}}),n(15770),n(84919),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(58926),i=n(38661),o=n(13504),s=(n(8195),n(38934),n(31688),n(90109),n(23669)),a=n(34948),d=n(16058),h=n(70849);function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(e){function t(t,n,r,o){var s;return(s=e.call(this,t)||this).savedMutations=[],s.root=(0,i.Z)(s),s.styler=n,s.editor=r,s.emitter=o,s.startMutationObserver(),s.clean(),s}(0,o.Z)(t,e),t.createDomNode=function(){return document.createElement(this.tagName)};var n=t.prototype;return n.clean=function(){for(var e,t=u(this.children);!(e=t()).done;)e.value.remove();this.optimize()},n.remove=function(){throw new Error("root node cannot be removed")},n.insertBefore=function(t,n){if(!(t instanceof d.Z))throw new Error("root node can only insert VLine");e.prototype.insertBefore.call(this,t,n)},n.insertTextAt=function(t,n){if(0!==n.length){var r=Math.min(t,this.length()-s.s$);e.prototype.insertTextAt.call(this,r,n),this.optimize()}},n.deleteAt=function(t,n){var r=this.children.get(t),i=r[0],o=r[1],s=this.children.get(t+n)[0];if(e.prototype.deleteAt.call(this,t,n),i&&s&&i!==s&&o>0){for(var a,d=u(s.children);!(a=d()).done;){var l=a.value;l instanceof h.Z||i.insertBefore(l)}s.remove()}this.optimize()},n.formatAt=function(e,t,n,r){this.children.forEachAt(e,t,(function(e,t,i){e.formatAt(t,i,n,r)})),this.optimize()},n.sync=function(e,t){var n,i=this,o={};if(e=e||this.mutationObserver.takeRecords(),this.editor.isComposing()&&!t)return(n=this.savedMutations).push.apply(n,(0,r.Z)(e)),void this.emitter.compositionEmitter.fire(new CompositionEvent("compositionupdateend"));e=[].concat((0,r.Z)(this.savedMutations),(0,r.Z)(e)),this.savedMutations=[],0!==e.length&&(e.map((function(e){var t=(0,s.n2)(e.target,!0);return t?t.mutations?(t.mutations.push(e),null):(t.mutations=[e],t):null})).forEach((function(e){e&&e!==i&&e.update(o)})),this.mutations&&this.update(),this.emitter.viewChangeStartEmitter.fire({mutations:e,context:o}),this.optimize(o),this.emitter.viewChangeEmitter.fire({mutations:e,context:o}))},n.optimize=function(t){if(void 0===t&&(t={}),e.prototype.optimize.call(this,t),0===this.children.getSize()){var n=new d.Z(d.Z.createDomNode());this.insertBefore(n),n.optimize(t)}},n.startMutationObserver=function(){var e=this;this.mutationObserver=new MutationObserver((function(t){e.sync(t)})),this.mutationObserver.observe(this.domNode,{subtree:!0,childList:!0,attributes:!0,characterData:!0,characterDataOldValue:!0})},t}(a.Z);c.tagName="DIV"},19910:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(13504),i=(n(52865),n(64425),n(15770),n(38934),n(23669)),o=function(e){function t(n){var r;return(r=e.call(this,n)||this).text=t.getValueByNode(r.domNode),r}(0,r.Z)(t,e),t.createDomNode=function(e){return document.createTextNode(e)},t.getValueByNode=function(e){var t=e.data;return t.normalize&&(t=t.normalize()),t};var n=t.prototype;return n.insertBefore=function(){throw new Error("Text node cannot insert child node")},n.length=function(){return this.text.length},n.value=function(){return this.text},n.getNativeRangePos=function(e){return[this.domNode,e]},n.getOffsetFromNativeRangePos=function(e,t){return this.domNode===e?t:-1},n.split=function(e){if(0===e)return this;if(e>=this.length())return this.next;var n=new t(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next),this.text=t.getValueByNode(this.domNode),n},n.insertTextAt=function(e,t){0!==t.length&&(this.text=this.text.slice(0,e)+t+this.text.slice(e),this.domNode.data=this.text)},n.deleteAt=function(e,t){this.text=this.text.slice(0,e)+this.text.slice(e+t),this.domNode.data=this.text},n.formatAt=function(e,n,r,i){var o=this.isolate(e,n);o instanceof t&&o.wrap().format(r,i)},n.format=function(){},n.wrap=function(){var e=document.createElement("span"),t=(0,i.Cq)(e);return this.parent.insertBefore(t,this.next),t.insertBefore(this),t},n.update=function(){var e=this,n=this.mutations;n&&n.some((function(t){return"characterData"===t.type&&t.target===e.domNode}))&&(this.text=t.getValueByNode(this.domNode))},n.optimize=function(n){e.prototype.optimize.call(this,n),this.text=t.getValueByNode(this.domNode),0===this.text.length?this.remove():this.next instanceof t&&this.next.prev===this&&(this.insertTextAt(this.length(),this.next.value()),this.next.remove())},t}(n(42433).Z);o.tagName="text"},24591:function(e,t,n){"use strict";function r(e){if("string"!==typeof e)return e;var t,n,r,i=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return i&&4===i.length?(t=parseInt(i[1],10),n=parseInt(i[2],10),r=parseInt(i[3],10),"#"+((1<<24)+(t<<16)+(n<<8)+r).toString(16).slice(1)):e}n.d(t,{IH:function(){return i},s:function(){return r}}),n(52865),n(53923),n(77468),n(20670),n(84168),n(85932),n(15770),n(38934),/Mac/i.test(navigator.platform),new RegExp("\ufeff( )?","g");var i="data-theme-color"},32198:function(e,t,n){"use strict";n(19553),n(30980),n(38934),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144);var r=function(){function e(e){this.ctor=e,this.maxPoolSize=1e4,this.pools=new Map}var t=e.prototype;return t.createInstance=function(e){var t,n;void 0===e&&(e={});var r=(null===(n=(t=this.ctor).preHandleOptions)||void 0===n?void 0:n.call(t,e))||e,i=this.ctor.generateKey(r),o=this.pools.get(i);return o||(o=new this.ctor(r,i),this.set(i,o)),o},t.isTargetType=function(e){return e instanceof this.ctor},t.releasePools=function(){this.pools.clear()},t.set=function(e,t){this.pools.size>=this.maxPoolSize&&this.releasePools(),this.pools.set(e,t)},e}();t.Z=r},60866:function(e,t,n){"use strict";n.d(t,{F:function(){return r.Z}});var r=n(32198)},72104:function(e,t,n){"use strict";n(46396),n(93984),n(38934);var r=n(31973),i=function(){function e(e,t){this.handler=e,this.context=t.context,this.once=t.once,this.priority=t.priority}return e.prototype.isEqual=function(e){return this.handler===e.handler&&this.context===e.context&&this.once===e.once&&this.priority===e.priority},e}(),o=function(){function e(){this.events={}}var t=e.prototype;return t.on=function(e,t,n){var r=new i(t,Object.assign({context:this},n));return this.events[e]?(this.events[e].filter((function(e){return e.isEqual(r)})).length||(r.priority?this.events[e].unshift(r):this.events[e].push(r)),this):(this.events[e]=[r],this)},t.addListener=function(e,t,n){return this.on(e,t,n)},t.once=function(e,t,n){return this.on(e,t,Object.assign(Object.assign({},n),{once:!0}))},t.off=function(e,t,n){if(!e)return this.events={},this;if(!t)return this.events[e]=void 0,this;if(!this.events[e])return this;var r=new i(t,Object.assign({context:this},n));return this.events[e]=this.events[e].filter((function(e){return!e.isEqual(r)})),this},t.removeListener=function(e,t,n){return this.off(e,t,n)},t.emit=function(e){r.ZP.jank.log({moduleValue:"eventEmit",actionValue:e});var t=this.events[e];if(!t)return!1;for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var s=0;s<t.length;s++)t[s].once&&this.off(e,t[s].handler,{once:t[s].once,priority:t[s].priority,context:t[s].context}),t[s].handler.apply(t[s].context,i);return!0},t.destroy=function(){this.events={}},e}();t.Z=o},52083:function(e,t,n){"use strict";n.d(t,{ZP:function(){return d},h1:function(){return o},jQ:function(){return i},rW:function(){return s}}),n(52865),n(85932),n(38934),n(93984),n(31688),n(8195),n(85813);var r=/Mac|iPad/i.test(n.g.navigator.platform),i=r?"metaKey":"ctrlKey",o=r?"Meta":"Control",s={BACKSPACE:8,TAB:9,RETURN:13,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESCAPE:27,SPACE:32,SPACE_SAFARI:160,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,META:91,META_LEFT:91,META_RIGHT:93,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,SEMICOLON_FIREFOX:59,EQUAL:187,EQUAL_FIREFOX:61,COMMA:188,MINUS:189,MINUS_FIREFOX:173,PERIOD:190,SLASH:191,BACK_QUOTE:192,LEFT_BRACKETS:219,BACKSLASH:220,RIGHT_BRACKETS:221,QUOTE:222},a={DIGIT0:48,DIGIT9:57},d=function(){function e(e){this.options=e,this.bindings={},this.onKeyDown=this.onKeyDown.bind(this),this.listen();var t=e.bindings;t&&(Array.isArray(t)?this.addBindings(t):this.addBinding(t))}e.match=function(t,n){if(!n.ignore&&["altKey","ctrlKey","metaKey","shiftKey"].some((function(e){return!!n[e]!==t[e]})))return!1;var r=e.getKeyCodeByEvent(t);return n.key===r||n.key===t.key},e.isEqual=function(e,t){return["altKey","ctrlKey","metaKey","shiftKey","ignore"].every((function(n){return e[n]===t[n]}))},e.normalize=function(t){var n=t;if("string"===typeof n.key){var r=n.key.toUpperCase();e.isCommonChar(r)&&(n.key=r.charCodeAt(0))}return n.shortKey&&(n[i]=n.shortKey,n.shortKey=void 0),n},e.isCommonChar=function(e){return void 0===e&&(e=""),1===e.length&&(e<="9"&&e>="0"||e<="Z"&&e>="A"||e<="z"&&e>="a"||" "===e)},e.getKeyCodeByEvent=function(t){var n,r=t.which||t.keyCode,i=null===(n=null===t||void 0===t?void 0:t.code)||void 0===n?void 0:n.toUpperCase();return 229===r&&e.isCommonChar(t.key)?r=t.key.toUpperCase().charCodeAt(0):229===r&&i in a&&(r=a[i]),r};var t=e.prototype;return t.addBinding=function(t){var n=e.normalize(t),r=n.key;this.bindings[r]=this.bindings[r]||[],t.override&&(this.bindings[r]=this.bindings[r].filter((function(t){return!e.isEqual(t,n)}))),n.priority?this.bindings[r].unshift(n):this.bindings[r].push(n)},t.addBindings=function(e){var t=this;Array.isArray(e)&&e.forEach((function(e){t.addBinding(e)}))},t.removeBinding=function(t){var n=e.normalize(t),r=n.key,i=this.bindings[r];i&&i.length&&(this.bindings[r]=i.filter((function(e){return!(n.key===e.key&&n.handler===e.handler&&n.metaKey===e.metaKey&&n.ctrlKey===e.ctrlKey&&n.shiftKey===e.shiftKey&&n.priority===e.priority)})))},t.removeBindings=function(e){var t=this;Array.isArray(e)&&e.forEach((function(e){t.removeBinding(e)}))},t.destroy=function(){this.bindings={},this.options.root.removeEventListener("keydown",this.onKeyDown)},t.listen=function(){this.options.root.addEventListener("keydown",this.onKeyDown)},t.onKeyDown=function(t){var n,r,i=this;if(!(null===(r=(n=this.options).shouldDisable)||void 0===r?void 0:r.call(n))){var o=e.getKeyCodeByEvent(t),s=(this.bindings[t.key]||[]).concat(this.bindings[o]||[]).filter((function(n){return e.match(t,n)}));0!==s.length&&s.some((function(e){return!1===e.handler.call(i,t,e)}))&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation())}},e}();d.KEYS=s},96896:function(e,t,n){"use strict";n.d(t,{L:function(){return o}});var r=n(76138),i=function(){function e(e,t,n,i){(0,r.wi)(this),this._node=e,this._type=t,this._handler=n,this._options=i||!1,this._node.addEventListener(this._type,this._handler,this._options),this.disposableId=t+" DOMListener"}return e.prototype.dispose=function(){(0,r.jz)(this),this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)},e}();function o(e,t,n,r){return new i(e,t,n,r)}},51057:function(e,t,n){"use strict";n.d(t,{Q:function(){return c},j:function(){return l}}),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(85952);function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(D){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var i=t&&t.prototype instanceof c?t:c,o=Object.create(i.prototype),s=new y(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=T(s,n);if(a){if(a===l)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var d=u(e,t,n);if("normal"===d.type){if(r=n.done?"completed":"suspendedYield",d.arg===l)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r="completed",n.method="throw",n.arg=d.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(D){return{type:"throw",arg:D}}}e.wrap=h;var l={};function c(){}function f(){}function I(){}var g={};d(g,o,(function(){return this}));var p=Object.getPrototypeOf,m=p&&p(p(S([])));m&&m!==t&&n.call(m,o)&&(g=m);var v=I.prototype=c.prototype=Object.create(g);function R(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(i,o,s,a){var d=u(e[i],e,o);if("throw"!==d.type){var h=d.arg,l=h.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){h.value=e,s(h)}),(function(e){return r("throw",e,s,a)}))}a(d.arg)}var i;this._invoke=function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}}function T(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function y(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=I,d(v,"constructor",I),d(I,"constructor",f),f.displayName=d(I,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,d(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},R(x.prototype),d(x.prototype,s,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new x(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},R(v),d(v,a,"Generator"),d(v,o,(function(){return this})),d(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,y.prototype={constructor:y,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),d=n.call(o,"finallyLoc");if(a&&d){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;w(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}n(84919),n(15770),n(38934),n(31688),n(48845),n(31575),n(5570),n(64656),n(43125),n(27849),n(11425);var o=function e(t){this.element=t,this.next=e.Undefined,this.prev=e.Undefined};o.Undefined=new o(void 0);var s=function(e){function t(){this._first=o.Undefined,this._last=o.Undefined,this._size=0}var n=t.prototype;return n.isEmpty=function(){return this._first===o.Undefined},n.clear=function(){this._first=o.Undefined,this._last=o.Undefined,this._size=0},n.unshift=function(e){return this._insert(e,!1)},n.push=function(e){return this._insert(e,!0)},n.shift=function(){if(this._first!==o.Undefined){var e=this._first.element;return this._remove(this._first),e}},n.pop=function(){if(this._last!==o.Undefined){var e=this._last.element;return this._remove(this._last),e}},n[e]=i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._first;case 1:if(t===o.Undefined){e.next=7;break}return e.next=4,t.element;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)})),n.toArray=function(){for(var e=[],t=this._first;t!==o.Undefined;t=t.next)e.push(t.element);return e},n._insert=function(e,t){var n=this,r=new o(e);if(this._first===o.Undefined)this._first=r,this._last=r;else if(t){var i=this._last;this._last=r,r.prev=i,i.next=r}else{var s=this._first;this._first=r,r.next=s,s.prev=r}this._size+=1;var a=!1;return function(){a||(a=!0,n._remove(r))}},n._remove=function(e){if(e.prev!==o.Undefined&&e.next!==o.Undefined){var t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===o.Undefined&&e.next===o.Undefined?(this._first=o.Undefined,this._last=o.Undefined):e.next===o.Undefined?(this._last=this._last.prev,this._last.next=o.Undefined):e.prev===o.Undefined&&(this._first=this._first.next,this._first.prev=o.Undefined);this._size-=1},(0,r.Z)(t,[{key:"size",get:function(){return this._size}}]),t}(Symbol.iterator),a=n(76138),d=n(31973);function h(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l,c=function(){function e(e){this._disposed=!1,this._options=e}var t=e.prototype;return t.fire=function(e){var t;if((null===(t=this._options)||void 0===t?void 0:t.name)&&d.ZP.jank.log({moduleValue:"emitter",actionValue:this._options.name}),this._listeners){this._deliveryQueue||(this._deliveryQueue=new s);for(var n,r=h(this._listeners);!(n=r()).done;){var i=n.value;this._deliveryQueue.push([i,e])}for(;this._deliveryQueue.size>0;){var o=this._deliveryQueue.shift(),a=o[0],u=o[1];try{"function"===typeof a?a.call(void 0,u):a[0].call(a[1],u)}catch(l){console.error(l)}}}},t.dispose=function(){this._listeners&&this._listeners.clear(),this._deliveryQueue&&this._deliveryQueue.clear(),this._disposed=!0},(0,r.Z)(e,[{key:"event",get:function(){var e=this;return this._event||(this._event=function(t,n,r){var i,o,d;e._listeners||(e._listeners=new s);var h=e._listeners.isEmpty();h&&(null===(i=e._options)||void 0===i?void 0:i.onFirstListenerAdd)&&e._options.onFirstListenerAdd(e);var u=e._listeners.push(n?[t,n]:t);h&&(null===(o=e._options)||void 0===o?void 0:o.onFirstListenerDidAdd)&&e._options.onFirstListenerDidAdd(e),(null===(d=e._options)||void 0===d?void 0:d.onListenerDidAdd)&&e._options.onListenerDidAdd(e,t,n);var l={dispose:function(){var t;e._disposed||(u(),(null===(t=e._options)||void 0===t?void 0:t.onLastListenerRemove)&&(e._listeners&&!e._listeners.isEmpty()||e._options.onLastListenerRemove(e))),(0,a.jz)(l)},disposableId:"event"};return Array.isArray(r)&&r.push(l),(0,a.wi)(l),l}),this._event}}]),e}();!function(e){function t(e){return function(t,n,r){void 0===n&&(n=null);var i=!1,o=e((function(e){if(!i)return o?o.dispose():i=!0,t.call(n,e)}),null,r);return i&&o.dispose(),o}}e.once=t,e.signal=function(e){return e},e.buffer=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=[]);var r=n.slice(),i=e((function(e){r?r.push(e):s.fire(e)})),o=function(){r&&r.forEach((function(e){return s.fire(e)})),r=null},s=new c({onFirstListenerAdd:function(){i||(i=e((function(e){return s.fire(e)})))},onFirstListenerDidAdd:function(){r&&(t?setTimeout(o):o())},onLastListenerRemove:function(){i&&i.dispose(),i=null}});return s.event},e.fromPromise=function(e){var t=new c,n=!1;return e.then(void 0,(function(){return null})).then((function(){n?t.fire(void 0):setTimeout((function(){return t.fire(void 0)}),0)})),n=!0,t.event},e.toPromise=function(e){return new Promise((function(n){return t(e)(n)}))}}(l||(l={}))},85813:function(e,t,n){"object"!==typeof n.g&&(Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.global=__magic__,Object.prototype.__magic__=void 0)},28280:function(e,t,n){"use strict";n.d(t,{Q5:function(){return i.Q},ju:function(){return i.j},vp:function(){return r.Z}}),n(85813),n(52083);var r=n(72104),i=n(51057)},43386:function(e,t,n){"use strict";n.d(t,{Df:function(){return a},Hx:function(){return d},KS:function(){return o},kV:function(){return h}}),n(12024),n(81502);var r,i,o,s=n(11376);function a(e){return[o.YEAR_MONTH_DAY,o.YEAR_MONTH,o.MONTH_DAY].includes(e)}!function(e){e[e.YEAR_MONTH_DAY=1]="YEAR_MONTH_DAY",e[e.YEAR_MONTH=2]="YEAR_MONTH",e[e.MONTH_DAY=3]="MONTH_DAY",e[e.DATE_TIME=4]="DATE_TIME",e[e.HOUR_MINUTE=5]="HOUR_MINUTE"}(o||(o={}));var d=((r={})[o.YEAR_MONTH_DAY]=s.ZP.t('yyyy"年"m"月"d"日";@'),r[o.YEAR_MONTH]=s.ZP.t('yyyy"年"m"月";@'),r[o.MONTH_DAY]=s.ZP.t('m"月"d"日";@'),r[o.DATE_TIME]="yyyy/m/d h:mm;@",r[o.HOUR_MINUTE]="h:mm;@",r),h=((i={})[o.YEAR_MONTH_DAY]=s.ZP.t("YYYY年M月D日"),i[o.YEAR_MONTH]=s.ZP.t("YYYY年M月"),i[o.MONTH_DAY]=s.ZP.t("M月D日"),i[o.DATE_TIME]="YYYY/M/D H:mm",i[o.HOUR_MINUTE]="H:mm",i)},61861:function(e,t,n){"use strict";n.d(t,{Z:function(){return r},c:function(){return o}});var r,i=n(11376);!function(e){e[e.CUSTOM=1]="CUSTOM",e[e.SEX=2]="SEX",e[e.EDUCATION=3]="EDUCATION",e[e.YES_NO=4]="YES_NO",e[e.PRIORITY=5]="PRIORITY",e[e.PROJECT_STATUS=6]="PROJECT_STATUS",e[e.CLOTHING_SIZE=7]="CLOTHING_SIZE"}(r||(r={}));var o={SEX:[{text:i.ZP.t("男"),bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:i.ZP.t("女"),bgColor:"#ea2f2f29",textColor:"#ea2f2f"}],EDUCATION:[{text:i.ZP.t("初中"),bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:i.ZP.t("高中"),bgColor:"#19bd8f29",textColor:"#19bd8f"},{text:i.ZP.t("大专"),bgColor:"#7c5ed829",textColor:"#7c5ed8"},{text:i.ZP.t("本科"),bgColor:"#e85bbe29",textColor:"#e85bbe"},{text:i.ZP.t("研究生"),bgColor:"#f36f3929",textColor:"#f36f39"},{text:i.ZP.t("博士"),bgColor:"#ea2f2f29",textColor:"#ea2f2f"}],YES_NO:[{text:i.ZP.t("是"),bgColor:"#19bd8f29",textColor:"#19bd8f"},{text:i.ZP.t("否"),bgColor:"#ea2f2f29",textColor:"#ea2f2f"}],PRIORITY:[{text:"P0",bgColor:"#ea2f2f29",textColor:"#ea2f2f"},{text:"P1",bgColor:"#f36f3929",textColor:"#f36f39"},{text:"P2",bgColor:"#02b1ff29",textColor:"#02b1ff"}],PROJECT_STATUS:[{text:i.ZP.t("待启动"),bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:i.ZP.t("进行中"),bgColor:"#f36f3929",textColor:"#f36f39"},{text:i.ZP.t("已完成"),bgColor:"#19bd8f29",textColor:"#19bd8f"}],CLOTHING_SIZE:[{text:"XS",bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:"S",bgColor:"#19bd8f29",textColor:"#19bd8f"},{text:"M",bgColor:"#7c5ed829",textColor:"#7c5ed8"},{text:"L",bgColor:"#e85bbe29",textColor:"#e85bbe"},{text:"XL",bgColor:"#f36f3929",textColor:"#f36f39"},{text:"2XL",bgColor:"#ea2f2f29",textColor:"#ea2f2f"},{text:"3XL",bgColor:"#f02f4f29",textColor:"#f02f4f"}]}},53426:function(e,t,n){"use strict";n.d(t,{S2:function(){return f},lz:function(){return h},nH:function(){return c},qz:function(){return u}}),n(26894),n(71091),n(19553),n(38934),n(81144),n(52865),n(64425),n(62883),n(71096),n(93984),n(15770),n(84919),n(13857),n(54371),n(95019);var r=n(89577),i=n(54500),o=n(99772),s=n(10531);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t,n,i){if(!l(e,t))return!1;for(var o,d=t.getBasicFilter().range,h=e.getSheetId(),u=!1,c=a(i);!(o=c()).done;){var f=o.value,I=f.index,g=f.amount;if(n===s.DIMENSION_TYPE.ROWS){var p=new r.Z(h,I,I+g-1,0,e.getColCount()-1);u=d.isCross(p)}if(n===s.DIMENSION_TYPE.COLUMNS){var m=new r.Z(h,0,e.getRowCount()-1,I,I+g-1);u=d.isCross(m)}if(u)return u}return u}function u(e,t,n,i,o){if(!l(e,t))return!1;for(var d,h=t.getBasicFilter().range,u=e.getSheetId(),c=!1,f=0,I=a(i);!(d=I()).done;){var g=d.value,p=g.startIndex,m=g.endIndex;if(f+=m-p+1,n===s.DIMENSION_TYPE.ROWS){var v=new r.Z(u,p,m,0,e.getColCount()-1);c=h.isCross(v)}if(n===s.DIMENSION_TYPE.COLUMNS){var R=new r.Z(u,0,e.getRowCount()-1,p,m);c=h.isCross(R)}}if(c)return c;if(n===s.DIMENSION_TYPE.ROWS){var x=new r.Z(u,o,o+f-1,0,e.getColCount()-1);c=h.isCross(x)}if(n===s.DIMENSION_TYPE.COLUMNS){var T=new r.Z(u,0,e.getRowCount()-1,o,o+f-1);c=h.isCross(T)}return c}function l(e,t){if(!e||!t)return!1;var n=t.getBasicFilter();return!!n&&!!n.sortSpecs.length}function c(e){for(var t=[],n=e.getBasicFilter(),r=e.getFilterView2SheetMap(),s={},a=0,d=Array.from(r.entries());a<d.length;a++){var h=d[a],u=h[0],l=h[1],c=u.split("_")[0];s[l.rowIndex]={from:l.rowIndex,to:Number(c)}}return t.push(new i.Z({sheetId:e.sheetId,range:n.range,operation:{queue:Object.keys(s),rules:s}})),t.push(new o.ZP({sheetId:e.sheetId,filterViewId:e.filterViewId,workbookRangeId:n.workbookRangeId,updateType:o.Qn.UPDATE,delta:{defaultFilterId:n.workbookRangeId},sortSpecs:[]})),t}function f(e,t,n,i){var o=t.sheetId,d=t.startIndex,h=function(e,t,n){var i=t.sheetId,o=t.startIndex,a=t.endIndex,d=e.getRowCount()-1,h=e.getColCount()-1;return n===s.DIMENSION_TYPE.ROWS?new r.Z(i,o,a,0,h):new r.Z(i,0,d,o,a)}(e,t,i),u=function(e,t){var n=[];return e.mergeManager.each((function(e){t.contain(e)&&n.push(e)})),n}(e,h);if(!u.length)return!1;for(var l,c=e.getAllBasicFilter(),f=!1,I=function(){var e=l.value,t=e.range.clone(),a=t.startColIndex,c=t.endColIndex,I=t.startRowIndex,g=t.endRowIndex;if(function(e){var t=e.filter,n=e.type,r=e.beforeRangeTop,i=e.beforeRangeBottom,o=e.beforeRangeLeft,a=e.beforeRangeRight,d=!t.filterViewReference||!t.sortSpecs.length;return n===s.DIMENSION_TYPE.ROWS&&r===i||n===s.DIMENSION_TYPE.COLUMNS&&o===a||d}({filter:e,type:i,beforeRangeTop:I,beforeRangeBottom:g,beforeRangeLeft:a,beforeRangeRight:c}))return"continue";i===s.DIMENSION_TYPE.ROWS&&n>I&&n<=g?(t.insertDimension({sheetId:o,type:i,index:n,amount:h.getRowCount()}),f=u.some((function(e){var i=e.sheetId,o=e.startColIndex,s=e.endColIndex,a=e.startRowIndex,h=e.endRowIndex,u=n-d,l=new r.Z(i,a+u,h+u,o,s);return t.contain(l)||t.isCross(l)}))):i===s.DIMENSION_TYPE.COLUMNS&&n>a&&n<=c&&(t.insertDimension({sheetId:o,type:i,index:n,amount:h.getColCount()}),f=u.some((function(e){var i=e.sheetId,o=e.startColIndex,s=e.endColIndex,a=e.startRowIndex,h=e.endRowIndex,u=n-d,l=new r.Z(i,a,h,o+u,s+u);return t.contain(l)||t.isCross(l)})))},g=a(c);!(l=g()).done;)I();return f}},20875:function(e,t,n){"use strict";n.d(t,{o:function(){return a}}),n(15770),n(38934),n(84919),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(11376),i=n(27571);function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,s){if(!function(e,t,n,r){var o=e.activeSheet;if(!o)return!1;var s=o.filterViewManager.getActiveFilterView(),a=r.getFormula();if(!s||!a)return!1;var d=s.getBasicFilter();if(!d||!d.sortSpecs.length)return!1;var h=o.getSheetId(),u=new i.GridRange(h,t,t,n,n);return!!d.range.isCross(u)}(e,t,n,s))return null;for(var a,d=s.getFormula().getAllCellRangeWithFixedInfo(),h=e.activeSheet,u=h.getSheetId(),l=h.filterViewManager.getActiveFilterView().getBasicFilter(),c=o(d);!(a=c()).done;){var f=a.value,I=f.getAbsoluteStartRow(t),g=f.getAbsoluteEndRow(t),p=f.getAbsoluteStartCol(n),m=f.getAbsoluteEndCol(n),v=f.isStartRowRelative||f.isEndRowRelative||f.isStartColRelative||f.isEndColRelative,R=new i.GridRange(u,I,g,p,m);if(v&&!l.range.isCross(R))return{title:r.ZP.t("提示"),message:r.ZP.t("排序后, 函数引用位置会随相对位置变化")}}return null}},63665:function(e,t,n){"use strict";n.d(t,{N2:function(){return h},e6:function(){return i},gj:function(){return o}}),n(38934),n(31688),n(46396);var r=n(89577);function i(e,t){var n=t.filterViewManager.getActiveFilterView(),r=t.getSheetId();if(!n)return e;var i=s(e,t,0,!0),o=i.isNeedTransform,a=i.dividedGridRanges,h=i.cellsValidArray;return o?d(a,h,r):e}function o(e,t){var n=t.filterViewManager.getActiveFilterView(),r=t.getSheetId();if(!n)return e;var i=s(e,t,0,!1),o=i.isNeedTransform,a=i.dividedGridRanges,h=i.cellsValidArray;return o?d(a,h,r):e}function s(e,t,n,r){var i=!1,o=[],s=[];return e.forEach((function(e){if(e.isSheet)return o.push(e);for(var n=e.clampToSheetSize(t),a=n.startRowIndex,d=n.startColIndex,h=n.endRowIndex,u=n.endColIndex,l=a;l<=h;l+=1)for(var c=d;c<=u;c+=1){var f=void 0,I=void 0;if(r){var g=t.transformCoordFromFilterViewToSheet(l,c);f=g.row,I=g.col}else{var p=t.transformCoordFromSheetToFilterView(l,c);f=p.row,I=p.col}s[f]||(s[f]=[]),s[f][I]=!0,f===l&&I===c||(i=!0)}})),{isNeedTransform:i,dividedGridRanges:o,cellsValidArray:s}}function a(e){var t=e.isValid,n=e.startRow,r=e.rowIndex,i=e.startCol,o=e.colIndex;return t?{startCol:-1!==i?i:o,endCol:o,startRow:-1!==n?n:r,endRow:r}:{startCol:i,endCol:Math.max(i,o-1),startRow:n,endRow:Math.max(n,r-1)}}var d=function(e,t,n){for(var i=0;i<t.length;i++){var o=t[i],s=-1,d=-1,h=-1,u=-1;if(o)for(var l=o.length,c=0;c<o.length;c++){var f=o[c],I=l===c+1,g=a({isValid:f,startRow:s,rowIndex:i,startCol:h,colIndex:c});if(h=g.startCol,u=g.endCol,s=g.startRow,d=g.endRow,(!f||I)&&-1!==s&&-1!==d&&-1!==h&&-1!==u){for(var p=s+1,m=function(e,n,r){for(var i,o=n;o<=r;o+=1)if(!(null===(i=t[e])||void 0===i?void 0:i[o]))return!1;return!0};m(p,h,u);)p+=1;d=Math.max(0,p-1),e.push(new r.Z(n,s,d,h,u)),function(e,n,r,i){for(var o=e;o<=n&&t[o];o++)for(var s=r;s<=i;s++)t[o]&&(t[o][s]=!1)}(s,d,h,u),s=-1,d=-1,h=-1,u=-1}}}return e},h=function(e,t,n){var o=n.filterViewManager.getActiveFilterView(),s=n.getSheetId();if(!o)return[{deltas:e,gridRange:t}];var a=i([t],n),d=[];return a.forEach((function(t){var n=[];e.forEach((function(e){var i=o.getDataPositionByFilterViewPosition(e.rowIndex,e.colIndex),a=i.row,d=i.col;t.contain(new r.Z(s,a,a,d,d))&&n.push(Object.assign(Object.assign({},e),{rowIndex:a,colIndex:d}))})),d.push({gridRange:t,deltas:n})})),d}},83810:function(e,t,n){"use strict";n.d(t,{J:function(){return h},U:function(){return d}}),n(38934),n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(15770),n(84919),n(26894),n(52865),n(13857),n(54371),n(95019);var r=n(11376),i=n(27571),o=n(48885);function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=function(e){var t=e.getFilterViewsInSheet();if(!t.length)return!1;for(var n,r=s(t);!(n=r()).done;){var i=n.value.getBasicFilter();if(i&&i.sortSpecs.length)return!0}return!1};function h(e,t,n){if(!t.length||!d(e))return null;for(var a,h=function(){var e=a.value;if(!e.filterViewReference||!e.sortSpecs.length)return"continue";var s=e.range;if(t.some((function(e){return new i.GridRange(e).isCross(s)}))){var d=new Map([[o.Z.PASTE_DATA_REQUEST,r.ZP.t("粘贴内容失败，合并单元格与现有筛选排序有交集")],[o.Z.AUTO_FILL_REQUEST,r.ZP.t("智能填充失败，合并单元格与现有筛选排序有交集")],[o.Z.DELETE_RANGE_REQUEST,r.ZP.t("删除单元格失败，合并单元格与现有筛选排序有交集")],[o.Z.INSERT_RANGE_REQUEST,r.ZP.t("插入单元格失败，合并单元格与现有筛选排序有交集")],[o.Z.MOVE_RANGE_REQUEST,r.ZP.t("移动单元格失败，合并单元格与现有筛选排序有交集")]]);return{v:{isWarningOnly:!1,error:{title:r.ZP.t("出现问题"),content:d.get(n)}}}}},u=s(e.getAllBasicFilter());!(a=u()).done;){var l=h();if("continue"!==l&&"object"===typeof l)return l.v}return null}},29056:function(e,t,n){"use strict";n.d(t,{J:function(){return o},z:function(){return i}}),n(38934),n(31688);var r=n(65749);function i(e,t){var n=e.activeSheet.getFilterViewsInSheet(),r=[];return n.forEach((function(e){var n,i,o=null===(n=e.getBasicFilter())||void 0===n?void 0:n.range,s=null===(i=e.getBasicFilter())||void 0===i?void 0:i.sortSpecs;s&&s.length>0&&(null===o||void 0===o?void 0:o.isCross(t))&&r.push(e.getFilterViewName())})),r}var o=function(e){var t,n=e.activeSheetId,i=(0,r.xJ)(e),o=[];if(!i)return o.length>0;var s=null===(t=e.activeSheet.getBasicFilter())||void 0===t?void 0:t.range;return s?(e.workbookRangeManager.protectedRangeMap.forEach((function(e){if(e.range.sheetId===n){var t=e.range.clone();t.isCross(s)&&o.push(t)}})),o.length>0):o.length>0}},60467:function(e,t,n){"use strict";n.d(t,{NP:function(){return u},Zf:function(){return c},cL:function(){return f},l9:function(){return l}}),n(19553),n(38934),n(81144);var r=n(11376),i=n(66176),o=n(22685),s=n(14831),a=n.n(s),d=n(47627);if(6042==n.j)var h=n(1839);var u="NONE_OPTION_KEY";function l(e){var t=[],n=e.conditionType,r=e.inputOne,i=e.inputTwo;return r&&t.push(new d.ConditionValue({type:d.ARG_TOKEN_TYPE.VALUE_TOKEN,userEnteredValue:r})),i&&t.push(new d.ConditionValue({type:d.ARG_TOKEN_TYPE.VALUE_TOKEN,userEnteredValue:i})),new d.BooleanCondition({type:n,values:t})}function c(e){var t,n,r,i=e.type,o=e.values;return(null===(t=h.Z[i])||void 0===t?void 0:t.hasInputOne())?{conditionType:i,inputOne:(null===(n=o[0])||void 0===n?void 0:n.userEnteredValue)||"",inputTwo:(null===(r=o[1])||void 0===r?void 0:r.userEnteredValue)||null}:{conditionType:i,inputOne:null,inputTwo:null}}function f(e){var t=e.inputOne,n=e.inputTwo,s=e.conditionType;if(s===u)return!0;var d=h.Z[s].checkInputValid(t,n);return!d||(a().isMobilePhone?o.default.show({type:"error",message:d,duration:3e3}):i.default.confirm({title:r.ZP.t("条件筛选提示"),className:"conditiona-filter-error-dialog",content:d}),!1)}},8045:function(e,t,n){"use strict";n.d(t,{Gu:function(){return s},ic:function(){return o}});var r=n(36395),i=n(48943);function o(e,t){if(!t||!t.getHiddenRows().length)return e;for(var n=[],o=t.getHiddenRows(),s=0;s<e.length;s++){var a=e[s];if(a.dimension!==i.Z.COLUMNS){for(var d=a.startIndex,h=a.endIndex,u=0;u<o.length;u++){var l=o[u];if(d<=l&&h>=l&&(d<l&&n.push(new r.Z(a.sheetId,d,l-1,a.dimension)),(d=l+1)>h))break}d<=h&&n.push(new r.Z(a.sheetId,d,h,a.dimension))}else n.push(a)}return n}function s(e,t){var n,i,o=[];for(n=0;n<e.length;n++){var s=e[n],a=null;for(i=s.startIndex;i<=s.endIndex;i++)t[i]&&t[i].hiddenByUser?null===a&&(a=i):null!==a&&(o.push(new r.Z(s.sheetId,a,i-1,s.dimension)),a=null);null!==a&&o.push(new r.Z(s.sheetId,a,i-1,s.dimension))}return o}},76213:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var r=n(61424),i=n(28086);function o(e,t,n){if(t=t||(0,r.getDefaultNumberFormat)(),e&&e.type===i.Z.NUMBER){var o=e.value,s=t.pattern||"";n>0?(s=(0,r.increaseDecimalFormat)(o,s),t=(0,r.getNumberFormatByFormatCode)(s)):n<0&&(s=(0,r.decreaseDecimalFormat)(o,s),t=(0,r.getNumberFormatByFormatCode)(s))}return t}},85249:function(e,t,n){"use strict";var r=n(31973),i=n(11557),o=n(26178),s=n(61502),a=n(31160),d=n(80067),h=n(38808),u=n(71217),l=n(20445),c=function(){function e(e,t){void 0===t&&(t={}),this.id=e,this.version=(0,d.hj)(t.requestId)?t.version:a.Z.MUTATION_VER,this.requestId=(0,d.hj)(t.requestId)?t.requestId:-1,this.operationType=(0,d.hj)(t.operationType)?t.operationType:u.Z.LOCAL}var t=e.prototype;return t.setAffectedSheetId=function(e){},t.runOnWorkbook=function(e){},t.runOnFormulaModel=function(e){},t.checkSheetId=function(e){var t=this.getAffectedSheetId();if(t){var n=e.getSheetId()===t,r=n?void 0:"SheetId 不一致 "+e.getSheetId()+" != "+t;return n||this.runOnFormulaLayer(e),{isValid:n,errorMessage:r}}return{isValid:!0}},t.runOnFormulaLayer=function(e){},t.check=function(e){return{isValid:!0}},t.isMultiSheetMutation=function(){return!1},t.getAffectedGridRanges=function(){return[]},t.getSizeEstimate=function(){return 1},t.isNonPersistedLocalChange=function(){return!1},t.shouldSyncToWorker=function(){return!0},t.run=function(e,t){var n,r=[],i={isValid:!0};if(e instanceof o.Spreadsheet.Spreadsheet){this.checkAndRunOnWorkbook(e,t)&&(n=this.getAffectedSheetId());var s,a,d,h=this.getAffectedSheets(e);for(a=0,d=h.length;a<d&&(s=h[a],(i=this.checkAndRunOnSheet(s,t)).isValid);a++)r.push([s,t]);this.checkAndRunOnFormulaModel(e)}else i=this.checkAndRunOnSheet(e,t),r.push([e,t]);return{runResult:i,runCache:r,workbookWithSheetId:n,isMultiSheet:!1}},t.checkAndRunOnSheet=function(e,t){var o,a,d,u,c,f,I,g;if(!(e instanceof i.Z))return{isValid:!1,errorMessage:"sheet类型不是Model.Spreadsheet.Spreadsheet"};new Date;var p={isValid:!1,errorMessage:"默认错误"},m=!1;try{p=this.check(e)}catch(v){null===(o=n.g.log)||void 0===o||o.error("mutation",this,v),r.ZP.run(s.mz.CHECK_MUTATION_ERROR,this,v,p)}if(!(p=p.isValid?this.checkSheetId(e):p).isValid&&!t.ignoreCheck)return r.ZP.run(s.mz.CHECK_MUTATION_RESULT_ERROR,this,p),r.ZP.zzsStatus({attrid:l.CORE_LINK_ZZS_POINTER.MUTATION_APPLY_TO_MODEL_ERROR,status:1,dimensions:t.isOffline?"offlineMsg":"onlineMsg"}),r.ZP.opentelemetry({name:s.mz.RUN_MUTATION_ERROR,message:p,dimension:{operationType:this.operationType,isFromFormula:t.isFromFormula,baseVersion:null===(a=SpreadsheetApp.messageCenter)||void 0===a?void 0:a.versionManager.getCurrentVersion()}}),[h.ZP.SET_CELL_PROPERTIES_MUTATION,h.ZP.SET_RANGE_MUTATION].indexOf(this.id)>-1&&(null===(u=null===(d=n.g.log)||void 0===d?void 0:d.report)||void 0===u||u.call(d,s.mz.CHECK_MUTATION_RESULT_ERROR)),p;try{this.runOnSheet(e)}catch(v){null===(c=n.g.log)||void 0===c||c.error("mutation","run mutation error",this.id,this.requestId,v),r.ZP.run(s.mz.RUN_MUTATION_ERROR,v,this),v.message&&0===v.message.indexOf("ApiCheckError")||(m=!0),r.ZP.zzsStatus({attrid:l.CORE_LINK_ZZS_POINTER.MUTATION_APPLY_TO_MODEL_ERROR,status:1,dimensions:t.isOffline?"offlineMsg":"onlineMsg"}),r.ZP.opentelemetry({name:s.mz.RUN_MUTATION_ERROR,message:v.message,dimension:{operationType:this.operationType,isFromFormula:t.isFromFormula,baseVersion:null===(f=SpreadsheetApp.messageCenter)||void 0===f?void 0:f.versionManager.getCurrentVersion()}}),null===(g=null===(I=n.g.log)||void 0===I?void 0:I.report)||void 0===g||g.call(I,s.mz.RUN_MUTATION_ERROR)}return{isValid:!m,errorMessage:m?"有遇到mutation运行错误":void 0}},t.checkAndRunOnWorkbook=function(e,t){return this.runOnWorkbook(e)},t.checkAndRunOnFormulaModel=function(e){return this.runOnFormulaModel(e)},t.transform=function(e,t){var n,r=((n={})[h.ZP.INSERT_DIMENSION_MUTATION]="transformWithInsertDimensionMutation",n[h.ZP.DELETE_DIMENSION_MUTATION]="transformWithDeleteDimensionMutation",n[h.ZP.SET_DIMENSION_PROPERTIES_MUTATION]="transformWithSetDimensionPropertiesMutation",n[h.ZP.SET_RANGE_MUTATION]="transformWithSetRangeMutation",n[h.ZP.SET_CELL_PROPERTIES_MUTATION]="transformWithSetCellPropertiesMutation",n[h.ZP.MERGE_CELLS_MUTATION]="transformWithMergeCellsMutation",n[h.ZP.UNMERGE_CELLS_MUTATION]="transformWithUnmergeCellsMutation",n[h.ZP.DEFINE_FILTER_MUTATION]="transformWithDefineFilterMutation",n[h.ZP.DELETE_FILTER_MUTATION]="transformWithDeleteFilterMutation",n[h.ZP.UPDATE_FILTER_MUTATION]="transformWithUpdateFilterMutation",n[h.ZP.SWITCH_FILTER_SYNC_MUTATION]="transformWithSwitchFilterSyncMutation",n[h.ZP.ADD_EMBEDDED_OBJECT_MUTATION]="transformWithAddEmbeddedObjectMutation",n[h.ZP.DELETE_EMBEDDED_OBJECT_MUTATION]="transformWithDeleteEmbeddedObjectMutation",n[h.ZP.UPDATE_EMBEDDED_OBJECT_MUTATION]="transformWithUpdateEmbeddedObjectMutation",n[h.ZP.INSERT_SHEET_MUTATION]="transformWithInsertSheetMutation",n[h.ZP.DELETE_SHEET_MUTATION]="transformWithDeleteSheetMutation",n[h.ZP.MOVE_SHEET_MUTATION]="transformWithMoveSheetMutation",n[h.ZP.SET_SHEET_PROPERTIES_MUTATION]="transformWithSetSheetPropertiesMutation",n[h.ZP.UPDATE_ALL_SHEETS_MUTATION]="transformWithUpdateAllSheetsMutation",n[h.ZP.DEFINE_SHEET_RANGE_MUTATION]="transformWithDefineSheetRangeMutation",n[h.ZP.DELETE_SHEET_RANGE_MUTATION]="transformWithDeleteSheetRangeMutation",n[h.ZP.UPDATE_SHEET_RANGE_MUTATION]="transformWithUpdateSheetRangeMutation",n[h.ZP.SET_WORKBOOK_PROPERTIES_MUTATION]="transformWithSetWorkbookPropertiesMutation",n[h.ZP.COPY_PASTE_MUTATION]="transformWithCopyPasteMutation",n[h.ZP.REORDER_RANGE_MUTATION]="transformWithReorderRangeMutation",n[h.ZP.MAP_RANGE_MUTATION]="transformWithMapRangeMutation",n[h.ZP.EMPTY_MUTATION]="transformWithEmptyMutation",n[h.ZP.ADD_CONDITIONAL_FORMAT_MUTATION]="transformWithAddConditionalFormatMutation",n[h.ZP.DELETE_CONDITIONAL_FORMAT_MUTATION]="transformWithDeleteConditionalFormatMutation",n[h.ZP.UPDATE_CONDITIONAL_FORMAT_MUTATION]="transformWithUpdateConditionalFormatMutation",n[h.ZP.DEFINE_WORKBOOK_RANGE_MUTATION]="transformWithDefineWorkbookRangeMutation",n[h.ZP.UPDATE_WORKBOOK_RANGE_MUTATION]="transformWithUpdateWorkbookRangeMutation",n[h.ZP.DELETE_WORKBOOK_RANGE_MUTATION]="transformWithDeleteWorkbookRangeMutation",n[h.ZP.NEW_ADD_EMBEDDED_OBJECT_MUTATION]="transformWithNewAddEmbeddedObjectMutation",n[h.ZP.NEW_DELETE_EMBEDDED_OBJECT_MUTATION]="transformWithNewDeleteEmbeddedObjectMutation",n[h.ZP.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION]="transformWithNewUpdateEmbeddedObjectMutation",n[h.ZP.ADD_FILTER_VIEW_MUTATION]="transformWithAddFilterViewMutation",n[h.ZP.DELETE_FILTER_VIEW_MUTATION]="transformWithDeleteFilterViewMutation",n[h.ZP.UPDATE_FILTER_VIEW_MUTATION]="transformWithUpdateFilterViewMutation",n[h.ZP.ACTIVE_FILTER_VIEW_MUTATION]="transformWithActiveFilterViewMutation",n[h.ZP.ADD_PIVOT_TABLE_MUTATION]="transformWithAddPivotTableMutation",n[h.ZP.DELETE_PIVOT_TABLE_MUTATION]="transformWithDeletePivotTableMutation",n[h.ZP.UPDATE_PIVOT_TABLE_MUTATION]="transformWithUpdatePivotTableMutation",n);if(r[e.id])return this[r[e.id]](e,t);throw new Error("Should not have tried transforming the two mutations: "+this.id+","+e.id)},t.transformWithInsertDimensionMutation=function(e,t){return[this]},t.transformWithDeleteDimensionMutation=function(e,t){return[this]},t.transformWithSetDimensionPropertiesMutation=function(e,t){return[this]},t.transformWithSetRangeMutation=function(e,t){return[this]},t.transformWithSetCellPropertiesMutation=function(e,t){return[this]},t.transformWithMergeCellsMutation=function(e,t){return[this]},t.transformWithUnmergeCellsMutation=function(e,t){return[this]},t.transformWithDefineFilterMutation=function(e,t){return[this]},t.transformWithDeleteFilterMutation=function(e,t){return[this]},t.transformWithUpdateFilterMutation=function(e,t){return[this]},t.transformWithSwitchFilterSyncMutation=function(e,t){return[this]},t.transformWithAddEmbeddedObjectMutation=function(e,t){return[this]},t.transformWithDeleteEmbeddedObjectMutation=function(e,t){return[this]},t.transformWithUpdateEmbeddedObjectMutation=function(e,t){return[this]},t.transformWithInsertSheetMutation=function(e,t){return[this]},t.transformWithDeleteSheetMutation=function(e,t){return[this]},t.transformWithMoveSheetMutation=function(e,t){return[this]},t.transformWithSetSheetPropertiesMutation=function(e,t){return[this]},t.transformWithUpdateAllSheetsMutation=function(e,t){return[this]},t.transformWithDefineSheetRangeMutation=function(e,t){return[this]},t.transformWithDeleteSheetRangeMutation=function(e,t){return[this]},t.transformWithUpdateSheetRangeMutation=function(e,t){return[this]},t.transformWithSetWorkbookPropertiesMutation=function(e,t){return[this]},t.transformWithCopyPasteMutation=function(e,t){return[this]},t.transformWithReorderRangeMutation=function(e,t){return[this]},t.transformWithMapRangeMutation=function(e,t){return[this]},t.transformWithEmptyMutation=function(e,t){return[this]},t.transformWithAddConditionalFormatMutation=function(e,t){return[this]},t.transformWithDeleteConditionalFormatMutation=function(e,t){return[this]},t.transformWithUpdateConditionalFormatMutation=function(e,t){return[this]},t.transformWithDefineWorkbookRangeMutation=function(e,t){return[this]},t.transformWithUpdateWorkbookRangeMutation=function(e,t){return[this]},t.transformWithDeleteWorkbookRangeMutation=function(e,t){return[this]},t.transformWithNewAddEmbeddedObjectMutation=function(e,t){return[this]},t.transformWithNewDeleteEmbeddedObjectMutation=function(e,t){return[this]},t.transformWithNewUpdateEmbeddedObjectMutation=function(e,t){return[this]},t.transformWithAddFilterViewMutation=function(e,t){return[this]},t.transformWithDeleteFilterViewMutation=function(e,t){return[this]},t.transformWithUpdateFilterViewMutation=function(e,t){return[this]},t.transformWithActiveFilterViewMutation=function(e,t){return[this]},t.transformWithAddPivotTableMutation=function(e,t){return[this]},t.transformWithDeletePivotTableMutation=function(e,t){return[this]},t.transformWithUpdatePivotTableMutation=function(e,t){return[this]},e}();t.Z=c},38808:function(e,t,n){"use strict";var r;n.d(t,{$z:function(){return i},p0:function(){return o}}),function(e){e[e.INSERT_DIMENSION_MUTATION=0]="INSERT_DIMENSION_MUTATION",e[e.DELETE_DIMENSION_MUTATION=1]="DELETE_DIMENSION_MUTATION",e[e.SET_DIMENSION_PROPERTIES_MUTATION=2]="SET_DIMENSION_PROPERTIES_MUTATION",e[e.SET_RANGE_MUTATION=3]="SET_RANGE_MUTATION",e[e.SET_CELL_PROPERTIES_MUTATION=4]="SET_CELL_PROPERTIES_MUTATION",e[e.MERGE_CELLS_MUTATION=5]="MERGE_CELLS_MUTATION",e[e.UNMERGE_CELLS_MUTATION=6]="UNMERGE_CELLS_MUTATION",e[e.UPDATE_FILTERS_MODEL_MUTATION=7]="UPDATE_FILTERS_MODEL_MUTATION",e[e.ADD_EMBEDDED_OBJECT_MUTATION=8]="ADD_EMBEDDED_OBJECT_MUTATION",e[e.DELETE_EMBEDDED_OBJECT_MUTATION=9]="DELETE_EMBEDDED_OBJECT_MUTATION",e[e.UPDATE_EMBEDDED_OBJECT_MUTATION=10]="UPDATE_EMBEDDED_OBJECT_MUTATION",e[e.INSERT_SHEET_MUTATION=11]="INSERT_SHEET_MUTATION",e[e.DELETE_SHEET_MUTATION=12]="DELETE_SHEET_MUTATION",e[e.MOVE_SHEET_MUTATION=13]="MOVE_SHEET_MUTATION",e[e.SET_SHEET_PROPERTIES_MUTATION=14]="SET_SHEET_PROPERTIES_MUTATION",e[e.UPDATE_ALL_SHEETS_MUTATION=15]="UPDATE_ALL_SHEETS_MUTATION",e[e.DEFINE_SHEET_RANGE_MUTATION=16]="DEFINE_SHEET_RANGE_MUTATION",e[e.DELETE_SHEET_RANGE_MUTATION=17]="DELETE_SHEET_RANGE_MUTATION",e[e.UPDATE_SHEET_RANGE_MUTATION=18]="UPDATE_SHEET_RANGE_MUTATION",e[e.SET_WORKBOOK_PROPERTIES_MUTATION=19]="SET_WORKBOOK_PROPERTIES_MUTATION",e[e.INIT_DATA_MUTATION=20]="INIT_DATA_MUTATION",e[e.COPY_PASTE_MUTATION=21]="COPY_PASTE_MUTATION",e[e.REORDER_RANGE_MUTATION=22]="REORDER_RANGE_MUTATION",e[e.MAP_RANGE_MUTATION=23]="MAP_RANGE_MUTATION",e[e.DEFINE_FILTER_MUTATION=24]="DEFINE_FILTER_MUTATION",e[e.DELETE_FILTER_MUTATION=25]="DELETE_FILTER_MUTATION",e[e.UPDATE_FILTER_MUTATION=26]="UPDATE_FILTER_MUTATION",e[e.EMPTY_MUTATION=27]="EMPTY_MUTATION",e[e.ADD_CONDITIONAL_FORMAT_MUTATION=28]="ADD_CONDITIONAL_FORMAT_MUTATION",e[e.DELETE_CONDITIONAL_FORMAT_MUTATION=29]="DELETE_CONDITIONAL_FORMAT_MUTATION",e[e.UPDATE_CONDITIONAL_FORMAT_MUTATION=30]="UPDATE_CONDITIONAL_FORMAT_MUTATION",e[e.DEFINE_WORKBOOK_RANGE_MUTATION=31]="DEFINE_WORKBOOK_RANGE_MUTATION",e[e.UPDATE_WORKBOOK_RANGE_MUTATION=32]="UPDATE_WORKBOOK_RANGE_MUTATION",e[e.DELETE_WORKBOOK_RANGE_MUTATION=33]="DELETE_WORKBOOK_RANGE_MUTATION",e[e.NEW_ADD_EMBEDDED_OBJECT_MUTATION=34]="NEW_ADD_EMBEDDED_OBJECT_MUTATION",e[e.NEW_DELETE_EMBEDDED_OBJECT_MUTATION=35]="NEW_DELETE_EMBEDDED_OBJECT_MUTATION",e[e.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION=36]="NEW_UPDATE_EMBEDDED_OBJECT_MUTATION",e[e.SWITCH_FILTER_SYNC_MUTATION=37]="SWITCH_FILTER_SYNC_MUTATION",e[e.ADD_FILTER_VIEW_MUTATION=38]="ADD_FILTER_VIEW_MUTATION",e[e.DELETE_FILTER_VIEW_MUTATION=39]="DELETE_FILTER_VIEW_MUTATION",e[e.UPDATE_FILTER_VIEW_MUTATION=40]="UPDATE_FILTER_VIEW_MUTATION",e[e.ACTIVE_FILTER_VIEW_MUTATION=41]="ACTIVE_FILTER_VIEW_MUTATION",e[e.ADD_PIVOT_TABLE_MUTATION=42]="ADD_PIVOT_TABLE_MUTATION",e[e.DELETE_PIVOT_TABLE_MUTATION=43]="DELETE_PIVOT_TABLE_MUTATION",e[e.UPDATE_PIVOT_TABLE_MUTATION=44]="UPDATE_PIVOT_TABLE_MUTATION",e[e.Sheet_Max_MUTATION_Id=999]="Sheet_Max_MUTATION_Id"}(r||(r={}));var i=[r.SWITCH_FILTER_SYNC_MUTATION,r.DEFINE_WORKBOOK_RANGE_MUTATION,r.UPDATE_WORKBOOK_RANGE_MUTATION,r.DELETE_WORKBOOK_RANGE_MUTATION,r.EMPTY_MUTATION,r.INIT_DATA_MUTATION,r.DEFINE_SHEET_RANGE_MUTATION,r.DELETE_SHEET_RANGE_MUTATION,r.UPDATE_SHEET_RANGE_MUTATION,r.SET_WORKBOOK_PROPERTIES_MUTATION,r.INSERT_SHEET_MUTATION,r.DELETE_SHEET_MUTATION,r.MOVE_SHEET_MUTATION,r.UPDATE_ALL_SHEETS_MUTATION],o=[r.DEFINE_SHEET_RANGE_MUTATION,r.DELETE_SHEET_RANGE_MUTATION,r.UPDATE_SHEET_RANGE_MUTATION,r.SET_WORKBOOK_PROPERTIES_MUTATION,r.ADD_CONDITIONAL_FORMAT_MUTATION,r.DELETE_CONDITIONAL_FORMAT_MUTATION,r.UPDATE_CONDITIONAL_FORMAT_MUTATION,r.DEFINE_WORKBOOK_RANGE_MUTATION,r.UPDATE_WORKBOOK_RANGE_MUTATION,r.DELETE_WORKBOOK_RANGE_MUTATION,r.NEW_ADD_EMBEDDED_OBJECT_MUTATION,r.NEW_DELETE_EMBEDDED_OBJECT_MUTATION,r.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION,r.SET_DIMENSION_PROPERTIES_MUTATION];t.ZP=r},71217:function(e,t){"use strict";var n;!function(e){e[e.HISTORY=-1]="HISTORY",e[e.LOCAL=0]="LOCAL",e[e.UNDO=1]="UNDO",e[e.REDO=2]="REDO",e[e.COLLAB=3]="COLLAB"}(n||(n={})),t.Z=n},90945:function(e,t){"use strict";var n;!function(e){e[e.SET_SLOT=0]="SET_SLOT",e[e.CLEAR_SLOT=1]="CLEAR_SLOT",e[e.ADD_SLOT=2]="ADD_SLOT",e[e.REMOVE_SLOT=3]="REMOVE_SLOT"}(n||(n={})),t.Z=n},11530:function(e,t,n){"use strict";n.d(t,{D:function(){return r}});var r=(0,n(76138).yh)("IMutationBehavior")},73543:function(e,t,n){"use strict";n.d(t,{Z:function(){return ae}});var r,i=n(85952),o=(n(38934),n(31688),n(90109),n(72104)),s=n(31973),a=n(26178),d=n(61502),h=n(31160),u=n(20808),l=n(38808),c=[{verLowestSupport:3,verTarget:6,convert:function(e){return e}}],f=function(e,t){var n,r,i;for(void 0===t&&(t=h.Z.MUTATION_VER),n=0,r=c.length;n<r&&(i=c[n],!(e.v>=t));n++)e.v>=i.verLowestSupport&&e.v<i.verTarget&&(e=i.convert(e));return e},I=n(22535),g=n(99790),p=n(94809),m=n(62962),v=n(75832),R=n(49902),x=n(15),T=n(98279),E=n(75479),w=n(87082),y=n(42313),S=n(20191),O=n(60869),D=n(87789),M=n(20587),C=n(66676),_=n(6091),A=n(54792),N=n(17144),b=n(58763),P=n(54500),k=n(20911),L=n(52047),Z=n(14527),U=n(99772),F=n(89688),W=n(52152),V=n(49898),j=n(97098),B=n(85145),z=n(98217),H=n(35631),K=n(25693),G=n(38561),Y=n(52074),J=n(4960),q=n(38698),Q=n(91961),X=n(94853),$=n(59089),ee=n(13176),te=n(84217),ne=n(93896),re=n(81646),ie=n(32869),oe=a.Utils.serializeUtils;!function(e){e[e.Workbook=1]="Workbook",e[e.Sheet=2]="Sheet"}(r||(r={}));var se=function(){function e(){this.emitter=new o.Z}var t=e.prototype;return t.serializeMutation=function(e){var t,r={t:e.id,v:e.version,c:[],r:e.requestId,o:e.operationType};try{e.version<5&&(r.v=h.Z.MUTATION_VER_LOWEST_SUPPORT),r.c=this._serializeMutation(e)}catch(i){null===(t=n.g.log)||void 0===t||t.error("mutation","serialize error",e,i),s.ZP.run(d.mz.SERIALIZE_MUTATION,[e],i)}return r},t.deserializeMutation=function(t){var n;if(t.v>h.Z.MUTATION_VER)return this.emitter.emit(e.EVENT.DATA_VERSION_TOO_LOW,t.v),s.ZP.zzsStatus({attrid:d.Ly.DATA_VERSION_TOO_LOW,status:1}),null;if(t.v<h.Z.MUTATION_VER_LOWEST_SUPPORT)return console.error("mutation version is lower than support",t),s.ZP.zzsStatus({attrid:d.Ly.MUTATION_VER_LOWER_THAN_SUPPORT,status:1}),null;if(t.v<h.Z.MUTATION_VER&&t.v>=5)try{t=f(t)}catch(o){return console.error("convert mutation error: ",t,o),s.ZP.zzsStatus({attrid:d.Ly.CONVERT_MUTATION_ERROR,status:1}),null}var r=((n={})[l.ZP.INSERT_DIMENSION_MUTATION]=g.Z,n[l.ZP.DELETE_DIMENSION_MUTATION]=p.Z,n[l.ZP.SET_DIMENSION_PROPERTIES_MUTATION]=m.ZP,n[l.ZP.SET_RANGE_MUTATION]=v.Z,n[l.ZP.SET_CELL_PROPERTIES_MUTATION]=R.Z,n[l.ZP.MERGE_CELLS_MUTATION]=x.Z,n[l.ZP.UNMERGE_CELLS_MUTATION]=T.Z,n[l.ZP.UPDATE_FILTERS_MODEL_MUTATION]=W.Z,n[l.ZP.ADD_EMBEDDED_OBJECT_MUTATION]=E.Z,n[l.ZP.DELETE_EMBEDDED_OBJECT_MUTATION]=w.Z,n[l.ZP.UPDATE_EMBEDDED_OBJECT_MUTATION]=y.Z,n[l.ZP.INSERT_SHEET_MUTATION]=S.Z,n[l.ZP.DELETE_SHEET_MUTATION]=O.Z,n[l.ZP.MOVE_SHEET_MUTATION]=D.Z,n[l.ZP.SET_SHEET_PROPERTIES_MUTATION]=M.Z,n[l.ZP.UPDATE_ALL_SHEETS_MUTATION]=W.Z,n[l.ZP.DEFINE_SHEET_RANGE_MUTATION]=C.Z,n[l.ZP.DELETE_SHEET_RANGE_MUTATION]=_.Z,n[l.ZP.UPDATE_SHEET_RANGE_MUTATION]=A.Z,n[l.ZP.SET_WORKBOOK_PROPERTIES_MUTATION]=G.Z,n[l.ZP.INIT_DATA_MUTATION]=N.Z,n[l.ZP.COPY_PASTE_MUTATION]=b.Z,n[l.ZP.REORDER_RANGE_MUTATION]=P.Z,n[l.ZP.MAP_RANGE_MUTATION]=k.Z,n[l.ZP.DEFINE_FILTER_MUTATION]=L.ZP,n[l.ZP.DELETE_FILTER_MUTATION]=Z.Z,n[l.ZP.UPDATE_FILTER_MUTATION]=U.ZP,n[l.ZP.SWITCH_FILTER_SYNC_MUTATION]=F.Z,n[l.ZP.EMPTY_MUTATION]=W.Z,n[l.ZP.ADD_CONDITIONAL_FORMAT_MUTATION]=V.Z,n[l.ZP.DELETE_CONDITIONAL_FORMAT_MUTATION]=j.Z,n[l.ZP.UPDATE_CONDITIONAL_FORMAT_MUTATION]=B.Z,n[l.ZP.DEFINE_WORKBOOK_RANGE_MUTATION]=z.Z,n[l.ZP.UPDATE_WORKBOOK_RANGE_MUTATION]=H.Z,n[l.ZP.DELETE_WORKBOOK_RANGE_MUTATION]=K.Z,n[l.ZP.NEW_ADD_EMBEDDED_OBJECT_MUTATION]=Y.Z,n[l.ZP.NEW_DELETE_EMBEDDED_OBJECT_MUTATION]=J.Z,n[l.ZP.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION]=q.Z,n[l.ZP.ADD_FILTER_VIEW_MUTATION]=Q.Z,n[l.ZP.DELETE_FILTER_VIEW_MUTATION]=X.Z,n[l.ZP.UPDATE_FILTER_VIEW_MUTATION]=$.Z,n[l.ZP.ACTIVE_FILTER_VIEW_MUTATION]=ee.Z,n[l.ZP.ADD_PIVOT_TABLE_MUTATION]=te.Z,n[l.ZP.DELETE_PIVOT_TABLE_MUTATION]=ne.Z,n[l.ZP.UPDATE_PIVOT_TABLE_MUTATION]=re.Z,n),i=null;try{r[t.t]?i=this._deserializeMutation(t,r[t.t]):(console.error("deserialize mutation fail: ",t),s.ZP.run(d.mz.DESERIALIZE_MUTATION_FAIL,[t,h.Z.MUTATION_VER_LOWEST_SUPPORT,h.Z.MUTATION_VER])),(i=i||new W.Z({sheetId:""})).version=t.v,i.requestId=t.r,i.operationType=t.o}catch(o){console.error(o),t.v>5?s.ZP.run(d.mz.DESERIALIZE_MUTATION_CATCH_ERROR,[t,h.Z.MUTATION_VER_LOWEST_SUPPORT,h.Z.MUTATION_VER],o):s.ZP.run(d.mz.DESERIALIZE_MUTATION_CATCH_ERROR_OLD,[t,h.Z.MUTATION_VER],o)}return i},t.getMutationDataSize=function(e){var t=this;try{var n=[];null===e||void 0===e||e.forEach((function(e){var r=t.serializeMutation(e);n.push(r)}));var r=JSON.stringify(n);return new Blob([r]).size}catch(i){return console.error(i),-1}},t.getCollabMutations=function(e){var t=this;if("string"===typeof e)try{e=JSON.parse(e)}catch(r){throw s.ZP.run(d.mz.GET_COLLAB_MUTATIONS,[e,r]),r}var n=[];return Array.isArray(e)&&e.forEach((function(e){if(e&&e.v){var r=t.deserializeMutation(e);r&&n.push(r)}})),n},t.follow=function(e,t){var n,r,i,o,s=[],a=[],d=[];for(n=0,r=e.length;n<r;n++)(i=this.deserializeMutation(e[n]))&&a.push(i);for(n=0,r=t.length;n<r;n++)(o=this.deserializeMutation(t[n]))&&d.push(o);for(d=(0,I.v)(d,a,!0),n=0,r=t.length;n<r;n++)s.push(this.serializeMutation(d[n]));return s},t.followRequestMutations=function(e,t,n){void 0===n&&(n=!1);try{var r,i,o,a,h,u,l,c;for(r=0,a=e.length;r<a;r++){for(h=e[r],l=[],i=0,o=t.length;i<o;i++)u=t[i],c=(0,I.v)(u,h,!n),i<o-1&&(h=(0,I.v)(h,u,n)),l.push(c);t=l}return t}catch(f){throw s.ZP.run(d.mz.FOLLOW_REQUEST_MUTATIONS,[e,t,n,null===f||void 0===f?void 0:f.stack]),f}},t.followRequests=function(e,t,n){var r,i,o,a;void 0===n&&(n=!1);var d,h,l,c,f,I=!1;if(!(0,u.Ep)(e)||!(0,u.Ep)(t))return t;var g=[];for(r=0,a=e.length;r<a;r++){for(c=[],i=0,o=e[r].length;i<o;i++)(h=this.deserializeMutation(e[r][i]))?c.push(h):I=!0;g.push(c)}var p=[];for(r=0,a=t.length;r<a;r++){for(f=[],i=0,o=t[r].length;i<o;i++)(l=this.deserializeMutation(t[r][i]))?f.push(l):I=!0;p.push(f)}var m=this.followRequestMutations(g,p,n);return d=this.serializeRequests(m),I&&s.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_core",action:"followRequests",obj3:"requestsA: "+JSON.stringify(e||"")+"  requestsB: "+JSON.stringify(t||"")}),d},t.followChangeset=function(e,t,n){var r=this,i=JSON.parse(e).map((function(e){return e.map((function(e){return r.deserializeMutation(e)}))})),o=JSON.parse(t).map((function(e){return e.map((function(e){return r.deserializeMutation(e)}))})),s=this.followRequestMutations(i,o,n),a=[];return s.forEach((function(e){var t=[];e.forEach((function(e){var n=r.serializeMutation(e);t.push(n)})),a.push(t)})),JSON.stringify(a)},t.multiTypeFollowMutations=function(e,t,n){return(0,ie.Xz)(e,t,n)},t.multiTypeFollowChangeset=function(e,t,n){return(0,ie.hh)(e,t,n)},t.serializeRequests=function(e){for(var t,n,r=[],i=0,o=e.length;i<o;i++){n=e[i],r[i]=[];for(var s=0,a=n.length;s<a;s++)t=n[s],r[i].push(this.serializeMutation(t))}return r},t.deSerializeRequests=function(e){var t,n,r,i,o,s=[],a=[];for(t=0,i=e.length;t<i;t++){for(s=[],n=0,r=e[t].length;n<r;n++)(o=this.deserializeMutation(e[t][n]))&&a.push(o);s.push(a)}return s},t.applyMutation=function(t,i,o){var s;o||(o=n.g.SpreadsheetApp.spreadsheet);try{this.emitter.emit(e.EVENT.BEFORE_MUTATION_RUN,{mutation:t,isLocal:i.isLocal,isFromFormula:i.isFromFormula,isCollab:i.isCollab,isReplay:i.isReplay})}catch(p){null===(s=n.g.log)||void 0===s||s.error("mutation","BEFORE_MUTATION_RUN error.",null===p||void 0===p?void 0:p.stack)}var a=t.run(o,i),d=a.runResult,h=a.runCache,u=a.workbookWithSheetId,l=a.isMultiSheet;if(i.isIgnoreRender)return d;if(l)this.triggerRender(t,o,i,r.Workbook);else if(d.isValid){for(var c=!1,f=0,I=h.length;f<I;f++){var g=h[f][0];this.triggerRender(t,g,h[f][1],r.Sheet),u&&g.getSheetId()!==u||(c=!0)}c||this.triggerRender(t,o,i,r.Workbook)}return i.isIgnoreDataCallView||this.triggerDataChange(t),d},t.triggerRender=function(t,i,o,a){var h,u,l;a===r.Workbook?(u=i.type,l=t.getAffectedSheetId()):(u=i.spreadsheetReference.type,l=i.getSheetId());try{this.emitter.emit(e.EVENT.AFTER_MUTATION_RUN,{sheetId:l,mutation:t,sType:u,isLocal:o.isLocal,isFromFormula:o.isFromFormula,isCollab:o.isCollab,isReplay:o.isReplay,isIgnoreDataCallView:o.isIgnoreDataCallView})}catch(c){s.ZP.run(d.mz.AFTER_MUTATION_RUN_CATCH_ERROR,c,t),null===(h=n.g.log)||void 0===h||h.error("mutation","triggerRender AFTER_MUTATION_RUN error.",null===c||void 0===c?void 0:c.stack)}},t.triggerDataChange=function(t){var r;try{this.emitter.emit(e.EVENT.DATA_CHANGE,{type:"afterMutationRun",mutation:t})}catch(i){return null===(r=n.g.log)||void 0===r||r.error("mutation","triggerDataChange DATA_CHANGE error.",null===i||void 0===i?void 0:i.stack),s.ZP.run(d.mz.AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR,i,t),!1}},t._serializeMutation=function(e){return e.version>=5?e.serialize():oe.serialize(e,null,{notReplaceSheetId:!0})},t._deserializeMutation=function(e,t){return e.v>=5?t.deserialize(e.c):oe.deserialize(e.c,t,{notReplaceSheetId:!0})},(0,i.Z)(e,[{key:"EVENT",get:function(){return e.EVENT}}]),e}();se.EVENT={DATA_VERSION_TOO_LOW:"DATA_VERSION_TOO_LOW",DATA_CHANGE:"DATA_CHANGE",BEFORE_MUTATION_RUN:"BEFORE_MUTATION_RUN",AFTER_MUTATION_RUN:"AFTER_MUTATION_RUN"};var ae=se},49902:function(e,t,n){"use strict";var r=n(13504),i=(n(46396),n(38934),n(77468),n(31688),n(25594),n(62883),n(26178)),o=n(80067),s=n(38808),a=n(85249),d=n(3230),h=n(75832),u=n(98279),l=n(172),c=(n(36156),n(91974)),f=n(25927),I=n(81300),g=i.Dimension.DIMENSION_TYPE,p=i.Range.GridRange,m=i.Range.gridRangeUtils,v=function(e){function t(t){var n;return(n=e.call(this,s.ZP.SET_CELL_PROPERTIES_MUTATION,t)||this).gridRange=t.gridRange,n.cellDataDelta=t.cellDataDelta,n}(0,r.Z)(t,e),t.deserialize=function(e){var n=p.deserialize(e[0]),r=f.ZP.createPropertiesMap(e[2],n);return new t({gridRange:n,cellDataDelta:c.Z.deserialize(e[1],r)})};var n=t.prototype;return n.serialize=function(){var e=new f.ZP;return[this.gridRange.serialize(),this.cellDataDelta.serialize(e),e.serializedPropertiesMap]},n.getAffectedSheetId=function(){return this.gridRange.sheetId},n.setAffectedSheetId=function(e){this.gridRange.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId);return t?[t]:[]},n.getAffectedGridRanges=function(){return[this.gridRange]},n.check=function(t){var n=e.prototype.check.call(this,t);if(!n.isValid)return n;if(!this.gridRange||!this.cellDataDelta)return{isValid:!1,errorMessage:"GridRange为空 或者 cellDataDelta为空 gridRange="+JSON.stringify(this.gridRange)+" cellDataDelta="+JSON.stringify(this.cellDataDelta)};var r=this.gridRange,i=t.properties.gridProperties;return(0,o.hj)(r.startRowIndex)&&(0,o.hj)(r.endRowIndex)&&(0,o.hj)(r.startColIndex)&&(0,o.hj)(r.endColIndex)?r.startRowIndex<0||r.endRowIndex>=i.rowCount||r.startColIndex<0||r.endColIndex>=i.colCount?{isValid:!1,errorMessage:"gridRange 范围不正确。 gridRange="+JSON.stringify(r)+" gridProperties="+JSON.stringify(i)}:{isValid:!0}:{isValid:!1,errorMessage:"gridRange index类型不是数字 girdRange="+JSON.stringify(r)}},n.run=function(t,n){return this.runMutationOptions={isLocal:!1},Object.assign(this.runMutationOptions,n),e.prototype.run.call(this,t,n)},n.runOnSheet=function(e){var t,n,r;if(!this.cellDataDelta.isEmpty()){var i,o,s,a,d,h,u=this.cellDataDelta,l=this.gridRange,c=l.startRowIndex,f=l.endRowIndex,g=l.startColIndex,p=l.endColIndex;for(i=c,s=f;i<=s;i++)for(o=g,a=p;o<=a;o++)if((d=e.getCellDataAtPosition(i,o,{isIgnoreFilterView:!0}))&&0!==d.setSlots||0!==u.setSlots){var m=null===d||void 0===d?void 0:d.cloneMentionDetails(),v=null===d||void 0===d?void 0:d.getHyperlink(),R=(null===(t=null===d||void 0===d?void 0:d.getEffectiveValue())||void 0===t||t.value,(null===d||void 0===d?void 0:d.getDateReminderId())||null),x=(null===d||void 0===d?void 0:d.getTodoId())||null;((h=I.cellDataUtils.mergeDeltaToCellData(d,u))||d)&&(e.setCellDataAtPosition(i,o,h),e.mentionManager.updateMentions(m,(null===h||void 0===h?void 0:h.getMentionDetails())||void 0,i,o,{isReplay:null===(n=this.runMutationOptions)||void 0===n?void 0:n.isReplay,isCollab:null===(r=this.runMutationOptions)||void 0===r?void 0:r.isCollab}),e.hyperlinkManager.updateHyperlink(v?{rowIndex:i,colIndex:o}:null,(null===h||void 0===h?void 0:h.getHyperlink())?{rowIndex:i,colIndex:o,cellData:h}:null),e.dateReminderManager.updateDateReminder(R,d,h,i,o,this.runMutationOptions),e.todoManager.updateTodoRange(x,h,i,o))}}},n.runOnFormulaModel=function(e){if(!this.cellDataDelta.isEmpty()){for(var t=this.cellDataDelta,n=e.formulaModelManager,r=this.gridRange,i=r.startRowIndex,o=r.endRowIndex,s=r.startColIndex,a=r.endColIndex,d=this.getAffectedSheetId(),h=i,u=o;h<=u;h++)for(var l=s,c=a;l<=c;l++)0===t.setSlots&&0===t.clearSlots||(n.addFormulaData({row:h,col:l,sheetId:d},t),n.addDataValidationData({row:h,col:l,sheetId:d},t));n.updateFormulaModelManagerDataFinish()}},n.invert=function(e){var t,n,r,i,o,s,a,d,u,c=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId),f=this.cellDataDelta,g=[],p=this.gridRange;if(!c)return[];var m=c.data;for(s=p.startRowIndex<0?m.startRow:p.startRowIndex,a=p.endRowIndex<0?c.getRowCount()-1:p.endRowIndex,d=p.startColIndex<0?m.startCol:p.startColIndex,u=p.endColIndex<0?c.getColCount()-1:p.endColIndex,t=s,r=a;t<=r;t++)for(n=d,i=u;n<=i;n++){o=c.getCellDataAtPosition(t,n,{isIgnoreFilterView:!0});var v=I.cellDataUtils.invertCellDataDelta(o,f);(null===o||void 0===o?void 0:o.getPivotTableRef())&&((0,l.isCellContentModified)(f)&&v.clearSlot(I.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE),(0,l.isCellPivotRefModified)(f)&&v.clearSlot(I.CELL_DATA_SLOT.SLOT_PIVOT_TABLE_REF)),g.push({rowIndex:t,colIndex:n,cellDataDelta:v})}return[new h.Z({gridRange:this.gridRange,cellDataDeltaAtPositions:g})]},n.transformWithInsertDimensionMutation=function(e,n){if(this.gridRange.sheetId!==e.sheetId)return[this];var r,i,o=[];e.type===g.ROWS?e.index>this.gridRange.startRowIndex&&e.index<=this.gridRange.endRowIndex?(o.push(new p(this.gridRange.sheetId,this.gridRange.startRowIndex,e.index-1,this.gridRange.startColIndex,this.gridRange.endColIndex)),o.push(new p(this.gridRange.sheetId,e.index,this.gridRange.endRowIndex,this.gridRange.startColIndex,this.gridRange.endColIndex))):o.push(this.gridRange):e.index>this.gridRange.startColIndex&&e.index<=this.gridRange.endColIndex?(o.push(new p(this.gridRange.sheetId,this.gridRange.startRowIndex,this.gridRange.endRowIndex,this.gridRange.startColIndex,e.index-1)),o.push(new p(this.gridRange.sheetId,this.gridRange.startRowIndex,this.gridRange.endRowIndex,e.index,this.gridRange.endColIndex))):o.push(this.gridRange);var s=[],a=(0,d.M)(this.cellDataDelta,e);for(r=0,i=o.length;r<i;r++)o[r].insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),s.push(new t({gridRange:o[r],cellDataDelta:a}));return s},n.transformWithDeleteDimensionMutation=function(e,n){if(this.gridRange.sheetId!==e.sheetId)return[this];var r=this.gridRange.clone();return r.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),r.endRowIndex<r.startRowIndex||r.endColIndex<r.startColIndex?[]:[new t({gridRange:r,cellDataDelta:(0,d.M)(this.cellDataDelta,e)})]},n.transformWithSetRangeMutation=function(e,n){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var r,i;if(!this.gridRange.isCross(e.gridRange))return[this];var o,s,a=e.getTotalSlots();if(0===((this.cellDataDelta.setSlots|this.cellDataDelta.clearSlots)&(a.cellDataSetSlots|a.cellDataClearSlots)))return[this];var d,h=[],u=[];for(r=0,i=e.cellDataDeltaAtPositions.length;r<i;r++)o=e.cellDataDeltaAtPositions[r],this.gridRange.containCell(o.rowIndex,o.colIndex)&&(s=I.cellDataUtils.transformTwoCellDataDelta(this.cellDataDelta,o.cellDataDelta,n),d=new p(this.gridRange.sheetId,o.rowIndex,o.rowIndex,o.colIndex,o.colIndex),s.isEmpty()||h.push(new t({gridRange:d,cellDataDelta:s})),u.push(d));for(r=0,i=(u=m.divideGridRangeByCells(this.gridRange,u)).length;r<i;r++)h.push(new t({gridRange:u[r],cellDataDelta:this.cellDataDelta}));return h},n.transformWithSetCellPropertiesMutation=function(e,n){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var r,i;if(!this.gridRange.isCross(e.gridRange))return[this];if(0===((this.cellDataDelta.setSlots|this.cellDataDelta.clearSlots)&(e.cellDataDelta.setSlots|e.cellDataDelta.clearSlots)))return[this];var o=I.cellDataUtils.transformTwoCellDataDelta(this.cellDataDelta,e.cellDataDelta,n);if(e.gridRange.contain(this.gridRange))return o.isEmpty()?[]:[new t({gridRange:this.gridRange,cellDataDelta:o})];var s=this.gridRange.getCross(e.gridRange),a=[];o.isEmpty()||a.push(new t({gridRange:s,cellDataDelta:o}));var d=m.divideGridRangeByCells(this.gridRange,[s]);for(r=0,i=d.length;r<i;r++)a.push(new t({gridRange:d[r],cellDataDelta:this.cellDataDelta}));return a},n.transformWithMergeCellsMutation=function(e,n){if(this.gridRange.sheetId!==e.sheetId)return[this];var r,i;if(0===this.cellDataDelta.setSlots)return[this];var o,s=[];s.push(new p(e.sheetId,e.startRowIndex+1,e.endRowIndex,e.startColIndex,e.endColIndex)),s.push(new p(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex+1,e.endColIndex));var a=[];for(r=0,i=s.length;r<i;r++)(o=this.gridRange.getCross(s[r]))&&a.push(o);if(0===a.length)return[this];if(n)return[new u.Z({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex})];var d=[];for(r=0,i=(a=m.divideGridRangeByCells(this.gridRange,a)).length;r<i;r++)d.push(new t({gridRange:a[r],cellDataDelta:this.cellDataDelta}));return d},n.transformWithDeleteSheetMutation=function(e,t){return this.gridRange.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithCopyPasteMutation=function(e,t){var n=this;if(this.gridRange.sheetId!==e.sheetId)return[this];if(t)return[this];var r=e.getAffectedGridRanges(),i=!1,o=[];if(r.forEach((function(e){e.isCross(n.gridRange)&&(i=!0,o.push(e.getCross(n.gridRange)))})),!i)return[this];var s=[],a=[],d=e.cellMask;o.forEach((function(e){e.each((function(e,t){var r={rowIndex:e,colIndex:t,cellDataDelta:(0,l.removeCrossSlotByMask)(n.cellDataDelta,d)};a.push(r)}))})),this.gridRange.each((function(e,t){a.find((function(n){return n.rowIndex===e&&n.colIndex===t}))||a.push({rowIndex:e,colIndex:t,cellDataDelta:n.cellDataDelta})}));var u=new h.Z({gridRange:this.gridRange,cellDataDeltaAtPositions:a});return s.push(u),s},n.transformWithReorderRangeMutation=function(e,n){if(this.gridRange.sheetId!==e.sheetId)return[this];var r,i,o=this.gridRange.getCross(e.range);if(!o)return[this];var s,a=m.divideGridRangeByCells(this.gridRange,[o]),h=[];for(r=0,i=a.length;r<i;r++)h.push(new t({gridRange:a[r],cellDataDelta:this.cellDataDelta}));var u=(0,d.M)(this.cellDataDelta,e),l=(0,d.L)(u);for(r=o.startRowIndex,i=o.endRowIndex;r<=i;r++)(s=e.getOrderResult(r))?(l.borders&&!l.borders.isEmpty()&&h.push(new t({gridRange:new p(o.sheetId,r,r,o.startColIndex,o.endColIndex),cellDataDelta:l.borders})),l.other&&!l.other.isEmpty()&&h.push(new t({gridRange:new p(o.sheetId,s,s,o.startColIndex,o.endColIndex),cellDataDelta:l.other}))):h.push(new t({gridRange:new p(o.sheetId,r,r,o.startColIndex,o.endColIndex),cellDataDelta:this.cellDataDelta}));return h},n.transformWithMapRangeMutation=function(e,n){if(this.gridRange.sheetId!==e.sourceSheetId)return[this];var r,i,o=(0,d.M)(this.cellDataDelta,e),s=this.gridRange.getCross(new p(e.sourceSheetId,-1===e.row.from.startIndex?0:e.row.from.startIndex,-1===e.row.from.endIndex?Number.MAX_VALUE:e.row.from.endIndex,-1===e.column.from.startIndex?0:e.column.from.startIndex,-1===e.column.from.endIndex?Number.MAX_VALUE:e.column.from.endIndex));if(!s)return[new t({gridRange:this.gridRange,cellDataDelta:o})];var a=[];a.push(new t({gridRange:s,cellDataDelta:new c.Z({clearSlots:I.CELL_DATA_SLOT_COMPOSE.ALL})}));var h=new p(this.gridRange.sheetId,-1===e.row.from.startIndex?s.startRowIndex:s.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.from.startIndex?s.endRowIndex:s.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.from.startIndex?s.startColIndex:s.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.from.startIndex?s.endColIndex:s.endColIndex-e.column.from.startIndex+e.column.to);a.push(new t({gridRange:h,cellDataDelta:o}));var u=m.divideGridRangeByCells(this.gridRange,[s]);for(r=0,i=u.length;r<i;r++)a.push(new t({gridRange:u[r],cellDataDelta:this.cellDataDelta}));return a},t}(a.Z);v.protoMap={0:{name:"gridRange",dataType:p},1:{name:"cellDataDelta",dataType:c.Z}},t.Z=v},75832:function(e,t,n){"use strict";var r=n(13504),i=(n(62883),n(71096),n(46396),n(38934),n(77468),n(31688),n(8195),n(80067)),o=n(20808),s=n(38808),a=n(85249),d=n(3230),h=n(49902),u=n(98279),l=n(172),c=n(89577),f=n(91974),I=n(25927),g=n(81300),p=n(27571),m=(n(36156),{0:{name:"rowIndex",dataType:Number},1:{name:"colIndex",dataType:Number},2:{name:"cellDataDelta",dataType:f.Z}}),v=function(e){function t(t){var n;return(n=e.call(this,s.ZP.SET_RANGE_MUTATION,t)||this).gridRange=t.gridRange,n.cellDataDeltaAtPositions=t.cellDataDeltaAtPositions,n}(0,r.Z)(t,e),t.deserialize=function(e){var n,r,i,o,s,a=c.Z.deserialize(e[0]),d=Object.keys(e[1]),h=I.ZP.createPropertiesMap(e[2],a),u=a.endColIndex-a.startColIndex+1,l=[];for(o=0,s=d.length;o<s;o++)r=(n=+d[o])%u+a.startColIndex,i=Math.floor(n/u)+a.startRowIndex,l.push({rowIndex:i,colIndex:r,cellDataDelta:f.Z.deserialize(e[1][n],h)});return d=null,h=null,new t({gridRange:a,cellDataDeltaAtPositions:l})};var n=t.prototype;return n.serialize=function(){var e,t,n,r={},i=new I.ZP,o=this.gridRange.endColIndex-this.gridRange.startColIndex+1;for(t=0,n=this.cellDataDeltaAtPositions.length;t<n;t++)r[((e=this.cellDataDeltaAtPositions[t]).rowIndex-this.gridRange.startRowIndex)*o+(e.colIndex-this.gridRange.startColIndex)]=e.cellDataDelta.serialize(i);return[this.gridRange.serialize(),r,i.serializedPropertiesMap]},n.getSizeEstimate=function(){return this.cellDataDeltaAtPositions.length},n.getAffectedSheetId=function(){return this.gridRange.sheetId},n.setAffectedSheetId=function(e){this.gridRange.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId);return t?[t]:[]},n.getAffectedGridRanges=function(){return[this.gridRange]},n.check=function(t){var n=e.prototype.check.call(this,t);if(!n.isValid)return n;if(!this.gridRange||!this.cellDataDeltaAtPositions)return{isValid:!1,errorMessage:"GridRange为空 或者 cellDataDeltaAtPositions为空 gridRange="+JSON.stringify(this.gridRange)+" cellDataDeltaAtPositions="+JSON.stringify(this.cellDataDeltaAtPositions)};var r=this.gridRange,o=t.properties.gridProperties;return(0,i.hj)(r.startRowIndex)&&(0,i.hj)(r.endRowIndex)&&(0,i.hj)(r.startColIndex)&&(0,i.hj)(r.endColIndex)?r.startRowIndex<0||r.endRowIndex>=o.rowCount||r.startColIndex<0||r.endColIndex>=o.colCount||r.endColIndex<r.startColIndex?{isValid:!1,errorMessage:"gridRange 范围不正确。 gridRange="+JSON.stringify(r)+" gridProperties="+JSON.stringify(o)}:{isValid:!0}:{isValid:!1,errorMessage:"gridRange index类型不是数字 girdRange="+JSON.stringify(r)}},n.run=function(t,n){return this.runMutationOptions={isLocal:!1},Object.assign(this.runMutationOptions,n),e.prototype.run.call(this,t,n)},n.runOnSheet=function(e){var t,n,r,i,o,s,a,d,h;for(r=0,i=this.cellDataDeltaAtPositions.length;r<i;r++)if(o=this.cellDataDeltaAtPositions[r].rowIndex,s=this.cellDataDeltaAtPositions[r].colIndex,d=this.cellDataDeltaAtPositions[r].cellDataDelta,(a=e.getCellDataAtPosition(o,s,{isIgnoreFilterView:!0}))&&0!==a.setSlots||0!==d.setSlots){var u=null===a||void 0===a?void 0:a.cloneMentionDetails(),l=null===a||void 0===a?void 0:a.getHyperlink(),c=(null===a||void 0===a?void 0:a.getDateReminderId())||null,f=(null===a||void 0===a?void 0:a.getTodoId())||null;((h=g.cellDataUtils.mergeDeltaToCellData(a,d))||a)&&(e.setCellDataAtPosition(o,s,h),e.mentionManager.updateMentions(u,(null===h||void 0===h?void 0:h.getMentionDetails())||void 0,o,s,{isReplay:null===(t=this.runMutationOptions)||void 0===t?void 0:t.isReplay,isCollab:null===(n=this.runMutationOptions)||void 0===n?void 0:n.isCollab}),e.hyperlinkManager.updateHyperlink(l?{rowIndex:o,colIndex:s}:null,(null===h||void 0===h?void 0:h.getHyperlink())?{rowIndex:o,colIndex:s,cellData:h}:null),e.dateReminderManager.updateDateReminder(c,a,h,o,s,this.runMutationOptions),e.todoManager.updateTodoRange(f,h,o,s))}},n.runOnFormulaModel=function(e){for(var t=e.formulaModelManager,n=0,r=this.cellDataDeltaAtPositions.length;n<r;n++){var i=this.cellDataDeltaAtPositions[n],o=i.rowIndex,s=i.colIndex,a=i.cellDataDelta,d=this.getAffectedSheetId();0===a.setSlots&&0===a.clearSlots||(t.addFormulaData({row:o,col:s,sheetId:d},a),t.addDataValidationData({row:o,col:s,sheetId:d},a))}t.updateFormulaModelManagerDataFinish()},n.invert=function(e){var n,r,i,o,s,a,d=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId),h=[];if(!d)return[];for(n=0,r=this.cellDataDeltaAtPositions.length;n<r;n++){i=this.cellDataDeltaAtPositions[n].rowIndex,o=this.cellDataDeltaAtPositions[n].colIndex,a=this.cellDataDeltaAtPositions[n].cellDataDelta,s=d.getCellDataAtPosition(i,o,{isIgnoreFilterView:!0});var u=g.cellDataUtils.invertCellDataDelta(s,a);(null===s||void 0===s?void 0:s.getPivotTableRef())&&((0,l.isCellContentModified)(a)&&u.clearSlot(g.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE),(0,l.isCellPivotRefModified)(a)&&u.clearSlot(g.CELL_DATA_SLOT.SLOT_PIVOT_TABLE_REF)),h.push({rowIndex:i,colIndex:o,cellDataDelta:u})}return[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:h})]},n.transformWithInsertDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n,r,i=this.gridRange.clone();i.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount});var o,s,a=[];for(n=0,r=this.cellDataDeltaAtPositions.length;n<r;n++)o=this.cellDataDeltaAtPositions[n],(s=new c.Z(this.gridRange.sheetId,o.rowIndex,o.rowIndex,o.colIndex,o.colIndex)).insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),s.endRowIndex===s.startRowIndex&&s.endColIndex===s.startColIndex&&a.push({rowIndex:s.startRowIndex,colIndex:s.startColIndex,cellDataDelta:(0,d.M)(o.cellDataDelta,e)});return 0===a.length?[]:[new t({gridRange:i,cellDataDeltaAtPositions:a})]},n.transformWithDeleteDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n,r,i=this.gridRange.clone();if(i.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),i.endRowIndex<i.startRowIndex||i.endColIndex<i.startColIndex)return[];var o,s,a=[];for(n=0,r=this.cellDataDeltaAtPositions.length;n<r;n++)o=this.cellDataDeltaAtPositions[n],(s=new c.Z(this.gridRange.sheetId,o.rowIndex,o.rowIndex,o.colIndex,o.colIndex)).deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),s.endRowIndex===s.startRowIndex&&s.endColIndex===s.startColIndex&&a.push({rowIndex:s.startRowIndex,colIndex:s.startColIndex,cellDataDelta:(0,d.M)(o.cellDataDelta,e)});return 0===a.length?[]:[new t({gridRange:i,cellDataDeltaAtPositions:a})]},n.transformWithSetRangeMutation=function(e,n){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var r,i;if(!this.gridRange.isCross(e.gridRange))return[this];var s=this.getTotalSlots(),a=e.getTotalSlots();if(0===((s.cellDataSetSlots|s.cellDataClearSlots)&(a.cellDataSetSlots|a.cellDataClearSlots)))return[this];if((0,o.fS)(this,e))return n?[this]:[];var d,h,u,l=[],c={};for(r=0,i=e.cellDataDeltaAtPositions.length;r<i;r++)c[h=(d=e.cellDataDeltaAtPositions[r]).rowIndex+","+d.colIndex]=d.cellDataDelta;for(r=0,i=this.cellDataDeltaAtPositions.length;r<i;r++)if(c[h=(d=this.cellDataDeltaAtPositions[r]).rowIndex+","+d.colIndex]){if((u=g.cellDataUtils.transformTwoCellDataDelta(d.cellDataDelta,c[h],n)).isEmpty())continue;l.push({rowIndex:d.rowIndex,colIndex:d.colIndex,cellDataDelta:u})}else l.push(d);return 0===l.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:l})]},n.transformWithSetCellPropertiesMutation=function(e,n){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var r,i;if(!this.gridRange.isCross(e.gridRange))return[this];var o=this.getTotalSlots();if(0===((o.cellDataSetSlots|o.cellDataClearSlots)&(e.cellDataDelta.setSlots|e.cellDataDelta.clearSlots)))return[this];var s,a,d=[];for(r=0,i=this.cellDataDeltaAtPositions.length;r<i;r++)if(s=this.cellDataDeltaAtPositions[r],e.gridRange.containCell(s.rowIndex,s.colIndex)){if((a=g.cellDataUtils.transformTwoCellDataDelta(s.cellDataDelta,e.cellDataDelta,n)).isEmpty())continue;d.push({rowIndex:s.rowIndex,colIndex:s.colIndex,cellDataDelta:a})}else d.push(s);return 0===d.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:d})]},n.transformWithMergeCellsMutation=function(e,n){if(this.gridRange.sheetId!==e.sheetId)return[this];var r,i,o=new c.Z(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(!this.gridRange.isCross(o))return[this];var s,a=[];for(r=0,i=this.cellDataDeltaAtPositions.length;r<i;r++){var d=s=this.cellDataDeltaAtPositions[r],h=d.rowIndex,l=d.colIndex;if(!o.containCell(h,l)||h===o.startRowIndex&&l===o.startColIndex)a.push(s);else if(n&&s.cellDataDelta.setSlots>0)return[new u.Z(o),this]}return 0===a.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:a})]},n.transformWithDeleteSheetMutation=function(e,t){return this.gridRange.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithCopyPasteMutation=function(e,t){var n=this;if(this.gridRange.sheetId!==e.sheetId)return[this];var r=[];if(t)r.push(this);else if(e.sheetId!==this.gridRange.sheetId)r.push(this);else{var i=e.getAffectedGridRanges(),o=!1,s=[];if(i.forEach((function(e){e.isCross(n.gridRange)&&(o=!0,s.push(e.getCross(n.gridRange)))})),o){var a=e.cellMask;s.forEach((function(e){e.each((function(e,t){n.cellDataDeltaAtPositions.forEach((function(r,i){var o=r.rowIndex,s=r.colIndex,d=r.cellDataDelta;if(o===e&&s===t){var h=Object.assign(Object.assign({},r),{cellDataDelta:(0,l.removeCrossSlotByMask)(d,a)});n.cellDataDeltaAtPositions[i]=h}}))}))})),r.push(this)}else r.push(this)}return r},n.transformWithReorderRangeMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n,r,i=this.gridRange.getCross(e.range);if(!i)return[this];var o,s,a,h=[];for(n=0,r=this.cellDataDeltaAtPositions.length;n<r;n++)if(o=this.cellDataDeltaAtPositions[n],i.containCell(o.rowIndex,o.colIndex)){if(null===(s=e.getOrderResult(o.rowIndex))){h.push(o);continue}a=(0,d.M)(o.cellDataDelta,e);var u=(0,d.L)(a);u.other&&!u.other.isEmpty()&&h.push({rowIndex:s,colIndex:o.colIndex,cellDataDelta:u.other}),u.borders&&!u.borders.isEmpty()&&h.push({rowIndex:o.rowIndex,colIndex:o.colIndex,cellDataDelta:u.borders})}else h.push(o);return 0===h.length?[]:[new t({gridRange:p.gridRangeUtils.getMinContainGridRange(this.gridRange,e.range),cellDataDeltaAtPositions:h})]},n.transformWithMapRangeMutation=function(e){if(this.gridRange.sheetId!==e.sourceSheetId)return[this];var n,r,i,o,s,a=this.gridRange.getCross(new c.Z(e.sourceSheetId,-1===e.row.from.startIndex?0:e.row.from.startIndex,-1===e.row.from.endIndex?Number.MAX_VALUE:e.row.from.endIndex,-1===e.column.from.startIndex?0:e.column.from.startIndex,-1===e.column.from.endIndex?Number.MAX_VALUE:e.column.from.endIndex)),u=[],l=[];if(!a){for(n=0,r=this.cellDataDeltaAtPositions.length;n<r;n++)i=this.cellDataDeltaAtPositions[n],u.push({rowIndex:i.rowIndex,colIndex:i.colIndex,cellDataDelta:(0,d.M)(i.cellDataDelta,e)});return 0===u.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:u})]}for(l.push(new h.Z({gridRange:a,cellDataDelta:new f.Z({clearSlots:g.CELL_DATA_SLOT_COMPOSE.ALL})})),n=0,r=this.cellDataDeltaAtPositions.length;n<r;n++)if(i=this.cellDataDeltaAtPositions[n],a.containCell(i.rowIndex,i.colIndex)){var I=e.row,p=e.column;o=-1===I.from.startIndex?i.rowIndex:i.rowIndex-I.from.startIndex+I.to,s=-1===p.from.startIndex?i.colIndex:i.colIndex-p.from.startIndex+p.to,l.push(new h.Z({gridRange:new c.Z(this.gridRange.sheetId,o,o,s,s),cellDataDelta:(0,d.M)(i.cellDataDelta,e)}))}else u.push({rowIndex:i.rowIndex,colIndex:i.colIndex,cellDataDelta:(0,d.M)(i.cellDataDelta,e)});return 0===u.length?l:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:u})].concat(l)},n.getTotalSlots=function(){var e,t,n,r={cellDataSetSlots:0,cellDataClearSlots:0,cellFormatSetSlots:0,cellFormatClearSlots:0};for(e=0,t=this.cellDataDeltaAtPositions.length;e<t;e++){n=this.cellDataDeltaAtPositions[e],r.cellDataSetSlots|=n.cellDataDelta.setSlots,r.cellDataSetSlots|=n.cellDataDelta.clearSlots;var i=n.cellDataDelta.delta.userEnteredFormatDelta;i&&(r.cellFormatSetSlots|=i.setSlots,r.cellFormatClearSlots|=i.clearSlots)}return r},t}(a.Z);v.protoMap={0:{name:"gridRange",dataType:c.Z},1:{name:"cellDataDeltaAtPositions",dataType:{type:Array,subType:{type:Object,protoMap:m}}}},t.Z=v},3230:function(e,t,n){"use strict";n.d(t,{L:function(){return u},M:function(){return h}});var r=n(26178),i=n(91974),o=r.Cell.CELL_DATA_SLOT,s=r.Cell.CellFormatDelta,a=r.Cell.CELL_FORMAT_SLOT,d=r.Cell.CELL_FORMAT_SLOT_COMPOSE;function h(e,t){return e}function u(e){var t,n,r=new i.Z,h=e,u=function(e,t,n,r){var i=e,o=1<<n;(e.setSlots&o)>0?t.setSlot(n,r):(e.clearSlots&o)>0&&t.clearSlot(n),i.removeSlot(n)};if((e.setSlots&1<<o.SLOT_USER_ENTERED_FORMAT_DELTA)>0){t=new s;var l=e.delta.userEnteredFormatDelta;n=l,u(l,t,a.BORDER_TOP,l.delta.getBorderTop()),u(l,t,a.BORDER_RIGHT,l.delta.getBorderRight()),u(l,t,a.BORDER_BOTTOM,l.delta.getBorderBottom()),u(l,t,a.BORDER_LEFT,l.delta.getBorderLeft()),r.setSlot(o.SLOT_USER_ENTERED_FORMAT_DELTA,t)}else(e.clearSlots&1<<o.SLOT_USER_ENTERED_FORMAT_DELTA)>0?(t=new s({clearSlots:d.BORDERS}),n=new s({clearSlots:d.ALL&~d.BORDERS}),r.setSlot(o.SLOT_USER_ENTERED_FORMAT_DELTA,t),h.setSlot(o.SLOT_USER_ENTERED_FORMAT_DELTA,n)):r=null;return{borders:r,other:h}}},49898:function(e,t,n){"use strict";var r=n(13504),i=(n(38934),n(31688),n(49502),n(8195),n(62883),n(26178)),o=n(38808),s=n(85249),a=n(97098),d=i.Rule.ConditionalFormatRule,h=i.Range.GridRange,u=function(e){function t(t){var n;return(n=e.call(this,o.ZP.ADD_CONDITIONAL_FORMAT_MUTATION,t)||this).sheetId=t.sheetId,n.ruleIndex=t.ruleIndex,n.rule=t.rule,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],ruleIndex:e[1],rule:d.deserialize(e[2])})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.ruleIndex,this.rule.serialize()]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){var t;this.sheetId=e,null===(t=this.rule.ruleRanges)||void 0===t||t.forEach((function(t){t.sheetId=e}))},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.getAffectedGridRanges=function(){return this.rule.ruleRanges},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){var t=e.conditionalFormatRuleManager.addConditionalFormatRule(this.ruleIndex,this.rule).id;e.spreadsheetReference.formulaModelManager.addConditionalFormatData(t,{id:t,rule:this.rule,index:this.ruleIndex})},n.invert=function(){return[new a.Z({sheetId:this.sheetId,ruleIndex:this.ruleIndex,oldRuleRanges:this.rule.ruleRanges})]},n.transformWithInsertDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&n.push(t))})),n.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new d({ruleRanges:n,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat})})]:[]},n.transformWithDeleteDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&n.push(t))})),n.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new d({ruleRanges:n,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat})})]:[]},n.transformWithMergeCellsMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=new h(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(this.rule.ruleRanges.some((function(e){return e.isCross(n)}))){var r=new h(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex,e.startColIndex);if(this.rule.ruleRanges.some((function(e){return e.contain(r)})))return[this];var i=[];return this.rule.ruleRanges.forEach((function(e){if(e.sheetId===n.sheetId&&e.isCross(n)){var t=e.startRowIndex,r=e.endRowIndex;e.startRowIndex<n.startRowIndex&&(i.push(new h(e.sheetId,e.startRowIndex,n.startRowIndex,e.startColIndex,e.endColIndex)),t=n.startRowIndex),n.endRowIndex<e.endRowIndex&&(i.push(new h(e.sheetId,n.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),r=n.endRowIndex),e.startColIndex<n.startColIndex&&i.push(new h(e.sheetId,t,r,e.startColIndex,n.endColIndex)),n.endColIndex<e.endColIndex&&i.push(new h(e.sheetId,t,r,n.endColIndex,e.endColIndex))}else i.push(e)})),0===i.length?[]:(i.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new d({ruleRanges:i,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat})})])}return[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithMapRangeMutation=function(e){if(this.sheetId!==e.sourceSheetId)return[this];var n=[],r=[],i=[],o=[];return this.rule.ruleRanges.forEach((function(t){if(t.sheetId===e.sourceSheetId){var s=[],a=new h(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.from.startIndex,-1===e.row.to?t.endRowIndex:e.row.from.endIndex,-1===e.column.to?t.startColIndex:e.column.from.startIndex,-1===e.column.to?t.endColIndex:e.column.from.endIndex),d=t.getCross(a);d&&(s.push(d),r.push(d),o.push(new h(e.sourceSheetId,-1===e.row.to?d.startRowIndex:d.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.to?d.endRowIndex:d.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.to?d.startColIndex:d.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.to?d.endColIndex:d.endColIndex-e.column.from.startIndex+e.column.to)));var u=new h(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.to,-1===e.row.to?t.endRowIndex:e.row.to+e.row.from.endIndex-e.row.from.startIndex,-1===e.column.to?t.startColIndex:e.column.to,-1===e.column.to?t.endColIndex:e.column.to+e.column.from.endIndex-e.column.from.startIndex),l=t.getCross(u);l&&(s.push(l),i.push(l)),d||l?s.forEach((function(e){var r=t.startRowIndex,i=t.endRowIndex;t.startRowIndex<e.startRowIndex&&(n.push(new h(t.sheetId,t.startRowIndex,e.startRowIndex,t.startColIndex,t.endColIndex)),r=e.startRowIndex),e.endRowIndex<t.endRowIndex&&(n.push(new h(t.sheetId,e.endRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)),i=e.endRowIndex),t.startColIndex<e.startColIndex&&n.push(new h(t.sheetId,r,i,t.startColIndex,e.endColIndex)),e.endColIndex<t.endColIndex&&n.push(new h(t.sheetId,r,i,e.endColIndex,t.endColIndex))})):n.push(t)}})),n.length>0||o.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new d({ruleRanges:[].concat(n,o),booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat})})]:[]},n.transformWithAddConditionalFormatMutation=function(e,n){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>e.ruleIndex||this.ruleIndex===e.ruleIndex&&n?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,rule:this.rule})]:[this]},n.transformWithDeleteConditionalFormatMutation=function(e,n){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,rule:this.rule})]:[this]},t}(s.Z);u.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"rule",dataType:i.Rule.ConditionalFormatRule}},t.Z=u},97098:function(e,t,n){"use strict";var r=n(13504),i=(n(90109),n(38934),n(31688),n(62883),n(26178)),o=n(38808),s=n(85249),a=n(49898),d=i.Range.GridRange,h=function(e){function t(t){var n;return(n=e.call(this,o.ZP.DELETE_CONDITIONAL_FORMAT_MUTATION,t)||this).sheetId=t.sheetId,n.ruleIndex=t.ruleIndex,n.oldRuleRanges=t.oldRuleRanges,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],ruleIndex:e[1],oldRuleRanges:e[2].map((function(e){return d.deserialize(e)}))})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.ruleIndex,this.oldRuleRanges.map((function(e){return e.serialize()}))]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){var t;this.sheetId=e,null===(t=this.oldRuleRanges)||void 0===t||t.forEach((function(t){t.sheetId=e}))},n.getAffectedGridRanges=function(){return this.oldRuleRanges},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){var t=e.spreadsheetReference.formulaModelManager,n=e.conditionalFormatRuleManager.getRuleByRuleIndex(this.ruleIndex);void 0!==(null===n||void 0===n?void 0:n.id)&&t.removeConditionalFormatData(n.id,this.oldRuleRanges),e.conditionalFormatRuleManager.deleteConditionalFormatRule(this.ruleIndex)},n.invert=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId).conditionalFormatRuleManager.getConditionalFormatRuleByRuleIndex(this.ruleIndex);return t?[new a.Z({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:t})]:[]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithAddConditionalFormatMutation=function(e,n){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>=e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,oldRuleRanges:this.oldRuleRanges})]:[this]},n.transformWithDeleteConditionalFormatMutation=function(e){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?[]:this.ruleIndex>e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,oldRuleRanges:this.oldRuleRanges})]:[this]},n.transformWithUpdateConditionalFormatMutation=function(e){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,oldRuleRanges:this.oldRuleRanges})]:[this]},t}(s.Z);h.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"oldRuleRanges",dataType:{type:Array,subType:d}}},t.Z=h},85145:function(e,t,n){"use strict";var r=n(13504),i=(n(90109),n(38934),n(31688),n(8195),n(49502),n(62883),n(26178)),o=n(38808),s=n(85249),a=i.Rule.ConditionalFormatRule,d=i.Range.GridRange,h=function(e){function t(t){var n;return(n=e.call(this,o.ZP.UPDATE_CONDITIONAL_FORMAT_MUTATION,t)||this).sheetId=t.sheetId,n.ruleIndex=t.ruleIndex,n.rule=t.rule,n.oldRuleRanges=t.oldRuleRanges,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],ruleIndex:e[1],rule:a.deserialize(e[2]),oldRuleRanges:e[3].map((function(e){return d.deserialize(e)}))})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.ruleIndex,this.rule.serialize(),this.oldRuleRanges.map((function(e){return e.serialize()}))]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){var t,n;this.sheetId=e,null===(t=this.rule.ruleRanges)||void 0===t||t.forEach((function(t){t.sheetId=e})),null===(n=this.oldRuleRanges)||void 0===n||n.forEach((function(t){t.sheetId=e}))},n.getAffectedGridRanges=function(){var e=[];return e.concat(this.oldRuleRanges),e.concat(this.rule.ruleRanges),e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(e){return{isValid:!0}},n.runOnSheet=function(e){var t=e.conditionalFormatRuleManager;t.updateConditionalFormatRule(this.ruleIndex,this.rule);var n=e.spreadsheetReference.formulaModelManager,r=t.getRuleByRuleIndex(this.ruleIndex);void 0!==(null===r||void 0===r?void 0:r.id)&&(n.removeConditionalFormatData(r.id,this.rule.ruleRanges),n.addConditionalFormatData(r.id,r))},n.invert=function(e){var n=e.sheetManager.getSheetBySheetId(this.sheetId).conditionalFormatRuleManager.getConditionalFormatRuleByRuleIndex(this.ruleIndex);return n?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:n,oldRuleRanges:this.rule.ruleRanges})]:[]},n.transformWithInsertDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&n.push(t))})),n.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new a({ruleRanges:n,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]},n.transformWithDeleteDimensionMutation=function(e,n){if(this.sheetId!==e.sheetId)return[this];var r=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&r.push(t))})),r.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new a({ruleRanges:r,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]},n.transformWithMergeCellsMutation=function(e,n){if(this.sheetId!==e.sheetId)return[this];var r=new d(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(this.rule.ruleRanges.some((function(e){return e.isCross(r)}))){var i=new d(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex,e.startColIndex);if(this.rule.ruleRanges.some((function(e){return e.contain(i)})))return[this];var o=[];return this.rule.ruleRanges.forEach((function(e){if(e.sheetId===r.sheetId&&e.isCross(r)){var t=e.startRowIndex,n=e.endRowIndex;e.startRowIndex<r.startRowIndex&&(o.push(new d(e.sheetId,e.startRowIndex,r.startRowIndex,e.startColIndex,e.endColIndex)),t=r.startRowIndex),r.endRowIndex<e.endRowIndex&&(o.push(new d(e.sheetId,r.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),n=r.endRowIndex),e.startColIndex<r.startColIndex&&o.push(new d(e.sheetId,t,n,e.startColIndex,r.endColIndex)),r.endColIndex<e.endColIndex&&o.push(new d(e.sheetId,t,n,r.endColIndex,e.endColIndex))}else o.push(e)})),0===o.length?[]:(o.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new a({ruleRanges:o,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat}),oldRuleRanges:this.oldRuleRanges})])}return[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithMapRangeMutation=function(e){if(this.sheetId!==e.sourceSheetId)return[this];var n=[],r=[],i=[],o=[];return this.rule.ruleRanges.forEach((function(t){if(t.sheetId===e.sourceSheetId){var s=[],a=new d(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.from.startIndex,-1===e.row.to?t.endRowIndex:e.row.from.endIndex,-1===e.column.to?t.startColIndex:e.column.from.startIndex,-1===e.column.to?t.endColIndex:e.column.from.endIndex),h=t.getCross(a);h&&(s.push(h),r.push(h),o.push(new d(e.sourceSheetId,-1===e.row.to?h.startRowIndex:h.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.to?h.endRowIndex:h.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.to?h.startColIndex:h.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.to?h.endColIndex:h.endColIndex-e.column.from.startIndex+e.column.to)));var u=new d(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.to,-1===e.row.to?t.endRowIndex:e.row.to+e.row.from.endIndex-e.row.from.startIndex,-1===e.column.to?t.startColIndex:e.column.to,-1===e.column.to?t.endColIndex:e.column.to+e.column.from.endIndex-e.column.from.startIndex),l=t.getCross(u);l&&(s.push(l),i.push(l)),h||l?s.forEach((function(e){var r=t.startRowIndex,i=t.endRowIndex;t.startRowIndex<e.startRowIndex&&(n.push(new d(t.sheetId,t.startRowIndex,e.startRowIndex,t.startColIndex,t.endColIndex)),r=e.startRowIndex),e.endRowIndex<t.endRowIndex&&(n.push(new d(t.sheetId,e.endRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)),i=e.endRowIndex),t.startColIndex<e.startColIndex&&n.push(new d(t.sheetId,r,i,t.startColIndex,e.endColIndex)),e.endColIndex<t.endColIndex&&n.push(new d(t.sheetId,r,i,e.endColIndex,t.endColIndex))})):n.push(t)}})),n.length>0||o.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new a({ruleRanges:[].concat(n,o),booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat,dataBarConditionalFormat:this.rule.dataBarConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]},n.transformWithAddConditionalFormatMutation=function(e,n){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>=e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,rule:this.rule,oldRuleRanges:this.oldRuleRanges})]:[this]},n.transformWithDeleteConditionalFormatMutation=function(e,n){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?[]:(this.ruleIndex>e.ruleIndex&&new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,rule:this.rule,oldRuleRanges:this.oldRuleRanges}),[this])},n.transformWithUpdateConditionalFormatMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?t?[this]:[]:[this]},t}(s.Z);h.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"rule",dataType:a},3:{name:"oldRuleRanges",dataType:{type:Array,subType:d}}},t.Z=h},61502:function(e,t,n){"use strict";n.d(t,{Ly:function(){return i},mz:function(){return o}});var r,i={DATA_VERSION_TOO_LOW:"mutation低版本打开高版本",MUTATION_VER_LOWER_THAN_SUPPORT:"mutation低于最低支持版本",CONVERT_MUTATION_ERROR:"mutation转换失败"},o={SERIALIZE_MUTATION:"SERIALIZE_MUTATION",DESERIALIZE_MUTATION_FAIL:"DESERIALIZE_MUTATION_FAIL",DESERIALIZE_MUTATION_CATCH_ERROR:"DESERIALIZE_MUTATION_CATCH_ERROR",DESERIALIZE_MUTATION_CATCH_ERROR_OLD:"DESERIALIZE_MUTATION_CATCH_ERROR_OLD",GET_COLLAB_MUTATIONS:"GET_COLLAB_MUTATIONS",FOLLOW_REQUEST_MUTATIONS:"FOLLOW_REQUEST_MUTATIONS",CHECK_MUTATION_ERROR:"CHECK_MUTATION_ERROR",CHECK_MUTATION_RESULT_ERROR:"CHECK_MUTATION_RESULT_ERROR",RUN_MUTATION_ERROR:"RUN_MUTATION_ERROR",AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR:"AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR",AFTER_MUTATION_RUN_CATCH_ERROR:"AFTER_MUTATION_RUN_CATCH_ERROR"};!function(e){e.MUTATIONS_RUN="mutations_run",e.AFTER_MUTATIONS_RUN="after_mutations_run"}(r||(r={}))},31160:function(e,t){"use strict";t.Z={MUTATION_VER:5,MUTATION_VER_LOWEST_SUPPORT:3}},94809:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(13504),i=(n(8195),n(46396),n(62883),n(26178)),o=n(81300),s=n(10752),a=n(47627),d=n(80067),h=n(38808),u=n(85249),l=n(99790),c=n(62962),f=n(75832),I=n(15),g=n(42313),p=n(20587),m=n(66676),v=n(78449),R=n(22459),x=n(49902);n(38934),n(31688),n(19553),n(81144);var T=n(70594),E=i.Dimension.DIMENSION_TYPE,w=i.Range.DimensionRange,y=i.Range.GridRange,S=i.Sheet.SheetPropertiesDelta,O=i.Sheet.NEW_SHEET_PROPERTIES_SLOT_OPERATION,D=i.Cell.cellDataUtils,M=function(e){function t(t){var n;return(n=e.call(this,h.ZP.DELETE_DIMENSION_MUTATION,t)||this).index=t.index,n.amount=t.amount,n.type=t.type,n.sheetId=t.sheetId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({index:e[0],amount:e[1],sheetId:e[2],type:e[3]})};var n=t.prototype;return n.serialize=function(){return[this.index,this.amount,this.sheetId,this.type]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.sheetId))&&n.push(t),n},n.check=function(e){if(this.type!==E.ROWS&&this.type!==E.COLUMNS)return{isValid:!1,errorMessage:"type不是行也不是列。 "+this.type};var t=e.properties.gridProperties,n=this.type===E.ROWS?t.rowCount:t.colCount;return!(0,d.hj)(this.index)||this.index<0||this.index>=n?{isValid:!1,errorMessage:"index值不规范 index="+this.index+" dimensionCount="+n}:!(0,d.hj)(this.amount)||this.amount<=0||this.index+this.amount>n?{isValid:!1,errorMessage:"amount值不规范 amount="+this.amount+" index="+this.index+"  dimensionCount="+n}:{isValid:!0}},n.runOnSheet=function(e){e.deleteDimension({sheetId:this.sheetId,index:this.index,amount:this.amount,type:this.type})},n.runOnWorkbook=function(e){return e.deleteDimension({sheetId:this.sheetId,type:this.type,index:this.index,amount:this.amount}),!0},n.runOnFormulaModel=function(e){e.deleteDimensionForFormulaModel({sheetId:this.sheetId,type:this.type,index:this.index,amount:this.amount})},n.invert=function(e){var t,n,r=e.sheetManager.getSheetBySheetId(this.sheetId),i=[];if(null===r)return i;if(this.type!==E.ROWS&&this.type!==E.COLUMNS)return console.warn("DIMENSION_TYPE error"),i;i.push(new l.Z({index:this.index,amount:this.amount,type:this.type,sheetId:this.sheetId})),t=new w(this.sheetId,this.index,this.index+this.amount-1,this.type),i=i.concat((0,c.OR)({sheet:r,type:this.type,ranges:[t]},Object.assign(Object.assign({},c.Sb),{needDefaultProperties:!0}))),n=this.type===E.ROWS?new y(this.sheetId,this.index,this.index+this.amount-1,0,r.getColCount()-1):new y(this.sheetId,0,r.getRowCount()-1,this.index,this.index+this.amount-1);var o=this.getSetRangeMutation(r,n);if(o&&i.push(o),this.type===E.ROWS){var s=r.getFrozenRowCount();this.index<s&&this.index+this.amount>=s&&i.push(new p.Z({sheetId:this.sheetId,sheetDelta:new S({operation:O.SET_PROPERTIES,delta:{frozenRowCount:s}})}))}else if(this.type===E.COLUMNS){var a=r.getFrozenColCount();this.index<a&&this.index+this.amount>=a&&i.push(new p.Z({sheetId:this.sheetId,sheetDelta:new S({operation:O.SET_PROPERTIES,delta:{frozenColCount:a}})}))}this.invertOnMerges(i,r,t);var d=(0,T.lO)(e).getInvertMutationsForDeleteDimensionMutation(this);return i=i.concat(d),this.invertOnImages(i,r),this.invertOnDataValidation(i,e),i},n.invertOnMerges=function(e,t,n){var r=this;t.mergeManager.each((function(i){var o=i.startRowIndex,s=i.startColIndex,a=t.getCellDataAtPosition(o,s);(null===a||void 0===a?void 0:a.getPivotTableRef())||(r.type===E.ROWS&&n.isCross(new w(i.sheetId,i.startRowIndex,i.endRowIndex,E.ROWS))||r.type===E.COLUMNS&&n.isCross(new w(i.sheetId,i.startColIndex,i.endColIndex,E.COLUMNS)))&&e.push(new I.Z(i.clone()))})),t.sheetRangeManager.each((function(t,n){(r.type===E.ROWS&&t.gridRange.startRowIndex>=r.index&&t.gridRange.endRowIndex<=r.index+r.amount-1||r.type===E.COLUMNS&&t.gridRange.startColIndex>=r.index&&t.gridRange.endColIndex<=r.index+r.amount-1)&&e.push(new m.Z({sheetId:t.sheetId,sheetRangeId:n,sheetRangeType:t.sheetRangeType,padId:t.padId,gridRange:t.gridRange.clone(),sheetRangeDelta:new v.Z({commentSheetRangeProperties:new R.Z({isArchived:t.properties.isArchived})})}))}))},n.invertOnImages=function(e,t){var n=this.index,r=this.amount;this.type===E.ROWS?t.imageManager.each((function(t){var i=t.position.overlayPosition.anchorCell.rowIndex;i>=n&&i<n+r&&e.push(new g.Z({data:t.toObject()}))})):this.type===E.COLUMNS&&t.imageManager.each((function(t){var i=t.position.overlayPosition.anchorCell.colIndex;i>=n&&i<n+r&&e.push(new g.Z({data:t.toObject()}))}))},n.invertOnDataValidation=function(e,t){var n=this;!function(e,t){e.sheetManager.getSheetIdList().forEach((function(n){e.sheetManager.getSheetBySheetId(n)&&function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e);r&&r.data.rowData.forEach((function(t,r){t&&t.values.forEach((function(t,i){t&&n({row:r,col:i,sheetId:e,cellData:t})}))}))}(n,e,t)}))}(t,(function(t){var r,d,h=t.row,u=t.col,l=t.sheetId,c=t.cellData.getDataValidation();if(c&&c.ruleType===o.DATA_VALIDATION_RULE_TYPE.LIST&&(null===(d=null===(r=c.argTokens)||void 0===r?void 0:r[0])||void 0===d?void 0:d.type)===a.ARG_TOKEN_TYPE.FORMULA_TOKEN){var f=c.argTokens[0].formula;if(!f)return;if(!f.isAffectedByRowColDel({index:n.index,amount:n.amount,isRow:n.type===i.Dimension.DIMENSION_TYPE.ROWS,sheetId:n.sheetId,nodeSheetId:l,row:h,col:u}))return;var I=new o.CellDataDelta;I.setSlot(o.CELL_DATA_SLOT.SLOT_DATA_VALIDATION_RULE,s.Z.createInstance(Object.assign({},c.getOptions())));var g=new x.Z({gridRange:new y(l,h,h,u,u),cellDataDelta:I});e.push(g)}}))},n.getSetRangeMutation=function(e,t){for(var n=[],r=t.startRowIndex;r<=t.endRowIndex;r++)for(var i=t.startColIndex;i<=t.endColIndex;i++){var o=e.getCellDataAtPosition(r,i),s=D.createCellDataDelta(null,o);s.isEmpty()||(null===o||void 0===o?void 0:o.getPivotTableRef())||n.push({rowIndex:r,colIndex:i,cellDataDelta:s})}return n.length>0?new f.Z({gridRange:t,cellDataDeltaAtPositions:n}):null},n.isConflict=function(e){return this.sheetId===e.sheetId&&this.type===e.type},n.transformWithInsertDimensionMutation=function(e){if(!this.isConflict(e))return[this];var n,r,i=[],o=new w(this.sheetId,this.index,this.index+this.amount-1,this.type);o.insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var s=o.toDimensionData();return n=s.index,r=s.amount,i.push(new t({index:n,amount:r,sheetId:this.sheetId,type:this.type})),i},n.transformWithDeleteDimensionMutation=function(e){if(!this.isConflict(e))return[this];var n,r,i=[],o=new w(this.sheetId,this.index,this.index+this.amount-1,this.type);o.deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var s=o.toDimensionData();return n=s.index,0===(r=s.amount)||i.push(new t({index:n,amount:r,sheetId:this.sheetId,type:this.type})),i},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},t}(u.Z);M.protoMap={0:{name:"index",dataType:Number},1:{name:"amount",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"type",dataType:String}};var C=M},99790:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r,i=n(58926),o=n(13504),s=(n(8195),n(62883),n(26178)),a=n(38808),d=n(85249),h=n(80067),u=n(49902),l=n(15),c=s.Dimension.DIMENSION_TYPE,f=s.Range.DimensionRange,I=s.Range.GridRange,g=s.Cell.CellDataDelta,p=s.Cell.CELL_DATA_SLOT,m=s.Cell.cellFormatUtils;function v(e,t,n,r){var i=function(e,t,n){var r,i,o=[];return e.mergeManager.each((function(s){var a;r=!1,(null===(a=e.getCellDataAtPosition(s.startRowIndex,s.startColIndex))||void 0===a?void 0:a.getPivotTableRef())||(t===c.ROWS?n>s.startRowIndex&&n<=s.endRowIndex&&(r=!0):t===c.COLUMNS&&n>s.startColIndex&&n<=s.endColIndex&&(r=!0),r&&(i=e.getCellDataAtPosition(s.startRowIndex,s.startColIndex),o.push({userEnterFormat:(null===i||void 0===i?void 0:i.getUserEnteredFormat())||null,gridRange:s})))})),o}(e,n,r);return{mergeData:i}}function R(e,t,n,r,i){var o=[],s=[];switch(e.id){case a.ZP.SET_RANGE_MUTATION:case a.ZP.SET_CELL_PROPERTIES_MUTATION:break;case a.ZP.MERGE_CELLS_MUTATION:o=function(e,t,n,r){var i=!1;return t===e.sheetId&&(n===c.ROWS?r>e.startRowIndex&&r<=e.endRowIndex&&(i=!0):n===c.COLUMNS&&r>e.startColIndex&&r<=e.endColIndex&&(i=!0)),i?[{userEnterFormat:null,gridRange:new I(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)}]:[]}(e,n,r,i);break;case a.ZP.UPDATE_FILTERS_MODEL_MUTATION:case a.ZP.ADD_EMBEDDED_OBJECT_MUTATION:case a.ZP.UPDATE_EMBEDDED_OBJECT_MUTATION:case a.ZP.COPY_PASTE_MUTATION:case a.ZP.REORDER_RANGE_MUTATION:break;case a.ZP.DEFINE_WORKBOOK_RANGE_MUTATION:s=function(e,t,n,r){var i=!1;return t!==e.gridRange.sheetId||e.gridRange.isSheet||(n===c.ROWS?r>e.gridRange.startRowIndex&&r<=e.gridRange.endRowIndex&&(i=!0):n===c.COLUMNS&&r>e.gridRange.startColIndex&&r<=e.gridRange.endColIndex&&(i=!0)),i?[e.clone()]:[]}(e,n,r,i)}return{mergeData:o,workbookRange:s}}function x(e,t,n,i,o){var s=[];return function(e,t,n,i,o,s){var a,d,h,f,v;for(a=0,d=e.mergeData.length;a<d;a++)(f=T(t,(h=e.mergeData[a]).gridRange,n,i,o)).isValid()&&!f.isSingle()&&s.push(new l.Z({sheetId:f.sheetId,startRowIndex:f.startRowIndex,endRowIndex:f.endRowIndex,startColIndex:f.startColIndex,endColIndex:f.endColIndex})),v=n===c.ROWS?h.gridRange.startRowIndex:h.gridRange.startColIndex,t===r.DELETE&&h.userEnterFormat&&f.isValid()&&v>=i&&v<=i+o&&s.push(new u.Z({gridRange:new I(f.sheetId,f.startRowIndex,f.startRowIndex,f.startColIndex,f.startColIndex),cellDataDelta:new g({setSlots:1<<p.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:m.createCellFormatDelta(null,h.userEnterFormat)}})}))}(e,t,n,i,o,s),function(e,t,n,r,i,o){var s,a,d=e.workbookRange;if(void 0!==d)for(s=0;s<d.length;s++)(a=T(t,d[s].gridRange,n,r,i)).isValid()&&(d[s].gridRange=a,o.push(d[s]))}(e,t,n,i,o,s),s}function T(e,t,n,i,o){var s;switch(e){case 0:return(s=n===c.ROWS?new f(t.sheetId,t.startRowIndex,t.endRowIndex,c.ROWS):new f(t.sheetId,t.startColIndex,t.endColIndex,c.COLUMNS)).insertDimension({sheetId:t.sheetId,index:i,amount:o,type:n}),n===c.ROWS?new I(t.sheetId,s.startIndex,s.endIndex,t.startColIndex,t.endColIndex):new I(t.sheetId,t.startRowIndex,t.endRowIndex,s.startIndex,s.endIndex);case 1:return(s=n===c.ROWS?new f(t.sheetId,t.startRowIndex,t.endRowIndex,c.ROWS):new f(t.sheetId,t.startColIndex,t.endColIndex,c.COLUMNS)).deleteDimension({sheetId:t.sheetId,index:i,amount:o,type:n}),n===c.ROWS?new I(t.sheetId,s.startIndex,s.endIndex,t.startColIndex,t.endColIndex):new I(t.sheetId,t.startRowIndex,t.endRowIndex,s.startIndex,s.endIndex);case r.UNDO_INSERT:case r.UNDO_DELETE:return t}return t}!function(e){e[e.INSERT=0]="INSERT",e[e.DELETE=1]="DELETE",e[e.UNDO_INSERT=2]="UNDO_INSERT",e[e.UNDO_DELETE=3]="UNDO_DELETE"}(r||(r={}));var E=n(94809),w=s.Dimension.DIMENSION_TYPE,y=function(e){function t(t){var n;return(n=e.call(this,a.ZP.INSERT_DIMENSION_MUTATION,t)||this).index=t.index,n.amount=t.amount,n.type=t.type,n.sheetId=t.sheetId,n}(0,o.Z)(t,e),t.deserialize=function(e){return new t({index:e[0],amount:e[1],sheetId:e[2],type:e[3]})};var n=t.prototype;return n.serialize=function(){return[this.index,this.amount,this.sheetId,this.type]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(e){if(this.type!==w.ROWS&&this.type!==w.COLUMNS)return{isValid:!1,errorMessage:"type不是行也不是列。 "+this.type};var t=e.properties.gridProperties,n=this.type===w.ROWS?t.rowCount:t.colCount;return!(0,h.hj)(this.index)||this.index<0||this.index>n?{isValid:!1,errorMessage:"index值不规范 index="+this.index+" dimensionCount="+n}:!(0,h.hj)(this.amount)||this.amount<=0?{isValid:!1,errorMessage:"amount值不规范 amount="+this.amount+" index="+this.index+"  dimensionCount="+n}:{isValid:!0}},n.runOnSheet=function(e){e.insertDimension({sheetId:this.sheetId,index:this.index,amount:this.amount,type:this.type})},n.runOnWorkbook=function(e){return e.insertDimension({sheetId:this.sheetId,type:this.type,index:this.index,amount:this.amount}),!0},n.runOnFormulaModel=function(e){e.insertDimensionForFormulaModel({sheetId:this.sheetId,type:this.type,index:this.index,amount:this.amount})},n.invert=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=[];if(n.push(new E.Z({index:this.index,amount:this.amount,type:this.type,sheetId:this.sheetId})),!t)return n;var o=x(v(t,r.INSERT,this.type,this.index),r.UNDO_INSERT,this.type,this.index,this.amount);return n=[].concat((0,i.Z)(n),(0,i.Z)(o))},n.transform=function(t,n){var o=R(t,r.INSERT,this.sheetId,this.type,this.index),s=e.prototype.transform.call(this,t,n),a=x(o,r.INSERT,this.type,this.index,this.amount);return[].concat((0,i.Z)(s),(0,i.Z)(a))},n.isConflictWithCollabMutation=function(e){return this.sheetId===e.sheetId&&this.type===e.type},n.transformWithInsertDimensionMutation=function(e,n){if(!this.isConflictWithCollabMutation(e))return[this];var r=this.index;return(this.index>e.index||n&&this.index===e.index)&&(r=this.index+e.amount),[new t({index:r,amount:this.amount,type:this.type,sheetId:this.sheetId})]},n.transformWithDeleteDimensionMutation=function(e){return this.isConflictWithCollabMutation(e)?this.index<=e.index?[this]:this.index>=e.index+e.amount?[new t({index:this.index-e.amount,amount:this.amount,type:this.type,sheetId:this.sheetId})]:[]:[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},t}(d.Z);y.protoMap={0:{name:"index",dataType:Number},1:{name:"amount",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"type",dataType:String}};var S=y},62962:function(e,t,n){"use strict";n.d(t,{Dk:function(){return O},OR:function(){return y},P8:function(){return f},Sb:function(){return v}}),n(15770),n(84919),n(26894),n(71091),n(52865),n(13857),n(54371),n(95019),n(19553),n(81144);var r=n(13504),i=(n(73368),n(62883),n(90109),n(38934),n(31688),n(41031),n(26178)),o=n(38808),s=n(85249),a=n(90945),d=n(3639),h=n(18384),u=n(10752);function l(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f,I=i.Dimension.DimensionFormData,g=i.Dimension.DIMENSION_TYPE,p=i.Dimension.DimensionPropertiesFactory,m=i.Range.DimensionRange,v=Object.freeze({needDefaultProperties:!1,hiddenByUser:!0,pixelSize:!0,ignoreDefaultHidden:!0,ignoreDefaultSize:!0,formData:!0,columnTypeMetadata:!0,ignoreValidateRows:!0,ignoreInvalidError:!0,dataValidation:!0});!function(e){e[e.SLOT_SIZE=1]="SLOT_SIZE",e[e.SLOT_HIDDEN=2]="SLOT_HIDDEN",e[e.SLOT_FORMDATA=3]="SLOT_FORMDATA",e[e.SLOT_COLUMN_TYPE_METADATA=7]="SLOT_COLUMN_TYPE_METADATA",e[e.SLOT_IGNORE_VALIDATE_ROWS=8]="SLOT_IGNORE_VALIDATE_ROWS",e[e.SLOT_IGNORE_INVALID_ERROR=9]="SLOT_IGNORE_INVALID_ERROR",e[e.SLOT_DATA_VALIDATION=10]="SLOT_DATA_VALIDATION"}(f||(f={}));var R={0:{name:"slot",dataType:Number},1:{name:"size",dataType:Number},2:{name:"hidden",dataType:Number},3:{name:"formData",dataType:I}},x=function(e){var t,n,r=[e.slot,null!==e.slotOperation?e.slotOperation:a.Z.SET_SLOT];switch(e.slot){case f.SLOT_SIZE:r[2]=e.size;break;case f.SLOT_HIDDEN:r[2]=e.hidden;break;case f.SLOT_FORMDATA:r[2]=e.formData?e.formData.serialize():null;break;case f.SLOT_COLUMN_TYPE_METADATA:r[2]=(null===(t=e.columnTypeMetadata)||void 0===t?void 0:t.serialize())||null;break;case f.SLOT_IGNORE_VALIDATE_ROWS:r[2]=e.ignoreValidateRows;break;case f.SLOT_IGNORE_INVALID_ERROR:r[2]=e.ignoreInvalidError;break;case f.SLOT_DATA_VALIDATION:r[2]=(null===(n=e.dataValidation)||void 0===n?void 0:n.serialize())||null}return r},T=function(e){var t={slot:e[0],slotOperation:e[1]};switch(e[0]){case f.SLOT_SIZE:t.size=e[2];break;case f.SLOT_HIDDEN:t.hidden=e[2];break;case f.SLOT_FORMDATA:t.formData=e[2]?I.deserialize(e[2]):null;break;case f.SLOT_COLUMN_TYPE_METADATA:t.columnTypeMetadata=e[2]?(0,h.F)(e[2]):null;break;case f.SLOT_IGNORE_VALIDATE_ROWS:t.ignoreValidateRows=e[2];break;case f.SLOT_IGNORE_INVALID_ERROR:t.ignoreInvalidError=e[2];break;case f.SLOT_DATA_VALIDATION:t.dataValidation=e[2]?(0,u.D)(e[2]):null}return t},E=function(e){function t(t){var n;(n=e.call(this,o.ZP.SET_DIMENSION_PROPERTIES_MUTATION,t)||this).ranges=[];for(var r=0;r<t.ranges.length;r++)t.ranges[r].endIndex>=t.ranges[r].startIndex&&n.ranges.push(t.ranges[r]);return n.operation=t.operation,n.type=t.type,n.sheetId=t.sheetId,n.filterViewId=t.filterViewId,n}(0,r.Z)(t,e),t.deserialize=function(e){var n,r,i=[],o=[];for(n=0,r=e[1].length;n<r;n++)i.push(new m(e[0],e[1][n][0],e[1][n][1],e[3]));for(n=0,r=e[2].length;n<r;n++)o.push(T(e[2][n]));return new t({sheetId:e[0],ranges:i,operation:o,type:e[3],filterViewId:e[4]})};var s=t.prototype;return s.serialize=function(){var e,t,n=[],r=[];for(e=0,t=this.ranges.length;e<t;e++)n.push([this.ranges[e].startIndex,this.ranges[e].endIndex]);for(e=0,t=this.operation.length;e<t;e++)r.push(x(this.operation[e]));return[this.sheetId,n,r,this.type,this.filterViewId]},s.getAffectedSheetId=function(){return this.sheetId},s.getAffectedGridRanges=function(){var e=this,t=n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(this.sheetId);return this.ranges.map((function(n){return e.type===i.Dimension.DIMENSION_TYPE.ROWS?new i.Range.GridRange({sheetId:e.sheetId,startRowIndex:n.startIndex,endRowIndex:n.endIndex,startColIndex:0,endColIndex:t.getColCount()-1}):new i.Range.GridRange({sheetId:e.sheetId,startColIndex:n.startIndex,endColIndex:n.endIndex,startRowIndex:0,endRowIndex:t.getRowCount()-1})}))},s.setAffectedSheetId=function(e){this.sheetId=e,this.ranges.forEach((function(t){t.sheetId=e}))},s.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},s.check=function(e){if(!this.ranges||!this.operation)return{isValid:!1,errorMessage:"ranges为空 或者 operation为空 ranges="+JSON.stringify(this.ranges)+" operation="+JSON.stringify(this.operation)};var t,n,r,i=this.ranges,o=e.properties.gridProperties;if(this.type!==g.ROWS&&this.type!==g.COLUMNS)return{isValid:!1,errorMessage:"type不是行也不是列。 "+this.type};for(t=0,n=i.length;t<n;t++){if(!(r=i[t]).isValid())return{isValid:!1,errorMessage:"dimensionRange值非法 "+JSON.stringify(r)};if(this.type===g.ROWS){if(r.endIndex>=o.rowCount)return{isValid:!1,errorMessage:"dimensionRange超出rowCount范围 dimensionRange="+JSON.stringify(r)+" gridPreperties="+JSON.stringify(o)}}else if(this.type===g.COLUMNS&&r.endIndex>=o.colCount)return{isValid:!1,errorMessage:"dimensionRange超出colCount范围 dimensionRange="+JSON.stringify(r)+" gridPreperties="+JSON.stringify(o)}}return{isValid:!0}},s.runOnSheet=function(e){for(var t=0,n=e.filterViewManager.getFilterViewByViewId(this.filterViewId);t<this.operation.length;t++)switch(this.operation[t].slot){case f.SLOT_SIZE:this.setDimensionSize(e,this.operation[t]);break;case f.SLOT_HIDDEN:n?this.setDimensionHiddenOnFilterView(n,this.operation[t]):this.setDimensionHidden(e,this.operation[t]);break;case f.SLOT_FORMDATA:this.setDimensionFormData(e,this.operation[t]);break;case f.SLOT_COLUMN_TYPE_METADATA:this.setColumnTypeMetadata(e,this.operation[t]);break;case f.SLOT_IGNORE_VALIDATE_ROWS:this.setIgnoreValidateRows(e,this.operation[t]);break;case f.SLOT_IGNORE_INVALID_ERROR:this.setIgnoreInvalidError(e,this.operation[t]);break;case f.SLOT_DATA_VALIDATION:this.setDataValidation(e,this.operation[t])}},s.setColumnTypeMetadata=function(e,t){var n=this;this.ranges.forEach((function(r){var i=r.startIndex,o=r.endIndex;n.type===g.COLUMNS&&e.data.setColsTypeMetadata(i,o,t.columnTypeMetadata||null)}))},s.setIgnoreValidateRows=function(e,t){var n=this;this.ranges.forEach((function(r){var i=r.startIndex,o=r.endIndex;n.type===g.COLUMNS&&e.data.setColsIgnoreValidateRows(i,o,t.ignoreValidateRows)}))},s.setIgnoreInvalidError=function(e,t){var n=this;this.ranges.forEach((function(r){var i=r.startIndex,o=r.endIndex;n.type===g.COLUMNS&&e.data.setColsIgnoreInvalidError(i,o,t.ignoreInvalidError)}))},s.setDataValidation=function(e,t){var n=this;this.ranges.forEach((function(r){var i=r.startIndex,o=r.endIndex;n.type===g.COLUMNS&&e.data.setColsDataValidation(i,o,t.dataValidation||null)}))},s.setDimensionFormData=function(e,t){var n,r,i=this;this.ranges.forEach((function(o){n=o.startIndex,r=o.endIndex,i.type===g.ROWS?e.data.setRowsFormData(n,r,t.formData):i.type===g.COLUMNS&&e.data.setColsFormData(n,r,t.formData)}))},s.setDimensionSize=function(e,t){var n=this;this.ranges.forEach((function(r){n.type===g.ROWS?e.setRowsHeight(r,t.size,n.filterViewId):n.type===g.COLUMNS&&e.setColsWidth(r,t.size,n.filterViewId)}))},s.setDimensionHidden=function(e,t){for(var n,r=0;r<this.ranges.length;r++)n=this.ranges[r],this.type===g.ROWS?t.hidden?e.data.hideRows(n.startIndex,n.endIndex):e.data.showRows(n.startIndex,n.endIndex):this.type===g.COLUMNS&&(t.hidden?e.data.hideCols(n.startIndex,n.endIndex):e.data.showCols(n.startIndex,n.endIndex))},s.setDimensionHiddenOnFilterView=function(e,t){for(var n,r=l(this.ranges);!(n=r()).done;){var i=n.value;this.type===g.ROWS?t.hidden?e.hideRows(i.startIndex,i.endIndex):e.showRows(i.startIndex,i.endIndex):this.type===g.COLUMNS&&(t.hidden?e.hideCols(i.startIndex,i.endIndex):e.showCols(i.startIndex,i.endIndex))}},s.invert=function(e){for(var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId),r=n.filterViewManager.getFilterViewByViewId(this.filterViewId),i=this.type,o=this.ranges,s=0;s<this.operation.length;s++){var a=[];switch(this.operation[s].slot){case f.SLOT_SIZE:a=y({sheet:n,type:i,ranges:o},{needDefaultProperties:!0,pixelSize:!0,ignoreDefaultSize:!1});break;case f.SLOT_HIDDEN:a=y({sheet:n,type:i,ranges:o,filterView:r},{needDefaultProperties:!0,hiddenByUser:!0});break;case f.SLOT_FORMDATA:a=y({sheet:n,type:i,ranges:o},{needDefaultProperties:!0,formData:!0});break;case f.SLOT_COLUMN_TYPE_METADATA:a=y({sheet:n,type:i,ranges:o},{needDefaultProperties:!0,columnTypeMetadata:!0});break;case f.SLOT_IGNORE_VALIDATE_ROWS:a=y({sheet:n,type:i,ranges:o},{ignoreValidateRows:!0});break;case f.SLOT_IGNORE_INVALID_ERROR:a=y({sheet:n,type:i,ranges:o},{ignoreInvalidError:!0});break;case f.SLOT_DATA_VALIDATION:a=y({sheet:n,type:i,ranges:o},{dataValidation:!0})}Array.prototype.push.apply(t,a)}return t},s.isConflict=function(e){return this.sheetId===e.sheetId&&this.type===e.type},s.transformWithInsertDimensionMutation=function(e){if(!this.isConflict(e))return[this];for(var n,r=[],i=0,o=[];i<this.ranges.length;i++)(n=this.ranges[i].clone()).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),o.push(n);return r.push(new t({ranges:o,operation:this.operation,type:this.type,sheetId:this.sheetId,filterViewId:this.filterViewId})),r},s.transformWithDeleteDimensionMutation=function(e){if(!this.isConflict(e))return[this];for(var n,r=[],i=0,o=[];i<this.ranges.length;i++)(n=this.ranges[i].clone()).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),n.endIndex<n.startIndex||o.push(n);return 0===o.length||r.push(new t({ranges:o,operation:this.operation,type:this.type,sheetId:this.sheetId,filterViewId:this.filterViewId})),r},s.transformWithSetDimensionPropertiesMutation=function(e,n){if(!this.isConflict(e))return[this];var r,i=0,o=0,s=0,a=[],d=[];for(i=0;i<this.operation.length;i++){for(o=0;o<e.operation.length;o++)if(this.operation[i].slot===e.operation[o].slot){for(r=w(this.ranges,e.ranges,n),s=0;s<r.length;s++)d=r[s],a.push(new t({ranges:d,operation:[this.operation[i]],type:this.type,sheetId:this.sheetId,filterViewId:this.filterViewId}));o=0;break}0!==o&&a.push(new t({ranges:this.ranges,operation:[this.operation[i]],type:this.type,sheetId:this.sheetId,filterViewId:this.filterViewId}))}return a},s.transformWithMapRangeMutation=function(e){if(this.sheetId!==e.sourceSheetId)return[this];var n,r,i=[],o=0,s=[];if((0,d.O)(this.type,e)){if(this.type===g.ROWS)n=e.row;else{if(this.type!==g.COLUMNS)return console.warn("DIMENSION_TYPE error"),i;n=e.column}for(;o<this.ranges.length;o++)r=this.ranges[o].clone(),Array.prototype.push.apply(s,r.move({from:n.from,to:n.to}));i.push(new t({ranges:s,operation:this.operation,type:this.type,sheetId:this.sheetId,filterViewId:this.filterViewId}))}else i.push(this);return i},s.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},s.transformWithDeleteFilterViewMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:this.filterViewId&&t&&this.filterViewId===e.filterViewId?[]:[this]},t}(s.Z);function w(e,t,n){var r,i=0,o=0,s=0,a=[];for(i=0;i<e.length;i++)for(o=0;o<t.length;o++){for(r=e[i].divideByCross(t[o]),s=0;s<r.ranges.length;s++)r.ranges[s].endIndex<r.ranges[s].startIndex&&(r.ranges.splice(s,1),s-=1);r.ranges.length&&a.push(r.ranges),n&&r.cross&&a.push([r.cross])}return a}function y(e,t){void 0===t&&(t=v);for(var n=[],r=e.sheet,i=e.type,o=e.ranges,s=e.filterView,a=0;a<o.length;a++)for(var d=o[a],h=d.startIndex,u=d.endIndex,l=h;l<=u;){var c=S({sheet:r,type:i,config:t,startIndex:l,maxIndex:u,filterView:s}),f=c.startIndex,I=c.endIndex,g=c.dimensionProperties;if(l=I+1,g){var p=O(g,t);p.length&&n.push(new E({ranges:[new m(d.sheetId,f,I,i)],operation:p,type:i,sheetId:d.sheetId,filterViewId:null===s||void 0===s?void 0:s.filterViewId}))}}return n}function S(e){var t=e.sheet,n=e.type,r=e.config,i=e.startIndex,o=e.maxIndex,s=null,a=e.filterView||t,d=a.getDimensionProperties(i,n);d||(d=s=r.needDefaultProperties?p.createInstance():null);for(var h=i+1;h<=o;h++){var u=a.getDimensionProperties(h,n)||s;if(!(d===u||d&&u&&d.equal(u,r)))break}return{startIndex:i,endIndex:h-1,dimensionProperties:d}}function O(e,t){var n=[];return t.pixelSize&&(e.pixelSize?n.push({slot:f.SLOT_SIZE,size:e.pixelSize}):t.clearDefaultSize?n.push({slot:f.SLOT_SIZE,size:null}):t.ignoreDefaultSize||n.push({slot:f.SLOT_SIZE,size:null})),t.hiddenByUser&&(e.hiddenByUser?n.push({slot:f.SLOT_HIDDEN,hidden:1}):t.ignoreDefaultHidden||n.push({slot:f.SLOT_HIDDEN,hidden:0})),t.formData&&(e.formData?n.push({slot:f.SLOT_FORMDATA,formData:e.formData}):n.push({slot:f.SLOT_FORMDATA,formData:null})),t.columnTypeMetadata&&n.push({slot:f.SLOT_COLUMN_TYPE_METADATA,columnTypeMetadata:e.columnTypeMetadata}),t.ignoreValidateRows&&void 0!==e.ignoreValidateRows&&n.push({slot:f.SLOT_IGNORE_VALIDATE_ROWS,ignoreValidateRows:e.ignoreValidateRows}),t.ignoreInvalidError&&void 0!==e.ignoreInvalidError&&n.push({slot:f.SLOT_IGNORE_INVALID_ERROR,ignoreInvalidError:e.ignoreInvalidError}),t.dataValidation&&n.push({slot:f.SLOT_DATA_VALIDATION,dataValidation:e.dataValidation}),n}E.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ranges",dataType:{type:Array,subType:m}},2:{name:"operation",dataType:{type:Array,subType:{type:Object,protoMap:R}}},3:{name:"type",dataType:String}},t.ZP=E},75479:function(e,t,n){"use strict";var r=n(13504),i=n(26178),o=n(38808),s=n(85249),a=n(65608),d=n(87082),h=i.Dimension.DIMENSION_TYPE,u=i.Range.DimensionRange,l=function(e){function t(t){var n;return(n=e.call(this,o.ZP.ADD_EMBEDDED_OBJECT_MUTATION,t)||this).data=t.data,n}(0,r.Z)(t,e),t.deserialize=function(e){var n={data:{type:e[0],sheetId:e[1],id:e[2],url:e[3],width:e[4],height:e[5],x:e[6],y:e[7],offsetX:e[8],offsetY:e[9],zIndex:e[10]}};return e[11]&&(n.data.clipInfo={clipTop:e[11][0],clipLeft:e[11][1],clipRight:e[11][2],clipBottom:e[11][3]}),new t(n)};var n=t.prototype;return n.serialize=function(){var e=[this.data.type,this.data.sheetId,this.data.id,this.data.url,this.data.width,this.data.height,this.data.x,this.data.y,this.data.offsetX,this.data.offsetY,this.data.zIndex];return this.data.clipInfo?e.push([this.data.clipInfo.clipTop,this.data.clipInfo.clipLeft,this.data.clipInfo.clipRight,this.data.clipInfo.clipBottom]):e.push(null),e},n.getAffectedSheetId=function(){return this.data.sheetId},n.setAffectedSheetId=function(e){this.data.sheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.data.sheetId);return n&&t.push(n),t},n.check=function(e){return e.imageManager.getImage(this.data.id)?{isValid:!1,errorMessage:"图片ID已经存在了 "+this.data.id}:{isValid:!0}},n.runOnSheet=function(e){e.imageManager.addImage(this.data)},n.invert=function(){var e=[];return e.push(new d.Z({key:this.data.id,sheetId:this.data.sheetId})),e},n.transformWithInsertDimensionMutation=function(e){if(this.data.sheetId!==e.sheetId)return[this];var n,r=[],i=this.data.sheetId;(n=e.type===h.ROWS?new u(i,this.data.y,this.data.y,e.type):new u(i,this.data.x,this.data.x,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var o=JSON.parse(JSON.stringify(this.data));return e.type===h.ROWS?o.y=n.startIndex:o.x=n.startIndex,r.push(new t({data:o})),r},n.transformWithDeleteDimensionMutation=function(e){if(this.data.sheetId!==e.sheetId)return[this];var n,r=[],i=this.data.sheetId;(n=e.type===h.ROWS?new u(i,this.data.y,this.data.y,e.type):new u(i,this.data.x,this.data.x,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var o=JSON.parse(JSON.stringify(this.data));return e.type===h.ROWS?o.y=n.startIndex:o.x=n.startIndex,r.push(new t({data:o})),r},n.transformWithAddEmbeddedObjectMutation=function(e,t){return this.data.sheetId,e.data.sheetId,[this]},n.transformWithDeleteEmbeddedObjectMutation=function(e){return this.data.sheetId,e.sheetId,[this]},n.transformWithUpdateEmbeddedObjectMutation=function(e){return this.data.sheetId,e.data.sheetId,[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.data.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDefineSheetRangeMutation=function(e){return this.data.sheetId,e.sheetId,[this]},n.transformWithUpdateSheetRangeMutation=function(e){return this.data.sheetId,e.sheetId,[this]},t}(s.Z);l.protoMap={0:{name:"data",dataType:{type:Object,protoMap:a.E}}},t.Z=l},87082:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(75479),a=function(e){function t(t){var n;return(n=e.call(this,i.ZP.DELETE_EMBEDDED_OBJECT_MUTATION,t)||this).key=t.key,n.sheetId=t.sheetId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({key:e[0],sheetId:e[1]})};var n=t.prototype;return n.serialize=function(){return[this.key,this.sheetId]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},n.check=function(e){return e.imageManager.getImage(this.key)?{isValid:!0}:{isValid:!1,errorMessage:"图片key不存在 "+this.key}},n.runOnSheet=function(e){e.imageManager.deleteImage(this.key)},n.invert=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);if(null===n)return t;var r=n.imageManager.getImage(this.key);return r&&t.push(new s.Z({data:r.toObject()})),t},n.transformWithAddEmbeddedObjectMutation=function(e){return this.sheetId,e.data.sheetId,[this]},n.transformWithDeleteEmbeddedObjectMutation=function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return e.key!==this.key&&n.push(this),n},n.transformWithUpdateEmbeddedObjectMutation=function(e){return this.sheetId,e.data.sheetId,[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDefineSheetRangeMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=[];return t.push(this),t},n.transformWithUpdateSheetRangeMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=[];return t.push(this),t},t}(o.Z);a.protoMap={0:{name:"key",dataType:String},1:{name:"sheetId",dataType:String}},t.Z=a},42313:function(e,t,n){"use strict";var r=n(13504),i=n(26178),o=n(38808),s=n(85249),a=n(65608),d=i.Dimension.DIMENSION_TYPE,h=i.Range.DimensionRange,u=function(e){function t(t){var n;return(n=e.call(this,o.ZP.UPDATE_EMBEDDED_OBJECT_MUTATION,t)||this).data=t.data,n}(0,r.Z)(t,e),t.deserialize=function(e){var n={data:{type:e[0],sheetId:e[1],id:e[2],url:e[3],width:e[4],height:e[5],x:e[6],y:e[7],offsetX:e[8],offsetY:e[9],zIndex:e[10]}};return e[11]&&(n.data.clipInfo={clipTop:e[11][0],clipLeft:e[11][1],clipRight:e[11][2],clipBottom:e[11][3]}),new t(n)};var n=t.prototype;return n.serialize=function(){var e=[this.data.type,this.data.sheetId,this.data.id,this.data.url,this.data.width,this.data.height,this.data.x,this.data.y,this.data.offsetX,this.data.offsetY,this.data.zIndex];return this.data.clipInfo?e.push([this.data.clipInfo.clipTop,this.data.clipInfo.clipLeft,this.data.clipInfo.clipRight,this.data.clipInfo.clipBottom]):e.push(null),e},n.getAffectedSheetId=function(){return this.data.sheetId},n.setAffectedSheetId=function(e){this.data.sheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.data.sheetId);return n&&t.push(n),t},n.check=function(e){return e.imageManager.getImage(this.data.id)?{isValid:!0}:{isValid:!1,errorMessage:"图片ID已经存在了 "+this.data.id}},n.runOnSheet=function(e){e.imageManager.updateImage(this.data)},n.invert=function(e){var n=[],r=e.sheetManager.getSheetBySheetId(this.data.sheetId);if(null===r)return n;var i=r.imageManager.getImage(this.data.id);return i&&n.push(new t({data:i.toObject()})),n},n.transformWithInsertDimensionMutation=function(e){if(this.data.sheetId!==e.sheetId)return[this];var n,r=[],i=this.data.sheetId;(n=e.type===d.ROWS?new h(i,this.data.y,this.data.y,e.type):new h(i,this.data.x,this.data.x,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var o=JSON.parse(JSON.stringify(this.data));return e.type===d.ROWS?o.y=n.startIndex:o.x=n.startIndex,r.push(new t({data:o})),r},n.transformWithDeleteDimensionMutation=function(e){if(this.data.sheetId!==e.sheetId)return[this];var n,r=[],i=this.data.sheetId;(n=e.type===d.ROWS?new h(i,this.data.y,this.data.y,e.type):new h(i,this.data.x,this.data.x,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var o=JSON.parse(JSON.stringify(this.data));return e.type===d.ROWS?o.y=n.startIndex:o.x=n.startIndex,r.push(new t({data:o})),r},n.transformWithAddEmbeddedObjectMutation=function(e){return this.data.sheetId,e.data.sheetId,[this]},n.transformWithDeleteEmbeddedObjectMutation=function(e){if(this.data.sheetId!==e.sheetId)return[this];var t=[];return e.key!==this.data.id&&t.push(this),t},n.transformWithUpdateEmbeddedObjectMutation=function(e,t){if(this.data.sheetId!==e.data.sheetId)return[this];var n=[];return(e.data.id!==this.data.id||t)&&n.push(this),n},n.transformWithDeleteSheetMutation=function(e,t){return this.data.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDefineSheetRangeMutation=function(e){return this.data.sheetId,e.sheetId,[this]},n.transformWithUpdateSheetRangeMutation=function(e){return this.data.sheetId,e.sheetId,[this]},t}(s.Z);u.protoMap={0:{name:"data",dataType:{type:Object,protoMap:a.E}}},t.Z=u},65608:function(e,t,n){"use strict";n.d(t,{E:function(){return i}}),n(62883);var r=n(26178).Embedded.EmbeddedImageClip,i={0:{name:"type",dataType:String},1:{name:"sheetId",dataType:"sheetId"},2:{name:"id",dataType:String},3:{name:"url",dataType:String},4:{name:"width",dataType:Number},5:{name:"height",dataType:Number},6:{name:"x",dataType:Number},7:{name:"y",dataType:Number},8:{name:"offsetX",dataType:Number},9:{name:"offsetY",dataType:Number},10:{name:"zIndex",dataType:Number},11:{name:"clipInfo",dataType:r}}},13176:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=function(e){function t(t){var n;return(n=e.call(this,i.ZP.ACTIVE_FILTER_VIEW_MUTATION,t)||this).sheetId=t.sheetId,n.filterViewId=t.filterViewId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],filterViewId:e[1]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.filterViewId]},n.isNonPersistedLocalChange=function(){return!0},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){this.filterViewId&&!e.filterViewManager.getFilterViewByViewId(this.filterViewId)||e.filterViewManager.setActiveFilterViewId(this.filterViewId)},n.invert=function(e){var n=e.sheetManager.getSheetBySheetId(this.sheetId);return this.originFilterViewId=n?n.filterViewManager.getActiveFilterViewId():"",[new t({sheetId:this.sheetId,filterViewId:this.originFilterViewId})]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId===e.sheetId&&t?[]:[this]},n.transformWithDeleteFilterViewMutation=function(e,t){return this.sheetId===e.sheetId&&this.filterViewId===e.filterViewId&&t?[]:[this]},t}(n(85249).Z);t.Z=o},91961:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(77413),a=n(1759),d=n(94853),h=function(e){function t(t){var n;return(n=e.call(this,i.ZP.ADD_FILTER_VIEW_MUTATION,t)||this).sheetId=t.sheetId,n.filterViewId=t.filterViewId,n.creatorId=t.creatorId,n.filterViewDelta=t.filterViewDelta,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],filterViewId:e[1],filterViewDelta:e[2]?a.Z.deserialize(e[2]):void 0,creatorId:e[3]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.filterViewId,this.filterViewDelta?this.filterViewDelta.serialize():void 0,this.creatorId]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){var t,n=(null===(t=this.filterViewDelta)||void 0===t?void 0:t.getName())||"",r=new s.Z({sheetId:this.sheetId,filterViewId:this.filterViewId,creatorId:this.creatorId,filterViewName:n,sheetReference:e,basicFilter:null});this.filterViewDelta&&this.filterViewDelta.applyToFilterView(r),e.filterViewManager.addOrUpdateFilterView(r)},n.invert=function(){var e=[],t=new d.Z({filterViewId:this.filterViewId,sheetId:this.sheetId});return e.push(t),e},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId===e.sheetId&&t?[]:[this]},t}(o.Z);t.Z=h},94853:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(1759),a=n(98013),d=n(91961),h=function(e){function t(t){var n;return(n=e.call(this,i.ZP.DELETE_FILTER_VIEW_MUTATION,t)||this).sheetId=t.sheetId,n.filterViewId=t.filterViewId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],filterViewId:e[1]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.filterViewId]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){e.filterViewManager.deleteFilterView(this.filterViewId)},n.invert=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);if(!n)return t;var r=n.filterViewManager.getFilterViewByViewId(this.filterViewId);if(!r)return t;var i=new s.Z({sheetId:this.sheetId,filterViewId:this.filterViewId}),o=r.getBasicFilter();o&&i.setBasicFilter((0,a.F)(o));var h=r.getFilterViewName();h&&i.setName(h);var u=new d.Z({sheetId:this.sheetId,filterViewId:this.filterViewId,creatorId:r.creatorId,filterViewDelta:i});return t.push(u),t},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId===e.sheetId&&t?[]:[this]},t}(o.Z);t.Z=h},59089:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(1759),a=n(98013),d=function(e){function t(t){var n;return(n=e.call(this,i.ZP.UPDATE_FILTER_VIEW_MUTATION,t)||this).sheetId=t.sheetId,n.filterViewId=t.filterViewId,n.filterViewDelta=t.filterViewDelta,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],filterViewId:e[1],filterViewDelta:s.Z.deserialize(e[2])})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.filterViewId,this.filterViewDelta.serialize()]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){var t=e.filterViewManager.getFilterViewByViewId(this.filterViewId);t&&this.filterViewDelta.applyToFilterView(t)},n.invert=function(e){var n=[],r=e.sheetManager.getSheetBySheetId(this.sheetId);if(!r)return n;var i=r.filterViewManager.getFilterViewByViewId(this.filterViewId);if(!i)return n;var o=new s.Z({sheetId:this.sheetId,filterViewId:this.filterViewId,filterViewName:i.getFilterViewName()}),d=i.getBasicFilter();d&&o.setBasicFilter((0,a.F)(d));var h=new t({sheetId:this.sheetId,filterViewId:this.filterViewId,filterViewDelta:o});return n.push(h),n},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId===e.sheetId&&t?[]:[this]},t}(o.Z);t.Z=d},98013:function(e,t,n){"use strict";function r(e){return{range:e.range,workbookRangeId:e.workbookRangeId,criteriaMap:e.criteriaMap,hiddenRows:e.getHiddenRows(),sortSpecs:e.sortSpecs,filterViewId:e.filterViewReference.filterViewId}}n.d(t,{F:function(){return r}})},52047:function(e,t,n){"use strict";var r=n(13504),i=n(58926),o=(n(71096),n(93984),n(38934),n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(31688),n(8195),n(46396),n(15770),n(26178)),s=n(38808),a=n(85249),d=n(80067),h=n(20808),u=n(14527),l=n(4178),c=n(75503),f=o.Dimension.DIMENSION_TYPE,I=o.Filter.BasicFilter,g=o.Range.GridRange;function p(e){var t=e.gridRange,n=e.workbookRangeId,r=e.criteriaDelta,i=e.hiddenRows,o=e.sortSpecs,s=e.sheet,a=e.filterView,d=r?function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r=parseInt(n,10),i=e[n];t.set(r,(0,l.b)(i))})),t}(r):void 0;return new I({range:t,hiddenRows:i,workbookRangeId:n,criteriaMap:d,sortSpecs:o,sheetReference:s,filterViewReference:a})}var m=function(e){var t=[e.defaultFilterId||"",e.hiddenRows||[],e.oldFilterViewId||""],n=Object.keys(e.criteriaDelta||{}),r={};return n.forEach((function(t){var n=e.criteriaDelta[t];r[t]=[!1===n.visibleByDefault?0:1].concat((0,i.Z)((0,l.b)(n).serialize()))})),t.push(r),t},v=function(e){var t={defaultFilterId:e[0],hiddenRows:e[1],oldFilterViewId:e[2]},n=e[3],r=Object.keys(n),i={};return r.forEach((function(e){var t=n[e];i[e]=Object.assign({visibleByDefault:!!t[0]},(0,l.z)(t.slice(1)))})),t.criteriaDelta=i,t},R=function(e){function t(t){var n;return(n=e.call(this,s.ZP.DEFINE_FILTER_MUTATION,t)||this).sheetId=t.sheetId,n.delta=t.delta,n.gridRange=t.gridRange,n.sortSpecs=t.sortSpecs||[],n.nonPersistingLocalChange=!!t.nonPersistingLocalChange,n.filterViewId=t.filterViewId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],gridRange:g.deserialize(e[1]),delta:v(e[2]),sortSpecs:c.j.deserialize(e[3])||[],filterViewId:e[4]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.gridRange.serialize(),m(this.delta),c.j.serialize(this.sortSpecs),this.filterViewId]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e,this.gridRange.sheetId=e},n.getAffectedSheets=function(e){var t=this.sheetId,n=e.sheetManager.getSheetBySheetId(t);return n?[n]:[]},n.check=function(t){var n=e.prototype.check.call(this,t);if(!n.isValid)return n;var r=this.gridRange;if(!(0,d.hj)(r.startRowIndex)||!(0,d.hj)(r.endRowIndex)||!(0,d.hj)(r.startColIndex)||!(0,d.hj)(r.endColIndex))return{isValid:!1,errorMessage:"gridRange index类型不是数字 girdRange="+JSON.stringify(r)};var i=t.properties.gridProperties;return r.startRowIndex<0||r.startRowIndex>=i.rowCount||r.endRowIndex>=i.rowCount||r.startColIndex<0||r.startColIndex>=i.colCount||r.endColIndex>=i.colCount?{isValid:!1,errorMessage:"gridRange 范围不正确。 gridRange="+JSON.stringify(r)+" gridProperties="+JSON.stringify(i)}:{isValid:!0}},n.runOnSheet=function(e){var t=this.delta.defaultFilterId;if(t){var n=this.delta,r=n.criteriaDelta,i=n.hiddenRows,o=this.gridRange,s=this.sortSpecs,a=p({gridRange:o.clone(),workbookRangeId:t,criteriaDelta:r,hiddenRows:i,sortSpecs:s,sheet:e,filterView:e.filterViewManager.getFilterViewByViewId(this.filterViewId)}),d=this.isNonPersistedLocalChange();a.setIsLocalView(d),e.setBasicFilter(a,this.filterViewId)}},n.invert=function(){var e=this.sheetId,t=this.filterViewId,n=this.delta.defaultFilterId;return n?[new u.Z({sheetId:e,filterViewId:t,delta:{defaultFilterId:n},nonPersistingLocalChange:this.isNonPersistedLocalChange()})]:[]},n.transformWithInsertDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n=e.type,r=e.index,i=e.amount,o=e.sheetId,s=this.gridRange.clone();s.insertDimension({sheetId:o,type:n,index:r,amount:i});var a=function(e,t){var n=e.type,r=e.index,i=e.amount,o=!1;if(n===f.COLUMNS&&null!=t.criteriaDelta){o=!1;var s=t.criteriaDelta;if(s&&Object.keys(s).length>0){var a=Object.keys(s),d=a.filter((function(e){return parseInt(e,10)>r})).length>0;if(o=o||d,d){var h=a.reduce((function(e,t){return e[parseInt(t,10)>r?parseInt(t,10)+i:t]=s[parseInt(t,10)],e}),{});t.criteriaDelta=h}}if(o)return t.hiddenRows=[],t}return t}({type:n,index:r,amount:i},this.delta);return[new t({gridRange:s,delta:a,sheetId:o,filterViewId:this.filterViewId})]},n.transformWithDeleteDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n=e.type,r=e.index,i=e.amount,o=e.sheetId,s=this.gridRange.clone();s.deleteDimension({sheetId:o,type:n,index:r,amount:i});var a=function(e,t){var n=e.type,r=e.index,i=e.amount,o=!1;if(n===f.COLUMNS&&null!=t.criteriaDelta){o=!1;var s=t.criteriaDelta;if(s&&Object.keys(s).length>0){var a=Object.keys(s),d=a.filter((function(e){return parseInt(e,10)>r})).length>0;if(o=o||d,d){var h=a.reduce((function(e,t){return e[parseInt(t,10)>r?parseInt(t,10)-i:t]=s[parseInt(t,10)],e}),{});t.criteriaDelta=h,t.hiddenRows=[]}}if(o)return t}return t}({type:n,index:r,amount:i},this.delta);return[new t({gridRange:s,delta:a,sheetId:o,filterViewId:this.filterViewId})]},n.transformWithMergeCellsMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var t=e.startColIndex,n=e.startRowIndex,r=e.endColIndex,i=e.endRowIndex,o=e.sheetId;return new g(o,n,i,t,r).isCross(this.gridRange)?[]:[this]},n.transformWithDefineFilterMutation=function(e,t){return this.gridRange.sheetId!==e.sheetId?[this]:(0,h.ZG)(e.delta.defaultFilterId||e.delta.oldFilterViewId,this.delta.defaultFilterId||this.delta.oldFilterViewId)?[]:t?[this]:[]},n.transformWithDeleteFilterMutation=function(e){return this.gridRange.sheetId!==e.sheetId?[this]:(0,h.ZG)(e.delta.defaultFilterId||e.delta.oldFilterViewId,this.delta.defaultFilterId||this.delta.oldFilterViewId)?[]:[this]},n.transformWithUpdateFilterMutation=function(e){return this.gridRange.sheetId,e.sheetId,[this]},n.transformWithReorderRangeMutation=function(e){return this.gridRange.sheetId,e.sheetId,[this]},n.transformWithMapRangeMutation=function(e){return this.gridRange.sheetId,e.sourceSheetId,[this]},n.transformWithDeleteFilterViewMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:this.filterViewId&&t&&this.filterViewId===e.filterViewId?[]:[this]},n.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},t}(a.Z);t.ZP=R},14527:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(35942),a=function(e){function t(t){var n;return(n=e.call(this,i.ZP.DELETE_FILTER_MUTATION,t)||this).sheetId=t.sheetId,n.delta=t.delta,n.nonPersistingLocalChange=!!t.nonPersistingLocalChange,n.filterViewId=t.filterViewId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],delta:{defaultFilterId:e[1][0]},filterViewId:e[2]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,[this.delta.defaultFilterId||""],this.filterViewId]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=this.sheetId,n=e.sheetManager.getSheetBySheetId(t);return n?[n]:[]},n.runOnSheet=function(e){this.delta.defaultFilterId&&e.clearBasicFilter(this.filterViewId)},n.invert=function(e){var t=this.delta.defaultFilterId,n=this.sheetId,r=this.filterViewId,i=e.sheetManager.getSheetBySheetId(n);return i&&t?(0,s.QT)(i,!1,{nonPersistingLocalChange:this.isNonPersistedLocalChange()},r):[]},n.transformWithDefineFilterMutation=function(e){return this.sheetId,e.gridRange.sheetId,[this]},n.transformWithDeleteFilterMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithUpdateFilterMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithDeleteFilterViewMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:this.filterViewId&&t&&this.filterViewId===e.filterViewId?[]:[this]},n.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},t}(o.Z);t.Z=a},89688:function(e,t,n){"use strict";var r=n(13504),i=n(85249),o=n(38808),s=function(e){function t(t){var n;return(n=e.call(this,o.ZP.SWITCH_FILTER_SYNC_MUTATION,t)||this).isOn=t.isOn,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({isOn:e[0]})};var n=t.prototype;return n.getAffectedSheetId=function(){return"WORKBOOK"},n.getAffectedSheets=function(){return[]},n.invert=function(){return[new t({isOn:!this.isOn})]},n.runOnSheet=function(){},n.runOnWorkbook=function(e){return e.isFilterSync=this.isOn,!0},n.serialize=function(){return[this.isOn]},n.transformWithSwitchFilterSyncMutation=function(e,t){return t?[this]:[]},t}(i.Z);t.Z=s},99772:function(e,t,n){"use strict";n.d(t,{Jl:function(){return f},Qn:function(){return r}});var r,i=n(13504),o=n(58926),s=(n(8195),n(90109),n(46396),n(15770),n(49502),n(62883),n(38934),n(31688),n(26178)),a=n(38808),d=n(85249),h=n(20808),u=n(4178),l=n(75503),c=s.Range.GridRange;function f(e,t){var n=e.criteria,r=e.columnIndex;return e.clear?(t.deleteColFilterCriteria(r),t):(n&&t.setColFilterCriteria(r,(0,u.b)(n)),t)}!function(e){e[e.UPDATE=1]="UPDATE",e[e.RECAL=2]="RECAL"}(r||(r={}));var I=function(e){var t;return[e.defaultFilterId||"",e.hiddenRows||null,e.range?e.range.serialize():null,(null===(t=e.updateColumnCriteriaDelta)||void 0===t?void 0:t.length)?e.updateColumnCriteriaDelta.map((function(e){var t=e.columnIndex,n=e.clear,r=e.criteria;return[t,n?1:0,r?[!1===r.visibleByDefault?0:1].concat((0,o.Z)((0,u.b)(r).serialize())):null]})):null]},g=function(e){var t,n={defaultFilterId:e[0]};return e[1]&&(n.hiddenRows=e[1]),e[2]&&(n.range=c.deserialize(e[2])),e[3]&&(t=(0,h.kJ)(e[3][0])?e[3]:[e[3]],n.updateColumnCriteriaDelta=t.map((function(e){return{columnIndex:e[0],clear:!!e[1],criteria:e[2]?Object.assign({visibleByDefault:!!e[2][0]},(0,u.z)(e[2].slice(1))):void 0}}))),n},p=function(e){function t(t){var n;(n=e.call(this,a.ZP.UPDATE_FILTER_MUTATION,t)||this).workbookRangeId=t.workbookRangeId,n.updateType=t.updateType,n.sheetId=t.sheetId,n.filterViewId=t.filterViewId;var r=t.delta.updateColumnCriteriaDelta;return r&&!(0,h.kJ)(r)?n.delta=Object.assign(Object.assign({},t.delta),{updateColumnCriteriaDelta:[r]}):n.delta=Object.assign(Object.assign({},t.delta),{updateColumnCriteriaDelta:r}),n.delta.hiddenRows&&n.delta.hiddenRows.sort((function(e,t){return e-t})),n.sortSpecs=t.sortSpecs||null,n.nonPersistingLocalChange=!!t.nonPersistingLocalChange,n}(0,i.Z)(t,e),t.deserialize=function(e){return new t({workbookRangeId:e[0],updateType:e[1],sheetId:e[2],delta:g(e[3]),sortSpecs:l.j.deserialize(e[4]),filterViewId:e[5]})};var o=t.prototype;return o.serialize=function(){return[this.workbookRangeId,this.updateType,this.sheetId,I(this.delta),l.j.serialize(this.sortSpecs),this.filterViewId]},o.getAffectedSheetId=function(){return this.sheetId},o.setAffectedSheetId=function(e){this.sheetId=e},o.getAffectedSheets=function(e){var t=this.sheetId,n=e.sheetManager.getSheetBySheetId(t);return n?[n]:[]},o.getAffectedGridRanges=function(){var e,t,r=n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(this.sheetId);return[new c({sheetId:this.sheetId,startColIndex:0,endColIndex:r.getColCount()-1,startRowIndex:Math.max(Number(null===(e=this.delta.range)||void 0===e?void 0:e.startRowIndex),0),endRowIndex:Math.min(Number(null===(t=this.delta.range)||void 0===t?void 0:t.endRowIndex),r.getRowCount()-1)})]},o.runOnSheet=function(e){this.updateType!==r.UPDATE&&this.updateType!==r.RECAL||this.delta.defaultFilterId&&this.updateBasicFilter(this.delta,e)},o.updateBasicFilter=function(e,t){var n=e.hiddenRows,r=e.updateColumnCriteriaDelta,i=e.defaultFilterId,o=e.range,s=this.filterViewId?t.getBasicFilterInFilterView(this.filterViewId):t.getBasicFilterInSheet(!1);i&&s&&(r&&(((0,h.kJ)(r)?r:[r]).forEach((function(e){f(e,s)})),this.nonPersistingLocalChange||s.updateCacheCriteria(),t.setBasicFilter(s,this.filterViewId)),n&&(s.setHiddenRows(n),this.nonPersistingLocalChange||s.updateCacheHiddenRows(),t.setBasicFilter(s,this.filterViewId)),o&&(o.endRowIndex>=t.getRowCount()&&(o.endRowIndex=t.getRowCount()-1),o.endColIndex>=t.getColCount()&&(o.endColIndex=t.getColCount()-1),s.range=o.clone()),null!==this.sortSpecs&&(s.sortSpecs=this.sortSpecs,t.setBasicFilter(s,this.filterViewId)))},o.invert=function(e){if(this.updateType!==r.UPDATE&&this.updateType!==r.RECAL)return[];var t=this.sheetId,n=this.workbookRangeId,i=this.updateType,o=this.nonPersistingLocalChange,s=this.delta,a=this.filterViewId,d=s.defaultFilterId,h=e.sheetManager.getSheetBySheetId(t);if(!function(e,t,n){if(!e)return!1;var r=e.getBasicFilter(!1,t);return!(!n||!r)}(h,a,d))return[];var u=h.getBasicFilter(!1,a),l={workbookRangeId:n,sheetId:t,filterViewId:a,updateType:i,nonPersistingLocalChange:o,sortSpecs:u.sortSpecs,delta:{defaultFilterId:d}};return this.getInvertResult(u,l)},o.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},o.transformWithInsertDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=e.sheetId,n=e.type,r=e.index,i=e.amount,o=this.delta.range;if(o){var s=o.clone();s.insertDimension({sheetId:t,type:n,index:r,amount:i})}return[this]},o.transformWithDeleteDimensionMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithMergeCellsMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithDefineFilterMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithDeleteFilterMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithUpdateFilterMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithReorderRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithMapRangeMutation=function(e){return this.sheetId,e.sourceSheetId,[this]},o.transformWithDeleteFilterViewMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:this.filterViewId&&t&&this.filterViewId===e.filterViewId?[]:[this]},o.getInvertResult=function(e,n){var r=this.delta,i=r.hiddenRows,o=r.updateColumnCriteriaDelta,s=r.range,a=!1;if(o){var d=o.map((function(t){var n=t.columnIndex,r=e.getColFilterCriteria(n),i={columnIndex:n};return r?i.criteria=r:i.clear=!0,i}));n.delta.updateColumnCriteriaDelta=d,n.delta.range=e.range.clone(),a=!0}if(i){var h=e.getHiddenRows();n.delta.hiddenRows=h,n.delta.range=e.range.clone(),a=!0}if(s){var u=e.range;n.delta.range=u,a=!0}return this.sortSpecs&&(a=!0),a?[new t(n)]:[]},t}(d.Z);t.ZP=p},75503:function(e,t,n){"use strict";n.d(t,{j:function(){return r}}),n(90109);var r={serialize:function(e){return e?e.map((function(e){return[e.dimensionIndex,e.sortOrder]})):null},deserialize:function(e){return e?e.map((function(e){return{dimensionIndex:e[0],sortOrder:e[1]}})):null}}},7151:function(e,t,n){"use strict";n.d(t,{Cq:function(){return c.Z},Dm:function(){return i.D},G1:function(){return f.Z},MC:function(){return g.ZP},OZ:function(){return x.Z},XS:function(){return d.Z},Xd:function(){return E.Z},Y0:function(){return l.Z},dc:function(){return I.Z},eU:function(){return R.Z},fN:function(){return h.ZP},ff:function(){return p.Z},g8:function(){return s.Z},jZ:function(){return v.Z},kP:function(){return m.Z},kS:function(){return o.Z},qi:function(){return u.Z},sl:function(){return T.Z},uU:function(){return a.Z},xF:function(){return r.ZP}});var r=n(38808),i=n(11530),o=n(73543),s=n(71217),a=(n(85249),n(99790)),d=n(94809),h=n(62962),u=n(75832),l=n(49902),c=n(15),f=(n(98279),n(75479),n(87082)),I=(n(42313),n(20191),n(60869),n(87789),n(20587)),g=(n(73307),n(66676),n(6091),n(54792),n(38561),n(17144),n(58763),n(54500),n(20911),n(52047),n(14527),n(99772)),p=n(89688),m=(n(52152),n(49898)),v=n(97098),R=n(85145),x=n(98217),T=n(35631),E=n(25693);n(52074),n(4960),n(38698),n(91961),n(94853),n(59089),n(13176)},15:function(e,t,n){"use strict";n.d(t,{g:function(){return x}});var r=n(38661),i=n(13504),o=(n(46396),n(38934),n(31688),n(49502),n(62883),n(26178)),s=n(38808),a=n(85249),d=n(3639),h=n(49902),u=n(98279),l=n(14527),c=n(85145),f=n(48885),I=o.Range.GridRange,g=o.Dimension.DIMENSION_TYPE,p=o.Cell.CellDataDelta,m=o.Cell.CELL_DATA_SLOT_COMPOSE,v=o.Rule.ConditionalFormatRule,R=function(e){function t(t){var n;return n=e.call(this,s.ZP.MERGE_CELLS_MUTATION,t)||this,Object.assign((0,r.Z)(n),t),n}(0,i.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],startRowIndex:e[1],endRowIndex:e[2],startColIndex:e[3],endColIndex:e[4]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},n.getAffectedGridRanges=function(){return[new I({sheetId:this.sheetId,startColIndex:this.startColIndex,endColIndex:this.endColIndex,startRowIndex:this.startRowIndex,endRowIndex:this.endRowIndex})]},n.check=function(e){var t=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(!t.isValid())return{isValid:!1,errorMessage:"GridRange值非法 gridRange="+JSON.stringify(t)};var n=e.properties.gridProperties;return this.endRowIndex>=n.rowCount||this.endColIndex>=n.colCount?{isValid:!1,errorMessage:"行列范围不正确。 endRowIndex="+this.endRowIndex+"  endRowIndex="+this.endColIndex+" gridProperties="+JSON.stringify(n)}:{isValid:!0}},n.runOnSheet=function(e){var t=this.requestId===f.Z.UPDATE_PIVOT_TABLE_REQUEST;e.mergeManager.addMerge(new I(this),t)},n.invert=function(e){return[new u.Z({startRowIndex:this.startRowIndex,endRowIndex:this.endRowIndex,startColIndex:this.startColIndex,endColIndex:this.endColIndex,sheetId:this.sheetId})]},n.transformWithInsertDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return n.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({startRowIndex:n.startRowIndex,endRowIndex:n.endRowIndex,startColIndex:n.startColIndex,endColIndex:n.endColIndex,sheetId:this.sheetId})]},n.transformWithDeleteDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return n.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),!n.isValid()||n.isSingle()?[]:[new t({startRowIndex:n.startRowIndex,endRowIndex:n.endRowIndex,startColIndex:n.startColIndex,endColIndex:n.endColIndex,sheetId:this.sheetId})]},n.transformWithSetRangeMutation=function(e,t){if(this.sheetId!==e.gridRange.sheetId)return[this];var n,r,i,o=[],s=e.cellDataDeltaAtPositions,a=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(a.isCross(e.gridRange)){if(t){for(n=0;n<s.length;n++)0!==(r=s[n]).cellDataDelta.setSlots&&(i=new I(this.sheetId,r.rowIndex,r.rowIndex,r.colIndex,r.colIndex),a.isCross(i)&&o.push(new h.Z({gridRange:i,cellDataDelta:new p({setSlots:0,clearSlots:m.ALL})})));o.push(this)}}else o.push(this);return o},n.transformWithSetCellPropertiesMutation=function(e,t){if(this.sheetId!==e.gridRange.sheetId)return[this];var n,r,i=[],o=[],s=[];if(0===e.cellDataDelta.setSlots)i.push(this);else{for(o=x(new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex)),n=0;n<o.length;n++)(r=o[n].getCross(e.gridRange))&&s.push(r);if(s.length>0){if(t){for(n=0;n<s.length;n++)i.push(new h.Z({gridRange:s[n],cellDataDelta:new p({setSlots:0,clearSlots:m.ALL})}));i.push(this)}}else i.push(this)}return i},n.transformWithMergeCellsMutation=function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),r=new I(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);return n.isCross(r)?t?[new u.Z({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:e.sheetId}),this]:[]:[this]},n.transformWithUnmergeCellsMutation=function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[],r=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),i=new I(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);return r.isCross(i)?t&&n.push(e,this):n.push(this),n},n.transformWithDefineFilterMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=[];return new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isCross(e.gridRange)&&t.push(new l.Z({sheetId:e.sheetId,delta:{defaultFilterId:e.delta.defaultFilterId,oldFilterViewId:e.delta.oldFilterViewId}})),t.push(this),t},n.transformWithCopyPasteMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=[];return t.push(this),t},n.transformWithReorderRangeMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=[];return new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isCross(e.range)||t.push(this),t},n.transformWithMapRangeMutation=function(e){if(this.sheetId!==e.sourceSheetId)return[this];var t=[];return(0,d.O)(g.ROWS,e)||(0,d.O)(g.COLUMNS,e)||t.push(this),t},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDefineSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithUpdateSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithAddConditionalFormatMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),n=e.rule.ruleRanges;if(n.some((function(e){return e.isCross(t)}))){var r=new I(this.sheetId,this.startRowIndex,this.startRowIndex,this.startColIndex,this.startColIndex);if(n.some((function(e){return e.contain(r)})))return[this];var i=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===t.sheetId&&e.isCross(t)){var n=e.startRowIndex,r=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(i.push(new I(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),n=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(i.push(new I(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),r=t.endRowIndex),e.startColIndex<t.startColIndex&&i.push(new I(e.sheetId,n,r,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&i.push(new I(e.sheetId,n,r,t.endColIndex,e.endColIndex))}else i.push(e)})),0===i.length?[this]:(i.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[this,new c.Z({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new v({ruleRanges:i,booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat,dataBarConditionalFormat:e.rule.dataBarConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})])}return[this]},n.transformWithUpdateConditionalFormatMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=new I(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),n=e.rule.ruleRanges;if(n.some((function(e){return e.isCross(t)}))){var r=new I(this.sheetId,this.startRowIndex,this.startRowIndex,this.startColIndex,this.startColIndex);if(n.some((function(e){return e.contain(r)})))return[this];var i=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===t.sheetId&&e.isCross(t)){var n=e.startRowIndex,r=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(i.push(new I(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),n=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(i.push(new I(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),r=t.endRowIndex),e.startColIndex<t.startColIndex&&i.push(new I(e.sheetId,n,r,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&i.push(new I(e.sheetId,n,r,t.endColIndex,e.endColIndex))}else i.push(e)})),0===i.length?[this]:(i.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[this,new c.Z({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new v({ruleRanges:i,booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat,dataBarConditionalFormat:e.rule.dataBarConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})])}return[this]},t}(a.Z);function x(e){var t=[],n=e.sheetId,r=e.startRowIndex,i=e.endRowIndex,o=e.startColIndex,s=e.endColIndex;return i>r&&t.push(new I(n,r+1,i,o,s)),s>o&&t.push(new I(n,r,r,o+1,s)),t}R.protoMap={0:{name:"sheetId",dataType:String},1:{name:"startRowIndex",dataType:Number},2:{name:"endRowIndex",dataType:Number},3:{name:"startColIndex",dataType:Number},4:{name:"endColIndex",dataType:Number}},t.Z=R},98279:function(e,t,n){"use strict";n.d(t,{N:function(){return c}});var r=n(38661),i=n(13504),o=(n(46396),n(62883),n(38808)),s=n(85249),a=n(15),d=n(49902),h=n(81300),u=n(27571),l=function(e){function t(t){var n;return n=e.call(this,o.ZP.UNMERGE_CELLS_MUTATION,t)||this,Object.assign((0,r.Z)(n),t),n}(0,i.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],startRowIndex:e[1],endRowIndex:e[2],startColIndex:e[3],endColIndex:e[4]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},n.check=function(e){var t=new u.GridRange(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(!t.isValid())return{isValid:!1,errorMessage:"GridRange值非法 gridRange="+JSON.stringify(t)};var n=e.properties.gridProperties;return this.endRowIndex>=n.rowCount||this.endColIndex>=n.colCount?{isValid:!1,errorMessage:"行列范围不正确。 endRowIndex="+this.endRowIndex+"  endRowIndex="+this.endColIndex+" gridProperties="+JSON.stringify(n)}:{isValid:!0}},n.getAffectedGridRanges=function(){return[new u.GridRange(this)]},n.runOnSheet=function(e){e.mergeManager.deleteMerge(new u.GridRange(this))},n.invert=function(){return[new a.Z({startRowIndex:this.startRowIndex,endRowIndex:this.endRowIndex,startColIndex:this.startColIndex,endColIndex:this.endColIndex,sheetId:this.sheetId})]},n.transformWithInsertDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=new u.GridRange(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return n.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({startRowIndex:n.startRowIndex,endRowIndex:n.endRowIndex,startColIndex:n.startColIndex,endColIndex:n.endColIndex,sheetId:this.sheetId})]},n.transformWithDeleteDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=new u.GridRange(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return n.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),!n.isValid()||n.isSingle()?[]:[new t({startRowIndex:n.startRowIndex,endRowIndex:n.endRowIndex,startColIndex:n.startColIndex,endColIndex:n.endColIndex,sheetId:this.sheetId})]},n.transformWithUnmergeCellsMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var t=[];return this.sheetId===e.sheetId&&this.startRowIndex===e.startRowIndex&&this.endRowIndex===e.endRowIndex&&this.startColIndex===e.startColIndex&&this.endColIndex===e.endColIndex||t.push(this),t},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},t}(s.Z);function c(e){var t=e.gridRange,n=e.sheet,r=e.shouldForceClearFormat,i=e.shouldSkipMergeRange,o=[];return n.mergeManager.each((function(e,s,a){if(t.isCross(e)&&!(null===i||void 0===i?void 0:i(a))){o.push(new l(e));var c,f=e.startRowIndex,I=e.startColIndex,g=n.getCellDataAtPosition(f,I);if(null!==g){var p=c=h.cellFormatUtils.createCellFormatDelta(null,g.getUserEnteredFormat(),h.CELL_FORMAT_SLOT_COMPOSE.ALL),m=p.setSlots,v=p.clearSlots;r&&0===m&&0===v&&(c.clearSlots=h.CELL_FORMAT_SLOT_COMPOSE.ALL)}else c=null;var R=new h.CellDataDelta;R.setSlot(h.CELL_DATA_SLOT.SLOT_USER_ENTERED_FORMAT_DELTA,c);var x=new d.Z({cellDataDelta:R,gridRange:new u.GridRange(e)}),T=x.cellDataDelta.delta.userEnteredFormatDelta;(null===T||void 0===T?void 0:T.delta.getBorders())&&(T.clearSlot(h.CELL_FORMAT_SLOT.BORDER_TOP),T.clearSlot(h.CELL_FORMAT_SLOT.BORDER_BOTTOM),T.clearSlot(h.CELL_FORMAT_SLOT.BORDER_LEFT),T.clearSlot(h.CELL_FORMAT_SLOT.BORDER_RIGHT),T.clearSlot(h.CELL_FORMAT_SLOT.BORDER_DIAGUP),T.clearSlot(h.CELL_FORMAT_SLOT.BORDER_DIAGDOWN)),o.push(x)}})),o}l.protoMap={0:{name:"sheetId",dataType:String},1:{name:"startRowIndex",dataType:Number},2:{name:"endRowIndex",dataType:Number},3:{name:"startColIndex",dataType:Number},4:{name:"endColIndex",dataType:Number}},t.Z=l},52074:function(e,t,n){"use strict";var r=n(13504),i=(n(38934),n(31688),n(26178)),o=n(38808),s=n(85249),a=n(25693),d=n(4960),h=n(38698),u=i.NewEmbedded.EmbeddedObject,l=i.Dimension.DIMENSION_TYPE,c=i.Range.DimensionRange,f=function(e){function t(t){var n;return(n=e.call(this,o.ZP.NEW_ADD_EMBEDDED_OBJECT_MUTATION,t)||this).object=t.object,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({object:u.deserialize(e[0])})};var n=t.prototype;return n.serialize=function(){return[this.object.serialize()]},n.getAffectedSheetId=function(){return"WORKBOOK"},n.getAffectedSheets=function(){return[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(){},n.runOnWorkbook=function(e){return!this.checkEmbeddedObject(e,this.object)||(e.embeddedObjectManager.addEmbeddedObject(this.object),!0)},n.checkEmbeddedObject=function(e,t){var n,r=!0;return null===(n=t.properties.chart)||void 0===n||n.workbookRangeId.forEach((function(t){e.workbookRangeManager.getChartWorkbookRangeById(t)||(r=!1)})),r},n.invert=function(){return[new d.Z({objectId:this.object.objectId,sheetId:this.object.location.sheetId})]},n.transformWithInsertDimensionMutation=function(e){var n=this.object.location;if(n.sheetId!==e.sheetId)return[this];var r,i=n.position,o=i.rowIndex,s=i.colIndex,a=!1;if(e.type===l.ROWS?((r=new c(e.sheetId,o,o,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o||r.endIndex!==o):((r=new c(e.sheetId,s,s,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==s||r.endIndex!==s),a){var d=this.object.clone();return d.location.position={rowIndex:e.type===l.ROWS?r.startIndex:o,colIndex:e.type===l.ROWS?s:r.startIndex},[new t({object:d})]}return[this]},n.transformWithDeleteDimensionMutation=function(e){var n=this.object.location;if(n.sheetId!==e.sheetId)return[this];var r,i=n.position,o=i.rowIndex,s=i.colIndex,a=!1;if(e.type===l.ROWS?((r=new c(e.sheetId,o,o,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o||r.endIndex!==o):((r=new c(e.sheetId,s,s,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==s||r.endIndex!==s),a){var d=this.object.clone();return d.location.position={rowIndex:e.type===l.ROWS?r.startIndex:o,colIndex:e.type===l.ROWS?s:r.startIndex},[new t({object:d})]}return[this]},n.transformWithDeleteSheetMutation=function(e){return this.object.location.sheetId!==e.sheetId?[this]:[]},n.transformWithDefineWorkbookRangeMutation=function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new a.Z({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]},n.transformWithUpdateWorkbookRangeMutation=function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new a.Z({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]},n.transformWithNewAddEmbeddedObjectMutation=function(e,t){return this.object.objectId===e.object.objectId?t?[new h.Z({object:this.object.clone()})]:[]:[this]},n.transformWithNewDeleteEmbeddedObjectMutation=function(e){return this.object.objectId===e.objectId?[]:[this]},n.transformWithNewUpdateEmbeddedObjectMutation=function(e,t){return this.object.objectId===e.object.objectId?t?[new h.Z({object:this.object.clone()})]:[]:[this]},t}(s.Z);t.Z=f},4960:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(25693),a=n(52074),d=function(e){function t(t){var n;return(n=e.call(this,i.ZP.NEW_DELETE_EMBEDDED_OBJECT_MUTATION,t)||this).objectId=t.objectId,n.sheetId=t.sheetId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({objectId:e[0],sheetId:e[1]})};var n=t.prototype;return n.serialize=function(){return[this.objectId,this.sheetId]},n.getAffectedSheetId=function(){return"WORKBOOK"},n.getAffectedSheets=function(){return[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(){},n.runOnWorkbook=function(e){return e.embeddedObjectManager.deleteEmbeddedObject(this.objectId),!0},n.invert=function(e){return[new a.Z({object:e.embeddedObjectManager.getEmbeddedObject(this.objectId).clone()})]},n.transformWithDeleteSheetMutation=function(e){return this.sheetId!==e.sheetId?[this]:[]},n.transformWithDefineWorkbookRangeMutation=function(e,t){return this.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new s.Z({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]},n.transformWithUpdateWorkbookRangeMutation=function(e,t){return this.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new s.Z({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]},n.transformWithNewDeleteEmbeddedObjectMutation=function(e){return this.objectId===e.objectId?[]:[this]},t}(o.Z);t.Z=d},38698:function(e,t,n){"use strict";var r=n(13504),i=n(26178),o=n(38808),s=n(85249),a=n(25693),d=i.NewEmbedded.EmbeddedObject,h=i.Dimension.DIMENSION_TYPE,u=i.Range.DimensionRange,l=function(e){function t(t){var n;return(n=e.call(this,o.ZP.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION,t)||this).object=t.object,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({object:d.deserialize(e[0])})};var n=t.prototype;return n.serialize=function(){return[this.object.serialize()]},n.getAffectedSheetId=function(){return"WORKBOOK"},n.getAffectedSheets=function(){return[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(){},n.runOnWorkbook=function(e){return e.embeddedObjectManager.updateEmbeddedObject(this.object),!0},n.invert=function(e){return[new t({object:e.embeddedObjectManager.getEmbeddedObject(this.object.objectId).clone()})]},n.transformWithInsertDimensionMutation=function(e){var n=this.object.location;if(n.sheetId!==e.sheetId)return[this];var r,i=n.position,o=i.rowIndex,s=i.colIndex,a=!1;if(e.type===h.ROWS?((r=new u(e.sheetId,o,o,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o||r.endIndex!==o):((r=new u(e.sheetId,s,s,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==s||r.endIndex!==s),a){var d=this.object.clone();return d.location.position={rowIndex:e.type===h.ROWS?r.startIndex:o,colIndex:e.type===h.ROWS?s:r.startIndex},[new t({object:d})]}return[this]},n.transformWithDeleteDimensionMutation=function(e){var n=this.object.location;if(n.sheetId!==e.sheetId)return[this];var r,i=n.position,o=i.rowIndex,s=i.colIndex,a=!1;if(e.type===h.ROWS?((r=new u(e.sheetId,o,o,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o||r.endIndex!==o):((r=new u(e.sheetId,s,s,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==s||r.endIndex!==s),a){var d=this.object.clone();return d.location.position={rowIndex:e.type===h.ROWS?r.startIndex:o,colIndex:e.type===h.ROWS?s:r.startIndex},[new t({object:d})]}return[this]},n.transformWithDeleteSheetMutation=function(e){return this.object.location.sheetId!==e.sheetId?[this]:[]},n.transformWithDefineWorkbookRangeMutation=function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new a.Z({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]},n.transformWithUpdateWorkbookRangeMutation=function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new a.Z({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]},n.transformWithNewAddEmbeddedObjectMutation=function(e,n){return this.object.objectId===e.object.objectId?n?[new t({object:this.object.clone()})]:[]:[this]},n.transformWithNewDeleteEmbeddedObjectMutation=function(e){return this.object.objectId===e.objectId?[]:[this]},n.transformWithNewUpdateEmbeddedObjectMutation=function(e,n){return this.object.objectId===e.object.objectId?n?[new t({object:this.object.clone()})]:[]:[this]},t}(s.Z);t.Z=l},58763:function(e,t,n){"use strict";n.d(t,{S:function(){return g}});var r=n(58926),i=n(13504),o=(n(19553),n(30980),n(38934),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(93984),n(90109),n(31688),n(8195),n(62883),n(26178)),s=n(38808),a=n(85249),d=n(75832),h=n(81300),u=n(74140),l=o.Range.GridRange,c=o.Range.DimensionRange,f=o.Cell.cellDataUtils,I=o.Dimension.DIMENSION_TYPE,g=function(e){this.source=e.source,this.destination=e.destination};function p(e,t){if(e.isRow){if(!t.isRow)return!1}else{if(t.isRow)return!1;if(e.endRowIndex-e.startRowIndex!==t.endRowIndex-t.startRowIndex)return!1}if(e.isCol){if(!t.isCol)return!1}else{if(t.isCol)return!1;if(e.endColIndex-e.startColIndex!==t.endColIndex-t.startColIndex)return!1}return!0}g.protoMap={0:{name:"source",dataType:l},1:{name:"destination",dataType:l}};var m=function(e){function t(t){var n;(n=e.call(this,s.ZP.COPY_PASTE_MUTATION,t)||this).sheetId=t.sheetId,n.cellMask=t.cellMask,n.formatMask=t.formatMask;var r=t.pasteMappings;return n.checkPasteMappings(r)?n.pasteMappings=t.pasteMappings:(console.warn("pasteMapping must be same rowLen and colLen"),n.pasteMappings=n.filterPasteMappings(r)),n}(0,i.Z)(t,e),t.deserialize=function(e){var n,r,i={sheetId:e[0],cellMask:e[1],formatMask:e[2],pasteMappings:[]};for(n=0,r=e[3].length;n<r;n++)i.pasteMappings.push({source:l.deserialize(e[3][n][0]),destination:l.deserialize(e[3][n][1])});return new t(i)};var n=t.prototype;return n.serialize=function(){var e,t,n=[this.sheetId,this.cellMask,this.formatMask],r=[];for(e=0,t=this.pasteMappings.length;e<t;e++)r.push([this.pasteMappings[e].source.serialize(),this.pasteMappings[e].destination.serialize()]);return n.push(r),n},n.getAffectedGridRanges=function(){return this.pasteMappings.map((function(e){return e.destination}))},n.checkPasteMappings=function(e){var t=!0;return e.forEach((function(e){var n=e.source,r=e.destination;t&&(t=p(n,r))})),t},n.filterPasteMappings=function(e){return e.filter((function(e){return p(e.source,e.destination)}))},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=[];return function(e){var t=new Map;return e.filter((function(e){return!t.has(e)&&t.set(e,1)}))}(this.pasteMappings.map((function(e){return e.source.sheetId}))).forEach((function(n){var r=e.sheetManager.getSheetBySheetId(n);r&&t.push(r)})),t},n.generateSetRangeMutations=function(e){var t=this.cellMask,n=this.formatMask;return this.pasteMappings.map((function(r){for(var i=r.source,o=r.destination,s=i.startColIndex,a=i.startRowIndex,l=o.startColIndex,c=o.endColIndex,I=o.startRowIndex,g=o.endRowIndex,p=l-s,m=I-a,v=[],R=I;R<=g;R++)for(var x=l;x<=c;x++){var T=e.getCellDataAtPosition(R-m,x-p,{isIgnoreFilterView:!0}),E=e.getCellDataAtPosition(R,x,{isIgnoreFilterView:!0}),w=f.createCellDataDelta(E,T,t,n);(null===T||void 0===T?void 0:T.getCellType())===u.ZP.TODO&&(w.clearSlot(h.CELL_DATA_SLOT.SLOT_METADATA),w.clearSlot(h.CELL_DATA_SLOT.SLOT_REF_IDS)),w.isEmpty()||v.push({rowIndex:R,colIndex:x,cellDataDelta:w})}return new d.Z({gridRange:o,cellDataDeltaAtPositions:v})}))},n.runOnSheet=function(e){this.generateSetRangeMutations(e).forEach((function(t){return e.spreadsheetReference.parent.mutationBehavior.applyMutation(t,{isLocal:!0,isMapping:!0},e)}))},n.invert=function(e){var t=[],n=this.cellMask,i=this.formatMask;return this.pasteMappings.forEach((function(o){var s=o.source,a=o.destination,h=s.sheetId,u=s.startColIndex,l=s.startRowIndex,c=a.startColIndex,I=a.endColIndex,g=a.startRowIndex,p=a.endRowIndex,m=c-u,v=g-l,R=e.sheetManager.getSheetBySheetId(h);if(R){for(var x=[],T=g;T<=p;T++)for(var E=c;E<=I;E++){var w=R.getCellDataAtPosition(T-v,E-m),y=R.getCellDataAtPosition(T,E),S=f.createCellDataDelta(y,w,n,i);S.isEmpty()||x.push({rowIndex:T,colIndex:E,cellDataDelta:S})}var O=new d.Z({gridRange:a,cellDataDeltaAtPositions:x}).invert(e);t=[].concat((0,r.Z)(t),(0,r.Z)(O))}})),t},n.transformWithInsertDimensionMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithDeleteDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=-2147483647;function r(e,t){return e==n?e:e+t}function i(e){return e!=n?e:2147483647}function o(e,t){return e.startIndex==e.endIndex&&e.startIndex!=n&&e.endIndex!=n&&t.startIndex==t.endIndex&&t.startIndex!=n&&t.endIndex!=n?e.endIndex<t.startIndex:i(e.endIndex)<=t.startIndex}function s(e,t){return t.startIndex==t.endIndex&&t.startIndex!=n&&t.endIndex!=n?e.startIndex==e.endIndex&&e.startIndex!=n&&e.endIndex!=n&&e.startIndex==t.startIndex:e.startIndex==e.endIndex&&e.startIndex!=n&&e.endIndex!=n?e.startIndex>=t.startIndex&&e.startIndex<i(t.endIndex):e.startIndex>=t.startIndex&&i(e.endIndex)<=i(t.endIndex)}function a(e,t){var n,a,d,h,u=t.endIndex-t.startIndex;if(0==u)return e;if(o(e,t))return e;if(s(e,t))return h=t.startIndex,new m(h,h);d=e.startIndex,n=e.endIndex;var l=i(e.endIndex);return e.startIndex<t.startIndex&&l>t.startIndex&&l<i(t.endIndex)?n=t.startIndex:s(t,e)?n=r(n,-u):(a=i(t.endIndex),t.startIndex<e.startIndex&&a>e.startIndex&&a<i(e.endIndex)?(d=t.startIndex,n=r(n,-u)):o(t,e)&&(d=r(d,-u),n=r(n,-u))),new m(d,n)}function d(e,t,n,r){if(!u(t,e.sheetId))return e;var i=n==I.ROWS,o=p(e,n),s=a(o,r);return s==o||s.startIndex==o.startIndex&&s.endIndex==o.endIndex?e:i?function(e,t){return new l(e.sheetId,e.startRowIndex,e.endRowIndex,t.startIndex,t.endIndex)}(e,s):function(e,t){return new l(e.sheetId,t.startIndex,t.endIndex,e.startColIndex,e.endColIndex)}(e,s)}function h(e){return null==e?null:e}function u(e,t){return h(e)===h(t)}var f=l;function p(e,t){var n=e.startRowIndex,r=e.endRowIndex,i=e.startColIndex,o=e.endColIndex;return t===I.ROWS?new m(n,r):new m(i,o)}var m=function(e,t){this.startIndex=e,this.endIndex=t};function v(e,t,n){return function(e,t,n,r){return t==I.ROWS?new f(e.sheetId,n,e.endRowIndex,r,e.endColIndex):new f(e.sheetId,e.startRowIndex,n,e.startColIndex,r)}(e,n,t.startIndex,t.endIndex)}function R(e,t,n){var r=p(e.source,n),i=p(e.destination,n),o=v(e.source,new m(r.startIndex,r.startIndex+t),n),s=v(e.source,new m(r.startIndex+t,r.endIndex),n),a=v(e.destination,new m(i.startIndex,i.startIndex+t),n),d=v(e.destination,new m(i.startIndex+t,i.endIndex),n);return{a:new g({source:o,destination:a}),c:new g({source:s,destination:d})}}function x(e,t,n,r){return r>e&&t>n||e==n&&t==r}function T(t,n,r){var i,o,s;if(e.type){var a=n.type==I.ROWS?I.ROWS:I.COLUMNS,h=new c(n.sheetId,n.index,n.index+n.amount,e.type),l=p(t.source,a),f=p(t.destination,a),m=n.sheetId;x(l.startIndex,l.endIndex,h.startIndex,h.endIndex)&&m===t.source.sheetId?h.startIndex>l.startIndex?(T((s=R(t,h.startIndex-l.startIndex,a)).a,n,r),T(s.c,n,r)):h.endIndex<l.endIndex&&(T((s=R(t,h.endIndex-l.startIndex,a)).a,n,r),T(s.c,n,r)):x(f.startIndex,f.endIndex,h.startIndex,h.endIndex)&&m===t.destination.sheetId?h.startIndex>f.startIndex?(T((s=R(t,h.startIndex-f.startIndex,a)).a,n,r),T(s.c,n,r)):h.endIndex<f.endIndex&&(T((s=R(t,h.endIndex-f.startIndex,a)).a,n,r),T(s.c,n,r)):(o=u(m,t.source.sheetId)?d(t.source,m,a,h):t.source,i=u(m,t.destination.sheetId)?d(t.destination,m,a,h):t.destination,r.push(new g({source:o,destination:i})))}else console.warn("copy paste mutation transform with dimensionMutation that is without dimension type")}var E=[];this.pasteMappings.forEach((function(t){var n=t.source,r=t.destination;(n=n.clone()).deleteDimension(e),(r=r.clone()).deleteDimension(e),T(t,e,E)}));var w=0==E.length?null:new t({sheetId:this.sheetId,pasteMappings:E,cellMask:this.cellMask,formatMask:this.formatMask});return w?[w]:[]},n.transformWithSetRangeMutation=function(e,t){if(this.sheetId!==e.gridRange.sheetId)return[this];var n=[];if(t)n.push(this);else if(this.sheetId!==e.gridRange.sheetId)n.push(this);else{for(var r=this.getAffectedGridRanges(),i=!1,o=0;o<r.length;o++)if(r[o].isCross(e.gridRange)){i=!0;break}i?(n.push(this),n.push(e)):n.push(this)}return n},n.transformWithSetCellPropertiesMutation=function(e){return this.sheetId,e.gridRange.sheetId,[this]},n.transformWithMergeCellsMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithCopyPasteMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithReorderRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},t}(a.Z);m.protoMap={0:{name:"cellMask",dataType:Number},1:{name:"formatMask",dataType:Number},2:{name:"pasteMappings",dataType:{type:Array,subType:g}},3:{name:"sheetId",dataType:String}},t.Z=m},52152:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=function(e){function t(t){var n;return(n=e.call(this,i.ZP.EMPTY_MUTATION,t)||this).sheetId=t.sheetId,n}(0,r.Z)(t,e),t.deserialize=function(){return new t({sheetId:""})};var n=t.prototype;return n.serialize=function(){return[]},n.getAffectedSheets=function(){return[]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.check=function(){return{isValid:!0}},n.runOnSheet=function(){},n.invert=function(){return[]},t}(n(85249).Z);t.Z=o},17144:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=function(e){function t(t){var n;return(n=e.call(this,i.ZP.INIT_DATA_MUTATION,t)||this).sheetId=t.sheetId,n.lastRow=t.lastRow,n.lastCol=t.lastCol,n}(0,r.Z)(t,e),t.deserialize=function(e){if("string"!==typeof e[0])throw new TypeError("sheetid type error");if("number"!==typeof e[1]||"number"!==typeof e[2])throw new TypeError("lastRow or lastCol type error");return new t({sheetId:e[0],lastRow:e[1],lastCol:e[2]})};var n=t.prototype;return n.serialize=function(){return[]},n.getAffectedSheets=function(){return[]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.runOnSheet=function(){},n.invert=function(){return[]},t}(n(85249).Z);t.Z=o},20911:function(e,t,n){"use strict";var r=n(13504),i=(n(62883),n(38934),n(31688),n(8195),n(26178)),o=n(38808),s=n(85249),a=n(62962),d=n(98279),h=n(85145),u=i.Dimension.DIMENSION_TYPE,l=i.Range.DimensionRange,c=i.Range.GridRange,f=i.Rule.ConditionalFormatRule,I={0:{name:"from",dataType:{type:Object,protoMap:{0:{name:"startIndex",dataType:Number},1:{name:"endIndex",dataType:Number}}}},1:{name:"to",dataType:Number},2:{name:"sourceSheetId",dataType:String},3:{name:"destinationSheetId",dataType:String}},g=function(e){function t(t){var n;return(n=e.call(this,o.ZP.MAP_RANGE_MUTATION,t)||this).sourceSheetId=t.sourceSheetId,n.destinationSheetId=t.destinationSheetId,n.row=t.row,n.column=t.column,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sourceSheetId:e[0],destinationSheetId:e[1],row:{from:{startIndex:e[2][0][0],endIndex:e[2][0][1]},to:e[2][1],sourceSheetId:e[2][2],destinationSheetId:e[2][3]},column:{from:{startIndex:e[3][0][0],endIndex:e[3][0][1]},to:e[3][1],sourceSheetId:e[3][2],destinationSheetId:e[3][3]}})};var n=t.prototype;return n.serialize=function(){return[this.sourceSheetId,this.destinationSheetId,[[this.row.from.startIndex,this.row.from.endIndex],this.row.to,this.row.sourceSheetId,this.row.destinationSheetId],[[this.column.from.startIndex,this.column.from.endIndex],this.column.to,this.column.sourceSheetId,this.column.destinationSheetId]]},n.getAffectedSheetId=function(){return this.destinationSheetId},n.setAffectedSheetId=function(e){this.destinationSheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sourceSheetId);n&&t.push(n);var r=e.sheetManager.getSheetBySheetId(this.destinationSheetId);return r&&r!==n&&t.push(r),t},n.runOnSheet=function(){},n.runOnFormulaModel=function(e){e.mapRangeForFormulaModel(this)},n.invert=function(){var e=[];return e.push(new t({sourceSheetId:this.destinationSheetId,destinationSheetId:this.sourceSheetId,row:p(this.row),column:p(this.column)})),e},n.transformWithInsertDimensionMutation=function(e){if(this.sourceSheetId!==e.sheetId)return[this];var n,r,i=[];if(n=e.type===u.ROWS?{from:{startIndex:this.row.from.startIndex,endIndex:this.row.from.endIndex},to:this.row.to,sourceSheetId:this.row.sourceSheetId,destinationSheetId:this.row.destinationSheetId}:{from:{startIndex:this.column.from.startIndex,endIndex:this.column.from.endIndex},to:this.column.to,sourceSheetId:this.column.sourceSheetId,destinationSheetId:this.column.destinationSheetId},e.sheetId===n.sourceSheetId&&((r=new l(n.sourceSheetId,n.from.startIndex,n.from.endIndex,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),n.from.startIndex=r.startIndex,n.from.endIndex=r.endIndex),e.sheetId===n.destinationSheetId){var o=n.to+(e.index<=n.from.startIndex?Math.max(e.index+e.amount-n.from.startIndex,0):0);(r=new l(n.destinationSheetId,o,o,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),n.to=r.startIndex}return i.push(new t({sourceSheetId:this.sourceSheetId,destinationSheetId:this.destinationSheetId,row:e.type===u.ROWS?n:this.row,column:e.type===u.COLUMNS?n:this.column})),i},n.transformWithDeleteDimensionMutation=function(e){if(this.sourceSheetId!==e.sheetId)return[this];var n,r,i=[];if(n=e.type===u.ROWS?{from:{startIndex:this.row.from.startIndex,endIndex:this.row.from.endIndex},to:this.row.to,sourceSheetId:this.row.sourceSheetId,destinationSheetId:this.row.destinationSheetId}:{from:{startIndex:this.column.from.startIndex,endIndex:this.column.from.endIndex},to:this.column.to,sourceSheetId:this.column.sourceSheetId,destinationSheetId:this.column.destinationSheetId},e.sheetId===n.sourceSheetId&&((r=new l(n.sourceSheetId,n.from.startIndex,n.from.endIndex,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),n.from.startIndex=r.startIndex,n.from.endIndex=r.endIndex),e.sheetId===n.destinationSheetId){var o=n.to+(e.index<=n.from.startIndex?Math.max(e.index+e.amount-n.from.startIndex,0):0);(r=new l(n.destinationSheetId,o,o,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),n.to=r.startIndex}return i.push(new t({sourceSheetId:this.sourceSheetId,destinationSheetId:this.destinationSheetId,row:e.type===u.ROWS?n:this.row,column:e.type===u.COLUMNS?n:this.column})),i},n.transformWithSetDimensionPropertiesMutation=function(e,t){if(this.sourceSheetId!==e.sheetId)return[this];var n,r,i,o,s,d,h=[],c=e.ranges,f=[];if(h.push(this),e.sheetId!==this.sourceSheetId)return h;for(e.type===u.ROWS?(r=new l(this.sourceSheetId,this.row.from.startIndex,this.row.from.endIndex,u.ROWS),s=this.row.to):(r=new l(this.sourceSheetId,this.column.from.startIndex,this.column.from.endIndex,u.COLUMNS),s=this.column.to),i=0;i<c.length;i++)(n=c[i]).isCross(r)&&(o=n.divideByCross(r)).cross&&(d=o.cross.move({from:{startIndex:r.startIndex,endIndex:r.endIndex},to:s}),Array.prototype.push.apply(f,d));return f.length>0&&h.push(new a.ZP({operation:e.operation,ranges:f,type:e.type,sheetId:e.sheetId})),h},n.transformWithSetRangeMutation=function(e){return this.sourceSheetId,e.gridRange.sheetId,[this]},n.transformWithSetCellPropertiesMutation=function(e,t){return this.sourceSheetId,e.gridRange.sheetId,[this]},n.transformWithMergeCellsMutation=function(e){if(this.sourceSheetId!==e.sheetId)return[this];var t=[],n=this.destinationSheetId;if(n!==e.sheetId)return[this];var r=new c(n,this.row.to,this.row.to,this.column.to,this.column.to);return new c(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex).isCross(r)&&(this.row.from.startIndex===this.row.from.endIndex&&this.column.from.startIndex===this.column.from.endIndex&&this.row.to===e.startRowIndex&&this.column.to===e.endRowIndex||t.push(new d.Z({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex}))),t.push(this),t},n.transformWithDeleteSheetMutation=function(e,t){return this.sourceSheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDefineSheetRangeMutation=function(e){return this.sourceSheetId,e.sheetId,[this]},n.transformWithUpdateSheetRangeMutation=function(e){return this.sourceSheetId,e.sheetId,[this]},n.transformWithAddConditionalFormatMutation=function(e){var t=this;if(this.sourceSheetId!==e.sheetId)return[this];if(this.sourceSheetId===e.sheetId||this.destinationSheetId===e.sheetId){var n=[],r=[],i=[],o=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===t.sourceSheetId){var s=[],a=new c(t.sourceSheetId,-1===t.row.to?e.startRowIndex:t.row.from.startIndex,-1===t.row.to?e.endRowIndex:t.row.from.endIndex,-1===t.column.to?e.startColIndex:t.column.from.startIndex,-1===t.column.to?e.endColIndex:t.column.from.endIndex),d=e.getCross(a);d&&(s.push(d),r.push(d),o.push(new c(t.sourceSheetId,-1===t.row.to?d.startRowIndex:d.startRowIndex-t.row.from.startIndex+t.row.to,-1===t.row.to?d.endRowIndex:d.endRowIndex-t.row.from.startIndex+t.row.to,-1===t.column.to?d.startColIndex:d.startColIndex-t.column.from.startIndex+t.column.to,-1===t.column.to?d.endColIndex:d.endColIndex-t.column.from.startIndex+t.column.to)));var h=new c(t.sourceSheetId,-1===t.row.to?e.startRowIndex:t.row.to,-1===t.row.to?e.endRowIndex:t.row.to+t.row.from.endIndex-t.row.from.startIndex,-1===t.column.to?e.startColIndex:t.column.to,-1===t.column.to?e.endColIndex:t.column.to+t.column.from.endIndex-t.column.from.startIndex),u=e.getCross(h);u&&(s.push(u),i.push(u)),d||u?s.forEach((function(t){var r=e.startRowIndex,i=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(n.push(new c(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),r=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(n.push(new c(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),i=t.endRowIndex),e.startColIndex<t.startColIndex&&n.push(new c(e.sheetId,r,i,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&n.push(new c(e.sheetId,r,i,t.endColIndex,e.endColIndex))})):n.push(e)}})),n.length>0||o.length>0?[this,new h.Z({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new f({ruleRanges:[].concat(n,o),booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat,dataBarConditionalFormat:e.rule.dataBarConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})]:[this]}return[this]},n.transformWithUpdateConditionalFormatMutation=function(e,t){var n=this;if(this.sourceSheetId!==e.sheetId)return[this];if(this.sourceSheetId===e.sheetId||this.destinationSheetId===e.sheetId){var r=[],i=[],o=[],s=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===n.sourceSheetId){var t=[],a=new c(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.from.startIndex,-1===n.row.to?e.endRowIndex:n.row.from.endIndex,-1===n.column.to?e.startColIndex:n.column.from.startIndex,-1===n.column.to?e.endColIndex:n.column.from.endIndex),d=e.getCross(a);d&&(t.push(d),i.push(d),s.push(new c(n.sourceSheetId,-1===n.row.to?d.startRowIndex:d.startRowIndex-n.row.from.startIndex+n.row.to,-1===n.row.to?d.endRowIndex:d.endRowIndex-n.row.from.startIndex+n.row.to,-1===n.column.to?d.startColIndex:d.startColIndex-n.column.from.startIndex+n.column.to,-1===n.column.to?d.endColIndex:d.endColIndex-n.column.from.startIndex+n.column.to)));var h=new c(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.to,-1===n.row.to?e.endRowIndex:n.row.to+n.row.from.endIndex-n.row.from.startIndex,-1===n.column.to?e.startColIndex:n.column.to,-1===n.column.to?e.endColIndex:n.column.to+n.column.from.endIndex-n.column.from.startIndex),u=e.getCross(h);u&&(t.push(u),o.push(u)),d||u?t.forEach((function(t){var n=e.startRowIndex,i=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(r.push(new c(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),n=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(r.push(new c(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),i=t.endRowIndex),e.startColIndex<t.startColIndex&&r.push(new c(e.sheetId,n,i,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&r.push(new c(e.sheetId,n,i,t.endColIndex,e.endColIndex))})):r.push(e)}})),r.length>0||s.length>0?[this,new h.Z({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new f({ruleRanges:[].concat(r,s),booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat,dataBarConditionalFormat:e.rule.dataBarConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})]:[this]}return[this]},t}(s.Z);function p(e){var t={from:{startIndex:0,endIndex:0},to:0,sourceSheetId:e.destinationSheetId,destinationSheetId:e.sourceSheetId};return t.from.startIndex=e.to,t.from.endIndex=e.to+(e.from.endIndex-e.from.startIndex),t.to=e.from.startIndex,t}g.protoMap={0:{name:"sourceSheetId",dataType:String},1:{name:"destinationSheetId",dataType:String},2:{name:"row",dataType:{type:Object,protoMap:I}},3:{name:"column",dataType:{type:Object,protoMap:I}}},t.Z=g},54500:function(e,t,n){"use strict";var r=n(13504),i=(n(62883),n(71096),n(8195),n(41031),n(26178)),o=n(38808),s=n(85249),a=n(98279),d=n(87485),h=n(70594),u=i.Dimension.DIMENSION_TYPE,l=i.Range.GridRange,c={0:{name:"queue",dataType:{type:Array,subType:String}},1:{name:"rules",dataType:{type:Object,subType:{type:Object,protoMap:{0:{name:"from",dataType:Number},1:{name:"to",dataType:Number}}}}}},f=function(e){function t(t){var n;return(n=e.call(this,o.ZP.REORDER_RANGE_MUTATION,t)||this).sheetId=t.sheetId,n.range=t.range,n.operation=t.operation,n}(0,r.Z)(t,e),t.deserialize=function(e){var n,r,i={sheetId:e[0],range:l.deserialize(e[1]),operation:{queue:e[2][0],rules:{}}},o=Object.keys(e[2][1]);for(n=0,r=o.length;n<r;n++)i.operation.rules[o[n]]={from:e[2][1][o[n]][0],to:e[2][1][o[n]][1]};return new t(i)};var n=t.prototype;return n.serialize=function(){var e,t,n=[this.sheetId,this.range.serialize()],r=[];r.push(this.operation.queue),r.push({});var i=Object.keys(this.operation.rules);for(e=0,t=i.length;e<t;e++)r[1][i[e]]=[this.operation.rules[i[e]].from,this.operation.rules[i[e]].to];return n.push(r),n},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e,this.range.sheetId=e},n.getAffectedGridRanges=function(){return[this.range]},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},n.runOnSheet=function(e){for(var t=[],n=0;n<this.operation.queue.length;n++)t.push(this.operation.rules[this.operation.queue[n]]);(0,d.moveRange)(e,this.range,t),this.reorderFilterView(e)},n.runOnFormulaModel=function(e){e.reorderRangeForFormulaModel(this)},n.invert=function(e){var t=[];t=t.concat(this.reset());var n=(0,h.lO)(e).getInvertMutationsForRowReorderMutation(this);return t=t.concat(n)},n.reset=function(){var e,n,r=[],i={queue:[],rules:{}},o=this.operation.queue,s=this.operation.rules;for(e=0;e<o.length;e++)n=s[o[e]],i.queue.push(""+n.to),i.rules[""+n.to]={from:n.to,to:n.from};return r.push(new t({range:this.range,sheetId:this.sheetId,operation:i})),r},n.getOrderResult=function(e){var t,n;for(t=0,n=this.operation.queue.length;t<n;t++)if(e===Number(this.operation.queue[t]))return this.operation.rules[e].to;return null},n.transformWithInsertDimensionMutation=function(e,n){if(this.sheetId!==e.sheetId)return[this];var r,i,o=[],s=JSON.parse(JSON.stringify(this.operation)),a=s.queue,d=s.rules,h=this.range.clone();if(h.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),e.type===u.ROWS)for(i=0;i<a.length;i++)(r=d[a[i]]).from>=e.index&&(r.from+=e.amount,delete d[a[i]],a[i]=""+r.from,d[a[i]]=r),r.to>=e.index&&(r.to+=e.amount);return o.push(new t({range:h,sheetId:this.sheetId,operation:s})),o},n.transformWithDeleteDimensionMutation=function(e,n){if(this.sheetId!==e.sheetId)return[this];var r,i,o=[],s=JSON.parse(JSON.stringify(this.operation)),a=s.queue,d=s.rules,h=this.range.clone();if(h.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),e.type===u.COLUMNS){if(!h.isValid())return o}else for(i=0;i<a.length;i++)(r=d[a[i]]).from>=e.index&&(r.from<=e.index+e.amount-1?(delete d[a[i]],a.splice(i,1)):r.from-=e.amount);return o.push(new t({range:h,sheetId:this.sheetId,operation:s})),o},n.transformWithSetRangeMutation=function(e,t){return this.sheetId,e.gridRange.sheetId,[this]},n.transformWithSetCellPropertiesMutation=function(e,t){return this.sheetId,e.gridRange.sheetId,[this]},n.transformWithCopyPasteMutation=function(e,t){return this.sheetId,e.sheetId,[this]},n.transformWithMergeCellsMutation=function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[],r=e.startRowIndex,i=e.endRowIndex,o=e.startColIndex,s=e.endColIndex,d=e.sheetId,h=new l(d,r,i,o,s);return d===this.sheetId&&h.isCross(this.range)&&n.push(new a.Z({sheetId:d,startRowIndex:r,endRowIndex:i,startColIndex:o,endColIndex:s})),n.push(this),n},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDefineSheetRangeMutation=function(e,t){return this.sheetId,e.sheetId,[this]},n.transformWithUpdateSheetRangeMutation=function(e,t){return this.sheetId,e.sheetId,[this]},n.transformWithReorderRangeMutation=function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return this.range.isCross(e.range)?t&&(n=n.concat(e.reset())).push(this):n.push(this),n},n.reorderFilterView=function(e){if(e){var t=e.filterViewManager.getActiveFilterView();t&&t.reactivate()}},t}(s.Z);f.protoMap={0:{name:"sheetId",dataType:String},1:{name:"range",dataType:l},2:{name:"operation",dataType:{type:Object,protoMap:c}}},t.Z=f},3639:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var r=n(26178).Dimension.DIMENSION_TYPE;function i(e,t){var n,i=!1;return-1!==(n=e===r.ROWS?t.row:t.column).from.startIndex&&-1!==n.from.endIndex&&(i=!0),i}},84217:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(93896),a=n(56873),d=n(52810),h=n(95776),u=function(e){function t(t){var n;return(n=e.call(this,i.ZP.ADD_PIVOT_TABLE_MUTATION,t)||this).sheetId=t.sheetId,n.pivotTableItem=t.pivotTableItem,n.pivotCacheItem=t.pivotCacheItem,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],pivotTableItem:d.K.deserialize(e[1]),pivotCacheItem:h.G.deserialize(e[2])})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,d.K.serialize(this.pivotTableItem),h.G.serialize(this.pivotCacheItem)]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){e.spreadsheetReference.sheetManager.getSheetBySheetId(this.sheetId).pivotTableManager.addPivotTable(this.pivotTableItem,this.pivotCacheItem)},n.invert=function(e){var t=[],n=!e.sheetManager.getSheetBySheetId(this.sheetId).pivotTableManager.pivotCacheMap.has(this.pivotCacheItem.id),r=new s.Z({sheetId:this.sheetId,pivotTableId:this.pivotTableItem.id,shouldDeleteCache:n});return t.push(r),t},n.transformWithAddPivotTableMutation=function(e,t){var n=e.pivotTableItem,r=(0,a.hex2Range)(n.tableDefinition.location.ref,n.sheetId),i=(0,a.hex2Range)(this.pivotTableItem.tableDefinition.location.ref,this.pivotTableItem.sheetId);return r.equal(i)&&!t?[]:e.pivotTableItem.id!==this.pivotTableItem.id||t?[this]:[]},n.transformWithDeletePivotTableMutation=function(e,t){return e.pivotTableId!==this.pivotTableItem.id||t?[this]:[]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId===e.sheetId&&t?[]:[this]},t}(o.Z);t.Z=u},93896:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(84217),a=n(56873),d=function(e){function t(t){var n;return(n=e.call(this,i.ZP.DELETE_PIVOT_TABLE_MUTATION,t)||this).sheetId=t.sheetId,n.pivotTableId=t.pivotTableId,n.shouldDeleteCache=t.shouldDeleteCache,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],pivotTableId:e[1],shouldDeleteCache:e[2]})};var o=t.prototype;return o.serialize=function(){return[this.sheetId,this.pivotTableId,this.shouldDeleteCache]},o.getAffectedSheetId=function(){return this.sheetId},o.setAffectedSheetId=function(e){this.sheetId=e},o.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},o.check=function(){return{isValid:!0}},o.runOnSheet=function(e){var t=this.pivotTableId,n=this.shouldDeleteCache;e.pivotTableManager.deletePivotTable(t,n)},o.invert=function(e){var t,r,i=e.sheetManager.getSheetBySheetId(this.sheetId),o=i.pivotTableManager.pivotTableMap.get(this.pivotTableId),d=i.pivotTableManager.pivotCacheMap.get(o.cacheId);if(!o||!d)return null===(t=n.g.log)||void 0===t||t.error("delete-pivot-table-mutation","invert: 未找到待更新内容"),[];var h=function(e,t){var n=e.ref;return n?(0,a.hex2Range)(n,t):null}(o.tableDefinition.location,this.sheetId);return h?[new s.Z({sheetId:this.sheetId,pivotTableItem:o,pivotCacheItem:d})]:(null===(r=n.g.log)||void 0===r||r.error("delete-pivot-table-mutation","invert: 未找到合法 location"),[])},o.transformWithAddPivotTableMutation=function(e,t){return e.pivotTableItem.id!==this.pivotTableId||t?[this]:[]},o.transformWithDeletePivotTableMutation=function(e,t){return e.pivotTableId!==this.pivotTableId||t?[this]:[]},o.transformWithDeleteSheetMutation=function(e,t){return this.sheetId===e.sheetId&&t?[]:[this]},t}(o.Z);t.Z=d},81646:function(e,t,n){"use strict";var r=n(38661),i=n(13504),o=(n(46396),n(38808)),s=n(85249),a=n(52810),d=n(95776),h=function(e){function t(t){var n;return n=e.call(this,o.ZP.UPDATE_PIVOT_TABLE_MUTATION,t)||this,Object.assign((0,r.Z)(n),t),n}(0,i.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],pivotTableItem:e[1]?a.K.deserialize(e[1]):void 0,pivotCacheItem:e[2]?d.G.deserialize(e[2]):void 0})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.pivotTableItem?a.K.serialize(this.pivotTableItem):void 0,this.pivotCacheItem?d.G.serialize(this.pivotCacheItem):void 0]},n.shouldSyncToWorker=function(){return!this.isFromFormula},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){this.pivotTableItem&&e.pivotTableManager.updatePivotTable(this.pivotTableItem.id,this.pivotTableItem),this.pivotCacheItem&&e.pivotTableManager.updatePivotCache(this.pivotCacheItem.id,this.pivotCacheItem)},n.invert=function(e){var n=e.sheetManager.getSheetBySheetId(this.sheetId),r=this.pivotTableItem&&n.pivotTableManager.pivotTableMap.get(this.pivotTableItem.id),i=this.pivotCacheItem&&n.pivotTableManager.pivotCacheMap.get(this.pivotCacheItem.id);return[new t({sheetId:this.sheetId,pivotTableItem:r,pivotCacheItem:i})]},n.transformWithUpdatePivotTableMutation=function(e,t){var n,r,i,o;return(null===(n=e.pivotTableItem)||void 0===n?void 0:n.id)!==(null===(r=this.pivotTableItem)||void 0===r?void 0:r.id)&&(null===(i=e.pivotCacheItem)||void 0===i?void 0:i.id)!==(null===(o=this.pivotCacheItem)||void 0===o?void 0:o.id)||t?[this]:[]},n.transformWithDeletePivotTableMutation=function(e,t){var n;return e.pivotTableId===(null===(n=this.pivotTableItem)||void 0===n?void 0:n.id)&&t?[]:[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId===e.sheetId&&t?[]:[this]},t}(s.Z);t.Z=h},11222:function(e,t,n){"use strict";var r=n(13504),i=n(31973),o=n(61502),s=function(e){function t(t,n){return void 0===n&&(n={}),e.call(this,t,n)||this}(0,r.Z)(t,e);var n=t.prototype;return n.serialize=function(){return[]},n.isMultiSheetMutation=function(){return!0},n.getAffectedSheets=function(e){return[]},n.getAffectedSheetId=function(){return""},n.invert=function(e){return[]},n.run=function(e,t){var n={isValid:!1,errorMessage:"默认错误"};return"undefined"!==typeof e.getSpreadsheetId&&(this.runOnWorkbook(e),n=this.checkAndRunOnSheet(e,t)),{runResult:n,runCache:[],workbookWithSheetId:void 0,isMultiSheet:!0}},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){},n.checkAndRunOnSheet=function(e,t){var n={isValid:!1,errorMessage:"默认错误"},r=!1;try{n=this.check()}catch(s){i.ZP.run(o.mz.CHECK_MUTATION_ERROR,this,s,n)}if(!n.isValid&&(i.ZP.run(o.mz.CHECK_MUTATION_RESULT_ERROR,this,n),!t.ignoreCheck))return n;try{this.runOnSheet(e)}catch(s){console.error("Run mutation error: ",this,s),i.ZP.run(o.mz.RUN_MUTATION_ERROR,s,this),s.message&&0===s.message.indexOf("ApiCheckError")||(r=!0)}return{isValid:!r,errorMessage:r?"有遇到mutation运行错误":void 0}},t}(n(85249).Z);t.Z=s},66676:function(e,t,n){"use strict";var r=n(13504),i=(n(62883),n(26178)),o=n(38808),s=n(85249),a=n(6091),d=n(27571),h=n(78093),u=n(78449),l=n(22459),c=i.Range.GridRange,f=function(e){function t(t){var n;return(n=e.call(this,o.ZP.DEFINE_SHEET_RANGE_MUTATION,t)||this).sheetId=t.sheetId,n.sheetRangeId=t.sheetRangeId,n.gridRange=t.gridRange,n.sheetRangeType=t.sheetRangeType,n.nonPersistingLocalChange=t.nonPersistingLocalChange||!1,n.padId=t.padId,n.sheetRangeDelta=t.sheetRangeDelta,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],sheetRangeId:e[1],gridRange:c.deserialize(e[2]),sheetRangeType:e[3],padId:e[4],sheetRangeDelta:u.Z.deserialize(e[5])})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.sheetRangeId,this.gridRange.serialize(),this.sheetRangeType,this.padId,this.sheetRangeDelta.serialize()]},n.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},n.getAffectedSheetId=function(){return this.gridRange.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e,this.gridRange.sheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},n.getAffectedGridRanges=function(){return[this.gridRange]},n.check=function(e){return{isValid:!0}},n.runOnSheet=function(e){var t,n;this.sheetRangeType===d.SHEET_RANGE_TYPE.COMMENT_RANGE&&(n=new h.Z({sheetId:this.sheetId,gridRange:this.gridRange,sheetRangeType:this.sheetRangeType,padId:this.padId,properties:new l.Z({isArchived:null===(t=this.sheetRangeDelta.getCommentSheetRangeProperties())||void 0===t?void 0:t.isArchived})})),e.sheetRangeManager.addSheetRange(this.sheetRangeId,n)},n.invert=function(){return[new a.Z({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,nonPersistingLocalChange:this.nonPersistingLocalChange})]},n.transformWithInsertDimensionMutation=function(e){if(this.sheetId!==e.sheetId)return[this];var n=this.gridRange;return n.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({sheetRangeId:this.sheetRangeId,gridRange:n,sheetRangeType:this.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetId:this.sheetId,padId:this.padId,sheetRangeDelta:this.sheetRangeDelta})]},n.transformWithDeleteDimensionMutation=function(e,n){if(this.sheetId!==e.sheetId)return[this];var r=this.gridRange;return r.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({sheetRangeId:this.sheetRangeId,gridRange:r,sheetRangeType:this.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetId:this.sheetId,padId:this.padId,sheetRangeDelta:this.sheetRangeDelta})]},n.transformWithMergeCellsMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithAddEmbeddedObjectMutation=function(e){return this.sheetId,e.data.sheetId,[this]},n.transformWithDeleteEmbeddedObjectMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithUpdateEmbeddedObjectMutation=function(e){return this.sheetId,e.data.sheetId,[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDefineSheetRangeMutation=function(e,t){if(this.sheetId!==e.sheetId)return[this];if(t){var n=e.gridRange;if(this.gridRange.isCross(n)&&this.sheetRangeType===e.sheetRangeType)return[]}return[this]},n.transformWithDeleteSheetRangeMutation=function(e,t){return this.sheetId,e.sheetId,[this]},n.transformWithUpdateSheetRangeMutation=function(e,t){return this.sheetId,e.sheetId,[this]},n.transformWithReorderRangeMutation=function(e,t){return this.sheetId,e.sheetId,[this]},n.transformWithMapRangeMutation=function(e,t){return this.sheetId,e.sourceSheetId,[this]},t}(s.Z);f.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String},2:{name:"gridRange",dataType:c},3:{name:"sheetRangeType",dataType:Number},5:{name:"padId",dataType:String}},t.Z=f},60869:function(e,t,n){"use strict";var r=n(13504),i=n(26178),o=n(38808),s=n(11222),a=n(20191),d=i.Sheet.SheetPropertiesDelta,h=i.Sheet.NEW_SHEET_PROPERTIES_SLOT_OPERATION,u=function(e){function t(t){var n;return(n=e.call(this,o.ZP.DELETE_SHEET_MUTATION,t)||this).sheetId=t.sheetId,n.sheetIndex=t.sheetIndex,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],sheetIndex:e[1]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.sheetIndex]},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.getAffectedSheetId=function(){return this.sheetId},n.check=function(){return{isValid:!0}},n.transformWithInsertSheetMutation=function(e,n){if(this.sheetIndex>=e.sheetIndex&&n){var r=this.sheetIndex+1;return[new t({sheetId:this.sheetId,sheetIndex:r})]}return[this]},n.transformWithMoveSheetMutation=function(e,n){var r;return e.fromIndex===this.sheetIndex&&n?(r=e.toIndex,[new t({sheetId:this.sheetId,sheetIndex:r})]):e.fromIndex<this.sheetIndex&&e.toIndex>this.sheetIndex&&n?(r=this.sheetIndex-1,[new t({sheetId:this.sheetId,sheetIndex:r})]):e.fromIndex>this.sheetIndex&&e.toIndex<=this.sheetIndex&&n?(r=this.sheetIndex+1,[new t({sheetId:this.sheetId,sheetIndex:r})]):[this]},n.transformWithDeleteSheetMutation=function(e,n){if(this.sheetIndex>e.sheetIndex){var r=this.sheetIndex-1;return[new t({sheetId:this.sheetId,sheetIndex:r})]}return n&&this.sheetIndex===e.sheetIndex?[]:[this]},n.runOnSheet=function(e){var t,n,r,i,s=e.isExternalSheet(this.sheetId),a=null===(t=e.sheetManager.getSheetBySheetId(this.sheetId))||void 0===t?void 0:t.getSheetType();if(e.sheetManager.deleteSheetBySheetId(this.sheetId),s){var d=null===(i=null===(r=null===(n=e.parent)||void 0===n?void 0:n.sheetAdapterManager)||void 0===r?void 0:r.getAdapterBySheetType)||void 0===i?void 0:i.call(r,a);null===d||void 0===d||d.deleteSheet(this.sheetId)}else e.updateFormulaModelServiceForModel.updateFormulaModelFromMutation({sheetId:this.sheetId,sheetIndex:this.sheetIndex,id:o.ZP.DELETE_SHEET_MUTATION}),e.formulaModelManager.deleteSheet(this.sheetIndex,this.sheetId)},n.invert=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[new a.Z({sheetId:this.sheetId,sheetIndex:this.sheetIndex,sheetType:t.getSheetType(),rowCount:t.getRowCount(),colCount:t.getColCount(),sheetDelta:new d({operation:h.INSERT_SHEET,delta:{name:t.getTitle(),rightToLeft:t.getIsRtl(),hideGridline:t.getHideGridlines(),frozenColCount:t.getFrozenColCount(),frozenRowCount:t.getFrozenRowCount(),hidden:t.getDisplayHidden()}})})]:[]},t}(s.Z);t.Z=u},6091:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=n(85249),s=n(66676),a=n(6091),d=n(27571),h=n(78449),u=n(22459),l=function(e){function t(t){var n;return(n=e.call(this,i.ZP.DELETE_SHEET_RANGE_MUTATION,t)||this).sheetId=t.sheetId,n.sheetRangeId=t.sheetRangeId,n.nonPersistingLocalChange=t.nonPersistingLocalChange||!1,n}(0,r.Z)(t,e),t.deserialize=function(e){return new a.Z({sheetId:e[0],sheetRangeId:e[1]})};var o=t.prototype;return o.serialize=function(){return[this.sheetId,this.sheetRangeId]},o.getAffectedSheetId=function(){return this.sheetId},o.setAffectedSheetId=function(e){this.sheetId=e},o.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},o.getAffectedGridRanges=function(){var e,t=null===(e=n.g.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(this.sheetId).sheetRangeManager.getSheetRange(this.sheetRangeId))||void 0===e?void 0:e.gridRange;return t?[t]:[]},o.check=function(){return{isValid:!0}},o.runOnSheet=function(e){e.sheetRangeManager.deleteSheetRange(this.sheetRangeId)},o.invert=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=[];if(null===t)return n;var r=t.sheetRangeManager.getSheetRange(this.sheetRangeId);if(!r)return n;if(r.sheetRangeType===d.SHEET_RANGE_TYPE.COMMENT_RANGE){var i=new h.Z({commentSheetRangeProperties:new u.Z({isArchived:r.properties.isArchived})});n.push(new s.Z({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,gridRange:r.gridRange,sheetRangeType:r.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:r.padId,sheetRangeDelta:i}))}return n},o.transformWithUpdateFilterMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithDefineSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithDeleteSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},o.transformWithUpdateSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},t}(o.Z);l.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String}},t.Z=l},20191:function(e,t,n){"use strict";var r=n(13504),i=(n(38934),n(31688),n(46396),n(26178)),o=n(38808),s=n(11222),a=n(60869),d=n(20587),h=n(19251),u=n(11376),l=i.Sheet.SheetPropertiesDelta,c=i.Sheet.sheetPropertiesDeltaUtils,f=i.Sheet.NEW_SHEET_PROPERTIES_SLOT,I=i.Sheet.NEW_SHEET_PROPERTIES_SLOT_OPERATION,g=function(e){function t(t){var n;return(n=e.call(this,o.ZP.INSERT_SHEET_MUTATION,t)||this).sheetId=t.sheetId,n.sheetIndex=t.sheetIndex,n.sheetType=t.sheetType,n.rowCount=t.rowCount,n.colCount=t.colCount,n.sheetDelta=t.sheetDelta,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],sheetIndex:e[1],sheetType:e[2],sheetDelta:l.deserialize(e[3]),rowCount:e[4],colCount:e[5]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.sheetIndex,this.sheetType,this.sheetDelta.serialize(),this.rowCount,this.colCount]},n.getAffectedSheets=function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]},n.getAffectedSheetId=function(){return this.sheetId},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){var t=e.sheetManager.createSheet({id:this.sheetId,type:this.sheetType});t.setIndex(this.sheetIndex),c.mergeDeltaToSheetProperties(t.properties,this.sheetDelta),e.sheetManager.insertSheet(t,this.sheetIndex),e.formulaModelManager.insertSheet(this.sheetIndex,this.sheetId)},n.transformWithInsertSheetMutation=function(e,n){var r,i=this,o=this.sheetIndex,s=[];return this.sheetDelta.deltas.forEach((function(a){e.sheetDelta.deltas.forEach((function(u){a.slotName===f.SLOT_NAME&&u.slotName===f.SLOT_NAME&&a.value===u.value&&(n?(r=(0,h.t)(i,e),i.sheetIndex>=e.sheetIndex&&(o=i.sheetIndex+1),s.push(new t(Object.assign(Object.assign({},i),{sheetIndex:o,sheetDelta:r})))):(r=(0,h.t)(e,i),e.sheetIndex>=i.sheetIndex&&(o=e.sheetIndex+1),s.push(new d.Z(Object.assign(Object.assign({},e),{sheetIndex:o,sheetDelta:r})),i)))}))})),s.length?s:[this]},n.transformWithMoveSheetMutation=function(e,n){var r;return e.fromIndex<this.sheetIndex&&e.toIndex>this.sheetIndex&&n?(r=this.sheetIndex-1,[new t({sheetId:this.sheetId,sheetIndex:r,sheetType:this.sheetType,sheetDelta:this.sheetDelta,rowCount:this.rowCount,colCount:this.colCount})]):e.fromIndex>this.sheetIndex&&e.toIndex<this.sheetIndex&&n?(r=this.sheetIndex+1,[new t({sheetId:this.sheetId,sheetIndex:r,sheetType:this.sheetType,sheetDelta:this.sheetDelta,rowCount:this.rowCount,colCount:this.colCount})]):[this]},n.transformWithDeleteSheetMutation=function(e,n){if(this.sheetIndex>e.sheetIndex){var r=this.sheetIndex-1;return[new t({sheetId:this.sheetId,sheetIndex:r,sheetType:this.sheetType,sheetDelta:this.sheetDelta,rowCount:this.rowCount,colCount:this.colCount})]}return[this]},n.transformWithSetSheetPropertiesMutation=function(e,n){var r=this,i=[];return e.sheetDelta&&e.sheetDelta.deltas.forEach((function(o){r.sheetDelta.deltas.forEach((function(s){if(s.slotName===f.SLOT_NAME&&o.slotName===f.SLOT_NAME&&s.value===o.value)if(n){var a=(0,h.t)(r,e);i.push(new t(Object.assign(Object.assign({},r),{sheetDelta:a})))}else{var c=u.ZP.t("{{value0}}_自动重命名{{value1}}",{value0:o.value,value1:e.sheetId});i.push(new d.Z({sheetId:e.sheetId,sheetDelta:new l({operation:I.SET_PROPERTIES,delta:{name:c}})}),r)}}))})),i.length?i:[this]},n.invert=function(){return[new a.Z({sheetId:this.sheetId,sheetIndex:this.sheetIndex})]},t}(s.Z);t.Z=g},87789:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=function(e){function t(t){var n;return(n=e.call(this,i.ZP.MOVE_SHEET_MUTATION,t)||this).fromIndex=t.fromIndex,n.toIndex=t.toIndex,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({fromIndex:e[0],toIndex:e[1]})};var n=t.prototype;return n.serialize=function(){return[this.fromIndex,this.toIndex]},n.getAffectedSheets=function(e){return[]},n.getAffectedSheetId=function(){return""},n.check=function(){return{isValid:!0}},n.transformWithInsertSheetMutation=function(e,n){var r;if(n){if(e.sheetIndex<=this.fromIndex&&this.fromIndex<this.toIndex||e.sheetIndex<=this.toIndex&&this.fromIndex>this.toIndex)return[new t({fromIndex:this.fromIndex+1,toIndex:r=this.toIndex+1})];if(e.sheetIndex<=this.toIndex&&e.sheetIndex>this.fromIndex)return r=this.toIndex+1,[new t({fromIndex:this.fromIndex,toIndex:r})];if(e.sheetIndex<this.fromIndex&&e.sheetIndex>this.toIndex)return[new t({fromIndex:this.fromIndex+1,toIndex:this.toIndex})]}return[this]},n.transformWithMoveSheetMutation=function(e,n){return this.fromIndex===e.fromIndex&&this.toIndex!=e.toIndex?n?[new t({fromIndex:e.toIndex,toIndex:this.toIndex})]:[]:this.fromIndex===e.fromIndex&&this.toIndex===e.toIndex?[]:this.fromIndex<this.toIndex?e.fromIndex<e.toIndex?this.transformWithMoveSheetMutationScenes1(e):this.transformWithMoveSheetMutationScenes2(e):this.fromIndex>this.toIndex?e.fromIndex>e.toIndex?this.transformWithMoveSheetMutationScenes3(e):this.transformWithMoveSheetMutationScenes4(e):[this]},n.transformWithMoveSheetMutationScenes1=function(e){var n;return e.toIndex<this.fromIndex||e.fromIndex>this.toIndex||this.fromIndex<e.fromIndex&&e.toIndex<this.toIndex?[this]:e.fromIndex<this.fromIndex&&this.toIndex<=e.toIndex?[new t({fromIndex:this.fromIndex-1,toIndex:n=this.toIndex-1})]:e.fromIndex<this.fromIndex&&this.fromIndex<e.toIndex&&e.toIndex<this.toIndex?[new t({fromIndex:this.fromIndex-1,toIndex:this.toIndex})]:this.fromIndex<e.fromIndex&&e.fromIndex<this.toIndex&&this.toIndex<=e.toIndex?(n=this.toIndex-1,[new t({fromIndex:this.fromIndex,toIndex:n})]):[this]},n.transformWithMoveSheetMutationScenes2=function(e){var n;return e.fromIndex<this.fromIndex||e.toIndex>this.toIndex||this.fromIndex<e.toIndex&&e.fromIndex<this.toIndex?[this]:e.toIndex<=this.fromIndex&&this.toIndex<e.fromIndex?[new t({fromIndex:this.fromIndex+1,toIndex:n=this.toIndex+1})]:e.toIndex<this.fromIndex&&this.fromIndex<e.fromIndex&&e.fromIndex<this.fromIndex||this.fromIndex===e.toIndex&&this.toIndex===e.fromIndex?[new t({fromIndex:this.fromIndex+1,toIndex:this.toIndex})]:this.fromIndex<=e.toIndex&&e.toIndex<this.toIndex&&this.fromIndex<e.toIndex?(n=this.toIndex+1,[new t({fromIndex:this.fromIndex,toIndex:n})]):[this]},n.transformWithMoveSheetMutationScenes3=function(e){var n;return e.toIndex>this.fromIndex||e.fromIndex<this.toIndex||this.toIndex<e.toIndex&&e.fromIndex<this.fromIndex?[this]:e.toIndex<=this.toIndex&&this.fromIndex<e.fromIndex?[new t({fromIndex:this.fromIndex+1,toIndex:n=this.toIndex+1})]:this.toIndex<e.toIndex&&e.toIndex<this.fromIndex&&this.fromIndex<=e.fromIndex?[new t({fromIndex:this.fromIndex+1,toIndex:this.toIndex})]:e.toIndex<=this.toIndex&&this.toIndex<e.fromIndex&&e.fromIndex<this.fromIndex?(n=this.toIndex+1,[new t({fromIndex:this.fromIndex,toIndex:n})]):[this]},n.transformWithMoveSheetMutationScenes4=function(e){var n;return e.fromIndex>this.fromIndex||e.toIndex<this.toIndex||this.toIndex<e.fromIndex&&e.toIndex<this.fromIndex?[this]:e.fromIndex<this.toIndex&&this.fromIndex<e.toIndex?[new t({fromIndex:this.fromIndex-1,toIndex:n=this.toIndex-1})]:e.fromIndex<this.toIndex&&e.toIndex<this.fromIndex?(n=this.toIndex-1,[new t({fromIndex:this.fromIndex,toIndex:n})]):this.toIndex<e.fromIndex&&e.fromIndex<this.fromIndex&&this.fromIndex<=e.toIndex||this.fromIndex===e.toIndex&&this.toIndex===e.fromIndex?[new t({fromIndex:this.fromIndex-1,toIndex:this.toIndex})]:[this]},n.transformWithDeleteSheetMutation=function(e,n){var r;if(n){if(this.fromIndex===e.sheetIndex)return[];if(e.sheetIndex<this.fromIndex&&this.fromIndex<this.toIndex||e.sheetIndex<this.toIndex&&this.fromIndex>this.toIndex)return[new t({fromIndex:this.fromIndex-1,toIndex:r=this.toIndex-1})];if(e.sheetIndex<=this.toIndex&&e.sheetIndex>this.fromIndex)return r=this.toIndex-1,[new t({fromIndex:this.fromIndex,toIndex:r})];if(e.sheetIndex<this.fromIndex&&e.sheetIndex>=this.toIndex)return[new t({fromIndex:this.fromIndex-1,toIndex:this.toIndex})]}return[this]},n.runOnSheet=function(e){e.sheetManager.moveSheet(this.fromIndex,this.toIndex),e.formulaModelManager.moveSheet(this.toIndex,this.getAffectedSheetId())},n.invert=function(){return[new t({fromIndex:this.toIndex,toIndex:this.fromIndex})]},t}(n(11222).Z);t.Z=o},20587:function(e,t,n){"use strict";var r=n(13504),i=(n(38934),n(31688),n(46396),n(90109),n(12024),n(81502),n(62883),n(26178)),o=n(1976),s=n(38808),a=n(85249),d=n(90945),h=n(19251),u=n(11376),l=n(14277),c=i.Sheet.SheetPropertiesDelta,f=i.Sheet.NEW_SHEET_PROPERTIES_SLOT_OPERATION,I=i.Sheet.OLD_SHEET_PROPERTIES_SLOT,g=i.Sheet.NEW_SHEET_PROPERTIES_SLOT,p=i.Sheet.sheetPropertiesDeltaUtils,m=i.Dimension.DIMENSION_TYPE,v=i.Range.DimensionRange,R=function(e){function t(t){var n;return(n=e.call(this,s.ZP.SET_SHEET_PROPERTIES_MUTATION,t)||this).type=t.type,n.slotOperation=null!=t.slotOperation?t.slotOperation:d.Z.SET_SLOT,n.value=t.value,n.sheetId=t.sheetId,n.sheetDelta=t.sheetDelta,n.filterViewId=t.filterViewId,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],type:e[1],slotOperation:e[2],value:e[3],sheetDelta:e[4]?c.deserialize(e[4]):void 0,filterViewId:e[5]})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.type,,,this.sheetDelta?this.sheetDelta.serialize():null,this.filterViewId]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t},n.runOnSheet=function(e){if(this.sheetDelta)this.handleRunOnSheetWithSheetDelta(e);else if(this.type)switch(this.type){case I.SLOT_FROZEN_ROWS:e.setFrozenRowCount(this.value,this.filterViewId);break;case I.SLOT_FROZEN_COLUMNS:e.setFrozenColCount(this.value,this.filterViewId);break;case I.SLOT_HIDE_GRIDLINES:e.setHideGridlines(this.value);break;case I.SLOT_NAME:e.setTitle(this.value);break;case I.SLOT_NUMBER_OF_COLUMNS:e.setColCount(this.value);break;case I.SLOT_NUMBER_OF_ROWS:e.setRowCount(this.value)}},n.handleRunOnSheetWithSheetDelta=function(e){if(this.filterViewId&&e.filterViewManager.getFilterViewByViewId(this.filterViewId)){var t=e.filterViewManager.getFilterViewByViewId(this.filterViewId);(0,l.g)(this.sheetDelta,t)}else p.mergeDeltaToSheetProperties(e.properties,this.sheetDelta)},n.invert=function(e){var n=[],r=e.sheetManager.getSheetBySheetId(this.sheetId);if(null===r)return n;if(!this.sheetDelta){switch(this.type){case I.SLOT_FROZEN_ROWS:n.push(new t({type:I.SLOT_FROZEN_ROWS,value:r.getFrozenRowCount(),sheetId:this.sheetId,filterViewId:this.filterViewId}));break;case I.SLOT_FROZEN_COLUMNS:n.push(new t({type:I.SLOT_FROZEN_COLUMNS,value:r.getFrozenColCount(),sheetId:this.sheetId,filterViewId:this.filterViewId}));break;case I.SLOT_HIDE_GRIDLINES:n.push(new t({type:I.SLOT_HIDE_GRIDLINES,value:r.getHideGridlines(),sheetId:this.sheetId}));break;case I.SLOT_NAME:n.push(new t({type:I.SLOT_NAME,value:r.getTitle(),sheetId:this.sheetId}))}return n}var i=r.filterViewManager.getFilterViewByViewId(this.filterViewId),o=this.getSetSheetPropertiesMutation(this.sheetDelta.deltas,r,i);return n.push(o),n},n.getSetSheetPropertiesMutation=function(e,n,r){var i={};return e.forEach((function(e){switch(e.slotName){case g.SLOT_NAME:i.name=n.getTitle();break;case g.SLOT_RIGHT_TO_LEFT:i.rightToLeft=n.getIsRtl();break;case g.SLOT_ROW_COUNT:i.rowCount=n.getRowCount();break;case g.SLOT_COL_COUNT:i.colCount=n.getColCount();break;case g.SLOT_FROZEN_ROW_COUNT:i.frozenRowCount=r?r.getFrozenRowCount():n.properties.gridProperties.frozenRowCount;break;case g.SLOT_FROZEN_COL_COUNT:i.frozenColCount=r?r.getFrozenColCount():n.properties.gridProperties.frozenColCount;break;case g.SLOT_HIDE_GRID_LINE:i.hideGridline=n.getHideGridlines();break;case g.SLOT_HIDE:i.hidden=n.getDisplayHidden();break;case g.SLOT_TAB_COLOR:i.tabColor=o.Z.getColorHexCode(n.getTabColor(),n.spreadsheetReference);break;case g.SLOT_COLUMN_DV_IGNORE_ROWS:i.columnDvIgnoreRows=n.getColumnDvIgnoreRows()}})),new t({sheetId:this.sheetId,filterViewId:this.filterViewId,sheetDelta:new c({operation:f.SET_PROPERTIES,delta:i})})},n.transformWithInsertDimensionMutation=function(e,n){if(this.sheetId!==e.sheetId)return[this];if(this.sheetDelta){for(var r=this.sheetDelta.clone(),i=0,o=r.deltas.length;i<o;i++)if(r.deltas[i].slotName===g.SLOT_FROZEN_COL_COUNT&&e.type===m.COLUMNS){var s=r.deltas[i].value;(u=new v(this.sheetId,s,s,m.COLUMNS)).insertDimension({sheetId:e.sheetId,type:m.COLUMNS,index:e.index,amount:e.amount}),r.deltas[i].value=u.startIndex}else if(r.deltas[i].slotName===g.SLOT_FROZEN_ROW_COUNT&&e.type===m.ROWS){var a=r.deltas[i].value,d=new v(this.sheetId,a,a,m.ROWS);d.insertDimension({sheetId:e.sheetId,type:m.ROWS,index:e.index,amount:e.amount}),r.deltas[i].value=d.startIndex}return[new t({sheetDelta:r,sheetId:this.sheetId,filterViewId:this.filterViewId})]}var h=this.value;if(this.type===I.SLOT_FROZEN_COLUMNS&&e.type===m.COLUMNS){if(!(h>=e.index))return[this];var u;(u=new v(this.sheetId,h,h,m.COLUMNS)).insertDimension({sheetId:e.sheetId,type:m.COLUMNS,index:e.index,amount:e.amount}),h=u.startIndex}else{if(this.type!==I.SLOT_FROZEN_ROWS||e.type!==m.ROWS)return[this];if(!(h>=e.index))return[this];var l=new v(this.sheetId,h,h,m.ROWS);l.insertDimension({sheetId:e.sheetId,type:m.ROWS,index:e.index,amount:e.amount}),h=l.startIndex}return[new t({type:this.type,value:h,sheetId:this.sheetId,filterViewId:this.filterViewId})]},n.transformWithDeleteDimensionMutation=function(e,n){if(this.sheetId!==e.sheetId)return[this];if(this.sheetDelta){for(var r=this.sheetDelta.clone(),i=0,o=r.deltas.length;i<o;i++)if(r.deltas[i].slotName===g.SLOT_FROZEN_COL_COUNT&&e.type===m.COLUMNS){var s=r.deltas[i].value;(u=new v(this.sheetId,s,s,m.COLUMNS)).deleteDimension({sheetId:e.sheetId,type:m.COLUMNS,index:e.index,amount:e.amount}),r.deltas[i].value=u.startIndex}else if(r.deltas[i].slotName===g.SLOT_FROZEN_ROW_COUNT&&e.type===m.ROWS){var a=r.deltas[i].value,d=new v(this.sheetId,a,a,m.ROWS);d.deleteDimension({sheetId:e.sheetId,type:m.ROWS,index:e.index,amount:e.amount}),r.deltas[i].value=d.startIndex}return[new t({sheetDelta:r,sheetId:this.sheetId,filterViewId:this.filterViewId})]}var h=this.value;if(this.type===I.SLOT_FROZEN_COLUMNS&&e.type===m.COLUMNS){var u;(u=new v(this.sheetId,h,h,m.COLUMNS)).deleteDimension({sheetId:e.sheetId,type:m.COLUMNS,index:e.index,amount:e.amount}),h=u.startIndex}else{if(this.type!==I.SLOT_FROZEN_ROWS||e.type!==m.ROWS)return[this];var l=new v(this.sheetId,h,h,m.ROWS);l.deleteDimension({sheetId:e.sheetId,type:m.ROWS,index:e.index,amount:e.amount}),h=l.startIndex}return[new t({type:this.type,value:h,sheetId:this.sheetId,filterViewId:this.filterViewId})]},n.transformWithSetSheetPropertiesMutation=function(e,n){var r=[];if(this.sheetDelta)if(this.isConflict(e))for(var i=0;i<this.sheetDelta.deltas.length;i++)for(var o=this.sheetDelta.deltas[i],s=0;s<e.sheetDelta.deltas.length;s++){var a=e.sheetDelta.deltas[s];if(o.slotOperation===a.slotOperation)if(o.slotName===g.SLOT_NAME)if(e.sheetId===this.sheetId)n&&r.push(this);else if(n){var d=(0,h.t)(this,e);r.push(new t(Object.assign(Object.assign({},this),{sheetDelta:d})))}else{var u=(0,h.t)(e,this);r.push(this,new t(Object.assign(Object.assign({},e),{sheetDelta:u})))}else e.sheetId===this.sheetId&&n&&r.push(this)}else r.push(this);else(e.type!==this.type||n)&&r.push(this);return r},n.isConflict=function(e){if(e.sheetDelta&&this.sheetDelta){var t=e.sheetDelta.deltas.map((function(e){return e.slotOperation})),n=this.sheetDelta.deltas.map((function(e){return e.slotOperation}));return t.every((function(e){return n.includes(e)}))}return!1},n.transformWithInsertSheetMutation=function(e,n){var r=[];if(this.sheetDelta)for(var i=0;i<this.sheetDelta.deltas.length;i++)for(var o=this.sheetDelta.deltas[i],s=0;s<e.sheetDelta.deltas.length;s++){var a=e.sheetDelta.deltas[s];if(o.slotName===g.SLOT_NAME&&o.value===a.value)if(n){var d=(0,h.t)(this,e);r.push(new t(Object.assign(Object.assign({},this),{sheetDelta:d})))}else{var l=u.ZP.t("{{value0}}_自动重命名{{value1}}",{value0:a.value,value1:e.sheetId});r.push(new t({sheetId:e.sheetId,sheetDelta:new c({operation:f.SET_PROPERTIES,delta:{name:l}})}),this)}}return r.length?r:[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformWithDeleteFilterViewMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:this.filterViewId&&t&&this.filterViewId===e.filterViewId?[]:[this]},t}(a.Z);R.protoMap={0:{name:"sheetId",dataType:String},1:{name:"type",dataType:Number},2:{name:"value",dataType:String},3:{name:"sheetDelta",dataType:c}},t.Z=R},73307:function(e,t,n){"use strict";var r=n(13504),i=n(38808),o=function(e){function t(t){var n;return(n=e.call(this,i.ZP.UPDATE_ALL_SHEETS_MUTATION,t)||this).sheetId=t.sheetId,n.data=t.data,n}(0,r.Z)(t,e);var n=t.prototype;return n.serialize=function(){return[]},n.getAffectedSheets=function(e){return[]},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e},n.check=function(e){return{isValid:!0}},n.runOnSheet=function(e){},n.invert=function(){return[]},t}(n(85249).Z);t.Z=o},54792:function(e,t,n){"use strict";var r=n(13504),i=(n(62883),n(26178)),o=n(38808),s=n(85249),a=n(27571),d=n(78093),h=n(78449),u=n(22459),l=i.Range.GridRange,c=function(e){function t(t){var n;return(n=e.call(this,o.ZP.UPDATE_SHEET_RANGE_MUTATION,t)||this).sheetId=t.sheetId,n.sheetRangeId=t.sheetRangeId,n.gridRange=t.gridRange,n.sheetRangeType=t.sheetRangeType,n.nonPersistingLocalChange=t.nonPersistingLocalChange||!1,n.padId=t.padId,n.sheetRangeDelta=t.sheetRangeDelta,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({sheetId:e[0],sheetRangeId:e[1],gridRange:l.deserialize(e[2]),sheetRangeType:e[3],padId:e[4],sheetRangeDelta:h.Z.deserialize(e[5])})};var n=t.prototype;return n.serialize=function(){return[this.sheetId,this.sheetRangeId,this.gridRange.serialize(),this.sheetRangeType,this.padId,this.sheetRangeDelta.serialize()]},n.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},n.getAffectedSheetId=function(){return this.sheetId},n.setAffectedSheetId=function(e){this.sheetId=e,this.gridRange.sheetId=e},n.getAffectedGridRanges=function(){return[this.gridRange]},n.getAffectedSheets=function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId);return n&&t.push(n),t},n.check=function(e){return{isValid:!0}},n.runOnSheet=function(e){var t,n,r=this.gridRange.clone();this.sheetRangeType===a.SHEET_RANGE_TYPE.COMMENT_RANGE&&(n=new d.Z({sheetId:this.sheetId,gridRange:r,sheetRangeType:this.sheetRangeType,padId:this.padId,properties:new u.Z({isArchived:null===(t=this.sheetRangeDelta.getCommentSheetRangeProperties())||void 0===t?void 0:t.isArchived})})),e.sheetRangeManager.updateSheetRange(this.sheetRangeId,n)},n.invert=function(e){var n=e.sheetManager.getSheetBySheetId(this.sheetId),r=[];if(null===n)return r;var i=n.sheetRangeManager.getSheetRange(this.sheetRangeId);if(!i)return r;if(this.sheetRangeType===a.SHEET_RANGE_TYPE.COMMENT_RANGE){var o=new h.Z({commentSheetRangeProperties:new u.Z({isArchived:i.properties.isArchived})});r.push(new t({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,gridRange:i.gridRange,sheetRangeType:this.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:this.padId,sheetRangeDelta:o}))}return r},n.transformWithInsertDimensionMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithDeleteDimensionMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithMergeCellsMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithUpdateFilterMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithAddEmbeddedObjectMutation=function(e){return this.sheetId,e.data.sheetId,[this]},n.transformWithDeleteEmbeddedObjectMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithUpdateEmbeddedObjectMutation=function(e){return this.sheetId,e.data.sheetId,[this]},n.transformWithDeleteSheetMutation=function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]},n.transformDefineSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformDeleteSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformUpdateSheetRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithReorderRangeMutation=function(e){return this.sheetId,e.sheetId,[this]},n.transformWithMapRangeMutation=function(e){return this.sheetId,e.sourceSheetId,[this]},t}(s.Z);c.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String},2:{name:"gridRange",dataType:l},3:{name:"sheetRangeType",dataType:Number},5:{name:"padId",dataType:String}},t.Z=c},22535:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(58926),i=(n(38934),n(31688),n(8195),n(31160));function o(e,t,n){var s,a,d,h,u,l,c,f,I,g=e;try{for(s=0,h=t.length;s<h;s++)if(l=[t[s]],c=[],0!==l.length){for(a=0,d=e.length;a<d;a++)u=e[a],l.length>1?(f=o([u],l,n),a<d-1&&(I=o(l,[u],!n))):1===l.length?(f=u.transform(l[0],n),u.version===i.Z.MUTATION_VER_LOWEST_SUPPORT&&l[0].version===i.Z.MUTATION_VER_LOWEST_SUPPORT&&f.forEach((function(e){e.version=i.Z.MUTATION_VER_LOWEST_SUPPORT})),a<d-1&&(I=l[0].transform(u,!n),u.version===i.Z.MUTATION_VER_LOWEST_SUPPORT&&l[0].version===i.Z.MUTATION_VER_LOWEST_SUPPORT&&I.forEach((function(e){e.version=i.Z.MUTATION_VER_LOWEST_SUPPORT})))):(f=[u],I=[]),a<d-1&&(l=I),c=[].concat((0,r.Z)(c),(0,r.Z)(f));e=c}}catch(p){return console.error("transform two mutation array error: ",p),g}return g=e}},20808:function(e,t,n){"use strict";function r(e,t){if(e===t)return!0;if("string"===typeof e||"number"===typeof e||"boolean"===typeof e)return e===(t=null==t?null:t);if((Array.isArray(e)||null==e)&&(Array.isArray(t)||null==t)){if(null==e||0===e.length)return null==t||0===t.length;if(null==t||e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(!r(e[n],t[n]))return!1;return!0}return null!=e&&"function"===typeof e.equals?e.equals(t):void 0}function i(e){return null==e?null:e}function o(e,t){return i(e)===i(t)}function s(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if(!Array.isArray(e[t]))return!1;return!0}return!1}function a(e){return"[object Array]"===Object.prototype.toString.call(e)}n.d(t,{Ep:function(){return s},ZG:function(){return o},fS:function(){return r},kJ:function(){return a}}),n(38934)},19251:function(e,t,n){"use strict";n.d(t,{t:function(){return a}}),n(38934),n(31688);var r=n(26178),i=n(11376),o=r.Sheet.SheetPropertiesDelta,s=r.Sheet.NEW_SHEET_PROPERTIES_SLOT;function a(e,t){var n,r,a=(null===(n=e.sheetDelta)||void 0===n?void 0:n.clone())||new o,d=(null===(r=t.sheetDelta)||void 0===r?void 0:r.clone())||new o;return a.deltas.forEach((function(t){d.deltas.forEach((function(n){if(t.slotName===s.SLOT_NAME&&n.slotName===s.SLOT_NAME&&t.value===n.value){var r=i.ZP.t("{{value0}}_自动重命名{{value1}}",{value0:t.value,value1:e.sheetId});t.value=r}}))})),a}},38561:function(e,t,n){"use strict";var r=n(13504),i=n(59099),o=n(38808),s=function(e){function t(t){var n;return(n=e.call(this,o.ZP.SET_WORKBOOK_PROPERTIES_MUTATION,t)||this).theme=t.theme,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({theme:e[0]})};var n=t.prototype;return n.serialize=function(){return[this.theme]},n.getAffectedSheets=function(){return[]},n.getAffectedSheetId=function(){return"WORKBOOK"},n.check=function(){return{isValid:!0}},n.runOnSheet=function(){},n.runOnWorkbook=function(e){var t,n=i.vCY.deserialize(((t={})[i.LK6.theme]=this.theme,t));return e.setTheme(n),!0},n.invert=function(){return[new t({theme:null})]},t}(n(85249).Z);t.Z=s},98217:function(e,t,n){"use strict";var r=n(13504),i=(n(46396),n(62883),n(26178)),o=n(38808),s=n(85249),a=n(25693),d=n(29712),h=i.WorkbookRange.WorkbookRangeDelta,u=i.WorkbookRange.WORKBOOK_RANGE_TYPE,l=i.WorkbookRange.ChartWorkbookRange,c=i.WorkbookRange.ProtectedRange,f=i.WorkbookRange.LinkedRange,I=i.WorkbookRange.NotifyRange,g=i.Range.GridRange,p=function(e){function t(t){var n;return(n=e.call(this,o.ZP.DEFINE_WORKBOOK_RANGE_MUTATION,t)||this).workbookRangeId=t.workbookRangeId,n.gridRange=t.gridRange,n.workbookRangeType=t.workbookRangeType,n.workbookRangePropertiesDelta=t.workbookRangePropertiesDelta,n.nonPersistingLocalChange=!!t.nonPersistingLocalChange,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({workbookRangeId:e[0],gridRange:g.deserialize(e[1]),workbookRangeType:e[2],workbookRangePropertiesDelta:h.deserialize(e[3]),nonPersistingLocalChange:e[4]})};var n=t.prototype;return n.serialize=function(){return[this.workbookRangeId,this.gridRange.serialize(),this.workbookRangeType,this.workbookRangePropertiesDelta.serialize()]},n.clone=function(){return t.deserialize(this.serialize())},n.getAffectedSheetId=function(){return"WORKBOOK"},n.getAffectedSheets=function(){return[]},n.getAffectedGridRanges=function(){return[this.gridRange]},n.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},n.check=function(){return{isValid:!0}},n.runOnSheet=function(){},n.runOnWorkbook=function(e){var t=null;if(!e.sheetManager.getSheetBySheetId(this.gridRange.sheetId))return!0;var n={id:this.workbookRangeId,range:this.gridRange,type:this.workbookRangeType};switch(this.workbookRangeType){case u.PROTECTED_RANGE:this.workbookRangePropertiesDelta.getProtectionProperties()&&(t=new c(Object.assign(Object.assign({},n),{properties:this.workbookRangePropertiesDelta.getProtectionProperties()})));break;case u.CHART:this.workbookRangePropertiesDelta.getEmbeddedObjectId()&&(t=new l(Object.assign(Object.assign({},n),{embeddedObjectId:this.workbookRangePropertiesDelta.getEmbeddedObjectId()})));break;case u.LINKED_RANGE:t=new f(Object.assign(Object.assign({},n),{properties:this.workbookRangePropertiesDelta.getLinkedRangeProperties()}));break;case u.PRIVATE_RANGE:t=new d.Z(n);break;case u.NOTIFY_RANGE:t=new I(Object.assign({},n))}return t&&e.workbookRangeManager.addWorkbookRange(t),!0},n.invert=function(){return[new a.Z({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType})]},n.transformWithInsertDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n=this.gridRange.clone();return n.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:n,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]},n.transformWithDeleteDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n=this.gridRange.clone();return n.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:n,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]},n.transformWithNewAddEmbeddedObjectMutation=function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]},n.transformWithNewDeleteEmbeddedObjectMutation=function(e){return this.workbookRangePropertiesDelta.getEmbeddedObjectId()===e.objectId?[]:[this]},n.transformWithNewUpdateEmbeddedObjectMutation=function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]},t}(s.Z);p.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"gridRange",dataType:g},2:{name:"workbookRangeType",dataType:Number},3:{name:"workbookRangePropertiesDelta",dataType:h},4:{name:"nonPersistingLocalChange",dataType:Boolean}},t.Z=p},25693:function(e,t,n){"use strict";var r=n(13504),i=(n(62883),n(38808)),o=n(85249),s=n(98217),a=n(25421),d=function(e){function t(t){var n;return(n=e.call(this,i.ZP.DELETE_WORKBOOK_RANGE_MUTATION)||this).workbookRangeId=t.workbookRangeId,n.workbookRangeType=t.workbookRangeType,n.nonPersistingLocalChange=!!t.nonPersistingLocalChange,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({workbookRangeId:e[0],workbookRangeType:e[1],nonPersistingLocalChange:e[2]})};var n=t.prototype;return n.serialize=function(){return[this.workbookRangeId,this.workbookRangeType]},n.getAffectedSheetId=function(){return"WORKBOOK"},n.getAffectedSheets=function(){return[]},n.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},n.check=function(){return{isValid:!0}},n.runOnSheet=function(){},n.runOnWorkbook=function(e){return e.workbookRangeManager.deleteWorkbookRange(this.workbookRangeId),!0},n.invert=function(e){var t=(0,a.D)(e,this.workbookRangeType,this.workbookRangeId);return t?[new s.Z(t)]:[]},n.transformWithDeleteWorkbookRangeMutation=function(e,t){return this.workbookRangeId===e.workbookRangeId&&t?[]:[this]},t}(o.Z);d.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"workbookRangeType",dataType:Number},2:{name:"nonPersistingLocalChange",dataType:Boolean}},t.Z=d},35631:function(e,t,n){"use strict";var r=n(13504),i=(n(46396),n(62883),n(38808)),o=n(85249),s=n(89654),a=n(29712),d=n(25421),h=n(89577),u=function(e){function t(t){var n;return(n=e.call(this,i.ZP.UPDATE_WORKBOOK_RANGE_MUTATION,t)||this).workbookRangeId=t.workbookRangeId,n.gridRange=t.gridRange,n.workbookRangeType=t.workbookRangeType,n.workbookRangePropertiesDelta=t.workbookRangePropertiesDelta,n.nonPersistingLocalChange=!!t.nonPersistingLocalChange,n}(0,r.Z)(t,e),t.deserialize=function(e){return new t({workbookRangeId:e[0],gridRange:h.Z.deserialize(e[1]),workbookRangeType:e[2],workbookRangePropertiesDelta:s.WorkbookRangeDelta.deserialize(e[3]),nonPersistingLocalChange:e[4]})};var n=t.prototype;return n.serialize=function(){return[this.workbookRangeId,this.gridRange.serialize(),this.workbookRangeType,this.workbookRangePropertiesDelta.serialize()]},n.getAffectedSheetId=function(){return"WORKBOOK"},n.getAffectedSheets=function(){return[]},n.getAffectedGridRanges=function(){return[this.gridRange]},n.isNonPersistedLocalChange=function(){return this.nonPersistingLocalChange},n.check=function(){return{isValid:!0}},n.runOnSheet=function(e){},n.runOnWorkbook=function(e){var t=null,n={id:this.workbookRangeId,range:this.gridRange.clone(),type:this.workbookRangeType};switch(this.workbookRangeType){case s.WORKBOOK_RANGE_TYPE.PROTECTED_RANGE:this.workbookRangePropertiesDelta.getProtectionProperties()&&(t=new s.ProtectedRange(Object.assign(Object.assign({},n),{properties:this.workbookRangePropertiesDelta.getProtectionProperties()})));break;case s.WORKBOOK_RANGE_TYPE.CHART:this.workbookRangePropertiesDelta.getEmbeddedObjectId()&&(t=new s.ChartWorkbookRange(Object.assign(Object.assign({},n),{embeddedObjectId:this.workbookRangePropertiesDelta.getEmbeddedObjectId()})));break;case s.WORKBOOK_RANGE_TYPE.LINKED_RANGE:this.workbookRangePropertiesDelta.getLinkedRangeProperties()&&(t=new s.LinkedRange(Object.assign(Object.assign({},n),{properties:this.workbookRangePropertiesDelta.getLinkedRangeProperties()})));break;case s.WORKBOOK_RANGE_TYPE.PRIVATE_RANGE:t=new a.Z(n)}return t&&e.workbookRangeManager.updateWorkbookRange(this.workbookRangeId,t),!0},n.invert=function(e){var n=(0,d.D)(e,this.workbookRangeType,this.workbookRangeId);return n?[new t(n)]:[]},n.transformWithInsertDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n=this.gridRange.clone();return n.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:n,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]},n.transformWithDeleteDimensionMutation=function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var n=this.gridRange.clone();return n.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new t({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:n,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]},n.transformWithNewAddEmbeddedObjectMutation=function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]},n.transformWithNewDeleteEmbeddedObjectMutation=function(e){return this.workbookRangePropertiesDelta.getEmbeddedObjectId()===e.objectId?[]:[this]},n.transformWithNewUpdateEmbeddedObjectMutation=function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]},t}(o.Z);u.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"gridRange",dataType:h.Z},2:{name:"workbookRangeType",dataType:Number},3:{name:"workbookRangePropertiesDelta",dataType:s.WorkbookRangeDelta},4:{name:"nonPersistingLocalChange",dataType:Boolean}},t.Z=u},25421:function(e,t,n){"use strict";n.d(t,{D:function(){return s}});var r,i=n(89654),o=((r={})[i.WORKBOOK_RANGE_TYPE.PROTECTED_RANGE]=function(e,t){var n=e.getProtectedRangeById(t);if(!n)return null;var r=new i.WorkbookRangeDelta;return r.setProtectionProperties(n.properties),{workbookRangeId:t,gridRange:n.range.clone(),workbookRangeType:n.type,workbookRangePropertiesDelta:r}},r[i.WORKBOOK_RANGE_TYPE.CHART]=function(e,t){var n=e.getChartWorkbookRangeById(t);if(!n)return null;var r=new i.WorkbookRangeDelta;return r.setEmbeddedObjectId(n.embeddedObjectId),{workbookRangeId:t,gridRange:n.range.clone(),workbookRangeType:n.type,workbookRangePropertiesDelta:r}},r[i.WORKBOOK_RANGE_TYPE.LINKED_RANGE]=function(e,t){var n=e.getLinkedWorkbookRangeById(t);if(!n)return null;var r=new i.WorkbookRangeDelta,o=n.properties;return o&&r.setLinkedRangeProperties(o),{workbookRangeId:t,gridRange:n.range.clone(),workbookRangeType:n.type,workbookRangePropertiesDelta:r}},r[i.WORKBOOK_RANGE_TYPE.PRIVATE_RANGE]=function(e,t){var n=e.getPrivateWorkbookRangeById(t);if(!n)return null;var r=new i.WorkbookRangeDelta;return{workbookRangeId:t,gridRange:n.range.clone(),workbookRangeType:n.type,workbookRangePropertiesDelta:r}},r);function s(e,t,n){var r=e.workbookRangeManager,i=o[t];return(null===i||void 0===i?void 0:i(r,n))||null}},31973:function(e,t,n){"use strict";n.d(t,{e5:function(){return r},O8:function(){return i.O},ZP:function(){return s},iV:function(){return o.i}});var r,i=n(20256),o=n(50293);!function(e){e[e.kDocReportUnknown=0]="kDocReportUnknown",e[e.kDocNewDoc=1]="kDocNewDoc",e[e.kDocOpenDoc=2]="kDocOpenDoc",e[e.kDocOpenHomePage=3]="kDocOpenHomePage",e[e.kDocOpenTemplatePage=4]="kDocOpenTemplatePage",e[e.kDocExport=5]="kDocExport",e[e.kDocForwardWw=6]="kDocForwardWw",e[e.kDocForwardWx=7]="kDocForwardWx"}(r||(r={}));var s=i.Z},20256:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(85952),i=(n(38934),n(31688),n(52865),n(64425),n(93984),n(31973)),o=function(){function e(t){this.cache=[],this.functionName=t,e.stack.push(this)}e.eachLoad=function(t,n){void 0===n&&(n=!1),e.stack.forEach((function(e){e.initLoad(t,n)}))};var t=e.prototype;return t.getProxyFunction=function(e){var t=this;return void 0===e&&(e=!1),function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];if(i.iV)return t.module?t.execute.apply(t,r):void(e||t.cache.push((function(){return t.execute.apply(t,r)})))}},t.execute=function(){var e=this.functionName.split("."),t=this.getExecuteFunction(this.module,e),n=t.func;if(!n)return!1;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return n.apply(t.self,i),!0},t.getExecuteFunction=function(e,t){var n=t.shift();return n?0===t.length?{self:e,func:null===e||void 0===e?void 0:e[n]}:this.getExecuteFunction(e[n],t):e},t.initLoad=function(e,t){void 0===t&&(t=!1),this.module=e,this.cache.forEach((function(e,t,n){(null===e||void 0===e?void 0:e())&&(n[t]=null)})),this.cache=this.cache.filter((function(e){return null!==e})),t&&(this.module=null)},(0,r.Z)(e,null,[{key:"isStackEmpty",get:function(){return!this.stack.some((function(e){return e.cache.length}))}}]),e}();o.stack=[];var s={run:new o("run").getProxyFunction(),speed:{runReport:new o("speed.runReport").getProxyFunction(),hasDonePagePerformanceReport:new o("speed.hasDonePagePerformanceReport").getProxyFunction()},jank:{log:new o("jank.log").getProxyFunction(!0),startMonitor:new o("jank.startMonitor").getProxyFunction(),closeMonitor:new o("jank.closeMonitor").getProxyFunction(),stopReport:new o("jank.stopReport").getProxyFunction(!0),restartReport:new o("jank.restartReport").getProxyFunction(!0),releaseLock:new o("jank.releaseLock").getProxyFunction(!0)},tdwReport:new o("tdwReport").getProxyFunction(),tdwSingleReport:new o("tdwSingleReport").getProxyFunction(),flowlog:new o("flowlog").getProxyFunction(),huatuo:new o("huatuo").getProxyFunction(),retcode:new o("retcode").getProxyFunction(),tam:{reportT:new o("tam.reportT").getProxyFunction(),reportEvent:new o("tam.reportEvent").getProxyFunction()},zzsStatus:new o("zzsStatus").getProxyFunction(),zzsValue:new o("zzsValue").getProxyFunction(),tipReport:new o("tipReport").getProxyFunction(),resetDefaultTdwData:new o("resetDefaultTdwData").getProxyFunction(),getSource1:new o("getSource1").getProxyFunction(),kvrOss:new o("kvrOss").getProxyFunction(),idkey:new o("idkey").getProxyFunction(),opentelemetry:new o("opentelemetry").getProxyFunction()};t.Z=s},50293:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var r=n(43367),i=n(30628),o=!(0,r.ej)("env_id")&&!(0,i.IZ)("devMode")||(0,i.IZ)("force_prod_env")},88800:function(e,t,n){"use strict";n.d(t,{vT:function(){return h},gp:function(){return u}});var r,i=n(58926),o=(n(8195),n(38934),n(31688),n(57447),n(15770),n(7151)),s=n(66877),a=function(){function e(e){var t,n;this.runMutation=e.runMutation,this.invertMutation=e.invertMutation,this.redoMutations=e.redoMutations||[],this.undoMutations=e.undoMutations||[],this.isLocal=!!e.isLocal,this.requestKey=null!==(t=e.requestKey)&&void 0!==t?t:"",this.requestMode=null!==(n=e.requestMode)&&void 0!==n?n:s.Z.Default,this.sheetId=e.sheetId,this.docType=e.docType,this.fromMultiSheetRequest=e.fromMultiSheetRequest}var t=e.prototype;return t.add=function(e){var t=this;this.redoMutations=this.redoMutations.concat(e);try{this.isLocal&&e.forEach((function(e){var n=e.requestId,r=t.invertMutation(e);r.forEach((function(e){e.requestId=n})),t.undoMutations=r.concat(t.undoMutations)}))}catch(n){console.error(n)}},t.run=function(e){var t=this;void 0===e&&(e=!1),e&&(this.redoMutations=[]),this.undoMutations.forEach((function(r){e&&(t.redoMutations=[].concat((0,i.Z)(t.invertMutation(r)),(0,i.Z)(t.redoMutations))),function(e){var t,r;try{if(0!==e.id&&1!==e.id)return;var i=SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(e.sheetId);null===(t=n.g.log)||void 0===t||t.info("undoRedo","行列变换",e,"version: "+SpreadsheetApp.messageCenter.versionManager.getCurrentVersion()+", isLoaded: "+(null===i||void 0===i?void 0:i.isLoaded)+", rowCount: "+(null===i||void 0===i?void 0:i.getRowCount())+", colCount: "+(null===i||void 0===i?void 0:i.getColCount()))}catch(o){null===(r=n.g.log)||void 0===r||r.error("undoRedo","logUndoRedoDimension error")}}(r),t.runMutation(r)}))},t.reverse=function(){return new e({sheetId:this.sheetId,docType:this.docType,redoMutations:this.undoMutations,undoMutations:this.redoMutations,isLocal:this.isLocal,runMutation:this.runMutation,invertMutation:this.invertMutation})},t.complete=function(){var e=this.undoMutations.findIndex((function(e){return e.id===o.xF.UPDATE_PIVOT_TABLE_MUTATION}));this.undoMutations.length>1&&0===e&&(this.undoMutations=[].concat((0,i.Z)(this.undoMutations.slice(1)),[this.undoMutations[0]]))},e}(),d=(n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(46396),n(41031),n(76138));!function(e){e[e.UNDO=1]="UNDO",e[e.REDO=2]="REDO"}(r||(r={}));var h=(0,d.yh)("IUndoRedoStack"),u=function(){function e(){this.undoStack=[],this.redoStack=[],this.docTypeMutationFuncMap=new Map,this.onUndoRedoStackChangeFunMap=[],this.localUndoSize=0}var t=e.prototype;return t.canUndo=function(){return!!this.undoStack.length},t.canRedo=function(){return!!this.redoStack.length},t.registerDocType=function(e,t){var r,i=t.runMutation,o=t.invertMutation,s=t.follow,a=t.onUndoRedoStackChange;i&&o&&s||null===(r=n.g.log)||void 0===r||r.error("品类在 UndoRedoStack 注册相关依赖参数缺失"),this.getDocTypeDependency(e)||(this.docTypeMutationFuncMap.set(e,t),a&&this.onUndoRedoStackChangeFunMap.push(a))},t.createUndoRedoMutations=function(e){var t,r=e.docType,i=this.getDocTypeDependency(r);if(!i)return null===(t=n.g.log)||void 0===t||t.error("mutation 对应的品类未在 UndoRedoStack 正确注册相关依赖，请确认在此之前使用 registerDocType 注册品类"),{};var o=i.runMutation,s=i.invertMutation;return new a(Object.assign(Object.assign({},e),{runMutation:o,invertMutation:s}))},t.pushLocal=function(e){this.clearRedoStack(),this.pushUndoStack(e),this.onUndoRedoStackChangeFunMap.forEach((function(e){return e()}))},t.undo=function(e){var t,i,o=this.getLocalMutations(this.undoStack);if(!o)return null===(t=n.g.log)||void 0===t?void 0:t.info("undo stack is empty");this.localUndoSize-=1;var a=o.mutations,d=o.index,h=!1;if(d>=1&&(a=this.transform(a,{stack:this.undoStack,pointer:d-1}),d===this.undoStack.length&&(h=!0)),a.undoMutations.forEach((function(e){e.operationType=r.UNDO})),a.run(d>=1),a.requestMode!==s.Z.Temporary){var u=a.reverse();this.redoStack.unshift(u)}h&&this.clearUndoStack();var l=this.getDocTypeDependency(a.docType),c=e||{needCommit:!0};return a.requestMode!==s.Z.LocalPersist&&a.requestMode!==s.Z.Temporary||(c.needCommit=!1),null===(i=null===l||void 0===l?void 0:l.afterUndo)||void 0===i||i.call(l,a,c),this.onUndoRedoStackChangeFunMap.forEach((function(e){return e()})),a},t.undoTemporary=function(e){var t,n=this.getLocalMutationsWithRequestKey(this.undoStack,e);if(!n)return null;this.localUndoSize-=1;var r=n.mutations,i=n.index;i>=1&&(r=this.transform(r,{stack:this.undoStack,pointer:i-1})),r.run(!1);var o=this.getDocTypeDependency(r.docType);return null===(t=null===o||void 0===o?void 0:o.afterUndo)||void 0===t||t.call(o,r,{needCommit:!1}),this.onUndoRedoStackChangeFunMap.forEach((function(e){return e()})),r},t.undoAllAfterRequestKey=function(e,t){var n=this.getLocalMutationsWithRequestKey(this.undoStack,e,!1);if(!n)return null;for(var r=[],i=n.index;;){var o=this.undo(t);if(!o)break;if(r.push(o),o.requestKey===e)break;if((i-=1)<=0)break}return r.length?r:null},t.redo=function(e){var t,i,o=this.getLocalMutations(this.redoStack);if(!o)return null===(t=n.g.log)||void 0===t?void 0:t.info("redo stack is empty");var a=o.mutations,d=o.index,h=!1;d>=1&&(a=this.transform(a,{stack:this.redoStack,pointer:d-1}),d===this.redoStack.length&&(h=!0)),a.undoMutations.forEach((function(e){e.operationType=r.REDO})),a.run(d>=1);var u=a.reverse();this.pushUndoStack(u),h&&this.clearRedoStack();var l=this.getDocTypeDependency(a.docType),c=e||{needCommit:!0};return a.requestMode!==s.Z.LocalPersist&&a.requestMode!==s.Z.Temporary||(c.needCommit=!1),null===(i=null===l||void 0===l?void 0:l.afterRedo)||void 0===i||i.call(l,a,c),this.onUndoRedoStackChangeFunMap.forEach((function(e){return e()})),a},t.pushCollab=function(e){this.undoStack.length>0&&this.undoStack.unshift(e),this.redoStack.length>0&&this.redoStack.unshift(e)},t.destroy=function(){this.clearUndoStack(),this.clearRedoStack()},t.clearRedoStack=function(){this.redoStack.length=0},t.transform=function(e,t){for(var n,r=t.stack,i=t.pointer;i>=0;)if(n=r[i],e.docType===n.docType){var o=this.getDocTypeDependency(e.docType);if(o){var s=o.follow,a=s([e.undoMutations],[n.redoMutations],!0)[0],d=s([n.redoMutations],[e.undoMutations],!1)[0];e.undoMutations=d,e.redoMutations=[],r[i].redoMutations=a,i-=1}else console.error("对应的品类未在 UndoRedoStack 正确注册冲突处理方法，请确认在此之前使用 registerDocType 注册品类")}else i-=1;return e},t.clearUndoStack=function(){this.localUndoSize=0,this.undoStack.length=0},t.pushUndoStack=function(t){if(this.undoStack.unshift(t),this.localUndoSize+=1,!(this.localUndoSize<=e.MAX_STACK_SIZE))for(var n=this.undoStack.length-1,r=0;;n--){if(this.undoStack[n].isLocal&&2===(r+=1)){this.localUndoSize-=1;break}this.undoStack.pop()}},t.getLocalMutations=function(e){var t,n;for(t=0;t<e.length;t++)if((n=e[t]).isLocal)return e.splice(t,1),{mutations:n,index:t};return null},t.getLocalMutationsWithRequestKey=function(e,t,n){var r,i;for(void 0===n&&(n=!0),r=0;r<e.length;r++)if((i=e[r]).isLocal&&i.requestKey===t)return n&&e.splice(r,1),{mutations:i,index:r};return null},t.getDocTypeDependency=function(e){return this.docTypeMutationFuncMap.get(e)},e}();u.MAX_STACK_SIZE=100},17663:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var r=n(80067);function i(){var e=(0,r.IZ)("client"),t=(0,r.ej)("open_theme_id"),n=(0,r.ej)("third_appid");return e||t||n||""}},55351:function(e,t,n){"use strict";n.d(t,{kk:function(){return r}});var r=n(19349);n(68217),n(62986),n(17663)},19349:function(e,t,n){"use strict";n.r(t),n.d(t,{getRandomId:function(){return i},getUuid:function(){return o}});var r=n(74876);function i(e,t){void 0===e&&(e=1e9),void 0===t&&(t=9999999999);var n=Math.floor(Math.random()*(t-e+1))+e;return String(n)}function o(){return(0,r.Z)()}},62986:function(e,t,n){"use strict";n.d(t,{G:function(){return i},f:function(){return o}});var r=n(80067);function i(){var e=(0,r.ej)("skey"),t=5381;if(e){for(var n=0,i=e.length;n<i;n++)t+=(t<<5)+e.charAt(n).charCodeAt(0);return 2147483647&t}}function o(){return(0,r.ej)("TOK")||""}},68217:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var r=n(80067);function i(e){var t=(0,r.IZ)("uid"),n=(0,r.IZ)("uid_key"),i=t?"uid="+t+"&uid_key="+n:"";if(!i)return e;var o=-1!==e.indexOf("?")?"&":"?";return""+e+o+i}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_chunk_part_2.cc1c168014c30a280b91.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_chunk_part_2.cc1c168014c30a280b91.js.map