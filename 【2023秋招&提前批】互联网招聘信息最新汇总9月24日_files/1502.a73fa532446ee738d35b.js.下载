self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[1502],{99419:function(e,t,n){"use strict";n.d(t,{GI:function(){return c.GI},Bk:function(){return s.default},lb:function(){return c.lb},zU:function(){return g},Cj:function(){return y},d6:function(){return w},RP:function(){return C},s5:function(){return m},f2:function(){return T},Tl:function(){return f.T},St:function(){return f.S},LC:function(){return p.LC},qM:function(){return D}}),n(38934),n(48845),n(13857),n(54371),n(95019),n(19553),n(71091),n(81144),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770),n(46396);var r=n(36395),a=n(48943);function o(e){var t=e.currentSelect,n=e.pasteData,o=e.cutDataSheetId,i=e.activeSheetId,c=e.dimensionType,s=e.cacheState,u=e.isSingle,l=function(e){var t=e.currentSelect,n=e.cutDataSheetId,o=e.activeSheetId,i=e.dimensionType,c=e.cacheStateFrom,s=e.isSingle,u=(i==a.Z.ROWS?t.yRange:t.xRange)[0],l=[],d=i==a.Z.ROWS?c.yRange:c.xRange,f=d[0],p=d[1],h=p-f+1,v=p-f+u;s||(n==o&&u<f&&(f+=h,p+=h),l=[new r.Z(n,f,p,i)]);var g={deleteDimensionRanges:l,insertDimensionRanges:[new r.Z(o,u,v,i)]},m=i==a.Z.ROWS?c.xRange:c.yRange;return{infoDimension:g,range:{xRange:i==a.Z.ROWS?m:[u,v],yRange:i==a.Z.ROWS?[u,v]:m}}}({currentSelect:t,cutDataSheetId:o,activeSheetId:i,dimensionType:c,cacheStateFrom:s.from,isSingle:u}),d=l.infoDimension,f=l.range,p=Object.assign({},n);return p.infoDimension=d,{pasteData:p,range:f}}function i(e){var t=e.currentSelect,n=e.pasteData,o=function(e){var t=e.currentSelect,n=e.activeSheetId,o=e.dimensionType,i=e.cacheStateFrom,c=(o==a.Z.ROWS?t.yRange:t.xRange)[0],s=o==a.Z.ROWS?i.yRange:i.xRange,u=s[0],l=s[1]-u+c,d={insertDimensionRanges:[new r.Z(n,c,l,o)]},f=o==a.Z.ROWS?i.xRange:i.yRange;return{infoDimension:d,range:{xRange:o==a.Z.ROWS?f:[c,l],yRange:o==a.Z.ROWS?[c,l]:f}}}({currentSelect:t,activeSheetId:e.activeSheetId,dimensionType:e.dimensionType,cacheStateFrom:e.cacheState.from}),i=o.infoDimension,c=o.range,s=Object.assign({},n);return s.infoDimension=i,{pasteData:s,range:c}}var c=n(30516),s=n(435),u=n(597),l=n(73380),d=n(82449),f=n(97774),p=n(48908);function h(){h=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(T){c=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a=t&&t.prototype instanceof d?t:d,o=Object.create(a.prototype),i=new b(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var c=R(i,n);if(c){if(c===l)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=u(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}(e,n,i),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(T){return{type:"throw",arg:T}}}e.wrap=s;var l={};function d(){}function f(){}function p(){}var v={};c(v,a,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==t&&n.call(m,a)&&(v=m);var y=p.prototype=d.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(a,o,i,c){var s=u(e[a],e,o);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(d).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,c)}))}c(s.arg)}var a;this._invoke=function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}}function R(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,R(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function I(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:D}}function D(){return{value:void 0,done:!0}}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,i,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},w(S.prototype),c(S.prototype,o,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new S(s(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(y),c(y,i,"Generator"),c(y,a,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=I,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),s=n.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;C(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}var v=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{s(r.next(e))}catch(t){o(t)}}function c(e){try{s(r.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((r=r.apply(e,t||[])).next())}))};function g(e,t){var n=t.copyType,r=t.previewActiveSheetId;return v(this,void 0,void 0,h().mark((function t(){var a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:return a=t.sent,t.abrupt("return",a.doCopy({copyType:n,previewActiveSheetId:r}));case 4:case"end":return t.stop()}}),t)})))}function m(e,t){var n=t.copyPasteCache,r=e.view.canvas,a=!(0,l.isSelectColoumn)(e)&&!(0,l.isSelectRow)(e),o=n.getCacheData(),i=n.getCacheState(),s=i.valid,u=s&&i.pasteType==c.lb.cut,d=function(e,t,n){return!e&&!t&&!(n&&1==n.isSingle&&0==n.isMerge)}(o&&i.select&&i.select.selectRow,o&&i.select&&i.select.selectCol,o);return{canPaste:s,inValid:a,isCut:u,notSingle:d,cacheState:i,isSelectPic:!!r.shapeEditCenter.shapeEdit.shapeId}}function y(e){return v(this,void 0,void 0,h().mark((function t(){var n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:return n=t.sent,t.abrupt("return",n.doRangeToImgCopy());case 4:case"end":return t.stop()}}),t)})))}function w(e,t){var n=t.cbSucc,r=t.cbFail;return v(this,void 0,void 0,h().mark((function t(){var o,s,l,d,f,p,v,g,m,y,w,S,R,x,C;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:if(o=t.sent,s=o.copyPasteCache,1===(l=e.view.canvas).normalSelectData.selectQueue.length){t.next=7;break}return t.abrupt("return");case 7:if(d=e.spreadsheet.activeSheet,f=d.getSheetId(),p=s.getCacheData(),v=s.getCacheState(),g=l.normalSelectData.selectQueue[0],m=v.select,!g.selectRow){t.next=22;break}if(!m.selectCol){t.next=17;break}return r(),t.abrupt("return");case 17:y=i({cacheState:v,currentSelect:{yRange:(0,u.TS)(l.rowcolAccessor,l.normalSelectData.selectQueue)[0],xRange:[0,0]},pasteData:p,activeSheetId:f,dimensionType:a.Z.ROWS}),w=y.pasteData,S=y.range,o.doImageTextPaste({type:c.GI.table,pasteData:w,selectAreaCellRange:S,pasteHtmlString:s.getCacheState().clipboardCopyData.html}),n(a.Z.ROWS),t.next=29;break;case 22:if(!g.selectCol){t.next=29;break}if(!m.selectRow){t.next=26;break}return r(),t.abrupt("return");case 26:R=i({cacheState:v,currentSelect:{xRange:(0,u.rz)(l.rowcolAccessor,l.normalSelectData.selectQueue)[0],yRange:[0,0]},pasteData:p,activeSheetId:f,dimensionType:a.Z.COLUMNS}),x=R.pasteData,C=R.range,o.doImageTextPaste({type:c.GI.table,pasteData:x,selectAreaCellRange:C,pasteHtmlString:s.getCacheState().clipboardCopyData.html}),n(a.Z.COLUMNS);case 29:case"end":return t.stop()}}),t)})))}var S=function(e,t,n,r,i,s,l,d,f,p){if(t.selectRow&&n&&r){var h=o({cacheState:i,currentSelect:{yRange:(0,u.TS)(s.tableView,s.normalSelectData.selectQueue)[0],xRange:[0,0]},pasteData:e,cutDataSheetId:r,activeSheetId:l,dimensionType:a.Z.ROWS,isSingle:!0}),v=h.pasteData,g=h.range;d.doImageTextPaste({type:c.GI.table,pasteData:v,selectAreaCellRange:g,pasteHtmlString:f.getCacheState().clipboardCopyData.html}),p(a.Z.ROWS)}else if(t.selectCol&&n&&r){var m=o({cacheState:i,currentSelect:{xRange:(0,u.rz)(s.tableView,s.normalSelectData.selectQueue)[0],yRange:[0,0]},pasteData:e,cutDataSheetId:r,activeSheetId:l,dimensionType:a.Z.COLUMNS,isSingle:!0}),y=m.pasteData,w=m.range;d.doImageTextPaste({type:c.GI.table,pasteData:y,selectAreaCellRange:w,pasteHtmlString:f.getCacheState().clipboardCopyData.html}),p(a.Z.COLUMNS)}},R=function(e,t,n,r,i,s,l,d,f,p,h){if(e.yRange[0]>t.from.yRange[0]&&e.yRange[0]<=t.from.yRange[1])return!1;if(e.selectCol)return!1;if(e.selectRow&&r&&i){var v=o({cacheState:t,currentSelect:{yRange:(0,u.TS)(s.tableView,s.normalSelectData.selectQueue)[0],xRange:[0,0]},pasteData:l,cutDataSheetId:i,activeSheetId:d,dimensionType:a.Z.ROWS,isSingle:!1}),g=v.pasteData,m=v.range;h.doImageTextPaste({type:c.GI.table,pasteData:g,selectAreaCellRange:m,pasteHtmlString:p.getCacheState().clipboardCopyData.html}),f(a.Z.ROWS)}return!0},x=function(e,t,n,r,i,s,l,d,f,p,h){if(e.xRange[0]>t.from.xRange[0]&&e.xRange[0]<=t.from.xRange[1])return!1;if(e.selectRow)return!1;if(e.selectCol&&r&&i){var v=o({cacheState:t,currentSelect:{xRange:(0,u.rz)(s.tableView,s.normalSelectData.selectQueue)[0],yRange:[0,0]},pasteData:l,cutDataSheetId:i,activeSheetId:d,dimensionType:a.Z.COLUMNS,isSingle:!1}),g=v.pasteData,m=v.range;h.doImageTextPaste({type:c.GI.table,pasteData:g,selectAreaCellRange:m,pasteHtmlString:p.getCacheState().clipboardCopyData.html}),f(a.Z.COLUMNS)}return!0};function C(e,t){var n=t.cbSucc,r=t.cbFail;return v(this,void 0,void 0,h().mark((function t(){var a,o,i,s,u,l,d,f,p,v,g;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.feature.getCopyPaste();case 2:if(a=t.sent,o=a.copyPasteCache,1===(i=e.view.canvas).normalSelectData.selectQueue.length){t.next=7;break}return t.abrupt("return");case 7:if(s=e.spreadsheet.activeSheet,u=s.getSheetId(),l=o.getCacheState(),d=l.valid,f=o.getCacheData(),p=d&&l.pasteType==c.lb.cut,v=l.sheetId,g=i.normalSelectData.selectQueue[0],!f||1!=f.isSingle||0!=f.isMerge){t.next=19;break}S(f,g,p,v,l,i,u,a,o,n),t.next=30;break;case 19:if(!I(f,l,g)){t.next=24;break}if(R(g,l,0,p,v,i,f,u,n,o,a)){t.next=22;break}return t.abrupt("return",r());case 22:case 27:t.next=30;break;case 24:if(!b(f,l,g)){t.next=29;break}if(x(g,l,0,p,v,i,f,u,n,o,a)){t.next=27;break}return t.abrupt("return",r());case 29:return t.abrupt("return",r());case 30:case"end":return t.stop()}}),t)})))}var b=function(e,t,n){return e&&t.select.selectCol&&n.selectCol},I=function(e,t,n){return e&&t.select.selectRow&&n.selectRow};function D(){return(0,d.n_)()}var T=new function(){var e=this;this.isPermission=!1,this.isCanPasteFromClipboard=function(){return v(e,void 0,void 0,h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPermission){e.next=2;break}return e.abrupt("return",this.isPermission);case 2:return e.next=4,this.checkPermission();case 4:return e.abrupt("return",this.isPermission);case 5:case"end":return e.stop()}}),e,this)})))},this.getIsPermission=function(){return e.isPermission||e.checkPermission(),e.isPermission},this.checkPermission=function(){return v(e,void 0,void 0,h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.navigator.clipboard.read();case 3:t=e.sent,this.isPermission=!!t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this.isPermission=!1;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}}},435:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var r=n(13504),a=(n(90609),n(46396),n(38934),n(19553),n(81144),n(31973)),o=n(50394),i=n(30516),c=n(15602),s=n(97774),u=n(48908),l=n(39033),d=n.n(l),f=n(81194),p=n(71699),h=n(31723),v=n(85624),g=n(97735),m=function(e){function t(t){var n,r=t.spreadsheetApp,a=t.config;return(n=e.call(this,{spreadsheetApp:r,config:a})||this).subscribe(),n}(0,r.Z)(t,e);var c=t.prototype;return c.setPasteAnchor=function(e){this.anchor=e},c.setShouldOverWriteColWidthOrRowHeight=function(e){this.shouldOverWriteColWidthOrRowHeight=e},c.getPasteAnchor=function(){return this.anchor},c.onCopy=function(e){var t=e.from,n=e.copyType,r=e.hotInstance,a=e.previewActiveSheetId,o=e.isSelectAll,i=(0,s.S)({hotInstance:r,previewActiveSheetId:a,from:t,copyType:n}),c=(0,s.T)({from:t,copyType:n,isSelectAll:o,hotInstance:r,previewActiveSheetId:a});return this.cacheData=i,this.cacheState=c,c.clipboardCopyData},c.onPaste=function(e){var t,r=this,c=e.activeSheetId,s=e.to,l=e.hotInstance,f=e.pasteData,p=e.cb,h=e.envs,v=this.cacheState,m=l.spreadsheet.activeSheet;if(c=c||l.spreadsheet.getActiveSheetId(),f=f||(this.cacheState.valid?this.cacheData:void 0),f=d()(f),!(0,g.LC)(f))return n.g.log.info("copypaste","pasteData is not valid"),!1;var y=d()(f),w=m.getBasicFilter(),S=(0,u.LC)(l.spreadsheet.sheetManager,l.spreadsheet.activeSheet,v,c,s,f,this.config,h,this.shouldOverWriteColWidthOrRowHeight);if(this.shouldOverWriteColWidthOrRowHeight&&this.setShouldOverWriteColWidthOrRowHeight(!1),!1===S)return!1;var R=S.option,x=S.rowDataUpdate,C=S.useXYLen,b=S.fromCache,I=S.isCut,D=S.selectAreaCellRange,T=S.isFomulaInCut,O=R.toGridRange,_=O.startRowIndex,P=O.startColIndex,L=C.useXLen,E={style:[]},k=!(1!==L||!(0,o.IK)(l)),A=!1;return k&&(A=(0,o.IK)(l,!0)),this.applyPasteBehavior({pasteData:f,activeSheetId:c,basicFilter:w,option:R,toYStart:_,toXStart:P,rowDataUpdate:x,isFomulaInCut:T,activeSheet:m}),b&&(this.cacheState.pasteType=i.lb.copy,this.cacheState.hasDonePaste=!0),null===(t=l.view.canvas)||void 0===t||t.selectApi.selectCells(l.view.canvas.normalSelectData,D,null),I&&b&&l.feature.copyPaste&&(l.feature.copyPaste.copyPasteCache.cacheState.valid=!1),p&&(setTimeout((function(){p.call({pasteData:y,stateBefore:d()(E)},{hotInstance:l,active:Object.assign({},s),fromCache:b,pasteType:I?i.lb.cut:i.lb.copy,toCheckSmartSplit:k,isNewSheet:A,envs:h})})),a.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:r.isCut?"cut_copy_paste_cut_click":"cut_copy_paste_paste_sucess"})),!0},c.cancelCopy=function(){this.spreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(this.cacheState.sheetId)&&(this.cacheState.cutRange&&(this.cacheState.cutRange=null),this.cacheState.copyRange&&(this.cacheState.copyRange=null))},c.getCacheData=function(){return this.cacheData},c.getCacheState=function(){return this.cacheState},c.setStateCopyData=function(e){this.cacheState.clipboardCopyData=e},c.setCacheData=function(e){this.cacheData=e},c.setValid=function(e){this.cacheState.valid=e},c.applyPasteBehavior=function(e){var t,n=e.pasteData,r=e.activeSheetId,o=e.basicFilter,i=e.option,c=e.toYStart,s=e.toXStart,u=e.rowDataUpdate,l=e.isFomulaInCut,d=e.activeSheet,f=window.performance.now(),g=this.cacheState,m=i.copyRange;if((0,h.i)({pasteData:n,cacheState:g,basicFilter:o,activeSheetId:r,cellImage:null===(t=i.propsKeys)||void 0===t?void 0:t.cellImage,copyRange:i.copyRange,pasteRanges:i.pasteRanges,infoDimension:i.infoDimension,workbookRangeManager:this.spreadsheetApp.spreadsheet.workbookRangeManager,isFormatPainter:this.config.isFormatPainter,isFomulaInCut:l,activeSheet:d})&&!(0,v.Nb)(this.spreadsheetApp,m?[m]:[])){this.spreadsheetApp.requestApi.insideSheetCopyPaste(Object.assign({copyPasteMutationsOptions:{copyRange:i.copyRange}},i));var y=window.performance.now(),w=Math.round(y-f);a.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:"inside_sheet_copy_paste",ver5:w})}else{this.spreadsheetApp.requestApi.applyPasteData(Object.assign({gridData:{startRow:c,startCol:s,rowData:u,rowMetadata:[],colMetadata:[]}},i));var S=window.performance.now(),R=Math.round(S-f);a.ZP.tdwReport({module:"cut_copy_paste",opername:"doc_excel_editor",action:"apply_paste_data",ver5:R})}if(m){for(var x=!1,C=this.spreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(m.sheetId),b=m.startColIndex;b<m.endColIndex;b++)for(var I=m.startRowIndex;I<m.endRowIndex;I++)if((0,p.Tk)(C,I,b)){x=!0;break}x&&a.ZP.kvrOss({itemname:"xls_dropdown_copypaste"})}var D=!1;null===u||void 0===u||u.some((function(e){var t;return null===(t=null===e||void 0===e?void 0:e.values)||void 0===t?void 0:t.some((function(e){var t;return!!(null===(t=null===e||void 0===e?void 0:e.getHyperlinkRuns())||void 0===t?void 0:t.length)&&(D=!0,!0)}))})),D&&a.ZP.kvrOss({itemname:"xls_rangelink_paste_samefile"})},c.subscribe=function(){var e=this;this.spreadsheetApp.mutationBehavior.emitter.addListener(this.spreadsheetApp.mutationBehavior.EVENT.AFTER_MUTATION_RUN,(function(t){e.cacheState=(0,f.a)(t,e.cacheState)}))},t}(c.Z)},70699:function(e,t,n){"use strict";n.d(t,{UF:function(){return P},YX:function(){return x},ws:function(){return D}}),n(38934),n(77468),n(19553),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(75793),n(52865),n(20670),n(31688),n(71096),n(90109),n(64425),n(33552);var r=n(30516),a=n(84814),o=n(14831),i=n.n(o),c=n(83246),s=n(80067),u=n(89882),l=n(24352),d=n(82143),f=n(59538),p=n(68134),h=n(33572),v=n(64522),g=n(61424),m=n(74140),y=n(85130),w=(n(36156),n(20998),n(85624)),S=n(91508),R=n(81300);function x(e){var t=e.spreadsheetApp,n=e.copyType,o=e.range,i=e.select,c=t.spreadsheet.activeSheet,s=t.view,g=(new Date).getTime().toString();if(!c)return{timeStamp:g,html:"",plain:"",imageCache:new Map};var m=c.data.rowData,R=c.getBasicFilter(),x=R?R.getHiddenRowMap():new Map,I=(0,a.convertXYRangeToGridRange)(o,c.getSheetId()),T=function(e,t,n,o,i,c){var s=e.xRange,g=e.yRange,m=t.data,R=m.rowData,x=o.selectRow?t.data.rowMetadata:[],C=o.selectCol?t.data.colMetadata:[],b=(0,a.convertXYRangeToGridRange)(e,"sheetId"),I=function(e,t,n,r,a){var o=(0,u.r$)(e.rowData,t.xRange[0],t.yRange[0],t.xRange[1],t.yRange[1]),i=o.maxY,c=o.maxX,s=i,l=r[0],f=(0,d.Px)({range:t,sheet:n,rowCount:r.length,colCount:l?l.values.length:0,view:a});return Object.keys(f).forEach((function(e){var t=e.split("_").map((function(e){return parseInt(e,10)})),n=t[0],r=t[1];r>c&&(c=r),n>s&&(s=n)})),{xEnd:c,yEnd:s,selectedImages:f}}(m,e,t,R,c),T=I.xEnd,P=I.yEnd,L=I.selectedImages,E=s[0],k=g[0],A={isOwner:S.q.getConfig("isOwner"),ownerId:S.q.getConfig("ownerId"),tinyid:S.q.getConfig("tinyid")},F="";F+=function(e,t,n,a){var o='<table style="border-collapse:collapse" selectType="'+function(e){return e.selectAll?r.lr.all:e.selectRow?r.lr.row:e.selectCol?r.lr.col:r.lr.cells}(e)+'">',i=function(e,t,n){for(var r,a="",o=e;o<=t;o++){var i=n[o],c=null!==(r=null===i||void 0===i?void 0:i.pixelSize)&&void 0!==r?r:l.DEFAULT_COL_WIDTH;a+="<col "+(i&&i.hiddenByUser?' hiddenCol="hiddenCol" ':"")+" "+((null===i||void 0===i?void 0:i.columnTypeMetadata)?"columnTypeMetadata="+JSON.stringify(i.columnTypeMetadata.serialize()):"")+' width="'+c+'" style="width: '+c+'px;">'}return a}(t,n,a.colMetadata);return o+i}(o,E,T,m);for(var Z=k;Z<=P;Z++)if(!n.get(Z)){var M=_(E,T,m.colMetadata.length,Z,m.rowMetadata);F+="<tr "+O(Z,m.rowMetadata)+M+">";for(var z=E;z<=T;z++){var j=t.getCellDataAtPosition(Z,z);((0,y.xy)(t.spreadsheetReference,Z,z,t,A)||(0,w.tE)(t.spreadsheetReference.parent,Z,z))&&(j=null);var U=(0,f.G)({cellData:j,hiddenRowMap:n,copyRange:b,x:z,y:Z,rowData:R,copyType:i}),G=U.newX,N=U.newY,Y=U.newCellData,H=U.mergeReference;if(j=Y,!(0,p.Ft)(j,N,G)||H){var W={newY:N,newX:G,pasteType:i,mergeReference:H,hideRowMap:x,hideColMap:C,selectedImages:L,xStart:E,yStart:k};F+="<td "+h.Z.run(v.aC.COPY_ON_CELL_ATTR,"copyToHtml",{activeSheet:t,cellData:j,ext:W})+">",F+=h.Z.run(v.aC.COPY_ON_CELL_VALUE,"getCellValue",{activeSheet:t,cellData:j,ext:W}),F+="</td>"}}F+="</tr>"}var X=h.Z.run(v.aC.COPY_ON_TABLE_END,"getTableEndStr",{selectedImages:L});return F+=X,D(F+="</table>")}(o,c,x,i,n,s);return{timeStamp:g,html:T,plain:b(t.spreadsheet,I,m,x),imageCache:C(I,c,m,x)}}function C(e,t,n,r){var a=new Map;return e.each((function(e,o){var i,c,s;if(!r.get(e)){var u=null===(i=n[e])||void 0===i?void 0:i.values[o];if((null===(c=null===u||void 0===u?void 0:u.getMetadata())||void 0===c?void 0:c.customDataType)===m.ZP.IMAGE){var l=null===(s=null===u||void 0===u?void 0:u.getRefIds())||void 0===s?void 0:s[0],d=l&&t.imageManager.getImage(l);a.set(l,d)}}})),a}function b(e,t,n,r){for(var a=t.startColIndex,o=t.endColIndex,c=t.startRowIndex,s=t.endRowIndex,u="",l=c;l<=s;l++)if(!r.get(l)){for(var d=[],f=a;f<=o;f++){var p=n[l]?n[l].values[f]:null;((0,y.xy)(e,l,f)||(0,w.tE)(e.parent,l,f))&&(p=null);var h=I(p);d.push(h)}u+=d.join("\t"),l!==s&&(i().isWindows?u+="\r\n":u+="\n")}return u}function I(e){var t,n,r=null===e||void 0===e?void 0:e.getCellType();return(n=r===m.ZP.STAFF_CARD||r===m.ZP.GROUP_CARD||r===m.ZP.SCHEDULE?"[不支持的媒体类型]":(null===(t=null===e||void 0===e?void 0:e.getFormattedValue())||void 0===t?void 0:t.value)||"")===g.INVALID_VALUE&&(n=(n=(null===e||void 0===e?void 0:e.getEditValue())||"").replace(/\ufeff/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n}function D(e){var t="";return t+='<html xmlns:x="tencent"><meta charset="utf-8"><style type=\'text/css\'>'+function(){if(i().isMobilePhone||i().isAndroidPad)return"";var e=T("td"),t=T("table"),n=T("font"),r="";return(e||t)&&(r="\x3c!-- td { "+e+" } table { "+t+" } font{ "+n+" }--\x3e"),r}()+"</style>",t+="<body>\x3c!--StartFragment--\x3e",t+=e,t+="\x3c!--EndFragment--\x3e</body></html>"}function T(e){switch(e){case"td":return"empty-cells:show;line-height:normal;color:#000;vertical-align:middle;outline-width:0;word-wrap:break-word;word-break:normal;white-space:nowrap; text-align:left;font-size:10pt;";case"table":return"border-collapse: collapse;";case"font":return"white-space: pre-wrap";default:return""}}function O(e,t){var n=t[e],r=n?n.pixelSize:null,a=!!r;return' height="'+(r=r||l.DEFAULT_ROW_HEIGHT)+'" style="mso-height-source:'+(a?"userset":"auto")+";height:"+r+'px;"'}function _(e,t,n,r,a){var o="";if(function(e,t,n){return 0===e&&t-e+1>=n}(e,t,n)&&a&&a[r]){var i=a[r];(null===i||void 0===i?void 0:i.hiddenByUser)&&(o=' hiddenRow="hiddenRow" ')}return o}function P(e){var t,n=null===e||void 0===e?void 0:e.getHyperlink(),r=null===e||void 0===e?void 0:e.getHyperlinkRuns(),a=null===e||void 0===e?void 0:e.getHyperlinkType(),o=null===e||void 0===e?void 0:e.getLinkIconStatus(),i=!(!n||!(0,c.lS)(n));if(!n&&(!r||0===r.length))return null;r?t=r[0].linkUrl:n&&(t=""+(i?n:(0,c.Kc)(n,!0)));var u=r?'data-sheets-hyperlinkruns="'+(0,s.r)(JSON.stringify(r))+'"':"",l={hyperlinkType:a,linkIconStatus:o,fullLinkUrl:void 0},d='data-sheets-hyperlink="'+(0,s.r)(JSON.stringify(l))+'"',f=function(e,t){var n=null===e||void 0===e?void 0:e.getHyperlinkRuns(),r=null===e||void 0===e?void 0:e.getHyperlinkType();return n||r===R.HYPERLINK_TYPE.SHEET_LINK?""+location.origin+location.pathname:t}(e,t);return"<a "+d+" "+u+' href="'+f+'" data-sheet-href="'+t+'" title="" style="cursor: default;color: blue; text-decoration: underline;pointer-events: auto" >'}},2585:function(e,t,n){"use strict";n.d(t,{U:function(){return l},pd:function(){return h}});var r=n(58926),a=(n(71096),n(8195),n(49502),n(62077),n(46396),n(41031),n(90109),n(68767)),o=n(28086),i=n(30516),c=n(74413),s=n(19750),u=n(52731);function l(e,t){void 0===t&&(t=[]);for(var n=[],a=[],o=[],i=0,c=e.length,s=0;s<c;s++){var u=e[s],l=Object.keys(u);p.apply(void 0,[l,"prefix","suffix","num"].concat((0,r.Z)(t))),l.sort((function(e,t){return e-t})),l.length<1||(a[s]=l,i=Math.max(u[l[0]].length,i))}if(i<1)return[n,n.length,i,o];for(var f=0;f<c;f++){var h=a[f],v=h.length;if(h||!(v<1)){var g=e[f],m=g.prefix,y=g.suffix;m&&""!==m.trim()&&(n.push([m].concat((0,r.Z)(d(i-1,"")))),o.push(n.length-1));for(var w=d(i-g[h[0]].length,""),S=0;S<v;S++)n.push([].concat((0,r.Z)(g[h[S]]),(0,r.Z)(w)));y&&""!==y.trim()&&(n.push([y].concat((0,r.Z)(d(i-1,"")))),o.push(n.length-1)),a[f+1]&&a[f+1].length>0&&(n.push((0,r.Z)(d(i,""))),n.push((0,r.Z)(d(i,""))))}}return[n,n.length,i,o]}function d(e,t){var n=[];t&&"object"===typeof t&&(t=Object.assign({},t));for(var r=0;r<e;r++)n.push(t);return n}function f(e,t,n){for(var r=[],a=0;a<e;a++)r.push(d(t,n));return r}function p(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++){var n=e.indexOf(t+1<1||arguments.length<=t+1?void 0:arguments[t+1]);-1!==n&&e.splice(n,1)}}function h(e){var t=e[0],n=e[1],r=e[2],l=e[3],d=t.map((function(e,t){var n=-1!==l.indexOf(t);return{values:e.map((function(e){var t={wrapStrategy:n?c.Z.OVERFLOW_CELL:null},r=u.Z.createInstance(t),i=s.Z.createInstance({type:o.Z.STRING,value:e});return new a.Z({userEnteredFormat:r,effectiveValue:i})}))}}));return{isSingle:!1,isMerge:!1,merge:f(n,r,!1),formula:f(n,r,null),fromType:1,images:[],rowDataUpdate:d,fromApp:i.o_.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0}}t.ZP=function(e){return h(l(e))}},97735:function(e,t,n){"use strict";n.d(t,{AZ:function(){return w},Ci:function(){return g},FU:function(){return d},LC:function(){return u},RD:function(){return y},U4:function(){return S},_l:function(){return m},iI:function(){return h},kg:function(){return p},lY:function(){return f},tK:function(){return l}}),n(93984),n(38934),n(19553),n(81144),n(90109),n(8195),n(31688),n(30980),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(15770),n(84919),n(26894),n(52865),n(13857),n(54371),n(95019);var r=n(84814),a=n(30516),o=n(89577),i=n(73380);function c(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=function(e){if(!(null===e||void 0===e?void 0:e.rowDataUpdate)||void 0===e.rowDataUpdate[0])return!1;for(var t,n=c(e.rowDataUpdate);!(t=n()).done;){var r=t.value,a=null===r||void 0===r?void 0:r.values.filter((function(e){return!!e}));if((null===a||void 0===a?void 0:a.length)>0)return!0}return!1},l=function(e,t){if(!e.fromOuterContentType){var n=t.from;return new o.Z(t.sheetId,n.yRange[0],n.yRange[1],n.xRange[0],n.xRange[1])}},d=function(e,t){return e&&t.pasteType===a.lb.cut},f=function(e){return!e||e.fromType===a.gN.COPY_CACHE||e.fromType===a.gN.TRANSPOSE},p=function(e,t){return e.map((function(e){var n=e.length;return e.concat(new Array(t-n))}))},h=function(e){var t=e.toGridRange,n=e.useXYLen,r=e.crossFilterRow,o=e.changeRowProps,i=e.changeColProps,c=e.pasteData,s=t.clone(),u=s=v(c,s),l=u.startRowIndex,d=u.startColIndex,f=n.useXLen,p=n.useYLen,h={};return c.fromApp!==a.o_.tencent?(h.xRange=[d,Math.max(d+f-1,d)],h.yRange=[l,Math.max(l+p-1+r,l)],h):(o||(h.xRange=[d,Math.max(d+f-1,d)]),i||(h.yRange=[l,Math.max(l+p-1+r,l)]),h)},v=function(e,t){var n=e.infoDimension;return(null===n||void 0===n?void 0:n.deleteDimensionRanges)&&n.deleteDimensionRanges.forEach((function(e){var n=e.startIndex,r=e.endIndex,a=e.dimension,o=e.sheetId;t.deleteDimension({sheetId:o,type:a,amount:r-n+1,index:n})})),t},g=function(e,t,n,r){var a=!1;return t.isSingle&&n.isSingle&&(a=!t.isMerge||n.isMerge),!1===e&&1===r.useXLen&&1===r.useYLen&&(a=!0),a},m=function(e,t,n,r,a,o){var i,c,s=t.startRowIndex,u=t.startColIndex,l=n.fromXLen,d=n.fromYLen,f=a.repeatX,p=a.repeatY,h=r.toXLen,v=r.toYLen;if((null===o||void 0===o?void 0:o.tile)||1===h&&1===v)i=f*l,c=p*d;else if(null===o||void 0===o?void 0:o.isFormatPainter){var g=e.getColCount();i=h,c=v,s+d-1>=e.getRowCount()&&(i=l),u+l-1>=g&&(c=d)}else i=h,c=v;return{useXLen:i,useYLen:c}},y=function(e,t,n){var r={isSingle:t.isSingle,isMerge:t.isMerge},a=e.getCellDataAtPosition(n.startRowIndex,n.startColIndex),o=(0,i.rangeIsMergeCell)(n,a),c={isSingle:!1,isMerge:!1};return(n.isSingle()||o)&&(c={isSingle:!0,isMerge:o}),{fromGridRangeType:r,toGridRangeType:c}},w=function(e,t,n){var r=1,a=1;return n&&(r=e.fromXLen<t.toXLen?t.toXLen/e.fromXLen>>0:1,a=e.fromYLen<t.toYLen?t.toYLen/e.fromYLen>>0:1),{repeatX:r,repeatY:a}},S=function(e,t,n,a,o,i){var c=t.from,s=(0,r.convertXYRangeToDimensionRanges)(c,n),u=(0,r.convertDimensionRangesToGridRange)(s),l=(0,r.convertXYRangeToDimensionRanges)(a,n),d=(0,r.convertDimensionRangesToGridRange)(l),f=d.startColIndex,p=d.endColIndex;return{fromGridRange:u,fromGridRangeLen:{fromXLen:o.rowDataUpdate[0].values.length,fromYLen:o.rowDataUpdate.length},toGridRange:d,toGridRangeLen:{toXLen:p-f+1,toYLen:R(e,d,i)}}},R=function(e,t,n){for(var r=1,a=t.startRowIndex,o=t.endRowIndex,i=e.getBasicFilter(),c=i?i.getHiddenRowMap():new Map,s=a;s<o;s++)n?r+=1:c.get(s)||(r+=1);return r}},85508:function(e,t,n){"use strict";n.d(t,{wh:function(){return u}}),n(52865),n(20670),n(85932),n(38934),n(31688),n(71096),n(64425),n(62077),n(75793),n(90109),n(93984);var r=n(65447),a=n(87485),o=n(29835),i={"＝":{reg:/[＝]/g,target:"="},"（":{reg:/[（]/g,target:"("},"）":{reg:/[）]/g,target:")"},"，":{reg:/[，]/g,target:","},"：":{reg:/[：]/g,target:":"},"；":{reg:/[；]/g,target:";"},"！":{reg:/[！]/g,target:"!"},"／":{reg:/[／]/g,target:"/"},"　":{reg:/[　]/g,target:" "}};function c(e,t,n){return e=function(e){return~e.indexOf(" (")?e.replace(/[A-Z]+\s+\(/g,(function(e){return e.replace(/\s+/,"")})):e}(e=function(e,t){return Object.keys(i).forEach((function(n){t.indexOf(n)>=0||(e=e.replace(i[n].reg,i[n].target))})),e}(e,n)),e=function(e,t){return t.forEach((function(t){e=(e=e.split(t.toUpperCase()+"!").join(t+"!")).split(t.toUpperCase()+":").join(t+":")})),e}(e=function(e){var t=e;try{if(t.match(/ID/i)){var n=/ID\(\s*((\d{17}x)|(\d{18})|(\d{15})|([a-zA-Z]\d+))s*,\s*\)/gi,r=t.match(n);null===r||void 0===r||r.map((function(e){var n=(e.match(/(\d+x|\d+)\s*,/i)||[])[0];t=t.replace(n,n+"0")})),n=/ID\(\s*((\d{17}x)|(\d{18})|(\d{15}|([a-zA-Z]\d+)))\s*\)/gi,null===(r=t.match(n))||void 0===r||r.map((function(e){var n=(e.match(/(\d+x|\d+)\s*/i)||[])[0];t=t.replace(n,n+",0")}))}}catch(a){}return t}(e=function(e){var t=e;if(t.match(/STOCK/i)){var n=t.match(/STOCK\(\s*(\d+\.\w+)\s*(,\s*)?\)/gi);null===n||void 0===n||n.map((function(){t=t.replace(/(\d+\.\w+)\s*(,\s*)?\)/i,(function(e){return e.replace(/(,\s*)?\)/i,",0)")}))}))}return t}(e=function(e){if(!~e.indexOf(","))return e;var t=e.split(",");return t.forEach((function(e,n){(0===n||e.trim())&&(t[n]=e.replace(/(\s+$)/,""))})),t.join(",")}(e=(0,r.makeSelectionInOrder)(e)))),t),e}function s(e,t){e=function(e){return e.toUpperCase()}(e);var n=t.filter((function(e){return(0,a.isSheetTitleValidateForCrossSheet)(e)})),r=t.join(""),o=/('.*?'!)/;if(o.test(e)){var i=e.split(o)||[];i.forEach((function(e,a){o.test(e)?(t.forEach((function(t){var n=t.toUpperCase();e=(e=(e=e.replace("'"+n+":",(function(){return"'"+t+":"}))).replace(":"+n+"'!",(function(){return":"+t+"'!"}))).replace("'"+n+"'!",(function(){return"'"+t+"'!"}))})),i[a]=e):i[a]=c(e,n,r)})),e=i.join("")}else e=c(e,n,r);return e}function u(e,t){if(!(0,o.jr)(e))return e;var n=e;n=(0,o.$8)(n);var r=/(".*?")/;if(r.test(n)){var a=n.split(r)||[];a.forEach((function(e,n){var o=r.test(e);a[n]=o?e:s(e,t)})),n=a.join("")}else n=s(n,t);return n=function(e){var t=e;return e.indexOf("STOCK")>-1&&/(stock)(?=\()/gi.test(t)&&(t=t.replace(/STOCK\((\w+(\.\w+)+),([^)]+)\)/i,'STOCK("$1",$3)')),t}(n),n=function(e){if(-1===e.indexOf("ID("))return e;var t=e;try{var n=e.match(/ID\(\s*((\d{17}x)|(\d{18})|(\d{15}))\s*,/gi);null===n||void 0===n||n.forEach((function(n){var r=n.match(/(\d+x|\d+)/i)[0];t=e.replace(r,'"'+r+'"')}))}catch(r){console.error("退出身份证解析",r)}return t}(n),n}},5267:function(e,t,n){"use strict";function r(e){var t=null;if("string"===typeof e)try{t=JSON.parse(e)}catch(r){n.g.log.warn("smart-split string convert failed",r)}else"object"===typeof e&&(t=e);return t}function a(e,t){for(var n=e.startRowIndex,r=e.endRowIndex,a=e.startColIndex,o=e.endColIndex,i=[],c=n;c<=r;c++){for(var s=[],u=a;u<=o;u++){var l=t(c,u),d=(null===l||void 0===l?void 0:l.getEditValue())||"";s.push(d)}i.push(s)}return i}n.d(t,{u:function(){return a},x:function(){return r}})},24627:function(e,t,n){"use strict";n.r(t),n.d(t,{calcFrozenRowColmn:function(){return s},cancelFreezePreview:function(){return d},checkFreezeAreaOutOfView:function(){return m},doFreeze:function(){return v},firstColumnFreezePreview:function(){return p},firstRowFreezePreview:function(){return f},freezePreview:function(){return h},generateFreezeBtnText:function(){return l},generateFreezeRequestOption:function(){return u},reportFreezeApplyStatus:function(){return g}});var r=n(11376),a=n(56873),o=n(31973),i=n(76406),c=n(46086),s=function(e){var t=e.spreadsheet.activeSheet,n=t.getFrozenRowCount(),r=t.getFrozenColCount(),a=e.view.getSelectionWithGridRanges().rangeSelections,o=a[a.length-1];if(!o)return{isError:!0,row:0,column:0,isForzenRow:!1,isForzenColumn:!1};var i=-1,c=-1,s=!0,u=!0;o.isSheet?(i=0,c=0):o.isRow?(i=o.endRowIndex,r>0&&0===n?c=r-1:u=!1):o.isCol?(c=o.endColIndex,n>0&&0===r?i=n-1:s=!1):0===o.startRowIndex&&0===o.startColIndex?(i=o.endRowIndex,c=o.endColIndex):(i=Math.max(o.startRowIndex-1,0),c=Math.max(o.startColIndex-1,0));var l=function(e,t,n){var r=!1,a=e.view.canvas.clientRect.width-e.view.canvas.headSize.displayRowHeadWidth,o=e.view.canvas.clientRect.height-e.view.canvas.headSize.displayColHeadHeight;return t&&t>0&&e.view.canvas.areaData.getDisplayGlobalRightByCol(t)>a&&(r=!0),n&&n>0&&e.view.canvas.areaData.getDisplayGlobalBottomByRow(n)>o&&(r=!0),!r}(e,c,i);return{isError:!l,row:i,column:c,isForzenRow:s,isForzenColumn:u}},u=function(e){var t=s(e),n=t.row,r=t.column,a=t.isForzenRow;return{column:t.isForzenColumn?r+1:0,row:a?n+1:0}},l=function(e){var t=s(e),n=t.row,o=t.column,i=t.isForzenRow,c=t.isForzenColumn,u=(-1===n?0:n)+1,l=(0,a.colIndex2ColChar)(-1===o?0:o);return r.ZP.t("冻结至第{{value0}}{{value1}}",{value0:i?""+u+r.ZP.t("frozen row"):"",value1:c?""+l+r.ZP.t("frozen column"):""})};function d(e){e.requestApi.cancelFreezePreview()}function f(e){e.requestApi.freezePreview({row:1})}function p(e){e.requestApi.freezePreview({column:1})}function h(e){if(s(e).isError)return d(e);var t=u(e);e.requestApi.freezePreview(t)}function v(e,t){var n={};switch(t){case"firstRow":n={row:1,column:0};break;case"firstColumn":n={column:1,row:0};break;case"currentCell":n=u(e);break;case"cancelFreeze":n={row:-1,column:-1}}e.requestApi.freeze(n)}var g=function(e,t){var n=t.row,r=t.column;if(n&&n>0&&0===r)o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"row_freeze"});else if(r&&r>0&&0===n)o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"col_freeze"});else if(r&&r>0&&n&&n>0){var a=e.spreadsheet.activeSheet,i=a.getFrozenRowCount(),c=a.getFrozenColCount();0!==i&&0!==c?o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"re-row+col_freeze"}):0!==i&&0!==c||o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"row+col_freeze"})}};function m(e,t){var n=e.clientRect.width-e.headSize.displayRowHeadWidth,r=e.clientRect.height-e.headSize.displayColHeadHeight;return t.column&&t.column>0&&e.areaData.getDisplayGlobalRightByCol(t.column-1)>n?(c.dialog.info({title:i.V,content:i.e}),!1):!((null===t||void 0===t?void 0:t.row)&&(null===t||void 0===t?void 0:t.row)>0&&e.areaData.getDisplayGlobalBottomByRow(t.row-1)>r)||(c.dialog.info({title:i.V,content:i.e}),!1)}},17483:function(e,t,n){"use strict";var r,a=n(90980),o=n(24627),i=n(73380),c=n(97882),s=n(72996),u=n(7692),l=n(70631),d=n(64625),f=n(90489);!function(e){e.cell=a,e.selection=i,e.range=c,e.freeze=o,e.util=l,e.numberFormat=s,e.sheet=d,function(e){e.FormulaInsert=f.M,e.util=u}(e.formula||(e.formula={}))}(r||(r={})),t.Z=r},72996:function(e,t,n){"use strict";n.r(t),n.d(t,{isLeagalNumber:function(){return d},stringToNumber:function(){return f}});var r=n(26178).Utils.numberFormatUtils.formatParseEngine,a=r.parseNumber,o=r.parsePercentage,i=r.parseCurrency,c=r.parseExponential,s=r.parseThousandNumber,u=r.parseFractionValue,l=r.parseDateTimeValue;function d(e,t){var n=f(e,t);return!(!n||"date"===n.type)}function f(e,t){var n=(void 0===t?{}:t).fractionFirst,r=void 0!==n&&n;return a(e,{})||o(e,{})||i(e,{})||c(e,{})||s(e,{})||u(e,r?{numberFormat:"fraction"}:{})||l(e,{})}},29095:function(e,t,n){n(52865),n(64425),n(20670),function(e){"use strict";function n(e){return e.split('"').length-1}var r=function(e){var t,r,a,o,i,c,s,u=[],l=0;for((a=(e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).split("\n")).length>1&&""===a[a.length-1]&&a.pop(),t=0,r=a.length;t<r;t+=1){for(a[t]=a[t].split("\t"),o=0,i=a[t].length;o<i;o+=1)u[l]||(u[l]=[]),c&&0===o?(s=u[l].length-1,u[l][s]=u[l][s]+"\n"+a[t][0],c&&1&n(a[t][0])&&(c=!1,u[l][s]=u[l][s].substring(0,u[l][s].length-1))):o===i-1&&0===a[t][o].indexOf('"')&&1&n(a[t][o])?(u[l].push(a[t][o].substring(1)),c=!0):c?(1&n(a[t][o])&&c&&0!=a[t][o].length&&a[t][o].lastIndexOf('"')===a[t][o].length-1&&(c=!1),s=u[l].length-1,u[l][s]=u[l][s]+"\n"+a[t][0]):(u[l].push(a[t][o]),c=!1);c||(l+=1)}return u},a=function(e){var t,n,r,a,o,i="";for(t=0,n=e.length;t<n;t+=1){for(a=e[t].length,r=0;r<a;r+=1)r>0&&(i+="\t"),"string"===typeof(o=e[t][r])?o.indexOf("\n")>-1||o.indexOf("\r")>-1||o.indexOf("\t")>-1?i+='"'+o.replace(/"/g,'""')+'"':i+=o:i+=null===o||void 0===o?"":o;n-1!=t&&(i+="\n")}return i};t.parse=r,t.stringify=a}(window)}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/1502.a73fa532446ee738d35b.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=1502.a73fa532446ee738d35b.js.map