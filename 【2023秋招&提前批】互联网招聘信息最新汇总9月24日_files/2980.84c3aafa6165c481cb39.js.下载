self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[2980],{61360:function(e,t,n){function r(e,t){t&&e.rowDataUpdate.forEach((function(e){e.values.forEach((function(e){if(e&&!e.getUserEnteredFormat()&&e.getPivotTableRef()){var t=e.getPivotTableRef().format;t&&e.setUserEnteredFormat(t)}}))}))}n.d(t,{y:function(){return r}}),n(38934),n(31688),n(19553),n(81144)},92034:function(e,t,n){n.d(t,{Ir:function(){return a},iS:function(){return i},zn:function(){return o}}),n(90609);var r=n(55690);function o(e,t){var n=e.id,o=e.size,i=o.width,a=o.height,l=e.offset,A=l.x,c=l.y,u=e.url,s=e.clipInfo,d=0,f=0,h=e.anchor;return h?(d=h.col,f=h.row):(d=0,f=0),{type:r.EMBEDDED_OBJECT_TYPE.IMAGE,id:n,url:u,width:i,height:a,sheetId:t,x:d,y:f,offsetX:A,offsetY:c,zIndex:0,clipInfo:s}}function i(e,t){var n=e.id,r=e.size,o=r.width,i=r.height,a=e.url,l=e.clipInfo,A=0,c=0,u=e.anchor;return u?(A=u.col,c=u.row):(A=0,c=0),{id:n,sheetId:t,url:a,width:o,height:i,x:A,y:c,clipInfo:l}}function a(e){var t=e.id,n=e.position.overlayPosition,r=n.offsetXpixels,o=n.offsetYpixels,i=n.widthPixels,a=n.heightPixels,l=e.url,A=e.clipInfo;return{id:t,url:l,offset:{x:r,y:o},size:{width:i,height:a},clipInfo:{clipBottom:A.clipBottom,clipLeft:A.clipLeft,clipRight:A.clipRight,clipTop:A.clipTop}}}},15602:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(85952),o=(n(19553),n(30980),n(38934),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(30516)),i=function(){function e(e){this.shapeData=[],this.mappingTypeWithOutMergeAndUnMerge=!1,this.isChangeRow=!1,this.isChangeCol=!1,this.spreadsheetApp=e.spreadsheetApp,this.config=e.config,this.cacheData={isSingle:!1,isMerge:!1,formula:[[]],merge:[[]],rowDataUpdate:[{values:[]}],fromType:o.gN.COPY_CACHE,fromApp:o.o_.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0},this.cacheState={copyHTMLType:o.GI.table,sheetId:"string",pasteType:o.lb.copy,valid:!1,select:{selectAll:!1,selectRow:!1,selectCol:!1},copyRangeIsChange:!1,from:{xRange:[0,0],yRange:[0,0]},clipboardCopyData:{html:"",plain:"",timeStamp:""},cellImageCache:new Map}}return(0,r.Z)(e,[{key:"activeSheet",get:function(){return this.spreadsheetApp.spreadsheet.activeSheet}}]),e}()},81194:function(e,t,n){n.d(t,{a:function(){return a}});var r=n(38808),o=n(39033),i=n.n(o),a=function(e,t){var n,o=i()(t);switch(e.mutation.id){case r.ZP.INSERT_DIMENSION_MUTATION:return n=e.mutation,c(n,o);case r.ZP.DELETE_DIMENSION_MUTATION:return n=e.mutation,u(n,o);case r.ZP.SET_RANGE_MUTATION:return n=e.mutation,l(n,o);case r.ZP.SET_CELL_PROPERTIES_MUTATION:return n=e.mutation,A(n,o);default:return o}},l=function(e,t){var n=t.cutRange,r=t.copyRange;return f(n,e.gridRange)&&h(t,"setRangeMutation"),f(r,e.gridRange)&&p(t),t},A=function(e,t){var n=t.cutRange,r=t.copyRange;return f(n,e.gridRange)&&h(t,"setCellProperties"),f(r,e.gridRange)&&p(t),t},c=function(e,t){var n=t.cutRange,r=t.copyRange;return d(n,e)&&h(t,"insertDimension"),d(r,e)&&p(t),t},u=function(e,t){var n=t.cutRange,r=t.copyRange;return s(n,e)&&h(t,"deleteDimension"),s(r,e)&&p(t),t},s=function(e,t){return!!e&&e.clone().deleteDimension(t)},d=function(e,t){return!!e&&e.clone().insertDimension(t)},f=function(e,t){return!!e&&e.clone().isCross(t)},h=function(e,t){e.valid=!1,n.g.log.log("cut operation fail because of "+t)},p=function(e){e.copyRangeIsChange=!0}},90128:function(e,t,n){n.d(t,{Z:function(){return r}}),n(71096);var r=function(){function e(){this.iconSrc={spinner:"data:image/gif;base64,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"},this.iconsList={},this.init(this.iconSrc,this.iconsList)}return e.prototype.init=function(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var o=n[r],i=e[o];t[o]=i}},e}()},79938:function(e,t,n){var r;n.d(t,{bX:function(){return r}}),function(e){e.KEEPDEFAULT="keepDefault",e.MERGESTYLES="mergeStyles",e.ONLYVALUES="onlyValues",e.CLEARAUTOPARSE="clearAutoParse",e.TRANSPOSE="transpose",e.SMARTSPLIT="smartSplit",e.TRANS_TO_CELL_PIC="transToCellPic",e.TRANS_TO_FLOAT_PIC="transToFloatPic"}(r||(r={}))},50394:function(e,t,n){n.d(t,{BF:function(){return x},IK:function(){return R},PQ:function(){return m},aY:function(){return y},ep:function(){return w},fG:function(){return C},jq:function(){return L},lT:function(){return S},yC:function(){return E}});var r=n(58926),o=(n(52865),n(20670),n(62077),n(19553),n(38934),n(81144),n(77468),n(71096),n(8195),n(11376)),i=n(2585),a=n(75227),l=n(41415),A=n(31973),c=n(14831),u=n.n(c),s=n(5267),d=n(8326),f=n(69738),h=n.n(f),p=null;function g(e,t,r,o){e.addEventListener?e.addEventListener(t,r,o):e.attachEvent&&e.attachEvent("on"+t,(function(){r(n.g.event)}))}function v(e,t,r,o){e.removeEventListener?e.removeEventListener(t,r,o):e.detachEvent&&e.detachEvent("on"+t,(function(){r(n.g.event)}))}function m(e,t,n){void 0===t&&(t=function(){}),a();var r={isNeedBtn:!0,toolToastCloseTime:5e3,btnText:o.ZP.t("试试智能分列"),btnCallBack:function(){a(),t(),e.view.canvas.inputManager.focus(),A.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_toast"})}},i=null;function a(){E(),i&&(i.dispose(),i=null)}(0,l.showToast)("你可能希望对数据进行自动整理。    ".replace(/ /g," "),{top:"182px"},r),i||(i=e.view.canvas.normalSelectData.onModifySelectData(a))}function y(e,t){void 0===t&&(t=function(){});var r=null;function i(){E(),r&&(r.dispose(),r=null),v(document,"tap",c,!1),v(document,"click",c,!1),v(document,"input",i,!1)}function c(e){e.target.classList.contains("table-input-content")||i()}a.Z.wait(0).run((function(){n.g.scrollTo(0,0)})),E(),(0,l.showToast)(o.ZP.t("你可能希望对数据进行自动整理。"),void 0,{isNeedBtn:!0,btnText:o.ZP.t("试试智能分列"),supportMobile:!0,autoClose:!0,toolToastCloseTime:3e3,btnCallBack:function(){i(),t(),A.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_toast"})}}),r||(r=e.view.canvas.normalSelectData.onModifySelectData(i)),g(document,"tap",c,!1),g(document,"click",c,!1),a.Z.wait(0).run((function(){g(document,"input",i,!1)})),A.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"trigger_toast"})}function E(){"试试智能分列"===$("#toolToastBtn").text().trim()&&(0,l.hideToast)()}function C(e,t){void 0===t&&(t=function(){}),p=null,function(e,t){void 0===t&&(t=function(){}),$.ajax({url:"//"+d.Z.getConfig("runtime.domainName")+"/cgi-bin/online_docs/ai_autocolumn",type:"POST",xhrFields:{withCredentials:!0},data:{type:"textanalysis.autocolumn",data:JSON.stringify({text:e,docID:n.g.location.pathname.replace(/^.*\/([^\/]+)$/,"$1")}),xsrf:n.g.CoreSheet.util.getXsrf()},success:function(e){var n=(0,s.x)(e.ssodata),r=(0,s.x)(null===n||void 0===n?void 0:n.result);0===e.cgicode&&0===e.retcode&&n&&0===n.code&&Array.isArray(r)&&r.length>0&&!h()(r[0])&&t(r)}}),A.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"total_trigger"})}(e,(function(e){p=e,t(e)}))}function w(){return p}function x(e){p=e}function S(e,t){e=e||p;var r=(0,i.ZP)(e);t.feature.copyPaste&&t.feature.copyPaste.doPaste({pasteData:r,cb:function(){}}),(u().isMobilePhone||u().isAndroidPad)&&a.Z.wait(0).run((function(){n.g.scrollTo(0,0)}))}function T(e,t,n){for(var r=e[0],o=e[1],i=e[2],a=e[3],l=r;l<=o;l++)if(t[l])for(var A=t[l].values,c=i;c<=a;c++){var u=A[c];if(n){if(u)return!1}else if(u&&u.effectiveValue&&u.effectiveValue.value&&""!==u.effectiveValue.value.toString())return!1}return!0}function I(e,t,n){return void 0===t?[0,e-1]:void 0===n?[t,t>e-1?-1:e-1]:t>e-1?[t,-1]:[t,n>e-1?e-1:n]}function R(e,t){var o=e.spreadsheet.activeSheet,i=o.data.rowData,a=o.getRowCount()||0,l=o.getColCount()||0;if(!function(e,t,r){var o,i;if(!(null===(i=null===(o=n.g.CoreSheet)||void 0===o?void 0:o.configurations)||void 0===i?void 0:i.aiAutoColumnEnable))return!1;if(!e)return!1;if("number"!==typeof t||"number"!==typeof r||t<1||r<1)return!1;if(t>500)return!1;var a=e.spreadsheet.activeSheet.images;return!(a&&Object.keys(a).length>0)}(e,a,l))return!1;var A=[].concat((0,r.Z)(I(a,0,25)),(0,r.Z)(I(l,0,8))),c=[].concat((0,r.Z)(I(a,0,25)),(0,r.Z)(I(l,9,16))),u=[].concat((0,r.Z)(I(a,26,50)),(0,r.Z)(I(l,0,16))),s=[].concat((0,r.Z)(I(a,0,50)),(0,r.Z)(I(l,17))),d=[].concat((0,r.Z)(I(a,51)),(0,r.Z)(I(l,0)));return!!(T(A,i,t)&&T(c,i,t)&&T(u,i,t)&&T(s,i,t)&&T(d,i,t))}function L(e,t,n){C(e,(function(e){y(t,(function(){t.requestApi.undo().then((function(){S(e,t)}))})),A.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"active_trigger"}),n&&A.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"new_sheet_trigger"})}))}},63898:function(e,t,n){n.d(t,{G:function(){return o},H:function(){return i}}),n(52865),n(20670),n(15770),n(75793),n(90109),n(64425);var r={CSS:{Sequence:function(){var e=/\\((([\dA-F]{2}|[\dA-F]{1,5})\s)|([\dA-F]{6}|[\dA-F]{4}))/gim;return e.unescape=function(e){var t=window,n=t.String.fromCharCode,r=t.parseInt;return e.replace(this,(function(e){return n(r(e.slice(2),16))}))},e}()}},o=function(e){return function(e){return e.replace(/(\\.)/g,(function(e){return e.slice(1)})).replace(/(\\[\$\-+/\(\):!\^&'~{}<>= ])/g,(function(e){return e.slice(1)}))}(r.CSS.Sequence.unescape(e))},i=function(e){return"'"+a(e)+"'"},a=function(e){var t=0;return e=e.split('"').map((function(e){return++t%2===0?e:e.replace(/([\\\)\|\(#;,\.\[\]\$¥])/g,"\\$1")})).join("\\0022")}},5080:function(e,t,n){n.d(t,{C:function(){return i}}),n(71096),n(38934),n(31688);var r=n(64522),o=n(82143),i="tencent-sheet-float-img",a=new(function(){function e(){var e=this;this.desc={name:r.r.cellFloatImage},this.shapeIdsCommentStr="\x3c!--cutShapeIDs",this.getCellValue=function(t,n){return(0,o.Fb)(t.ext.selectedImages)?t.ext.mergeReference?e.handleFloatImgWithMerge(t,n):e.handleFloatImg(t,n):n()},this.getTableEndStr=function(t,n){if(t.selectedImages&&Object.keys(t.selectedImages).length>0){e.shapeIdsCommentStr=e.shapeIdsCommentStr.substring(0,e.shapeIdsCommentStr.length-1);var r=e.shapeIdsCommentStr+"cutShapeIDs--\x3e";return e.shapeIdsCommentStr="\x3c!--cutShapeIDs",r+n()}return n()}}var t=e.prototype;return t.handleFloatImg=function(e,t){var n=this,r=e.ext.newY+"_"+e.ext.newX,o=e.ext.selectedImages[r],a="";return(null===o||void 0===o?void 0:o.length)>0&&o.forEach((function(t){a+='<img src="'+t.url+'" type="'+i+'" width='+t.size.width+" height="+t.size.height+' style="width: '+t.size.width+"px; height: "+t.size.height+"px; margin-left: "+t.offset.x+"px; margin-top: "+t.offset.y+'px" data-clip="'+t.clipInfo.clipTop+"px "+t.clipInfo.clipRight+"px "+t.clipInfo.clipBottom+"px "+t.clipInfo.clipLeft+'px" data-anchor="'+(e.ext.newY-e.ext.yStart)+" "+(e.ext.newX-e.ext.xStart)+'"/>',n.shapeIdsCommentStr+=t.id+"|"})),a+t()},t.handleFloatImgWithMerge=function(e,t){for(var n=this,r=e.ext.mergeReference.startRowIndex,o=e.ext.mergeReference.endRowIndex,a=e.ext.mergeReference.startColIndex,l=e.ext.mergeReference.endColIndex,A="",c=r;c<=o;c++)for(var u=a;u<=l;u++){var s=c+"_"+u,d=e.ext.selectedImages[s];(null===d||void 0===d?void 0:d.length)>0&&function(){for(var t=0,o=u;o>a;o--)t+=e.activeSheet.getColWidth(o-1);for(var l=0,s=c;s>r;s--)l+=e.activeSheet.getRowHeight(s-1);var f="",h="";d.forEach((function(n){f+='<img src="'+n.url+'" type="'+i+'" width='+n.size.width+" height="+n.size.height+' style="width: '+n.size.width+"px; height: "+n.size.height+"px; margin-left: "+(n.offset.x+t)+"px; margin-top: "+(n.offset.y+l)+'px" data-clip="'+n.clipInfo.clipTop+"px "+n.clipInfo.clipRight+"px "+n.clipInfo.clipBottom+"px "+n.clipInfo.clipLeft+'px" data-anchor="'+(e.ext.newY-e.ext.yStart)+" "+(e.ext.newX-e.ext.xStart)+'"/>',h+=n.id+"|"})),A+=f,n.shapeIdsCommentStr+=h}()}return A+t()},e}());t.Z=a},32406:function(e,t,n){n(38934),n(48845),n(46396),n(19553),n(81144),n(13857),n(54371),n(95019),n(71091),n(31575),n(5570),n(64656),n(43125),n(27849),n(31688),n(84919),n(11425),n(15770);var r=n(11376),o=n(66105),i=n(74140),a=n(28086),l=n(18384),A=n(55690),c=n(64522),u=n(11002),s=n(19750),d=n(67855),f=n.n(d),h=n(5080),p=n(82143);function g(){"use strict";g=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(R){l=function(e,t,n){return e[t]=n}}function A(e,t,n,r){var o=t&&t.prototype instanceof s?t:s,i=Object.create(o.prototype),a=new S(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var l=C(a,n);if(l){if(l===u)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var A=c(e,t,n);if("normal"===A.type){if(r=n.done?"completed":"suspendedYield",A.arg===u)continue;return{value:A.arg,done:n.done}}"throw"===A.type&&(r="completed",n.method="throw",n.arg=A.arg)}}}(e,n,a),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(R){return{type:"throw",arg:R}}}e.wrap=A;var u={};function s(){}function d(){}function f(){}var h={};l(h,o,(function(){return this}));var p=Object.getPrototypeOf,v=p&&p(p(T([])));v&&v!==t&&n.call(v,o)&&(h=v);var m=f.prototype=s.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(o,i,a,l){var A=c(e[o],e,i);if("throw"!==A.type){var u=A.arg,s=u.value;return s&&"object"==typeof s&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,a,l)}),(function(e){r("throw",e,a,l)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,l)}))}l(A.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function C(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return d.prototype=f,l(m,"constructor",f),l(f,"constructor",d),d.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},y(E.prototype),l(E.prototype,i,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new E(A(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(m),l(m,a,"Generator"),l(m,o,(function(){return this})),l(m,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=n.call(i,"catchLoc"),A=n.call(i,"finallyLoc");if(l&&A){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!A)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}var v=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{A(r.next(e))}catch(t){i(t)}}function l(e){try{A(r.throw(e))}catch(t){i(t)}}function A(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}A((r=r.apply(e,t||[])).next())}))},m=new(function(){function e(){var e=this;this.desc={name:c.r.cellImage,tableProps:c.X_.cellImage},this.tdToCellData={isActive:function(t,n,r){var o,i=n.x,a=n.y;return(null===(o=t[e.desc.tableProps][a])||void 0===o?void 0:o[i])&&!r.effectiveValue},fn:function(e){return Object.assign(e,{metadata:l.Z.createInstance({customDataType:i.ZP.IMAGE})})}},this.copyToHtml=function(e,t){var n,r,o=null===(n=e.cellData)||void 0===n?void 0:n.getMetadata(),a=null===o||void 0===o?void 0:o.customDataType;if(!a)return t();if(a!==i.ZP.IMAGE)return t();var l=null===(r=e.cellData.getRefIds())||void 0===r?void 0:r[0],A=l&&e.activeSheet.imageManager.getImage(l);return A?"data-online-sheet-type='"+A.type+"' data-online-sheet-url='"+A.url+"' data-online-sheet-width='"+Math.floor(A.position.overlayPosition.widthPixels)+"' data-online-sheet-height='"+Math.floor(A.position.overlayPosition.heightPixels)+"' "+t():t()},this.processPasteData=function(t){var n=t.cellData,A=t.pasteData,c=t.offset,u=c.row,d=c.col,f=c.fromRow,h=c.fromCol,p=t.activeSheet,g=t.sheetManager,v=t.activeSheetId,m=t.cacheState,y=t.ext.propsKeys;if(n){var E=(0,o.ki)(),C=n.getMetadata(),w=n;if(w&&(null===C||void 0===C?void 0:C.customDataType)===i.ZP.IMAGE&&(w=n.clone()),(null===C||void 0===C?void 0:C.customDataType)===i.ZP.IMAGE){var x=e.setCellImage(A,u,d,f,h,E,p,g,y[e.desc.tableProps],v,m);if(!(null===x||void 0===x?void 0:x.url))return;var S=r.ZP.t("图片");w.setEffectiveValue(s.Z.createInstance({type:a.Z.STRING,value:S})),w.setMetadata(l.Z.createInstance({customDataType:i.ZP.IMAGE})),w.setRefIds([E])}return{newCellData:w}}},this.parseHTML=function(e,t){var n={cellImage:null};if(f()(e.info,n),e.element){if(e.element.getAttribute("data-online-sheet-type")===A.EMBEDDED_OBJECT_TYPE.CELL_IMAGE)return n.cellImage={url:e.element.getAttribute("data-online-sheet-url"),width:e.element.getAttribute("data-online-sheet-width"),height:e.element.getAttribute("data-online-sheet-height")},f()(e.info,n),void t();var r=e.element.querySelector("img"),o=null===r||void 0===r?void 0:r.getAttribute("src");(null===r||void 0===r?void 0:r.getAttribute("type"))!==h.C&&o&&!(0,u.e3)(o)?(n.cellImage={url:o},f()(e.info,n),t()):t()}else t()}}var t=e.prototype;return t.beforePaste=function(e,t){return v(this,void 0,void 0,g().mark((function n(){var r,o,i,a,l,A;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=e.cellImage,o=void 0===r?[]:r,i=0;case 2:if(!(i<o.length)){n.next=29;break}a=0;case 4:if(!(a<o[i].length)){n.next=26;break}if(!o[i][a]){n.next=23;break}if(l=o[i][a].url,!(0,p.$X)(o[i][a])){n.next=23;break}return A=void 0,n.prev=9,n.next=12,t(l);case 12:if(A=n.sent){n.next=16;break}return o[i][a].url="",n.abrupt("continue",23);case 16:n.next=22;break;case 18:return n.prev=18,n.t0=n.catch(9),o[i][a].url="",n.abrupt("continue",23);case 22:o[i][a]={width:A.size.width,height:A.size.height,url:A.url};case 23:a++,n.next=4;break;case 26:i++,n.next=2;break;case 29:case"end":return n.stop()}}),n,null,[[9,18]])})))},t.getCellValue=function(e,t){var n,r,o=null===(n=e.cellData)||void 0===n?void 0:n.getMetadata();if((null===o||void 0===o?void 0:o.customDataType)===i.ZP.IMAGE){var a=null===(r=e.cellData.getRefIds())||void 0===r?void 0:r[0],l=a&&e.activeSheet.imageManager.getImage(a);if(l)return"<img src="+l.url+"/ tencent-sheet-cell-img='true'>"}return t()},t.setCellImage=function(e,t,n,r,o,i,a,l,c,u,s){var d,f=e.cellImage,h=void 0===f?[]:f,p=0,g=0;if(h.length){var v=d=h[r][o];p=v.width,g=v.height}else{if(!(null===(d=this.setCellImageInner(e,r,o,a,l,s,u))||void 0===d?void 0:d.url))return{url:""};var m=d.position.overlayPosition;p=m.widthPixels,g=m.heightPixels}return d.url&&c.push(Object.assign(Object.assign({},d),{type:A.EMBEDDED_OBJECT_TYPE.CELL_IMAGE,sheetId:u,x:n,y:t,width:p,height:g,id:i,offsetX:0,offsetY:0,zIndex:0})),d},t.setCellImageInner=function(e,t,n,r,o,i,a){var l,A;try{l=e.rowDataUpdate[t].values[n].getRefIds()[0]}catch(u){return{url:""}}if(a===i.sheetId)A=r.imageManager.getImage(l)||i.cellImageCache.get(l);else{var c=o.getSheetBySheetId(i.sheetId);A=null===c||void 0===c?void 0:c.imageManager.getImage(l)}return A},e}());t.Z=m},33572:function(e,t,n){n.d(t,{Z:function(){return ye}});var r,o,i,a=n(64522),l=n(58926),A=(n(19553),n(30980),n(38934),n(71091),n(16640),n(37108),n(28255),n(50104),n(25111),n(39585),n(77575),n(76880),n(11502),n(96434),n(3377),n(71318),n(21530),n(81144),n(26894),n(93984),n(90109),(r={})[a.aC.COPY_ON_CELL_VALUE]=new Map,r[a.aC.CELL_PROPS]=new Map,r[a.aC.COPY_ON_CELL_ATTR]=new Map,r[a.aC.COPY_ON_TABLE_END]=new Map,r[a.aC.PASTE_ON_PARSE_HTML]=new Map,r),c=function(){function e(){this.phase=a.nz.IDLE,this.middleWares=A}var t=e.prototype;return t.getMiddleWaresByLevel=function(e){var t=this.middleWares[e];return Array.from(t.values())},t.getAllMiddleWares=function(e){var t=e.level,n=e.tableProps;if(!t)return[];var r=(0,l.Z)(this.getMiddleWaresByLevel(t));return n&&(r=this.getMiddleWaresByTableProps(r)),r},t.run=function(e,t,n){var r=this.getMiddleWareCallBacks(e,t);return this.compose(r,n)},t.register=function(e,t,n){this.middleWares[e].set(t,n)},t.getMiddleWaresByTableProps=function(e){return e?e.filter((function(e){return e.desc.tableProps})):[]},t.getMiddleWareCallBacks=function(e,t){return this.getMiddleWaresByLevel(e).filter((function(e){return"function"===typeof e[t]})).map((function(e){return e[t]}))},t.compose=function(e,t){var n=-1;return function r(o){if(o<=n)throw new Error("next only called once");if(n=o,o===e.length)return"";var i=e[o];return null===i||void 0===i?void 0:i(t,r.bind(null,o+1))}(0)},e}(),u=new c,s=n(32406),d=(n(52865),n(20670),n(46396),n(31688),n(64425),n(52731)),f=n(62084),h=n(54327),p=n(18216),g=n(24352),v=n(33740),m=n(70699),y=n(67855),E=n.n(y),C=n(61424),w=new function(){this.desc={name:a.r.cellLink},this.getCellValue=function(e,t){if(!e.cellData)return t();var n=(0,m.UF)(e.cellData),r=t();return r=(null===r||void 0===r?void 0:r.replace(/\r?\n/g,'<br style="mso-data-placement:same-cell;">'))||"",n?""+n+r+"</a>":r},this.processPasteData=function(e){var t,n=e.cellData;if(!n)return{newCellData:n};var r=n.getHyperlink()||n.getHyperlinkRuns(),o=n.getUserEnteredFormat();if(r){var i=null===o||void 0===o?void 0:o.getColor(),a=null===o||void 0===o?void 0:o.getUnderline(),l={};i||(l.color=g.HYPERLINK_COLOR),a||(l.underline=v.Z.SINGLE_LINE);var A=C.NumberFormatFactory.createInstance({pattern:"@"});n.setUserEnteredFormat(d.Z.createInstance(Object.assign(Object.assign({},null===o||void 0===o?void 0:o.getOptions()),{textFormat:Object.assign(Object.assign({},null===(t=null===o||void 0===o?void 0:o.textFormat)||void 0===t?void 0:t.getOptions()),l),numberFormat:A})))}return{newCellData:n}},this.parseHTML=function(e,t){var n={template:null};if(E()(e.info,n),e.element){var r,o,i,a=e.element.getElementsByTagName("a");a.length&&function(){for(var t=void 0,l=[],A=0,c=a.length;A<c;A++){r=a[A].getAttribute("data-sheet-href")||a[A].getAttribute("href"),i=a[A].dataset.tencent_doc_hyperlink_type||"";var u=a[A].getAttribute("data-sheets-hyperlink"),s=a[A].getAttribute("data-sheets-hyperlinkruns");try{var d=u?JSON.parse(u):void 0;(0,f.a6)(d)&&(t=d)}catch(m){}try{var g=s?JSON.parse(s):void 0;Array.isArray(g)&&g.forEach((function(e){"object"===typeof e&&l.push(p.Z.createInstance(e))}))}catch(m){}if(r)break}o=e.element.innerText;var v=!1;(null===t||void 0===t?void 0:t.fullLinkUrl)&&(null===t||void 0===t?void 0:t.fullLinkUrl.split("?"))[0]!==""+location.origin+location.pathname&&(v=!0),n.template=(0,h.eO)(v?null===t||void 0===t?void 0:t.fullLinkUrl:r||o,o,i&&parseInt(i,10)||(null===t||void 0===t?void 0:t.hyperlinkType),null===t||void 0===t?void 0:t.linkIconStatus,l.length>0&&!v?l:void 0),E()(e.info,n)}(),t()}else t()}},x=(n(91502),n(86310),n(91877),n(60113),n(8266)),S=n(60878),T=(n(71096),n(75793),n(15770),n(8195),n(85932),n(77468),n(62883),n(12024),n(81502),{white:"#FFFFFF",silver:"#C0C0C0",gray:"#808080",black:"#000000",red:"#FF0000",maroon:"#800000",yellow:"#FFFF00",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",teal:"#008080",blue:"#0000FF",navy:"#000080",fuchsia:"#FF00FF",purple:"#800080"}),I={windowtext:"",windowframe:"",window:"",threedshadow:"",threedlightshadow:"",threedhighlight:"",threedface:"",threeddarkshadow:"",scrollbar:"",menutext:"",menu:"",infotext:"",infobackground:"",inactivecaptiontext:"",inactivecaption:"",inactiveborder:"",highlighttext:"",highlight:"",grayText:"",captiontext:"",buttontext:"",buttonshadow:"",buttonhighlight:"",buttonface:"",background:"",appworkspace:"",activecaption:"",activeborder:""},R=n(28411),L=n(64548),b=((o={})[L.Z.NONE]="none",o[L.Z.HAIR]=".5pt hairline",o[L.Z.DASH_DOT]=".5pt dot-dash",o[L.Z.DASH_DOT_DOT]=".5pt dot-dot-dash",o[L.Z.DOTTED]=".5pt dotted",o[L.Z.DASHED]=".5pt dashed",o[L.Z.THIN]=".5pt solid",o[L.Z.MEDIUM_DASH_DOT_DOT]="1.0pt dot-dot-dash",o[L.Z.SLANTED_DASH_DOT]="1.0pt dot-dash-slanted",o[L.Z.MEDIUM_DASH_DOT]="1.0pt dot-dash",o[L.Z.MEDIUM_DASHED]="1.0pt dashed",o[L.Z.MEDIUM]="1.0pt solid",o[L.Z.DOUBLE]="2.0pt double",o[L.Z.THICK]="1.5pt solid",o),D=n(90980),_=n(63898),F=n(14831),M=n.n(F),O=n(74140),P=n(1976),k=Object.keys(I);function N(e,t,n,r,o,a){var l=[];return function(e,t,n){var r=e.getBackgroundColor();if(r){var o=P.Z.getColorHexCode(r,n);o!==g.DEFAULT_CELL_FORMAT_LITERAL.backgroundColor&&t.push("background-color:"+o)}}(o,l,a),B(r,l,a,e),function(e,t,n,r){var o=t.getMergeReference();Q(e,n,i.left,r),Q(e,n,i.top,r),Q(e,n,i.diagUp,r),Q(e,n,i.diagDown,r),o||(Q(e,n,i.right,r),Q(e,n,i.bottom,r))}(o,e,l,a),function(e,t,n,r){(function(e,t,n,r){var o=e.getMergeReference();if(o){var i=o.startRowIndex,a=o.endColIndex;if((null===t||void 0===t?void 0:t[i])&&t[i].values&&t[i].values[a]){var l=t[i].values[a];if(l){var A=l.getUserEnteredFormat();if(A){var c=A.getBorderRight();c&&(c.color||c.style)&&n.push("border-right: "+Z(c,r))}}}}})(e,t,n,r),function(e,t,n,r){var o=e.getMergeReference();if(o){var i=o.endRowIndex,a=o.startColIndex;if((null===t||void 0===t?void 0:t[i])&&t[i].values&&t[i].values[a]){var l=t[i].values[a];if(l){var A=l.getUserEnteredFormat();if(A){var c=A.getBorderBottom();c&&(c.color||c.style)&&n.push("border-bottom: "+Z(c,r))}}}}}(e,t,n,r)}(e,n,l,a),function(e,t){var n=(0,D.getMergedFormat)(e,"verticalAlign");n&&t.push("vertical-align:"+n)}(e,l),function(e,t){var n=(0,D.getMergedFormat)(e,"textAlign");n&&t.push("text-align:"+n)}(e,l),function(e,t){var n=e.getWrapStrategy();n&&t.push("white-space:"+n)}(o,l),function(e,t){if(e){var n=(0,_.H)((0,C.getFormatCodeByNumberFormat)(e));t.push("mso-number-format: "+n)}}(t,l),l.join(";")+";"}function B(e,t,n,r){var o;t.push("font-size:"+(e.fontSize?e.fontSize:g.DEFAULT_CELL_FORMAT_LITERAL.fontSize)+"pt"),e.italic&&t.push("font-style:italic"),e.bold&&t.push("font-weight:bold"),e.underline&&t.push("text-decoration:underline");var i=e.fontFamily?e.fontFamily.replace(/"/g,"'"):g.DEFAULT_CELL_FORMAT_LITERAL.fontFamily;i&&t.push("font-family:"+i);var a=e.color;(a||(null===(o=null===r||void 0===r?void 0:r.getMetadata())||void 0===o?void 0:o.customDataType)===O.ZP.DATE_REMINDER)&&t.push("color:"+P.Z.getColorHexCode(a,n))}function Z(e,t){var n=e.color?P.Z.getColorHexCode(e.color,t):"#000000";return("number"===typeof e.style?b[e.style]:b[L.Z.THIN])+" "+n}function Q(e,t,n,r){var o,a=((o={})[i.left]=e.getBorderLeft,o[i.right]=e.getBorderRight,o[i.top]=e.getBorderTop,o[i.bottom]=e.getBorderBottom,o[i.diagUp]=e.getBorderDiagUp,o[i.diagDown]=e.getBorderDiagDown,o)[n].bind(e)();a&&(a.color||a.style)&&t.push(n+": "+Z(a,r))}function U(e){var t=e.split(" "),n=null;return t&&t.length>2&&(n=t.slice(0,2).join(" ")),n?function(e){var t={none:L.Z.NONE,".5pt hairline":L.Z.HAIR,".5pt dot-dash":L.Z.DASH_DOT,".5pt dot-dot-dash":L.Z.DASH_DOT_DOT,".5pt dotted":L.Z.DOTTED,".5pt dashed":L.Z.DASHED,".5pt solid":L.Z.THIN,"1.0pt dot-dot-dash":L.Z.MEDIUM_DASH_DOT_DOT,"1.0pt dot-dash-slanted":L.Z.SLANTED_DASH_DOT,"1.0pt dot-dash":L.Z.MEDIUM_DASH_DOT,"1.0pt dashed":L.Z.MEDIUM_DASHED,"1.0pt solid":L.Z.MEDIUM,"2.0pt double":L.Z.DOUBLE,"1.5pt solid":L.Z.THICK},n={".5pt dotted":L.Z.DOTTED,".5pt dashed":L.Z.DASHED,".5pt solid":L.Z.THIN,"1.2pt solid":L.Z.MEDIUM,"1.2pt dashed":L.Z.MEDIUM_DASHED,"2.0pt solid":L.Z.THICK,"2.0pt double":L.Z.DOUBLE},r={"0.5pt dotted":L.Z.DOTTED,"0.5pt dashed":L.Z.DASHED,"0.5pt solid":L.Z.THIN,"1pt dashed":L.Z.MEDIUM_DASHED,"1pt solid":L.Z.MEDIUM,"1.5pt solid":L.Z.THICK,"2pt double":L.Z.DOUBLE};return t[e]||n[e]||r[e]||null}(n):null}!function(e){e.left="border-left",e.right="border-right",e.top="border-top",e.bottom="border-bottom",e.diagUp="border-diagup",e.diagDown="border-diagdown"}(i||(i={}));var H,J=function(e,t,n,r,o,i){if(!e)return n;var a=t[o];if(a)return a;var l=t[r]||t[i];if(!l)return n;var A=K(l);return G(A)},K=function(e){var t=e.split(/\s+/);return t.length>2?t.slice(2).join(""):t[2]},G=function(e){if("string"===typeof e)return W(e)},Y=function(e){return{borderTopWidth:e["border-top"]||e.border||"0px",borderRightWidth:e["border-right"]||e.border||"0px",borderBottomWidth:e["border-bottom"]||e.border||"0px",borderLeftWidth:e["border-left"]||e.border||"0px",borderDiagUpWidth:e["border-diagup"]||e["mso-diagonal-up"]||"0px",borderDiagDownWidth:e["border-diagdown"]||e["mso-diagonal-down"]||"0px"}},j=function(e){var t=V(e);return{borderTopWidth:(null===e||void 0===e?void 0:e["border-top-width"])?z(e["border-top-width"],t[0],e["border-top-color"]):null,borderRightWidth:(null===e||void 0===e?void 0:e["border-right-width"])?z(e["border-right-width"],t[1],e["border-right-color"]):null,borderBottomWidth:(null===e||void 0===e?void 0:e["border-bottom-width"])?z(e["border-bottom-width"],t[2],e["border-bottom-color"]):null,borderLeftWidth:(null===e||void 0===e?void 0:e["border-left-width"])?z(e["border-left-width"],t[3],e["border-left-color"]):null,borderDiagUpWidth:null,borderDiagDownWidth:null}},V=function(e){var t=[];if(e["border-style"]&&(t=e["border-style"].split(" ")),2===t.length&&(t=t.concat(t)),3===t.length){var n=t[1];t.push(n)}return t},z=function(e,t,n){return e+" "+t+" "+n},W=function(e){if("string"===typeof e){var t=X(e),n={};return"#"===t[0]?t:"rgb"===t.substring(0,3).toLowerCase()?(n[t]||(n[t]=q(t)),n[t]):T[t]?T[t]:void 0}},q=function(e){var t=e.toString().match(/\d+(\.\d+)?/g);if(null===t||void 0===t?void 0:t.length){var n=1;if(t[3]&&"undefined"!==typeof t[3]&&(n=Number(t[3])),0===n)return"";var r="#";if(1===n)for(var o=0;o<3;o++)r+=("{0"+Number(t[o]).toString(16)).slice(-2);else{for(var i=0;i<3;i++)r+=("{0"+Number(t[i]).toString(16)).slice(-2);r+=(255*n).toString(16).substring(0,2)}return r}},X=function(){var e=document.createElement("div");return document.body.appendChild(e),function(t){if("excel"===R.Z.getApp()){var n=t.toLocaleLowerCase();if(k.includes(n))return I[n]?I[n]:(e.style.borderColor=t,getComputedStyle(e).borderColor)}return t}}(),$=function(e,t){var n=[];e.strikethrough&&n.push("s");var r=n.reverse();return function(e,t,n){return""+e.map((function(e){return"<"+e+">"})).concat([n]).concat(t.map((function(e){return"</"+e+">"}))).join("")}(n,r,t)},ee=new(function(){function e(){var e=this;this.desc={name:a.r.cellStyle},this.style={},this.getCellValue=function(e,t){var n=function(e){var t=[];if(e){var n=[e.getConditionalFormatResult(),e.getEffectiveFormat(),e.getUserEnteredFormat()].filter((function(e){return null!==e}));t.push.apply(t,(0,l.Z)(n))}if(0!==t.length)return(0,x.mergeCellFormats)(t)}(e.cellData),r=(null===n||void 0===n?void 0:n.getTextFormat())||S.Z.createInstance(),o=t();return""+(o=$(r,o))},this.copyToHtml=function(e,t){var n=e.activeSheet.data.rowData,r=[];if(e.cellData){var o=[e.cellData.getConditionalFormatResult(),e.cellData.getEffectiveFormat(),e.cellData.getUserEnteredFormat()].filter((function(e){return null!==e}));r.push.apply(r,(0,l.Z)(o))}var i=r.length>0&&(0,x.mergeCellFormats)(r),a="",A=!1!==i&&(null===i||void 0===i?void 0:i.getTextFormat())||S.Z.createInstance();if(e.cellData&&i){var c=i.getNumberFormat();a+=N(e.cellData,c,n,A,i,e.activeSheet.spreadsheetReference)}else a+=function(){var e="";return e+"font-size: "+g.DEFAULT_CELL_FORMAT_LITERAL.fontSize+"pt;"}();return'style="'+a+'" '+t()},this.parseHTML=function(t,n){e.parseFontFamily(t.element,t.style).parseFontSize(t.element,t.style).parseFontColor(t.element,t.style).parseFontWeight(t.element,t.style).parseFontStyle(t.element,t.style).parseFontDecoration(t.element,t.style).parseBorder(t.element,t.style).parseBackgroundColor(t.element,t.style).parseTextAlign(t.element,t.style).parseVerticalAlign(t.element,t.style).parseWhiteSpace(t.element,t.style).parseFormat(t.element,t.style,t.ext);var r={style:e.style};E()(t.info,r),e.style={},n()}}var t=e.prototype;return t.parseFontFamily=function(e,t){var n=null===t||void 0===t?void 0:t["font-family"];return n&&(this.style.fontfamily=(0,h.L1)(n)),this},t.parseFontSize=function(e,t){var n=null===t||void 0===t?void 0:t["font-size"];return n&&(this.style.fontsize=(0,h.bU)(n)),this},t.parseFontColor=function(e,t){var n=null===t||void 0===t?void 0:t.color;if(n){var r=W(n);r&&(this.style.fontcolor=r)}return this},t.parseFontWeight=function(e,t){var n=null===t||void 0===t?void 0:t["font-weight"];return!n||"bold"!==n&&700!==parseInt(n,10)||(this.style.bold="bold"),this},t.parseFontStyle=function(e,t){return"italic"===(null===t||void 0===t?void 0:t["font-style"])&&(this.style.italic="italic"),this},t.parseFontDecoration=function(e,t){var n=null===t||void 0===t?void 0:t["text-decoration"];if(n&&(-1!==n.indexOf("underline")&&(this.style.underline="underline"),-1!==n.indexOf("line-through")&&(this.style.strikeline="strikeline")),e)for(var r=e.firstElementChild,o=10;r&&o;)"u"===r.tagName.toLowerCase()?this.style.underline="underline":"s"===r.tagName.toLowerCase()&&(this.style.strikeline="strikeline"),r=r.firstElementChild,o-=1;return this},t.parseBorder=function(e,t){if(t){var n=function(e){var t=Y(e);if(M().isSafari){var n=j(e);Object.keys(n).forEach((function(e){n[e]&&(t[e]=n[e])}))}return t}(t),r=n.borderTopWidth,o=n.borderRightWidth,i=n.borderBottomWidth,a=n.borderLeftWidth,l=n.borderDiagUpWidth,A=n.borderDiagDownWidth,c=function(e,t,n,r,o,i){return[parseInt(e,10)>0||parseFloat(e)>0,parseInt(t,10)>0||parseFloat(t)>0,parseInt(n,10)>0||parseFloat(n)>0,parseInt(r,10)>0||parseFloat(r)>0,parseInt(o,10)>0||parseFloat(o)>0,parseInt(i,10)>0||parseFloat(i)>0]}(r,o,i,a,l,A),u=function(e,t){var n=e.border&&K(e.border),r=e.border&&G(n);return[J(t[0],e,r,"border-top","border-top-color","border-top"),J(t[1],e,r,"border-right","border-right-color","border-right"),J(t[2],e,r,"border-bottom","border-bottom-color","border-bottom"),J(t[3],e,r,"border-left","border-left-color","border-left"),J(t[4],e,r,"border-diagup","border-diagup-color","mso-diagonal-up"),J(t[5],e,r,"border-diagdown","border-diagdown-color","mso-diagonal-down")]}(t,c),s=function(e,t,n,r,o,i,a){return[e[0]&&t?U(t):null,e[1]&&n?U(n):null,e[2]&&r?U(r):null,e[3]&&o?U(o):null,e[4]&&i?U(i):null,e[5]&&a?U(a):null]}(c,r,o,i,a,l,A);this.style.border={colors:u,styles:s}}return this},t.parseBackgroundColor=function(e,t){var n=(null===t||void 0===t?void 0:t["background-color"])||(null===t||void 0===t?void 0:t.background);if(n){var r=W(n);r&&(this.style.cellcolor=r)}return this},t.parseTextAlign=function(e,t){var n,r;return(r="excel"===R.Z.getApp()&&(null===(n=null===e||void 0===e?void 0:e.style)||void 0===n?void 0:n.textAlign)||(null===t||void 0===t?void 0:t["text-align"]))&&("start"===(r=(r=(null===r||void 0===r?void 0:r.toLowerCase())||"").replace(/^-(webkit|moz)-(.*)/,"$2"))||"justify"===r?r="left":"end"===r&&(r="right"),"121"===r&&(r="center"),-1!==["right","left","center"].indexOf(r)&&(this.style.h_align=r)),this},t.parseVerticalAlign=function(e,t){var n=null===t||void 0===t?void 0:t["vertical-align"];return t&&(this.style.v_align=n),this},t.parseWhiteSpace=function(e,t){if(t){var n=e.style.whiteSpace,r=null===t||void 0===t?void 0:t["white-space"];r&&(n=r),this.style.textwrap="normal"===n?n:"nowrap"}return this},t.parseFormat=function(e,t,n){if(!e||!n.mSOStyle)return this;var r=null===t||void 0===t?void 0:t["mso-number-format"];if(void 0===r)return this;r=r.replace(/^['|"]/,"").replace(/['|"]$/,"");var o=C.MSO_FORMAT_MAP[r];return o&&(r=o),this.style.format_data=r,this},e}()),te=n(30516),ne=n(17483),re=new(function(){function e(){var e=this;this.desc={name:a.r.cellFormula},this.parseHTML=function(e,t){var n={formula:null};if(!e.ext.noFormula&&e.element){var r=e.element.getAttribute("data-online-sheet-formula");r&&"string"===typeof r&&(n.formula=r,E()(e.info,n))}t()},this.copyToHtml=function(t,n){var r=e.getRelativeFormula(t);return r&&"string"===typeof r?function(e){var t="";return e&&(t=' data-online-sheet-formula="'+e.replace(/"/g,"&#34;")+'" '),t}(r)+n():n()}}return e.prototype.getRelativeFormula=function(e){var t;if(e.cellData){var n,r=null===(t=e.cellData)||void 0===t?void 0:t.getFormula();if(r){var o=r.toString(e.ext.newY,e.ext.newX,e.activeSheet.spreadsheetReference.sheetManager);return e.ext.pasteType===te.lb.copy&&(n=ne.Z.formula.util.getRelativeFormulaWithFormula(o,e.ext.newY,e.ext.newX)),n}}},e}());function oe(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ie(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(84919),n(13857),n(54371),n(95019),function(e){e[e.TEXT=0]="TEXT",e[e.BR=1]="BR"}(H||(H={}));var ae=function e(t,n,r){if(!t)return[];if(3===t.nodeType)return function(e){var t,n=e.textContent;return t=n.replace(/^[\r\n]\s+/,""),(n=t.replace(/[\r\n]\s/g,""))?[{len:n.length,format:null,text:n,type:H.TEXT}]:[]}(t);if(t.nodeType!==Node.ELEMENT_NODE)return[];if("br"==t.tagName.toLowerCase())return[{len:1,format:null,text:"\n",type:H.BR}];var o=function(e,t,n){var r=n(e),o={style:{}};if("a"==e.tagName.toLowerCase()&&(o.style.fontcolor=t("#018ffb"),o.style.underline="underline"),r){var i=r["font-family"];if(i){var a=i.indexOf(",");-1!=a&&(i=i.slice(0,a)),'"'==i[0]&&(i=i.slice(1,i.length-1)),o.style.fontfamily=i}var l=r["font-size"];if(l)if(-1!==l.toString().toLowerCase().indexOf("pt"))o.style.fontsize=l;else{var A=parseFloat(l);A=3*A/4,(A=Math.round(10*A)/10)&&(o.style.fontsize=A+"pt")}var c=t(r.color);c&&(o.style.fontcolor=c);var u=r["font-weight"];"bold"!=u&&700!=u||(o.style.bold="bold"),"italic"==r["font-style"]&&(o.style.italic="italic");var s=r["text-decoration"];s&&(-1!=s.indexOf("underline")&&(o.style.underline="underline"),-1!=s.indexOf("line-through")&&(o.style.strikeline="strikeline"))}return function(e,t){switch(e.tagName.toLowerCase()){case"b":case"strong":t.style.bold="bold";break;case"i":case"em":t.style.italic="italic";break;case"u":case"ins":t.style.underline="underline";break;case"s":case"strike":case"del":t.style.strikeline="strikeline"}return t}(e,o)}(t,n,r),i=t.childNodes;if(i&&i.length){var a=[];i.forEach((function(t,o){a=a.concat(e(t,n,r))}));for(var l,A=oe(a);!(l=A()).done;){var c=l.value;c&&(c.format?c.format=Object.assign({},o.style,c.format):c.format=Object.assign({},o.style))}return a}return[]},le=function(e,t){return/^[^\S\r\n]+$/.test(e)&&/^[\r\n]$/.test(t)},Ae=function(e,t,n){if(!n)return{effectTextFormatRuns:[],allTextFormatRuns:[]};var r=[];return function(e,t){var n=0,r=e.length-1;e.forEach((function(o,i){if(o){if((0===n||i===r)&&o.type===H.TEXT&&/^\s+$/.test(o.text))return;if(le(o.text,e[Math.max(i-1,0)].text))return;t.push({startIndex:n,format:o.format,text:o.text}),n+=o.len}}))}(ae(e,t,n),r),r.filter((function(e){return!e.format||!Object.keys(e.format).length})).length===r.length?{effectTextFormatRuns:[],allTextFormatRuns:r}:{effectTextFormatRuns:r,allTextFormatRuns:r}},ce=function(e){return e.replace(/&/g,"&amp;").replace(/\ufeff/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")},ue=new function(){var e=this;this.desc={name:a.r.cellTextFormat},this.style={},this.getCellValue=function(e,t){var n=e.cellData,r=e.activeSheet,o=null===n||void 0===n?void 0:n.getEffectiveValue(),i=null===n||void 0===n?void 0:n.getTextFormatRuns();if("string"===typeof(null===o||void 0===o?void 0:o.value)&&i){var a=o.value;return""+i.map((function(e,t){var n=i[t+1]?i[t+1].startIndex:a.length,o=a.slice(e.startIndex,n);if(o=ce(o),!e.format)return o;var l=function(e,t){var n=[];return B(e.format,n,t),n.join(";")+";"}(e,r.spreadsheetReference);return'<font style="'+l+'">'+$(e.format,o)+"</font>"})).join("")}return t()},this.copyToHtml=function(){return""},this.parseHTML=function(t,r){if(E()(t.info,{style:e.style}),t.element){try{var o=Ae(t.element,W,t.ext.mSOStyle?t.ext.mSOStyle.getComputedStyle:void 0),i=o.effectTextFormatRuns,a=o.allTextFormatRuns;e.style.textFormatRuns=i,e.style.allTextFormatRuns=a}catch(A){n.g.log.error("cellTextFormatMiddleware parseHTML",A)}var l={style:e.style};E()(t.info,l),e.style={},r()}else r()}},se=new function(){var e=this;this.desc={name:a.r.cellTextPlain},this.getCellValue=function(e,t){var n=e.cellData,r=function(e){return e?(0,D.getMergedValue)(e):""}(n),o=null===n||void 0===n?void 0:n.getCellType();return""+(r=o===O.ZP.STAFF_CARD||o===O.ZP.GROUP_CARD||o===O.ZP.SCHEDULE?"[不支持的媒体类型]":r===C.INVALID_VALUE?(r=((null===n||void 0===n?void 0:n.getEditValue())||"").replace(/\ufeff/g,"")).replace(/</g,"&lt;").replace(/>/g,"&gt;"):ce(r))+t()},this.parseHTML=function(t,n){var r="";E()(t.info,{data:r}),t.element?(r=(r=e.setTextPlainFromTextFormat(t))||t.element.textContent,E()(t.info,{data:r}),n()):n()},this.setTextPlainFromTextFormat=function(e){var t,n,r="";return null===(n=null===(t=e.info.style)||void 0===t?void 0:t.allTextFormatRuns)||void 0===n||n.forEach((function(e){r+=e.text})),r}},de=n(59538),fe=new function(){this.desc={name:a.r.cellMergeReference},this.copyToHtml=function(e,t){var n=e.ext,r=n.mergeReference,o=n.newX,i=n.newY,a=n.hideRowMap,l=n.hideColMap;return r?(0,de.J)(r,o,i,a,l)+t():t()}},he=n(55690),pe=n(10752),ge=n(18384),ve=new(function(){function e(){var e=this;this.desc={name:a.r.cellCustomData},this.info={},this.copyToHtml=function(e,t){var n=e.activeSheet.spreadsheetReference.getSpreadsheetId();return function(e,t){void 0===t&&(t="");var n=null===e||void 0===e?void 0:e.getMetadata(),r=null===n||void 0===n?void 0:n.customDataType;if(!r)return"";if(r===O.ZP.IMAGE||r===O.ZP.STAFF_CARD||r===O.ZP.GROUP_CARD||r===O.ZP.SCHEDULE||r===O.ZP.TODO)return"";var o="data-online-sheet-type='"+r+"' data-online-sheet-value='"+JSON.stringify(null===n||void 0===n?void 0:n.serialize())+"'",i=e.getRefIds();o+=" data-online-sheet-refId='"+(null!==i&&void 0!==i?i:"")+"'";var a=null===e||void 0===e?void 0:e.getRefData();return!a||r!==O.ZP.THIRD_PARTY_APP&&r!==O.ZP.MINI_APP||(o+=" data-online-sheet-refData='"+JSON.stringify(a.serialize())+"'"),r===O.ZP.DATE_REMINDER&&(o+=" data-online-sheet-docId="+t),o}(e.cellData,n)+function(e){var t=null===e||void 0===e?void 0:e.getDataValidation();return t?"data-online-sheet-validation='"+JSON.stringify(t.serialize())+"'":""}(e.cellData)+t()},this.parseHTML=function(t,n){e.parseSelect(t.element).parseDataValidation(t.element);var r=Object.assign({},e.info);E()(t.info,r),e.info={},n()},this.setSelect=function(t,n,r){try{e.info.cellSelect={value:(0,ge.F)(JSON.parse(n)),refId:r.getAttribute("data-online-sheet-refId"),refData:r.getAttribute("data-online-sheet-refData"),type:Number(t),docId:r.getAttribute("data-online-sheet-docId")||void 0}}catch(o){e.info.cellSelect=null}}}var t=e.prototype;return t.parseSelect=function(e){if(e){var t=e.getAttribute("data-online-sheet-type"),n=e.getAttribute("data-online-sheet-value");!function(e,t){return e!==he.EMBEDDED_OBJECT_TYPE.CELL_IMAGE&&t}(t,n)?this.info.cellSelect=null:this.setSelect(t,n,e)}return this},t.parseDataValidation=function(e){if(e){var t=e.getAttribute("data-online-sheet-validation");this.info.dataValidation=t?(0,pe.D)(JSON.parse(t)):null}return this},e}()),me=n(5080);u.register(a.aC.COPY_ON_CELL_VALUE,a.r.cellLink,w),u.register(a.aC.COPY_ON_CELL_VALUE,a.r.cellImage,s.Z),u.register(a.aC.COPY_ON_CELL_VALUE,a.r.cellFloatImage,me.Z),u.register(a.aC.COPY_ON_CELL_VALUE,a.r.cellStyle,ee),u.register(a.aC.COPY_ON_CELL_VALUE,a.r.cellTextFormat,ue),u.register(a.aC.COPY_ON_CELL_VALUE,a.r.cellTextPlain,se),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellMergeReference,fe),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellImage,s.Z),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellFormula,re),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellLink,w),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellStyle,ee),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellCustomData,ve),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellTextFormat,ue),u.register(a.aC.COPY_ON_CELL_ATTR,a.r.cellTextPlain,se),u.register(a.aC.COPY_ON_TABLE_END,a.r.cellFloatImage,me.Z),u.register(a.aC.CELL_PROPS,a.r.cellImage,s.Z),u.register(a.aC.CELL_PROPS,a.r.cellLink,w),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellMergeReference,fe),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellImage,s.Z),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellFormula,re),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellLink,w),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellStyle,ee),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellCustomData,ve),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellTextFormat,ue),u.register(a.aC.PASTE_ON_PARSE_HTML,a.r.cellTextPlain,se);var ye=u},64522:function(e,t,n){var r,o,i,a;n.d(t,{X_:function(){return o},aC:function(){return i},nz:function(){return a},r:function(){return r}}),function(e){e.cellImage="cellImage",e.cellLink="cellLink",e.cellStyle="cellStyle",e.cellFormula="cellFormula",e.cellTextFormat="cellTextFormat",e.cellTextPlain="cellTextPlain",e.cellMergeReference="cellMergeReference",e.cellCustomData="cellCustomData",e.cellFloatImage="cellFloatImage"}(r||(r={})),function(e){e.cellImage="cellImage"}(o||(o={})),function(e){e[e.COPY_ON_CELL_ATTR=0]="COPY_ON_CELL_ATTR",e[e.COPY_ON_CELL_VALUE=1]="COPY_ON_CELL_VALUE",e[e.COPY_ON_TABLE_END=2]="COPY_ON_TABLE_END",e[e.PASTE_ON_PARSE_HTML=3]="PASTE_ON_PARSE_HTML",e[e.CELL_PROPS=4]="CELL_PROPS"}(i||(i={})),function(e){e[e.IDLE=1]="IDLE",e[e.BEFORE_COPY=2]="BEFORE_COPY",e[e.COPY=3]="COPY",e[e.SET_CACHE=4]="SET_CACHE",e[e.COPY_TO_HTML=5]="COPY_TO_HTML",e[e.BEFORE_PARSE=6]="BEFORE_PARSE",e[e.PARSE=7]="PARSE",e[e.PARSE_HTML=8]="PARSE_HTML",e[e.HTML_TABLE=9]="HTML_TABLE",e[e.PROCESS_CELL_DATA=10]="PROCESS_CELL_DATA",e[e.RUN_REQUEST=11]="RUN_REQUEST"}(a||(a={}))},42525:function(e,t,n){n.d(t,{nS:function(){return l},oc:function(){return a}});var r=n(11376),o=n(46086),i=n.g,a=function(){o.dialog.confirm({title:r.ZP.t("提示"),content:r.ZP.t("不能执行与合并单元格相交的粘贴，建议取消合并单元格。"),onOk:function(e){return e.preventDefault(),e.stopPropagation(),i.focus(),!0},onCancel:function(e){e.preventDefault(),e.stopPropagation(),i.focus()}})},l=function(){o.dialog.alert(r.ZP.t("提示"),r.ZP.t("无法对合并单元格执行此操作。"),(function(){}))}},89882:function(e,t,n){n.d(t,{$8:function(){return l.$8},Bs:function(){return s},bF:function(){return c},r$:function(){return u}}),n(19553),n(38934),n(81144),n(90109);var r=n(90128),o=n(30516),i=n(90431),a=n(45422),l=n(29835),A=(new r.Z).iconsList.spinner,c=function(e){for(var t=e.mergeReference,n=e.hiddenRowMap,r=e.copyRange,i=e.copyType,a=e.isCopyForOuter,l=r.endRowIndex,A=r.endColIndex,c=!1,u=t.endColIndex-t.startColIndex+1,s=t.startColIndex,d=s+u-1,f=s,h=s;h<=d;h++){if(h>A)return{xUnit:-1,yUnit:-1,x:-1,y:-1};c||(f=h,c=!0)}for(var p=!1,g=t.endRowIndex-t.startRowIndex+1,v=t.startRowIndex,m=v+g-1,y=v,E=v;E<=m;E++){if(E>l)return{xUnit:-1,yUnit:-1,x:-1,y:-1};!a&&i!==o.lb.copy||!(null===n||void 0===n?void 0:n.get(E))?p||(y=E,p=!0):g-=1}return{xUnit:u,yUnit:g,x:f,y:y}},u=function(e,t,n,r,o){for(var i=n,a=t,l=n;l<=o&&l<e.length;l++)for(var A=t;A<=r&&e[l]&&e[l].values;A++)e[l].values[A]&&(i<l&&(i=l),a<A&&(a=A));return{maxY:i,maxX:a}};function s(e,t){var n=t.cutRanges,r=t.oldRow,o=t.oldCol,l=t.newRow,A=t.newCol,c=e.getParts().map((function(e){if("string"===typeof e)return e;for(var t=e,i=n.length-1;i>-1;i--){var c=n[i],u=e.isContainedByRange({row:r,col:o,range:c});t=(0,a.dt)(t,{oldRow:r,oldCol:o,newRow:l,newCol:A,keepRelativeRelationship:u})}return t}));return i.FormulaModelFactory.createInstance({formulaPartList:c})}var d={loadingView:document.createElement("loadingView"),showLoading:function(e){var t=d.loadingView;return t.setAttribute("width",e.style.width),t.setAttribute("height",e.style.height),t.style.backgroundColor="#E2E2E2",t.style.width=e.style.width,t.style.height=e.style.height,t.style.borderColor="#E2E2E2",t.id="copyLoadingView",t.style.background='url("'+A+'") center left no-repeat',t.style.display="flex",t.style.marginLeft="5px",t.style.content="",e.appendChild(t),t},closeLoading:function(e){e.removeChild(d.loadingView)}}},28411:function(e,t){var n=new(function(){function e(){this.type=null}var t=e.prototype;return t.getApp=function(e){return this.parseFromApp(e)},t.parseFromApp=function(e){e||(this.type=null);var t=null===e||void 0===e?void 0:e.getElementsByTagName("html")[0],n=null===t||void 0===t?void 0:t.getAttribute("xmlns:x");return this.type="excel","urn:schemas-microsoft-com:office:excel"===n?this.type="excel":"tencent"===n&&(this.type="tencent"),this.type},e}());t.Z=n},68134:function(e,t,n){n.d(t,{Ft:function(){return o},aB:function(){return r},zk:function(){return i}});var r=function(e,t,n){if(!e)return!1;var r=e.getMergeReference();return!!r&&r.startRowIndex===t&&r.startColIndex===n},o=function(e,t,n){if(!e)return!1;var r=e.getMergeReference();return!!r&&(r.startRowIndex!==t||r.startColIndex!==n)},i=function(e,t){for(var n=e.startRowIndex,r=e.startColIndex,o=e.endRowIndex,i=e.endColIndex,a=n;a<=o;a++)for(var l=r;l<=i;l++){var A=t.getCellDataAtPosition(a,l);if(A){var c=A.getMergeReference();if(c&&!e.contain(c))return!1}}return!0}},82143:function(e,t,n){n.d(t,{$X:function(){return c},Fb:function(){return d},Px:function(){return s},gh:function(){return u},nC:function(){return p}}),n(62883),n(52865),n(85932),n(20670),n(64425),n(71096),n(46396),n(8195);var r=n(55690),o=n(92034),i=n(22830),a=n.n(i),l=n(19068),A=n.n(l),c=function(e){return!!e.url&&!(Number(e.width)>0&&Number(e.height)>0)},u=function(e){var t=e.match(/cutShapeIDs[\S]+cutShapeIDs/);if(!t)return[];var n=t[0];return(n=n.replace(/cutShapeIDs/g,"")).split("|")};function s(e){var t=e.rowCount,n=e.colCount,i=e.range,a=e.sheet,l=e.view,c={};return a.imageManager.each((function(e){if(e.type!==r.EMBEDDED_OBJECT_TYPE.CELL_IMAGE){for(var u=e.position.overlayPosition.anchorCell.colIndex,s=e.position.overlayPosition.anchorCell.rowIndex,d=e.position.overlayPosition.offsetXpixels;d>=a.getColWidth(u)&&u<=n-1;)d-=a.getColWidth(u),u+=1;for(var p=e.position.overlayPosition.offsetYpixels,g=l.canvas.rowcolAccessor.getRowDisplayHeight(s);p>=g&&s<=t-1;)p-=g,s+=1;var v=function(e,t,n,r,i,a,l){var A=h(n),c=A.xStart,u=A.xEnd,s=A.yStart,d=A.yEnd;if(e>=s&&e<=d&&t>=c&&t<=u&&function(e,t,n,r,o,i,a){for(var l=h(e),A=l.xEnd,c=l.yEnd,u=!1,s=0,d=0,f=r;f<=c;f++)d+=a.canvas.rowcolAccessor.getRowDisplayHeight(f);for(var p=n;p<=A;p++)s+=a.canvas.rowcolAccessor.getColSetWidth(p);return d-=i,s-=o,t.position.overlayPosition.widthPixels<=s&&t.position.overlayPosition.heightPixels<=d&&(u=!0),u}(n,a,t,e,r,i,l)){var f={},p=e+"_"+t,g=Object.assign({},(0,o.Ir)(a));g.offset.x=r,g.offset.y=i;var v=[];return v.push(g),f[p]=v,f}}(s,u,i,d,p,e,l);A()(c,v,f)}})),c}function d(e){return e&&Object.keys(e).length>0}function f(e,t){if(a()(e))return e.concat(t)}function h(e){var t=e.xRange,n=e.yRange;return{xStart:t[0],xEnd:t[1],yStart:n[0],yEnd:n[1]}}function p(e,t){return!((e<=2||t<=2)&&e*t<=4)}},59538:function(e,t,n){n.d(t,{G:function(){return l},J:function(){return i}}),n(19553),n(38934),n(81144);var r=n(89882),o=n(89577);function i(e,t,n,r,o){if(!e)return"";var i=e.getColCount();i=a(i,t,o);var l=e.getRowCount();return' colspan="'+i+'" rowspan="'+(l=a(l,n,r))+'" '}var a=function(e,t,n){for(var r=e,o=t+r-1,i=t;i<=o;i++)(null===n||void 0===n?void 0:n[i])&&n[i].hiddenByUser&&(r-=1);return r},l=function(e){var t,n,i,a=e.cellData,l=e.hiddenRowMap,A=e.copyRange,c=e.x,u=e.y,s=e.rowData,d=e.copyType,f=null===a||void 0===a?void 0:a.getMergeReference();if(!f)return{newX:c,newY:u,newCellData:a,mergeReference:f};var h=(f=f.clone()).startColIndex,p=f.startRowIndex,g=(0,r.bF)({mergeReference:f,hiddenRowMap:l,copyRange:A,isCopyForOuter:!0,copyType:d}),v=g.xUnit,m=g.yUnit,y=g.x,E=g.y;return y===c&&E===u?(f=v>1||m>1?new o.Z("sheetid",E,E+m-1,y,y+v-1):null,t=h,i=s[n=p]?s[n].values[t]:null):f=null,{newX:t||c,newY:n||u,newCellData:i||a,mergeReference:f}}},54327:function(e,t,n){n.d(t,{L1:function(){return l},bU:function(){return i},eO:function(){return a}}),n(38934),n(77468),n(52865),n(20670),n(15770);var r=n(83246),o=n(31973);function i(e){var t=e.toString();if(-1!==t.toLowerCase().indexOf("pt"))return t;var n=parseFloat(t);return n=3*n/4,n=Math.round(10*n)/10,e?n+"pt":""}function a(e,t,n,i,a){var l=null===t||void 0===t?void 0:t.replace(/^\s+|\s+$/g,""),A=!(!e||!(0,r.lS)(e));if(e&&""!==e&&((0,r.Kc)(e)||A)||a&&a.length>0){var c="web";return A?c="sheet":a&&a.length>0&&(c="cell"),o.ZP.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set",ver11:"copy",ver10:c,ver12:-1===i?"word_type":"icon_type"}),{link:{url:e,value:l,type:n,linkIconStatus:i,hyperlinkRuns:a}}}return{}}var l=function(e){var t=e,n=t.indexOf(",");return-1!==n&&(t=t.slice(0,n)),'"'===t[0]&&(t=t.slice(1,t.length-1)),t.replace(/-webkit-standard|-webkit-body|-webkit-pictograph/g,"")}},31723:function(e,t,n){n.d(t,{i:function(){return i}});var r=n(85130),o=n(30516),i=function(e){var t=e.pasteData,n=e.cacheState,r=e.basicFilter,o=e.activeSheetId,i=e.cellImage,d=e.copyRange,f=e.pasteRanges,h=e.infoDimension,p=e.workbookRangeManager,g=e.isFormatPainter,v=e.isFomulaInCut,m=e.activeSheet;return!a(t)&&!(m.pivotTableManager.pivotTableMap.size>0)&&!l(o,n)&&!A(n)&&!r&&!c(i)&&!u(f,d,h)&&!s(p,d)&&!g&&!v},a=function(e){return e.fromType!==o.gN.COPY_CACHE},l=function(e,t){return e!==t.sheetId},A=function(e){return e.copyRangeIsChange},c=function(e){return e&&e.length>0},u=function(e,t,n){return!t||!!n&&!(!t.isCross(e[0])||!n.insertDimensionRanges)},s=function(e,t){return!t||(0,r.Up)(e,[t])}},11002:function(e,t,n){n.d(t,{Zp:function(){return i},e3:function(){return l},kb:function(){return a}}),n(8195),n(52865),n(85932);var r=n(83246),o=[n(8326).Z.getConfig("custom.standaloneDomains.qpic_cn")].concat((0,r.kq)());function i(e){return/^data:image\/(png|gif|jpeg|x-icon|jpg|tiff);base64,.+/i.test(e)}function a(e){var t,n=e.match('<img[^<>]*? src="([^<>]*?)"');return!(!(null===n||void 0===n?void 0:n[1])||l(n[1]))&&(t=n[1],!(-1!==o.indexOf(function(e){var t,n;return(n=e.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n?=]+)/im))&&(n=(t=n[1]).match(/^[^.]+\.(.+\..+)$/))&&(t=n[1]),t||""}(t)))||i(n[1]))}function l(e){return e.match(/^file:\/\/[/].+(gif|jpg|jpeg|tiff|png)$/i)}},41415:function(e,t,n){n.r(t),n.d(t,{hideToast:function(){return h},initToast:function(){return d},showToast:function(){return f},showVipToast:function(){return u}}),n(38934),n(48845),n(84919);var r=n(14831),o=n.n(r),i=n(40182),a=n(48237),l=n(43943),A=n(86022),c=null;function u(e){return new Promise((function(t){var r,o;(null===(r=n.g.SLR)||void 0===r?void 0:r.assetLoaded)?s(e,t):null===(o=n.g.SLR)||void 0===o||o.listen("SL-INIT",(function(){s(e,t)}))}))}function s(e,t){if(c)t(c.show(e));else{var n=o().isMobilePhone||o().isAndroidPad||o().isIPad?l.C.name:A.P.name;a.default.getExtension(n).then((function(n){t((c=n).show(e))}))}}n.g.showVipToast=u;var d=i.Bk,f=function(e,t,n,r){(0,i.Bk)().then((function(o){o.showToast(e,t,n,r)}))},h=function(){(0,i.Bk)().then((function(e){e.hideToast()}))}}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/2980.84c3aafa6165c481cb39.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=2980.84c3aafa6165c481cb39.js.map