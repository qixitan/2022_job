self.window=self,window.jsExecStartTimeStamp=Date.now(),(self.webpackChunk_tencent_alloy_builder_webpack_runner=self.webpackChunk_tencent_alloy_builder_webpack_runner||[]).push([[1600],{43706:function(e,t,r){r.d(t,{AD:function(){return y},D_:function(){return C},Fz:function(){return w},Pz:function(){return N},QS:function(){return M},R8:function(){return A},VT:function(){return T},de:function(){return S},hP:function(){return R},nx:function(){return _},zD:function(){return E},zH:function(){return I}}),r(95019),r(31575),r(27849),r(11425);var n=r(13504),a=r(58926),o=r(85952),i=(r(38934),r(48845),r(52865),r(75793),r(62883),r(20670),r(64425),r(84919),r(85932),r(77468),r(15770),r(19725),r(31688),r(19553),r(71091),r(81144),r(53923),r(33552),r(62077),r(8195),r(47794),r(45948),r(56500),r(66724),r(45845),r(91768),r(14422),r(74053),r(23976),r(78541),r(42056),r(84348),r(31771),r(74041),r(29553),r(79927),r(93134),r(54900),r(37732),r(16795),r(2657),r(93069),r(2951),r(98457),r(40480),r(10839),r(20726),r(10913),r(86019),r(41031),r(49502),r(89051),r(41901),r(71096),r(17302),r(13857),r(54371),r(5570),r(64656),r(43125),r(30980),r(16640),r(37108),r(28255),r(50104),r(25111),r(39585),r(77575),r(76880),r(11502),r(96434),r(3377),r(71318),r(21530),r(59677),r(14199),r(47917),r(48912),r(34797),r(2725),r(12522),r(56687),r(10635),r(89512),r(57625),r(41403),r(76252),r(69398),r(49245),r(15421),r(554),r(26894),r(90109),r(46396),r(79690),r(12024),r(81502),r(57447),r(31610),r(95232),r(50374),r(25594),r(93984),r(10012),r(74686),r(25136),r(62442),r(11904),r(91594),r(11376)),u=r(53536),s=r.n(u),l=r(61424);function c(){"use strict";c=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(C){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var a=t&&t.prototype instanceof d?t:d,o=Object.create(a.prototype),i=new T(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(a,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw o;return{value:void 0,done:!0}}for(r.method=a,r.arg=o;;){var i=r.delegate;if(i){var u=R(i,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(e,t,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(e,r,i),o}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(C){return{type:"throw",arg:C}}}e.wrap=s;var f={};function d(){}function h(){}function m(){}var g={};u(g,a,(function(){return this}));var p=Object.getPrototypeOf,v=p&&p(p(S([])));v&&v!==t&&r.call(v,a)&&(g=v);var y=m.prototype=d.prototype=Object.create(g);function N(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function n(a,o,i,u){var s=l(e[a],e,o);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(s.arg)}var a;this._invoke=function(e,r){function o(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(o,o):o()}}function R(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,R(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return h.prototype=m,u(y,"constructor",m),u(m,"constructor",h),h.displayName=u(m,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,i,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},N(M.prototype),u(M.prototype,o,(function(){return this})),e.AsyncIterator=M,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new M(s(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},N(y),u(y,i,"Generator"),u(y,a,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(u&&s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;_(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},e}function f(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"===typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=function(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{s(n.next(e))}catch(t){o(t)}}function u(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}s((n=n.apply(e,t||[])).next())}))},m={4277:function(e,t){t.kE=void 0;var r=/^\s*[+-]?\s*((\d+(\.\d+)?(e[+-]?\d+)?)|(0x[a-f\d]+))\s*$/i;t.kE=function(e){var t=typeof e;return("string"!==t||0!==e.toLowerCase().indexOf("0x"))&&("number"===t?!isNaN(e)&&isFinite(e):"string"===t?function(e){return 0!==e.toLowerCase().indexOf("0x")&&0!==e.length&&(1===e.length?/\d/.test(e):r.test(e))}(e):"object"===t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date))}},8177:function(e){e.exports=function(){var e="millisecond",t="second",r="minute",n="hour",a="day",o="week",i="month",u="quarter",s="year",l=/^(\d{4})[-/](\d{1,2})[-/](\d{0,2})([^0-9]+(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?)?(\+\d{1,4})?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},d={s:f,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),a=r%60;return(t<=0?"+":"-")+f(n,2,"0")+":"+f(a,2,"0")},m:function(e,t){var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,i),a=t-n<0,o=e.clone().add(r+(a?-1:1),i);return Number(-(r+(t-n)/(a?n-o:o-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return{M:i,y:s,w:o,d:a,h:n,m:r,s:t,ms:e,Q:u}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",g={};g[m]=h;var p=function(e){return e instanceof R},v=function(e,t,r){var n;if(!e)return m;if("string"==typeof e)g[e]&&(n=e),t&&(g[e]=t,n=e);else{var a=e.name;g[a]=e,n=a}return r||(m=n),n},y=function(e,t,r){if(p(e))return e.clone();var n=t?"string"==typeof t?{format:t,pl:r}:t:{};return n.date=e,new R(n)},N=d;N.l=v,N.i=p,N.w=function(e,t){return y(e,{locale:t.$L,utc:t.$u})};var M=function(e){var t=e.date,r=e.utc,n=e.autoIncrease;if(null===t)return new Date(NaN);if(N.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var a=t.match(l);if(a){if(n)return r?new Date(Date.UTC(a[1],a[2]-1,a[3]||1,a[5]||0,a[6]||0,a[7]||0,a[8]||0)):new Date(a[1],a[2]-1,a[3]||1,a[4]||0,a[5]||0,a[6]||0,a[7]||0);var o=function(){var e=new Date(arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5],arguments.length<=6?void 0:arguments[6]);return e.getFullYear()!==(arguments.length<=1?void 0:arguments[1])||e.getMonth()!==(arguments.length<=2?void 0:arguments[2])||e.getDate()!==(arguments.length<=3?void 0:arguments[3])||e.getHours()!==(arguments.length<=4?void 0:arguments[4])||e.getMinutes()!==(arguments.length<=5?void 0:arguments[5])||e.getSeconds()!==(arguments.length<=6?void 0:arguments[6])?null:e}(t,Number(a[1]),Number(a[2]-1),Number(a[3]||1),Number(a[5]||0),Number(a[6]||0),Number(a[7]||0));return o||new Date(NaN)}}return new Date(t)},R=function(){function l(e){this.$L=this.$L||v(e.locale,null,!0),this.parse(e)}var f=l.prototype;return f.parse=function(e){this.$d=M(e),this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return N},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(e,t){var r=y(e);return this.startOf(t)<=r&&r<=this.endOf(t)},f.isAfter=function(e,t){return y(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<y(e)},f.$g=function(e,t,r){return N.u(e)?this[t]:this.set(r,e)},f.year=function(e){return this.$g(e,"$y",s)},f.month=function(e){return this.$g(e,"$M",i)},f.day=function(e){return this.$g(e,"$W",a)},f.date=function(e){return this.$g(e,"$D","date")},f.hour=function(e){return this.$g(e,"$H",n)},f.minute=function(e){return this.$g(e,"$m",r)},f.second=function(e){return this.$g(e,"$s",t)},f.millisecond=function(t){return this.$g(t,"$ms",e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,u){var l=this,c=!!N.u(u)||u,f=N.p(e),d=function(e,t){var r=N.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return c?r:r.endOf(a)},h=function(e,t){return N.w(l.toDate()[e].apply(l.toDate(),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},m=this.$W,g=this.$M,p=this.$D,v="set"+(this.$u?"UTC":"");switch(f){case s:return c?d(1,0):d(31,11);case i:return c?d(1,g):d(0,g+1);case o:var y=this.$locale().weekStart||0,M=(m<y?m+7:m)-y;return d(c?p-M:p+(6-M),g);case a:case"date":return h(v+"Hours",0);case n:return h(v+"Minutes",1);case r:return h(v+"Seconds",2);case t:return h(v+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(o,u){var l,c=N.p(o),f="set"+(this.$u?"UTC":""),d=(l={},l[a]=f+"Date",l.date=f+"Date",l[i]=f+"Month",l[s]=f+"FullYear",l[n]=f+"Hours",l[r]=f+"Minutes",l[t]=f+"Seconds",l[e]=f+"Milliseconds",l)[c],h=c===a?this.$D+(u-this.$W):u;if(c===i||c===s){var m=this.clone().set("date",1);m.$d[d](h),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).toDate()}else d&&this.$d[d](h);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[N.p(e)]()},f.add=function(e,u){var l,c=this;e=Number(e);var f=N.p(u),d=function(t){var r=y(c);return N.w(r.date(r.date()+Math.round(t*e)),c)};if(f===i)return this.set(i,this.$M+e);if(f===s)return this.set(s,this.$y+e);if(f===a)return d(1);if(f===o)return d(7);var h=(l={},l[r]=6e4,l[n]=36e5,l[t]=1e3,l)[f]||1,m=this.valueOf()+e*h;return N.w(m,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=N.z(this),a=this.$locale(),o=this.$H,i=this.$m,u=this.$M,s=a.weekdays,l=a.months,f=function(e,n,a,o){return e&&(e[n]||e(t,r))||a[n].substr(0,o)},d=function(e){return N.s(o%12||12,e,"0")},h=a.meridiem||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:u+1,MM:N.s(u+1,2,"0"),MMM:f(a.monthsShort,u,l,3),MMMM:l[u]||l(this,r),D:this.$D,DD:N.s(this.$D,2,"0"),d:String(this.$W),dd:f(a.weekdaysMin,this.$W,s,2),ddd:f(a.weekdaysShort,this.$W,s,3),dddd:s[this.$W],H:String(o),HH:N.s(o,2,"0"),h:d(1),hh:d(2),a:h(o,i,!0),A:h(o,i,!1),m:String(i),mm:N.s(i,2,"0"),s:String(this.$s),ss:N.s(this.$s,2,"0"),SSS:N.s(this.$ms,3,"0"),Z:n};return r.replace(c,(function(e,t){return t||m[e]||n.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(e,l,c){var f,d=N.p(l),h=y(e),m=6e4*(h.utcOffset()-this.utcOffset()),g=this-h,p=N.m(this,h);return p=(f={},f[s]=p/12,f[i]=p,f[u]=p/3,f[o]=(g-m)/6048e5,f[a]=(g-m)/864e5,f[n]=g/36e5,f[r]=g/6e4,f[t]=g/1e3,f)[d]||g,c?p:N.a(p)},f.daysInMonth=function(){return this.endOf(i).$D},f.$locale=function(){return g[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var r=this.clone();return r.$L=v(e,t,!0),r},f.clone=function(){return N.w(this.toDate(),this)},f.toDate=function(){return new Date(this.$d)},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},l}();return y.prototype=R.prototype,y.extend=function(e,t){return e(t,R,y),y},y.locale=v,y.isDayjs=p,y.unix=function(e){return y(1e3*e)},y.en=g[m],y.Ls=g,y}()},9669:function(e,t,r){e.exports=r(1609)},5448:function(e,t,r){var n=r(4867),a=r(6026),o=r(5327),i=r(4109),u=r(7985),s=r(5061);e.exports=function(e){return new Promise((function(t,l){var c=e.data,f=e.headers;n.isFormData(c)&&delete f["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",m=e.auth.password||"";f.Authorization="Basic "+btoa(h+":"+m)}if(d.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:r,config:e,request:d};a(t,l,n),d=null}},d.onerror=function(){l(s("Network Error",e,null,d)),d=null},d.ontimeout=function(){l(s("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var g=r(4372),p=(e.withCredentials||u(e.url))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;p&&(f[e.xsrfHeaderName]=p)}if("setRequestHeader"in d&&n.forEach(f,(function(e,t){void 0===c&&"content-type"===t.toLowerCase()?delete f[t]:d.setRequestHeader(t,e)})),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){d&&(d.abort(),l(e),d=null)})),void 0===c&&(c=null),d.send(c)}))}},1609:function(e,t,r){var n=r(4867),a=r(1849),o=r(321),i=r(5655);function u(e){var t=new o(e),r=a(o.prototype.request,t);return n.extend(r,o.prototype,t),n.extend(r,t),r}var s=u(i);s.Axios=o,s.create=function(e){return u(n.merge(i,e))},s.Cancel=r(5263),s.CancelToken=r(4972),s.isCancel=r(6502),s.all=function(e){return Promise.all(e)},s.spread=r(8713),e.exports=s,e.exports.default=s},5263:function(e){function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:function(e,t,r){var n=r(5263);function a(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}a.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},a.source=function(){var e;return{token:new a((function(t){e=t})),cancel:e}},e.exports=a},6502:function(e){e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:function(e,t,r){var n=r(5655),a=r(4867),o=r(782),i=r(3572);function u(e){this.defaults=e,this.interceptors={request:new o,response:new o}}u.prototype.request=function(e){"string"==typeof e&&(e=a.merge({url:arguments[0]},arguments[1])),(e=a.merge(n,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[i,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},a.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a.merge(r||{},{method:e,url:t}))}})),a.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,n){return this.request(a.merge(n||{},{method:e,url:t,data:r}))}})),e.exports=u},782:function(e,t,r){var n=r(4867);function a(){this.handlers=[]}a.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},a.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},a.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=a},5061:function(e,t,r){var n=r(481);e.exports=function(e,t,r,a,o){var i=new Error(e);return n(i,t,r,a,o)}},3572:function(e,t,r){var n=r(4867),a=r(8527),o=r(6502),i=r(5655),u=r(1793),s=r(7303);function l(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return l(e),e.baseURL&&!u(e.url)&&(e.url=s(e.baseURL,e.url)),e.headers=e.headers||{},e.data=a(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||i.adapter)(e).then((function(t){return l(e),t.data=a(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(l(e),t&&t.response&&(t.response.data=a(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:function(e){e.exports=function(e,t,r,n,a){return e.config=t,r&&(e.code=r),e.request=n,e.response=a,e}},6026:function(e,t,r){var n=r(5061);e.exports=function(e,t,r){var a=r.config.validateStatus;r.status&&a&&!a(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},8527:function(e,t,r){var n=r(4867);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},5655:function(e,t,r){var n=r(4867),a=r(6016),o={"Content-Type":"application/x-www-form-urlencoded"};function i(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u,s={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process)&&(u=r(5448)),u),transformRequest:[function(e,t){return a(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(i(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(i(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){s.headers[e]=n.merge(o)})),e.exports=s},1849:function(e){e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},5327:function(e,t,r){var n=r(4867);function a(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var i=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),i.push(a(t)+"="+a(e))})))})),o=i.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},7303:function(e){e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:function(e,t,r){var n=r(4867);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,a,o,i){var u=[];u.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),n.isString(a)&&u.push("path="+a),n.isString(o)&&u.push("domain="+o),!0===i&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:function(e){e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},7985:function(e,t,r){var n=r(4867);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function a(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=a(window.location.href),function(t){var r=n.isString(t)?a(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},6016:function(e,t,r){var n=r(4867);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},4109:function(e,t,r){var n=r(4867),a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,i={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(i[t]&&a.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i}},8713:function(e){e.exports=function(e){return function(t){return e.apply(null,t)}}},4867:function(e,t,r){var n=r(1849),a=r(8738),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function u(e){return null!==e&&"object"==typeof e}function s(e){return"[object Function]"===o.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:a,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:s,isStream:function(e){return u(e)&&s(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function r(r,n){"object"==typeof t[n]&&"object"==typeof r?t[n]=e(t[n],r):t[n]=r}for(var n=0,a=arguments.length;n<a;n++)l(arguments[n],r);return t},extend:function(e,t,r){return l(t,(function(t,a){e[a]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},3776:function(e,t,r){var n;!function(a){var o,i,u,s=9e15,l=1e9,c="0123456789abcdef",f="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",d="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",h={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-s,maxE:s,crypto:!1},m=!0,g="[DecimalError] ",p=g+"Invalid argument: ",v=g+"Precision limit exceeded",y=g+"crypto unavailable",N="[object Decimal]",M=Math.floor,R=Math.pow,E=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,_=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,T=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,S=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,I=1e7,C=f.length-1,A=d.length-1,w={toStringTag:N};function x(e){var t,r,n,a=e.length-1,o="",i=e[0];if(a>0){for(o+=i,t=1;t<a;t++)(r=7-(n=e[t]+"").length)&&(o+=G(r)),o+=n;(r=7-(n=(i=e[t])+"").length)&&(o+=G(r))}else if(0===i)return"0";for(;i%10==0;)i/=10;return o+i}function D(e,t,r){if(e!==~~e||e<t||e>r)throw Error(p+e)}function b(e,t,r,n){var a,o,i,u;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=7,a=0):(a=Math.ceil((t+1)/7),t%=7),o=R(10,7-t),u=e[a]%o|0,null==n?t<3?(0==t?u=u/100|0:1==t&&(u=u/10|0),i=r<4&&99999==u||r>3&&49999==u||5e4==u||0==u):i=(r<4&&u+1==o||r>3&&u+1==o/2)&&(e[a+1]/o/100|0)==R(10,t-2)-1||(u==o/2||0==u)&&0==(e[a+1]/o/100|0):t<4?(0==t?u=u/1e3|0:1==t?u=u/100|0:2==t&&(u=u/10|0),i=(n||r<4)&&9999==u||!n&&r>3&&4999==u):i=((n||r<4)&&u+1==o||!n&&r>3&&u+1==o/2)&&(e[a+1]/o/1e3|0)==R(10,t-3)-1,i}function O(e,t,r){for(var n,a,o=[0],i=0,u=e.length;i<u;){for(a=o.length;a--;)o[a]*=t;for(o[0]+=c.indexOf(e.charAt(i++)),n=0;n<o.length;n++)o[n]>r-1&&(void 0===o[n+1]&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}w.absoluteValue=w.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),L(e)},w.ceil=function(){return L(new this.constructor(this),this.e+1,2)},w.clampedTo=w.clamp=function(e,t){var r=this,n=r.constructor;if(e=new n(e),t=new n(t),!e.s||!t.s)return new n(NaN);if(e.gt(t))throw Error(p+t);return r.cmp(e)<0?e:r.cmp(t)>0?t:new n(r)},w.comparedTo=w.cmp=function(e){var t,r,n,a,o=this,i=o.d,u=(e=new o.constructor(e)).d,s=o.s,l=e.s;if(!i||!u)return s&&l?s!==l?s:i===u?0:!i^s<0?1:-1:NaN;if(!i[0]||!u[0])return i[0]?s:u[0]?-l:0;if(s!==l)return s;if(o.e!==e.e)return o.e>e.e^s<0?1:-1;for(t=0,r=(n=i.length)<(a=u.length)?n:a;t<r;++t)if(i[t]!==u[t])return i[t]>u[t]^s<0?1:-1;return n===a?0:n>a^s<0?1:-1},w.cosine=w.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(e,t){var r,n,a;if(t.isZero())return t;(n=t.d.length)<32?a=(1/z(4,r=Math.ceil(n/3))).toString():(r=16,a="2.3283064365386962890625e-10"),e.precision+=r,t=q(e,1,t.times(a),new e(1));for(var o=r;o--;){var i=t.times(t);t=i.times(i).minus(i).times(8).plus(1)}return e.precision-=r,t}(n,J(n,r)),n.precision=e,n.rounding=t,L(2==u||3==u?r.neg():r,e,t,!0)):new n(1):new n(NaN)},w.cubeRoot=w.cbrt=function(){var e,t,r,n,a,o,i,u,s,l,c=this,f=c.constructor;if(!c.isFinite()||c.isZero())return new f(c);for(m=!1,(o=c.s*R(c.s*c,1/3))&&Math.abs(o)!=1/0?n=new f(o.toString()):(r=x(c.d),(o=((e=c.e)-r.length+1)%3)&&(r+=1==o||-2==o?"0":"00"),o=R(r,1/3),e=M((e+1)/3)-(e%3==(e<0?-1:2)),(n=new f(r=o==1/0?"5e"+e:(r=o.toExponential()).slice(0,r.indexOf("e")+1)+e)).s=c.s),i=(e=f.precision)+3;;)if(l=(s=(u=n).times(u).times(u)).plus(c),n=F(l.plus(c).times(u),l.plus(s),i+2,1),x(u.d).slice(0,i)===(r=x(n.d)).slice(0,i)){if("9999"!=(r=r.slice(i-3,i+1))&&(a||"4999"!=r)){+r&&(+r.slice(1)||"5"!=r.charAt(0))||(L(n,e+1,1),t=!n.times(n).times(n).eq(c));break}if(!a&&(L(u,e+1,0),u.times(u).times(u).eq(c))){n=u;break}i+=4,a=1}return m=!0,L(n,e,f.rounding,t)},w.decimalPlaces=w.dp=function(){var e,t=this.d,r=NaN;if(t){if(r=7*((e=t.length-1)-M(this.e/7)),e=t[e])for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r},w.dividedBy=w.div=function(e){return F(this,new this.constructor(e))},w.dividedToIntegerBy=w.divToInt=function(e){var t=this.constructor;return L(F(this,new t(e),0,1,1),t.precision,t.rounding)},w.equals=w.eq=function(e){return 0===this.cmp(e)},w.floor=function(){return L(new this.constructor(this),this.e+1,3)},w.greaterThan=w.gt=function(e){return this.cmp(e)>0},w.greaterThanOrEqualTo=w.gte=function(e){var t=this.cmp(e);return 1==t||0===t},w.hyperbolicCosine=w.cosh=function(){var e,t,r,n,a,o=this,i=o.constructor,u=new i(1);if(!o.isFinite())return new i(o.s?1/0:NaN);if(o.isZero())return u;r=i.precision,n=i.rounding,i.precision=r+Math.max(o.e,o.sd())+4,i.rounding=1,(a=o.d.length)<32?t=(1/z(4,e=Math.ceil(a/3))).toString():(e=16,t="2.3283064365386962890625e-10"),o=q(i,1,o.times(t),new i(1),!0);for(var s,l=e,c=new i(8);l--;)s=o.times(o),o=u.minus(s.times(c.minus(s.times(c))));return L(o,i.precision=r,i.rounding=n,!0)},w.hyperbolicSine=w.sinh=function(){var e,t,r,n,a=this,o=a.constructor;if(!a.isFinite()||a.isZero())return new o(a);if(t=o.precision,r=o.rounding,o.precision=t+Math.max(a.e,a.sd())+4,o.rounding=1,(n=a.d.length)<3)a=q(o,2,a,a,!0);else{e=(e=1.4*Math.sqrt(n))>16?16:0|e,a=q(o,2,a=a.times(1/z(5,e)),a,!0);for(var i,u=new o(5),s=new o(16),l=new o(20);e--;)i=a.times(a),a=a.times(u.plus(i.times(s.times(i).plus(l))))}return o.precision=t,o.rounding=r,L(a,t,r,!0)},w.hyperbolicTangent=w.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,F(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)},w.inverseCosine=w.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),a=r.precision,o=r.rounding;return-1!==n?0===n?t.isNeg()?P(r,a,o):new r(0):new r(NaN):t.isZero()?P(r,a+4,o).times(.5):(r.precision=a+6,r.rounding=1,t=t.asin(),e=P(r,a+4,o).times(.5),r.precision=a,r.rounding=o,e.minus(t))},w.inverseHyperbolicCosine=w.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,m=!1,r=r.times(r).minus(1).sqrt().plus(r),m=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)},w.inverseHyperbolicSine=w.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,m=!1,r=r.times(r).plus(1).sqrt().plus(r),m=!0,n.precision=e,n.rounding=t,r.ln())},w.inverseHyperbolicTangent=w.atanh=function(){var e,t,r,n,a=this,o=a.constructor;return a.isFinite()?a.e>=0?new o(a.abs().eq(1)?a.s/0:a.isZero()?a:NaN):(e=o.precision,t=o.rounding,n=a.sd(),Math.max(n,e)<2*-a.e-1?L(new o(a),e,t,!0):(o.precision=r=n-a.e,a=F(a.plus(1),new o(1).minus(a),r+e,1),o.precision=e+4,o.rounding=1,a=a.ln(),o.precision=e,o.rounding=t,a.times(.5))):new o(NaN)},w.inverseSine=w.asin=function(){var e,t,r,n,a=this,o=a.constructor;return a.isZero()?new o(a):(t=a.abs().cmp(1),r=o.precision,n=o.rounding,-1!==t?0===t?((e=P(o,r+4,n).times(.5)).s=a.s,e):new o(NaN):(o.precision=r+6,o.rounding=1,a=a.div(new o(1).minus(a.times(a)).sqrt().plus(1)).atan(),o.precision=r,o.rounding=n,a.times(2)))},w.inverseTangent=w.atan=function(){var e,t,r,n,a,o,i,u,s,l=this,c=l.constructor,f=c.precision,d=c.rounding;if(l.isFinite()){if(l.isZero())return new c(l);if(l.abs().eq(1)&&f+4<=A)return(i=P(c,f+4,d).times(.25)).s=l.s,i}else{if(!l.s)return new c(NaN);if(f+4<=A)return(i=P(c,f+4,d).times(.5)).s=l.s,i}for(c.precision=u=f+10,c.rounding=1,e=r=Math.min(28,u/7+2|0);e;--e)l=l.div(l.times(l).plus(1).sqrt().plus(1));for(m=!1,t=Math.ceil(u/7),n=1,s=l.times(l),i=new c(l),a=l;-1!==e;)if(a=a.times(s),o=i.minus(a.div(n+=2)),a=a.times(s),void 0!==(i=o.plus(a.div(n+=2))).d[t])for(e=t;i.d[e]===o.d[e]&&e--;);return r&&(i=i.times(2<<r-1)),m=!0,L(i,c.precision=f,c.rounding=d,!0)},w.isFinite=function(){return!!this.d},w.isInteger=w.isInt=function(){return!!this.d&&M(this.e/7)>this.d.length-2},w.isNaN=function(){return!this.s},w.isNegative=w.isNeg=function(){return this.s<0},w.isPositive=w.isPos=function(){return this.s>0},w.isZero=function(){return!!this.d&&0===this.d[0]},w.lessThan=w.lt=function(e){return this.cmp(e)<0},w.lessThanOrEqualTo=w.lte=function(e){return this.cmp(e)<1},w.logarithm=w.log=function(e){var t,r,n,a,o,i,u,s,l=this,c=l.constructor,f=c.precision,d=c.rounding;if(null==e)e=new c(10),t=!0;else{if(r=(e=new c(e)).d,e.s<0||!r||!r[0]||e.eq(1))return new c(NaN);t=e.eq(10)}if(r=l.d,l.s<0||!r||!r[0]||l.eq(1))return new c(r&&!r[0]?-1/0:1!=l.s?NaN:r?0:1/0);if(t)if(r.length>1)o=!0;else{for(a=r[0];a%10==0;)a/=10;o=1!==a}if(m=!1,i=Z(l,u=f+5),n=t?k(c,u+10):Z(e,u),b((s=F(i,n,u,1)).d,a=f,d))do{if(i=Z(l,u+=10),n=t?k(c,u+10):Z(e,u),s=F(i,n,u,1),!o){+x(s.d).slice(a+1,a+15)+1==1e14&&(s=L(s,f+1,0));break}}while(b(s.d,a+=10,d));return m=!0,L(s,f,d)},w.minus=w.sub=function(e){var t,r,n,a,o,i,u,s,l,c,f,d,h=this,g=h.constructor;if(e=new g(e),!h.d||!e.d)return h.s&&e.s?h.d?e.s=-e.s:e=new g(e.d||h.s!==e.s?h:NaN):e=new g(NaN),e;if(h.s!=e.s)return e.s=-e.s,h.plus(e);if(l=h.d,d=e.d,u=g.precision,s=g.rounding,!l[0]||!d[0]){if(d[0])e.s=-e.s;else{if(!l[0])return new g(3===s?-0:0);e=new g(h)}return m?L(e,u,s):e}if(r=M(e.e/7),c=M(h.e/7),l=l.slice(),o=c-r){for((f=o<0)?(t=l,o=-o,i=d.length):(t=d,r=c,i=l.length),o>(n=Math.max(Math.ceil(u/7),i)+2)&&(o=n,t.length=1),t.reverse(),n=o;n--;)t.push(0);t.reverse()}else{for((f=(n=l.length)<(i=d.length))&&(i=n),n=0;n<i;n++)if(l[n]!=d[n]){f=l[n]<d[n];break}o=0}for(f&&(t=l,l=d,d=t,e.s=-e.s),i=l.length,n=d.length-i;n>0;--n)l[i++]=0;for(n=d.length;n>o;){if(l[--n]<d[n]){for(a=n;a&&0===l[--a];)l[a]=I-1;--l[a],l[n]+=I}l[n]-=d[n]}for(;0===l[--i];)l.pop();for(;0===l[0];l.shift())--r;return l[0]?(e.d=l,e.e=B(l,r),m?L(e,u,s):e):new g(3===s?-0:0)},w.modulo=w.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?L(new n(r),n.precision,n.rounding):(m=!1,9==n.modulo?(t=F(r,e.abs(),0,3,1)).s*=e.s:t=F(r,e,0,n.modulo,1),t=t.times(e),m=!0,r.minus(t))},w.naturalExponential=w.exp=function(){return j(this)},w.naturalLogarithm=w.ln=function(){return Z(this)},w.negated=w.neg=function(){var e=new this.constructor(this);return e.s=-e.s,L(e)},w.plus=w.add=function(e){var t,r,n,a,o,i,u,s,l,c,f=this,d=f.constructor;if(e=new d(e),!f.d||!e.d)return f.s&&e.s?f.d||(e=new d(e.d||f.s===e.s?f:NaN)):e=new d(NaN),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(l=f.d,c=e.d,u=d.precision,s=d.rounding,!l[0]||!c[0])return c[0]||(e=new d(f)),m?L(e,u,s):e;if(o=M(f.e/7),n=M(e.e/7),l=l.slice(),a=o-n){for(a<0?(r=l,a=-a,i=c.length):(r=c,n=o,i=l.length),a>(i=(o=Math.ceil(u/7))>i?o+1:i+1)&&(a=i,r.length=1),r.reverse();a--;)r.push(0);r.reverse()}for((i=l.length)-(a=c.length)<0&&(a=i,r=c,c=l,l=r),t=0;a;)t=(l[--a]=l[a]+c[a]+t)/I|0,l[a]%=I;for(t&&(l.unshift(t),++n),i=l.length;0==l[--i];)l.pop();return e.d=l,e.e=B(l,n),m?L(e,u,s):e},w.precision=w.sd=function(e){var t,r=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(p+e);return r.d?(t=H(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t},w.round=function(){var e=this,t=e.constructor;return L(new t(e),e.e+1,t.rounding)},w.sine=w.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+7,n.rounding=1,r=function(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:q(e,2,t,t);r=(r=1.4*Math.sqrt(n))>16?16:0|r,t=q(e,2,t=t.times(1/z(5,r)),t);for(var a,o=new e(5),i=new e(16),u=new e(20);r--;)a=t.times(t),t=t.times(o.plus(a.times(i.times(a).minus(u))));return t}(n,J(n,r)),n.precision=e,n.rounding=t,L(u>2?r.neg():r,e,t,!0)):new n(NaN)},w.squareRoot=w.sqrt=function(){var e,t,r,n,a,o,i=this,u=i.d,s=i.e,l=i.s,c=i.constructor;if(1!==l||!u||!u[0])return new c(!l||l<0&&(!u||u[0])?NaN:u?i:1/0);for(m=!1,0==(l=Math.sqrt(+i))||l==1/0?(((t=x(u)).length+s)%2==0&&(t+="0"),l=Math.sqrt(t),s=M((s+1)/2)-(s<0||s%2),n=new c(t=l==1/0?"5e"+s:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+s)):n=new c(l.toString()),r=(s=c.precision)+3;;)if(n=(o=n).plus(F(i,o,r+2,1)).times(.5),x(o.d).slice(0,r)===(t=x(n.d)).slice(0,r)){if("9999"!=(t=t.slice(r-3,r+1))&&(a||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(L(n,s+1,1),e=!n.times(n).eq(i));break}if(!a&&(L(o,s+1,0),o.times(o).eq(i))){n=o;break}r+=4,a=1}return m=!0,L(n,s,c.rounding,e)},w.tangent=w.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,(r=r.sin()).s=1,r=F(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,L(2==u||4==u?r.neg():r,e,t,!0)):new n(NaN)},w.times=w.mul=function(e){var t,r,n,a,o,i,u,s,l,c=this,f=c.constructor,d=c.d,h=(e=new f(e)).d;if(e.s*=c.s,!(d&&d[0]&&h&&h[0]))return new f(!e.s||d&&!d[0]&&!h||h&&!h[0]&&!d?NaN:d&&h?0*e.s:e.s/0);for(r=M(c.e/7)+M(e.e/7),(s=d.length)<(l=h.length)&&(o=d,d=h,h=o,i=s,s=l,l=i),o=[],n=i=s+l;n--;)o.push(0);for(n=l;--n>=0;){for(t=0,a=s+n;a>n;)u=o[a]+h[n]*d[a-n-1]+t,o[a--]=u%I|0,t=u/I|0;o[a]=(o[a]+t)%I|0}for(;!o[--i];)o.pop();return t?++r:o.shift(),e.d=o,e.e=B(o,r),m?L(e,f.precision,f.rounding):e},w.toBinary=function(e,t){return Q(this,2,e,t)},w.toDecimalPlaces=w.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),void 0===e?r:(D(e,0,l),void 0===t?t=n.rounding:D(t,0,8),L(r,e+r.e+1,t))},w.toExponential=function(e,t){var r,n=this,a=n.constructor;return void 0===e?r=U(n,!0):(D(e,0,l),void 0===t?t=a.rounding:D(t,0,8),r=U(n=L(new a(n),e+1,t),!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r},w.toFixed=function(e,t){var r,n,a=this,o=a.constructor;return void 0===e?r=U(a):(D(e,0,l),void 0===t?t=o.rounding:D(t,0,8),r=U(n=L(new o(a),e+a.e+1,t),!1,e+n.e+1)),a.isNeg()&&!a.isZero()?"-"+r:r},w.toFraction=function(e){var t,r,n,a,o,i,u,s,l,c,f,d,h=this,g=h.d,v=h.constructor;if(!g)return new v(h);if(l=r=new v(1),n=s=new v(0),i=(o=(t=new v(n)).e=H(g)-h.e-1)%7,t.d[0]=R(10,i<0?7+i:i),null==e)e=o>0?t:l;else{if(!(u=new v(e)).isInt()||u.lt(l))throw Error(p+u);e=u.gt(t)?o>0?t:l:u}for(m=!1,u=new v(x(g)),c=v.precision,v.precision=o=7*g.length*2;f=F(u,t,0,1,1),1!=(a=r.plus(f.times(n))).cmp(e);)r=n,n=a,a=l,l=s.plus(f.times(a)),s=a,a=t,t=u.minus(f.times(a)),u=a;return a=F(e.minus(r),n,0,1,1),s=s.plus(a.times(l)),r=r.plus(a.times(n)),s.s=l.s=h.s,d=F(l,n,o,1).minus(h).abs().cmp(F(s,r,o,1).minus(h).abs())<1?[l,n]:[s,r],v.precision=c,m=!0,d},w.toHexadecimal=w.toHex=function(e,t){return Q(this,16,e,t)},w.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),null==e){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),void 0===t?t=n.rounding:D(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(m=!1,r=F(r,e,0,t,1).times(e),m=!0,L(r)):(e.s=r.s,r=e),r},w.toNumber=function(){return+this},w.toOctal=function(e,t){return Q(this,8,e,t)},w.toPower=w.pow=function(e){var t,r,n,a,o,i,u=this,s=u.constructor,l=+(e=new s(e));if(!(u.d&&e.d&&u.d[0]&&e.d[0]))return new s(R(+u,l));if((u=new s(u)).eq(1))return u;if(n=s.precision,o=s.rounding,e.eq(1))return L(u,n,o);if((t=M(e.e/7))>=e.d.length-1&&(r=l<0?-l:l)<=9007199254740991)return a=Y(s,u,r,n),e.s<0?new s(1).div(a):L(a,n,o);if((i=u.s)<0){if(t<e.d.length-1)return new s(NaN);if(0==(1&e.d[t])&&(i=1),0==u.e&&1==u.d[0]&&1==u.d.length)return u.s=i,u}return(t=0!=(r=R(+u,l))&&isFinite(r)?new s(r+"").e:M(l*(Math.log("0."+x(u.d))/Math.LN10+u.e+1)))>s.maxE+1||t<s.minE-1?new s(t>0?i/0:0):(m=!1,s.rounding=u.s=1,r=Math.min(12,(t+"").length),(a=j(e.times(Z(u,n+r)),n)).d&&b((a=L(a,n+5,1)).d,n,o)&&(t=n+10,+x((a=L(j(e.times(Z(u,t+r)),t),t+5,1)).d).slice(n+1,n+15)+1==1e14&&(a=L(a,n+1,0))),a.s=i,m=!0,s.rounding=o,L(a,n,o))},w.toPrecision=function(e,t){var r,n=this,a=n.constructor;return void 0===e?r=U(n,n.e<=a.toExpNeg||n.e>=a.toExpPos):(D(e,1,l),void 0===t?t=a.rounding:D(t,0,8),r=U(n=L(new a(n),e,t),e<=n.e||n.e<=a.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r},w.toSignificantDigits=w.toSD=function(e,t){var r=this.constructor;return void 0===e?(e=r.precision,t=r.rounding):(D(e,1,l),void 0===t?t=r.rounding:D(t,0,8)),L(new r(this),e,t)},w.toString=function(){var e=this,t=e.constructor,r=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r},w.truncated=w.trunc=function(){return L(new this.constructor(this),this.e+1,1)},w.valueOf=w.toJSON=function(){var e=this,t=e.constructor,r=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};var F=function(){function e(e,t,r){var n,a=0,o=e.length;for(e=e.slice();o--;)n=e[o]*t+a,e[o]=n%r|0,a=n/r|0;return a&&e.unshift(a),e}function t(e,t,r,n){var a,o;if(r!=n)o=r>n?1:-1;else for(a=o=0;a<r;a++)if(e[a]!=t[a]){o=e[a]>t[a]?1:-1;break}return o}function r(e,t,r,n){for(var a=0;r--;)e[r]-=a,a=e[r]<t[r]?1:0,e[r]=a*n+e[r]-t[r];for(;!e[0]&&e.length>1;)e.shift()}return function(n,a,o,u,s,l){var c,f,d,h,m,g,p,v,y,N,R,E,_,T,S,C,A,w,x,D,b=n.constructor,O=n.s==a.s?1:-1,F=n.d,U=a.d;if(!(F&&F[0]&&U&&U[0]))return new b(n.s&&a.s&&(F?!U||F[0]!=U[0]:U)?F&&0==F[0]||!U?0*O:O/0:NaN);for(l?(m=1,f=n.e-a.e):(l=I,m=7,f=M(n.e/m)-M(a.e/m)),x=U.length,A=F.length,N=(y=new b(O)).d=[],d=0;U[d]==(F[d]||0);d++);if(U[d]>(F[d]||0)&&f--,null==o?(T=o=b.precision,u=b.rounding):T=s?o+(n.e-a.e)+1:o,T<0)N.push(1),g=!0;else{if(T=T/m+2|0,d=0,1==x){for(h=0,U=U[0],T++;(d<A||h)&&T--;d++)S=h*l+(F[d]||0),N[d]=S/U|0,h=S%U|0;g=h||d<A}else{for((h=l/(U[0]+1)|0)>1&&(U=e(U,h,l),F=e(F,h,l),x=U.length,A=F.length),C=x,E=(R=F.slice(0,x)).length;E<x;)R[E++]=0;(D=U.slice()).unshift(0),w=U[0],U[1]>=l/2&&++w;do{h=0,(c=t(U,R,x,E))<0?(_=R[0],x!=E&&(_=_*l+(R[1]||0)),(h=_/w|0)>1?(h>=l&&(h=l-1),1==(c=t(p=e(U,h,l),R,v=p.length,E=R.length))&&(h--,r(p,x<v?D:U,v,l))):(0==h&&(c=h=1),p=U.slice()),(v=p.length)<E&&p.unshift(0),r(R,p,E,l),-1==c&&(c=t(U,R,x,E=R.length))<1&&(h++,r(R,x<E?D:U,E,l)),E=R.length):0===c&&(h++,R=[0]),N[d++]=h,c&&R[0]?R[E++]=F[C]||0:(R=[F[C]],E=1)}while((C++<A||void 0!==R[0])&&T--);g=void 0!==R[0]}N[0]||N.shift()}if(1==m)y.e=f,i=g;else{for(d=1,h=N[0];h>=10;h/=10)d++;y.e=d+f*m-1,L(y,s?o+y.e+1:o,u,g)}return y}}();function L(e,t,r,n){var a,o,i,u,s,l,c,f,d,h=e.constructor;e:if(null!=t){if(!(f=e.d))return e;for(a=1,u=f[0];u>=10;u/=10)a++;if((o=t-a)<0)o+=7,i=t,s=(c=f[d=0])/R(10,a-i-1)%10|0;else if((d=Math.ceil((o+1)/7))>=(u=f.length)){if(!n)break e;for(;u++<=d;)f.push(0);c=s=0,a=1,i=(o%=7)-7+1}else{for(c=u=f[d],a=1;u>=10;u/=10)a++;s=(i=(o%=7)-7+a)<0?0:c/R(10,a-i-1)%10|0}if(n=n||t<0||void 0!==f[d+1]||(i<0?c:c%R(10,a-i-1)),l=r<4?(s||n)&&(0==r||r==(e.s<0?3:2)):s>5||5==s&&(4==r||n||6==r&&(o>0?i>0?c/R(10,a-i):0:f[d-1])%10&1||r==(e.s<0?8:7)),t<1||!f[0])return f.length=0,l?(t-=e.e+1,f[0]=R(10,(7-t%7)%7),e.e=-t||0):f[0]=e.e=0,e;if(0==o?(f.length=d,u=1,d--):(f.length=d+1,u=R(10,7-o),f[d]=i>0?(c/R(10,a-i)%R(10,i)|0)*u:0),l)for(;;){if(0==d){for(o=1,i=f[0];i>=10;i/=10)o++;for(i=f[0]+=u,u=1;i>=10;i/=10)u++;o!=u&&(e.e++,f[0]==I&&(f[0]=1));break}if(f[d]+=u,f[d]!=I)break;f[d--]=0,u=1}for(o=f.length;0===f[--o];)f.pop()}return m&&(e.e>h.maxE?(e.d=null,e.e=NaN):e.e<h.minE&&(e.e=0,e.d=[0])),e}function U(e,t,r){if(!e.isFinite())return W(e);var n,a=e.e,o=x(e.d),i=o.length;return t?(r&&(n=r-i)>0?o=o.charAt(0)+"."+o.slice(1)+G(n):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):a<0?(o="0."+G(-a-1)+o,r&&(n=r-i)>0&&(o+=G(n))):a>=i?(o+=G(a+1-i),r&&(n=r-a-1)>0&&(o=o+"."+G(n))):((n=a+1)<i&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-i)>0&&(a+1===i&&(o+="."),o+=G(n))),o}function B(e,t){var r=e[0];for(t*=7;r>=10;r/=10)t++;return t}function k(e,t,r){if(t>C)throw m=!0,r&&(e.precision=r),Error(v);return L(new e(f),t,1,!0)}function P(e,t,r){if(t>A)throw Error(v);return L(new e(d),t,r,!0)}function H(e){var t=e.length-1,r=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function G(e){for(var t="";e--;)t+="0";return t}function Y(e,t,r,n){var a,o=new e(1),i=Math.ceil(n/7+4);for(m=!1;;){if(r%2&&ee((o=o.times(t)).d,i)&&(a=!0),0===(r=M(r/2))){r=o.d.length-1,a&&0===o.d[r]&&++o.d[r];break}ee((t=t.times(t)).d,i)}return m=!0,o}function V(e){return 1&e.d[e.d.length-1]}function $(e,t,r){for(var n,a=new e(t[0]),o=0;++o<t.length;){if(!(n=new e(t[o])).s){a=n;break}a[r](n)&&(a=n)}return a}function j(e,t){var r,n,a,o,i,u,s,l=0,c=0,f=0,d=e.constructor,h=d.rounding,g=d.precision;if(!e.d||!e.d[0]||e.e>17)return new d(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(m=!1,s=g):s=t,u=new d(.03125);e.e>-2;)e=e.times(u),f+=5;for(s+=n=Math.log(R(2,f))/Math.LN10*2+5|0,r=o=i=new d(1),d.precision=s;;){if(o=L(o.times(e),s,1),r=r.times(++c),x((u=i.plus(F(o,r,s,1))).d).slice(0,s)===x(i.d).slice(0,s)){for(a=f;a--;)i=L(i.times(i),s,1);if(null!=t)return d.precision=g,i;if(!(l<3&&b(i.d,s-n,h,l)))return L(i,d.precision=g,h,m=!0);d.precision=s+=10,r=o=u=new d(1),c=0,l++}i=u}}function Z(e,t){var r,n,a,o,i,u,s,l,c,f,d,h=1,g=e,p=g.d,v=g.constructor,y=v.rounding,N=v.precision;if(g.s<0||!p||!p[0]||!g.e&&1==p[0]&&1==p.length)return new v(p&&!p[0]?-1/0:1!=g.s?NaN:p?0:g);if(null==t?(m=!1,c=N):c=t,v.precision=c+=10,n=(r=x(p)).charAt(0),!(Math.abs(o=g.e)<15e14))return l=k(v,c+2,N).times(o+""),g=Z(new v(n+"."+r.slice(1)),c-10).plus(l),v.precision=N,null==t?L(g,N,y,m=!0):g;for(;n<7&&1!=n||1==n&&r.charAt(1)>3;)n=(r=x((g=g.times(e)).d)).charAt(0),h++;for(o=g.e,n>1?(g=new v("0."+r),o++):g=new v(n+"."+r.slice(1)),f=g,s=i=g=F(g.minus(1),g.plus(1),c,1),d=L(g.times(g),c,1),a=3;;){if(i=L(i.times(d),c,1),x((l=s.plus(F(i,new v(a),c,1))).d).slice(0,c)===x(s.d).slice(0,c)){if(s=s.times(2),0!==o&&(s=s.plus(k(v,c+2,N).times(o+""))),s=F(s,new v(h),c,1),null!=t)return v.precision=N,s;if(!b(s.d,c-10,y,u))return L(s,v.precision=N,y,m=!0);v.precision=c+=10,l=i=g=F(f.minus(1),f.plus(1),c,1),d=L(g.times(g),c,1),a=u=1}s=l,a+=2}}function W(e){return String(e.s*e.s/0)}function X(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;48===t.charCodeAt(n);n++);for(a=t.length;48===t.charCodeAt(a-1);--a);if(t=t.slice(n,a)){if(a-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%7,r<0&&(n+=7),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=7;n<a;)e.d.push(+t.slice(n,n+=7));n=7-(t=t.slice(n)).length}else n-=a;for(;n--;)t+="0";e.d.push(+t),m&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function K(e,t){var r,n,a,i,u,s,l,c,f;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),S.test(t))return X(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(_.test(t))r=16,t=t.toLowerCase();else if(E.test(t))r=2;else{if(!T.test(t))throw Error(p+t);r=8}for((i=t.search(/p/i))>0?(l=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),u=(i=t.indexOf("."))>=0,n=e.constructor,u&&(i=(s=(t=t.replace(".","")).length)-i,a=Y(n,new n(r),i,2*i)),i=f=(c=O(t,r,I)).length-1;0===c[i];--i)c.pop();return i<0?new n(0*e.s):(e.e=B(c,f),e.d=c,m=!1,u&&(e=F(e,a,4*s)),l&&(e=e.times(Math.abs(l)<54?R(2,l):o.pow(2,l))),m=!0,e)}function q(e,t,r,n,a){var o,i,u,s,l=e.precision,c=Math.ceil(l/7);for(m=!1,s=r.times(r),u=new e(n);;){if(i=F(u.times(s),new e(t++*t++),l,1),u=a?n.plus(i):n.minus(i),n=F(i.times(s),new e(t++*t++),l,1),void 0!==(i=u.plus(n)).d[c]){for(o=c;i.d[o]===u.d[o]&&o--;);if(-1==o)break}o=u,u=n,n=i,i=o}return m=!0,i.d.length=c+1,i}function z(e,t){for(var r=e;--t;)r*=e;return r}function J(e,t){var r,n=t.s<0,a=P(e,e.precision,1),o=a.times(.5);if((t=t.abs()).lte(o))return u=n?4:1,t;if((r=t.divToInt(a)).isZero())u=n?3:2;else{if((t=t.minus(r.times(a))).lte(o))return u=V(r)?n?2:3:n?4:1,t;u=V(r)?n?1:4:n?3:2}return t.minus(a).abs()}function Q(e,t,r,n){var a,o,u,s,f,d,h,m,g,p=e.constructor,v=void 0!==r;if(v?(D(r,1,l),void 0===n?n=p.rounding:D(n,0,8)):(r=p.precision,n=p.rounding),e.isFinite()){for(v?(a=2,16==t?r=4*r-3:8==t&&(r=3*r-2)):a=t,(u=(h=U(e)).indexOf("."))>=0&&(h=h.replace(".",""),(g=new p(1)).e=h.length-u,g.d=O(U(g),10,a),g.e=g.d.length),o=f=(m=O(h,10,a)).length;0==m[--f];)m.pop();if(m[0]){if(u<0?o--:((e=new p(e)).d=m,e.e=o,m=(e=F(e,g,r,n,0,a)).d,o=e.e,d=i),u=m[r],s=a/2,d=d||void 0!==m[r+1],d=n<4?(void 0!==u||d)&&(0===n||n===(e.s<0?3:2)):u>s||u===s&&(4===n||d||6===n&&1&m[r-1]||n===(e.s<0?8:7)),m.length=r,d)for(;++m[--r]>a-1;)m[r]=0,r||(++o,m.unshift(1));for(f=m.length;!m[f-1];--f);for(u=0,h="";u<f;u++)h+=c.charAt(m[u]);if(v){if(f>1)if(16==t||8==t){for(u=16==t?4:3,--f;f%u;f++)h+="0";for(f=(m=O(h,a,t)).length;!m[f-1];--f);for(u=1,h="1.";u<f;u++)h+=c.charAt(m[u])}else h=h.charAt(0)+"."+h.slice(1);h=h+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)h="0"+h;h="0."+h}else if(++o>f)for(o-=f;o--;)h+="0";else o<f&&(h=h.slice(0,o)+"."+h.slice(o))}else h=v?"0p+0":"0";h=(16==t?"0x":2==t?"0b":8==t?"0o":"")+h}else h=W(e);return e.s<0?"-"+h:h}function ee(e,t){if(e.length>t)return e.length=t,!0}function te(e){return new this(e).abs()}function re(e){return new this(e).acos()}function ne(e){return new this(e).acosh()}function ae(e,t){return new this(e).plus(t)}function oe(e){return new this(e).asin()}function ie(e){return new this(e).asinh()}function ue(e){return new this(e).atan()}function se(e){return new this(e).atanh()}function le(e,t){e=new this(e),t=new this(t);var r,n=this.precision,a=this.rounding,o=n+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(r=t.s<0?P(this,n,a):new this(0)).s=e.s:!e.d||t.isZero()?(r=P(this,o,1).times(.5)).s=e.s:t.s<0?(this.precision=o,this.rounding=1,r=this.atan(F(e,t,o,1)),t=P(this,o,1),this.precision=n,this.rounding=a,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(F(e,t,o,1)):(r=P(this,o,1).times(t.s>0?.25:.75)).s=e.s:r=new this(NaN),r}function ce(e){return new this(e).cbrt()}function fe(e){return L(e=new this(e),e.e+1,2)}function de(e,t,r){return new this(e).clamp(t,r)}function he(e){if(!e||"object"!=typeof e)throw Error(g+"Object expected");var t,r,n,a=!0===e.defaults,o=["precision",1,l,"rounding",0,8,"toExpNeg",-s,0,"toExpPos",0,s,"maxE",0,s,"minE",-s,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(r=o[t],a&&(this[r]=h[r]),void 0!==(n=e[r])){if(!(M(n)===n&&n>=o[t+1]&&n<=o[t+2]))throw Error(p+r+": "+n);this[r]=n}if(r="crypto",a&&(this[r]=h[r]),void 0!==(n=e[r])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(p+r+": "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(y);this[r]=!0}else this[r]=!1}return this}function me(e){return new this(e).cos()}function ge(e){return new this(e).cosh()}function pe(e,t){return new this(e).div(t)}function ve(e){return new this(e).exp()}function ye(e){return L(e=new this(e),e.e+1,3)}function Ne(){var e,t,r=new this(0);for(m=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return m=!0,new this(1/0);r=t}return m=!0,r.sqrt()}function Me(e){return e instanceof o||e&&e.toStringTag===N||!1}function Re(e){return new this(e).ln()}function Ee(e,t){return new this(e).log(t)}function _e(e){return new this(e).log(2)}function Te(e){return new this(e).log(10)}function Se(){return $(this,arguments,"lt")}function Ie(){return $(this,arguments,"gt")}function Ce(e,t){return new this(e).mod(t)}function Ae(e,t){return new this(e).mul(t)}function we(e,t){return new this(e).pow(t)}function xe(e){var t,r,n,a,o=0,i=new this(1),u=[];if(void 0===e?e=this.precision:D(e,1,l),n=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));o<n;)(a=t[o])>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:u[o++]=a%1e7;else{if(!crypto.randomBytes)throw Error(y);for(t=crypto.randomBytes(n*=4);o<n;)(a=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((127&t[o+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,o):(u.push(a%1e7),o+=4);o=n/4}else for(;o<n;)u[o++]=1e7*Math.random()|0;for(e%=7,(n=u[--o])&&e&&(a=R(10,7-e),u[o]=(n/a|0)*a);0===u[o];o--)u.pop();if(o<0)r=0,u=[0];else{for(r=-1;0===u[0];r-=7)u.shift();for(n=1,a=u[0];a>=10;a/=10)n++;n<7&&(r-=7-n)}return i.e=r,i.d=u,i}function De(e){return L(e=new this(e),e.e+1,this.rounding)}function be(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function Oe(e){return new this(e).sin()}function Fe(e){return new this(e).sinh()}function Le(e){return new this(e).sqrt()}function Ue(e,t){return new this(e).sub(t)}function Be(){var e=0,t=arguments,r=new this(t[e]);for(m=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return m=!0,L(r,this.precision,this.rounding)}function ke(e){return new this(e).tan()}function Pe(e){return new this(e).tanh()}function He(e){return L(e=new this(e),e.e+1,1)}(o=function e(t){var r,n,a;function o(e){var t,r,n,a=this;if(!(a instanceof o))return new o(e);if(a.constructor=o,Me(e))return a.s=e.s,void(m?!e.d||e.e>o.maxE?(a.e=NaN,a.d=null):e.e<o.minE?(a.e=0,a.d=[0]):(a.e=e.e,a.d=e.d.slice()):(a.e=e.e,a.d=e.d?e.d.slice():e.d));if("number"==(n=typeof e)){if(0===e)return a.s=1/e<0?-1:1,a.e=0,void(a.d=[0]);if(e<0?(e=-e,a.s=-1):a.s=1,e===~~e&&e<1e7){for(t=0,r=e;r>=10;r/=10)t++;return void(m?t>o.maxE?(a.e=NaN,a.d=null):t<o.minE?(a.e=0,a.d=[0]):(a.e=t,a.d=[e]):(a.e=t,a.d=[e]))}return 0*e!=0?(e||(a.s=NaN),a.e=NaN,void(a.d=null)):X(a,e.toString())}if("string"!==n)throw Error(p+e);return 45===(r=e.charCodeAt(0))?(e=e.slice(1),a.s=-1):(43===r&&(e=e.slice(1)),a.s=1),S.test(e)?X(a,e):K(a,e)}if(o.prototype=w,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=he,o.clone=e,o.isDecimal=Me,o.abs=te,o.acos=re,o.acosh=ne,o.add=ae,o.asin=oe,o.asinh=ie,o.atan=ue,o.atanh=se,o.atan2=le,o.cbrt=ce,o.ceil=fe,o.clamp=de,o.cos=me,o.cosh=ge,o.div=pe,o.exp=ve,o.floor=ye,o.hypot=Ne,o.ln=Re,o.log=Ee,o.log10=Te,o.log2=_e,o.max=Se,o.min=Ie,o.mod=Ce,o.mul=Ae,o.pow=we,o.random=xe,o.round=De,o.sign=be,o.sin=Oe,o.sinh=Fe,o.sqrt=Le,o.sub=Ue,o.sum=Be,o.tan=ke,o.tanh=Pe,o.trunc=He,void 0===t&&(t={}),t&&!0!==t.defaults)for(a=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<a.length;)t.hasOwnProperty(n=a[r++])||(t[n]=this[n]);return o.config(t),o}(h)).prototype.constructor=o,o.default=o.Decimal=o,f=new o(f),d=new o(d),void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()},8738:function(e){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},2705:function(e,t,r){var n=r(5639).Symbol;e.exports=n},2488:function(e){e.exports=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}},1078:function(e,t,r){var n=r(2488),a=r(7285);e.exports=function e(t,r,o,i,u){var s=-1,l=t.length;for(o||(o=a),u||(u=[]);++s<l;){var c=t[s];r>0&&o(c)?r>1?e(c,r-1,o,i,u):n(u,c):i||(u[u.length]=c)}return u}},4239:function(e,t,r){var n=r(2705),a=r(9607),o=r(2333),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?a(e):o(e)}},9454:function(e,t,r){var n=r(4239),a=r(7005);e.exports=function(e){return a(e)&&"[object Arguments]"==n(e)}},1957:function(e,t,r){var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},9607:function(e,t,r){var n=r(2705),a=Object.prototype,o=a.hasOwnProperty,i=a.toString,u=n?n.toStringTag:void 0;e.exports=function(e){var t=o.call(e,u),r=e[u];try{e[u]=void 0;var n=!0}catch(e){}var a=i.call(e);return n&&(t?e[u]=r:delete e[u]),a}},7285:function(e,t,r){var n=r(2705),a=r(5694),o=r(1469),i=n?n.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||a(e)||!!(i&&e&&e[i])}},2333:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5639:function(e,t,r){var n=r(1957),a="object"==typeof self&&self&&self.Object===Object&&self,o=n||a||Function("return this")();e.exports=o},5564:function(e,t,r){var n=r(1078);e.exports=function(e){return null!=e&&e.length?n(e,1):[]}},5694:function(e,t,r){var n=r(9454),a=r(7005),o=Object.prototype,i=o.hasOwnProperty,u=o.propertyIsEnumerable,s=n(function(){return arguments}())?n:function(e){return a(e)&&i.call(e,"callee")&&!u.call(e,"callee")};e.exports=s},1469:function(e){var t=Array.isArray;e.exports=t},7005:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},2582:function(e){e.exports=function(){function e(e,n,a,o,i){!function e(r,n,a,o,i){for(;o>a;){if(o-a>600){var u=o-a+1,s=n-a+1,l=Math.log(u),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(u-c)/u)*(s-u/2<0?-1:1);e(r,n,Math.max(a,Math.floor(n-s*c/u+f)),Math.min(o,Math.floor(n+(u-s)*c/u+f)),i)}var d=r[n],h=a,m=o;for(t(r,a,n),i(r[o],d)>0&&t(r,a,o);h<m;){for(t(r,h,m),h++,m--;i(r[h],d)<0;)h++;for(;i(r[m],d)>0;)m--}0===i(r[a],d)?t(r,a,m):t(r,++m,o),m<=n&&(a=m+1),n<=m&&(o=m-1)}}(e,n,a||0,o||e.length-1,i||r)}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function o(e,t){i(e,0,e.children.length,t,e)}function i(e,t,r,n,a){a||(a=m(null)),a.minX=1/0,a.minY=1/0,a.maxX=-1/0,a.maxY=-1/0;for(var o=t;o<r;o++){var i=e.children[o];u(a,e.leaf?n(i):i)}return a}function u(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function s(e,t){return e.minX-t.minX}function l(e,t){return e.minY-t.minY}function c(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function h(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(t,r,n,a,o){for(var i=[r,n];i.length;)if(!((n=i.pop())-(r=i.pop())<=a)){var u=r+Math.ceil((n-r)/a/2)*a;e(t,u,r,n,o),i.push(r,u,u,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(e){var t=this.data,r=[];if(!h(e,t))return r;for(var n=this.toBBox,a=[];t;){for(var o=0;o<t.children.length;o++){var i=t.children[o],u=t.leaf?n(i):i;h(e,u)&&(t.leaf?r.push(i):d(e,u)?this._all(i,r):a.push(i))}t=a.pop()}return r},n.prototype.collides=function(e){var t=this.data;if(!h(e,t))return!1;for(var r=[];t;){for(var n=0;n<t.children.length;n++){var a=t.children[n],o=t.leaf?this.toBBox(a):a;if(h(e,o)){if(t.leaf||d(e,o))return!0;r.push(a)}}t=r.pop()}return!1},n.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},n.prototype.clear=function(){return this.data=m([]),this},n.prototype.remove=function(e,t){if(!e)return this;for(var r,n,o,i=this.data,u=this.toBBox(e),s=[],l=[];i||s.length;){if(i||(i=s.pop(),n=s[s.length-1],r=l.pop(),o=!0),i.leaf){var c=a(e,i.children,t);if(-1!==c)return i.children.splice(c,1),s.push(i),this._condense(s),this}o||i.leaf||!d(i,u)?n?(r++,i=n.children[r],o=!1):i=null:(s.push(i),l.push(r),r=0,n=i,i=i.children[0])}return this},n.prototype.toBBox=function(e){return e},n.prototype.compareMinX=function(e,t){return e.minX-t.minX},n.prototype.compareMinY=function(e,t){return e.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(e){return this.data=e,this},n.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},n.prototype._build=function(e,t,r,n){var a,i=r-t+1,u=this._maxEntries;if(i<=u)return o(a=m(e.slice(t,r+1)),this.toBBox),a;n||(n=Math.ceil(Math.log(i)/Math.log(u)),u=Math.ceil(i/Math.pow(u,n-1))),(a=m([])).leaf=!1,a.height=n;var s=Math.ceil(i/u),l=s*Math.ceil(Math.sqrt(u));g(e,t,r,l,this.compareMinX);for(var c=t;c<=r;c+=l){var f=Math.min(c+l-1,r);g(e,c,f,s,this.compareMinY);for(var d=c;d<=f;d+=s){var h=Math.min(d+s-1,f);a.children.push(this._build(e,d,h,n-1))}}return o(a,this.toBBox),a},n.prototype._chooseSubtree=function(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){for(var a=1/0,o=1/0,i=void 0,u=0;u<t.children.length;u++){var s=t.children[u],l=c(s),f=(d=e,h=s,(Math.max(h.maxX,d.maxX)-Math.min(h.minX,d.minX))*(Math.max(h.maxY,d.maxY)-Math.min(h.minY,d.minY))-l);f<o?(o=f,a=l<a?l:a,i=s):f===o&&l<a&&(a=l,i=s)}t=i||t.children[0]}var d,h;return t},n.prototype._insert=function(e,t,r){var n=r?e:this.toBBox(e),a=[],o=this._chooseSubtree(n,this.data,t,a);for(o.children.push(e),u(o,n);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(n,a,t)},n.prototype._split=function(e,t){var r=e[t],n=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,n);var i=this._chooseSplitIndex(r,a,n),u=m(r.children.splice(i,r.children.length-i));u.height=r.height,u.leaf=r.leaf,o(r,this.toBBox),o(u,this.toBBox),t?e[t-1].children.push(u):this._splitRoot(r,u)},n.prototype._splitRoot=function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(e,t,r){for(var n,a,o,u,s,l,f,d=1/0,h=1/0,m=t;m<=r-t;m++){var g=i(e,0,m,this.toBBox),p=i(e,m,r,this.toBBox),v=(a=g,o=p,u=Math.max(a.minX,o.minX),s=Math.max(a.minY,o.minY),l=Math.min(a.maxX,o.maxX),f=Math.min(a.maxY,o.maxY),Math.max(0,l-u)*Math.max(0,f-s)),y=c(g)+c(p);v<d?(d=v,n=m,h=y<h?y:h):v===d&&y<h&&(h=y,n=m)}return n||r-t},n.prototype._chooseSplitAxis=function(e,t,r){var n=e.leaf?this.compareMinX:s,a=e.leaf?this.compareMinY:l;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,a)&&e.children.sort(n)},n.prototype._allDistMargin=function(e,t,r,n){e.children.sort(n);for(var a=this.toBBox,o=i(e,0,t,a),s=i(e,r-t,r,a),l=f(o)+f(s),c=t;c<r-t;c++){var d=e.children[c];u(o,e.leaf?a(d):d),l+=f(o)}for(var h=r-t-1;h>=t;h--){var m=e.children[h];u(s,e.leaf?a(m):m),l+=f(s)}return l},n.prototype._adjustParentBBoxes=function(e,t,r){for(var n=r;n>=0;n--)u(t[n],e)},n.prototype._condense=function(e){for(var t=e.length-1,r=void 0;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():o(e[t],this.toBBox)},n}()},8045:function(e,t,r){r.d(t,{HD:function(){return o},de:function(){return d},jr:function(){return a},lA:function(){return l},lr:function(){return c},n0:function(){return u},o8:function(){return i},yH:function(){return s},zH:function(){return f}});var n=r(8902);function a(e){return"string"==typeof e&&"="===e[0]&&e.length>1}function o(e){return"[object String]"===Object.prototype.toString.call(e)}function i(e){return void 0===e}function u(e){return/(^|!)\d+:\d+$/.test(e)}function s(e){return/(^|!)[A-Za-z]+:[A-Za-z]+$/.test(e)}function l(e){var t=e;if("string"!=typeof t)return!1;var r=t.lastIndexOf("!");return t=t.slice(r+1),/^\$?([A-Za-z]{1,3})\$?([1-9][0-9]{0,5})$/g.test(t)}function c(e){var t=e.split(":");return 2===t.length&&t.every((function(e){return l(e)}))}function f(e){return!!(null==e?void 0:e.displayText)}function d(e){return void 0!==n.fR[e.funcName]}},8902:function(e,t,r){r.d(t,{A1:function(){return d},BT:function(){return u},JJ:function(){return l},JK:function(){return o},fR:function(){return h},kY:function(){return f},tM:function(){return m},u7:function(){return n},vG:function(){return i},v_:function(){return c},xU:function(){return a},yc:function(){return s}});var n,a={AND:!0,STOCK:!0,DAYS360:!0,DATEDIF:!0,E:!0,FALSE:!0,HLOOKUP:!0,IF:!0,INT:!0,ISEVEN:!0,ISODD:!0,ISNUMBER:!0,IFERROR:!0,ISNA:!0,ISERROR:!0,ISERR:!0,INDIRECT:!0,INDEX:!0,LOOKUP:!0,MATCH:!0,NOT:!0,OR:!0,TRUE:!0,VLOOKUP:!0,COUNTIF:!0,ASC:!0,CONCATENATE:!0,CONCAT:!0,TRIM:!0,VALUE:!0,SUBSTITUTE:!0,UPPER:!0,"WORKDAY.ORIGIN":!0,"WORKDAY.INTL":!0,FIXED:!0,PRODUCT:!0,REPT:!0,LOGICMATCH:!0,SPECIALMATCH:!0,EOMONTH:!0,EDATE:!0,IMSUB:!0,IMCONJUGATE:!0,COMPLEX:!0,SQRTPI:!0,FVSCHEDULE:!0,PROPER:!0,N:!0,EFFECT:!0,NOMINAL:!0,BIN2DEC:!0,BIN2OCT:!0,BIN2HEX:!0,OCT2BIN:!0,OCT2DEC:!0,OCT2HEX:!0,HEX2BIN:!0,HEX2OCT:!0,HEX2DEC:!0,DEC2BIN:!0,DEC2OCT:!0,DEC2HEX:!0,"ERF.ORIGIN":!0,"ERF.PRECISE":!0,"ERFC.PRECISE":!0,RANDBETWEEN:!0,CONVERT:!0,DELTA:!0,GESTEP:!0,LEN:!0},o={ID:!0,IS_VALID_ID:!0,ID_FOR_HK:!0,MID:!0,RIGHT:!0,LEFT:!0,SPECIALMATCH:!0,COUNTIF:!0,COUNTIFS:!0,BIN2OCT:!0,BIN2DEC:!0,BIN2HEX:!0,OCT2BIN:!0,OCT2DEC:!0,OCT2HEX:!0,HEX2BIN:!0,HEX2OCT:!0,HEX2DEC:!0,SUBSTITUTE:!0,CONCAT:!0,CONCATENATE:!0},i={VLOOKUP:!0},u={ISERROR:!0,IFERROR:!0,ISERR:!0,ISNA:!0,IF:!0,COUNT:!0,COUNTA:!0,COUNTIF:!0,COUNTIFS:!0,CHOOSE:!0,ISNUMBER:!0,SUMIF:!0,SUMIFS:!0,ISBLANK:!0,COLUMN:!0,MATCH:!0,ISFORMULA:!0,ISREF:!0},s={VLOOKUP:!0,HLOOKUP:!0,LOOKUP:!0,ISNUMBER:!0,OR:!0,MATHMATCH:!0,LOGICMATCH:!0,AVERAGEA:!0,COUNTIFS:!0,MOD:!0,RANK:!0,"RANK.EQ":!0,"RANK.AVG":!0},l={OFFSET:!0,VLOOKUP:!0,HLOOKUP:!0},c={IFERROR:!0,ROW:!0,COLUMN:!0,N:!0},f={STOCK:!0,ID:!0},d={SUMPRODUCT:!0,LOOKUP:!0};!function(e){e.BOOL="BOOL",e.STRING="STRING",e.NUMBER="NUMBER",e.DATE="DATE",e.ARRAY="ARRAY",e.NOT_ARRAY="NOT_ARRAY",e.ANY="ANY"}(n||(n={}));var h={},m={SUM:{argumentsType:n.ANY,acceptRef:!0,min:1},IF:{argumentsType:[n.BOOL,n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:3,acceptRef:!0},STOCK:{min:2,max:2},ID:{min:2,max:2},IS_VALID_ID:{min:1,max:1},ID_FOR_HK:{min:2,max:2},ROUND:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},AVERAGE:{argumentsType:n.ANY,min:1,acceptRef:!0},COUNTIF:{argumentsType:[n.ANY,n.STRING],min:2,max:2,acceptRef:!0},MID:{argumentsType:[n.STRING,n.NUMBER,n.NUMBER],min:3,max:3},MAX:{argumentsType:n.ANY,min:1,acceptRef:!0},COUNTA:{argumentsType:n.ANY,min:1,max:255,acceptRef:!0},DATEDIF:{argumentsType:[n.DATE,n.DATE,n.STRING],min:3,max:3},COUNTIFS:{argumentsType:[n.ANY,n.STRING,n.ANY,n.STRING,n.ANY,n.STRING,n.ANY,n.STRING],min:2},SUBTOTAL:{argumentsType:[n.NUMBER,n.ANY,n.ANY],min:2,acceptRef:!0},MIN:{argumentsType:n.ANY,min:1,acceptRef:!0},COUNT:{argumentsType:n.ANY,min:1,acceptRef:!0},SUMIF:{argumentsType:[n.ANY,n.STRING,n.ANY],min:2,max:3,acceptRef:!0},SUMIFS:{argumentsType:[n.ANY,n.ANY,n.STRING,n.ANY,n.STRING,n.ANY,n.STRING],min:3,max:254},TEXT:{argumentsType:[n.NOT_ARRAY,n.STRING],min:2,max:2},LEFT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},RIGHT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},YEAR:{argumentsType:[n.DATE],min:1,max:1},INT:{argumentsType:[n.NUMBER],min:1,max:1},MOD:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},DATE:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:3},NOW:{argumentsType:[n.ANY],min:0,max:0},ABS:{argumentsType:[n.NUMBER],min:1,max:1},MONTH:{argumentsType:[n.DATE],min:1,max:1},RAND:{argumentsType:[n.ANY],min:0,max:0},SQRT:{argumentsType:[n.NUMBER],min:1,max:1},DAY:{argumentsType:[n.DATE],min:1,max:1},LEN:{argumentsType:[n.STRING],min:1,max:1},WEEKDAY:{argumentsType:[n.DATE,n.NUMBER],min:1,max:2},OR:{argumentsType:[n.ANY],min:1,max:255},INDIRECT:{argumentsType:[n.STRING,n.BOOL],min:1,max:2,acceptRef:!0},AND:{argumentsType:[n.ANY],min:1,max:255},ROUNDUP:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},ROUNDDOWN:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},VLOOKUP:{argumentsType:[n.NOT_ARRAY,n.ANY,n.STRING,n.BOOL],min:3,max:4,acceptRef:!0},HLOOKUP:{argumentsType:[n.NOT_ARRAY,n.ANY,n.STRING,n.BOOL],min:3,max:4,acceptRef:!0},LOOKUP:{argumentsType:[n.NOT_ARRAY,n.ANY,n.ANY],min:2,max:3,acceptRef:!0},INDEX:{argumentsType:[n.ANY,n.NUMBER,n.NUMBER,n.NUMBER],min:2,max:4,acceptRef:!0},ISERROR:{argumentsType:[n.NOT_ARRAY],min:1,max:1},ISERR:{argumentsType:[n.NOT_ARRAY],min:1,max:1},FIND:{argumentsType:[n.STRING,n.STRING,n.NUMBER],min:2,max:3},SUMPRODUCT:{argumentsType:n.ANY,min:1,acceptRef:!0},ISNA:{argumentsType:[n.ANY],min:1,max:1},ISNUMBER:{argumentsType:[n.NOT_ARRAY],min:1,max:1},IFERROR:{argumentsType:[n.ANY,n.NOT_ARRAY],min:2,max:2},ROW:{argumentsType:[n.ANY],min:0,max:1,acceptRef:!0},TODAY:{argumentsType:[n.ANY],min:0,max:0},MATCH:{argumentsType:[n.NOT_ARRAY,n.ARRAY,n.ANY],min:2,max:3,acceptRef:!0},TRIM:{argumentsType:[n.STRING],min:1,max:1},CONCATENATE:{argumentsType:[n.ARRAY],min:1},CONCAT:{argumentsType:n.ANY,min:1},CHOOSE:{argumentsType:[n.NUMBER,n.ANY],min:2,max:255,acceptRef:!0},PRODUCT:{argumentsType:n.ANY,min:1,acceptRef:!0},SPECIALMATCH:{argumentsType:[n.ANY,n.ANY,n.STRING],min:3,max:3},MATHMATCH:{argumentsType:[n.NUMBER,n.NUMBER,n.STRING],min:3,max:3,acceptRef:!0},LOGICMATCH:{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY,n.STRING],min:3,max:3},SUBSTITUTE:{argumentsType:[n.STRING,n.STRING,n.STRING,n.NUMBER],min:3,max:4},TRUNC:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},OFFSET:{argumentsType:[n.ANY,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5,acceptRef:!0},VALUE:{argumentsType:[n.STRING],min:1,max:1},FIXED:{argumentsType:[n.NUMBER,n.NUMBER,n.BOOL],min:1,max:3},ISBLANK:{argumentsType:[n.NOT_ARRAY],min:1,max:1},ASC:{argumentsType:[n.STRING],min:1,max:1},UPPER:{argumentsType:[n.STRING],min:1,max:1},LN:{argumentsType:[n.NUMBER],min:1,max:1},"CEILING.ORIGIN":{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},"CEILING.MATH":{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:1,max:3},"CEILING.PRECISE":{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},"FLOOR.ORIGIN":{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},"FLOOR.MATH":{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:1,max:3},"FLOOR.PRECISE":{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},ADDRESS:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.BOOL,n.STRING],min:2,max:5},COLUMN:{argumentsType:[n.ANY],min:0,max:1,acceptRef:!0},"WORKDAY.ORIGIN":{argumentsType:[n.DATE,n.NOT_ARRAY,n.ARRAY],min:2,max:3},"WORKDAY.INTL":{argumentsType:[n.DATE,n.NOT_ARRAY,n.NUMBER,n.ARRAY],min:2,max:4},AVERAGEIF:{argumentsType:[n.ANY,n.ANY,n.ANY],min:2,max:3,acceptRef:!0},"RANK.EQ":{argumentsType:[n.NUMBER,n.ARRAY,n.NUMBER],min:2,max:3},"RANK.AVG":{argumentsType:[n.NUMBER,n.ARRAY,n.NUMBER],min:2,max:3},AVERAGEA:{argumentsType:n.ANY,min:1},LOG:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},CHAR:{argumentsType:[n.NUMBER],min:1,max:1},COS:{argumentsType:[n.NUMBER],min:1,max:1},SIN:{argumentsType:[n.NUMBER],min:1,max:1},SINH:{argumentsType:[n.NUMBER],min:1,max:1},TAN:{argumentsType:[n.NUMBER],min:1,max:1},ASIN:{argumentsType:[n.NUMBER],min:1,max:1},ACOS:{argumentsType:[n.NUMBER],min:1,max:1},ATAN:{argumentsType:[n.NUMBER],min:1,max:1},PI:{argumentsType:[],min:0,max:0},DEGREES:{argumentsType:[n.NUMBER],min:1,max:1},RADIANS:{argumentsType:[n.NUMBER],min:1,max:1},ISODD:{argumentsType:[n.NOT_ARRAY],min:1,max:1},N:{argumentsType:[n.ANY],min:1,max:1},REPT:{argumentsType:[n.STRING,n.NUMBER],min:2,max:2},SMALL:{argumentsType:[n.ARRAY,n.NOT_ARRAY],min:2,max:2},LARGE:{argumentsType:[n.ARRAY,n.NOT_ARRAY],min:2,max:2},MINUTE:{argumentsType:[n.DATE],min:1,max:1},HOUR:{argumentsType:[n.DATE],min:1,max:1},SECOND:{argumentsType:[n.DATE],min:1,max:1},NOT:{argumentsType:[n.NOT_ARRAY],min:1,max:1},PROPER:{argumentsType:[n.NOT_ARRAY],min:1,max:1},LOWER:{argumentsType:[n.NOT_ARRAY],min:1,max:1},EOMONTH:{argumentsType:[n.DATE,n.NUMBER],min:2,max:2},EDATE:{argumentsType:[n.DATE,n.NUMBER],min:2,max:2},PMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5},IMSUB:{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:2},IMCONJUGATE:{argumentsType:[n.NOT_ARRAY],min:1,max:1},COMPLEX:{argumentsType:[n.NUMBER,n.NUMBER,n.STRING],min:2,max:3},POWER:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},TRUE:{argumentsType:[],min:0,max:0},FALSE:{argumentsType:[],min:0,max:0},LOG10:{argumentsType:[n.NUMBER],min:1,max:1},EXP:{argumentsType:[n.NUMBER],min:1,max:1},RATE:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:6},SUMSQ:{argumentsType:n.ANY,min:1},STDEVA:{argumentsType:n.ANY,min:1},STDEVPA:{argumentsType:n.ANY,min:1},VARA:{argumentsType:n.ANY,min:1},VARPA:{argumentsType:n.ANY,min:1},AVEDEV:{argumentsType:n.ANY,min:1},DEVSQ:{argumentsType:n.ANY,min:1},EXACT:{argumentsType:[n.STRING,n.STRING],min:2,max:2},ROMAN:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},CORREL:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},TEXTJOIN:{argumentsType:n.ANY,min:3},GEOMEAN:{argumentsType:n.ANY,min:1},HARMEAN:{argumentsType:n.ANY,min:1},IPMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:6},PPMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:6},UNICHAR:{argumentsType:[n.NUMBER],min:1,max:1},UNICODE:{argumentsType:[n.ANY],min:1,max:1},CHIDIST:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},KURT:{argumentsType:n.ANY,min:1},INTERCEPT:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},PEARSON:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},RSQ:{argumentsType:[n.ARRAY,n.ARRAY],min:2,max:2},ISEVEN:{argumentsType:[n.NOT_ARRAY],min:1,max:1},"SKEW.ORIGIN":{argumentsType:n.ANY,min:1},"SKEW.P":{argumentsType:n.ANY,min:1},WEEKNUM:{argumentsType:[n.DATE,n.NUMBER],min:1,max:2},ISOWEEKNUM:{argumentsType:[n.DATE],min:1,max:1},SLOPE:{argumentsType:n.ANY,min:2,max:2},CODE:{min:1,max:1},ATAN2:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},ASINH:{argumentsType:[n.NUMBER],min:1,max:1},ACOSH:{argumentsType:[n.NUMBER],min:1,max:1},TANH:{argumentsType:[n.NUMBER],min:1,max:1},ATANH:{argumentsType:[n.NUMBER],min:1,max:1},COSH:{argumentsType:[n.NUMBER],min:1,max:1},COT:{argumentsType:[n.NUMBER],min:1,max:1},COTH:{argumentsType:[n.NUMBER],min:1,max:1},ACOT:{argumentsType:[n.NUMBER],min:1,max:1},ACOTH:{argumentsType:[n.NUMBER],min:1,max:1},REPLACE:{argumentsType:[n.STRING,n.NUMBER,n.NUMBER,n.STRING],min:4,max:4},CLEAN:{argumentsType:[n.STRING],min:1,max:1},FV:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5},DOLLAR:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},XOR:{argumentsType:n.ANY,min:1},PV:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:5},SQRTPI:{argumentsType:[n.NUMBER],min:1,max:1},TIME:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:3},DATEVALUE:{argumentsType:[n.STRING],min:1,max:1},TIMEVALUE:{argumentsType:[n.STRING],min:1,max:1},FVSCHEDULE:{argumentsType:[n.NOT_ARRAY,n.ANY],min:2,max:2},"VAR.P":{argumentsType:n.ANY,min:1},"VAR.S":{argumentsType:n.ANY,min:1},"STDEV.S":{argumentsType:n.ANY,min:1},IRR:{argumentsType:[n.ARRAY,n.NUMBER],min:1,max:2},DAYS:{argumentsType:[n.DATE,n.DATE],min:2,max:2},DAYS360:{argumentsType:[n.DATE,n.DATE,n.BOOL],min:2,max:3},YEARFRAC:{argumentsType:[n.DATE,n.DATE,n.NUMBER],min:2,max:3},CUMIPMT:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:6},CUMPRINC:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:6},T:{argumentsType:[n.ANY],min:1,max:1},MROUND:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},EFFECT:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},NOMINAL:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},EVEN:{argumentsType:[n.NUMBER],min:1,max:1},ODD:{argumentsType:[n.NUMBER],min:1,max:1},BESSELI:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},BESSELJ:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},BESSELK:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},BESSELY:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},TRIMMEAN:{argumentsType:[n.ANY,n.NUMBER],min:2,max:2},BIN2DEC:{argumentsType:[n.STRING],min:1,max:1},BIN2OCT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},BIN2HEX:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},OCT2DEC:{argumentsType:[n.STRING],min:1,max:1},OCT2BIN:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},OCT2HEX:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},HEX2BIN:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},HEX2OCT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},HEX2DEC:{argumentsType:[n.STRING],min:1,max:1},DEC2BIN:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},DEC2OCT:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},DEC2HEX:{argumentsType:[n.STRING,n.NUMBER],min:1,max:2},SYD:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:4},SLN:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER],min:3,max:3},MAXA:{argumentsType:n.ANY,min:1},MINA:{argumentsType:n.ANY,min:1},PRICE:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:7},PRICEDISC:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:5},"MODE.SNGL":{argumentsType:n.ANY,min:1},MEDIAN:{argumentsType:n.ANY,min:1},PRICEMAT:{argumentsType:[n.DATE,n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:5,max:6},"PERCENTRANK.INC":{argumentsType:[n.ARRAY,n.NUMBER,n.NUMBER],min:2,max:3},"PERCENTRANK.EXC":{argumentsType:[n.ARRAY,n.NUMBER,n.NUMBER],min:2,max:3},YIELD:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:6,max:7},YIELDMAT:{argumentsType:[n.DATE,n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:5,max:6},YIELDDISC:{argumentsType:[n.DATE,n.DATE,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:5},DB:{argumentsType:[n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER,n.NUMBER],min:4,max:5},"ERF.ORIGIN":{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},"ERF.PRECISE":{argumentsType:[n.NUMBER],min:1,max:1},"ERFC.PRECISE":{argumentsType:[n.NUMBER],min:1,max:1},NA:{argumentsType:[],min:0,max:0},SEARCH:{argumentsType:[n.STRING,n.STRING,n.NUMBER],min:2,max:3},RANDBETWEEN:{argumentsType:[n.NUMBER,n.NUMBER],min:2,max:2},CONVERT:{argumentsType:[n.NUMBER,n.STRING,n.STRING],min:3,max:3},COUNTBLANK:{argumentsType:[n.ARRAY],min:1,max:1},DELTA:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},GESTEP:{argumentsType:[n.NUMBER,n.NUMBER],min:1,max:2},MINVERSE:{argumentsType:[n.ANY],min:1,max:1,acceptRef:!0},MMULT:{argumentsType:[n.ANY,n.ANY],min:2,max:2,acceptRef:!0},"NETWORKDAYS.ORIGIN":{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:3},"NETWORKDAYS.INTL":{argumentsType:[n.NOT_ARRAY,n.NOT_ARRAY],min:2,max:4},ISFORMULA:{argumentsType:n.ANY,min:1,max:1,acceptRef:!0},ISREF:{argumentsType:n.ANY,min:1,max:1,acceptRef:!0},AVERAGEIFS:{argumentsType:n.ANY,min:1,acceptRef:!0},FREQUENCY:{argumentsType:[n.ANY,n.ANY],min:2,max:2,acceptRef:!0},TRANSPOSE:{argumentsType:n.ANY,min:1,max:1},MINIFS:{argumentsType:n.ANY,min:3,acceptRef:!0},MAXIFS:{argumentsType:n.ANY,min:3,acceptRef:!0},REGEXMATCH:{argumentsType:[n.STRING,n.STRING,n.BOOL],min:3,acceptRef:!0},HYPERLINK:{argumentsType:[n.STRING,n.STRING],min:1,max:2},URL:{argumentsType:[n.ANY],min:1,max:1,acceptRef:!0}}},9678:function(e,t,r){r.d(t,{Z:function(){return n}});var n=function(){function e(){}function t(e,r){for(var n in r)if(r.hasOwnProperty(n)){var a=r[n];Array.isArray(a)?(e[n]=[],t(e[n],r[n])):"object"==typeof a?(e[n]={},t(e[n],r[n])):e[n]=r[n]}}return e._insert=function(e,t,r){e.splice(t,0,r)},e._add=function(e,t){e.push(t)},e._contains=function(e,t){return e.indexOf(t)>-1},e._remove=function(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)},e._removeByIndex=function(e,t){return e.slice(0,t).concat(e.slice(t+1))},e._indexOf=function(e,t,r){return e.indexOf(t,r)},e._clear=function(e,t,r){if(!(t<0))for(var n=0;n<r&&t+n<e.length;n++)e[t+n]=null},e._nextNonEmptyIndex=function(e,t){t<0&&(t=-1);for(var r=t+1;r<e.length;r++)if(void 0!==e[r]&&null!==e[r])return r;return-1},e._getLength=function(e){return e&&e.length},e._clone=function(e){var r=[];return t(r,e),r},e}()},1501:function(e,t,r){r.d(t,{s:function(){return S}});var n=r(2021),a=r(8657),o=r(7686),i=r(8045),u=o.Z,s=u._inherit,l=u._each,c=void 0,f=null,d=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"],h=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],m=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],g=d.concat(h);l(d,(function(e,t){l(h,(function(e,r){e<h.length-4&&g.push(t+" "+r)}))})),g=g.concat(m),l(m,(function(e,t){l(h,(function(e,r){e<h.length-4&&g.push(t+" "+r)}))}));var p=function(){function e(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"¤",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"‰",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd"},this.name=function(){return""},this.id=-1}function t(e){return e.split(" ").join(" ").toUpperCase()}function r(e){for(var r=[],n=0,a=e.length;n<a;n++)r[n]=t(e[n]);return r}function n(e,r,n){var a=t(e),o=r.indexOf(a);return-1===o&&(o=n.indexOf(a)),o}return e.prototype={constructor:e,_getDateTimePattern:function(){if(!this._dateTimeFormatPattern){var e=this.DateTimeFormat.shortDatePattern.replace(/m/g,"M"),t=[e,e+" h:mm",e+" h:mm:ss",e+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"];this._dateTimeFormatPattern=t.concat(g)}return this._dateTimeFormatPattern},_getMonthIndex:function(e){var t=this;return t._upperMonths||(t._upperMonths=r(t.DateTimeFormat.monthNames),t._upperMonthsGenitive=r(t.DateTimeFormat.monthGenitiveNames)),n(e,t._upperMonths,t._upperMonthsGenitive)},_getAbbrMonthIndex:function(e){var t=this;return t._upperAbbrMonths||(t._upperAbbrMonths=r(t.DateTimeFormat.abbreviatedMonthNames),t._upperAbbrMonthsGenitive=r(t.DateTimeFormat.abbreviatedMonthGenitiveNames)),n(e,t._upperAbbrMonths,t._upperAbbrMonthsGenitive)},_getDayIndex:function(e){var n=this;return n._upperDays||(n._upperDays=r(n.DateTimeFormat.dayNames)),n._upperDays.indexOf(t(e))},_getAbbrDayIndex:function(e){var n=this;return n._upperAbbrDays||(n._upperAbbrDays=r(n.DateTimeFormat.abbreviatedDayNames)),n._upperAbbrDays.indexOf(t(e))}},e}(),v=function(){function e(){}return e._isValidEraDate=function(e){return e>=this._getEraMin()&&e<=this._getEraMax()},e._getEraDates=function(){var e=p.eras;if(e!==c){for(var t=[],r=0;r<e.length;r++)t[r]=new Date(e[r].startDate.replace(/-/g,"/"));return t}return this._EraDates},e._getEraPropByFormat=function(e){var t,r,n=this;switch(e){case"g":t="symbol",r=n._symbols;break;case"gg":t="abbreviation",r=n._abbreviations;break;case"ggg":t="name",r=n._names;break;default:return[]}var a=p.eras,o=[];if(a!==c){for(var i=0;i<a.length;i++)o[i]=a[i][t];return o}return r},e._getEraMax=function(){var e=p.eras;if(e!==c&&e.length>0){var t=new Date(e[e.length-1].startDate.replace(/-/g,"/"));return t.setFullYear(t.getFullYear()+99),t}return this._EraMax},e._getEraMin=function(){var e=p.eras;return e!==c&&e.length>0?new Date(e[0].startDate.replace(/-/g,"/")):this._EraMin},e._getEraCount=function(){var e=p.eras;return e!==c?e.length:this._EraCount},e._getEraYears=function(){var e=p.eras;if(e!==c){for(var t=[],r=1;r<e.length;r++){var n=new Date(e[r-1].startDate.replace(/-/g,"/")),a=new Date(e[r].startDate.replace(/-/g,"/"));t[r-1]=a.getFullYear()-n.getFullYear()+1}return t[r-1]=99,t}return this._EraYears},e._getEraDate=function(e){var t={_era:-1,_eraYear:-1},r=this;if(!r._isValidEraDate(e))return t;for(var n=0;n<r._getEraCount();n++)if(e<(n+1!==r._getEraCount()?r._getEraDates()[n+1]:r._addMilliseconds(r._getEraMax(),1))){t._era=n,t._eraYear=e.getFullYear()-r._getEraDates()[n].getFullYear()+1;break}return t},e._addMilliseconds=function(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return r.setMilliseconds(r.getMilliseconds()+t),new Date(r.valueOf())},e._getYearFromEra=function(t,r){return e._getEraDates()[t].getFullYear()+r-1},e._parseEraPart=function(t,r){r=r.toUpperCase();for(var n=e._getEraPropByFormat(t),a=0;a<n.length;a++)if(n[a]===r)return a;return-1},e._formatEraPart=function(t,r){var n=e,a=n._getEraDate(r),o=a._era;if(o>=0){var i=n._getEraPropByFormat(t);if(i.length>0)return i[o]}var u=a._eraYear;if(u>=0){var s=u.toString();if("ee"===t)return 1===s.length&&(s="0"+s),s;if("e"===t)return s}return""},e._EraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],e._EraCount=4,e._EraYears=[45,15,64,99],e._EraMax=new Date(2087,11,31,23,59,59),e._EraMin=new Date(1868,8,8),e._shortcuts=["1,m","2,t","3,s","4,h"],e._EraIndices=[0,1,2,3,0,1,2,3],e._names=[n.default.t("明治"),n.default.t("大正"),n.default.t("昭和"),n.default.t("平成")],e._symbols=["M","T","S","H"],e._abbreviations=[n.default.t("明"),n.default.t("大"),n.default.t("昭"),n.default.t("平")],e._EraYearMax=99,e}(),y=function(e){function t(){e.apply(this,arguments),_.call(this,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),_.call(this,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1]),this.name=function(){return"en-US"},this.id=1033}return s(t,e),t}(p),N=function(e){function t(){e.apply(this,arguments);var t={1:{letters:[n.default.t("兆"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("亿"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("万"),n.default.t("千"),n.default.t("百"),n.default.t("十"),""],numbers:["〇",n.default.t("一"),n.default.t("二"),n.default.t("三"),n.default.t("四"),n.default.t("五"),n.default.t("六"),n.default.t("七"),n.default.t("八"),n.default.t("九")]},2:{letters:[n.default.t("兆"),n.default.t("阡"),n.default.t("百"),n.default.t("拾"),n.default.t("億"),n.default.t("阡"),n.default.t("百"),n.default.t("拾"),n.default.t("萬"),n.default.t("阡"),n.default.t("百"),n.default.t("拾"),""],numbers:["〇",n.default.t("壱"),n.default.t("弐"),n.default.t("参"),n.default.t("四"),n.default.t("伍"),n.default.t("六"),n.default.t("七"),n.default.t("八"),n.default.t("九")]},3:{letters:f,numbers:["０","１","２","３","４","５","６","７","８","９"]}};_.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[0,1,"¥",!1,n.default.t("NaN (非数値)"),"-∞",1,1,"+∞",t]);var r=["1","2","3","4","5","6","7","8","9","10","11","12",""],a=[n.default.t("1月"),n.default.t("2月"),n.default.t("3月"),n.default.t("4月"),n.default.t("5月"),n.default.t("6月"),n.default.t("7月"),n.default.t("8月"),n.default.t("9月"),n.default.t("10月"),n.default.t("11月"),n.default.t("12月"),""];_.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","EraFilterDialogDateFormatter"],[[n.default.t("日"),n.default.t("月"),n.default.t("火"),n.default.t("水"),n.default.t("木"),n.default.t("金"),n.default.t("土")],r,r,n.default.t("午前"),!1,[n.default.t("日曜日"),n.default.t("月曜日"),n.default.t("火曜日"),n.default.t("水曜日"),n.default.t("木曜日"),n.default.t("金曜日"),n.default.t("土曜日")],n.default.t("yyyy'年'M'月'd'日' H:mm:ss"),n.default.t("yyyy'年'M'月'd'日'"),"H:mm:ss",n.default.t("M'月'd'日'"),a,a,n.default.t("西暦 (日本語)"),n.default.t("午後"),"yyyy/MM/dd",[n.default.t("日"),n.default.t("月"),n.default.t("火"),n.default.t("水"),n.default.t("木"),n.default.t("金"),n.default.t("土")],"H:mm",n.default.t("yyyy'年'M'月'"),n.default.t("yyyy年/mmmm/d日"),n.default.t("ggge/mmmm/d日")]),this.DateTimeFormat.eras=v,this.name=function(){return"ja-JP"},this.id=1041,this.isJCKCulture=!0}return s(t,e),t}(p),M=function(e){function t(){e.apply(this,arguments);var t={1:{letters:[n.default.t("兆"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("亿"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("万"),n.default.t("千"),n.default.t("百"),n.default.t("十"),""],numbers:["○",n.default.t("一"),n.default.t("二"),n.default.t("三"),n.default.t("四"),n.default.t("五"),n.default.t("六"),n.default.t("七"),n.default.t("八"),n.default.t("九")]},2:{letters:[n.default.t("兆"),n.default.t("仟"),n.default.t("佰"),n.default.t("拾"),n.default.t("亿"),n.default.t("仟"),n.default.t("佰"),n.default.t("拾"),n.default.t("万"),n.default.t("仟"),n.default.t("佰"),n.default.t("拾"),""],numbers:[n.default.t("零"),n.default.t("壹"),n.default.t("贰"),n.default.t("叁"),n.default.t("肆"),n.default.t("伍"),n.default.t("陆"),n.default.t("柒"),n.default.t("捌"),n.default.t("玖")]},3:{letters:f,numbers:["０","１","２","３","４","５","６","７","８","９"]}};_.call(this,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[2,"¥",!1,n.default.t("非数字"),n.default.t("负无穷大"),1,1,n.default.t("正无穷大"),t]);var r=[n.default.t("1月"),n.default.t("2月"),n.default.t("3月"),n.default.t("4月"),n.default.t("5月"),n.default.t("6月"),n.default.t("7月"),n.default.t("8月"),n.default.t("9月"),n.default.t("10月"),n.default.t("11月"),n.default.t("12月"),""],a=[n.default.t("一月"),n.default.t("二月"),n.default.t("三月"),n.default.t("四月"),n.default.t("五月"),n.default.t("六月"),n.default.t("七月"),n.default.t("八月"),n.default.t("九月"),n.default.t("十月"),n.default.t("十一月"),n.default.t("十二月"),""];_.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[[n.default.t("周日"),n.default.t("周一"),n.default.t("周二"),n.default.t("周三"),n.default.t("周四"),n.default.t("周五"),n.default.t("周六")],r,r,n.default.t("上午"),!1,[n.default.t("星期日"),n.default.t("星期一"),n.default.t("星期二"),n.default.t("星期三"),n.default.t("星期四"),n.default.t("星期五"),n.default.t("星期六")],1,n.default.t("yyyy'年'M'月'd'日' H:mm:ss"),n.default.t("yyyy'年'M'月'd'日'"),"H:mm:ss",n.default.t("M'月'd'日'"),a,a,n.default.t("公历"),n.default.t("下午"),"yyyy/M/d",[n.default.t("日"),n.default.t("一"),n.default.t("二"),n.default.t("三"),n.default.t("四"),n.default.t("五"),n.default.t("六")],"H:mm",n.default.t("yyyy'年'M'月'"),n.default.t("yyyy年/mmmm/d日")]),this.name=function(){return"zh-cn"},this.id=2052,this.isJCKCulture=!0}return s(t,e),t}(p),R=function(e){function t(){e.apply(this,arguments);var t={1:{letters:[n.default.t("兆"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("億"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("万"),n.default.t("千"),n.default.t("百"),n.default.t("十"),""],numbers:["０",n.default.t("一"),n.default.t("二"),n.default.t("三"),n.default.t("四"),n.default.t("五"),"六",n.default.t("七"),n.default.t("八"),n.default.t("九")]},2:{letters:[n.default.t("兆"),n.default.t("阡"),n.default.t("百"),"拾",n.default.t("億"),n.default.t("阡"),n.default.t("百"),"拾",n.default.t("萬"),n.default.t("阡"),n.default.t("百"),"拾",""],numbers:["零",n.default.t("壹"),n.default.t("貳"),"參",n.default.t("四"),n.default.t("伍"),"六",n.default.t("七"),n.default.t("八"),n.default.t("九")]},3:{letters:[n.default.t("兆"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("億"),n.default.t("千"),n.default.t("百"),n.default.t("十"),n.default.t("万"),n.default.t("千"),n.default.t("百"),n.default.t("十"),""],numbers:["０","１","２","３","４","５","６","７","８","９"]}};_.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber"],[0,1,"₩",!1,t]);var r=["1","2","3","4","5","6","7","8","9","10","11","12",""],a=["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월",""];_.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["일","월","화","수","목","금","토"],r,r,"오전",!1,["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],1,"yyyy'년' M'월' d'일' dddd h:mm:ss","yyyy'년' M'월' d'일' dddd","h:mm:ss","M'월' d'일'",a,a,"서기","오후","yyyy-MM-dd",["일","월","화","수","목","금","토"],"tt h:mm","yyyy'년' M'월'","yyyy년/mmmm/d일"]),this.name=function(){return"ko-kr"},this.id=1042,this.isJCKCulture=!0}return s(t,e),t}(p),E={invariant:new p,"en-us":new y,"ja-jp":new N,"zh-cn":new M,"ko-kr":new R};function _(e,t,r){for(var n,a=0,o=t.length;a<o;a++)n=t[a],this[e][n]=r[a]}var T=function(){if("object"==typeof e.instance)return e.instance;function e(){var t="en-us";this.culture=function(e){if(0===arguments.length)return t;e&&t!==e&&(t=e.toLowerCase())},this.addCultureInfo=function(e,t){var r=t.NumberFormat.numberDecimalSeparator,n=t.NumberFormat.arrayListSeparator,o=t.NumberFormat.arrayGroupSeparator;if(r===t.NumberFormat.listSeparator||o===n)throw new Error(a.wI.Exp_Separator);E[e.toLowerCase()]=t},this.getCultureInfo=function(e){if(0===arguments.length)return E[t];e=(0,i.HD)(e)?e.toLowerCase():e;var r=E,n=f;for(var a in r)if(a===e||r[a].id!==c&&r[a].id===e){n=r[a];break}return n},this._getCultureInfo=function(e){var r=this.getCultureInfo(e);return r||(r=E[t])||(r=new p),r},this._getFilterDialogFormatterStr=function(e,t){var r=(this.getCultureInfo(e)||this.getCultureInfo("en-US")).DateTimeFormat,n=r.filterDialogDateFormatter;return(t.indexOf("g")>=0||t.indexOf("e")>=0)&&(n=r.EraFilterDialogDateFormatter||n),n},e.instance=this}return e}(),S=new T},8422:function(e,t,r){r.d(t,{Z:function(){return v}});var n=r(8657),a=r(6593),o=r(9678),i=r(1501),u=r(7686).Z._isNullOrUndefined,s=a.Z._padZeroLeft,l=null,c=parseInt,f=!1,d=!0,h=Math.floor,m=Math.abs,g={},p=function(){function e(e,t,r){var n,a,o,i,u,s=f;for((u=r).slice(1).forEach((function(e){e&&(s=!0)})),s||(u=u.concat(t._getDateTimePattern())),n=1,a=u.length;n<a;n++)if((i=u[n])&&(s=d,o=y(e,i,t)))return o;return l}function t(e,a,o){var i=o.DateTimeFormat,u=i.Calendar.convert;if(!a||!a.length)return o&&o.name.length?u?t(e,i.fullDateTimePattern,o):e.toLocaleString():e.toString();var l,c,f,g=i.eras,p="",v=/([^d]|^)(d|dd)([^d]|$)/g;function y(){return c||f||(c=v.test(a),f=d),c}var N,M=0,R=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[s\]|\[ss\]/g;function E(e,t){if(N)return N[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:return}}"s"!==a&&u&&(N=u.fromGregorian(e));for(var _=-2,T=-2,S={_value:""},I=0;;I++){var C=R.lastIndex,A=R.exec(a),w=a.slice(C,A?A.index:a.length);if(S._value="",M+=r(w,S),p+=S._value,!A)break;if(M%2!=1){var x=e.getFullYear(),D=e.getDay(),b=e.getHours(),O=e.getMinutes(),F=e.getSeconds(),L=e.getMilliseconds(),U=e.getTimezoneOffset();switch(e>=new Date("1900/1/1")&&e<=new Date("1900/1/7")&&(D=(D+6)%7),A[0]){case"dddd":p+=i.dayNames[D];break;case"ddd":p+=i.abbreviatedDayNames[D];break;case"dd":c=d,p+=s(E(e,2),2);break;case"d":c=d,p+=E(e,2);break;case"MMMM":p+=i.monthGenitiveNames&&y()?i.monthGenitiveNames[E(e,1)]:i.monthNames[E(e,1)];break;case"MMM":p+=i.abbreviatedMonthGenitiveNames&&y()?i.abbreviatedMonthGenitiveNames[E(e,1)]:i.abbreviatedMonthNames[E(e,1)];break;case"MM":p+=s(E(e,1)+1,2);break;case"M":p+=E(e,1)+1;break;case"yyyy":case"yyy":p+=_>=0?g._formatEraPart("ee",e):s(N?N[0]:x,4);break;case"yy":p+=_>=0?g._formatEraPart("ee",e):s((N?N[0]:x)%100,2);break;case"y":p+=_>=0?g._formatEraPart("e",e):((N?N[0]:x)%100).toString();break;case"hh":0==(l=b%12)&&(l=12),p+=s(l,2);break;case"h":0==(l=b%12)&&(l=12),p+=l;break;case"HH":p+=s(b,2);break;case"H":p+=b.toString();break;case"mm":p+=s(O,2);break;case"m":p+=O.toString();break;case"ss":p+=s(F,2);break;case"s":p+=F.toString();break;case"tt":p+=b<12?i.amDesignator:i.pmDesignator;break;case"t":p+=(b<12?i.amDesignator:i.pmDesignator).charAt(0);break;case"f":case"0":p+=s(L,3).charAt(0);break;case"ff":case"00":p+=s(L,3).substr(0,2);break;case"fff":case"000":p+=s(L,3);break;case"z":p+=((l=U/60)<=0?"+":"-")+h(m(l));break;case"zz":p+=((l=U/60)<=0?"+":"-")+s(h(m(l)),2);break;case"zzz":p+=((l=U/60)<=0?"+":"-")+s(h(m(l)),2)+":"+s(m(U%60),2);break;case"g":case"gg":case"ggg":if(!g)break;if(_===I-1){_=I;break}p+=g._formatEraPart(A[0],e),_=I;break;case"e":case"ee":if(!g){p+=s(N?N[0]:x,4);break}if(T===I-1){T=I;break}p+=g._formatEraPart(A[0],e),T=I;break;case"/":p+=i.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[ss]":case"[s]":p+=A[0];break;default:throw new Error(n.wI.Exp_InvalidDateFormat)}}else p+=A[0]}return p.toString()}function r(e,t){for(var r=0,n=f,a=0,o=e.length;a<o;a++){var i=e.charAt(a);switch(i){case'"':n?t._value+="'":r++,n=f;break;case"\\":n&&(t._value+="\\"),n=!n;break;default:t._value+=i,n=f}}return r}function v(e,t){var r=new Date,n=e.DateTimeFormat.eras;if(n&&t<100){var a=n._getEraDate(r)._eraYear;(t+=a-a%100)>e.DateTimeFormat.Calendar.TwoDigitYearMax&&(t-=100)}return t}function y(e,t,i){e=e.trim();var u=i.DateTimeFormat,s=function(e,t){if(e._parseRegExp){if(e._parseRegExp[t])return e._parseRegExp[t]}else e._parseRegExp={};var a=t;a=(a=a.replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var i,u="^",s={_value:""},c=[],f=0,d=0,h=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[s\]|\[ss\]/g;(i=h.exec(a))!==l;){s._value="";var m=a.slice(f,i.index);if(f=h.lastIndex,d+=r(m,s),u+=s._value,d%2!=1){switch(i[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":u+="(\\D+)";break;case"tt":case"t":u+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":u+="(\\d\\d?)";break;case"yyy":case"yyyy":u+="(\\d{2}|\\d{4})";break;case"fff":case"000":u+="(\\d{3})";break;case"ff":case"00":u+="(\\d{2})";break;case"f":case"0":u+="(\\d)";break;case"zzz":u+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":u+="([+-]?\\d\\d?)";break;case"/":u+="(\\"+e.dateSeparator+")";break;default:throw new Error(n.wI.Exp_InvalidDateFormat)}o.Z._add(c,i[0])}else u+=i[0]}s._value="",r(a.slice(f),s),u+=s._value;var g=(u+="$").toString().replace(/\s+/g,"\\s+"),p={_regExp:g,_groups:c,_exp:new RegExp(g)};return e._parseRegExp[t]=p,p}(u,t),h=s._exp.exec(e);if(h===l)return l;for(var m,g=f,p=s._groups,y=l,N=l,M=l,R=l,E=l,_=0,T=0,S=0,I=0,C=l,A=f,w=0,x=p.length;w<x;w++){var D=h[w+1];if(D)switch(p[w]){case"dd":case"d":if((R=c(D,10))<1||R>31)return l;break;case"MMMM":if((M=i._getMonthIndex(D))<0||M>11)return l;break;case"MMM":if((M=i._getAbbrMonthIndex(D))<0||M>11)return l;break;case"M":case"MM":case"%M":if((M=c(D,10)-1)<0||M>11)return l;break;case"e":case"ee":if((N=v(i,c(D,10)))<0||N>9999)return l;break;case"y":case"yy":case"yyy":case"yyyy":if((N=c(D,10))<0||N>9999)return l;break;case"h":case"hh":case"H":case"HH":if((_=c(D,10))<0)return l;break;case"m":case"mm":if((T=c(D,10))<0||T>59)return l;break;case"s":case"ss":if((S=c(D,10))<0||S>59)return l;break;case"tt":case"t":var b=D.toUpperCase();if(!(A=b===u.pmDesignator.toUpperCase()||"PM"===b)&&b!==u.amDesignator.toUpperCase()&&"AM"!==b)return l;g=d;break;case"f":case"0":if((I=100*c(D,10))<0||I>999)return l;break;case"ff":case"00":if((I=10*c(D,10))<0||I>999)return l;break;case"fff":case"000":if((I=c(D,10))<0||I>999)return l;break;case"dddd":if((E=i._getDayIndex(D))<0||E>6)return l;break;case"ddd":if((E=i._getAbbrDayIndex(D))<0||E>6)return l;break;case"zzz":var O=D.split(/:/);if(2!==O.length)return l;if((m=c(O[0],10))<-12||m>13)return l;var F=c(O[1],10);if(F<0||F>59)return l;C=60*m+(a.Z._startsWith(D,"-")?-F:F);break;case"z":case"zz":if((m=c(D,10))<-12||m>13)return l;C=60*m;break;case"g":case"gg":case"ggg":var L=D;if(!L||!u.eras)return l;if((y=u.eras._parseEraPart(p[w],L))<0)return l}}var U,B=/^(\d|\d\d):/.test(e),k=new Date("1970/01/01 00:00:00 +0800"),P=B?new Date(k.getTime()+-22090752e5):new Date,H=u.Calendar.convert;if(H&&(U=H.fromGregorian(P)),H||(U=[P.getFullYear(),P.getMonth(),P.getDate()]),N===l?N=U[0]:N<100&&(u.eras&&y!==l?N=u.eras._getYearFromEra(y||0,N):N+=N>=30?1900:2e3),M===l&&(M=U[1]),R===l&&(R=U[2]),H){if((P=H.toGregorian(N,M,R))===l)return l}else{if(P.setFullYear(N,M,R),P.getDate()!==R)return l;if(E!==l&&P.getDay()!==E)return l}if(g&&_>12)return l;if(A&&_<12&&(_+=12),g&&!A&&12===_&&(_=0),P.setHours(_,T,S,I),C!==l){var G=P.getMinutes()-(C+P.getTimezoneOffset());P.setHours(P.getHours()+G/60,G%60)}return P}function N(e){var t=e.getTimezoneOffset();return-485===t&&(t=-485-43/60),t}return{_customCultureFormat:function(e,r,n){return n||(n=i.s._getCultureInfo()),t(e,r,n)},_localeFormat:function(e,r,n){return t(e,r,n||i.s._getCultureInfo())},_parseLocale:function(t,r,n){var a,o;return r||n||void 0===(o=g[t])?(a=r?[t,r]:[t],o=e(t,n||i.s._getCultureInfo(),a),r||n||(g[t]=o),o?new Date(o):o):o?new Date(o):o},_parseInvariant:function(t,r){return e(t,i.s._getCultureInfo("invariant"),[t,r])},_parseExact:y,_fromOADate:function(e){var t=e-25568,r=t>=0?1:-1,n=N(new Date(864e5*t)),a=(864e5*e*1440+r-3181068288e6+864e5*n)/1440,o=new Date(a),i=n>=0?1:-1,u=N(new Date(a+36e5*i));if(n!==u&&366!==e){var s=new Date(a+60*(u-n)*1e3);if(n>u){if(-1===i||u===N(o))return 999===s.getMilliseconds()?new Date(s.valueOf()+1):s}else if(n<u&&(1===i||u===N(o)))return 999===s.getMilliseconds()?new Date(s.valueOf()+1):s}return 999===o.getMilliseconds()?new Date(o.valueOf()+1):o},_fromOADateString:function(e){if("/OADate("===e.substr(0,8)){var t=parseFloat(e.substr(8,e.length-10));return this._fromOADate(t)}},_toOADateString:function(e){return"/OADate("+this._toOADate(e)+")/"},_toOADate:function(e){if(u(e))return 0;"number"==typeof e&&(e=new Date(e));var t=N(e);return(1440*e.getTime()+3181068288e6-864e5*t)/124416e6},_DT:function(e){var t=l,r=d;if(u(e))t=this._fromOADate(0);else if(e instanceof Date)t=new Date(e.valueOf());else if("string"==typeof e){var a=this._parseLocale(e);if(!a)if(isNaN(e))if(this._isInvalidDateString(e))r=f;else{a=new Date(e),isNaN(a.valueOf())&&(r=f);var o=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(e.replace(/ |\n/g,"").trim());o&&4===o.length&&(-1!==o.indexOf(a.getFullYear().toString())&&-1!==o.indexOf((a.getMonth()+1).toString())&&-1!==o.indexOf(a.getDate().toString())||(r=f))}else(a=p._fromOADate(parseFloat(e)))||(r=f);t=a}else"number"==typeof e?t=this._fromOADate(e):r=f;if(r)return t;throw n.wI.Exp_InvalidCast},_isInvalidDateString:function(e){var t=i.s._getCultureInfo().DateTimeFormat,r=function(e,t){var r=0;return t.forEach((function(t){t&&e.indexOf(t)>-1&&r++})),r>1};return r(e,t.monthNames)||r(e,t.abbreviatedMonthNames)||r(e,t.dayNames)||r(e,t.abbreviatedDayNames)},_isDate:function(e){return e&&(e.constructor===Date||e.getUTCDate&&e.setFullYear)}}}(),v=p},2471:function(e,t,r){r.d(t,{Z:function(){return R}});var n=r(8657),a=r(6593),o=(r(9678),r(1501)),i=r(7686).Z._isNullOrUndefined,u=a.Z,s=u._padZeroLeft,l=u._padZeroRight,c=null,f=parseInt,d=parseFloat,h=!1,m=!0,g=Math.floor,p=Math.abs,v=Math.pow,y=Math.min;function N(e,t,r){return e.substr(t,r)}function M(e){return RegexHelper._getReg(e)}var R=function(){var e="##################0",t="################",r={1:"+",0:"","-1":"-"},u=["0","#","?"],R={"¤":"¤",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH₵":"GH₵","ብር":"ብር","ر.س.‏":"ر.س.‏",XDR:"XDR","د.إ.‏":"د.إ.‏","د.ب.‏":"د.ب.‏","د.ج.‏":"د.ج.‏","ج.م.‏":"ج.م.‏","₪":"₪","د.ع.‏":"د.ع.‏","د.ا.‏":"د.ا.‏","ف.ج.ق.‏":"ف.ج.ق.‏","د.ك.‏":"د.ك.‏","ل.ل.‏":"ل.ل.‏","د.ل.‏":"د.ل.‏","د.م.‏":"د.م.‏","أ.م.‏":"أ.م.‏","ر.ع.‏":"ر.ع.‏","ر.ق.‏":"ر.ق.‏","ج.س.":"ج.س.",S:"S","£":"£","ل.س.‏":"ل.س.‏","د.ت.‏":"د.ت.‏","ر.ي.‏":"ر.ي.‏","₹":"₹",TSh:"TSh","€":"€","₼":"₼","₽":"₽",K:"K","лв.":"лв.","₦":"₦",CFA:"CFA","৳":"৳","¥":"¥",KM:"KM","КМ":"КМ",USh:"USh","Kč":"Kč","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","ރ.":"ރ.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","₱":"₱",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","₡":"₡",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","₲":"₲","Bs.":"Bs.","ريال":"ريال",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","֏":"֏",ISK:"ISK","₾":"₾","​":"​","₸":"₸","៛":"៛","₩":"₩","сом":"сом",Kz:"Kz","₭":"₭",MTn:"MTn","ден":"ден","₮":"₮","रु":"रु","Afl.":"Afl.","ߖߕ.":"ߖߕ.","руб.":"руб.","zł":"zł","؋":"؋",R$:"R$",Db:"Db",RON:"RON","₴":"₴",MAD:"MAD","රු.":"රු.","Lekë":"Lekë",den:"den",RSD:"RSD","дин.":"дин.","ܠ.ܣ.‏":"ܠ.ܣ.‏","Rs.":"Rs.","смн":"смн","฿":"฿","m.":"m.","₺":"₺","ⴷⵔ":"ⴷⵔ","soʻm":"soʻm","сўм":"сўм","₫":"₫",HK$:"HK$",MOP:"MOP",NT$:"NT$"};function E(e,t){for(var r=g(p(e)),n={_integer:1,_decimal:0};r>=10;)r/=10,n._integer++;var a,o=e.toString(),i=o.search(/e/gi),u=o.indexOf(t);if(-1!==i){var s=N(o,0,i),l=N(o,i+1),c=0;-1!==u&&(c=N(s,u+1).length),(a=c-d(l))<0&&(a=0),n._decimal=a}else a=0,-1!==u&&(a=N(o,u+1).length),n._decimal=a;return n}function _(e){for(var t={_symbol:e.charAt(0),_sign:0,_exp:0},r="",a=1;a<e.length;a++)if("+"===(r=e.charAt(a)))t._sign=1;else{if("-"!==r){if("0"===r){t._exp=e.length-a;break}throw new Error(n.wI.Exp_InvalidExponentFormat)}t._sign=-1}return t}function T(e,t){for(var r,n={_intPart:c,_decPart:c,_group:h,_scale:0,_percent:0,_permille:0,_exponent:c},a="",o=h,i=h,s=h,l=h,f=h,d=h,g=c,p=[],v=0;v<e.length;v++){if(r=e.charAt(v),o)a+=r,'"'===r&&(p.push(a),a="",o=h);else if(i){if("E"===g||"e"===g){if(!(["+","-","0"].indexOf(r)>=0)){i=h,v--;continue}a+=r}else if("+"===g||"-"===g){if("0"!==r){i=h,v--;continue}a+=r}else if("0"===g){if("0"!==r){i=h,f||(f=m,n._exponent=_(a)),v--;continue}a+=r}}else if("*"!==g&&"_"!==g&&"\\"!==g||""===a)if("*"===r||"_"===r||"\\"===r)d=h,""!==a&&(p.push(a),a=""),a+=r;else if("'"===r)d=h,""!==a&&(p.push(a),a=""),p.push(r);else if('"'===r)d=h,o=m,""!==a&&(p.push(a),a=""),a+=r;else if(u.indexOf(r)>=0)d=m,u.indexOf(g)<0&&""!==a&&(p.push(a),a=""),a+=r;else if("."!==r||s)if(r===t.percentSymbol)d=h,n._percent++,""!==a&&(p.push(a),a=""),p.push(r);else if(r===t.perMilleSymbol)d=h,n._permille++,""!==a&&(p.push(a),a=""),p.push(r);else if(r===t.percentGroupSeparator)if(d){""!==a&&(p.push(a),a="");for(var y=m,N="",M=v+1;M<e.length;M++){var R=e.charAt(M);if(""===N)if('"'===R)N=R;else{if(u.indexOf(R)>=0){y=h;break}if(R===t.numberDecimalSeparator||";"===R)break}else'"'===R&&(N="")}y?n._scale++:s||(R=e.charAt(v+1))&&u.indexOf(R)>=0&&(l=m)}else a+=r;else"E"===r||"e"===r?(d=h,i=m,""!==a&&(p.push(a),a=""),a+=r):(d=h,u.indexOf(g)>=0&&""!==a&&(p.push(a),a=""),a+=r);else""!==a&&(p.push(a),a=""),n._intPart=p,p=[],s=m,d=h;else a+=r,p.push(a),a="";g=r}return""!==a&&(i&&!f&&(n._exponent=_(a)),p.push(a)),l&&(n._group=m),s?n._decPart=p:n._intPart=p,n}function S(e){var t=c;if(e){t="";for(var r=0;r<e.length;r++){var n=e[r];/^(0|#|\?)+/g.test(n)&&(t+=n)}}return t}function I(a,o,i,u){var c=[];a=function(e,t,r,n){var a=e;return t>0&&(a=e*v(100,t)),r>0&&(a=e*v(1e3,r)),n>0&&(a=e/v(1e3,n)),a}(a,o._percent,o._permille,o._scale);var d=o._intPart,g=o._decPart;if(!d&&!g)return c;var M,_=S(d),T=S(g);if(T||(T=""),o._exponent){var I=function(e,t,r){var n={value:e,exponentValue:0},a=E(e,".")._integer,o=p(e),i=r?r.length:1;if(o>=1)a>i?(a-=i,n.value=e/v(10,a),n.exponentValue=a):n.exponentValue=0,-1===t._sign&&(t._sign=0);else if(o<1&&o>0){t._sign=-1;for(var u=v(10,i);10*o<u;)o*=10,n.exponentValue++;n.value*=v(10,n.exponentValue)}return n}(a,o._exponent,_);a=I.value,M=I.exponentValue}var C=E(a,"."),A=(i.numberGroupSizes,i.numberGroupSeparator,i.numberDecimalSeparator),w=i.negativeSign,x=function(e,t,r,n,a,o){var i=function(e,t){if(void 0===typeof t||0==+t)return Math.round(e);if(e=+e,t=+t,isNaN(e)||t%1!=0)return NaN;var r=e<0;return e=(e=r?-e:e).toString().split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t))),+((e=(e=r?-e:e).toString().split("e"))[0]+"e"+(e[1]?+e[1]+t:t))}(e,-t);isFinite(i)||(i=e);var u,c,d=(e=i).toString(),h=d.split(/e/i);return d=h[0],c=h.length>1?f(h[1],10):0,h=d.split("."),d=h[0],u=h.length>1?h[1]:"",c>0?(d+=(u=l(u,c)).slice(0,c),u=N(u,c)):c<0&&(c=-c,u=(d=e<0?o+s(d.replace(o,""),c+1):s(d,c+1)).slice(-c,d.length)+u,d=d.slice(0,-c)),d+(t>0?a+(u=u.length>t?u.slice(0,t):l(u,t)):"")}(a,y(C._decimal,T.length),0,0,A,w);if(u||(x=function(e,t){var r=e;return-1!==e.indexOf(t)&&(r=e.replace(/0+$/,"")),r}(x,A)),""===x)return c.push({type:"text",value:(d?d.join(""):"")+(g?g.join(""):"")}),c;var D={hasInfilling:h,infillIndex:-1,replaceExponent:h},b=x.split(A)[0];return d&&function(e,t,a,o,i,u,l,c){var f=c.numberGroupSizes,d=c.numberGroupSeparator,g=c.negativeSign,p=c.percentSymbol,v=c.perMilleSymbol,y=o._exponent,M=N(t,0,1);M===g&&(t=N(t,1));var E=1===t.length&&"0"===t?0:t.length;t=0===E?"":t;for(var _=0,T="",S=e.length-1;S>=0;S--){var I="",C=e[S];if(/^(0|#|\?)+/g.test(C)){if(T!==a){for(var A=C.length,w=E-_-1;w>=0&&A>0;w--)I=t.charAt(w)+I,A--,_++;for(var x=A-1;x>=0;x--){var D=C[x];_++,"0"===D?I=D+I:"?"===D&&(""!==I&&(u.push({type:"number",value:I}),I=""),u.push({type:"numberPlaceholder",value:D}))}(T=C+T)===a&&_<E&&(I=t.substr(0,E-_)+I),""!==I&&u.push({type:"number",value:I})}}else if(o._exponent&&!l.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(C)){l.replaceExponent=m;var b="";b+=y._symbol,b+=r[y._sign],b+=s(i.toString(),y._exp),u.push({type:"exponent",value:b})}else"_"===C[0]?u.push({type:"placeholder",value:C[1]}):"*"===C[0]?l.hasInfilling||(u.push({type:"fillingChar",value:C[1]}),l.hasInfilling=!0,l.infillIndex=u.length-1):"\\"===C[0]?2===C.length&&u.push({type:"text",value:C[1]}):'"'===C[0]&&'"'===C[C.length-1]?C.length>2&&u.push({type:"text",value:C.substr(1,C.length-2)}):C===p?u.push({type:"percent",value:C}):C===v?u.push({type:"permille",value:C}):R[C]?u.push({type:"currency",value:C}):u.push({type:"text",value:C})}M===g&&u.push({type:"text",value:M}),o._group===m&&function(e,t,r,a){for(var o=t[0],i=1,u=0,s=h,l=e.length,c=0;c<l;c++){var f=e[c].type;if("number"===f){for(var d="",g=e[c].value,p=g.length-1;p>=0;){if(o<1||o>9)throw new Error(n.wI.Exp_InvalidNumberGroupSize);/\d/gi.test(g[p])?(s&&(d&&e.push({type:"number",value:d}),e.push({type:"groupSeparator",value:r}),d="",s=h),u++):u=0,d=g[p]+d,u===o&&(s=m,u=0,i<t.length&&(o=t[i],i++)),p--}d&&e.push({type:f,value:d})}else"fillingChar"===f&&(a.infillIndex=e.length-l),e.push({type:f,value:e[c].value})}e.splice(0,l)}(u,f,d,l),u=u.reverse(),l.infillIndex=u.length-1-l.infillIndex}(d,b,_,o,M,c,D,i),"0"!==b&&""===_&&g&&c.push({type:"number",value:b}),g&&function(n,a,o,i,u,l,c,f,d){var h=d.numberDecimalSeparator,g=d.percentSymbol,p=d.perMilleSymbol,v=a.indexOf(h),y=u._exponent;(v>0||i!==e||o!==t)&&c.push({type:"decimalSeparator",value:h});for(var N=-1!==v?a.substring(v+1):"",M=0,E="",_=0;_<n.length;_++){var T=n[_];if(/^(0|#|\?)+/g.test(T)){var S="";if(E!==o){for(var I=T.length,C=0,A=M;I>0&&N.length-M>0;)S+=N.charAt(A),I--,M++,C++,A++;for(var w=C;I>0;){var x=T[w];w++,M++,I--,"0"===x?S+=x:"?"===x&&(""!==S&&(c.push({type:"number",value:S}),S=""),c.push({type:"numberPlaceholder",value:x}))}""!==S&&c.push({type:"number",value:S}),E+=T}}else if(y&&!f.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(T)){f.replaceExponent=m;var D="";D+=y._symbol,D+=r[y._sign],D+=s(l.toString(),y._exp),c.push({type:"exponent",value:D})}else"_"===T[0]?c.push({type:"placeholder",value:T[1]}):"*"===T[0]?(c.push({type:"fillingChar",value:T[1]}),f.hasInfilling&&c.splice(f.infillIndex,1),f.hasInfilling=!0,f.infillIndex=c.length-1):"\\"===T[0]?2===T.length&&c.push({type:"text",value:T[1]}):'"'===T[0]&&'"'===T[T.length-1]?T.length>2&&c.push({type:"text",value:T.substr(1,T.length-2)}):T===g?c.push({type:"percent",value:T}):T===p?c.push({type:"permille",value:T}):R[T]?c.push({type:"currency",value:T}):c.push({type:"text",value:T})}}(g,x,T,_,o,M,c,D,i),c}function C(e,t){if((e=i(e)?"":a.Z._trimEnd(e,"")).match(/^[+-]?infinity$/i))return d(e);if(e.match(/^0x[a-f0-9]+$/i))return f(e,10);var r,n,o=t.NumberFormat,u=o.numberNegativePattern,s=A(e,o,u),l=s[0],h=s[1];""===l&&1!==u&&(l=(s=A(e,o,1))[0],h=s[1]),""===l&&(l="+"),h[0]===o.currencySymbol&&(h=N(h,1));var m,g,p=h.indexOf("e");p<0&&(p=h.indexOf("E")),p<0?(n=h,r=c):(n=N(h,0,p),r=N(h,p+1));var v=n.indexOf(".");v<0?(m=n,g=c):(m=N(n,0,v),g=N(n,v+".".length)),m=m.split(",").join("");var y=",".replace(/\u00A0/g," ");","!==y&&(m=m.split(y).join(""));var M=l+m;if(g!==c&&(M+="."+g),M[M.length-1]===o.percentSymbol){M=N(M,0,M.length-1);var R=(M=a.Z._trimEnd(M,"")).indexOf(".");-1===R&&(R=M.length);var E="";E+=N(M,0,R-2),E+=".",E+=N(M,R-2,2),M=E+=N(M,R+1)}if(r!==c){var _=A(r,o,1);""===_[0]&&(_[0]="+"),M+="e"+_[0]+_[1]}return M.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?d(M):NaN}function A(e,t,r){var n=t.negativeSign,o=t.positiveSign,i=a.Z;if(4!==r&&2!==r||(n=" "+n,o=" "+o),4===r||3===r){if(i._endsWith(e,n))return["-",N(e,0,e.length-n.length)];if(i._endsWith(e,o))return["+",N(e,0,e.length-o.length)]}else if(2===r||1===r){if(i._startsWith(e,n))return["-",N(e,n.length)];if(i._startsWith(e,o))return["+",N(e,o.length)]}else{if(0!==r)throw new Error("");if(i._startsWith(e,"(")&&i._endsWith(e,")"))return["-",N(e,1,e.length-2)]}return["",e]}var w="#dot#",x="#group#";function D(e){var t=o.s._getCultureInfo().NumberFormat;return"string"==typeof e&&(t=o.s._getCultureInfo(e).NumberFormat),t}return{_parseLocale:function(e){return C(e,o.s._getCultureInfo())},_parseInvariant:function(e){return C(e,o.s._getCultureInfo("invariant"))},_customCultureFormat:function(e,t,r,n){return r||(r=o.s._getCultureInfo()),function(e,t,r,n){return t&&0!==t.length&&"i"!==t?function(e,t,r,n){return I(e,T(t,r),r,n)}(e,t,r.NumberFormat,n):r&&r.name.length>0?e.toLocaleString():e.toString()}(e,t,r,n)},_replaceNormalToCultureSymbol:function(e,t){if("string"!=typeof e)return e;var r=D(t),n=r.numberDecimalSeparator,a=r.numberGroupSeparator;return"."!==n&&(e=e.replace(M("[.]"),w)),","!==a&&(e=e.replace(M("[,]"),x)),"."!==n&&(e=e.replace(M(w),n)),","!==a&&(e=e.replace(M(x),a)),e},_replaceCultureSymbolToNormal:function(e,t){if("string"!=typeof e)return e;var r=D(t),n=r.numberDecimalSeparator,a=r.numberGroupSeparator;return"."!==n&&(e=e.replace(M("["+n+"]"),w)),","!==a&&(e=e.replace(M("["+a+"]"),x)),"."!==n&&(e=e.replace(M(w),".")),","!==a&&(e=e.replace(M(x),",")),e},_isValidCultureNumberString:function(e,t){if("string"==typeof e){var r=D(t),n=r.numberDecimalSeparator,a=r.numberGroupSeparator;if("."!==n&&"."!==a&&e.indexOf(".")>=0||","!==n&&","!==a&&e.indexOf(",")>=0)return!1}return!0},_parseFloat:function(e,t){return d(this._replaceCultureSymbolToNormal(e,t))},_toHexString:function(e,t,r){if(0!==p(g(e)-e))throw new Error(n.wI.Exp_BadFormatSpecifier);var a=e>=0?e.toString(16):(4294967295+e+1).toString(16);return a=t?a.toLowerCase():a.toUpperCase(),!i(r)&&a.length<r?s(a,r):a},_parseCustomNumberFormatter:T,_formatNumber:I,_formatObjectToSrting:function(e){var t="";if(Array.isArray(e)&&e.length>0)for(var r=0;r<e.length;r++){var n=e[r].type,a=e[r].value;if("placeholder"===n)t+=" ";else{if("fillingChar"===n)continue;t+="numberPlaceholder"===n?" ":a}}return t},_generalNumberInt:e,_generalNumberDec:t,_fixNumber:function(e,t){return"number"==typeof e&&e.toString().length>=t&&(e=e<1&&e>-1?+e.toFixed(t):+e.toPrecision(t)),e}}}()},8751:function(e,t,r){r.d(t,{Z:function(){return a}});var n=r(6593),a=function(){function e(){}return e._getReg=function(t){var r=e._regDict[t];return r||(r=e._regDict[t]=new RegExp(t,"g")),r.lastIndex=0,r},e._getRegIgnoreCase=function(t){var r=e._regDictIgnoreCase[t];return r||(r=e._regDictIgnoreCase[t]=new RegExp(t,"gi")),r.lastIndex=0,r},e._getRegWithConditions=function(t,r){var n=e._regDictIgnoreCase[t];return n||(n=e._regDictIgnoreCase[t]=new RegExp(t,r)),n.lastIndex=0,n},e._getWildcardCriteria=function(t,r,n,a){if(void 0===a&&(a=!1),e._wildcardParseRecord[t])return e._wildcardParseResultBuffer[t];var o="[~?*]+";if(a&&(o="[?*]+"),e._getReg(o).test(t)){for(var i,u=[],s=t.split(""),l={".":!0,"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0},c=0;c<s.length;c++)"~"===(i=s[c])&&c<s.length-1?("*"===(i=s[++c])||"?"===i?u.push("\\"):r&&u.push("~"),u.push(i)):"?"===i?u.push("."):"*"===i?(u.push("."),n?u.push("+"):u.push("*")):l[i]?(u.push("\\"),u.push(i)):"\\"===i?u.push("\\\\"):u.push(i);return u.join("")}return null},e._getWildcardCriteriaFullMatch=function(t,r,n,a){void 0===a&&(a=!1);var o=e._getWildcardCriteria(t,r,n,a);return o&&(o="^"+o+"$"),o},e._getReplaceSymbol=function(e,t){for(var r="#"+e+"0#",a=1;t.indexOf(r)>0;)r=n.Z._join(r,"#"+e+(a-1)+"#","#"+e+a+"#"),a++;return r},e._regDict={},e._regDictIgnoreCase={},e._wildcardParseRecord={},e._wildcardParseResultBuffer={},e._replaceRegString2NormalString=function(e){return e.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},e}()},8657:function(e,t,r){r.d(t,{Z:function(){return o},wI:function(){return a}});var n=r(2021),a={Exp_InvalidDateFormat:n.default.t("无效日期格式"),Exp_InvalidExponentFormat:n.default.t("无效指数格式"),Exp_InvalidSemicolons:n.default.t("无效格式 : 过多分号"),Exp_InvalidNumberGroupSize:n.default.t("数值组大小范围必须在 1 到 9 之间。"),Exp_BadFormatSpecifier:n.default.t("错误的格式指示符"),Exp_InvalidNumberFormat:n.default.t("无效数值格式"),Exp_InvalidCast:n.default.t("无效转换异常"),Exp_Separator:n.default.t("在文化信息中，小数点分隔符, 数组分隔符和列分隔符必须不相同。")},o={Exp_TokenIsNull:"token is null",Exp_InvalidBackslash:"the '\\' cannot be evaluated",Exp_FormatIllegal:"format is illegal.",Exp_ValueIsNull:"value is null",Exp_DuplicatedDescriptor:"The type of descriptor was added.",Exp_TokenIllegal:"token is illegal.",Exp_ValueIllegal:"value is illegal.",Exp_InvalidCast:"InvalidCastException"}},6593:function(e,t,r){r.d(t,{Z:function(){return u}});var n=r(7686).Z._isNullOrUndefined;function a(e,t,r){return e.substr(t,r)}var o={_contains:function(e,t,r){return r&&(e=e.toLowerCase(),t=t.toLowerCase()),""===t||e.indexOf(t)>=0},_indexOf:function(e,t,r){if(r){var n=e.toLowerCase(),a=t.toLowerCase();return n.indexOf(a)}return e.indexOf(t)},_trimStart:function(e,t){if(!t)return e;for(var r=e;a(r,0,t.length)===t;)r=a(r,t.length);return r},_trimEnd:function(e,t){if(!t)return e;for(var r=e;a(r,r.length-t.length,t.length)===t;)r=a(r,0,r.length-t.length);return r},_insert:function(e,t,r){if(t<0||t>e.length||n(r))throw new Error;return a(e,0,t)+r+a(e,t,e.length-t)},_remove:function(e,t,r){if(n(r)&&(r=e.length-t),t<0||r<0||t+r>e.length)throw new Error;return a(e,0,t)+a(e,t+r,e.length-t-r)},_startsWith:function(e,t,r){return i(e,t,r,(function(e,t){return e.slice(0,t.length)===t}))},_endsWith:function(e,t,r){return i(e,t,r,(function(e,t){return e.slice(-t.length)===t}))},_replace:function(e,t,r,n){if(!t)throw new Error;return r=(""+r).replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"+(n?"i":"")),r)},_replaceAllNoReg:function(e,t,n,a){return t=r(8751).Z._replaceRegString2NormalString(t),this._replace(e,t,n,a)},_leftBefore:function(e,t){var r=e.indexOf(t);return r<0||r>=e.length?e:a(e,0,r)},_count:function(e,t){for(var r=0,n=e.indexOf(t);n>=0;)r+=1,n=e.indexOf(t,n+1);return r},_join:function(e,t,r){return e.split(t).join(r)},_format:function(e,t){for(var r=e,n=0;n<t.length;n++){var a=new RegExp("\\{"+n+"\\}","g");r=r.replace(a,t[n])}return r},_padZero:function(e,t,r){for(var n=e.toString(),a=n.length;a<t;a++)n=r?"0"+n:n+"0";return n},_padZeroLeft:function(e,t){return o._padZero(e,t,!0)},_padZeroRight:function(e,t){return o._padZero(e,t,!1)},_compareStringIgnoreCase:function(e,t){return e===t||!e&&!t||e&&t&&e.toLowerCase()===t.toLowerCase()},_toUpperCase:function(e){return e.toUpperCase()},_escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=r(8751).Z._getReg("(?:&|<|>|\"|'|`)");return n.test(e)?e.replace(n,(function(e){return t[e]})):e},_unescapeHtml:function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},n=r(8751).Z._getReg("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return n.test(e)?e.replace(n,(function(e){return t[e]})):e}};function i(e,t,r,a){if(n(t))throw new Error;if(""===t)return!0;if(t.length>e.length)return!1;var o=e,i=t;return r&&(o=o.toLowerCase(),i=i.toLowerCase()),a(o,i)}var u=o},7686:function(e,t,r){r.d(t,{Z:function(){return a}});var n={_each:function(e,t){if(n._isArraylike(e))for(var r=0,a=e.length;r<a&&!1!==t.call(e[r],r,e[r]);r++);else for(var o in e)if(e.hasOwnProperty(o)&&!1===t.call(e[o],o,e[o]))break;return e},_isEmptyObject:function(e){return!e||"object"==typeof e&&0===Object.keys(e).length},_isFunction:function(e){return"function"===n._getType(e)},_isArray:function(e){return Array.isArray?Array.isArray(e):"array"===n._getType(e)},_isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},_getType:function(e){if(null===e)return"null";var t=n._class2type;if(!t){t=n._class2type={};for(var r=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],a=0,o=r.length;a<o;a++)t["[object "+r[a]+"]"]=r[a].toLowerCase()}var i=t.toString,u=typeof e;return"object"===u||"function"===u?t[i.call(e)]||"object":u},_inArray:function(e,t,r){var a;if(t){var o=[].indexOf;if(o)return o.call(t,e,r);for(a=t.length,n._isNullOrUndefined(r)&&(r=0),r=r<0?Math.max(0,a+r):r;r<a;r++)if(r in t&&t[r]===e)return r}return-1},_merge:function(e,t){var r=t.length,n=e.length,a=0;if("number"==typeof r)for(;a<r;a++)e[n++]=t[a];else for(;void 0!==t[a];)e[n++]=t[a++];return e.length=n,e},_map:function(e,t,r){var a,o=0,i=e.length,u=[];if(n._isArraylike(e))for(;o<i;o++)null!==(a=t(e[o],o,r))&&(u[u.length]=a);else for(o in e)e.hasOwnProperty(o)&&null!==(a=t(e[o],o,r))&&(u[u.length]=a);return[].concat.apply([],u)},_extend:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r,a,o,i,u,s,l=arguments[0]||{},c=1,f=arguments.length,d=!1;for("boolean"==typeof l&&(d=l,l=arguments[1]||{},c=2),"object"==typeof l||n._isFunction(l)||(l={}),f===c&&(l=this,--c);c<f;c++)if(u=arguments[c],!n._isNullOrUndefined(u))for(i in u)r=l[i],l!==(o=u[i])&&(a=n._isArray(o),d&&o&&(n._isPlainObject(o)||a)?(s=a?r&&n._isArray(r)?r:[]:r&&n._isPlainObject(r)?r:{},l[i]=n._extend(d,s,o)):void 0!==o&&(l[i]=o));return l},_inherit:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},_isWindow:function(e){return null!==e&&e===e.window},_isPlainObject:function(e){if(!e||"object"!==n._getType(e)||e.nodeType||n._isWindow(e))return!1;var t,r={}.hasOwnProperty;try{if(e.constructor&&!r.call(e,"constructor")&&!r.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(t in e);return void 0===t||r.call(e,t)},_isArraylike:function(e){if(n._isNullOrUndefined(e))return!1;var t=e.length,r=n._getType(e);return!n._isWindow(e)&&(!(1!==e.nodeType||!t)||"array"===r||"function"!==r&&(0===t||"number"==typeof t&&t>0&&t-1 in e))},_makeArray:function(e,t){var r=t||[];return null!==e&&(n._isArraylike(Object(e))?n._merge(r,"string"==typeof e?[e]:e):[].push.call(r,e)),r},_isType:function(e,t){return n._isNullOrUndefined(e)?"null"===t:!!t&&(t instanceof Function&&e instanceof t||typeof e===t||!("function"!==t||!/^\s*\bfunction\b/.test(""+e))||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===t.toLowerCase()||("DateTime"===t||"TimeSpan"===t?e instanceof Date:("string"==typeof t&&"undefined number boolean string".indexOf(t),!1)))},_isNullOrUndefined:function(e){return null==e},_isNumber:function(e,t){var a=r(2471).Z;return!!a._isValidCultureNumberString(e,t)&&(e=a._replaceCultureSymbolToNormal(e,t),n._isType(e,"number")||n._isType(e,"DateTime")||n._isType(e,"TimeSpan")||e&&!n._isType(e,"boolean")&&!isNaN(e)&&!isNaN(parseFloat(e))&&!(e.length>=2&&"0"===e[0]&&"x"===e[1]))},_toDouble:function(e){var t=r(8422).Z;return n._isNullOrUndefined(e)||""===e?0:n._isType(e,"number")?e:n._isType(e,"string")&&!isNaN(e)?r(2471).Z._parseLocale(e):n._isType(e,"boolean")?e?1:0:n._isType(e,"DateTime")?t._toOADate(e):n._isType(e,"TimeSpan")?Math.floor(t._toOADate(e)):parseFloat(e)},_cloneObject:function(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||n._isNullOrUndefined(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e);var t,r,a;for(r in t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf()),e)e.hasOwnProperty(r)&&(a=e[r],e.hasOwnProperty(r)&&t[r]!==a&&(t[r]="object"==typeof a?n._cloneObject(a):a));return t.toString=e.toString,t.valueOf=e.valueOf,t}},a=n},2021:function(e,t,r){var n,a;e.exports=(n={default:function(){return i.ZP}},a={},r.d(a,n),a)}},g={};function p(e){var t=g[e];if(void 0!==t)return t.exports;var r=g[e]={exports:{}};return m[e].call(r.exports,r,r.exports,p),r.exports}p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,{a:t}),t},p.d=function(e,t){for(var r in t)p.o(t,r)&&!p.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},p.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var v={};!function(){var e;p.d(v,{AD:function(){return i},Pz:function(){return S},QS:function(){return At},hP:function(){return rg},zD:function(){return t},nx:function(){return r},G8:function(){return ee},uC:function(){return q},VT:function(){return J},_S:function(){return z},lA:function(){return vr.lA},lr:function(){return vr.lr},yH:function(){return vr.yH},de:function(){return vr.de},zH:function(){return vr.zH},jr:function(){return vr.jr},D_:function(){return X},i1:function(){return K},n0:function(){return vr.n0},HD:function(){return vr.HD},o8:function(){return vr.o8},R8:function(){return te},Fz:function(){return Q}});var t={};p.r(t),p.d(t,{DIMENSION_TYPE:function(){return Y},Direction:function(){return V},FormulaGridRange:function(){return k},MUTATION_ID:function(){return $},deleteDimensionInGridRange:function(){return ne},getExceptRange:function(){return oe},getTwoGridRangeIntersect:function(){return ue},gridRangeToString:function(){return he},insertDimensionInGridRange:function(){return re},isGridRangeValid:function(){return de},isTwoGridRangeIntersect:function(){return ie},iteratorWithLimitGridRange:function(){return ae},mergeGridRanges:function(){return le},mergeGridRangesWithDirection:function(){return ce},splitIntersectGridRanges:function(){return se}});var r={};p.r(r),p.d(r,{BaseGraphSegmentManager:function(){return Be},DEFAULT_DIMENSION_END:function(){return F},DEFAULT_DIMENSION_START:function(){return O},DegreeTreeType:function(){return j},FORMULA_TYPE:function(){return b},FULL_TABLE_FORMULA_MODEL:function(){return B},FormulaGraph:function(){return Je},GraphMergeableType:function(){return Ne},GraphSegmentNode:function(){return Pe},GraphSegmentType:function(){return I},GraphService:function(){return Ze},GraphUpdateService:function(){return We},MergeableGraphSegmentManager:function(){return He},getDepOffsetRangeByRefOffsetRangeAndPart:function(){return ge},getSheetIdsFromPart:function(){return pe}});var i={};p.r(i),p.d(i,{AST_TYPE:function(){return C},BaseNode:function(){return nt},CELL_RANGE_TYPE:function(){return x},CROSS_TABLE_TYPE:function(){return A},CalcRef:function(){return lt},CellNode:function(){return at},CellRangeBinaryNode:function(){return it},CellRangeNode:function(){return ot},FunctionNode:function(){return ut},RANGE_BINARY_TYPE:function(){return D},VARIABLE_TYPE:function(){return w},VariableNode:function(){return st},default:function(){return wt},isASTNode:function(){return ct},isCalcRef:function(){return ft},isCell:function(){return dt},isCellNode:function(){return ht},isCellNodeCrossTable:function(){return gt},isCellRangeBinaryNode:function(){return Mt},isCellRangeNode:function(){return Rt},isCellRangeNodeCrossTable:function(){return yt},isCellRangeNodeCrossTableThreeDimension:function(){return Nt},isCrossTableCellNode:function(){return mt},isCrossTableCellRangeNode:function(){return pt},isCurrentNodeInPositionRelyFunction:function(){return St},isFunctionNode:function(){return Et},isFunctionNodeButNotBinaryNode:function(){return _t},isUserRange:function(){return vt},isVariableNode:function(){return Tt},walk:function(){return Ct}});var u={};p.r(u),p.d(u,{asyncCalculate:function(){return sn},calculateAstNode:function(){return ln},cellRangeCalcFuncByRefList:function(){return on},cellValueCalcFunc:function(){return nn},getCalcRef:function(){return cn},getCellValueByData:function(){return rn},getRangeValue:function(){return fn},getSheetIdBySheetName:function(){return tn},setCalculateService:function(){return Jr}});var d={};p.r(d),p.d(d,{HLOOKUP:function(){return No},LOOKUP:function(){return Mo},MATCH:function(){return io},VLOOKUP:function(){return yo}});var m={};p.r(m),p.d(m,{ERROR:function(){return _o},ISBLANK:function(){return Fo},ISERR:function(){return To},ISERROR:function(){return So},ISEVEN:function(){return Uo},ISFORMULA:function(){return Io},ISLOGICAL:function(){return Co},ISNA:function(){return Ao},ISNUMBER:function(){return wo},ISODD:function(){return Lo},ISREF:function(){return xo},ISTEXT:function(){return Do},N:function(){return Bo},NA:function(){return bo},TYPE:function(){return Oo}});var g={};p.r(g),p.d(g,{DATE:function(){return Xo},DATEVALUE:function(){return Ei},DAY:function(){return Ko},DAYS:function(){return Ti},DAYS360:function(){return Si},EDATE:function(){return vi},EOMONTH:function(){return pi},HOUR:function(){return hi},ISOWEEKNUM:function(){return yi},MINUTE:function(){return di},MONTH:function(){return qo},NETWORKDAYS:function(){return Qo},NOW:function(){return ei},SECOND:function(){return mi},TIME:function(){return Ri},TIMEVALUE:function(){return ii},TODAY:function(){return ti},WEEKDAY:function(){return ri},WEEKNUM:function(){return Mi},WORKDAY:function(){return fi},YEAR:function(){return ni},YEARFRAC:function(){return Ii},isLeapYear:function(){return ai},transSpDate:function(){return oi},weekday:function(){return ui}});var y={};p.r(y),p.d(y,{FLATTEN:function(){return Ou},JOIN:function(){return Fu}});var N={};p.r(N),p.d(N,{AVERAGE:function(){return ku},AVERAGEA:function(){return is},AVERAGEIF:function(){return os},AVERAGEIFS:function(){return Pu},CHIDIST:function(){return Rs},CORREL:function(){return vs},COUNT:function(){return Hu},COUNTA:function(){return Gu},COUNTBLANK:function(){return Yu},COUNTIF:function(){return Zu},COUNTIFS:function(){return Wu},FREQUENCY:function(){return Xu},GEOMEAN:function(){return Ns},HARMEAN:function(){return Ms},INTERCEPT:function(){return _s},KURT:function(){return Es},LARGE:function(){return ls},MAX:function(){return qu},MAXA:function(){return xs},MEDIAN:function(){return cs},MIN:function(){return zu},MINA:function(){return Ds},MODE:function(){return fs},PEARSON:function(){return Ts},PERCENTRANK:function(){return Os},RANK:function(){return rs},RSQ:function(){return Ss},SKEW:function(){return Is},SLOPE:function(){return Cs},SMALL:function(){return ss},STDEV:function(){return Ju},STDEVA:function(){return hs},STDEVPA:function(){return ms},TRANSPOSE:function(){return Qu},TRIMMEAN:function(){return As},VAR:function(){return es},VARA:function(){return gs},VARPA:function(){return ps}});var M={};p.r(M),p.d(M,{ABS:function(){return ol},ACOS:function(){return dc},ACOSH:function(){return Ac},ACOT:function(){return Fc},ACOTH:function(){return Lc},ADD:function(){return Ml},ADDRESS:function(){return nc},ASIN:function(){return fc},ASINH:function(){return Cc},ATAN:function(){return hc},ATAN2:function(){return Ic},ATANH:function(){return xc},AVEDEV:function(){return Ec},CEILING:function(){return ec},COLUMN:function(){return Ol},COS:function(){return lc},COSH:function(){return Dc},COT:function(){return bc},COTH:function(){return Oc},DECIMAL:function(){return dl},DEGREES:function(){return gc},DEVSQ:function(){return _c},DIVIDE:function(){return El},EQ:function(){return Cl},EVEN:function(){return Hc},EXP:function(){return Nc},FLOOR:function(){return rc},GTE:function(){return Tl},ID:function(){return Vl},ID_FOR_HK:function(){return jl},IFERROR:function(){return xl},INT:function(){return hl},ISO:function(){return tc},IS_VALID_ID:function(){return $l},LN:function(){return ql},LOG:function(){return ic},LOG10:function(){return yc},LOGICMATCH:function(){return cl},LT:function(){return Sl},LTE:function(){return Il},MATHMATCH:function(){return ll},MAXIFS:function(){return Pl},MINIFS:function(){return Hl},MINUS:function(){return Rl},MINVERSE:function(){return Ll},MMULT:function(){return Ul},MOD:function(){return ml},MROUND:function(){return Bc},MULTIPLY:function(){return _l},NE:function(){return Al},ODD:function(){return Pc},PI:function(){return mc},POW:function(){return wl},POWER:function(){return vc},PRODUCT:function(){return oc},RADIANS:function(){return pc},RAND:function(){return gl},RANDBETWEEN:function(){return Gc},ROMAN:function(){return Tc},ROUND:function(){return pl},ROUNDDOWN:function(){return Xl},ROUNDUP:function(){return vl},ROW:function(){return bl},SIN:function(){return sc},SINH:function(){return Sc},SPECIALMATCH:function(){return il},SQRT:function(){return yl},SQRTPI:function(){return Uc},STOCK:function(){return fl},SUBTOTAL:function(){return Nl},SUM:function(){return Fl},SUMIF:function(){return Gl},SUMIFS:function(){return kl},SUMPRODUCT:function(){return Yl},SUMSQ:function(){return Mc},TAN:function(){return cc},TANH:function(){return wc},TRUNC:function(){return Wl},round:function(){return Kl}});var R={};p.r(R),p.d(R,{ASC:function(){return cf},CHAR:function(){return df},CLEAN:function(){return _f},CODE:function(){return Rf},CONCAT:function(){return af},CONCATENATE:function(){return nf},DOLLAR:function(){return Tf},EXACT:function(){return gf},FIND:function(){return Wc},FIXED:function(){return sf},HYPERLINK:function(){return Af},LEFT:function(){return Xc},LEN:function(){return zc},LOWER:function(){return Mf},MID:function(){return Jc},PROPER:function(){return mf},REGEXMATCH:function(){return Qc},REPLACE:function(){return Ef},REPT:function(){return hf},RIGHT:function(){return Kc},SEARCH:function(){return Cf},SUBSTITUTE:function(){return ef},T:function(){return Sf},TEXT:function(){return If},TEXTJOIN:function(){return vf},TRIM:function(){return tf},UNICHAR:function(){return yf},UNICODE:function(){return Nf},UPPER:function(){return ff},URL:function(){return wf},VALUE:function(){return of}});var E={};p.r(E),p.d(E,{BESSELI:function(){return gd},BESSELJ:function(){return pd},BESSELK:function(){return vd},BESSELY:function(){return yd},BIN2DEC:function(){return Td},BIN2HEX:function(){return Id},BIN2OCT:function(){return Sd},COMPLEX:function(){return dd},CONVERT:function(){return mh},DATEDIF:function(){return Ud},DEC2BIN:function(){return Od},DEC2HEX:function(){return Fd},DEC2OCT:function(){return Ld},DELTA:function(){return gh},ERF:function(){return Bd},ERFC:function(){return kd},GESTEP:function(){return ph},HEX2BIN:function(){return Dd},HEX2DEC:function(){return xd},HEX2OCT:function(){return bd},IMCONJUGATE:function(){return fd},IMSUB:function(){return cd},INDEX:function(){return id},INDIRECT:function(){return ud},OCT2BIN:function(){return Ad},OCT2DEC:function(){return Cd},OCT2HEX:function(){return wd},OFFSET:function(){return sd}});var _={};p.r(_),p.d(_,{CUMIPMT:function(){return pm},CUMPRINC:function(){return vm},DB:function(){return Am},EFFECT:function(){return ym},FV:function(){return cm},FVSCHEDULE:function(){return nm},IPMT:function(){return um},IRR:function(){return mm},NOMINAL:function(){return Nm},PMT:function(){return om},PPMT:function(){return sm},PRICE:function(){return Em},PRICEDISC:function(){return _m},PRICEMAT:function(){return Tm},PV:function(){return fm},RATE:function(){return im},SLN:function(){return Rm},SYD:function(){return Mm},YIELD:function(){return Sm},YIELDDISC:function(){return Cm},YIELDMAT:function(){return Im}});var T={};p.r(T),p.d(T,{AND:function(){return Dm},CHOOSE:function(){return Um},FALSE:function(){return bm},IF:function(){return Om},NOT:function(){return Bm},OR:function(){return Fm},TRUE:function(){return Lm},XOR:function(){return km}});var S={};p.r(S),p.d(S,{CalculateCenter:function(){return Qm},Parser:function(){return gr},Token:function(){return rt},TokenType:function(){return qe},calcContext:function(){return et},error:function(){return Ut},hasError:function(){return kt},parseNumber:function(){return $t},parseTokens:function(){return ir},toCellId:function(){return jt},transformPosition:function(){return zm}});var I,C,A,w,x,D,b="FORMULA",O=0,F=1048576,L=["ROW()","COLUMN()"],U={startRowIndex:O,endRowIndex:F,startColIndex:O,endColIndex:F,isStartRowRelative:!1,isEndRowRelative:!1,isStartColRelative:!1,isEndColRelative:!1,isRowArray:!0,isColArray:!0,isPositionRely:!0,startSheetId:"",endSheetId:"",isCellRangeReferenceCorrect:!0},B={getAllCellRangeWithFixedInfo:function(){return[U]},getParts:function(){return["=SINGLE(",U,")"]},toString:function(e,t,r){return""},hasReferenceError:!1};!function(e){e.ALL="ALL",e.FORMULA="FORMULA_DEPENDENCY",e.DYNAMIC="DYNAMIC_DEPENDENCY",e.FULL_TABLE="FULL_TABLE_DEPENDENCY"}(I||(I={}));var k=function(){function e(e,t,r,n,a){this.sheetId=e,this.startRowIndex=t,this.endRowIndex=r,this.startColIndex=n,this.endColIndex=a}return(0,o.Z)(e,[{key:"isRow",get:function(){return this.startColIndex===O&&this.endColIndex===F}},{key:"isCol",get:function(){return this.startRowIndex===O&&this.endRowIndex===F}},{key:"isSheet",get:function(){return this.isRow&&this.isCol}}]),e}();!function(e){e.CELL="CELL",e.FUNCTION="FUNCTION",e.VARIABLE="VARIABLE",e.CELL_RANGE="CELL_RANGE",e.CELL_RANGE_BINARY="CELL_RANGE_BINARY"}(C||(C={})),function(e){e.NONE="NONE",e.NORMAL="NORMAL",e.THREE_DIMENSION="THREE_DIMENSION"}(A||(A={})),function(e){e.VARIABLE="VARIABLE",e.BINARY="BINARY",e.ORIGIN="ORIGIN",e.STR="STR",e.NUM="NUM",e.MINUS="MINUS",e.PERCENTAGE="PERCENTAGE",e.PLACEHOLDER="PLACEHOLDER",e.BOOL="BOOL",e.TIME="TIME",e.ERROR="ERROR"}(w||(w={})),function(e){e.NORMAL="NORMAL",e.ROW="ROW",e.COL="COL",e.USER_RANGE="USER_RANGE",e.CELL="CELL"}(x||(x={})),function(e){e.INTERSECTION="INTERSECTION",e.CONCAT="CONCAT"}(D||(D={}));var P=[1,26,676],H=[1,10,100,1e3,1e4,1e5,1e6,1e6];function G(e){return e<=127}var Y,V,$,j,Z,W=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function X(e){var t=e.charCodeAt(0);return!function(e){return e<=255}(t)||(G(t)?(t|=32)>=96&&t<=122:0===W[t]||1===W[t])}function K(e){var t=e.charCodeAt(0);return G(t)?t>=48&&t<=57:8===W[t]||10===W[t]}function q(e){for(var t=e.length,r={row:-1,col:-1},n=!1,a=!1,o=0;o<t;++o){var i=o,u=e[o],s=0;if(X(u)&&!n){do{(o+=1)<t&&(u=e[o])}while(o<t&&X(u));if(o-i>3)return{row:-1,col:-1};for(var l=o-1,c=l;c>=i;--c)s+=((32|e[c].charCodeAt(0))-96)*P[l-c];if(!(s<=16384))return{row:-1,col:-1};r.col=s-1,n=!0,o-=1}else{if(!K(u)||"0"===u||a){if("$"===u)continue;return{row:-1,col:-1}}do{(o+=1)<t&&(u=e[o])}while(o<t&&K(u));if(o-i>7)return{row:-1,col:-1};for(var f=o-1,d=0;f>=i;--f,++d)s+=(e[f].charCodeAt(0)-48)*H[d];s<=1048576&&(r.row=s-1),a=!0,o-=1}}return r}function z(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}function J(e){var t=e;"$"===t[0]&&(t=e.slice(1));var r,n=-1,a=0,o=t.length;do{r=t[n+=1]}while(n<o&&X(r));for(var i=n-1,u=i;u>=0;--u)a+=((32|t[u].charCodeAt(0))-96)*P[i-u];return a-1}function Q(e){if(-1===e.indexOf("$"))return parseInt(e,10)-1;var t=e;return t=t.replace(/\$/g,""),parseInt(t,10)-1}function ee(e,t,r){var n,a,o,i,u=e,s=t;switch(r){case x.NORMAL:var l,c,f=q(u),d=q(s),h=f.row,m=f.col,g=d.row,p=d.col;h>g&&(h=(l=[g,h])[0],g=l[1]),m>p&&(m=(c=[p,m])[0],p=c[1]),n=h,o=g-h+1,a=m,i=p-m+1;break;case x.ROW:var v;"$"===u[0]&&(u=u.slice(1)),"$"===s[0]&&(s=s.slice(1));var y=Number(u),N=Number(s);y>N&&(y=(v=[N,y])[0],N=v[1]),n=y-1,o=N-y+1,a=0,i=void 0;break;case x.COL:var M;"$"===u[0]&&(u=u.slice(1)),"$"===s[0]&&(s=s.slice(1));var R=J(u),E=J(s);R>E&&(R=(M=[E,R])[0],E=M[1]),n=0,o=void 0,a=R,i=E-R+1}return{row:n,col:a,rowCount:o,colCount:i}}function te(e){var t=e.lastIndexOf("!"),r=e;return t>-1&&(r=e.slice(t+1)),r}function re(e,t){var r=t.sheetId,n=t.type,a=t.index,o=t.amount;if(e.sheetId!==r)return!1;if(e.isSheet||e.isRow&&n===Y.COLUMNS||e.isCol&&n===Y.ROWS)return!0;var i,u,s=!0;return n===Y.ROWS?(i=e.startRowIndex,u=e.endRowIndex):(i=e.startColIndex,u=e.endColIndex),i>=a?(i+=o,u+=o):u>=a?u+=o:s=!1,n===Y.ROWS?(e.startRowIndex=i,e.endRowIndex=u):(e.startColIndex=i,e.endColIndex=u),s}function ne(e,t){var r=t.sheetId,n=t.type,a=t.index,o=t.amount;if(e.sheetId!==r)return!1;if(e.isSheet||e.isRow&&n===Y.COLUMNS||e.isCol&&n===Y.ROWS)return!0;var i,u,s=!0;return n===Y.ROWS?(i=e.startRowIndex,u=e.endRowIndex):(i=e.startColIndex,u=e.endColIndex),i>=a?(i=Math.max(a,i-o),u-=o):u>=a?u=Math.max(a-1,u-o):s=!1,n===Y.ROWS?(e.startRowIndex=i,e.endRowIndex=u):(e.startColIndex=i,e.endColIndex=u),s}function ae(e,t,r){var n=e.startRowIndex,a=e.startColIndex,o=e.sheetId,i=e.endRowIndex,u=e.endColIndex;if(e.isRow){if(!(null==r?void 0:r.colCount))return void console.error("gridRange each: isRow lack of sheet");u=r.colCount-1}if(e.isCol){if(!(null==r?void 0:r.rowCount))return void console.error("gridRange each: isCol lack of sheet");i=r.rowCount-1}void 0!==(null==r?void 0:r.rowCount)&&(i=Math.min(i,(null==r?void 0:r.rowCount)-1)),void 0!==(null==r?void 0:r.colCount)&&(u=Math.min(u,(null==r?void 0:r.colCount)-1));for(var s=n;s<=i;s++)for(var l=a;l<=u;l++)t(s,l,o)}function oe(e,t){if(!ie(e,t))return[e];var r=new k(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex),n=new k(t.sheetId,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex),a=[];if(r.startRowIndex<n.startRowIndex&&a.push(new k(e.sheetId,r.startRowIndex,n.startRowIndex-1,e.startColIndex,e.endColIndex)),r.endRowIndex>n.endRowIndex&&a.push(new k(e.sheetId,n.endRowIndex+1,r.endRowIndex,e.startColIndex,e.endColIndex)),r.startColIndex<n.startColIndex||r.endColIndex>n.endColIndex){var o=Math.max(e.startRowIndex,t.startRowIndex),i=Math.min(e.endRowIndex,t.endRowIndex);r.startColIndex<n.startColIndex&&a.push(new k(e.sheetId,o,i,r.startColIndex,n.startColIndex-1)),r.endColIndex>n.endColIndex&&a.push(new k(e.sheetId,o,i,n.endColIndex+1,r.endColIndex))}return a}function ie(e,t){return e.sheetId===t.sheetId&&(!!(e.isSheet||t.isSheet||e.isRow&&t.isCol||e.isCol&&t.isRow)||(e.isRow||t.isRow?t.endRowIndex>=e.startRowIndex&&t.startRowIndex<=e.endRowIndex:e.isCol||t.isCol?t.endColIndex>=e.startColIndex&&t.startColIndex<=e.endColIndex:t.endRowIndex>=e.startRowIndex&&t.startRowIndex<=e.endRowIndex&&t.endColIndex>=e.startColIndex&&t.startColIndex<=e.endColIndex))}function ue(e,t){if(!ie(e,t))return null;var r=Math.max(e.startRowIndex,t.startRowIndex),n=Math.max(e.startColIndex,t.startColIndex),a=Math.min(e.endRowIndex,t.endRowIndex),o=Math.min(e.endColIndex,t.endColIndex);return new k(e.sheetId,r,a,n,o)}function se(e){var t=[];return e.forEach((function(e){var r=[e];t.forEach((function(e){for(var t=[],n=0;n<r.length;n++)t.push.apply(t,(0,a.Z)(oe(r[n],e)));r=t})),t.push.apply(t,(0,a.Z)(r))})),t}function le(e){var t=ce(e,V.row),r=ce(t,V.col);return ce(r,V.row)}function ce(e,t){var r=new Map;e.forEach((function(e){var n=e.sheetId,a=e.startRowIndex,o=e.endRowIndex,i=e.startColIndex,u=e.endColIndex,s=fe(e,t),l=s.startMatchRangeKey,c=s.endMatchRangeKey,f=r.get(l),d=r.get(c);if(r.delete(l),r.delete(c),f||d){var h,m=fe(h=f&&d?new k(f.sheetId,f.startRowIndex,d.endRowIndex,f.startColIndex,d.endColIndex):f&&!d?new k(f.sheetId,f.startRowIndex,o,f.startColIndex,u):new k(d.sheetId,a,d.endRowIndex,i,d.endColIndex),t),g=m.startMatchRangeKey,p=m.endMatchRangeKey;r.set(g,h),r.set(p,h)}else{var v=new k(n,a,o,i,u);r.set(c,v),r.set(l,v)}}));var n=new Set;return r.forEach((function(e){n.add(e)})),Array.from(n)}function fe(e,t){var r=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,o=e.endColIndex,i=e.sheetId,u=r,s=n,l=a-1,c=o;return t===V.col&&(u=a,s=o,l=r-1,c=n),{startMatchRangeKey:i+","+u+","+s+","+l,endMatchRangeKey:i+","+u+","+s+","+c}}function de(e,t,r){return!!e.isSheet||(e.isRow?e.startRowIndex>=0&&e.startRowIndex<=e.endRowIndex&&(void 0===t||e.endRowIndex<=t-1):e.isCol?e.startColIndex>=0&&e.startColIndex<=e.endColIndex&&(void 0===r||e.endColIndex<=r-1):e.startRowIndex>=0&&e.startColIndex>=0&&e.startRowIndex<=e.endRowIndex&&e.startColIndex<=e.endColIndex&&(void 0===t||e.endRowIndex<=t-1)&&(void 0===r||e.endColIndex<=r-1))}function he(e,t){return void 0===t&&(t=!1),e.isSheet?e.sheetId+"!":e.isRow?(t?e.sheetId+"!":"")+(e.startRowIndex+1)+":"+(e.endRowIndex+1):e.isCol?(t?e.sheetId+"!":"")+z(e.startColIndex)+":"+z(e.endColIndex):(t?e.sheetId+"!":"")+(z(e.startColIndex)+(e.startRowIndex+1))+":"+(z(e.endColIndex)+(e.endRowIndex+1))}function me(e,t){return!(!e||!t)}function ge(e,t){var r=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,o=e.endColIndex,i=e.isStartRowRelative,u=e.isStartColRelative,s=e.isEndRowRelative,l=e.isEndColRelative,c=e.isRowArray,f=e.isColArray,d=t.startRowIndex,h=t.endRowIndex,m=t.startColIndex,g=t.endColIndex,p=i?d+r:r,v=s?h+n:n,y=u?m+a:a,N=l?g+o:o;return c?(y=O,N=F):f&&(p=O,v=F),{startRow:p,endRow:v,startCol:y,endCol:N}}function pe(e,t,r){var n=e.startSheetId,a=e.endSheetId,o=[t];return me(n,a)&&(o=r(n,a)),o}!function(e){e.ROWS="ROWS",e.COLUMNS="COLUMNS"}(Y||(Y={})),function(e){e[e.row=0]="row",e[e.col=1]="col"}(V||(V={})),(Z=$||($={}))[Z.INSERT_DIMENSION_MUTATION=0]="INSERT_DIMENSION_MUTATION",Z[Z.DELETE_DIMENSION_MUTATION=1]="DELETE_DIMENSION_MUTATION",Z[Z.MAP_RANGE_MUTATION=2]="MAP_RANGE_MUTATION",Z[Z.SET_RANGE_MUTATION=3]="SET_RANGE_MUTATION",Z[Z.SET_CELL_PROPERTIES_MUTATION=4]="SET_CELL_PROPERTIES_MUTATION",Z[Z.INSERT_SHEET_MUTATION=5]="INSERT_SHEET_MUTATION",Z[Z.DELETE_SHEET_MUTATION=6]="DELETE_SHEET_MUTATION",Z[Z.MOVE_SHEET_MUTATION=7]="MOVE_SHEET_MUTATION",function(e){e[e.IN_DEGREE=0]="IN_DEGREE",e[e.OUT_DEGREE=1]="OUT_DEGREE"}(j||(j={}));var ve,ye,Ne,Me=p(3776),Re=p.n(Me),Ee=(ve={default:function(){return s()}},ye={},p.d(ye,ve),ye),_e=p(9669),Te=p.n(_e),Se=p(4277),Ie=p(2582),Ce=p.n(Ie);function Ae(e,t){return void 0===t&&(t=""),e.sheetId+","+e.startRowIndex+","+e.endRowIndex+","+e.startColIndex+","+e.endColIndex+","+t}function we(e,t){return new k(e,t.minY,t.maxY,t.minX,t.maxX)}function xe(e,t){var r=e.id,n=e.index,a=e.type,o=e.amount,i=t.startRowIndex,u=t.startColIndex,s=t.endRowIndex,l=t.endColIndex,c=a===Y.ROWS?i:u,f=a===Y.ROWS?s:l;return!(t.isRow&&a===Y.COLUMNS||t.isCol&&a===Y.ROWS||!(r===$.INSERT_DIMENSION_MUTATION?n>c&&n<=f:r===$.DELETE_DIMENSION_MUTATION&&n<=f&&n+o-1>=c))}function De(e,t){var r=e.id,n=e.index,a=e.type,o=a===Y.ROWS?t.startRowIndex:t.startColIndex;return!(t.isRow&&a===Y.COLUMNS||t.isCol&&a===Y.ROWS||!(r===$.INSERT_DIMENSION_MUTATION?n<=o:r===$.DELETE_DIMENSION_MUTATION?n<o:n<=o))}function be(e,t){switch(e.id){case $.INSERT_DIMENSION_MUTATION:re(t,e);break;case $.DELETE_DIMENSION_MUTATION:ne(t,e)}return t}function Oe(e){var t=e.topSortRanges,r=e.cycleRanges;return[].concat((0,a.Z)(r.map((function(e){return{range:e,isInCycle:!0}}))),(0,a.Z)(t.map((function(e){return{range:e}}))))}function Fe(e){var t=[];return e.forEach((function(e){var r=e.range,n=r.sheetId;ae(r,(function(e,r){var a=B;null!==a&&t.push({row:e,col:r,sheetId:n,formulaModel:a,nodeInfo:void 0})}))})),t}function Le(e,t){var r;return r=function(e){return!!e.getId()}(e)?{range:t,id:e.getId()}:{range:t},r}function Ue(e){var t,r=e.inDegreeSegmentNode,n=e.partIdx,a=e.customType,o=e.getFormulaModelByRowCol;if(void 0!==n){var i=r.gridRange,u=o(i.startRowIndex,i.startColIndex,i.sheetId,{customType:a,inDegreeSegmentNode:r});return null===(t=null==u?void 0:u.getAllCellRangeWithFixedInfo())||void 0===t?void 0:t[n]}}p(5564);var Be=function(){function e(e,t){this.externalMethods=t,this.type=e,this.inDegreeTree={},this.outDegreeTree={}}var t=e.prototype;return t.destroy=function(){this.inDegreeTree={},this.outDegreeTree={}},t.getTreeMap=function(){return{inDegreeTreeMap:this.inDegreeTree,outDegreeTreeMap:this.outDegreeTree}},t.getTreeBySheetId=function(e){return{inDegreeTree:this.inDegreeTree[e],outDegreeTree:this.outDegreeTree[e]}},t.getTreeBySheetIdAndDegreeTreeType=function(e,t){return t===j.IN_DEGREE?this.inDegreeTree[e]:this.outDegreeTree[e]},t.searchInTree=function(e,t){var r,n=e.sheetId,a=e.startColIndex,o=e.endColIndex,i=e.startRowIndex,u=e.endRowIndex;return(null===(r=(t===j.IN_DEGREE?this.inDegreeTree:this.outDegreeTree)[n])||void 0===r?void 0:r.search({minX:a,maxX:o,minY:i,maxY:u}))||[]},t.removeNodeAndRelatedNodesInTree=function(e,t){var r=this,n=t===j.IN_DEGREE?j.OUT_DEGREE:j.IN_DEGREE;e.relationshipSegments.forEach((function(t){var a=t.node,o=a.gridRange.sheetId;a.removeRelationship(e),0===a.relationshipSegments.length&&r.removeNodeInTree(o,a,n)}));var a=e.gridRange.sheetId;this.removeNodeInTree(a,e,t)},t.getRefRangeByDepRange=function(e,t){var r=this;this.searchInTree(e,j.OUT_DEGREE).forEach((function(n){var a=ue(n.gridRange,e);a&&n.relationshipSegments.forEach((function(e){var n=e.node,o=Ue({inDegreeSegmentNode:n,partIdx:e.partIdx,customType:r.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});if(o){var i=function(e,t,r){var n=r.startRowIndex,a=r.endRowIndex,o=r.startColIndex,i=r.endColIndex,u=r.isStartRowRelative,s=r.isStartColRelative,l=r.isEndRowRelative,c=r.isEndColRelative,f=r.isRowArray,d=r.isColArray,h=e.startRowIndex,m=e.endRowIndex,g=e.startColIndex,p=e.endColIndex,v=l?t.startRowIndex-a:e.startRowIndex,y=u?t.endRowIndex-n:e.endRowIndex,N=c?t.startColIndex-i:e.startColIndex,M=s?t.endColIndex-o:e.endColIndex;return v=Math.max(h,v),N=Math.max(g,N),y=Math.min(m,y),M=Math.min(p,M),f?(N=e.startColIndex,M=e.endColIndex):d&&(v=e.startRowIndex,y=e.endRowIndex),{startRow:v,endRow:y,startCol:N,endCol:M}}(n.gridRange,a,o),u=i.startRow,s=i.endRow,l=i.startCol,c=i.endCol,f=new k(n.gridRange.sheetId,u,s,l,c);de(f)&&t({inDegreeSegmentNode:n,offsetRefRange:f})}else t({inDegreeSegmentNode:n,offsetRefRange:n.gridRange})}))}))},t.getDepRangeByRefRange=function(e,t){var r=this;this.searchInTree(e,j.IN_DEGREE).forEach((function(n){var a=ue(n.gridRange,e);a&&n.relationshipSegments.forEach((function(e){var o=e.node,i=e.partIdx,u=Ue({inDegreeSegmentNode:n,partIdx:i,customType:r.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});if(u){var s=u.startRowIndex,l=u.endRowIndex,c=u.startColIndex,f=u.endColIndex,d=u.isStartRowRelative,h=u.isStartColRelative,m=u.isEndRowRelative,g=u.isEndColRelative,p=d?a.startRowIndex+s:s,v=m?a.endRowIndex+l:l,y=h?a.startColIndex+c:c,N=g?a.endColIndex+f:f,M=new k(o.gridRange.sheetId,p,v,y,N);de(M)&&t({outDegreeSegmentNode:o,offsetRefRange:M})}else t({outDegreeSegmentNode:o,offsetRefRange:o.gridRange})}))}))},t.addDependency=function(e,t){return e.addRelationshipSegment(t),t.addRelationshipSegment(e),this.loadNodesInTree(e.gridRange.sheetId,[e],j.IN_DEGREE),this.loadNodesInTree(t.gridRange.sheetId,[t],j.OUT_DEGREE),!0},t.toJson=function(e){var t=void 0===e,r=this.getTreeMap(),n=r.inDegreeTreeMap,a=r.outDegreeTreeMap,o=function(e){return Object.assign(Object.assign({},e),{relationshipSegments:[]})},i={};return Object.entries(n).forEach((function(r){var n=r[0],a=r[1];(t||(null==e?void 0:e.includes(n)))&&(i[n]={outDegreeNodes:[],inDegreeNodes:(null==a?void 0:a.all().map(o))||[]})})),Object.entries(a).forEach((function(r){var n=r[0],a=r[1];(t||(null==e?void 0:e.includes(n)))&&(i[n]=Object.assign(Object.assign({},i[n]),{outDegreeNodes:(null==a?void 0:a.all().map(o))||[]}))})),i},t.loadNodesInTree=function(e,t,r){var n,a=r===j.IN_DEGREE?this.inDegreeTree:this.outDegreeTree;a[e]||this.createTree(e),null===(n=a[e])||void 0===n||n.load(t)},t.removeTree=function(e){var t=this,r=this.getTreeBySheetIdAndDegreeTreeType(e,j.IN_DEGREE);null==r||r.all().forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,j.IN_DEGREE)}));var n=this.getTreeBySheetIdAndDegreeTreeType(e,j.OUT_DEGREE);null==n||n.all().forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,j.IN_DEGREE)}))},t.removeNodeInTree=function(e,t,r){var n;null===(n=(r===j.IN_DEGREE?this.inDegreeTree:this.outDegreeTree)[e])||void 0===n||n.remove(t),t.clearRelationship()},t.createTree=function(e){this.inDegreeTree[e]=new ke(7),this.outDegreeTree[e]=new ke(7)},e}(),ke=function(e){function t(){return e.apply(this,arguments)||this}(0,n.Z)(t,e);var r=t.prototype;return r.toBBox=function(e){var t=e.gridRange;return{minX:t.startColIndex,minY:t.startRowIndex,maxX:t.endColIndex,maxY:t.endRowIndex}},r.compareMinX=function(e,t){var r=e.gridRange,n=t.gridRange;return r.startColIndex-n.startColIndex},r.compareMinY=function(e,t){var r=e.gridRange,n=t.gridRange;return r.startRowIndex-n.startRowIndex},r.walk=function(e){for(var t=[this.data];t.length>0;){var r=t.pop();!1!==e(r)&&!1===r.leaf&&t.push.apply(t,(0,a.Z)(r.children))}},t}(Ce()),Pe=function(){function e(e,t){this.gridRange=e,t&&(this.nodeInfo=t),this.relationshipSegments=[]}var t=e.prototype;return t.addRelationshipSegment=function(e,t){this.relationshipSegments.some((function(t){return t.node===e}))||this.relationshipSegments.push({node:e,partIdx:t})},t.removeRelationship=function(e){var t=this.relationshipSegments.findIndex((function(t){return t.node===e}));-1!==t&&this.relationshipSegments.splice(t,1)},t.clearRelationship=function(){this.relationshipSegments=[]},t.getId=function(){var e;return null===(e=this.nodeInfo)||void 0===e?void 0:e.id},e}(),He=function(e){function t(t,r){return e.call(this,t,r)||this}(0,n.Z)(t,e);var r=t.prototype;return r.addNodesFromChangedNodes=function(e){if(0!==e.length){var t=this.getSameFormulaModelChangedNodes(e),r=t.formulaBecomeConstNodesMap,n=t.sameFormulaModelChangedNodesMap,a=this.getAddAndDeleteRanges(r,n),o=a.deleteGraphSegmentNodesMap,i=a.addGraphSegmentNodesMap,u=this.compareWithOldSegmentAndGetDeleteAddSegment(o,i),s=u.deleteInDegreeGraphSegmentSet,l=u.needAddGraphSegmentNodesMap;return this.loadSegmentInTree({deleteInDegreeGraphSegmentSet:s,needAddGraphSegmentNodesMap:l})}},r.loadSegmentInTree=function(e){var t=this,r=e.deleteInDegreeGraphSegmentSet,n=e.needAddGraphSegmentNodesMap;r.forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,j.IN_DEGREE)}));var a=this.generateDegreeListHashByInDegreeMap(n),o=a.inDegreeGraphSegmentNodeHash,i=a.outDegreeGraphSegmentNodeHash;return Object.keys(o).forEach((function(e){var r=o[e];t.loadNodesInTree(e,r,j.IN_DEGREE)})),Object.keys(i).forEach((function(e){var r=i[e];t.loadNodesInTree(e,r,j.OUT_DEGREE)})),{customNodeType:this.type,inDegreeNodesMap:o}},r.generateDegreeListHashByInDegreeMap=function(e){var t=this,r={},n={},a={};return e.forEach((function(e,o){var i=e.gridRanges,u=e.nodeInfo;i.forEach((function(e){if(o){var i=new Pe(e,u);(null==o?void 0:o.getAllCellRangeWithFixedInfo()).forEach((function(n,o){if(!0!==n.isPositionRely){var u=ge(n,e),s=u.startRow,l=u.endRow,c=u.startCol,f=u.endCol;pe(n,e.sheetId,t.externalMethods.getSheetIdsAmongTwoSheets).forEach((function(e){var t=Ae({startRowIndex:s,endRowIndex:l,startColIndex:c,endColIndex:f,sheetId:e}),n=a[t];n||(n=new Pe(new k(e,s,l,c,f)),a[t]=n,r[e]||(r[e]=[]),r[e].push(n)),n.addRelationshipSegment(i,o),i.addRelationshipSegment(n,o)}))}})),n[e.sheetId]||(n[e.sheetId]=[]),n[e.sheetId].push(i)}else console.error("入度节点有问题？",e)}))})),{inDegreeGraphSegmentNodeHash:n,outDegreeGraphSegmentNodeHash:r}},r.compareWithOldSegmentAndGetDeleteAddSegment=function(e,t){var r=this,n=new Set,o=new Map;this.splitOldInDegreeSegmentWithAddRange({deleteInDegreeGraphSegmentSet:n,splitGraphSegmentNodeMap:o,addGraphSegmentNodesMap:t}),e.forEach((function(e,t){e.gridRanges.forEach((function(e){r.splitOldInDegreeSegment({inDegreeSegment:t,gridRange:e,deleteInDegreeGraphSegmentSet:n,splitGraphSegmentNodeMap:o})}))}));var i=new Set;return o.forEach((function(e,n){var o;if(0!==e.gridRanges.length){var u=e.gridRanges[0],s=u.startRowIndex,l=u.startColIndex,c=u.sheetId,f=r.externalMethods.getFormulaModelByRowCol(s,l,c,{customType:r.type,id:n.getId(),inDegreeSegmentNode:n});if(f){var d=t.get(f)||{gridRanges:[],nodeInfo:e.nodeInfo};(o=d.gridRanges).push.apply(o,(0,a.Z)(e.gridRanges)),t.set(f,d),i.add(f)}}})),i.forEach((function(e){var r,n=t.get(e);if(n&&(null===(r=n.gridRanges)||void 0===r?void 0:r.length)){var a=le(se(n.gridRanges));t.set(e,{nodeInfo:n.nodeInfo,gridRanges:a})}else t.delete(e)})),{deleteInDegreeGraphSegmentSet:n,needAddGraphSegmentNodesMap:t}},r.splitOldInDegreeSegmentWithAddRange=function(e){var t=this,r=e.deleteInDegreeGraphSegmentSet,n=e.splitGraphSegmentNodeMap;e.addGraphSegmentNodesMap.forEach((function(e,a){e.gridRanges.forEach((function(e){var o=e.startColIndex,i=e.endColIndex,u=e.startRowIndex,s=e.endRowIndex,l=e.sheetId;t.mergeOldInDegreeSegment({formulaModel:a,gridRange:e,deleteInDegreeGraphSegmentSet:r,splitGraphSegmentNodeMap:n}),t.searchInTree({sheetId:l,startColIndex:o,endColIndex:i,startRowIndex:u,endRowIndex:s},j.IN_DEGREE).forEach((function(a){t.splitOldInDegreeSegment({gridRange:e,inDegreeSegment:a,deleteInDegreeGraphSegmentSet:r,splitGraphSegmentNodeMap:n})}))}))}))},r.mergeOldInDegreeSegment=function(e){var t,r=this,n=e.formulaModel,a=e.gridRange,o=e.deleteInDegreeGraphSegmentSet,i=e.splitGraphSegmentNodeMap,u=function(e){return new k(e.sheetId,e.startRowIndex-1,e.endRowIndex+1,e.startColIndex-1,e.endColIndex+1)}(a);return this.searchInTree(u,j.IN_DEGREE).every((function(e){var u=e.gridRange,s=u.startRowIndex,l=u.startColIndex,c=u.sheetId,f=r.externalMethods.getFormulaModelByRowCol(s,l,c,{customType:r.type,id:e.getId(),inDegreeSegmentNode:e});if(n!==f)return!0;var d=i.get(e)||{gridRanges:[e.gridRange],nodeInfo:e.nodeInfo};return d.gridRanges.every((function(u,s){var l;if(ie(u,a))return!0;var c,f,h=(f=a,(c=u).sheetId!==f.sheetId?null:c.startRowIndex!==f.startRowIndex||c.endRowIndex!==f.endRowIndex||c.endColIndex!==f.startColIndex-1&&f.endColIndex!==c.startColIndex-1?c.startColIndex!==f.startColIndex||c.endColIndex!==f.endColIndex||c.endRowIndex!==f.startRowIndex-1&&f.endRowIndex!==c.startRowIndex-1?null:V.col:V.row);if(null===h)return!0;l=ce([u,a],h),t=l[0],o.add(e);var m=r.mergeOldInDegreeSegment({formulaModel:n,gridRange:t,deleteInDegreeGraphSegmentSet:o,splitGraphSegmentNodeMap:i});return t=m||t,d.gridRanges[s]=t,i.set(e,d),!1}))})),t},r.splitOldInDegreeSegment=function(e){var t=e.gridRange,r=e.inDegreeSegment,n=e.deleteInDegreeGraphSegmentSet,o=e.splitGraphSegmentNodeMap,i=o.get(r)||{gridRanges:[r.gridRange],nodeInfo:r.nodeInfo},u={gridRanges:[]};i.gridRanges.forEach((function(e){var r,n=oe(e,t);n.length?(r=u.gridRanges).push.apply(r,(0,a.Z)(n)):ie(e,t)||u.gridRanges.push(e),u.nodeInfo=i.nodeInfo})),0===u.gridRanges.length?o.delete(r):o.set(r,u),n.add(r)},r.getAddAndDeleteRanges=function(e,t){var r=new Map,n=new Map;return t.forEach((function(e,t){var n=le(e.map((function(e){var t=e.row,r=e.col;return{startRowIndex:t,endRowIndex:t,startColIndex:r,endColIndex:r,sheetId:e.sheetId}})));r.set(t,{gridRanges:n,nodeInfo:e[0].nodeInfo})})),e.forEach((function(e,t){var r=le(e.map((function(e){var t=e.row,r=e.col;return{startRowIndex:t,endRowIndex:t,startColIndex:r,endColIndex:r,sheetId:e.sheetId}})));n.set(t,{gridRanges:r,nodeInfo:e[0].nodeInfo})})),{deleteGraphSegmentNodesMap:n,addGraphSegmentNodesMap:r}},r.getSameFormulaModelChangedNodes=function(e){var t=this,r=new Map,n=new Map;return e.forEach((function(e){var a=e.col,o=e.row,i=e.sheetId;if(e.formulaModel){var u=r.get(e.formulaModel);u||(u=[],r.set(e.formulaModel,u)),u.push(e)}else{var s=t.searchInTree({sheetId:i,startColIndex:a,endColIndex:a,startRowIndex:o,endRowIndex:o},j.IN_DEGREE)[0];if(s){var l=n.get(s);l||(l=[],n.set(s,l)),l.push(e)}}})),{sameFormulaModelChangedNodesMap:r,formulaBecomeConstNodesMap:n}},t}(Be);function Ge(e){return e.id===$.INSERT_DIMENSION_MUTATION}function Ye(e){return e.id===$.DELETE_DIMENSION_MUTATION}function Ve(e){return e.id===$.MAP_RANGE_MUTATION}function $e(e){return e.id===$.INSERT_SHEET_MUTATION}function je(e){return{sheetId:e.sheetId,startRowIndex:e.row,endRowIndex:e.row,startColIndex:e.col,endColIndex:e.col}}var Ze=function(){function e(e,t){var r;this.externalMethods=t,this.graphUpdateService=new We({getSheetIdBySheetIndex:this.externalMethods.getSheetIdBySheetIndex,getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol});var n=new He(e,t),a=new He(e,t),o=new Be(e,t);this.graphSegmentManagerMap=((r={})[I.FORMULA]=n,r[I.DYNAMIC]=o,r[I.FULL_TABLE]=a,r)}var t=e.prototype;return t.destroy=function(){this.graphSegmentManagerMap.DYNAMIC_DEPENDENCY.destroy(),this.graphSegmentManagerMap.FULL_TABLE_DEPENDENCY.destroy(),this.graphSegmentManagerMap.FORMULA_DEPENDENCY.destroy()},t.removeFormulaNodes=function(e,t,r){this.removeFormulaNodesInSegmentManager(this.getFormulaGraphSegmentManager(),e,t,r),this.removeFormulaNodesInSegmentManager(this.getDynamicGraphSegmentManager(),e,t,r)},t.addDynamicDependency=function(e,t,r){var n=e.gridRange.sheetId,a=this.getDynamicGraphSegmentManager(),o=this.getFullTableGraphSegmentManager(),i=this.isAlreadyHasThisDependencyRelationship(e.gridRange,t.gridRange,a).isAlreadyHasThisDependency;if(!i){a.addDependency(e,t);var u=Object.assign(r||{},{formulaModel:B}),s=new Pe(e.gridRange,u),l=new Pe(new k(n,O,F,O,F));o.addDependency(s,l)}return!i},t.addDependency=function(e,t){var r=this.getFormulaGraphSegmentManager();t?r.addDependency(e,t):r.loadNodesInTree(e.gridRange.sheetId,[e],j.IN_DEGREE)},t.addFormulaNodes=function(e){var t=this,r=[],n=[],a=this.getFormulaGraphSegmentManager(),o=this.getFullTableGraphSegmentManager(),i=this.getDynamicGraphSegmentManager();e.forEach((function(e){r.push(e);var a=t.isInDegreeNodeDynamicDependency(e),o=a.isDynamicDependency,u=a.inDegreeNode;o&&(i.removeNodeAndRelatedNodesInTree(u,j.IN_DEGREE),n.push(Object.assign(Object.assign({},e),{formulaModel:void 0})));var s=t.isInDegreeNodePositionDependency(e),l=function(e){if(!e)return!1;for(var t=e.getParts(),r=function(e){var r=t[e];if("string"==typeof r){if(L.some((function(e){return r.includes(e)})))return{v:!0}}else if(null==r?void 0:r.isPositionRely)return{v:!0}},n=0;n<t.length;n++){var a=r(n);if("object"===typeof a)return a.v}return!1}(e.formulaModel);!s&&l?n.push(Object.assign(Object.assign({},e),{formulaModel:B})):s&&!l&&n.push(Object.assign(Object.assign({},e),{formulaModel:void 0}))}));var u=a.addNodesFromChangedNodes(r);return o.addNodesFromChangedNodes(n),u},t.getRefRangeByDepRange=function(e,t){var r=[];this.getDynamicGraphSegmentManager().getRefRangeByDepRange(e,(function(e){var t=e.offsetRefRange;r.push(t)}));var n=this.getFormulaGraphSegmentManager(),a=new WeakSet;r.forEach((function(e){n.searchInTree(e,j.IN_DEGREE).forEach((function(r){t({offsetRefRange:e,inDegreeSegmentNode:r}),a.add(r)}))})),this.getFormulaGraphSegmentManager().getRefRangeByDepRange(e,(function(e){var r=e.inDegreeSegmentNode,n=e.offsetRefRange;a.has(r)||t({inDegreeSegmentNode:r,offsetRefRange:n})}))},t.getOutDegreeNodesBySheetId=function(e){return[].concat((0,a.Z)(this.getOutDegreeNodesBySheetIdAndType(e,I.DYNAMIC)),(0,a.Z)(this.getOutDegreeNodesBySheetIdAndType(e,I.FORMULA)))},t.getDepRangeByRefRange=function(e,t){var r=[];this.getDynamicGraphSegmentManager().getDepRangeByRefRange(e,(function(e){var t=e.offsetRefRange;r.push(t)}));var n=this.getFormulaGraphSegmentManager(),a=new WeakSet;r.forEach((function(e){n.searchInTree(e,j.OUT_DEGREE).forEach((function(r){t({offsetRefRange:e,outDegreeSegmentNode:r}),a.add(r)}))})),this.getFormulaGraphSegmentManager().getDepRangeByRefRange(e,(function(e){var r=e.outDegreeSegmentNode,n=e.offsetRefRange;a.has(r)||t({outDegreeSegmentNode:r,offsetRefRange:n})}))},t.searchInTree=function(e,t,r){void 0===r&&(r=I.ALL);var n=[];if(r===I.ALL||r===I.FORMULA){var o=this.getFormulaGraphSegmentManager();n.push.apply(n,(0,a.Z)(o.searchInTree(e,t)))}if(r===I.ALL||r===I.DYNAMIC){var i=this.getDynamicGraphSegmentManager();n.push.apply(n,(0,a.Z)(i.searchInTree(e,t)))}return n},t.getInDegreeNodesBySheetId=function(e){return[].concat((0,a.Z)(this.getInDegreeNodesBySheetIdAndType(e,I.DYNAMIC)),(0,a.Z)(this.getInDegreeNodesBySheetIdAndType(e,I.FORMULA)))},t.updateGraphAndGetRecalculateFormulaNodes=function(e){var t=!1,r=e.getAffectedSheetId(),n=[],o=this.getFormulaGraphSegmentManager(),i=this.graphUpdateService.updateGraphAfterMutation(o,e);i.length>0&&(t=!0);var u=this.rebuildInDegreeNodesAndRelatedOutDegreeNodes(I.FORMULA,o,i);u.length>0&&n.push.apply(n,(0,a.Z)(u));var s=this.getFullTableGraphSegmentManager(),l=this.graphUpdateService.updateGraphAfterMutation(s,e);return this.rebuildInDegreeNodesAndRelatedOutDegreeNodes(I.FULL_TABLE,s,l),$e(e)||(this.clearDynamicDependencies(r),n.push.apply(n,(0,a.Z)(this.getNeedCalculateFullTableNodes(r)))),{isGraphChange:t,needRecalculateNodes:n}},t.eachDegreeTree=function(e,t,r){var n=this.getFormulaGraphSegmentManager().getTreeMap(),a=n.outDegreeTreeMap,o=n.inDegreeTreeMap;r(e===j.IN_DEGREE?o:a,t,I.FORMULA,this);var i=this.getDynamicGraphSegmentManager().getTreeMap(),u=i.outDegreeTreeMap,s=i.inDegreeTreeMap;r(e===j.IN_DEGREE?s:u,t,I.DYNAMIC,this)},t.getInDegreeNodeBySheetIdAndType=function(e,t){var r;return(null===(r=this.graphSegmentManagerMap[t].getTreeBySheetIdAndDegreeTreeType(e,j.IN_DEGREE))||void 0===r?void 0:r.all())||[]},t.getOutDegreeNodesBySheetIdAndType=function(e,t){var r;return(null===(r=this.graphSegmentManagerMap[t].getTreeBySheetIdAndDegreeTreeType(e,j.OUT_DEGREE))||void 0===r?void 0:r.all())||[]},t.toJson=function(e){var t=this;return Object.keys(this.graphSegmentManagerMap).reduce((function(r,n){return r[n]=t.graphSegmentManagerMap[n].toJson(e),r}),{})},t.isAlreadyHasThisDependencyRelationship=function(e,t,r){var n,a,o=r.searchInTree(e,j.IN_DEGREE);return 0===o.length?{isAlreadyHasThisDependency:!1}:{isAlreadyHasThisDependency:o.some((function(e){var r;return n=e,a=null===(r=e.relationshipSegments.find((function(e){return he(e.node.gridRange,!0)===he(t,!0)})))||void 0===r?void 0:r.node})),alreadyExistInDegreeNode:n,alreadyExistOutDegreeNode:a}},t.rebuildInDegreeNodesAndRelatedOutDegreeNodes=function(e,t,r){var n=this,a=[],o=t.type;return r.forEach((function(r){var i=r.gridRange,u=i.sheetId;t.removeNodeAndRelatedNodesInTree(r,j.IN_DEGREE),ae(i,(function(t,i){var s=null;if(e===I.FORMULA?s=n.externalMethods.getFormulaModelByRowCol(t,i,u,{customType:o,id:r.getId(),inDegreeSegmentNode:r}):e===I.FULL_TABLE&&(s=B),s){var l={row:t,col:i,sheetId:u,formulaModel:s,nodeInfo:r.nodeInfo};a.push(l)}}))})),t.addNodesFromChangedNodes(a),a},t.isInDegreeNodePositionDependency=function(e){return this.getFullTableGraphSegmentManager().searchInTree(je(e),j.IN_DEGREE).length>0},t.isInDegreeNodeDynamicDependency=function(e){var t=this.getDynamicGraphSegmentManager().searchInTree(je(e),j.IN_DEGREE);return{isDynamicDependency:t.length>0,inDegreeNode:t[0]}},t.getNeedCalculateFullTableNodes=function(e){var t=this.getFullTableGraphSegmentManager().getTreeBySheetId(e).inDegreeTree,r=[];return null==t||t.all().forEach((function(t){ae(t.gridRange,(function(t,n){var a=B;r.push({row:t,col:n,sheetId:e,formulaModel:a,nodeInfo:void 0})}))})),r},t.removeFormulaNodesInSegmentManager=function(e,t,r,n){var a=e.searchInTree(t,r).filter(n);0!==a.length&&a.forEach((function(t){e.removeNodeAndRelatedNodesInTree(t,r)}))},t.getInDegreeNodesBySheetIdAndType=function(e,t){var r;return(null===(r=this.graphSegmentManagerMap[t].getTreeBySheetIdAndDegreeTreeType(e,j.IN_DEGREE))||void 0===r?void 0:r.all())||[]},t.clearDynamicDependencies=function(e){var t=this.getDynamicGraphSegmentManager(),r=t.getTreeMap().inDegreeTreeMap[e];r&&r.all().forEach((function(e){t.removeNodeAndRelatedNodesInTree(e,j.IN_DEGREE)}))},t.getFormulaGraphSegmentManager=function(){return this.graphSegmentManagerMap[I.FORMULA]},t.getFullTableGraphSegmentManager=function(){return this.graphSegmentManagerMap[I.FULL_TABLE]},t.getDynamicGraphSegmentManager=function(){return this.graphSegmentManagerMap[I.DYNAMIC]},e}(),We=function(){function e(e){this.externalMethods=e}var t=e.prototype;return t.updateGraphAfterMutation=function(e,t){return Ge(t)||Ye(t)?this.updateAfterInsertDeleteDimension(e,t):Ve(t)?this.updateAfterMapRange(e,t):$e(t)?this.updateAfterInsertSheet(e,t):function(e){return e.id===$.DELETE_SHEET_MUTATION}(t)?this.updateAfterDeleteSheet(e,t):function(e){return e.id===$.MOVE_SHEET_MUTATION}(t)?this.updateAfterMoveSheet(e,{sheetIndex:t.toIndex}):[]},t.updateAfterInsertDeleteDimension=function(e,t){var r=this,n=new Set,a=function(a){var o=t.getAffectedSheetId(),i=e.getTreeBySheetIdAndDegreeTreeType(o,a);i&&i.walk((function(o){return o.leaf?r.updateLeafNodeAfterInsertDeleteDimension({graphSegmentManager:e,rTreeNode:o,mutation:t,degreeTreeType:a,needRebuildInDegreeNodeSet:n}):r.updateChildNodeAfterInsertDeleteDimension({rTreeNode:o,mutation:t})}))};return a(j.IN_DEGREE),a(j.OUT_DEGREE),Array.from(n)},t.updateAfterMapRange=function(e,t){var r=t.getAffectedSheetId(),n=e.getTreeBySheetIdAndDegreeTreeType(r,j.IN_DEGREE);if(!n)return[];var a=function(e){var t=e.row,r=e.column,n=-1!==t.to,a=(n?t:r).from,o=a.startIndex,i=a.endIndex,u=0,s=0,l=0,c=0;return n?(u=o,s=i,l=O,c=F):(u=O,s=F,l=o,c=i),{startColIndex:l,endColIndex:c,startRowIndex:u,endRowIndex:s}}(t),o=n.search({minX:a.startColIndex,maxX:a.endColIndex,minY:a.startRowIndex,maxY:a.endRowIndex}),i=new Set;return o.forEach((function(e){var r=e.gridRange,n=function(e,t){var r,n,a=e.row,o=e.column,i=-1!==a.to,u=i?a:o,s=u.to,l=u.from,c=l.startIndex,f=l.endIndex,d=e.getAffectedSheetId(),h=f-c,m=0,g=0,p=0,v=0;return i?(m=s,g=s+h,p=(r=[t.startColIndex,t.endColIndex])[0],v=r[1]):(m=(n=[t.startRowIndex,t.endRowIndex])[0],g=n[1],p=s,v=s+h),new k(d,m,g,p,v)}(t,r);i.add(new Pe(n,e.nodeInfo))})),Array.from(i)},t.updateAfterMoveSheet=function(e,t){var r=t.sheetIndex,n=(0,this.externalMethods.getSheetIdBySheetIndex)(r);return this.updateAfterMoveDeleteSheet(e,n)},t.updateAfterDeleteSheet=function(e,t){var r=this.updateAfterMoveDeleteSheet(e,t.sheetId);return e.removeTree(t.sheetId),Array.from(r)},t.updateAfterMoveDeleteSheet=function(e,t){var r=this,n=e.getTreeBySheetIdAndDegreeTreeType(t,j.OUT_DEGREE);if(void 0===n)return[];var a=new Set;return n.all().forEach((function(t){var n=t.relationshipSegments[0],o=Ue({inDegreeSegmentNode:n.node,partIdx:n.partIdx,customType:e.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});o&&me(o.startSheetId,o.endSheetId)&&a.add(n.node)})),Array.from(a)},t.updateAfterInsertSheet=function(e,t){var r=this,n=t.sheetId,a=t.sheetIndex-1;if(a<0)return[];var o=this.externalMethods.getSheetIdBySheetIndex(a),i=e.getTreeBySheetIdAndDegreeTreeType(o,j.OUT_DEGREE);if(!i)return[];var u=new Set;return i.all().forEach((function(t){var a=t.relationshipSegments[0],o=Ue({inDegreeSegmentNode:a.node,partIdx:a.partIdx,customType:e.type,getFormulaModelByRowCol:r.externalMethods.getFormulaModelByRowCol});if(void 0!==o){var i=o.startSheetId,s=o.endSheetId;(function(e,t){return e!==t&&""!==e})(i,s)&&r.externalMethods.getSheetIdsAmongTwoSheets(i,s).includes(n)&&u.add(a.node)}})),Array.from(u)},t.updateChildNodeAfterInsertDeleteDimension=function(e){var t=e.rTreeNode,r=e.mutation,n=we(r.sheetId,t),a=xe(r,n)||De(r,n);if(a){var o,i,u=be(r,n);o=[u.startColIndex,u.endColIndex],t.minX=o[0],t.maxX=o[1],i=[u.startRowIndex,u.endRowIndex],t.minY=i[0],t.maxY=i[1]}return a},t.updateLeafNodeAfterInsertDeleteDimension=function(e){var t,r,n=e.graphSegmentManager,a=e.rTreeNode,o=e.mutation,i=e.degreeTreeType,u=e.needRebuildInDegreeNodeSet,s=[];a.children.forEach((function(e){var t=e.gridRange;xe(o,t)&&(i===j.IN_DEGREE?Ye(o)?(be(o,t),u.add(e)):s.push(e):e.relationshipSegments.forEach((function(e){var t=e.node;u.add(t)}))),De(o,t)&&be(o,t)})),s.forEach((function(e){var t=e.gridRange;n.removeNodeAndRelatedNodesInTree(e,j.IN_DEGREE),function(e,t){var r=new k(t.sheetId,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex);be(e,r);var n=r.sheetId,a=r.startRowIndex,o=r.endRowIndex,i=r.startColIndex,u=r.endColIndex,s=e.type===Y.ROWS,l=e.type===Y.COLUMNS,c=s?e.index:a,f=l?e.index:i,d=s?e.index+e.amount-1:o,h=l?e.index+e.amount-1:u;return oe(r,new k(n,c,d,f,h))}(o,t).forEach((function(t){u.add(new Pe(t,e.nodeInfo))}))}));var l=we(o.sheetId,a),c=be(o,l);return t=[c.startColIndex,c.endColIndex],a.minX=t[0],a.maxX=t[1],r=[c.startRowIndex,c.endRowIndex],a.minY=r[0],a.maxY=r[1],!1},e}(),Xe=function(){function e(e){this.depSize=0,this.gridRange=e,this.refRelationshipSegments=new Set,this.depRelationshipSegments=new Set}var t=e.prototype;return t.addRefRelationshipSegment=function(e){return!this.refRelationshipSegments.has(e)&&(this.refRelationshipSegments.add(e),!0)},t.addDepRelationshipSegment=function(e){return!this.depRelationshipSegments.has(e)&&(this.depRelationshipSegments.add(e),!0)},t.removeDepRelationshipSegment=function(e){return this.depRelationshipSegments.delete(e)},t.removeRefRelationshipSegment=function(e){return this.refRelationshipSegments.delete(e)},e}(),Ke=function(){function e(e){this.interruptedNodeSet=new Set,this.externalMethods=e,this.subGraphSegmentNodeMap=new Map}var t=e.prototype;return t.getTopSortNodesBySheetIdsAndNodes=function(e,t,r){void 0===t&&(t=[]),this.graphService=r;var n=[],o=[];if(e.forEach((function(e){n.push.apply(n,(0,a.Z)(r.getInDegreeNodesBySheetId(e))),o.push.apply(o,(0,a.Z)(r.getOutDegreeNodesBySheetId(e)))})),n.push.apply(n,(0,a.Z)(t)),0===n.length&&0===o.length)return{topSortRanges:[],cycleRanges:[]};var i=this.getSubGraphInDegreeSegmentNodes({inDegreeNodes:n,outDegreeNodes:o}),u=this.getDyeSubGraphByInDegreeSegmentNodes(i),s=this.getTopSortNodesBySubGraph(u),l=s.topSortRanges,c=s.cycleRanges;return this.graphService=void 0,this.interruptedNodeSet.clear(),{topSortRanges:l,cycleRanges:c}},t.getTopSortNodesByChangedNodes=function(e,t){this.graphService=t;var r=this.getInDegreeSegmentNodesByChangedNodes(e),n=this.getDyeSubGraphByInDegreeSegmentNodes(r),a=this.getTopSortNodesBySubGraph(n),o=a.topSortRanges,i=a.cycleRanges;return this.graphService=void 0,this.interruptedNodeSet.clear(),{topSortRanges:o,cycleRanges:i}},t.getTopSortNodesBySubGraph=function(e){var t=this,r=Object.values(e),n=[],a=[],o=this.getTopSortNodesBySubGraphSegmentNodes(r,(function(e){var r=t.getCycle(e),n=r.cycles,a=r.sortNodes;return console.warn("函数存在环",{sortNodes:a,cycles:n}),{cycles:n,sortNodes:a}})),i=o.cycles;return o.sortNodes.forEach((function(e){n.push(e.gridRange)})),i.forEach((function(e){a.push(e.gridRange)})),{topSortRanges:n,cycleRanges:a}},t.getTopSortNodesBySubGraphSegmentNodes=function(e,t){for(var r=[];0!==e.length;){var n=e;if(e=[],n.forEach((function(t){t.depSize?e.push(t):(r.push(t),t.refRelationshipSegments.forEach((function(e){e.depSize-=1})))})),e.length===n.length){var o=t(e),i=o.cycles,u=o.sortNodes;return r.push.apply(r,(0,a.Z)(u)),{cycles:i,sortNodes:r}}}return{cycles:[],sortNodes:r}},t.getCycle=function(e){var t=this.searchCycle(e),r=t.needSortedNodes,n=t.cycles,a=this.getTopSortNodesBySubGraphSegmentNodes(r,(function(e){return console.warn("函数cycle error",r),{cycles:[],sortNodes:e}}));return{cycles:n,sortNodes:a.sortNodes}},t.searchCycle=function(e){var t=new Set,r=[],n=[];return e.forEach((function(e){r.push(e);for(var a=new Set,o=function(){var e=r[r.length-1],n=!1;e.refRelationshipSegments.forEach((function(e){if(!n){if(a.has(e))return!1;if(a.add(e),!e.depSize)return!1;var o=r.indexOf(e);if(-1!==o){for(var i=[];o!==r.length;){var u=r.pop();u.depSize>0&&(u.depSize-=1),t.add(u),i.push(u)}return i.forEach((function(e){0===e.depSize&&e.refRelationshipSegments.forEach((function(e){t.has(e)||e.depSize<=0||(e.depSize-=1)}))})),!1}return r.push(e),n=!0,!0}})),e===r[r.length-1]&&r.pop()};r.length;)o();t.has(e)||n.push(e)})),{cycles:Array.from(t),needSortedNodes:n}},t.getDyeSubGraphByInDegreeSegmentNodes=function(e){for(var t=this,r=new Map,n={},a={},o=function(e){var t=Ae(e.gridRange);return!!n[t]},i=function(e){var t=Ae(e.gridRange);return!!a[t]||(a[t]=!0,!1)},u=function(a){var u=e[a];if(o(u))return"continue";var s=r.get(u);if(s)return s.forEach((function(t){o(t)||i(t)||e.push(t)})),"continue";var l=Ae(u.gridRange);n[l]=u;var c=u.gridRange,f=new Set;t.getRefRangeByDependencyRange({dependencyRange:c,splitGraphMap:r,callBack:function(t){var r=t.inDegreeSegmentNode,a=t.exceptSegmentNodes,s=Ae(t.inDegreeParentSegmentNode.gridRange);a.length>0&&n[s]&&(f.add(s),a.forEach((function(t){o(t)||i(t)||e.push(t)}))),o(r)||i(r)||e.push(r);var l=u.addRefRelationshipSegment(r),c=r.addDepRelationshipSegment(u);l&&c&&(r.depSize+=1)}}),f.forEach((function(e){var t,r=n[e];null===(t=null==r?void 0:r.refRelationshipSegments)||void 0===t||t.forEach((function(e){e.removeDepRelationshipSegment(r),e.depSize-=1})),delete n[e]}))},s=0;s<e.length;s++)u(s);return r.forEach((function(e,t){var r=Ae(t.gridRange);n[r]&&console.warn("函数测试看一下是否存在需要删除的场景，理论上这里应该没有才对")})),this.subGraphSegmentNodeMap.clear(),n},t.getExceptRangeWithOffsetRange=function(e){return oe(e.inDegreeParentRange,e.inDegreeOffsetRange)},t.getInDegreeSegmentNodesByChangedNodes=function(e){var t=[],r=[];return e.forEach((function(e){var n=e.row,a=e.col,o=e.sheetId,i=e.formulaModel,u=new k(o,n,n,a,a);void 0!==i?r.push(u):t.push(u)})),[].concat((0,a.Z)(this.getInDegreeSegmentNodesByConstGridRanges(t)),(0,a.Z)(this.getInDegreeSegmentNodesByFormulaGridRanges(r)))},t.getInDegreeSegmentNodesByConstGridRanges=function(e){var t=this,r=new Set;return le(e).forEach((function(e){t.getRefRangeByDependencyRange({dependencyRange:e,callBack:function(e){var t=e.inDegreeSegmentNode;r.add(t)}})})),r},t.getInDegreeSegmentNodesByFormulaGridRanges=function(e){var t=this,r=new Set;return le(e).forEach((function(e){t.getRefRangeByDependencyRange({dependencyRange:e,callBack:function(e){var t=e.inDegreeSegmentNode;r.add(t)}});var n=t.graphService.searchInTree(e,j.IN_DEGREE,I.FORMULA);null==n||n.forEach((function(n){if(t.hijackIsNodeNeedCalculateHook(n)){var a=ue(n.gridRange,e);a&&de(a)&&r.add(t.getSubGraphSegmentNodeByRange(a))}}))})),r},t.getRefRangeByDependencyRange=function(e){var t,r=this,n=e.dependencyRange,o=e.splitGraphMap,i=e.callBack;null===(t=this.graphService)||void 0===t||t.getRefRangeByDepRange(n,(function(e){var t=e.offsetRefRange,n=e.inDegreeSegmentNode;if(r.hijackIsNodeNeedCalculateHook(n)){var u=(null==o?void 0:o.get(n))||[r.getSubGraphSegmentNodeByRange(n.gridRange)],s=u.length;u.forEach((function(e,n){var s=ue(e.gridRange,t);if(s){var l=r.getExceptRangeWithOffsetRange({inDegreeOffsetRange:s,inDegreeParentRange:e.gridRange}),c=[e];l.length>0&&(c=[s].concat((0,a.Z)(l)).map((function(t){var n=r.getSubGraphSegmentNodeByRange(t);return e.depRelationshipSegments.forEach((function(t){t.removeRefRelationshipSegment(e),t.addRefRelationshipSegment(n)})),n.depSize=e.depSize,n.depRelationshipSegments=new Set(Array.from(e.depRelationshipSegments)),n})),o&&(o.set(e,c),delete u[n],u.push.apply(u,(0,a.Z)(c)))),i({inDegreeParentSegmentNode:e,inDegreeSegmentNode:c[0],exceptSegmentNodes:c.slice(1)})}})),o&&u.length>s&&o.set(n,u)}}))},t.getSubGraphInDegreeSegmentNodes=function(e){var t=this,r=e.inDegreeNodes,n=e.outDegreeNodes,a=new Set,o=function(e){if(t.hijackIsNodeNeedCalculateHook(e)){var r=t.getSubGraphSegmentNodeByRange(e.gridRange);a.add(r)}};return r.forEach((function(e){o(e)})),n.forEach((function(e){e.relationshipSegments.forEach((function(e){var t=e.node;o(t)}))})),Array.from(a)},t.getSubGraphSegmentNodeByRange=function(e){var t=Ae(e),r=this.subGraphSegmentNodeMap.get(t);return r||(r=new Xe(e),this.subGraphSegmentNodeMap.set(t,r)),r},t.hijackIsNodeNeedCalculateHook=function(e){var t=this;return!this.interruptedNodeSet.has(e)&&(this.externalMethods.isNodeNeedCalculateHook(e)&&!this.graphService.searchInTree(e.gridRange,j.IN_DEGREE,I.DYNAMIC).some((function(e){return!t.externalMethods.isNodeNeedCalculateHook(e)}))||(this.interruptedNodeSet.add(e),!1))},e}();!function(e){e[e.AUTO=0]="AUTO",e[e.MANUAL=1]="MANUAL"}(Ne||(Ne={}));var qe,ze=function(){function e(e){this.graphServiceMap=new Map,this.externalMethods=e,this.graphServiceMap=new Map}var t=e.prototype;return t.getGraphServiceMap=function(){return this.graphServiceMap},t.getGraphServiceByCustomType=function(e){return this.graphServiceMap.get(e)},t.addCustomNodes=function(e,t,r){return r===Ne.AUTO?this.addCustomNodesWithAuto(e,t):this.addCustomNodesWithManual(e,t)},t.destroy=function(){this.graphServiceMap.forEach((function(e){e.destroy()}))},t.removeCustomNodes=function(e,t,r){return r===Ne.AUTO?this.removeCustomNodesWithAuto(e,t):this.removeCustomNodesWhitManual(e,t),t},t.getOrCreateGraphServiceByCustomType=function(e){var t=this.graphServiceMap.get(e);return void 0===t&&(t=new Ze(e,{getSheetIdBySheetIndex:this.externalMethods.getSheetIdBySheetIndex,getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol}),this.graphServiceMap.set(e,t)),t},t.removeCustomNodesWithAuto=function(e,t){var r=[];t.forEach((function(e){ae(e.gridRange,(function(e,t,n){r.push({row:e,col:t,sheetId:n,formulaModel:void 0,nodeInfo:void 0})}))})),this.getOrCreateGraphServiceByCustomType(e).addFormulaNodes(r)},t.addCustomNodesWithManual=function(e,t){var r=this,n={graphSegmentType:I.FORMULA,customNodeType:e,inDegreeNodesMap:{}},a=this.getOrCreateGraphServiceByCustomType(e);return t.forEach((function(e){var t=e.gridRange,o=e.formulaModel,i=e.nodeInfo,u=new Pe(t,i),s=null==o?void 0:o.getAllCellRangeWithFixedInfo();s.forEach((function(e){var n=ge(e,t),o=n.startRow,i=n.endRow,s=n.startCol,l=n.endCol;pe(e,t.sheetId,r.externalMethods.getSheetIdsAmongTwoSheets).forEach((function(e){var t=new Pe(new k(e,o,i,s,l));a.addDependency(u,t)}))})),0===s.length&&a.addDependency(u,void 0),n.inDegreeNodesMap[t.sheetId]||(n.inDegreeNodesMap[t.sheetId]=[]),n.inDegreeNodesMap[t.sheetId].push(u)})),n},t.addCustomNodesWithAuto=function(e,t){var r=this.getOrCreateGraphServiceByCustomType(e),n=[];return t.forEach((function(e){var t=e.gridRange,r=e.formulaModel,a=e.nodeInfo;ae(t,(function(e,t,o){n.push({row:e,col:t,sheetId:o,formulaModel:r,nodeInfo:a})}))})),r.addFormulaNodes(n)},t.removeCustomNodesWhitManual=function(e,t){var r=this.getOrCreateGraphServiceByCustomType(e);t.forEach((function(e){var t=e.gridRange,n=e.id;r.removeFormulaNodes(t,j.IN_DEGREE,(function(e){return e.getId()===n}))}))},e}(),Je=function(){function e(e){var t;this.externalMethods=e,this.sortService=new Ke({isNodeNeedCalculateHook:(null===(t=this.externalMethods)||void 0===t?void 0:t.isNodeNeedCalculateHook)||function(){return!0}}),this.customNodeService=new ze({getSheetIdBySheetIndex:this.externalMethods.getSheetIdBySheetIndex,getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol}),this.graphService=new Ze(b,{getSheetIdBySheetIndex:this.externalMethods.getSheetIdBySheetIndex,getSheetIdsAmongTwoSheets:this.externalMethods.getSheetIdsAmongTwoSheets,getFormulaModelByRowCol:this.externalMethods.getFormulaModelByRowCol}),this.resetPerformanceInfo()}var t=e.prototype;return t.toJson=function(e){var t={};return t[b]=this.graphService.toJson(e),this.customNodeService.getGraphServiceMap().forEach((function(r,n){t[n]=r.toJson(e)})),t},t.getPerformanceInfo=function(){return this.performanceInfo},t.resetPerformanceInfo=function(){this.performanceInfo={buildGraphDuration:0,topSortDuration:0}},t.destroy=function(){this.graphService.destroy(),this.customNodeService.destroy()},t.addNodes=function(e){var t=Date.now(),r=this.graphService.addFormulaNodes(e),n=Date.now();return this.performanceInfo.buildGraphDuration+=n-t,r},t.removeNodes=function(e){this.graphService.addFormulaNodes(e.map((function(e){return Object.assign(Object.assign({},e),{formulaModel:void 0})})))},t.addCustomNodes=function(e,t,r){return this.customNodeService.addCustomNodes(e,t,r)},t.removeCustomNodes=function(e,t,r){this.customNodeService.removeCustomNodes(e,t,r)},t.eachDegreeTree=function(e,t){this.graphService.eachDegreeTree(e,b,t),this.customNodeService.getGraphServiceMap().forEach((function(r,n){r.eachDegreeTree(e,n,t)}))},t.addDynamicDependency=function(e){var t=e.inDegreeNode,r=e.outDegreeNode,n=e.customType,a=this.getGraphService(n);return!!a&&a.addDynamicDependency(t,r)},t.getRefRangeByDepRange=function(e,t,r){var n=this,a=t===b;a&&this.graphService.getRefRangeByDepRange(e,(function(e){var t=e.offsetRefRange,a=e.inDegreeSegmentNode;r({offsetRefRange:t,inDegreeSegmentNode:a,graphSegmentManager:n.graphService,customType:b})})),this.customNodeService.getGraphServiceMap().forEach((function(n,o){(a||o===t)&&n.getRefRangeByDepRange(e,(function(e){var t=e.offsetRefRange,a=e.inDegreeSegmentNode;r({offsetRefRange:t,inDegreeSegmentNode:a,graphSegmentManager:n,customType:o})}))}))},t.getDepRangeByRefRange=function(e,t,r){var n=this;t===b?this.graphService.getDepRangeByRefRange(e,(function(e){var t=e.offsetRefRange,a=e.outDegreeSegmentNode;r({offsetRefRange:t,outDegreeSegmentNode:a,graphSegmentManager:n.graphService,customType:b})})):this.customNodeService.getGraphServiceMap().forEach((function(n,a){a===t&&n.getDepRangeByRefRange(e,(function(e){var t=e.offsetRefRange,o=e.outDegreeSegmentNode;r({offsetRefRange:t,outDegreeSegmentNode:o,graphSegmentManager:n,customType:a}),r({offsetRefRange:t,outDegreeSegmentNode:o,graphSegmentManager:n,customType:b})}))}))},t.searchInTree=function(e,t,r){var n=this.getGraphService(e);return null==n?void 0:n.searchInTree(t,r)},t.getRecalculateTopSortNodesBySheetIdsAndNodes=function(e,t){var r,n=Date.now(),a=this.sortService.getTopSortNodesBySheetIdsAndNodes(e,t,this.getGraphService(b)),o=Date.now();this.performanceInfo.topSortDuration+=o-n;var i=Oe(a),u=this.getRecalculateCustomTopSortNodesBySheetIds(e),s=this.getRecalculateCustomTopSortNodesByChangedNodes([],i),l=((r={})[b]=i,r);return this.customNodeService.getGraphServiceMap().forEach((function(e,t){Object.assign(u[t],s[t]),l[t]=Object.values(u[t])})),console.warn("函数整表排序结束",l),l},t.getRecalculateTopSortNodesByChangedNodes=function(e){var t;if(0===e.length)return{};var r=Date.now(),n=this.sortService.getTopSortNodesByChangedNodes(e,this.getGraphService(b)),a=Date.now();this.performanceInfo.topSortDuration+=a-r;var o=Oe(n),i=this.getRecalculateCustomTopSortNodesByChangedNodes(e,o),u=((t={})[b]=o,t);return this.customNodeService.getGraphServiceMap().forEach((function(e,t){u[t]=Object.values(i[t])})),console.warn("函数更新排序结束",u),u},t.commitMutation=function(e){var t=[],r=!1;return this.getNeedUpdateGraphServiceMap().forEach((function(n){var o=n.updateGraphAndGetRecalculateFormulaNodes(e),i=o.needRecalculateNodes,u=o.isGraphChange;!r&&u&&(r=!0),t.push.apply(t,(0,a.Z)(i))})),{needRecalculateNodes:t,isGraphChange:r}},t.getNeedUpdateGraphServiceMap=function(){var e=new Map(this.customNodeService.getGraphServiceMap());return e.set(b,this.getGraphService(b)),e},t.getRecalculateCustomTopSortNodesBySheetIds=function(e){for(var t,r=this,n={},a=function(){var a=t.value,o=a[0],i=a[1];n[o]={},e.forEach((function(t){var a=i.getInDegreeNodesBySheetId(t);null==a||a.forEach((function(e){var t,a,i;if(null===(a=(t=r.externalMethods).isNodeNeedCalculateHook)||void 0===a?void 0:a.call(t,e)){var u=Le(e,e.gridRange),s=Ae(e.gridRange,null===(i=e.nodeInfo)||void 0===i?void 0:i.id);n[o][s]=u}}));var u=i.getOutDegreeNodesBySheetId(t);null==u||u.forEach((function(t){t.relationshipSegments.forEach((function(t){var a,i,u=t.node;if(!e.includes(u.gridRange.sheetId)&&(null===(i=(a=r.externalMethods).isNodeNeedCalculateHook)||void 0===i?void 0:i.call(a,u))){var s=Ae(u.gridRange,u.getId());if(!n[o][s]){var l=Le(u,u.gridRange);n[o][s]=l}}}))}))}))},o=f(this.customNodeService.getGraphServiceMap());!(t=o()).done;)a();return n},t.getRecalculateCustomTopSortNodesByChangedNodes=function(e,t){for(var r,n=this,o={},i=[].concat((0,a.Z)(t),(0,a.Z)(e.map((function(e){var t=e.row,r=e.col,n=e.sheetId;return{range:new k(n,t,t,r,r)}})))),u=function(){var e=r.value,t=e[0],a=e[1];o[t]={},i.forEach((function(e){var r=e.range;a.getRefRangeByDepRange(r,(function(e){var r,a,i=e.offsetRefRange,u=e.inDegreeSegmentNode;if(null===(a=(r=n.externalMethods).isNodeNeedCalculateHook)||void 0===a?void 0:a.call(r,u)){var s=Le(u,i),l=Ae(s.range,s.id);o[t][l]||(o[t][l]=s)}}))}))},s=f(this.customNodeService.getGraphServiceMap());!(r=s()).done;)u();return console.warn(o),o},t.getGraphService=function(e){return function(e){return void 0!==e&&e!==b}(e)?this.customNodeService.getGraphServiceByCustomType(e):this.graphService},e}(),Qe={style:1,segment:!1,heteronym:!1},et=new(function(){function e(){this.pinyinCache={},this.vlookupCache={},this.rangeCache={}}var t=e.prototype;return t.getAstNodes=function(){return this._astNodes},t.setAstNodes=function(e){this._astNodes=e},t.getFuncNode=function(){return this._funcNode},t.setFuncNode=function(e){this._funcNode=e},t.getElement=function(){return this._element},t.setElement=function(e){this._element=e},t.getInstance=function(){return this._instance},t.setInstance=function(e){this._instance=e},t.getPinyin=function(e){var t=this.pinyinCache[e];return t||(t=(0,Ee.default)(e,Qe),this.pinyinCache[e]=t),t},t.setLookupCache=function(e,t){this.vlookupCache[e]=t},t.getLookupCache=function(e){return this.vlookupCache[e]},t.getRangeCache=function(){return this.rangeCache},t.clear=function(){this._astNodes=void 0,this._funcNode=void 0,this._instance=void 0,this._element=void 0},t.clearCache=function(){this.pinyinCache={},this.vlookupCache={},this.rangeCache={}},e}());function tt(e,t,r,n){return new(r||(r=Promise))((function(a,o){function i(e){try{s(n.next(e))}catch(e){o(e)}}function u(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}s((n=n.apply(e,t||[])).next())}))}Object.create,Object.create,function(e){e.CELL="CELL",e.COL="COL",e.ROW="ROW",e.VARIABLE="VARIABLE",e.STRING="STRING",e.ERROR="ERROR",e.NUMBER="NUMBER",e.SHEET="SHEET",e.SEPARATOR="SEPARATOR",e.USERARRAY="USERARRAY",e.UNKNOW="UNKNOW"}(qe||(qe={}));var rt=function(e,t){this.value=e,this.type=t},nt=function(){function e(){this.calculateParentFunctionNode=void 0}var t=e.prototype;return t.setCalculateParentFunctionNode=function(e){this.calculateParentFunctionNode=e},t.setValue=function(e){this.value=e},e}(),at=function(e){function t(t,r,n,a,o,i){var u;return(u=e.call(this)||this).cellId=t,u.originValue=r,u.row=n,u.col=a,u.sheetId=o,u.nodeType=C.CELL,u.crossTableType=i,u.asyncFunctionNodeList=[],u}(0,n.Z)(t,e);var r=t.prototype;return r.setFormula=function(e){this.formula=e},r.equalsFormula=function(e){return this.formula===e},r.setAsyncFunctionNodeList=function(e){void 0===e&&(e=[]),this.asyncFunctionNodeList=e},r.getAsyncFunctionNodeList=function(){return this.asyncFunctionNodeList},r.setBody=function(e){this.body=e},r.toString=function(e,t){if("function"==typeof t.CELL)t.CELL(e,this);else{if(this.originValue.indexOf("'")>=0){var r=this.originValue.lastIndexOf("!"),n=this.originValue.slice(0,r);"'"===n[0]&&n.slice(1,n.length-1).indexOf("'")>=0&&(n=(n=(n=n.slice(1,n.length-1)).replace(/'/g,"''")).slice(1,n.length-1)),this.originValue=n+this.originValue.slice(r)}e.push(this.originValue)}},r.toFormulaModel=function(e,t){var r=[];return"function"==typeof e.CELL&&e.CELL(r,this,t),r},t}(nt),ot=function(e){function t(t,r,n,a,o,i,u,s,l){var c;return(c=e.call(this)||this).nodeType=C.CELL_RANGE,c.startSheetId=t,c.endSheetId=r,c.cellRangeType=u,c.crossTableType=s,c.start=n,c.end=a,c.scope=o,c.sheetIds=i,c.originValue=l,c}(0,n.Z)(t,e);var r=t.prototype;return r.updateSheetIds=function(e){this.sheetIds=e},r.toString=function(e,t){if("function"==typeof t.CELL_RANGE)t.CELL_RANGE(e,this);else{if(this.originValue.indexOf("'")>=0){var r=this.originValue.lastIndexOf("!"),n=this.originValue.slice(0,r);"'"===n[0]&&n.slice(1,n.length-1).indexOf("'")>=0&&(n=(n=(n=n.slice(1,n.length-1)).replace(/'/g,"''")).slice(1,n.length-1)),this.originValue=n+this.originValue.slice(r)}e.push(this.originValue)}},r.toFormulaModel=function(e,t){var r=[];return"function"==typeof e.CELL_RANGE&&e.CELL_RANGE(r,this,t),r},t}(nt),it=function(e){function t(t,r,n){var a;return(a=e.call(this)||this).nodeType=C.CELL_RANGE_BINARY,a.binaryType=n,a.leftRange=t,a.rightRange=r,a}(0,n.Z)(t,e);var r=t.prototype;return r.toString=function(e,t){this.binaryType===D.CONCAT?(this.leftRange.toString(e,t),e.push(","),this.rightRange.toString(e,t)):this.binaryType===D.INTERSECTION&&(this.leftRange.toString(e,t),e.push(" "),this.rightRange.toString(e,t))},r.toFormulaModel=function(e,t){var r=[];return this.binaryType===D.CONCAT?((r=r.concat(this.leftRange.toFormulaModel(e,t))).push(","),r=r.concat(this.rightRange.toFormulaModel(e,t))):this.binaryType===D.INTERSECTION&&((r=r.concat(this.leftRange.toFormulaModel(e,t))).push(" "),r=r.concat(this.rightRange.toFormulaModel(e,t))),r},t}(nt),ut=function(e){function t(t,r){var n;return(n=e.call(this)||this).nodeType=C.FUNCTION,n.args=r,n.funcName=t,n}(0,n.Z)(t,e);var r=t.prototype;return r.setFormatType=function(e){this.formatType=e},r.setHyperLink=function(e){this.hyperLink=e},r.toString=function(e,t){if(e.parentFunctionNode=this,{LOGICMATCH:!0,SPECIALMATCH:!0,MATHMATCH:!0}[this.funcName])this.args[0].toString(e,t),this.args[2].toString(e,t),this.args[1].toString(e,t);else{e.push(this.funcName+"(");for(var r=0;r<this.args.length;r++)this.args[r].toString(e,t),r!==this.args.length-1&&e.push(",");e.push(")")}},r.toFormulaModel=function(e,t){var r=[];if({LOGICMATCH:!0,SPECIALMATCH:!0,MATHMATCH:!0}[this.funcName])r=(r=(r=r.concat(this.args[0].toFormulaModel(e,this))).concat(this.args[2].toFormulaModel(e,this))).concat(this.args[1].toFormulaModel(e,this));else{r.push(this.funcName+"(");for(var n=0;n<this.args.length;n++){var a=this.args[n];r=r.concat(a.toFormulaModel(e,this)),n!==this.args.length-1&&r.push(",")}r.push(")")}return r},t}(nt),st=function(e){function t(t,r,n){var a;return(a=e.call(this)||this).nodeType=C.VARIABLE,a.variableType=r,a.originValueNode=t,a.toString=n||function(e){void 0===e&&(e=[]);var t=this.originValueNode;return this.variableType===w.STR&&((t=t.slice(1,t.length-1)).indexOf('"')>=0&&(t=t.replace(/"/g,'""')),t='"'+t+'"'),e.push(t),t},a}return(0,n.Z)(t,e),t.prototype.toFormulaModel=function(e,t){var r=[];return this.toString(r,e),r},t}(nt),lt=function(){function e(e,t,r){var n=this;this.identities=e,this.isCell=t,this.toArray=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var o=r.apply(n,t);return n.setValue(o),o}}var t=e.prototype;return t.getRangeCount=function(){return this.identities.length},t.getIdentities=function(e){return this.identities[e]},t.getRowCount=function(e){return this.identities[e].rowCount},t.getColumnCount=function(e){return this.identities[e].colCount},t.getRow=function(e){return this.identities[e].row},t.getColumn=function(e){return this.identities[e].col},t.getSheetId=function(e){return this.identities[e].sheetId},t.setValue=function(e){this.value=e},e}();function ct(e){return!!e&&"string"!=typeof e&&void 0!==e.nodeType&&null!==e.nodeType}function ft(e){return e&&e instanceof lt}function dt(e){return e&&e.nodeType===C.CELL}function ht(e){return!!e&&e.nodeType===C.CELL}function mt(e){return!!ht(e)&&e.crossTableType===A.NORMAL}function gt(e){return e&&e.crossTableType===A.NORMAL}function pt(e){return!!Rt(e)&&e.crossTableType!==A.NONE}function vt(e){return!!Rt(e)&&e.cellRangeType===x.USER_RANGE}function yt(e){return e&&e.crossTableType!==A.NONE}function Nt(e){return e&&e.crossTableType===A.THREE_DIMENSION}function Mt(e){return e&&e.nodeType===C.CELL_RANGE_BINARY}function Rt(e){return e&&e.nodeType===C.CELL_RANGE}function Et(e){return"boolean"!=typeof e&&e&&e.nodeType===C.FUNCTION}function _t(e){return Et(e)&&"MATHMATCH"!==e.funcName&&"LOGICMATCH"!==e.funcName&&"SPECIALMATCH"!==e.funcName}function Tt(e){return e&&e.nodeType===C.VARIABLE}function St(e,t){if(t)if("OFFSET"===t.funcName){if(0===t.args.indexOf(e))return!0}else if("ROW"===t.funcName||"COLUMN"===t.funcName)return!0;return!1}var It={stopSearchingDown:!1,stopParallelTraversal:!1,stopAll:!1,walkContext:{}};function Ct(e,t,r,n){var a=void 0===r?{}:r,o=a.preorder,i=void 0!==o&&o,u=a.walkContext,s=void 0===u?{}:u;return void 0===n&&(n=[]),n.length||n.push(e),ht(e)?function(e,t,r,n){var a=r.preorder,o=r.walkContext;if(!e.body)return{stopAll:!1};var i=n.concat([e.body]),u=t(e.body,i,{walkContext:o})||It,s=u.stopSearchingDown,l=void 0!==s&&s,c=u.stopAll,f=void 0!==c&&c,d=u.walkContext;return f?{stopAll:!0}:!0!==l?Ct(e.body,t,{preorder:a,walkContext:d||o},i):{stopAll:f}}(e,t,{preorder:i,walkContext:s},n):Et(e)?function(e,t,r,n){for(var a=r.preorder,o=r.walkContext,i=e.args,u=a?0:i.length-1,s=a?i.length-1:0,l=u;a?l<=s:l>=s;a?l+=1:l-=1){var c=i[l],f=n.concat(c),d=t(c,f,{walkContext:o})||It,h=d.stopSearchingDown,m=void 0!==h&&h,g=d.stopParallelTraversal,p=void 0!==g&&g,v=d.stopAll,y=void 0!==v&&v,N=d.walkContext;if(y)return{stopAll:y};if(!0!==m&&Ct(c,t,{preorder:a,walkContext:N||o},f).stopAll)return{stopAll:!0};if(!0===p)break}return{stopAll:!1}}(e,t,{preorder:i,walkContext:s},n):Rt(e)?{stopAll:!1}:Tt(e)?function(e,t,r,n){var a=r.preorder,o=r.walkContext,i=e.originValueNode;if(ct(i)){var u=n.concat([i]),s=t(i,u,{walkContext:o})||It,l=s.stopSearchingDown,c=void 0!==l&&l,f=s.stopAll,d=void 0!==f&&f,h=s.walkContext;return d?{stopAll:!0}:!0!==c?Ct(i,t,{preorder:a,walkContext:h||o},u):{stopAll:d}}return{stopAll:!1}}(e,t,{preorder:i,walkContext:s},n):Mt(e)?function(e,t,r,n){var a=r.preorder,o=r.walkContext,i={rightRange:n.concat([e.rightRange]),leftRange:n.concat([e.leftRange])},u=!1,s=!1;return(a?["leftRange","rightRange"]:["rightRange","leftRange"]).forEach((function(r){if(!u&&!s){var n=t(e[r],i[r],{walkContext:o})||It,l=n.stopSearchingDown,c=void 0!==l&&l,f=n.stopParallelTraversal,d=void 0!==f&&f,h=n.stopAll,m=void 0!==h&&h,g=n.walkContext;if(m)s=m;else if(u=!!d,!0===c)u=d;else{var p=Ct(e[r],t,{preorder:a,walkContext:g||o},i[r]).stopAll;s=p}}})),{stopAll:s}}(e,t,{preorder:i,walkContext:s},n):{stopAll:!1}}var At,wt={BaseNode:nt,CellNode:at,CellRangeNode:ot,CellRangeBinaryNode:it,FunctionNode:ut,VariableNode:st},xt=new(function(){function e(){this.asyncFuncNodeList=[],this.initCellMapData()}var t=e.prototype;return t.initCellMapData=function(){this.cell={},this.rangeCache={},this.cacheStatus=!0,this.asyncFuncNodeList=[]},t.cleanAllAstNodes=function(e,t,r,n,a){for(var o=t;o<=r;o++)for(var i=n;i<=a;i++)this.deleteCell(e,o,i)},t.destroy=function(){this.cell={},this.rangeCache={},this.cacheStatus=!1,this.asyncFuncNodeList=[]},t.toggleCacheStatus=function(e){this.cacheStatus=e},t.getCacheStatus=function(){return this.cacheStatus},t.setCell=function(e,t,r,n){},t.getCell=function(e,t,r){if(this.cacheStatus){var n=this.cell[e],a=null==n?void 0:n[t];return null==a?void 0:a[r]}},t.deleteCell=function(e,t,r){var n,a;(null===(a=null===(n=this.cell[e])||void 0===n?void 0:n[t])||void 0===a?void 0:a[r])&&delete this.cell[e][t][r]},t.addAsyncFunctionNodeList=function(e){this.asyncFuncNodeList.push(e)},t.getAsyncFunctionNodeList=function(){return this.asyncFuncNodeList},t.cleanAsyncFunctionNodeList=function(){this.asyncFuncNodeList&&this.asyncFuncNodeList.length>0&&(this.asyncFuncNodeList=[])},t.startCalc=function(){this.rangeCache={}},e}()),Dt=p(8902);!function(e){e[e.ERROR=0]="ERROR",e[e.NULL_VALUE=1]="NULL_VALUE",e[e.DIVIDE_BY_ZERO=2]="DIVIDE_BY_ZERO",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.N_A=7]="N_A",e[e.LOADING=8]="LOADING",e[e.CIRCLE=9]="CIRCLE"}(At||(At={}));var bt=/^\s*$/,Ot=p.g.showFormulaLog,Ft=function(){return Ot||p.g.debugFormula},Lt=function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Ft()&&(t=console).error.apply(t,[e].concat(n))},Ut={null:"#NULL!",div0:"#DIV/0!",value:"#VALUE!",ref:"#REF!",circle:"#CIRCLE!",name:"#NAME?",num:"#NUM!",na:"#N/A",error:"#ERROR!",data:"#GETTING_DATA",paramsErr:"#PARAMS!",paramsLack:"#PARAMS_LACK",paramsOver:"#PARAMS_OVER",needUpdate:"#NEED_UPDATE",reorderInFilterView:"#FUNC!"},Bt={};function kt(e){return!("string"!=typeof e||!Object.prototype.hasOwnProperty.call(Bt,e))&&Bt[e]}function Pt(e){var t=e;return kt(t)||(t=Ut.error),t}function Ht(e){return e<10?"0"+e:e}Object.values(Ut).forEach((function(e){Bt[e]=!0}));var Gt=new Map;function Yt(e){if(""===e)return e;var t=0,r=e.length;return"'"===e[0]&&(t+=1,r-=1),e.slice(t,r)}function Vt(e,t){var r=e;return"number"==typeof r&&r.toString().length>=t&&(r=+r.toPrecision(t)),r}function $t(e){if("string"==typeof e&&(n=e,!bt.test(n))){var t=e.indexOf(".");if((-1===t?e.length:t)>=16)return e;var r=Number(e).valueOf();return isFinite(r)?r:e}var n;return e}function jt(e,t){return z(t)+(e+1)}var Zt={"#NULL!":At.NULL_VALUE,"#DIV/0!":At.DIVIDE_BY_ZERO,"#VALUE!":At.VALUE,"#REF!":At.REF,"#CIRCLE!":At.CIRCLE,"#NAME?":At.NAME,"#NUM!":At.NUM,"#N/A":At.N_A,"#ERROR!":At.ERROR,"#NEED_UPDATE":At.LOADING};function Wt(e,t,r,n,a){var o=q(t);return new at(t,n,o.row,o.col,r,a)}function Xt(e,t,r,n){return new it(t,r,n)}function Kt(e,t,r){var n=new ut(t,r);return Dt.kY[t]&&xt.addAsyncFunctionNodeList(n),n}function qt(e,t,r,n){return new st(t,r,n)}function zt(e,t){var r=t.start,n=t.end,a=t.startSheetId,o=t.endSheetId,i=t.originValue,u=t.cellRangeType,s=t.crossTableType,l=[a];o!==a&&(l=e.getSheetIdsAmongTwoSheets(a,o));var c=ee(r,n,u);return new ot(a,o,r,n,c,l,u,s,i)}var Jt=Object.values(Ut),Qt=function(){function e(e){var t=this;this.value="",this.tokenStack=[],this.start=0,this.formula="",this.strateyies=[{match:function(e,t){return rr(t)},action:function(e){t.value+=e}},{match:function(e,t){return er(t)||tr(e)},action:function(e){if(t.value.length>0)t.value+=e;else{var r=fr(t.formula,t.start);if(r.isError)throw new Error("number parse error， "+t.formula.slice(t.start));t.start=r.end-1;var n=t.formula[t.start+1];if(ar(n)||void 0===n){var a=new rt(r.result,qe.NUMBER);t.tokenStack.push(a)}else t.value+=r.result}}},{match:function(e,t){return 34===t},action:function(e){if(t.value.length>0)throw new Error("无法被识别的token:"+t.value+e);var r=dr(t.formula,t.start,'"','"');if(r.isError)throw new Error("无法被识别的token:"+t.formula.slice(t.start,r.end));t.start=r.end;var n=new rt(r.result,qe.STRING);t.tokenStack.push(n)}},{match:function(e){return ar(e)},action:function(e){if(t.value.length>0){var r=cr(t.value);if(r.isError)throw new Error("无法被识别的token:"+t.value);var n=new rt(t.value,r.tokenType);t.tokenStack.push(n)}if(" "===e){t.start=or(t.start+1,t.formula);var a=t.formula[t.start+1];ar(a)&&(e=a,t.start+=1)}var o=new rt(e,qe.SEPARATOR);t.tokenStack.push(o),t.value="",t.start=or(t.start+1,t.formula)}},{match:function(e,t){return 123===t},action:function(e){if(t.value.length>0)throw new Error("无法被识别的token:"+t.value+e);var r=dr(t.formula,t.start,"{","}");if(r.isError)throw new Error("无法被识别的token:"+t.formula.slice(t.start,r.end));t.start=r.end;var n=new rt(r.result,qe.USERARRAY);t.tokenStack.push(n)}},{match:function(e,t){return 39===t},action:function(){var e=dr(t.formula,t.start,"'","'"),r=t.formula[e.end+1].charCodeAt(0);if(e.isError)throw new Error("无法被识别的token:"+t.formula.slice(t.start,e.end));if(!nr(r))throw new Error("无法被识别的token:"+t.formula.slice(t.start,e.end+1));t.start=e.end+1;var n=new rt("'"+e.result+"'",qe.SHEET);t.tokenStack.push(n)}},{match:function(e,t){return nr(t)},action:function(){if(""===t.value)throw new Error("语法有误："+t.formula);var e=new rt(t.value,qe.SHEET);t.tokenStack.push(e),t.value=""}},{match:function(e,t){return 35===t},action:function(e){if(t.value.length>0)throw new Error("无法被识别的token:"+t.value+e);var r=function(e,t){for(var r=Jt.length,n=!0,a="",o=0;o<r;o++){var i=Jt[o];if(t+i.length<=e.length){var u=e.slice(t,t+i.length);if(u===i){t+=i.length,a=u,n=!1;break}}}return{result:a,end:t,isError:n}}(t.formula,t.start);if(r.isError)throw new Error("无法被识别的token:"+t.formula.slice(t.start));t.start=r.end-1;var n=new rt(r.result,qe.ERROR);t.tokenStack.push(n)}},{match:function(e,t){return 13===t||10===t},action:function(){}},{match:function(){return!0},action:function(e){t.value+=e}}],this.formula=e}var t=e.prototype;return t.traverseFormula=function(){for(var e=this.formula.length;this.start<e;this.start++)for(var t=this.formula[this.start],r=t.charCodeAt(0),n=0;n<this.strateyies.length;n++){var a=this.strateyies[n];if(a.match(t,r)){a.action(t);break}}if(this.value.length>0){var o=cr(this.value);if(o.isError)throw new Error("无法被识别的token:"+this.value);var i=new rt(this.value,o.tokenType);this.tokenStack.push(i)}},t.getTokenStack=function(){return this.tokenStack},e}();function er(e){return e>=48&&e<=57}function tr(e){return"."===e}function rr(e){return e>=97&&e<=122||e>=65&&e<=90}function nr(e){return 33===e}function ar(e){return{"&":!0,"=":!0,"<":!0,">":!0,"+":!0,"-":!0,"*":!0,"/":!0,"%":!0,"^":!0,":":!0,"(":!0,")":!0,",":!0," ":!0}[e]}function or(e,t){for(var r=e;" "===t[r];)r+=1;return r-1}var ir=function(e){var t=new Qt(e);return t.traverseFormula(),t.getTokenStack()};function ur(e,t,r,n,a){for(var o=e.length,i=0;r<o&&t(e[r].charCodeAt(0));r++)i+=1;return{accept:i>=n&&i<=a,end:r}}var sr=function(e,t){var r=ur(e,rr,t+1,0,2),n=1;return r.accept||(n=6),{state:n,idx:r.end-1}},lr=function(e,t){var r=ur(e,er,t+1,0,5),n=7;return r.end-t>=7&&Number(e.slice(t,r.end))>1048576&&(n=6),{state:n,idx:r.end-1}},cr=function(){var e={1:qe.COL,6:qe.VARIABLE,7:qe.CELL,8:qe.ROW},t=[[sr,2,,6],[,5,lr,6],[sr,,function(e,t){return{state:8,idx:ur(e,er,t+1,0,5).end-1}}],[],[],[,,function(e,t){return{state:7,idx:ur(e,er,t+1,0,5).end-1}}],[6,,6,6],[6,,,6],[]];return function(r){for(var n=0,a=0,o=!1,i=r.length;a<i;a++){var u,s=r[a];u=rr(s.charCodeAt(0))?0:K(s)?2:"$"===s?1:3;var l=t[n][u],c=typeof l;if("number"===c)n=l;else{if("function"!==c){o=!0;break}var f=l(r,a);if(void 0===f){o=!0;break}n=f.state,a=f.idx}}return{tokenType:e[n]||qe.UNKNOW,isError:o}}}(),fr=function(){var e=[[1,2],[1,2,4],[3,,4],[3,,4],[6,,,5],[6],[6]],t={1:!0,3:!0,6:!0},r=0;return function(n,a){r=0;for(var o="",i=n.length,u=a;u<i;u++){var s,l=n[u];s=er(l.charCodeAt(0))?0:tr(l)?1:"E"===l||"e"===l?2:"+"===l||"-"===l?3:4;var c=e[r][s];if(void 0===c)break;o+=l,r=c}var f=u;return u-=1,{result:o,end:f,isError:!t[r]}}}();function dr(e,t,r,n){for(var a=e.length,o="",i=!0,u=!1;t<a;t++){var s=e[t];if(u||s!==r){if(u&&s===n){if(e[t+1]===s){t+=1,o+=s;continue}i=!1;break}u&&(o+=s)}else u=!0}return{result:o,end:t,isError:i}}var hr,mr,gr=function(){function e(e){this.context=e}var t=e.prototype;return t.parse=function(e,t){this.idx=0,this.stack=[],this.context.element=t,this.tokens=ir(e),this.expression(!0);var r=this.stack[this.stack.length-1],n=te(t.id),a=Wt(this.context,n,t.sheetId,n,A.NONE);return a.setBody(r),a.setFormula(e),a},t.llkMatchType=function(e,t){var r=this.tokens[this.idx+t];return r&&r.type===e},t.llkMatchTypeAndChar=function(e,t,r){var n=this.tokens[this.idx+r];return n&&n.value===t&&n.type===e},t.matchType=function(e){return this.llkMatchType(e,0)},t.matchTypeAndChar=function(e,t){return this.llkMatchTypeAndChar(e,t,0)},t.advance=function(){this.idx+=1},t.back=function(){this.idx-=1},t.currentTokenValue=function(){return this.tokens[this.idx].value},t.isGTorLTorNotEqual=function(e,t){return">"===e&&"="===t||"<"===e&&("="===t||">"===t)},t.expression=function(e){this.expression1(),this.expression0(e)},t.expression1=function(){this.expression2(),this.expression21()},t.expression0=function(e){if(this.matchPriorityOperation0()){var t=this.currentTokenValue();if(this.advance(),this.idx>=this.tokens.length)throw new Error("expected expression，but got empty");var r=this.currentTokenValue();if(this.isGTorLTorNotEqual(t,r)&&(this.advance(),t+=r),this.expression1(),this.stack.length<2)throw new Error("expected expression，but got empty");var n=qt(this.context,t,w.BINARY),a=this.stack[this.stack.length-2],o=this.stack[this.stack.length-1],i=Kt(this.context,"LOGICMATCH",[a,o,n]);this.stack.pop(),this.stack.pop(),this.stack.push(i),this.expression0()}else if(e&&this.idx!==this.tokens.length)throw new Error("expected operation, but got "+this.currentTokenValue())},t.expression21=function(){if(this.matchTypeAndChar(qe.SEPARATOR,"&")){var e=this.currentTokenValue();if(this.advance(),this.expression2(),this.stack.length<2)throw new Error("expected expression，but got empty");var t=qt(this.context,e,w.BINARY),r=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],a=Kt(this.context,"SPECIALMATCH",[r,n,t]);this.stack.pop(),this.stack.pop(),this.stack.push(a),this.expression21()}},t.expression2=function(){this.expression3(),this.expression31()},t.expression31=function(){if(this.matchTypeAndChar(qe.SEPARATOR,"+")||this.matchTypeAndChar(qe.SEPARATOR,"-")){var e=this.currentTokenValue();if(this.advance(),this.expression3(),this.stack.length<2)throw new Error("expected expression，but got empty");var t=qt(this.context,e,w.BINARY),r=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],a=Kt(this.context,"MATHMATCH",[r,n,t]);this.stack.pop(),this.stack.pop(),this.stack.push(a),this.expression31()}},t.expression3=function(){this.expression4(),this.expression41()},t.expression41=function(){if(this.matchTypeAndChar(qe.SEPARATOR,"*")||this.matchTypeAndChar(qe.SEPARATOR,"/")){var e=this.currentTokenValue();if(this.advance(),this.expression4(),this.stack.length<2)throw new Error("expected expression，but got empty");var t=qt(this.context,e,w.BINARY),r=this.stack[this.stack.length-2],n=this.stack[this.stack.length-1],a=Kt(this.context,"MATHMATCH",[r,n,t]);this.stack.pop(),this.stack.pop(),this.stack.push(a),this.expression41()}},t.expression4=function(){if(this.matchTypeAndChar(qe.SEPARATOR,"-")||this.matchTypeAndChar(qe.SEPARATOR,"+")){var e=this.currentTokenValue();this.advance(),this.expression4();var t=this.stack[this.stack.length-1],r="-"===e?w.MINUS:w.NUM,n=qt(this.context,t,r,(function(t,r){t.push(e),this.originValueNode.toString(t,r)}));this.stack.pop(),this.stack.push(n)}else this.expression5(),this.expression51()},t.expression51=function(){if(this.matchTypeAndChar(qe.SEPARATOR,"%")){this.advance();var e=this.stack[this.stack.length-1],t=qt(this.context,e,w.PERCENTAGE,(function(e,t){this.originValueNode.toString(e,t),e.push("%")}));this.stack.pop(),this.stack.push(t),this.expression51()}else if(this.matchTypeAndChar(qe.SEPARATOR,"^")){var r=this.currentTokenValue();if(this.advance(),this.expression5(),this.stack.length<2)throw new Error("expected expression，but got empty");var n=qt(this.context,r,w.BINARY),a=this.stack[this.stack.length-2],o=this.stack[this.stack.length-1],i=Kt(this.context,"MATHMATCH",[a,o,n]);this.stack.pop(),this.stack.pop(),this.stack.push(i),this.expression51()}},t.expression5=function(){this.expression6(),this.expression61()},t.expression61=function(){},t.expression6=function(){if(this.matchTypeAndChar(qe.SEPARATOR,"("))this.advance(),this.expression7();else if(this.lfFunction())this.function();else if(this.lfReference())this.reference(),this.matchTypeAndChar(qe.SEPARATOR," ")&&this.cellRangeIntersectionSeq();else if(this.matchType(qe.STRING)){var e=qt(this.context,'"'+this.currentTokenValue()+'"',w.STR);this.stack.push(e),this.advance()}else if(this.matchType(qe.NUMBER)){var t=qt(this.context,this.currentTokenValue(),w.NUM);this.stack.push(t),this.advance()}else if(this.lfVariable())this.variable();else if(this.matchType(qe.ERROR)){var r=qt(this.context,this.currentTokenValue(),w.ERROR);this.stack.push(r),this.advance()}},t.cellRangeIntersectionSeq=function(){this.cellRangeIntersectionSeq1()},t.cellRangeIntersectionSeq1=function(){this.matchTypeAndChar(qe.SEPARATOR," ")&&(this.stack.push(this.currentTokenValue()),this.advance(),this.reference(),this.newCellRangeIntersection(),this.cellRangeIntersectionSeq1())},t.newCellRangeIntersection=function(){var e=D.INTERSECTION,t=this.stack[this.stack.length-3],r=this.stack[this.stack.length-1],n=Xt(this.context,t,r,e);return this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(n),n},t.function=function(){if(this.stack.push(this.currentTokenValue()),this.advance(),!this.matchTypeAndChar(qe.SEPARATOR,"("))throw new Error("expected (，but got"+this.currentTokenValue());if(this.stack.push(this.currentTokenValue()),this.advance(),this.matchTypeAndChar(qe.SEPARATOR,")"))this.stack.push([]),this.stack.push(this.currentTokenValue()),this.advance(),this.newFunctionNode();else{if(this.expseq(),!this.matchTypeAndChar(qe.SEPARATOR,")"))throw new Error("expected )，but got"+this.currentTokenValue());this.stack.push(this.currentTokenValue()),this.advance(),this.newFunctionNode()}},t.newFunctionNode=function(){var e=this.stack[this.stack.length-4],t=this.stack[this.stack.length-2],r=Kt(this.context,e,t);this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(r)},t.variable=function(){if(!this.matchType(qe.VARIABLE)&&!this.matchType(qe.COL))throw new Error("expected VARIABLE or COL，but got"+this.currentTokenValue());var e=this.currentTokenValue(),t=qt(this.context,e,w.VARIABLE);this.stack.push(t),this.advance()},t.isCellOrRangeWithComma=function(){return this.lfCell()&&this.llkMatchTypeAndChar(qe.SEPARATOR,",",1)||this.lfCellRange()&&this.llkMatchTypeAndChar(qe.SEPARATOR,",",3)},t.expression7=function(){if(this.isCellOrRangeWithComma()?this.cellRangeConcatSeq():this.expression(),!this.matchTypeAndChar(qe.SEPARATOR,")"))throw new Error("expected )，but got"+this.currentTokenValue());this.advance();var e=this.stack[this.stack.length-1],t=qt(this.context,e,w.ORIGIN,(function(e,t){e.push("("),this.originValueNode.toString(e,t),e.push(")")}));this.stack.pop(),this.stack.push(t)},t.cellRangeConcatSeq=function(){this.reference(),this.cellRangeConcatSeq1()},t.cellRangeConcatSeq1=function(){this.matchTypeAndChar(qe.SEPARATOR,",")&&(this.stack.push(this.currentTokenValue()),this.advance(),this.reference(),this.newCellRangeConcatSeq(),this.cellRangeConcatSeq1())},t.newCellRangeConcatSeq=function(){var e=D.CONCAT,t=this.stack[this.stack.length-3],r=this.stack[this.stack.length-1],n=Xt(this.context,t,r,e);return this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(n),n},t.reference=function(){this.lfWildcardSheetNameReference()?this.wildcardReference():this.lfCell()?this.cell():this.cellRange()},t.wildcardReference=function(){var e=this.currentTokenValue(),t=function(e,t){function r(e,t){var r=null;if(e[0]===t)r=[{startSheetName:e[1],endSheetName:e[e.length-1]}];else if(e[e.length-1]===t)r=[{startSheetName:e[0],endSheetName:e[e.length-2]}];else{var n=e.indexOf(t);r=[{startSheetName:e[0],endSheetName:e[n-1]},{startSheetName:e[n+1],endSheetName:e[e.length-1]}]}return r}var n=e.getSheetNames();if(1===n.length)throw new Error("sheet is not enough");var a=Yt(t),o=e.getSheetNameBySheetId(e.element.sheetId),i=null;if("*"===a)i=r(n,o);else{var u=a;u.indexOf("*")>=0&&(u=u.replace(/\*/g,"[\\w\\W]*")),u.indexOf("?")>=0&&(u=u.replace(/\?/g,"[\\w\\W]"));for(var s=new RegExp("^"+u+"$","i"),l=[],c=0;c<n.length;c++){var f=n[c];s.test(f)&&l.push(f)}-1===l.indexOf(o)&&l.push(o),i=r(l,o)}return i}(this.context,e);if(this.advance(),1===t.length){var r=t[0],n=r.startSheetName,a=r.endSheetName,o=new rt("'"+(n===a?n:n+":"+a)+"'",qe.SHEET);return this.back(),this.tokens[this.idx]=o,this.reference()}var i=t[0],u=i.startSheetName,s=i.endSheetName,l=new rt("'"+(u===s?u:u+":"+s)+"'",qe.SHEET),c=t[1],f=c.startSheetName,d=c.endSheetName,h=new rt("'"+(f===d?f:f+":"+d)+"'",qe.SHEET),m=new rt(",",qe.SEPARATOR);if(this.lfLocalCell()){var g=this.tokens[this.idx];this.back(),this.tokens[this.idx]=l,this.tokens.splice(this.idx+2,0,m,h,g)}else if(this.lfLocalCellRange()){var p=this.tokens[this.idx],v=this.tokens[this.idx+1],y=this.tokens[this.idx+2];this.back(),this.tokens[this.idx]=l,this.tokens.splice(this.idx+4,0,m,h,p,v,y)}return this.reference()},t.cell=function(){this.lfLocalCell()?this.localCell():this.lfSheetCell()&&this.sheetCell()},t.localCell=function(){var e=this.currentTokenValue(),t=A.NONE,r=Wt(this.context,e,this.context.element.sheetId,e,t);this.stack.push(r),this.advance()},t.sheetCell=function(){var e=this.currentTokenValue(),t=this.context.getSheetIdBySheetName(e);this.advance();var r=this.currentTokenValue();this.advance();var n=e+"!"+r,a=A.NORMAL,o=Wt(this.context,r,t,n,a);this.stack.push(o)},t.cellRange=function(){if(this.lfLocalCellRange())this.localCellRange();else if(this.lfSheetCellRange()){var e=this.currentTokenValue();if(e.indexOf(":")>=0){this.advance();var t=e.slice(1,e.length-1).split(":"),r=t[0],n=t[1],a=this.context.getSheetIdBySheetName(r),o=this.context.getSheetIdBySheetName(n);e+="!",this.isSheetSingleCell()?this.newThreeDimensionCellNode(e,a,o):this.threeDimensionCellRange({sheetName:e,startSheetId:a,endSheetId:o})}else this.sheetCellRange()}else if(this.lfThreeDimensionCellRange()){var i=this.currentTokenValue(),u=this.context.getSheetIdBySheetName(i,Ut.name);this.advance(),this.advance();var s=this.currentTokenValue(),l=this.context.getSheetIdBySheetName(s,Ut.name);this.advance();var c=i+":"+s+"!";this.threeDimensionCellRange({sheetName:c,startSheetId:u,endSheetId:l})}},t.localCellRange=function(){if(this.isSheetCellRangeNormal()){var e=x.NORMAL,t=A.NONE;this.newCellRangeNode(e,t,zt)}else if(this.isSheetColRange()){var r=x.COL,n=A.NONE;this.newCellRangeNode(r,n,zt)}else if(this.isSheetRowRange()){var a=x.ROW,o=A.NONE;this.newCellRangeNode(a,o,zt)}else{if(!this.matchType(qe.USERARRAY))throw new Error("expected cellRange，but got"+this.currentTokenValue());var i=this.currentTokenValue(),u=x.USER_RANGE,s=A.NONE,l="{"+i+"}",c=this.context.element.sheetId,f=zt(this.context,{start:l,end:l,startSheetId:c,endSheetId:c,originValue:l,cellRangeType:u,crossTableType:s});this.stack.push(f),this.advance()}},t.sheetCellRange=function(){var e=this.currentTokenValue(),t=this.context.getSheetIdBySheetName(e);if(this.advance(),this.isSheetCellRangeNormal()){var r=x.NORMAL,n=A.NORMAL;this.newCellRangeNode(r,n,zt,{startSheetId:t,endSheetId:t,sheetName:e+"!"})}else if(this.isSheetCellRangeNormalWithSheetName()){var a=x.NORMAL,o=A.NORMAL,i=this.currentTokenValue();this.advance();var u=this.currentTokenValue();this.advance(),this.advance();var s=this.currentTokenValue();this.advance();var l=e+i+u+e+s,c=zt(this.context,{start:i,end:s,startSheetId:t,endSheetId:t,originValue:l,cellRangeType:a,crossTableType:o});this.stack.push(c)}else if(this.isSheetColRange()){var f=x.COL,d=A.NORMAL;this.newCellRangeNode(f,d,zt,{startSheetId:t,endSheetId:t,sheetName:e+"!"})}else{if(!this.isSheetRowRange())throw new Error("expected cross table cellRange，but got"+this.currentTokenValue());var h=x.ROW,m=A.NORMAL;this.newCellRangeNode(h,m,zt,{startSheetId:t,endSheetId:t,sheetName:e+"!"})}},t.isSheetSingleCell=function(e){return void 0===e&&(e=0),this.llkMatchType(qe.CELL,e)&&!this.llkMatchTypeAndChar(qe.SEPARATOR,":",e+1)},t.isSheetCellRangeNormal=function(e){return void 0===e&&(e=0),this.llkMatchType(qe.CELL,e)&&this.llkMatchTypeAndChar(qe.SEPARATOR,":",e+1)&&this.llkMatchType(qe.CELL,e+2)},t.isSheetCellRangeNormalWithSheetName=function(e){return void 0===e&&(e=0),this.llkMatchType(qe.CELL,e)&&this.llkMatchTypeAndChar(qe.SEPARATOR,":",e+1)&&this.llkMatchType(qe.SHEET,e+2)&&this.llkMatchType(qe.CELL,e+3)},t.isSheetColRange=function(e){return void 0===e&&(e=0),this.llkMatchType(qe.COL,e)&&this.llkMatchTypeAndChar(qe.SEPARATOR,":",e+1)&&this.llkMatchType(qe.COL,e+2)},t.isSheetRowRange=function(e){return void 0===e&&(e=0),(this.llkMatchType(qe.ROW,e)||this.llkMatchType(qe.NUMBER,e))&&this.llkMatchTypeAndChar(qe.SEPARATOR,":",e+1)&&(this.llkMatchType(qe.ROW,e+2)||this.llkMatchType(qe.NUMBER,e+2))},t.newCellRangeNode=function(e,t,r,n){void 0===n&&(n={startSheetId:this.context.element.sheetId,endSheetId:this.context.element.sheetId,sheetName:""});var a=n,o=a.startSheetId,i=a.endSheetId,u=a.sheetName;this.stack.push(this.currentTokenValue()),this.advance(),this.stack.push(this.currentTokenValue()),this.advance(),this.stack.push(this.currentTokenValue()),this.advance();var s=this.stack[this.stack.length-3],l=this.stack[this.stack.length-2],c=this.stack[this.stack.length-1],f=u+s+l+c;this.stack.pop(),this.stack.pop(),this.stack.pop();var d=r(this.context,{start:s,end:c,startSheetId:o,endSheetId:i,originValue:f,cellRangeType:e,crossTableType:t});this.stack.push(d)},t.newThreeDimensionCellNode=function(e,t,r){var n=x.NORMAL,a=A.THREE_DIMENSION,o=this.currentTokenValue();this.advance();var i=e+o,u=zt(this.context,{start:o,end:o,startSheetId:t,endSheetId:r,originValue:i,cellRangeType:n,crossTableType:a});this.stack.push(u)},t.threeDimensionCellRange=function(e){var t=e.startSheetId,r=e.endSheetId,n=e.sheetName;if(this.isSheetSingleCell())this.newThreeDimensionCellNode(n,t,r);else if(this.isSheetCellRangeNormal()){var a=x.NORMAL,o=A.THREE_DIMENSION;this.newCellRangeNode(a,o,zt,{startSheetId:t,endSheetId:r,sheetName:n})}else if(this.isSheetColRange()){var i=x.COL,u=A.THREE_DIMENSION;this.newCellRangeNode(i,u,zt,{startSheetId:t,endSheetId:r,sheetName:n})}else{if(!this.isSheetRowRange())throw new Error("expected cross table cellRange，but got"+this.currentTokenValue());var s=x.ROW,l=A.THREE_DIMENSION;this.newCellRangeNode(s,l,zt,{startSheetId:t,endSheetId:r,sheetName:n})}},t.expseq=function(){var e=this.stack;if(this.stack=[],this.expression(),this.expseq1(),this.llkMatchTypeAndChar(qe.SEPARATOR,",",-1)){var t=qt(this.context,"",w.PLACEHOLDER);this.stack.push(t)}e.push(this.stack),this.stack=e},t.expseq1=function(){if(this.matchTypeAndChar(qe.SEPARATOR,",")){if(this.llkMatchTypeAndChar(qe.SEPARATOR,"(",-1)||this.llkMatchTypeAndChar(qe.SEPARATOR,",",-1)){var e=qt(this.context,"",w.PLACEHOLDER);this.stack.push(e)}this.advance(),this.expression(),this.expseq1()}},t.lfWildcardSheetNameReference=function(){var e=this.currentTokenValue();return this.matchType(qe.SHEET)&&(-1!==e.indexOf("*")||-1!==e.indexOf("?"))},t.lfCell=function(){return this.lfLocalCell()||this.lfSheetCell()},t.lfLocalCell=function(){return this.matchType(qe.CELL)&&!this.llkMatchTypeAndChar(qe.SEPARATOR,":",1)},t.lfSheetCell=function(){var e=this.currentTokenValue();return this.matchType(qe.SHEET)&&-1===e.indexOf(":")&&this.llkMatchType(qe.CELL,1)&&!this.llkMatchTypeAndChar(qe.SEPARATOR,":",2)},t.lfCellRange=function(){return this.lfLocalCellRange()||this.lfSheetCellRange()||this.lfThreeDimensionCellRange()},t.lfLocalCellRange=function(){return this.isSheetCellRangeNormal()||this.isSheetColRange()||this.isSheetRowRange()||this.matchType(qe.USERARRAY)},t.lfSheetCellRange=function(){if(this.matchType(qe.SHEET)){var e=this.currentTokenValue();return this.llkMatchType(qe.CELL,1)&&!this.llkMatchTypeAndChar(qe.SEPARATOR,":",2)&&e.indexOf(":")>=0||this.isSheetCellRangeNormalWithSheetName(1)||this.isSheetCellRangeNormal(1)||this.isSheetColRange(1)||this.isSheetRowRange(1)}return!1},t.lfThreeDimensionCellRange=function(){return!(!this.llkMatchTypeAndChar(qe.SEPARATOR,":",1)||!this.llkMatchType(qe.SHEET,2))&&(this.isSheetSingleCell(3)||this.isSheetCellRangeNormal(3)||this.isSheetColRange(3)||this.isSheetRowRange(3))},t.lfFunction=function(){return(this.matchType(qe.VARIABLE)||this.matchType(qe.COL)||this.matchType(qe.CELL))&&this.llkMatchTypeAndChar(qe.SEPARATOR,"(",1)},t.lfVariable=function(){return this.matchType(qe.VARIABLE)||this.matchType(qe.COL)&&!this.llkMatchTypeAndChar(qe.SEPARATOR,":",1)},t.lfReference=function(){return this.lfCell()||this.lfCellRange()},t.matchPriorityOperation0=function(){var e=this.tokens[this.idx];return e&&("="===e.value||"<"===e.value||">"===e.value)},e}(),pr=function(){function e(e){var t=this;this.parse=function(e,r){var n,a,o=null;try{var i=e;n=t.parser.parse(i,r);var u=xt.getAsyncFunctionNodeList();u.length>0&&(n.setAsyncFunctionNodeList(u),xt.cleanAsyncFunctionNodeList()),xt.setCell(r.sheetId,r.row,r.col,n)}catch(e){Lt("函数层出现错误",e),a=Pt(e.message),o=e.prop,n={error:a,errorProp:o,value:n}}return n},this.processInjectFunctions(e),this.parser=new gr(e)}return e.prototype.processInjectFunctions=function(e){var t=e.getSheetIdBySheetName;e.getSheetIdBySheetName=function(e,r){void 0===e&&(e=""),void 0===r&&(r=Ut.ref);var n=Yt(e),a=t(n);if(!a)throw new Error(r);return a}},e}(),vr=p(8045),yr=p(2021),Nr=p(8177),Mr=p.n(Nr),Rr=function(e){var t={};return p.d(t,e),t}({SUPPORT_CURRENCY_LIST:function(){return l.SUPPORT_CURRENCY_LIST},getCellNumberFormatType:function(){return l.getCellNumberFormatType},getDefaultNumberFormat:function(){return l.getDefaultNumberFormat},getNumberFormatByFormatCode:function(){return l.getNumberFormatByFormatCode},isNumeric:function(){return l.isNumeric}}),Er={name:"en",weekdays:"SUNDAY_MONDAY_TUESDAY_WEDNESDAY_THURSDAY_FRIDAY_SATURDAY".split("_"),weekdaysShort:"SUN_MON_TUE_WED_THU_FRI_SAT".split("_"),months:"JANUARY_FEBRUARY_MARCH_APRIL_MAY_JUNE_JULY_AUGUST_SEPTEMBER_OCTOBER_NOVEMBER_DECEMBER".split("_"),monthsShort:"JAN_FEB_MAR_APR_MAY_JUN_JUL_AUG_SEP_OCT_NOV_DEC".split("_")},_r={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_")};(mr=hr||(hr={}))[mr.NUMBER=0]="NUMBER",mr[mr.STRING=1]="STRING",mr[mr.BOOL=2]="BOOL",mr[mr.FORMULA=3]="FORMULA";var Tr,Sr,Ir=hr;(Sr=Tr||(Tr={})).GENERAL="auto",Sr.TEXT="text",Sr.NUMBER="number",Sr.PERCENT="percent",Sr.CURRENCY="currency",Sr.DATE="date",Sr.TIME="time",Sr.DATE_TIME="date-time",Sr.FRACTION="fraction",Sr.SCIENTIFIC="scientific",Sr.ACCOUNTING="accounting",Sr.SPECIAL="special",Sr.CUSTOM="custom";var Cr=Tr;function Ar(e,t){return function(e,t){if("string"==typeof e){var r,n,a=(e=e.replace(/\//g,"-")).match(/\s*[0-9a-zA-Z日号月](\s+)[0-9上下aApP]+/);if(a&&a[0]&&a[1]){var o=a.index+1,i=e.substring(0,o);if(!/^\s+/.test(i)){i=i.replace(/\s/g,"");var u=e.substring(o,e.length).replace(/\s/g,"");u=function(e){var t=e,r=(e=e.replace(/\s/g,"")).length,n=e.substring(r-2,r).toUpperCase(),a=e[r-1].toUpperCase();return-1!==["AM","PM","上午","下午"].indexOf(n)?e.substring(0,r-2)+" "+n:-1!==["A","P"].indexOf(a)?e.substring(0,r-1)+" "+a:t}(u);var s=Gr(i),l=Hr(u);if(s&&l&&0!==s.moment.year()){var c=s.moment.format("YYYY-MM-DD")+"T"+l.moment.format("HH:mm:ss")+"+08:00",f=qr(c);return f>0&&(n=Xr(f,t)),void 0!==n?(r="yyyy/m/d h:mm",l.pattern&&-1!==l.pattern.indexOf("s")&&(r="yyyy/m/d h:mm:ss;@"),{type:Cr.DATE_TIME,pattern:r,numericValue:n,valueType:Ir.NUMBER}):void 0}}}}}(e,t)||Gr(e,t)||Hr(e,t)}function wr(e,t){return Yr(e,t)||$r(e,t)||Zr(e,t)||Wr(e,t)||Vr(e,t)||kr(e,t)||Ar(e,t)||{numericValue:e}}function xr(e){return null==(t=e.value)||""===t||/\n/.test(t)?{isSuccess:!0,data:void 0}:{isSuccess:!1};var t}function Dr(e){return"number"==typeof e.value?{isSuccess:!0,data:{newValue:e.value,type:e.numberFormatType.type,pattern:e.numberFormat.pattern,numericValue:e.value,valueType:Ir.NUMBER}}:{isSuccess:!1}}function br(e){return e.numberFormatType.type===Cr.TEXT?{isSuccess:!0,data:{newValue:e.value,type:Cr.TEXT,pattern:"@",numericValue:e.value,valueType:Ir.STRING}}:{isSuccess:!1}}function Or(e){return"string"==typeof e.value&&"="===e.value[0]&&e.value.length>1?{isSuccess:!0,data:{newValue:e.value,type:e.numberFormatType.type,pattern:e.numberFormat.pattern,numericValue:e.value,valueType:Ir.FORMULA}}:{isSuccess:!1}}function Fr(e,t){return 0===e.parseMode&&/^[-]?(0|[1-9][0-9]*)(\.[0-9]*)?$/.test(e.value)?{isSuccess:!0,data:{newValue:Xr(e.value,t),type:e.numberFormatType.type,pattern:e.numberFormat.pattern,numericValue:Xr(e.value,t),valueType:Ir.NUMBER}}:{isSuccess:!1}}function Lr(e,t){var r=function(e,t){var r=t&&t.numberFormat;if("string"==typeof(e=e||"")){var n,a=(0,Rr.getCellNumberFormatType)(r).group;if(n=e.match(/^(\d+)\/(\d*[1-9]\d*)$/))switch(a){case Cr.FRACTION:n=kr(e,t);break;case Cr.NUMBER:(n=kr(e,t))&&(n.type=Cr.NUMBER,n.pattern="0.00_);[Red](0.00)");break;default:n=Gr(e,t)}return n?{originValue:e,numericValue:n.numericValue,type:n.type,pattern:n.pattern,valueType:n.valueType}:void 0}}(e.value,t)||Yr(e.value,t)||$r(e.value,t)||Zr(e.value,t)||Wr(e.value,t)||Vr(e.value,t)||kr(e.value,t)||Ar(e.value,t),n=void 0!==r?r.numericValue:e.value,a=void 0!==r?r.valueType:Ir.STRING,o=function(e,t){var r,n;if(t&&1===e.parseMode){var a=(0,Rr.getCellNumberFormatType)(t.pattern);t.type===Cr.NUMBER?Br(e.numberFormatType.group)||e.numberFormatType.group===Cr.GENERAL?(r=Cr.GENERAL,n="General"):(r=e.numberFormatType.type,n=e.numberFormat.pattern):Br(e.numberFormatType.group)&&e.numberFormatType.group===a.group||e.numberFormatType.type===t.type?(r=e.numberFormatType.type,n=e.numberFormat.pattern):(r=t.type,n=t.pattern)}else 0===e.parseMode&&e.numberFormatType.type===Cr.GENERAL&&t&&t.type!==Cr.NUMBER?(r=t.type,n=t.pattern):(r=e.numberFormatType.type,n=e.numberFormat.pattern);return{type:r,pattern:n}}(e,r);return{isSuccess:!0,data:{newValue:n,type:o.type,pattern:o.pattern,numericValue:n,valueType:a}}}var Ur=function(e,t,r){var n=(null==r?void 0:r.parseMode)||0;try{t=t||(0,Rr.getDefaultNumberFormat)(),r&&(r.numberFormat=t);for(var a,o,i,u=(0,Rr.getCellNumberFormatType)(t),s=e,l={value:e,numberFormat:t,numberFormatType:u,parseMode:n},c=[xr,Dr,br,Or,Fr,Lr];i=c.shift();)if((o=i.apply(this,[l,r])).isSuccess){a=o.data;break}var f=o.data||{newValue:e},d=f.newValue,h=f.pattern;return d!==-1/0&&d!==1/0&&a||(d=e,h=t.pattern),t=(0,Rr.getNumberFormatByFormatCode)(h),null==d&&(d=""),{originValue:s,value:d,numberFormat:t,valueType:a?a.valueType:Ir.STRING}}catch(t){console.warn(t);var m=e;return null==m&&(m=""),{originValue:e,value:m,numberFormat:(0,Rr.getDefaultNumberFormat)(),valueType:Ir.STRING}}};function Br(e){switch(e){case Cr.DATE:case Cr.TIME:case Cr.DATE_TIME:return!0}return!1}function kr(e,t){var r=t&&t.numberFormat,n=/^\s*[(（]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*))\s*[)）]\s*$/.exec(e);n&&n[1]&&(e="-"+n[1]);var a=e&&"string"==typeof e&&e.match(/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)$/),o=(0,Rr.getCellNumberFormatType)(r).group;if(a&&a[3]&&a[4]){var i=new(Re())(a[3]),u=new(Re())(a[4]),s=!(!a[1]||"-"!==a[1].trim());if(i.greaterThan(32767)||u.greaterThan(32767))return;var l=a[4].length,c=i.div(u),f=!!a[2];if(f){var d=new(Re())(a[2].trim());c=c.plus(d)}else if(o===Cr.GENERAL||0===u.toNumber()||!f&&0===i.toNumber())return;s&&(c=c.mul(-1));var h=new Array(l+1).join("?"),m="# "+h+"/"+h;return{type:Cr.FRACTION,pattern:m,numericValue:c.toNumber(),valueType:Ir.NUMBER}}}function Pr(e,t,r){return void 0===t&&(t=!0),t&&void 0!==r&&(e=-1!=="P_PM_下午".split("_").indexOf(r.toUpperCase())?(Number(e)%12+12).toString():(Number(e)%12+0).toString()),e&&e.length<2&&(e="0"+e),e}function Hr(e,t){if("string"==typeof e){var r,n=function(e){var t;if(t=e.match(/^\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s*$/)){var r=[{dateTime:"1970-01-01T"+Pr(t[1])+":"+Pr(t[2])+":"+Pr(t[3])+"."+(t[5]||0)+"+0800",targetFormat:void 0===t[5]?"h:mm:ss;@":"h:mm:ss.0"}];return zr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s*$/)){var n,a,o;void 0===t[4]?(n=Pr(t[1]),a=Pr(t[2]),o="00"):(n="00",a=Pr(t[1]),o=Pr(t[2]));var i=[{dateTime:"1970-01-01T"+n+":"+a+":"+o+"."+(t[4]||0)+"+0800",targetFormat:void 0===t[4]?"h:mm;@":"mm:ss.0"}];return zr.instance().parseMoment(i)}return!1}(e=e.replace(/：/g,":"))||function(e){var t;if(t=e.match(/^([0-9]{1,2})\s*:\s*([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s+(A|AM|P|PM|上午|下午)\s*$/i)){var r=[{dateTime:"1970-01-01T"+Pr(t[1],!0,t[6])+":"+Pr(t[2])+":"+Pr(t[3])+"."+(t[5]||0)+"+0800",targetFormat:void 0===t[5]?"[$-409]h:mm:ss\\ AM/PM;@":"h:mm:ss.0"}];return zr.instance().parseMoment(r)}if(t=e.match(/^([0-9]{1,2})\s*:\s*([0-9]{1,2})(\.(\d+))?\s+(A|AM|P|PM|上午|下午)$/i)){var n,a,o;void 0===t[4]?(n=Pr(t[1],!0,t[5]),a=Pr(t[2]),o="00"):(n=Pr("00",!0,t[5]),a=Pr(t[1]),o=Pr(t[2]));var i=[{dateTime:"1970-01-01T"+n+":"+a+":"+o+"."+(t[4]||0)+"+0800",targetFormat:void 0===t[4]?"[$-409]h:mm AM/PM;@":"mm:ss.0"}];return zr.instance().parseMoment(i)}return!1}(e)||function(e){var t;if(t=e.match(/^\s*(A|AM|P|PM|上午|下午)([0-9]{1,2})时([0-9]{1,2})分\s*$/i)){var r=[{dateTime:"1970-01-01T"+Pr(t[2],!0,t[1])+":"+Pr(t[3])+":00.0+0800",targetFormat:yr.default.t('上午/下午h"时"mm"分";@')}];return zr.instance().parseMoment(r)}if(t=e.match(/^\s*(A|AM|P|PM|上午|下午)([0-9]{1,2})时([0-9]{1,2})分([0-9]{1,2})秒\s*$/i)){var n=[{dateTime:"1970-01-01T"+Pr(t[2],!0,t[1])+":"+Pr(t[3])+":"+Pr(t[4])+".0+0800",targetFormat:yr.default.t('上午/下午h"时"mm"分"ss"秒";@')}];return zr.instance().parseMoment(n)}return!1}(e)||function(e){var t;if(t=e.match(/^\s*([0-9]{1,2})时([0-9]{1,2})分([0-9]{1,2})秒$/i)){var r=[{dateTime:"1970-01-01T"+Pr(t[1])+":"+Pr(t[2])+":"+Pr(t[3])+".0+0800",targetFormat:yr.default.t('h"时"mm"分"ss"秒";@')}];return zr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,2})时([0-9]{1,2})分\s*$/i)){var n=[{dateTime:"1970-01-01T"+Pr(t[1])+":"+Pr(t[2])+":00.0+0800",targetFormat:yr.default.t('h"时"mm"分";@')}];return zr.instance().parseMoment(n)}}(e);if(null==n?void 0:n.moment){if("1970-01-01"!==n.moment.format("YYYY-MM-DD"))return;var a=n.moment.format("HH:mm:ss.SSS");r=qr("1899-12-31T"+a+"+08:00")}return void 0!==r?(r=Xr(r,t),{type:Cr.TIME,pattern:n&&n.pattern,numericValue:r,valueType:Ir.NUMBER,moment:n&&n.moment}):void 0}}function Gr(e,t){if("string"==typeof e){var r,n=function(e){var t;if(t=e.match(/^([0-9]{1,4})\s*-\s*([0-9]{1,4})\s*-\s*([0-9]{1,4})\s*$/)){var r=[{dateTime:zr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:"yyyy/m/d"},{dateTime:zr.instance().getFullYear(t[3])+"-"+t[1]+"-"+t[2],targetFormat:"m/d/yyyy"}];return zr.instance().parseMoment(r)}if(t=e.match(/^([0-9]{0,4})\s*-\s*([0-9]{1,4})\s*$/)){var n=Number(t[1]);if(n>=0&&n<=99&&t[1].length<=2||n>=1900){var a=[{dateTime:zr.instance().getFullYear()+"-"+t[1]+"-"+t[2],targetFormat:yr.default.t('m"月"d"日";@')},{dateTime:zr.instance().getFullYear()+"-"+t[2]+"-"+t[1],targetFormat:yr.default.t('m"月"d"日";@')},{dateTime:zr.instance().getFullYear(t[1])+"-"+t[2]+"-1",targetFormat:"mmm-yy"}];return zr.instance().parseMoment(a)}}return!1}(e=e.replace(/\//g,"-"))||function(e){var t;if(t=e.match(/^\s*([0-9]{1,4})年([0-9]{1,4})月([0-9]{1,4})日\s*$/)){var r=[{dateTime:zr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:yr.default.t('yyyy"年"m"月"d"日";@')}];return zr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,4})年([0-9]{1,4})月\s*$/)){var n=[{dateTime:zr.instance().getFullYear(t[1])+"-"+t[2]+"-1",targetFormat:yr.default.t('yyyy"年"m"月";@')}];return zr.instance().parseMoment(n)}if(t=e.match(/^\s*([0-9]{1,4})月([0-9]{1,4})日\s*$/)){var a=[{dateTime:zr.instance().getFullYear()+"-"+t[1]+"-"+t[2],targetFormat:yr.default.t('m"月"d"日";@')}];return zr.instance().parseMoment(a)}return!1}(e)||function(e){var t;if(t=e.match(/^([0-9]{1,4})\s*-\s*((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*-\s*([0-9]{1,4})\s*$/i)){var r=[{dateTime:zr.instance().getFullYear(t[4])+"-"+zr.instance().getMonthNum(t[2],"en")+"-"+t[1],targetFormat:"[$-409]d-mmm-yy;@"}];return zr.instance().parseMoment(r)}if(t=e.match(/^((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*-\s*([0-9]{1,4})\s*$/i)){var n=zr.instance().getMonthNum(t[1],"en"),a=[{dateTime:zr.instance().getFullYear()+"-"+n+"-"+t[3],targetFormat:"d-mmm"},{dateTime:zr.instance().getFullYear(t[3])+"-"+n+"-1",targetFormat:"mmm-yy"}];return zr.instance().parseMoment(a)}if(t=e.match(/^\s*([0-9]{1,4})\s*-\s*((JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*)\s*$/i)){var o=zr.instance().getMonthNum(t[2],"en"),i=[{dateTime:zr.instance().getFullYear()+"-"+o+"-"+t[1],targetFormat:"d-mmm"}];return zr.instance().parseMoment(i)}return!1}(e)||function(e){var t;if(t=e.match(/^([0-9]{2,4})\s*\.\s*([0-9]{1,2})\s*\.\s*([0-9]{1,2})\s*$/)){var r=[{dateTime:zr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:'yyyy"."m"."d'}];return zr.instance().parseMoment(r)}if(t=e.match(/^\s*([0-9]{1,4})年([0-9]{1,4})月([0-9]{1,4})号\s*$/)){var n=[{dateTime:zr.instance().getFullYear(t[1])+"-"+t[2]+"-"+t[3],targetFormat:yr.default.t('yyyy"年"m"月"d"号"')}];return zr.instance().parseMoment(n)}if(t=e.match(/^\s*([0-9]{1,4})月([0-9]{1,4})号\s*$/)){var a=[{dateTime:zr.instance().getFullYear()+"-"+t[1]+"-"+t[2],targetFormat:yr.default.t('m"月"d"号"')}];return zr.instance().parseMoment(a)}return!1}(e);if(n&&n.moment){if(0===n.moment.year())return;var a=n.moment.format("YYYY-MM-DDTHH:mm:ss.SSS+08:00"),o=qr(a);o>0&&(r=Xr(o,t))}return void 0!==r?{type:Cr.DATE,pattern:n&&n.pattern,numericValue:r,valueType:Ir.NUMBER,moment:n&&n.moment}:void 0}}function Yr(e,t){var r=/^\s*[(（]\s*((\d+(\.\d+)?)|(\.\d+))\s*[)）]\s*$/.exec(e);if(r&&r[1]&&(e="-"+r[1]),/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*$/.test(e))return e=Xr(e=e.replace(/\s/g,""),t),{type:Cr.NUMBER,pattern:"0.00_);[Red](0.00)",numericValue:e,valueType:Ir.NUMBER}}function Vr(e,t){var r=/^\s*[(（]\s*(\d{1,3}([,，]\d{3})+(\.\d*)?)*\s*[)）]\s*$/.exec(e);if(r&&r[1]&&(e="-"+r[1]),r=/^\s*[+-]?\s*((\d{1,3})([,，]\d{3})+(\.\d*)?)\s*$/.exec(e)){var n="#,##0";-1!==(e=e.replace(/[,，\s]/g,"")).indexOf(".")&&(n="#,##0.00");var a=e=Xr(e,t);if(/^0{1,3}$/.test(r[2]))return;return{type:"thousand_numeral",pattern:n,numericValue:a,valueType:Ir.NUMBER}}}function $r(e,t){if("string"==typeof e){var r,n=/^\s*[(（]\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*[)）]\s*$/.exec(e)||/^\s*[(（]\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*%\s*$/.exec(e)||/^\s*[(（]\s*%\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*$/.exec(e)||/^\s*%\s*[(（]\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*$/.exec(e);n&&n[1]&&(e="-"+n[1]+"%");var a=-1!==e.indexOf(".");if(r=function(e){return/^\s*[+-]?\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*$/.test(e)?(e=e.replace(/\s/g,"")).substr(0,e.length-1):!(!/^\s*%\s*[+-]?\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e)&&!/^\s*[+-]?\s*%\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e))&&(-1!==(e=e.replace(/\s/g,"")).indexOf("+")?e.substr(2,e.length):-1!==e.indexOf("-")?"-"+e.substr(2,e.length):e.substr(1,e.length))}(e),/^\s*[(（]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*)(%))\s*[)）]\s*$/.test(e)||/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)(%)$/.test(e)){var o=kr(e.replace(/%/g,""),t);null!=o&&(a="string"==typeof(r=o.numericValue)&&-1!==r.indexOf("."))}if("string"==typeof r){r=Xr(r=r.replace(/[,，]/g,""),t),r=new(Re())(r).div(100).toString();var i=a?"0.00%":"0%";return{type:Cr.PERCENT,pattern:i,numericValue:r,valueType:Ir.NUMBER}}}}Mr().prototype.parseTwoDigitYear=function(e){var t=(new Date).getFullYear()+11,r=parseInt(e,10);return r+2e3<=t?r+2e3:r+1900};var jr=["$"];function Zr(e,t){if("string"==typeof e){e=e.toUpperCase();var r=/^\s*(\$|￥|¥|HK\$|US\$)\s*[（(]\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*$/.exec(e)||/^\s*[（(]\s*(\$|￥|¥|HK\$|US\$)\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))\s*[)）]\s*$/.exec(e);r&&r[1]&&r[2]&&(e="-"+r[1]+r[2]);for(var n=0;n<Rr.SUPPORT_CURRENCY_LIST.length;n++){for(var a=Rr.SUPPORT_CURRENCY_LIST[n],o=a.symbol,i=0;i<jr.length;i++)o=o.replace(jr[i],"\\"+jr[i]);if(new RegExp("^\\s*[+-]?\\s*"+o+"\\s*[+-]?\\s*((\\d{1,3})([,，]?\\d{3})*(\\.\\d*)?|(\\.\\d+))\\s*$").test(e)){e=e.replace(/\s/g,"").replace(a.symbol,"").replace(/[,，]/g,"");var u=a.pattern;-1!==e.indexOf(".")&&(u=a.pattern_decimal);var s=Xr(e,t);if((0,Rr.isNumeric)(s))return{type:a.type,pattern:u,numericValue:s,valueType:Ir.NUMBER}}}}}function Wr(e,t){if("string"==typeof e){var r=/^\s*[(（]((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)[)）]\s*$/.exec(e.toUpperCase());if(r&&r[1]&&r[6]&&(e="-"+r[1]+"E"+r[6]),(r=/^\s*[(（]((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)\s*%\s*[)）]\s*$/.exec(e.toUpperCase())||/^\s*[(（]((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)[)）]\s*%\s*$/.exec(e.toUpperCase()))&&r[1]&&r[6]&&(e="-"+r[1]+"E"+(Number(r[6])-2)),r=/^\s*([+-])?\s*((\d{1,3}([,，]?\d{3})*(\.\d*)?)|(\.\d+))[Ee]([+-]?\d+)\s*(%\s*)?$/.exec(e)){var n=parseInt(r[7],10);if(r[8]?(n-=2,e=""+(r[1]?r[1]:"")+r[2]+"E"+(Number(r[7])-2)):e=""+(r[1]?r[1]:"")+r[2]+"E"+r[7],!(n>=308||n<=-310)){-309===n&&(e="0");var a=e=Xr(e=e.replace(/[,，]/g,""),t);return{type:Cr.SCIENTIFIC,numericValue:a,pattern:"0.00E+00",valueType:Ir.NUMBER}}}}}function Xr(e,t){var r=function(e,t,r){t=t||15;var n=parseFloat(e);if(isNaN(n))return e;var a="",o=-1===(e=(e=""+e).trim()).indexOf("e")?e.indexOf("E"):e.indexOf("e");-1!==o&&(a=e.slice(o),e=e.slice(0,o));for(var i=e.split(""),u=0,s=0,l=!1,c=0;c<i.length;c++){var f=i[c];if("-"!==f||0!==c)if("."===f)l=!0,u>=t&&(i[c]="");else if(isNaN(parseInt(f,10)))i[c]="";else if(l){if(s+=1,(u>=t||u+s>t)&&(i[c]=""),!0===r&&u+s===t+1&&parseInt(f,10)>=5){var d=""===i[c-1]?c-2:c-1,h=parseInt(i[d],10);isNaN(h)||(i[d]=""+(h+1))}}else(u+=1)>t&&(i[c]="0"),!0===r&&u===t+1&&parseInt(f,10)>=5&&(i[c-1]=""+(parseInt(i[c-1],10)+1))}return i.join("")+a}(e,void 0,t&&t.toRound);return t&&t.toRound?r:function(e){if("number"==typeof e)return!1;if(!e)return!1;var t=e.indexOf(".");-1!==t&&(e=e.substr(0,t)+e.substr(t+1,e.length));var r=(e=(e=e.replace(/[+-]/,"")).toUpperCase()).indexOf("E");-1!==r&&(e=e.substr(0,r));var n=e.match(/^[0]*([1-9]([0-9]*[1-9])?)[0]*$/);return!!(n&&n[1].length>16)}(e)?e:parseFloat(e)}var Kr,qr=function(e,t){var r=(void 0===t?{}:t).need_1900_2_29,n=void 0!==r&&r,a=e,o=!1;/1900-0?2-29/.test(e)&&(a=e.replace("1900-2-29","1900-3-1"),o=!0);var i=(Date.parse(a)-Date.parse("1970-01-01T00:00:00.000+08:00"))/864e5+25568;return n&&(i=i>=60&&!o?i+1:i),i},zr=function(){function e(){this.supportLocales=new Map,this.supportLocales.set("en",Er),this.supportLocales.set("zh-cn",_r)}e.instance=function(){return e._instance};var t=e.prototype;return t.getFullYear=function(e){if(!e)return(new Date).getFullYear().toString();if(e.length>=4)return e;var t=(new Date).getFullYear()+11,r=parseInt(e,10);return r+2e3<=t?r+2e3:r+1900},t.getMonthNum=function(e,t){var r=0;if(e.length<3)return r;var n=this.supportLocales.get(t);if(n){e=e.toUpperCase();for(var a=0;a<n.months.length;a++)if(n.months[a].startsWith(e)){r=a+1;break}}return r},t.parseMoment=function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r.dateTime,a=Mr()(n);if(a.isValid())return{moment:a,pattern:r.targetFormat}}},e}();zr._instance=new zr;var Jr=function(e){Kr=e},Qr=function(e){var t;return t=ft(e)?e.toArray()[0]:e,(0,Se.kE)(t)?"number"==typeof t?t:"string"==typeof e?Ur(e).value:t:t},en=function(e){var t,r,n=e;if(ft(n)&&(n.isCell?(t=n.toArray(),n=t[0]):n=n.toArray()),Array.isArray(n))r=n.map((function(e){return-1*Ur(e).value}));else{if(r=Qr(n),isNaN(r))return Ut.value;r*=-1}return r},tn=function(e,t){void 0===e&&(e=""),void 0===t&&(t=Ut.ref);var r=Yt(e),n=Kr.getExternalMethod().getSheetIdBySheetName(r);if(!n)throw new Error(t);return n},rn=function(e,t,r){var n=et.getFuncNode(),a=(null==n?void 0:n.funcName)||"",o=!Dt.JK[a],i=Kr.getExternalMethod().cellValue(e,t,r);if("object"==typeof i&&i&&i.displayText)i=i.displayText;else if(""===i)""===Kr.getExternalMethod().cellEditValue(e,t,r)&&(i=null);else if(o){var u=$t(i);Dt.vG[a]?(null==i?void 0:i.toString())===String(u)&&(i=u):i=u}return i};function nn(){var e,t=this.identities[0],r=rn(t.row,t.col,t.sheetId);kt(r)&&(e=[r]);var n=[r];return n.error=e,n.rowCount=t.rowCount,n.colCount=t.colCount,n.rangeCount=1,n}function an(){return on(this.identities)}function on(e){var t,r,n,a=0,o=0,i=0,u=0,s=0,l=0,c=[],f=!1,d=et.getRangeCache(),h=et.getFuncNode(),m=(null==h?void 0:h.funcName)||"";c.error=[];for(var g=e.length,p=0;p<g;p++){var v=e[p],y=void 0;if(a=v.rowCount,o=v.colCount,t=v.sheetId,s=(i=v.row)+a,l=(u=v.col)+o,(f=a*o>1500)&&(y=d[n=i+"_"+u+"_"+a+"_"+o+"_"+t]),y)0===c.length&&1===g?(c=y).error=[]:Array.prototype.push.apply(c,y);else{for(var N=!Dt.JK[m],M=i;M<s;M++)for(var R=u;R<l;R++){var E=Kr.getExternalMethod().cellValue(M,R,t);if(E&&(0,vr.zH)(E))r=E.displayText;else if(""===E)r=""===Kr.getExternalMethod().cellEditValue(M,R,t)?null:E;else if(N){r=E;var _=$t(E);Dt.vG[m]?(null==r?void 0:r.toString())===String(_)&&(r=_):r=_}else r=E;kt(r)&&c.error.push(r),c.push(r)}f&&(d[n]=c)}}return c.rowCount=a,c.colCount=o,c.rangeCount=g,c.row=i,c.col=u,c}var un=function(e,t){void 0===t&&(t=!1);var r=e.value,n=Dt.kY[e.funcName];if(!t&&!n||t&&n){for(var a=e.args.length,o=[],i=0;i<a;i++){var u=e.args[i];u.setCalculateParentFunctionNode(e);var s=ln(u);Tt(u)&&u.variableType===w.PLACEHOLDER&&(s=dn[e.funcName]?"":0),o.push(s)}try{r=function(e,t,r,n){void 0===t&&(t=[]);var a=e.toUpperCase(),o=Kr.element,i=Kr.formulas[a];if(i){et.setAstNodes(r),et.setFuncNode(n),o&&et.setElement(o),et.setInstance(Kr);var u=Vt(i(t),15);return et.clear(),u}throw console.error(a+"函数不存在或还无法使用"),new Error(Ut.name)}(e.funcName,o,e.args,e),function(e){var t=e.astNode;if(Ft()&&Et(t)){var r=[];t.toString(r,{}),r.join("")}}({astNode:e,args:o,result:r})}catch(e){Lt(e),r=Pt(e.message)}"number"!=typeof r||isFinite(r)||(r=Ut.num)}return r},sn=function(e){return tt(void 0,void 0,void 0,c().mark((function t(){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,un(e,!0);case 2:return r=t.sent,t.abrupt("return",(e.setValue(r),r));case 4:case"end":return t.stop()}}),t)})))},ln=function e(t){var r=null;return ht(t)?r=function(e,t,r){var n={sheetId:t,row:r.row,col:r.col,rowCount:1,colCount:1,refType:x.CELL};return new lt([n],!0,nn)}(t.cellId,t.sheetId,t):Et(t)?r=un(t):Rt(t)?r=vt(t)?function(e){var t=e.split(";"),r=[];return t.forEach((function(e){for(var t=e.split(","),n=0;n<t.length;n++){var a=t[n].trim(),o=Number(a);if(isNaN(o))if(a.startsWith('"')&&a.endsWith('"'))t[n]=a.slice(1,-1);else{if("TRUE"!==a&&"FALSE"!==a&&"true"!==a&&"false"!==a)throw new Error(Ut.value);t[n]="TRUE"===a.toUpperCase()}else t[n]=o}r.push(t)})),[r]}(t.start.slice(1,t.start.length-1)):function(e){var t,r,n=e.scope,a=n.row,o=n.col,i=n.rowCount,u=n.colCount,s=e.sheetIds,l=[];s.length>1&&(s=Kr.getExternalMethod().getSheetIdsAmongTwoSheets(s[0],s[s.length-1]),e.updateSheetIds(s));var c=a,f=o;return s.forEach((function(n){t=Kr.getExternalMethod().countRows(n),r=Kr.getExternalMethod().countCols(n),l.push({row:c,col:f,rowCount:void 0===i?t-c:Math.min(i,t-c),colCount:void 0===u?r-f:Math.min(u,r-f),sheetId:n,refType:e.cellRangeType})})),new lt(l,!1,an)}(t):Mt(t)?r=function(t){t.leftRange.setCalculateParentFunctionNode(t.calculateParentFunctionNode),t.rightRange.setCalculateParentFunctionNode(t.calculateParentFunctionNode);var r,n=e(t.leftRange),a=e(t.rightRange);return t.binaryType===D.INTERSECTION?r=function(e,t){if(!ft(e)||!ft(t))return Ut.null;var r=e.identities[0],n=t.identities[0],a=r,o=n;r.row>n.row&&(o=r,a=n);var i=r,u=n;if(r.col>n.col&&(u=r,i=n),o.row>=a.row+a.rowCount||u.col>=i.col+i.colCount)return Ut.null;var s=u.col,l=o.row,c=r;r.row+r.rowCount>n.row+n.rowCount&&(c=n);var f=r;r.col+r.colCount>n.col+n.colCount&&(f=n);var d=c.row+c.rowCount-o.row,h=f.col+f.colCount-u.col,m=1===d&&1===h,g=m?nn:function(e){return void 0===e&&(e={}),fn(e,this.identities[0])},p=[{sheetId:r.sheetId,row:l,col:s,rowCount:d,colCount:h,refType:x.NORMAL}];return new lt(p,m,g)}(n,a):t.binaryType===D.CONCAT&&(r=function(e,t){var r=[];return Array.prototype.push.apply(r,e.identities),Array.prototype.push.apply(r,t.identities),new lt(r,!1,an)}(n,a)),r}(t):Tt(t)&&(r=function(t){var r,n=t.originValueNode;switch(t.originValueNode instanceof nt&&(t.originValueNode.setCalculateParentFunctionNode(t.calculateParentFunctionNode),n=e(t.originValueNode)),t.variableType){case w.NUM:r=Qr(n);break;case w.PERCENTAGE:r=function(e){var t=Qr(e);return"number"!=typeof t||isNaN(t)?Ut.value:Vt(t*=.01,15)}(n);break;case w.MINUS:r=en(n);break;case w.STR:r=function(e){var t=e.slice(1,e.length-1),r=t.length-1,n=t;if(t.startsWith("(")&&t.endsWith(")")){var a=fr(t,1);a.isError||a.end!==r||(n=en(a.result))}return n}(n);break;case w.ORIGIN:r=n;break;case w.PLACEHOLDER:r="";break;case w.BINARY:case w.ERROR:r=n;break;case w.VARIABLE:r=function(e){if(e){var t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&Ut.name}return Ut.name}(n)}return r}(t)),t.setValue(r),r},cn=function(e,t,r){return new lt(e,t,r||an)},fn=function(e,t){void 0===e&&(e={});var r,n=t.sheetId,a=t.row,o=t.col,i=t.rowCount,u=t.colCount;if(1===i&&1===u){var s=rn(a,o,n);(r=t.refType===x.CELL?[s]:[[s]]).rangeCount=1,r.row=a,r.col=o,r.rowCount=i,r.colCount=u}else r=function(e,t,r,n,a,o){void 0===e&&(e={});var i,u=e.newLine,s=0,l=[];l.error=[];for(var c=r+a,f=n+o,d=r;d<c;d++)for(var h=n;h<f;h++)if(kt(i=rn(d,h,t))&&l.error.push(i),void 0!==u){var m=Math.floor(s/u);void 0===l[m]&&(l[m]=[]),l[m].push(i),s+=1}else l.push(i);return l}(e,n,a,o,i,u),r.rangeCount=1,r.row=a,r.col=o,r.rowCount=i,r.colCount=u;return r},dn={LEFT:!0,RIGHT:!0,MID:!0,SUMPRODUCT:!0,FIND:!0,SUBSTITUTE:!0,CONCATENATE:!0,CONCAT:!0,OFFSET:!0,FIXED:!0,REPT:!0,SMALL:!0,LARGE:!0,EOMONTH:!0,EDATE:!0,WEEKNUM:!0,DOLLAR:!0,"FLOOR.MATH":!0,"CEILING.MATH":!0,"FLOOR.PRECISE":!0,"CEILING.PRECISE":!0,BIN2OCT:!0,BIN2HEX:!0,OCT2BIN:!0,OCT2HEX:!0,HEX2BIN:!0,HEX2OCT:!0,DEC2BIN:!0,DEC2OCT:!0,DEC2HEX:!0,COMPLEX:!0,MODE:!0,"MODE.SNGL":!0,PERCENTRANK:!0,"PERCENTRANK.INC":!0,"PERCENTRANK.EXC":!0,ERF:!0,"WORKDAY.INTL":!0,RANDBETWEEN:!0};function hn(e){return e&&e.reduce?e.reduce((function(e,t){var r=Array.isArray(e),n=Array.isArray(t);return r&&n?(e=e.concat(),t=t.concat(),e.concat(t)):r?((e=e.concat()).push(t),e):n?(t=t.concat(),[e].concat(t)):[e,t]})):e}function mn(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function gn(){for(var e=yn.apply(null,arguments);!mn(e);)e=hn(e);return e}function pn(e){for(var t=e[0],r=[],n=t.length,a=t[0].length,o=0;o<a;o++)for(var i=0;i<n;i++)r.push(t[i][o]);return r}function vn(e){return Array.isArray(e)&&e.length>0?e=vn(e[0]):e}function yn(e){return(t=e)&&"object"==typeof t&&isFinite(t.length)&&t.length>=0&&t.length===Math.floor(t.length)&&t.length<4294967296?Array.prototype.slice.call(e,0):[e];var t}function Nn(e,t){var r=e+t,n=r.toString();if(n.length<15||n.replace(/[^\d]/g,"").length<15)return r;var a=new(Re())(e),o=new(Re())(t),i=a.plus(o).toPrecision(15).toString();return parseFloat(i)}function Mn(e){if(void 0===e||""===e)return Ut.value;if("boolean"==typeof e)return+e;if(!isNaN(e))return parseFloat(e);if(/^(\d+\/\d+\/\d+|\d+\/\d+\/\d+\s*?\d+:\d+:\d+)$/.test(e)){var t=new Date(e+" 00:00:00 +0800"),r=new Date("1970/1/1 00:00:00 +0800");return(t.getTime()-r.getTime())/864e5+25568}if(/^\d+\/\d+\/\d+ \d+:\d+:\d+$/.test(e)){var n=new Date(e+" +0800"),a=new Date("1970/1/1 00:00:00 +0800");return(n.getTime()-a.getTime())/864e5+25568}return Ut.value}var Rn=new Date("1970/01/01 00:00:00");function En(e,t){var r=(t=t||{}).baseYear||1900;if(!isNaN(e)){if(e instanceof Date)return new Date(e);var n=parseInt(e,10);return 1900===r&&(n-=25567),n<-25567?Ut.num:new Date(Rn.getTime()+864e5*(n-1))}return"string"!=typeof e||(e=e.replace(/[年-]/,"/").replace(/[月-]/,"/").replace(/[日-]/,""),e=new Date(e),isNaN(e))?Ut.value:e}function _n(){for(var e=arguments.length;e--;)if(kt(arguments[e]))return!0;return!1}function Tn(e,t){var r=typeof e,n=typeof t;return r===n?"string"===r?Sn(e,t):e===t?0:e>t?1:-1:"boolean"===r||"string"===r&&"number"===n||null===t?1:-1}function Sn(e,t){if((e=e.toLowerCase())===(t=t.toLowerCase()))return 0;if(0===e.length||0===t.length)return e>t?1:-1;var r=In(e[0]),n=In(t[0]);if(1==(r^n))return r?-1:1;if(r&&n){var a=e.split("").reduce((function(e,t,r){return e.length!==r||In(t)&&(e=""+e+t),e}),""),o=t.split("").reduce((function(e,t,r){return e.length!==r||In(t)&&(e=""+e+t),e}),"");return a.length===e.length&&o.length===t.length?e>t?1:-1:a.length!==o.length?a>o?1:-1:a===o?Sn(e.replace(a,""),t.replace(o,"")):a>o?1:-1}var i=et.getPinyin(e),u=et.getPinyin(t);if("a".localeCompare("z")==="z".localeCompare("a"))return String(i)>String(u)?1:-1;var s=String(i).localeCompare(String(u));return 0===s?e>t?1:-1:s/Math.abs(s)}function In(e){var t=e.charCodeAt(0);if(!function(e){return e<=127}(t))return!1;var r=32|t;return r>=97&&r<=122}function Cn(e){return"boolean"==typeof e&&(e=e?1:0),e}function An(e,t){return!ht(t)&&"string"==typeof e&&""===e.trim()}function wn(e,t){var r="";return"string"==typeof e&&!vt(t)&&(ht(t)||Rt(t)||Mt(t))&&(r=e.toLowerCase()),"true"===r||"false"===r}function xn(e,t,r){return wn(e,t)?(e=e.toLowerCase(),r?"true"===e?1:0:"true"===e):e}function Dn(e,t,r){if(void 0===r&&(r=!1),"number"==typeof e)return e;if(!r&&An(e,t))throw new Error(Ut.value);return"string"==typeof(e=xn(e,t,!0))&&(e=(e=wr(e)).numericValue),e}var bn=p(8422),On=p(6593),Fn="number",Ln="string",Un="boolean",Bn=null,kn=Math.abs;Math.pow;var Pn=function(e){this.array=e};function Hn(e,t){return typeof e===Fn||e instanceof Date||!t&&(typeof e===Un||!isNaN(e)&&!isNaN(parseFloat(e)))}function Gn(e){return kt(e)}function Yn(e){return isNaN(e)||!isFinite(e)}function Vn(e){var t=$n(e);if(kn(t)<1e21)return parseInt(t,10);throw new Error(Ut.value)}function $n(e){var t={value:0};if(Zn(e,t))return t.value;throw new Error(Ut.value)}var jn={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};function Zn(e,t){var r=Bn;if(!e)return t.value=0,!0;var n=typeof e;try{if(n===Fn)r=e;else if(n===Ln){if(0===(e=e.trim()).length)return t.value=0,!0;var a=".",o=!1;if("%"===e.charAt(e.length-1)&&(o=!0,e=e.substr(0,e.length-1)),"$"===e[0])return!1;if(e.indexOf(a)!==e.lastIndexOf(a))return!1;if(e.length>=2&&"0"===e[0]&&"x"===e[1])return!1;if(Yn(r=Number(e).valueOf())){var i=e.charCodeAt(0);if(i|=32,e.length>4&&i>=96&&i<=122){var u=e[0]+e[1]+e[2];if(u=u.toUpperCase(),!jn[u])return!1}if("/"===e[0]||"/"===e[e.length-1])return!1;if(e.indexOf('"')>-1||e.indexOf("'")>-1)return!1;var s=Ar(e);if(void 0===s)return!1;r=Yn((r=new Date(e.replace(/-/g,"/"))).valueOf())?s.numericValue:bn.Z._toOADate(r)}o&&(r/=100)}else if(n===Un)r=e?1:0;else{if(!(e instanceof Date))return!1;r=bn.Z._toOADate(e)}}catch(e){return!1}return t.value=r,!0}function Wn(e,t){try{if(e)if(typeof e===Un);else if(e instanceof Date)e=0!==bn.Z._toOADate(e);else{if(!Hn(e))return!1;e=0!==e}else e=!1}catch(e){return!1}return t.value=e,!0}function Xn(e){try{if(void 0===e||e===Bn)return"";if(typeof e===Un)return e?"TRUE":"FALSE";if(typeof e===Ln)return e;if(e instanceof Date)return bn.Z._toOADate(e).toString();if(function(e){return e instanceof Pn}(e))throw new Error(Ut.value);return e.toString()}catch(e){throw new Error(Ut.value)}}function Kn(e){return Yn(e)?Ut.num:e}function qn(e){var t={value:Bn};if(Jn(e,t))return t.value;throw new Error(Ut.value)}function zn(e){var t;if(e&&e.length&&!Array.isArray(e[0])&&e.rowCount&&e.colCount)return e.error=e.error||[],e;if(ft(e))(t=e.toArray()).isReference=!0;else if(Array.isArray(e)&&e.length>0){(t=[]).error=[];for(var r=e[0],n=0,a=!0,o=0;o<r.length;o++)for(var i=0;i<r[o].length;i++){for(var u=0;u<e.length;u++){a&&(n+=e[u][o].length);var s=e[u][o][i];t.error&&t.error.length>0||!kt(s)||(t.error=[s]),t.push(s)}a=!1}t.isArray=!0,t.rowCount=e[0].length,t.colCount=n,t.rangeCount=1}else(t=[]).error=[],t.push(e),t.rowCount=1,t.colCount=1,t.rangeCount=1;return t}function Jn(e,t){if(e)if(e instanceof Date)t.value=new Date(e);else if(typeof e===Ln){var r=bn.Z._parseLocale(e);if(!r)if(isNaN(e)){if(r=new Date(e),isNaN(r.valueOf()))return!1;try{var n=On.Z._trimEnd(On.Z._trimStart(e.replace(/ |\n/g,"")," ")," "),a=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(n);if(a&&4===a.length&&(-1===a.indexOf(r.getYear().toString())||-1===a.indexOf(r.getMonth().toString())||-1===a.indexOf(r.getDate().toString())))return!1}catch(e){return!1}}else if(!(r=bn.Z._fromOADate(parseFloat(e))))return!1;t.value=r}else{if(typeof e!==Fn)return!1;t.value=bn.Z._fromOADate(e)}else t.value=bn.Z._fromOADate(0);return!0}var Qn={},ea=p(7686),ta=p(8657),ra=p(9678),na=p(8751),aa=ea.Z._isNullOrUndefined,oa=ra.Z._getLength,ia=isNaN,ua=Math.abs,sa=Math.exp,la=Math.log,ca=Math.pow,fa=179769e303;function da(e,t){var r=16777216;return e===t||ua(e-t)<ua(e)/(r*r)}function ha(e,t,r){var n;return!(2!==e&&4!==e&&"string"==typeof t&&"string"==typeof r&&!isNaN(r)&&!r.match(/^(0x|0b|0o)/i))&&(0===e?n=t<=r:1===e?n=t>=r:2===e?n=t!==r:3===e?n=t<r:4===e?n=t===r:5===e&&(n=t>r),n)}function ma(e,t,r){void 0===r&&(r=!1);var n=-1,a=!0,o={value:0},i=na.Z._getWildcardCriteriaFullMatch(t,!1,!1,r),u=!1;if(4===e&&(u=!0),aa(t))a=!1,n=null;else if(""===t)a=!1,n="";else if(i){a=!1;var s=function(e){var t=na.Z._getRegWithConditions(i,"gim");return t.lastIndex=0,t.test(e)}}else Zn(t.toString(),o)?n=o.value:a=!1;return function(r){if(kt(r))return!1;var o={value:0};if(null===r&&4===e&&""===t)return!0;if(null===r&&2!==e)return!1;if(a&&""!==r&&Zn(r,o))return ha(e,o.value,n);if(i&&Hn(r,!0))return!1;if(s&&!u){var l=s(r.toString()),c=r.toString().toUpperCase(),f=c;return l||(f=aa(t)?"":t.toString().toUpperCase()),ha(e,c,f)}var d=aa(t)?null:t.toString().toUpperCase(),h=aa(r)?null:r.toString();return i&&u?s(h):ha(e,null===h?h:h.toUpperCase(),d)}}var ga={},pa={_approxFloor:function(e){var t=Math.floor(e);return da(e,t+1)?t+1:t},_parseCriteria:function(e,t){void 0===t&&(t=!1);var r=e;ft(r)&&(r=zn(r));var n=ga;n||(ga=n={});var a=n[r];if(a&&!t)return a;if(Hn(r))return n[r]=ma(4,r);var o,i,u=aa(r)?"":r.toString().toUpperCase(),s="\0";for(o=0;o<2&&o<oa(u);o++){if(i=u[o],-1==="=><".indexOf(i)){if("<"===s)return n[r]=a=ma(3,u.substring(1)),a;if(">"===s)return n[r]=a=ma(5,u.substring(1)),a;break}if("="===i)return a="<"===s?ma(0,u.substring(2)):">"===s?ma(1,u.substring(2)):ma(4,"\0"===s?u.substring(1):r),n[r]=a,a;if("\0"===s)s=i;else{if("<"===s)return a=">"===i?ma(2,u.length>2?u.substring(2):null):ma(3,u.substring(1)),n[r]=a,a;if(">"===s)return n[r]=a=ma(5,u.substring(1)),a}}return n[r]=a=ma(4,r,t),a},_pow10:function(e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][e];return aa(t)?ca(10,parseFloat(e)):t},_approxCeiling:function(e){var t=Math.ceil(e);return da(e,t-1)?t-1:t},_round:function(e,t){var r=pa._pow10(ua(t));return e=(e=t<0?e/r:e*r)<0?pa._approxCeiling(e-.5):pa._approxFloor(e+.5),Kn(e=t<0?e*r:e/r)},_combin:function(e,t){if(e<0||t<0||e<t)return CalcErrorsNumber;var r,n=1;for(t=Math.min(e-t,t),r=1;r<=t;r++)n*=e-r+1,n/=r;return Kn(n)},_pow1p:function(e,t){var r=ua(e)>.5?ca(1+e,t):sa(t*la(1+e));return isFinite(r)?ia(r)&&(r=5e-324):r===Number.POSITIVE_INFINITY?r=fa:r===Number.NEGATIVE_INFINITY&&(r=-fa),r},_sinhCosh:function(e,t){return(sa(e)+(t?-1:1)*sa(-e))/2},_log:function(e,t){return ia(e)?e:ia(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?la(e)/la(t):NaN}},va=pa,ya=bn.Z._toOADate,Na=ra.Z._getLength,Ma=ea.Z._inArray,Ra=(ea.Z._isNullOrUndefined,isNaN,parseInt),Ea=Math.abs,_a=(Math.exp,Math.log,Math.pow,Math.floor,Ut.value,Ut.num),Ta=(Ut.div0,Ut.na),Sa=Ut.null,Ia=Vn,Ca=$n,Aa={};function wa(e){return e%400==0||e%4==0&&e%100!=0}function xa(e,t){switch(t){case 0:case 2:case 4:return 360;case 1:return wa(e.getFullYear())?366:365;case 3:return 365;default:return-1}}function Da(e,t){return e-t}function ba(e,t){return Ma(t,[0,2,4,6,7,9,11])>=0?31:Ma(t,[3,5,8,10])>=0?30:1===t?wa(e)?29:28:void 0}function Oa(e,t,r,n){var a=r.getFullYear(),o=r.getMonth(),i=r.getDate(),u=n.getFullYear(),s=n.getMonth(),l=n.getDate();if(e){var c=1===o&&ba(a,o)===i,f=1===s&&ba(u,s)===l;t?(c&&f&&(l=30),c&&(i=30),31===i&&(i=30),30===i&&31===l&&(l=30),31===l&&(l=30)):(31===i&&(i=30),31===l&&(l=30))}return 360*(u-a)+30*(s-o)+l-i}function Fa(e,t,r){var n=1;if(Da(e,t)>0){var a=e;e=t,t=a,n=-1}return Ma(r,[1,2,3])>=0?n*Ia(ya(t)-ya(e)):Ma(r,[4,5])>=0?n*Oa(!0,!1,e,t):n*Oa(!0,!0,e,t)}function La(e){var t,r=[];for(t=0;t<Na(e);t++)Ua(e[t],r);return r}function Ua(e,t){for(var r=0;r<Na(e);r++){var n=e[r];n!==Qn&&t.push(n)}!function(e){e.sort((function(e,t){return e-t}))}(t)}function Ba(e,t,r){var n=[];Ua(t,n);var a=Na(n);return r<=0||a<r?_a:e?n[a-r]:n[r-1]}function ka(e,t,r){this._real=e,this._imag=t,this._suffix=r||"i"}function Pa(e,t){return e.charAt(t)}function Ha(e,t){for(var r=e.length,n=!1;t<r&&!isNaN(Pa(e,t));)t++,n=!0;for(t<r&&"."===Pa(e,t)&&t++;t<r&&!isNaN(Pa(e,t));)t++,n=!0;if(t<r&&("E"===Pa(e,t)||"e"===Pa(e,t)))for(n=!1,++t<r&&("+"===Pa(e,t)||"-"===Pa(e,t))&&t++;t<r&&!isNaN(Pa(e,t));)t++,n=!0;return{_digitFlag:n,_index:t}}function Ga(e){try{return e?"number"==typeof e?new ka(parseFloat(e),0):"string"==typeof e?function(e){var t,r,n,a=0,o=0,i=!1,u=0,s=0,l=0,c=e.length;if(!e)throw ta.wI.Exp_ArgumentNull;if(0===c)throw ta.wI.Exp_Format;l<c&&("+"===Pa(e,l)||"-"===Pa(e,l))&&l++;var f=Ha(e,l);if(l=f._index,t=f._digitFlag,l<c&&("+"===Pa(e,l)||"-"===Pa(e,l))?(u=l,l=(f=Ha(e,++l))._index,r=f._digitFlag,l<c&&("i"===Pa(e,l)||"j"===Pa(e,l))&&(n=Pa(e,l),l++,i=!0),s=l-u):l<c&&("i"===Pa(e,l)||"j"===Pa(e,l))?(n=Pa(e,l),s=++l,r=t,i=!0,t=!1):u=l,l<c)throw ta.wI.Exp_Format;if(u>0){if(!t)throw ta.wI.Exp_Format;a=parseInt(e.substr(0,u),10)}if(s>0){if(!i)throw ta.wI.Exp_Format;if(1===s||2===s&&"+"===Pa(e,u))o=1;else if(2===s&&"-"===Pa(e,u))o=-1;else{if(!r)throw ta.wI.Exp_Format;o=parseInt(e.substr(u,s-1),10)}}return new ka(a,o,n)}(e):null:new ka(0,0)}catch(e){return null}}Aa._MAX_DOUBLE_VALUE=179769e303,Aa._isBoolean=function(e){return"boolean"==typeof e},Aa._isString=function(e){return"string"==typeof e},Aa._isNumber=function(e){return"number"==typeof e},Aa._isLeapYear=wa,Aa._annualYearBasis=xa,Aa._compareDateTime=Da,Aa._getDaysInMonth=ba,Aa._daysBetweenBasis=Fa,Aa._st_normsdist=function(e){var t,r,n;return r=0===e?0:(n=.5*Ea(e))>=3?1:n<1?((((((((.000124818987*(t=n*n)-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*n*2:(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524,e>0?.5*(r+1):.5*(1-r)},Aa._st_includeAggregateMulti=function(e,t){var r=13===t,n=14===t,a=15===t;return 12===t?function(){var e=La(arguments[0]),t=Na(e);return 0===t?_a:t%2==0?(Ca(e[t/2-1])+Ca(e[t/2]))/2:e[Ra((t/2).toString())]}(e):r?function(){var e,t,r,n=null,a=0,o=arguments[0],i=Na(o);for(e=0;e<i;e++){for(r=0,t=0;t<i;t++)t!==e&&o[t]===o[e]&&r++;r>a&&(a=r,n=o[e])}return 0===a?Ta:n}(e):n?Ba(!0,e[0],e[1]):a?function(e,t){return Ba(!1,e,t)}(e[0],e[1]):Sa},Aa._fact=function(e){var t,r=1;for(t=e;t>1;t--)r*=t;return r},Aa._days360=function(e,t,r){var n=e.getDate(),a=t.getDate(),o=e.getMonth(),i=t.getMonth(),u=e.getFullYear(),s=t.getFullYear();return n=31===n?30:n,r?a=31===a?30:a:31===a&&(n<30?(a=1,++i>12&&(i=1,s++)):a=30),30*(12*(s-u)+i-o)+a-n},Aa._yearfrac=function(e,t,r){return r<0||r>4?_a:function(e,t,r){var n,a=Fa(e,t,r);if(a<0){a=-a;var o=e;e=t,t=o}if(1===r){var i,u,s,l,c=e.getFullYear(),f=t.getFullYear();(i=new Date(e.valueOf())).setFullYear(i.getFullYear()+1),Da(t,i)>0?(l=f+1-c,i=new Date(c,0,1),u=new Date(f+1,0,1),s=Ia(ya(u)-ya(i))-365*(f+1-c)):(l=1,s=wa(c)&&e.getMonth()<3||wa(f)&&256*t.getMonth()+t.getDate()>=541?1:0),n=365+Ca(s)/Ca(l)}else n=xa(new Date,r);return a/n}(e,t,r)},ka.prototype={_getReal:function(){return this._real},_getImag:function(){return this._imag},_getSuffix:function(){return this._suffix},_toString:function(e){e=e||this._suffix||"i";var t=this._real,r=this._imag,n="";return 0===t&&0!==r||(n+=t.toString()),-1===r?n+="-":0!==t&&r>0&&(n+="+"),-1!==r&&0!==r&&1!==r&&(n+=r.toString()),0!==r&&(n+=e),n}},Aa._Complex=ka,Aa._convertToComplex=Ga,Aa.convertArgToComplex=function(e,t){void 0===t&&(t=!1);var r=Ga(e);return r=!r||t&&0===r._getReal()&&0===r._getImag()?Ut.num:{_real:r._getReal(),_imag:r._getImag(),_suffix:r._getSuffix()}};var Ya,Va,$a,ja,Za,Wa,Xa=Aa,Ka=null,qa=ea.Z._isNullOrUndefined,za=Xa._isBoolean,Ja=Xa._isString,Qa=bn.Z._parseInvariant,eo=ra.Z,to=eo._getLength,ro=eo._getLength,no=na.Z,ao=no._getWildcardCriteriaFullMatch,oo=no._getRegIgnoreCase;function io(e,t,r){void 0===r&&(r=1);var n=!1;if(ft(r)){var a=et._element,o=et._instance,i=a.row,u=a.col;r=o.custom.getValueByTopCellPosition(r,i,u),n=!0}if("number"!=typeof r)throw n?new Error(Ut.ref):new Error(Ut.value);function s(e,t){var r,n=ro(e);for(r=1;r<n;r++)if(2===fo(e[r-1],e[r],!1)&&!t)return!1;return!0}var l=zn(e),c=zn(t);if(!c.isArray&&!c.isReference)return Ut.na;var f=c.colCount,d=c.rowCount,h=-1;return f>1&&d>1||1===r&&!s(c,!0)||-1===r&&!s(c,!1)?Ut.na:(1===r?h=mo(l,c,1,d>1):0===r?h=go(l,c,0,d>1):-1===r&&(h=mo(l,c,-1,d>1)),-1===h?Ut.na:h+1)}function uo(e,t,r,n,a){if(e<0||t<0||t<e||r<e||r>t)return-1;if(a)return Ya=e,Va=t,ja=r,Za=n,Wa=n,$a=r;if(Za){if(++$a>Va){if(Za!==Wa)return-1;$a=ja-1,Za=!1}}else if(--$a<Ya){if(Za!==Wa)return-1;$a=ja+1,Za=!0}return $a}function so(e,t){return!(qa(t)||!((qa(e)||Hn(e,!0))&&Hn(t,!0)||za(e)&&za(t))&&(!Ja(e)||!Ja(t)))}function lo(e,t,r){if(qa(e))return Ka;if(e.isArray||e.isReference){var n=e.colCount;if(t>n){var a=t;t=r,r=a}return e[r*n+t]}return e[0]}function co(e,t,r){var n=Qa(e),a=r;return n===t?a=0:n>t?a=1:n<t&&(a=2),a}function fo(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),e===t)return 0;if(Ja(e)){if(!t&&0===to(e.toString()))return 0;if(Hn(t)&&!Hn(e))return 1;if(za(t))return 2;if(Ja(t)){if(!n&&(escape(e).indexOf("%u")>=0||escape(t).indexOf("%u")>=0))var a=Sn(e,t);else a=r?e.toString().localeCompare(t.toString()):e.toLowerCase().localeCompare(t.toLowerCase());return 0===a?0:a>0?1:2}return t instanceof Date?co(e,t,1):-1}if(Ja(t))return e||0!==to(t.toString())?Hn(e)?2:za(e)?1:e instanceof Date?co(e,t,2):-1:0;if(za(e)&&Hn(t))return 1;if(za(t)&&Hn(e))return 2;var o=$n(e),i=$n(t);return o===i?0:o<i?2:1}function ho(e,t,r){var n=lo(e,t,r);return qa(n)?0:n}function mo(e,t,r,n,a){void 0===a&&(a=!1);var o,i=-1,u=0,s=-1,l=-1;if(o=n?t.rowCount:t.colCount,--o<u)return-1;for(;u<=o;){var c,f=Ka,d=e[0];for(r>=1!=(2===i)&&(s=l),c=l=uo(u,o,l=Vn((u+o)/2),r>=0,!0);!so(d,f)&&-1!==l&&!so(d,f=n?lo(t,0,l):lo(t,l,0));)l=uo(0,0,0,!1,!1),r>=0&&l<c?o=l:r<0&&l>c&&(u=l);if(-1===l&&r>=1!=(2===i))return s;if(-1===l)return-1;if(i=fo(d,f,!1,a),r>=1&&1===i)u=l+1;else if(r>=1&&2===i)o=l-1;else if(r<=-1&&1===i)o=l-1;else if(r<=-1&&2===i)u=l+1;else if(0===i){for(;r<=-1&&l>u||r>=0&&l<o;){var h;if(h=r>=0?l+1:l-1,null===(f=n?ho(t,0,h):ho(t,h,0)))return-1;if(!so(d,f))break;if(0!==(i=fo(d,f,!1,a)))break;l=h}return l}}return r>=1!=(2===i)?l:s}function go(e,t,r,n,a){void 0===a&&(a=!1);var o,i,u,s,l,c=Ka,f=-1,d=e[0],h=Ja(d),m=ao(d);for(i=n?t.rowCount:t.colCount,h&&m&&(s=oo(m)),u=0;u<i;u++)if(so(d,l=n?lo(t,0,u):lo(t,u,0))){var g=Ja(l);if(h&&g&&m?(s.lastIndex=0,o=s.test(l)?0:1):o=fo(d,l,!1,a),r>=1&&1===o)o=-1,f>=0&&(o=fo(l,c,!1,a)),(f<0||f>=0&&1===o)&&(f=u,c=l);else if(r<=-1&&2===o)o=-1,f>=0&&(o=fo(l,c,!1,a)),(f<0||f>=0&&2===o)&&(f=u,c=l);else if(0===o)return u}return f}function po(e,t,r,n,a){var o=n?mo(e,t,1,a,!0):go(e,t,0,a,!0);return o>=0?a?ho(r,0,o):ho(r,o,0):Ut.na}function vo(e,t,r,n,a){var o=t.identities[0],i=o.row,u=o.col,s=o.rowCount,l=o.colCount,c=o.sheetId;if(a&&r>l||!a&&r>s)return Ut.ref;var f={row:i,col:u,rowCount:a?s:1,colCount:a?1:l,sheetId:c,refType:x.NORMAL},d={row:a?i:i+r-1,col:a?u+r-1:u,rowCount:a?s:1,colCount:a?1:l,sheetId:c,refType:x.NORMAL},h=f.row+"_"+f.col+"_"+f.rowCount+"_"+f.colCount+"_"+f.sheetId,m=et.getLookupCache(h);if(m&&!na.Z._getReg("[~?*]+").test(e[0])){var g=e[0];null===g&&(g=0);var p=m.get(g);if(p>=0){var v=et._instance.helper.cellRangeCalcFuncByRefList([d]);return v.isReference=!0,a?ho(v,0,p):ho(v,p,0)}}var y=et._instance.helper.cellRangeCalcFuncByRefList([f]);y.isReference=!0;var N=et._instance.helper.cellRangeCalcFuncByRefList([d]);if(N.isReference=!0,!m){var M=new Map;y.forEach((function(e,t){M.has(e)||M.set(e,t)})),et.setLookupCache(h,M)}return po(e,y,N,n,a)}function yo(e,t,r,n){if(void 0===n&&(n=!0),e=zn(e),r=(r=zn(r))&&r[0],n=(n=zn(n))&&n[0],ft(t))return vo(e,t,r,n,!0);var a=t=zn(t),o=a.colCount,i=a.rowCount;if(r>o)return Ut.ref;for(var u=[],s=[],l=0;l<i;l++)u.push([t[l*o]]),s.push([t[l*o+r-1]]);return po(e,zn([u]),zn([s]),n,!0)}function No(e,t,r,n){if(e=zn(e),r=(r=zn(r))&&r[0],n=(n=zn(n))&&n[0],ft(t))return vo(e,t,r,n,!1);var a=t=zn(t),o=a.colCount;if(r>a.rowCount)return Ut.ref;var i=[t.slice(0,o)],u=[t.slice((r-1)*o,r*o)];return po(e,zn([i]),zn([u]),n,!1)}function Mo(e,t,r){if("object"!=typeof t)return Ut.value;if(!0===t.isCell)return Ut.value;e=zn(e);var n=[];if(t=zn(t))for(var a=0;a<t.length;a++)n.push(t[a]);t.colCount<=t.rowCount?(n.colCount=t.colCount,n.rowCount=Math.ceil(n.length/n.colCount)):(n.rowCount=t.rowCount,n.colCount=Math.ceil(n.length/n.rowCount)),qa(t.isReference)||(n.isReference=t.isReference),qa(t.isArray)||(n.isArray=t.isArray),n.rangeCount=t.rangeCount;var o,i,u=n.colCount,s=n.rowCount,l=e;if(void 0===r){var c=u>s?No(l,n,s,!0):yo(l,n,u,!0);return kt(c)?Ut.na:c}if(i=zn(r)){if(i.colCount>1&&i.rowCount>1)return Ut.na}else i=n;return(o=mo(l,n,1,!(u>s)))>=0?(u=i.colCount)>(s=i.rowCount)?ho(i,o,s-1):ho(i,u-1,o):Ut.na}var Ro=va._approxFloor,Eo=ea.Z._isNullOrUndefined,_o={};function To(e){if(e&&e[0]&&e[0].length>1||e&&e[0]&&e[0].length>0&&e[0][0].length>1)return!0;var t=!1;return kt(e=vn(e))&&(t=!0),!!(t=t||"number"==typeof e&&(isNaN(e)||!isFinite(e)))&&e!==Ut.na}function So(e){if(e&&e[0]&&e[0].length>1||e&&e[0]&&e[0].length>0&&e[0][0].length>1)return!0;var t=!1;return kt(e=vn(e))&&(t=!0),t||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function Io(e){var t=et._instance,r=e.getRow(0),n=e.getColumn(0),a=e.getSheetId(0),o=t.custom.cellEditValue(r,n,a);return!!(0,vr.jr)(o)}function Co(e){return!0===e||!1===e}function Ao(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!((t=gn(t)).length>1)&&vn(t)===Ut.na}function wo(e){var t=gn(e);if(t.length>1&&!e.__isUserWrite)return!1;var r=t[0];return!(""===r||null==r||"boolean"==typeof r||So(r)||"number"!=typeof r||(r=Number(r),"number"!=typeof r||isNaN(r)||!isFinite(r)))}function xo(e){return ft(e)}function Do(e){return"string"==typeof e}function bo(){return Ut.na}function Oo(e){return wo(e)?1:Do(e)?2:Co(e)?4:So(e)?16:Array.isArray(e)?64:void 0}function Fo(e){return""===e||Eo(e)}function Lo(e){return"number"!=typeof(e=Dn(e,et._astNodes[0],!1))&&""!==e?Ut.value:Ro(Math.abs(e))%2!=0}function Uo(e){return"number"!=typeof(e=Dn(e,et._astNodes[0],!1))&&""!==e?Ut.value:Ro(Math.abs(e))%2==0}function Bo(e){return Array.isArray(e)&&(e=(e=gn(e))[0]),Hn(e,!0)?$n(e):(e=xn(e,et._astNodes[0]),Xa._isBoolean(e)?e?1:0:Gn(e)?e:0)}_o.TYPE=function(e){switch(e){case Ut.null:return 1;case Ut.div0:return 2;case Ut.value:return 3;case Ut.ref:return 4;case Ut.name:return 5;case Ut.num:return 6;case Ut.na:return 7;case Ut.data:return 8}throw new Error(Ut.na)};var ko=bn.Z,Po=ko._parseLocale,Ho=ko._toOADate,Go=ra.Z._getLength,Yo=ea.Z._inArray,Vo=void 0,$o=kt,jo=Vn,Zo=new Date("1970/01/01 00:00:00"),Wo=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];function Xo(e,t,r){if(_n(e,t,r)||!(0,Se.kE)(e)||!(0,Se.kE)(t)||!(0,Se.kE)(r))throw new Error(Ut.value);if((e=Mn(e))<0||e>=1e4)throw new Error(Ut.num);var n;return e<=1899&&e>=0&&(e=1900+e),(t=Mn(t))>12?(e+=parseInt(t/12),t%=12):t<1&&(e=e-parseInt(Math.abs(t/12))-1,t=12-Math.abs(t%12)),r=Mn(r),n=new Date(e+"/"+t+"/"+r).getTime()<0?Date.parse(parseInt(e,10)+"/"+parseInt(t,10)+"/1 00:00:00"):Date.parse(parseInt(e,10)+"/"+parseInt(t,10)+"/1 08:00:00"),parseInt((n-Zo)/864e5,10)+r+25567}function Ko(e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(e)){if(e.length>1)throw new Error(Ut.value);if(e[0]&&e[0].length>1)throw new Error(Ut.value);e=vn(e)}if(/\d{4},\d{1,2},\d{1,2}/.test(e))throw new Error(Ut.value);if(wo(e)&&(e=Number(e))>2958465)throw new Error(Ut.num);"string"==typeof e&&(e=e.replace(/-/g,"/"));var t=En(e||0);return t instanceof Date?1899===t.getFullYear()?0:t.getDate():t}function qo(e){if(Array.isArray(e)){if(e.length>1)throw new Error(Ut.value);e[0]&&e[0].length>1&&(e=e[0]),e=vn(e)}if(/\d{4},\d{1,2},\d{1,2}/.test(e))throw new Error(Ut.value);return(e=En(e||0))instanceof Date?1899===e.getFullYear()?1:e.getMonth()+1:e}function zo(e,t,r,n,a,o){var i={value:void 0};if(!Jn(t,i))throw new Error(Ut.value);if(t=i.value,!Jn(r,i={value:void 0}))throw new Error(Ut.value);r=i.value;var u=Vn(Ho(t)),s=Vn(Ho(r)),l=!1;if(u>s){var c=t;t=r,r=c;var f=u;u=s,s=f,l=!0}var d=s-u+1;return d=o(t,r,d,n),e&&kt(d)?d:d<=0?0:(d=function(e,t,r,n,a,o){var i,u;if(o&&kt(u=si(e=e!==Vo?e:"0000011")))return u;if(t!==Vo&&(i=zn(t)),!i)return a;if(i.isError)return i[0];var s,l=Go(i),c=[];for(s=0;s<l;s++){var f=i[s],d=bn.Z._fromOADate(f),h=d.getDay(),m=Go(u)?u[ri(d,3)]:6===h||0===h;-1===c.indexOf(f)&&!m&&f>=r&&f<=n&&c.push(f)}return a-Go(c)}(n,a,u,s,d,e),d=l?-d:d)}function Jo(e,t,r,n){var a,o=si(n=n!==Vo?n:"0000011"),i=0,u=0;if($o(o))return o;for(a=0;a<Go(o);a++)1===o[a]&&i++;if(r<30){for(a=0;a<r;a++)o[(jo(ri(e,3))+a)%7]&&u++;return r-u}var s=r,l=0,c=0;for(a=0;a<s&&jo(ri(e,3)+a)%7!=0;a++)l++;for(a=0;a<l;a++)o[(jo(ri(e,3))+a)%7]&&u++;for(a=0;a<s&&(jo(ri(t,3))+7-a)%7!=6;a++)c++;for(a=0;a<c;a++)o[(jo(ri(t,3))+7-a)%7]&&u++;return(r-=jo((s=s-l-c)/7)*i)-u}var Qo={};function ei(){var e,t=new Date;e=t.getFullYear(),e+="/",e+=t.getMonth()+1,e+="/",e+=t.getDate(),e+=" ",e+=t.getHours(),e+=":",e+=t.getMinutes(),e+=":",e+=t.getSeconds();var r=(Date.parse(e)-Zo)/864e5;return Number((r+25568).toFixed(4))}function ti(){var e=new Date;return parseInt((Date.parse(e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" 00:00:00")-Zo)/864e5,10)+25568}function ri(e,t){if(void 0===t&&(t=1),!wo(t))throw new Error(Ut.value);if([1,2,3,11,12,13,14,15,16,17].indexOf(t)<0)throw new Error(Ut.num);if(function(e){if(function(e){return!("string"!=typeof e||!/1900(?:-|\/)0?2(?:-|\/)29/.test(e))||60===parseInt(e)}(e))return!0;var t=En(e);t instanceof Date&&1900===t.getFullYear()&&t.getMonth()}(e=vn(e)),e=En(e),0===Number(t))throw new Error(Ut.num);if(!(e instanceof Date))return e;if(1899===e.getFullYear())return 7;var r=e.getDay();return isNaN(r)&&(r=6),Wo[t][r]}function ni(e){if(Array.isArray(e)){if(e.length>1)throw new Error(Ut.value);if(e[0]&&e[0].length>1)throw new Error(Ut.value);e=vn(e)}if(/\d{4},\d{1,2},\d{1,2}/.test(e))throw new Error(Ut.value);return(e=En(e||0))instanceof Date?Math.max(e.getFullYear(),1900):e}function ai(e){return 1===new Date(e,1,29).getMonth()}function oi(e){var t,r=new Date;return"string"!=typeof e?e:(t=e.match(/^(\d*)年(\d*)月(\d*)日$/))?t[1]+"/"+t[2]+"/"+t[3]:(t=e.match(/^(\d*)年(\d*)月$/))?t[1]+"/"+t[2]+"/1":(t=e.match(/^(\d*)月(\d*)日$/))||(t=e.match(/^(\d*)[-/](\d*)$/))?r.getFullYear()+"/"+t[1]+"/"+t[2]:e}function ii(e){if(""===(e=Dn(e,et._astNodes[0])))return Ut.value;var t=qn(e);return(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())/86400}function ui(e,t){var r=e.getDay();switch(t){case 1:return r+1;case 2:return 0===r?7:r;case 3:return 0===r?6:r-1;default:return Ut.num}}function si(e){if(Xa._isString(e)){if(7!==Go(e)||isNaN(parseInt(e)))return Ut.value}else if(!isNaN(e)){if(Math.floor(e)<1||Math.floor(e)>17)return Ut.num;e=e.toString()}var t,r=["1","2","3","4","5","6","7"],n=[0,0,0,0,0,0,0];switch(Go(e)){case 1:if(Yo(e,r)>=0){n[((t=parseInt(e))+4)%7]=1,n[(t+5)%7]=1;break}return Ut.num;case 2:if("1"===e[0]&&Yo(e[1],r)>=0){n[((t=parseInt(e[1]))+5)%7]=1;break}return Ut.num;case 7:for(t=0;t<7;t++)n[t]=parseInt(e[t]);break;default:return Ut.value}return n}function li(e,t,r,n,a){void 0===n&&(n=[]),t=qn(t=Vn(t)),r=Vn(r);var o=ui(t,3);if(Gn(o))return o;for(var i=Vn(o);r<0;++r)t.setDate(t.getDate()-1),i=0===i?6:--i,(e&&(5===i||6===i)||!e&&a[i]||n.indexOf(Ho(t))>=0)&&r--;for(;r>0;--r)t.setDate(t.getDate()+1),i=6===i?0:++i,(e&&(5===i||6===i)||!e&&a[i]||n.indexOf(Ho(t))>=0)&&r++;return t.getFullYear()<1900?Ut.num:Ho(t)}function ci(e,t){e=Array.isArray(e)?gn(e):[e];for(var r=vt(t),n=0,a=e.length;n<a;n++){var o=e[n];if(r&&""===o)return Ut.value;"number"!=typeof o&&(o=qn(oi(o)),e[n]=Ho(o))}return e}Qo.ORIGIN=function(e,t,r){return zo(!1,e,t,void 0,r,(function(e,t,r){var n=Vn(Ho(t)-Ho(e))%7,a=Vn(ri(e,2)+n),o=0===e.getDay()?1:2;return(r-=n=(n=a>5?a-5:0)>o?o:n)-2*Math.floor(r/7)}))},Qo.INTL=function(e,t,r,n){return zo(!0,e,t,r,n,Jo)};var fi={};function di(e){return An(e,et._astNodes[0])?Ut.value:(e=qn(e)).getMinutes()}function hi(e){return An(e,et._astNodes[0])?Ut.value:(e=qn(e)).getHours()}function mi(e){return An(e,et._astNodes[0])?Ut.value:(e=qn(e)).getSeconds()}function gi(e,t,r){if("boolean"==typeof t||"boolean"==typeof r)return Ut.value;if(An(t,et._astNodes[0]))return Ut.na;if(An(r,et._astNodes[1]))return Ut.na;if(t=Dn(t,et._astNodes[0]),r=Dn(r,et._astNodes[1]),""!==t&&0!==t||(t=new Date(1900,0,1)).setHours(0,0,0,0),""===r&&(r=0),r=Vn(r),isNaN(r))return Ut.value;t=qn(t);var n=new Date(t.getFullYear(),t.getMonth(),1);n.setMonth(n.getMonth()+r);var a=Xa._getDaysInMonth(n.getFullYear(),n.getMonth());return n.setDate(e?a:Math.min(t.getDate(),a)),Ho(n)}function pi(e,t){return gi(!0,e,t)}function vi(e,t){return gi(!1,e,t)}function yi(e){if(e=qn(e=Dn(e,et._astNodes[0])),isNaN(e))return Ut.num;function t(e){var t=new Date(e,0,4),r=t.getDay();return 0===r&&(r=7),t.setDate(t.getDate()+1-r),t}var r,n=new Date(1900,1,28);e.getTime()<=n.getTime()&&e.setDate(e.getDate()-1),1900===(r=e.getFullYear())?r+=400:9999===r&&(r-=400),e.setYear(r),e.getTime()<new Date(r,11,29).getTime()&&r--;var a=t(r+1);return e.getTime()<a.getTime()&&(a=t(r)),parseInt((e.getTime()-a.getTime())/864e5/7)+1}fi.ORIGIN=function(e,t,r){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),Gn(r=ci(r,et._astNodes[2]))?r:li(!0,e,t,r)},fi.INTL=function(e,t,r,n){void 0===r&&(r=1),e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),"string"==typeof r&&/^[01]{7}$/.test(r)||""===(r=Dn(r,et._astNodes[2],!0))&&(r=1);var a=si(r);return Gn(a)?a:Gn(n=ci(n,et._astNodes[3]))?n:"1111111"===a.join("")?Ut.value:li(!1,e,t,n,a)};var Ni=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0];function Mi(e,t){if(void 0===t&&(t=1),e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1],!0),e=qn(e),ht(et._astNodes[1])||""!==t||(t=1),t=Vn(t),isNaN(t))return Ut.value;if(21===t)return yi(e);if(void 0!==Ni[t]){var r=Ni[t],n=new Date(e.getFullYear(),0,1),a=(7-(r-n.getDay()))%7,o=n-24*a*60*60*1e3;return Math.floor((e-o)/864e5/7+1)}return Ut.num}function Ri(e,t,r){e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),e=Vn(e),t=Vn(t),r=Vn(r);var n=bn.Z._fromOADate(0);if(n.setHours(e),n.setMinutes(t),n.setSeconds(r),n.setMilliseconds(0),n.getHours()<0&&n.getMinutes()<0&&n.getSeconds()<0)return Ut.num;var a=Ho(n);return a<0?Ut.num:(et._funcNode.setFormatType("[$-409]h:mm AM/PM;@"),a)}function Ei(e){var t,r;if(Dn(e,et._astNodes[0]),Xa._isString(e)&&(e=oi(e),(t=Po(e))||(t=new Date(e))&&!isNaN(t.valueOf())||(t=null)),!t)return Ut.value;var n=t.getFullYear(),a=function(e){var t,r=e.getFullYear(),n=e.getMonth(),a=e.getDate();for(t=0;t<n;t++)a+=Xa._getDaysInMonth(r,t);return a}(t);if(n<1900)return Ut.value;for(r=1900;r<n;r++)a+=365,ai(r)&&a++;return a}function _i(e){var t,r={value:0};return Zn(e,r)?(t=r.value)>=0&&t<2958466?r:Ut.num:Ut.value}function Ti(e,t){e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]);var r=_i(e);if(Gn(r))return r;var n=_i(t);return Gn(n)?n:r.value-n.value}function Si(e,t,r){if(void 0===r&&(r=!1),e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=qn(e),t=qn(t),An(r,et._astNodes[2]))return Ut.value;var n=_i(e);if(Gn(n))return n;var a=_i(t);return Gn(a)?a:Xa._days360(e,t,r)}function Ii(e,t,r){if(void 0===r&&(r=0),e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=qn(e),t=qn(t),An(r,et._astNodes[2]))return Ut.value;var n=_i(e);if(Gn(n))return n;var a=_i(t);return Gn(a)?a:(r=Vn(r),Xa._yearfrac(e,t,r))}var Ci=p(1501),Ai=p(2471),wi=null,xi=void 0,Di=Math.abs,bi=On.Z,Oi=bn.Z,Fi=Ai.Z,Li=ea.Z._isType,Ui=ea.Z._isArray,Bi=Fi._generalNumberInt+"."+Fi._generalNumberDec,ki=Fi._formatObjectToSrting,Pi=Fi._customCultureFormat,Hi=Fi._fixNumber,Gi=ea.Z._isNullOrUndefined,Yi=function(e){return Ci.s._getCultureInfo(e)},Vi=function(e){return Yi(e).DateTimeFormat},$i=function(e){return Yi(e).NumberFormat},ji=function(e){return e&&e.toLowerCase()},Zi=function(){throw new Error(ta.Z.Exp_FormatIllegal)},Wi={_Empty:"",_format:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===arguments.length)return wi;for(var r=e[0],n=1;n<arguments.length;n++){var a=new RegExp("\\{"+(n-1)+"\\}","gm");r=r.replace(a,arguments[n])}return r},_isNullOrEmpty:function(e){return!e||e===Wi._Empty}},Xi=function(e){var t=e.charCodeAt(0);return t>=48&&t<=57},Ki=function(e){var t=e.charCodeAt(0);return t>=9&&t<=13||32===t||133===t||160===t},qi=function(){function e(e,t){_u.call(this,t);var r=this;r._content=e;var n=r._content,a=yu(n[0],"$",!1),o=n.indexOf("-");if(!(a&&o>-1))throw new Error(ta.Z.Exp_TokenIllegal);r._currencySymbol=su(n,1,o-1),(n=bi._remove(n,0,o+1)).length>0&&(r._locateID=parseInt(n,16))}return e.Name="LocaleIDFormatPart",e.prototype={cultureInfo:function(){var e=this;return e._cultureInfo||(e._cultureInfo=Yi(e._locateID),e._currencySymbol&&e._currencySymbol!==Wi._Empty&&!e._cultureInfo.NumberFormat.isReadOnly&&(e._cultureInfo.NumberFormat.currencySymbol=e._currencySymbol)),e._cultureInfo},currencySymbol:function(){return this._currencySymbol?bi._replace(this._currencySymbol,"\\.",'"."'):Wi._Empty},allowScience:function(){if(this._cultureInfo)return!(0===this._cultureInfo.name().indexOf("ja")||0===this._cultureInfo.name().indexOf("zh"))},toString:function(){return this._content?hu(this._content):Wi._Empty}},e}(),zi=function(){function e(e,t){this.formatCached=e,this.cultureName=t,this.typeName=""}return e.prototype={format:function(e,t){return wi},parse:function(e){return wi},formatString:function(){return this.formatCached},toJSON:function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},fromJSON:function(e){if(e)for(var t in e)e[t]!==xi&&(this[t]=e[t])}},e}(),Ji={_yearTwoDigit:"yy",_yearSingleDigit:"y",_yearFourDigit:"yyyy",_monthSingleDigit:"m",_monthTwoDigit:"mm",_monthAbbreviation:"mmm",_monthUnabbreviated:"mmmm",_monthJD:"mmmmm",_daySingleDigit:"d",_dayTwoDigit:"dd",_dayWeekDayAbbreviation:"aaa",_dayWeekDayUnabbreviated:"aaaa",_hoursSingleDigit:"h",_hoursTwoDigit:"hh",_minuteSingleDigit:"m",_minuteTwoDigit:"mm",_secondSingleDigit:"s",_secondTwoDigit:"ss",_eraYear:"e",_aMPMTwoDigit:"AM/PM",_aMPMSingleDigit:"A/P",_placeholderMonthJD:"@mmmmm",_defaultAbsoluteTime:new Date(1899,11,31,0,0,0,0)},Qi=[Ji._yearSingleDigit,Ji._yearTwoDigit,Ji._yearFourDigit,Ji._monthSingleDigit,Ji._monthTwoDigit,Ji._monthAbbreviation,Ji._monthUnabbreviated,Ji._monthJD,Ji._daySingleDigit,Ji._dayTwoDigit,Ji._dayWeekDayAbbreviation,Ji._dayWeekDayUnabbreviated,Ji._hoursSingleDigit,Ji._hoursTwoDigit,Ji._minuteSingleDigit,Ji._minuteTwoDigit,Ji._secondSingleDigit,Ji._secondTwoDigit,"ggg","gg","g","ee","e"],eu=function(){function e(e,t){_u.call(this,t);for(var r,n,a,o,i,u=this,s=["<=","<>",">=",">","<","="],l=0,c=s.length;l<c;l++)if(r=s[l],bi._startsWith(e,r,!0)){n=bi._remove(e,0,r.length);var f=parseFloat(n);isNaN(f)||(a=f);break}if(a===wi&&a===xi)throw new Error(ta.Z.Exp_TokenIllegal);u.value=a,u._compareOperator=r,u.isMeetCondition=(o="var self = this;",i="="===(i="<>"===(i=u._compareOperator)?"!=":i)?"===":i,new Function(["value"],o+="return value "+i+" self.value;"))}return e.Name="ConditionalFormatPart",e.prototype={toString:function(){return hu(this._compareOperator+this.value.toString())}},e}(),tu=function(){function e(e,t){_u.call(this,t);var r=this;if(r.token=e,r.type=parseInt(bi._remove(e,0,"dbnum".length),10),r.type<0||r.type>3)throw new Error(ta.Z.Exp_TokenIllegal)}function t(e,t,n){var a=e.split(".");if(a){if(1===a.length)return r(a[0],t.numbers,n?t.letters:wi);if(2===a.length)return r(a[0],t.numbers,n?t.letters:wi)+"."+r(a[1],t.numbers)}throw new Error(ta.Z.Exp_ValueIllegal)}function r(e,t,n){var a,o=e,i=0,u=0;if(2===arguments.length){var s="";for(i=0;i<o.length;i++)a=su(o,i,1),s+=t[u=parseInt(a,10)];return s}if(3===arguments.length){if(!n)return r(e,t);var l=0,c="",f=o.length,d=!1,h=[];for(i=0;i<f;i++){var m=n.length-1-i;m>-1?h.push(n[m].toString()):h.push(Wi._Empty)}for(var g=[],p=h.length-1;p>=0;p--)g[h.length-p-1]=h[p];h=g;var v=!1;for(p=0;p<f;p++){var y;a=su(o,p,1),u=parseInt(a,10);var N=Wi._Empty;f-p-16>0?(y=t[u],N="",v=!0):p!==f-1&&p!==f-5&&p!==f-9&&p!==f-13?"0"===a?(y="",N="",l+=1):"0"!==a&&0!==l?(y=t[0]+t[u],N=h[p],l=0):(y=t[u],N=h[p],l=0):"0"!==a&&0!==l?(y=t[0]+t[u],N=h[p],l=0):"0"!==a&&0===l||v?(y=t[u],N=h[p],l=0,v=!1):"0"===a&&l>=3?(y="",N="",l+=1):f>=11?(y="",l+=1):(y="",N=h[p],l+=1);var M=y+N===Wi._Empty;M||(d=!1),p!==f-13||d||(N=h[p],d=!0),p!==f-9||d||(N=h[p],d=!0),p===f-1&&(N=h[p],d=!0),c=c+y+N}var R=parseInt(e,10);return 0===R?t[0]:c}}return e.Name="DBNumberFormatPart",e.prototype={_replaceNumberString:function(e,r,n){if(!e||e===Wi._Empty)return e;for(var a,o,i,u=e,s=e,l=-1,c=-1,f=!1,d=e.length-1;d>=0;d--){var h=s[d];!isNaN(h)&&!yu(h," ",!1)||yu(h,".",!1)&&!f?(yu(h,".",!1)&&(f=!0),-1===l&&(l=d),c=d):c>-1&&l>-1&&(a=su(s,c,l-c+1),o=parseFloat(a),isNaN(o)||(i=t(a,r,n),u=bi._remove(u,c,l-c+1),u=bi._insert(u,c,i)),l=-1,c=-1,f=!1)}return c>-1&&l>-1&&(a=su(s,c,l-c+1),o=parseFloat(a),isNaN(o)||(i=t(a,r,n),u=bi._remove(u,c,l-c+1),u=bi._insert(u,c,i))),u},toString:function(){if(this.type>-1)return hu("DBNum"+this.type);throw new Error}},e}(),ru=function(){function e(e,t,r,n,a){Eu.call(this,t,r,n);var o=this;o._formatString=o._fixFormat(Nu(e)),o._absTimeParts=a,o._formatType=2,o._init()}function t(e){return bi._indexOf(e,Ji._hoursSingleDigit[0],!0)>-1||bi._indexOf(e,Ji._secondSingleDigit[0],!0)>-1}function r(e){return bi._indexOf(e,Ji._yearTwoDigit[0],!0)>-1||bi._indexOf(e,Ji._daySingleDigit[0],!0)>-1}return e.prototype={_init:function(){var t=this,r={_value:t._formatString};if(e._evaluateFormat(r._value)){var n=t._processAMPM(r);if(t.hasJD=t._replace(r._value,Ji._monthJD,'"'+Ji._placeholderMonthJD+'"',!0,!1,r,!1),t._replace(r._value,Ji._monthUnabbreviated,"MMMM",!0,!1,r,!1),t._replace(r._value,Ji._monthAbbreviation,"MMM",!0,!1,r,!1),t._replace(r._value,Ji._monthTwoDigit,"MM",!0,!1,r,!1),t._replace(r._value,Ji._monthSingleDigit,"M",!0,!1,r,!1),t._replace(r._value,Ji._dayWeekDayAbbreviation,"ddd",!0,!0,r,!0),t._replace(r._value,Ji._dayWeekDayUnabbreviated,"dddd",!0,!0,r,!0),n||(t._replace(r._value,Ji._hoursSingleDigit,"H",!0,!0,r,!1),t._replace(r._value,Ji._hoursTwoDigit,"HH",!0,!0,r,!1)),t._partDBNumberFormat&&t._partLocaleID&&(t._hasYearDelay=t._hasYearDelay||t._replace(r._value,Ji._yearFourDigit,'"@'+Ji._yearFourDigit+'"',!0,!1,r,!0),t._hasYearDelay=t._hasYearDelay||t._replace(r._value,Ji._yearTwoDigit,'"@'+Ji._yearTwoDigit+'"',!0,!1,r,!0)),t._absTimeParts)for(var a=0;a<t._absTimeParts.length;a++){var o=t._absTimeParts[a];t._replace(r._value,o._originalToken,"@"+o._originalToken,!0,!0,r,!0)}t._validDateTimeFormatString=r._value}else Zi()},formatString:function(){return this._formatString},format:function(e){var t=this,r=Wi._Empty,n=wi,a=t._validDateTimeFormatString,o=t._formatString.match(/(am\/pm|a\/p)/i);a=(a=a.replace(/H/gi,o?"h":"H")).replace(/(h{2})h+/i,"$1");var i=t.cultureName;a.match(/ddd/i)&&(i="zh-cn");try{if((n=Oi._DT(e))&&isNaN(n.valueOf())&&(n=wi),n?e=n:r=e.toString(),n){if(r=Oi._customCultureFormat(n,a,t._partLocaleID&&t._partLocaleID.cultureInfo()||Yi(i)),t.hasJD){var u=Yi(i).DateTimeFormat.monthNames[n.getMonth()];r=bi._replace(r,Ji._placeholderMonthJD,su(u,0,1))}if(t._absTimeParts)for(var s=24*(Oi._toOADate(n)-Oi._toOADate(Ji._defaultAbsoluteTime))*60*60*1e3,l=0;l<t._absTimeParts.length;l++){var c=t._absTimeParts[l],f=c._getTimeSpan(s);if(!Gi(f)){var d=c._originalToken.replace(/H/gi,o?"h":"H"),h=(d=d.replace(/(h{2})h+/i,"$1")).replace("[","\\[").replace("]","\\]");r=bi._replace(r,"@"+h,f)}}}}catch(t){r=lu(e)}return function(e,t,r,n,a){var o=e;if(!Gi(n)&&t instanceof Date){var i=Su(r,n.type,a);o=n._replaceNumberString(o,i,!0),1===n.type&&(o=o.replace(new RegExp("一十","g"),"十")),o=(o=o.replace("@"+Ji._yearFourDigit,Oi._localeFormat(t,Ji._yearFourDigit))).replace("@"+Ji._yearTwoDigit,Oi._localeFormat(t,Ji._yearTwoDigit)),o=n._replaceNumberString(o,i,!1)}return o}(r,e,t._partLocaleID,t._partDBNumberFormat,i)},parse:function(e){if(!e||e===Wi._Empty)return wi;var t=this,r=e,n=ji(r);if("true"===n)return!0;if("false"===n)return!1;if(t._validDateTimeFormatString){var a=Oi._parseExact(r,t._validDateTimeFormatString,Yi(t.cultureName));if(a)return a}try{var o=Oi._DT(r);return o&&!isNaN(o)?o:(o=new Date(r),isNaN(o.valueOf())?r:o)}catch(e){return r}},_fixFormat:function(e){for(var t=e,r="",n=!1,a=0;a<t.length;a++){var o=t[a];if('"'===o)n=!n;else if(!n)if("Y"===o||"D"===o||"S"===o||"E"===o||"G"===o)o=ji(o);else if("M"===o){var i=t[a-1];yu("A",i,!0)||yu("P",i,!0)||(o=ji(o))}r+=o}return r},_processAMPM:function(e){for(var t=[Ji._aMPMTwoDigit,Vi(this.cultureName).amDesignator+"/"+Vi(this.cultureName).pmDesignator,Ji._aMPMSingleDigit],r=["tt","tt","t"],n=0;n<3;n++)if(bi._contains(e._value,t[n],1))return e._value=bi._replace(e._value,t[n],r[n],!0),!0;return!1},_replace:function(e,n,a,o,i,u,s){if(o||i){var l=[],c=!0;!r(e)&&t(e)&&(c=!1);for(var f=!1,d=0;d<e.length;d++){var h=e[d];if(t(h)?c=!1:r(h)&&(c=!0),o&&yu(h,n[0],s)&&c||i&&yu(h,n[0],s)&&!c){for(var m=!0,g=0;g<n.length;g++)if(g+d>=e.length||!yu(n[g],e[g+d],s)){m=!1;break}var p=d+n.length-1;if(m&&p+1<e.length){var v=e[p],y=-1;for(y=p+1;y<e.length&&yu(v,e[y],s);y++);y>p+1&&(d=y,m=!1)}m&&!f&&l.splice(0,0,d)}'"'===h&&(f=!f)}if(u._value=e,l.length>0){for(d=0;d<l.length;d++){var N=l[d];u._value=bi._remove(u._value,N,n.length),u._value=bi._insert(u._value,N,a)}return!0}return!1}return!1}},e._evaluateFormat=function(e){return Mu(e,Qi)},e}(),nu=function(e,t){_u.call(this,t);var r,n=ji(e)[0];if("h"===n)r=3600;else if("m"===n)r=60;else{if("s"!==n)throw new Error(ta.Z.Exp_TokenIllegal);r=1}this._getTimeSpan=function(e){var t=e/1e3/r;return Math.abs(t-Math.round(t))<1e-6?Math.round(t):Math.floor(t)}};nu.Name="ABSTimeFormatPart";var au=function(){function e(e,t){_u.call(this,t),this.foreColor=e}return e.Name="ColorFormatPart",e.prototype.toString=function(){return hu(this.foreColor)},e}(),ou=function(){function e(e,t,r,n){Eu.call(this,t,r,n);var a=this;a._isGeneralNumber=!1,a._formatType=1,a._fullFormatString=mu(e);var o=Nu(e);if(t&&(o=pu(o,a._partLocaleID._originalToken,a._partLocaleID.currencySymbol())),(o=mu(o)).indexOf("/")>-1){var i=function(e,t){var r=[];if(e===wi||""===e)return r;var n,a,o=!1,i=[],u=!1;for(n=0;n<e.length;n++)'"'!==(a=e[n])||o||(u=!u),o||u||"/"!==a?i.push(a):(r.push(i.join("")),i=[]),o="\\"===a&&!o;return r.push(i.join("")),r}(o);if(i&&2===i.length){a._fractionDenominatorFormat=i[1];var u=i[0];if(u){var s=u.lastIndexOf(" ");s>-1?(a._fractionIntegerFormat=su(u,0,s),a._fractionNumeratorFormat=su(u,s+1,u.length-s-1)):a._fractionNumeratorFormat=u}}}a._numberFormatString=o}return e.prototype={formatString:function(){return this._fullFormatString},format:function(e){if(Li(e,"boolean"))return e.toString().toUpperCase();var t=this,r=ea.Z._toDouble(e);if(isNaN(r)||!isFinite(r)||isNaN(e))return"string"==typeof e?e:wi;var n,a,o,i,u,s,l=Yi(t.cultureName);if(t._fractionNumeratorFormat&&t._fractionDenominatorFormat){var c={value:0},f={value:0},d={value:0};if(function(e,t,r,n,a,o){var i=!!o.match(/^#\s+/),u=function(e,t){for(var r,n=t.maxDenominatorLength,a=void 0===n?7:n,o=[0,1],i=[1,0],u=e-parseInt(e),s=parseInt(u.toString().replace("0.","")),l=e,c=NaN,f=2;f<1e3;f++){var d=Math.floor(l),h=d*o[f-1]+o[f-2];if(Math.abs(o[f])>s)break;var m=d*i[f-1]+i[f-2];if(a&&m.toString().length>a)break;if(o[f]=h,i[f]=m,(r=o[f]/i[f])===c||r===e)break;c=r,l=1/(l-d)}var g=o.length-1;return g<2?{numerator:e,denominator:1}:{numerator:o[g],denominator:i[g]}}(Math.abs(e),{maxDenominatorLength:Math.min(7,t)}),s=u.numerator,l=u.denominator,c=parseInt(s/l);return e<0&&(c=-c),r.value=i&&1!==l?c:0,n.value=i&&1!==l?s%l:s,a.value=l,!0}(r,t._getDenominatorLength(),c,f,d,t._numberFormatString)){if(t._fractionIntegerFormat){s="",1===d.value&&(c.value+=f.value,f.value=0,d.value=0),0===c.value&&r<0&&(s+=l.NumberFormat.negativeSign);var h=ki(Pi(c.value,t._fractionIntegerFormat,l));h&&"0"!==h?(s+=h,s+=" "):0===c.value&&t._numberFormatString.match(/^#\s\?/)&&(s+=" "),0===r&&(s+="0"),a=t._fractionDenominatorFormat,o=parseFloat(a),!isNaN(o)&&o>0&&(0!==f.value&&0!==d.value&&(f.value*=o/d.value),d.value=o,a=a.replace(/^\d+/,function(e){return e.toString().replace(/\d/g,"?")}(o)),u=(i=Math.ceil(f.value))-f.value,f.value=u<=.5&&u>=0?parseFloat(i.toString()):parseFloat((i-1).toString()));var m=t._fractionNumeratorFormat,g=parseFloat(m);if(!isNaN(g)&&0===g){var p=m.length,v=f.value.toString(),y=v.length;p>y?m=m.substr(0,p-(p-y)):p<y&&(v=v.substr(0,y-(y-p)),f.value=parseInt(v,10))}var N=t._getFormattedFractionString(f.value,d.value,m,a,l);return 0===f.value&&(N=N.replace(/./g," "),""===h)?"0 "+N:""===(s+=N)?"0":s}s="",0===c.value&&r<0&&(s+=l.NumberFormat.negativeSign);var M=c.value*d.value+f.value;return a=t._fractionDenominatorFormat,(o=parseFloat(a))>0?(M*=o/d.value,d.value=o,s+=(M=(u=(i=Math.ceil(M))-M)<=.5&&u>=0?parseFloat(i.toString()):parseFloat((i-1).toString()))+"/"+d.value):s+=t._getFormattedFractionString(M,d.value,t._fractionNumeratorFormat,t._fractionDenominatorFormat,l),0===M?"0":s}return r.toString()}return n=function(e,t,r,n,a){if(!Gi(n)){var o=Su(r,n.type,a);if(!Gi(o)){for(var i,u,s=!1,l=Yi(a),c=0,f=e.length;c<f;c++)"decimalSeparator"===e[c].type&&(s=!0,e[c].value=n._replaceNumberString(e[c].value,o,t),i=e[c].value),"number"===e[c].type&&(e[c].value=s?n._replaceNumberString(i+e[c].value,o,t).slice(1):n._replaceNumberString(e[c].value,o,t),"ja-JP"===l.name()&&e[c].value.length>1&&("一千"===(u=e[c].value.substr(0,2))||"一百"===u||"一十"===u)&&(e[c].value=e[c].value.substr(1)));return e}}return e}(n=Pi(r,t._numberFormatString,l),t._isGeneralNumber,t._partLocaleID,t._partDBNumberFormat,t.cultureName),n},parse:function(e){var t=this;if(!e||e===Wi._Empty)return wi;var r=ji(e);if("true"===r)return!0;if("false"===r)return!1;e=t._trimSpecialSymbol(e),e=t._trimCurrencySymbol(e);var n=t._trimPercentSign(e),a=n._isPer,o=n._str;if(t._isValidaNumberString(o)){o=bi._replaceAllNoReg(o,$i(t.cultureName).numberGroupSeparator,"");var i=Fi._parseFloat(o,t.cultureName);if(!isNaN(i)&&isFinite(i))return a&&(i=Hi(i/100,15)),i}return wi},_getDenominatorLength:function(){var e=this._fractionDenominatorFormat,t=0;if(e)for(var r=e.length,n=0;n<r&&e[n].match(/[#?0\d]/);n++)t++;return t},_isValidaNumberString:function(e){for(var t="",r=0,n=0,a=0,o=!0,i=$i(this.cultureName),u=e.length-1;u>-1;u--){if(e[u]===i.numberDecimalSeparator)r++,a>0&&(o=!1),t="";else if("e"===ji(e[u])){if(n++,t="",u===e.length-1)return!1}else if(e[u]===i.numberGroupSeparator)o=3===t.length,a++,t="";else if("-"===e[u]||"+"===e[u]){if(u>0&&"e"!==ji(e[u-1]))return!1}else{if(!Xi(e[u]))return!1;t+=e[u]}if(r>1||n>1||!o)return!1}return!0},_trimSpecialSymbol:function(e){for(var t=e,r=[],n=0;n<t.length;n++)Xi(t[n])&&r.push(n);for(var a=$i(this.cultureName),o=[a.currencyDecimalSeparator,a.currencyGroupSeparator,a.currencySymbol,a.nanSymbol,a.negativeInfinitySymbol,a.negativeSign,a.numberDecimalSeparator,a.numberGroupSeparator,a.percentDecimalSeparator,a.percentGroupSeparator,a.percentSymbol,a.perMilleSymbol,a.positiveInfinitySymbol,a.positiveSign],i=t.length-1;i>-1;i--){var u=t[i];if(!Ki(u)||o.indexOf(u.toString())>-1){if("-"===u||"+"===u){var s=i>0?t[i-1].toString():wi;if(["e","E","(",$i(this.cultureName).currencySymbol].indexOf(s)<0)break}}else(i<r[0]||r[r.length-1]<i)&&(t=bi._remove(t,i,1))}return t},_trimCurrencySymbol:function(e){var t=$i(this.cultureName).currencySymbol,r=bi._startsWith(e,t)?bi._remove(e,0,t.length):e;return r.indexOf(t)<0?r:e},_trimPercentSign:function(e){var t=$i(this.cultureName).percentSymbol,r=!0,n=e;return bi._startsWith(e,t)?n=bi._remove(e,0,t.length):bi._endsWith(e,t)?n=bi._remove(e,e.length-t.length,t.length):r=!1,bi._contains(n,t)&&(r=!1),{_str:n,_isPer:r}},_getFormattedFractionString:function(e,t,r,n,a){var o=ki(Pi(e,r,a)),i=ki(Pi("0."+t,"#."+n,a,!0)),u=o+"/"+i.substr(i.indexOf(".")+1);return""===r&&(u=e+u),""===n&&(u+=t),u}},e}(),iu=function(){function e(e,t,r,n){Eu.call(this,t,r,n),arguments.length>0?((e.indexOf("0")>=0||e.indexOf("#")>=0||e.indexOf(".")>=0||e.indexOf("@")>=0)&&Zi(),this._fullFormatString=e):this._fullFormatString="General",this._formatType=0}return e.prototype={_getDigitalFormat:function(){var e=this;if(!e._digitalFormat){var t=e._fullFormatString;t=pu(t,"General",Bi),e._digitalFormat=new ou(t,e._partLocaleID,e._partDBNumberFormat,e.cultureName),e._digitalFormat._isGeneralNumber=!0}return e._digitalFormat},_getExponentialDigitalFormat:function(){var e=this;return e._exponentialDigitalFormat||(e._exponentialDigitalFormat=new ou("0.#####E+00",e._partLocaleID,e._partDBNumberFormat,e.cultureName),e._exponentialDigitalFormat._isGeneralNumber=!0),e._exponentialDigitalFormat},formatString:function(){return bi._replace(this._fullFormatString,"@NumberFormat","General")},format:function(e){var t=this;if(ea.Z._isNumber(e,t.cultureName)){var r=!t._partLocaleID||t._partLocaleID.allowScience(),n=ea.Z._toDouble(e);if(n!==xi&&n!==wi)return Di(n)>99999999999&&r||Di(n)<1e-11&&0!==n?t._getExponentialDigitalFormat().format(e):t._getDigitalFormat().format(e)}else{if(Li(e,"string")){var a=bi._replace(t.formatString(),'"',"");return(a=vu(a))?bi._replace(a,"General",e):e}if(Li(e,"boolean"))return e.toString().toUpperCase()}return""},parse:function(e){if(Wi._isNullOrEmpty(e))return wi;if("number"==typeof e)return e;var t,r=!1,n=bi._indexOf(e,"-");if(n>0&&!yu(e.charAt(n-1),"E",!0)&&(r=!0),bi._contains(e,"/")||r||bi._contains(e,":")||bi._contains(e,"-")){var a=Oi._parseLocale(e);if(a)return a}var o="-"===e.charAt(0),i=o?bi._remove(e,0,1):e,u="("===i.charAt(0)&&")"===e.charAt(e.length-1);return(t=this._getDigitalFormat().parse(i))!==wi&&t!==xi?(u||o)&&Li(t,"number")?-1*Di(t):t:e}},e}(),uu=function(){function e(e,t,r,n){var a=this;Eu.call(a,t,r,n);var o=Nu(e,!1);t&&(o=pu(o,a._partLocaleID._originalToken,a._partLocaleID.currencySymbol())),o=vu(o=mu(o)),a._formatString=o,a._formatType=3}return e.prototype={format:function(e){var t=this;try{var r;r=e instanceof Date?Oi._toOADate(e).toString():lu(e);var n=t._parseFormat(t._formatString);return t._toFormattedObject(r,n)}catch(e){return""}},parse:function(e){return e||""},formatString:function(){return this._formatString},_parseFormat:function(e){for(var t,r="",n=!1,a=wi,o=[],i=0;i<e.length;i++)t=e.charAt(i),n?('"'!==t?r+=t:(r+=t,o.push(r),r="",n=!1),a=t):"*"!==a&&"_"!==a&&"\\"!==a||""===r?"*"!==t&&"_"!==t&&"\\"!==t?"@"!==t?'"'!==t?(r+=t,a=t):(a=t,""!==r&&o.push(r),r=t,n=!0):(a=t,""!==r&&(o.push(r),r=""),o.push(t)):(a=t,""!==r&&(o.push(r),r=""),r+=t):(r+=t,o.push(r),r="");return""!==r&&o.push(r),o},_toFormattedObject:function(e,t){for(var r=[],n=!1,a=t.length-1;a>=0;a--){var o=t[a];"*"===o[0]?n||(n=!0,r.push({type:"fillingChar",value:o[1]})):"_"===o[0]?r.push({type:"placeholder",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&r.push({type:"text",value:o.substr(1,o.length-2)}):"@"===o[0]?r.push({type:"text",value:e}):r.push({type:"text",value:o})}return r.reverse()}},e}();function su(e,t,r){return e.substr(t,r)}function lu(e){return ea.Z._isNullOrUndefined(e)?"":"boolean"==typeof e?e?"TRUE":"FALSE":"string"==typeof e?e:e.toString()}var cu={_positive:0,_negative:1,_zero:2,_text:3},fu=new RegExp("([.+?*$^\\[\\](){}|/])","g");function du(e,t){if("\\"===e[t])throw new Error(ta.Z.Exp_InvalidBackslash);if(t-1>0&&t-1<e.length&&"\\"===e[t-1]){if(t-2<0)return!0;if(t-2>0&&t-2<e.length)return"\\"!==e[t-2]}return!1}function hu(e){if(!e)throw new Error(ta.Z.Exp_TokenIsNull);return"["+e+"]"}function mu(e){if(e===xi||e===wi||""===e)return e;for(var t="",r=0,n=0;n<e.length;n++){var a=e[n];"["===a?r++:"]"===a?--r<0&&(r=0):0===r&&(t+=a)}return t.toString()}function gu(e){return e=pu(e,"[",""),pu(e,"]","")}function pu(e,t,r){return!e||e===Wi._Empty||yu(t,r,!0)?e:(t=t.replace(fu,"\\$1"),e.replace(new RegExp(t,"g"),r))}function vu(e){for(var t=e.length,r=!1,n="",a=0;a<t;a++){var o=e.charAt(a);"\\"===o?(r=!r)||(n+=o):(r=!1,n+=o)}return n}function yu(e,t,r){return r?ji(e)===ji(t):e===t}function Nu(e,t){1===arguments.length&&(t=!0);for(var r=!1,n="",a=0;a<e.length;a++){var o=e[a];if('"'===o)r=!r;else if(!r&&!t&&"/"===o&&!du(e,a)){"_"===o&&a++;continue}n+=o}return n}function Mu(e,t){if(!e||e===Wi._Empty)return!1;for(var r=function(e){for(var t="",r=!1,n=0,a=e.length;n<a;n++){var o=e[n];'"'===o&&(r=!r),"E"===o||r||(t+=ji(o))}return t}(Nu(e)),n=0;n<t.length;n++){var a=r.indexOf(t[n]);if(0===a)return!0;if(a>0&&"_"!==r[a-1]&&"*"!==r[a-1])return!0}return!1}var Ru=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"],["H:m:s.FFF","h:m:s.FFF tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]];function Eu(e,t,r){this._partLocaleID=e,this._partDBNumberFormat=t,this.cultureName=r}function _u(e){this._originalToken=e}function Tu(e){var t,r=gu(e);if(!r||r===Wi._Empty)return t;var n=r[0];return["<",">","="].indexOf(n)>-1?(t=eu).Name="ConditionalFormatPart":bi._startsWith(r,"DBNum",!0)?(t=tu).Name="DBNumberFormatPart":yu(r[0],"$",!1)&&r.indexOf("-")>-1?(t=qi).Name="LocaleIDFormatPart":function(e){var t=ji(e),r=t[0];if("h"!==r&&"m"!==r&&"s"!==r)return!1;for(var n=1;n<t.length;n++)if(r!==t[n])return!1;return!0}(r)?(t=nu).Name="ABSTimeFormatPart":r.indexOf("$")<0&&r.length>=3&&((t=au).Name="ColorFormatPart"),t}function Su(e,t,r){var n=(e?e.cultureInfo():Yi(r)).NumberFormat.dbNumber;return n?n[t]:wi}var Iu=function(){function e(e,t){var r=this;0===arguments.length?(r.formatCached="General",r._numberFormat=new iu):r._init(e,t)}var t=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"];function r(e){if(!e||e===Wi._Empty)throw new Error(ta.Z.Exp_TokenIllegal)}function n(e){r(e);var t=gu(e);return r(t),t}function a(e){var t=n(e);return"$"===t[0]&&(t=t.slice(1)),'"'+t+'"'}return e.prototype={_init:function(e,t){e!==wi&&e!==xi||Zi();var r=e,o=this;o.formatCached=e;for(var i="",u="",s=!1,l=[],c=0;c<e.length;c++){var f=e[c];if("["===f)s&&Zi(),u&&(i||(i=""),i+=u),u=f.toString(),s=!0;else if("]"===f){if(s||Zi(),u){var d=(u+=f).toString(),h=Tu(u.toString());if(h)"ABSTimeFormatPart"===h.Name?(l.push(new h(n(d),d)),i+=u):o.addPart(h,d);else{var m=a(d);i+=m,r=pu(e,d,m)}u=""}else Zi();s=!1}else u+=f}u?s?Zi():i+=u:i||(i=o._getDBNumberDefaultFormat()),o.localeIDFormatPart&&(t=o.localeIDFormatPart.cultureInfo().name());var g,p,v,y,N=(g=i,p=o.conditionalFormatPart,y=!1,Mu(g=g?g.toString():Wi._Empty,["general"])?v=iu:ru._evaluateFormat(g)?v=ru:Mu(g,["E+","E-","#",".",",","%","0","/","?"])||p?(y=!0,v=ou):(y=!0,v=uu),{_isDigitalOrText:y,_type:v}),M=N._type,R=N._isDigitalOrText?r:i;M?o._numberFormat=new M(R,o.localeIDFormatPart,o.dbNumberFormatPart,t,l.length>0?l:wi):Zi()},_getDBNumberDefaultFormat:function(){var e=this,r="";return e.dbNumberFormatPart&&(t.some((function(t){return"dbNumberFormatPart"!==t&&e[t]}))||(r="General")),r},formatString:function(){for(var e=this,r="",n=0,a=t.length;n<a;n++){var o=t[n];e[o]&&(r+=e[o].toString())}return r+e._numberFormat.formatString()},addPart:function(e,r){for(var a=n(r),o=0,i=t.length;o<i;o++){var u=t[o];if(yu(u,e.Name,!0)){if(this[u])throw new Error(ta.Z.Exp_DuplicatedDescriptor);this[u]=new e(a,r)}}},format:function(e){return this._numberFormat.format(e)},parse:function(e){return this._numberFormat.parse(e)}},e}(),Cu=function(e){function t(e,t){var r=this;r._isSingleFormatterInfo=!0,r.PropertyChanged=[],Wi._isNullOrEmpty(e)&&(e="General"),r.formatCached=e,r.cultureName=t,r.init()}function r(e){var r=t[e];return r||(r=new t(e),t[e]=r),r}return ea.Z._inherit(t,e),t.prototype={toJSON:function(){var e=this,t={formatCached:e.formatCached};return e.cultureName&&(t.customerCultureName=e.cultureName),"general"===ji(e.formatCached)&&delete t.formatCached,t},hasFormatedColor:function(){for(var e in cu)if(cu.hasOwnProperty(e)){var t=this.getFormatter(cu[e]);if(t&&t.colorFormatPart)return!0}return!1},formatString:function(e){var t=this;if(0===arguments.length){for(var r=Wi._Empty,n=0,a=t.formatters.length;n<a;n++){var o=t.formatters[n];r+=o.formatString(),n!==a-1&&(r+=";")}return r}if(!e)throw new Error(ta.Z.Exp_ValueIsNull);return t.formatters=wi,t.formatCached=e,t.init(),t._raisePropertyChanged("formatString"),t},getFormatter:function(e){return this.formatters&&this.formatters[e]},getPreferredEditingFormatter:function(e){var t=Vi(this.cultureName);if(Li(e,"DateTime")){var n=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?"":" h:mm:ss";return r(t.shortDatePattern+n)}if(Li(e,"TimeSpan"))return r(t.longTimePattern);if(ea.Z._isNumber(e,this.cultureName)){var a=ea.Z._toDouble(e);return r(a>=1e20||a<=1e-17&&a>0||a<=-1e20||a<0&&a>=-1e-17?"0.##E+00":Bi)}return r("General")},getPreferredDisplayFormatter:function(e,n){var a=this;if(n||(n={value:wi}),n.value=wi,Wi._isNullOrEmpty(e))return new t;var o=e,i=n.value=a.parse(o);if(Li(i,"DateTime")||Li(i,"TimeSpan"))for(var u={pattern:Ru,formatter:["d-mmm","mmm-yy",Vi().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0",Vi().shortDatePattern+" h:mm",Vi().shortDatePattern+" h:mm:ss",Vi().shortDatePattern+" h:mm:ss.0"]},s=u.pattern,l=u.formatter,c=0;c<s.length;c++)for(var f=s[c],d=0;d<f.length;d++){var h=f[d],m=Oi._parseLocale(e,h);if(m&&m-i==0)return new t(l[c])}else if(ea.Z._isNumber(i,a.cultureName)){var g=$i(a.cultureName),p=g.currencySymbol,v=g.numberDecimalSeparator,y=g.percentSymbol,N=g.numberGroupSeparator,M=bi._contains,R=M(o,v)?".00":"";if(o[0]===p)return r(Wi._format("{0}#,##0{1};[Red]({0}#,##0{1})",p,R));if(M(o,"E",1))return r("0.00E+00");if(o[0].toString()===y||o[o.length-1].toString()===y)return r(Wi._format("0{0}%",R));if(M(o,N))return r(Wi._format("#,##0{0}",R))}return r("General")},format:function(e,t){if(Li(e,"boolean"))return e.toString().toUpperCase();var r=this._getFormatInfo(e);if(r){var n=r.colorFormatPart;t&&n&&(t.conditionalForeColor=t.value=n.foreColor);var a=0,o=ea.Z._isNumber(e,self.cultureName);o&&(a=ea.Z._toDouble(e));var i=Wi._Empty;try{o&&r===this.getFormatter(cu._negative)?i=r.format(Di(a)):(i=r.value)===xi&&(i=r.format(e)),t&&(t.content=Ui(i)?i:[{type:"text",value:i}]),Ui(i)&&(i=Fi._formatObjectToSrting(i))}catch(t){Li(e,"string")&&(i=e.toString())}return i===r.formatCached&&(""!==e&&null!=e&&!isNaN(e)||(i=e)),i}return o&&a<0?"-".toString():Li(e,"string")?e.toString():e===xi||e===wi?Wi._Empty:e.toString()},parse:function(e){var t=this;return t.formatters&&t.formatters.length>0?t.formatters[0].parse(e):wi},init:function(){var e=this,t=e.formatCached;Wi._isNullOrEmpty(t)&&Zi(),e.formatters=[];var r=t.split(";");e._isSingleFormatterInfo=1===r.length,(!r||r.length<1||r.length>4)&&Zi();for(var n=0;n<r.length;n++){var a=new Iu(r[n],e.cultureName);e.formatters.push(a)}e.getFormatter(cu._positive)||Zi()},_getFormatInfo:function(e){var t=this,r=t.getFormatter(cu._positive),n=r&&r.conditionalFormatPart,a=t.getFormatter(cu._text);if("string"==typeof e&&isNaN(e))return a||(n?e:r);if(ea.Z._isNumber(e,t.cultureName)||Li(e,"boolean")){var o,i=t.getFormatter(cu._negative),u=t.getFormatter(cu._zero),s=ea.Z._toDouble(e),l=n&&r.conditionalFormatPart.isMeetCondition(s),c=i&&i.conditionalFormatPart,f=c&&i.conditionalFormatPart.isMeetCondition(s);if(t._isSingleFormatterInfo||(n?l:s>0||0===s&&!u))o=r;else if(c?f:s<0)o=i;else if(u)o=u;else if(i){if(n&&c)return{value:""===u?"":s+""};o=i}return o}return wi},_raisePropertyChanged:function(e){var t=this;if(t.PropertyChanged)for(var r=0;r<t.PropertyChanged.length;r++){var n=t.PropertyChanged[r];"function"==typeof n&&n(t,e)}}},t}(zi),Au={BAND_INDEX_CONST:-2147483648,MAX_ROW_COUNT:1048576,MAX_COLUMN_COUNT:16384},wu=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function xu(e){return e<=255}function Du(e){return e<=127}Au.isDigit=function(e){return e>=48&&e<=57},Au._isLetter=function(e){var t=e.charCodeAt(0);return!xu(t)||(Du(t)?(t|=32)>=96&&t<=122:0===wu[t]||1===wu[t])},Au._isLetterOrDigit=function(e){var t=e.charCodeAt(0);return!xu(t)||(Du(t)?t<=57?t>=48:(t|=32)>=96&&t<=122:0===wu[t]||1===wu[t])};var bu=Au,Ou=gn;function Fu(e,t){try{return t[0][0].join(e)}catch(e){}}var Lu=ra.Z._getLength,Uu=Math.pow,Bu=Math.sqrt;function ku(){var e,t=arguments;t[t.length-1].isHiddenCells&&"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&(e=t[t.length-1],t=Array.from(t).slice(0,-1));var r,n=0,a=0;for(r=0;r<t.length;r++){var o,i=t[r],u=void 0,s=!1;if(ft(i)){if(u=e&&e[r],(o=i.toArray()).error&&o.error.length>0)return o.error[0]}else if(Array.isArray(i)){if((o=zn(i)).error&&o.error.length>0)return o.error[0]}else s=!0,o=zn(i);for(var l=0;l<o.length;l++){if(u){var c=o.row+Math.floor(l/o.colCount),f=o.col+l%o.colCount;if(u[c]&&u[c][f])continue}var d=o[l];if("number"==typeof d)n+=d,a++;else if(s&&"string"==typeof d){var h=parseFloat(d);if(isNaN(h))throw new Error(Ut.value);n+=h,a++}else s&&"boolean"==typeof d&&(n+=Number(d),a++)}}if(0===a)throw new Error(Ut.div0);return n/a}function Pu(e){var t,r,n,a,o=arguments,i=0,u=0,s=(e=zn(e)).length,l=o.length,c=[];for(c.push(e),n=1;n<l;n+=2){if((a=zn(o[n])).error&&a.error.length>0)return a.error[0];c.push(a);var f=o[n+1],d=va._parseCriteria(f);c.push(d)}for(r=0;r<s;r++)if("number"==typeof(t=e[r])){var h=!0;for(n=1;n<l&&(h=(d=c[n+1])(c[n][r]));n+=2);h&&(i+=t,u++)}return 0===u?Ut.div0:Kn(i/u)}function Hu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&t[t.length-1].isHiddenCells&&(n=t[t.length-1],t=t.slice(0,-1));for(var a=[],o=0;o<t.length;o++){var i=void 0,u=void 0,s=t[o],l=!1;if(ft(s))i=n&&n[o],u=s.toArray();else if(Array.isArray(s)){if((u=zn(s)).error&&u.error.length>0)return u.error[0]}else l=!0,u=zn(s);for(var c=0;c<u.length;c++){var f=u.row+Math.floor(c/u.colCount),d=u.col+c%u.colCount;if(!(i&&i[f]&&i[f][d])){var h=u[c];l&&"number"!=typeof h&&(h=parseFloat(h)),"number"!=typeof h||isNaN(h)||a.push(h)}}}return a.length}function Gu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,a=et._instance;"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&t[t.length-1].isHiddenCells&&(n=t[t.length-1],t=t.slice(0,-1));for(var o=0,i=0;i<t.length;i++){var u=t[i];if(ft(u))for(var s=n&&n[i],l=u.identities,c=0;c<l.length;c++)for(var f=l[c],d=0;d<f.rowCount;d++)for(var h=0;h<f.colCount;h++){var m=f.row+d,g=f.col+h;if(!(s&&s[m]&&s[m][g])){var p=a.custom.cellEditValue(d+f.row,h+f.col,f.sheetId);null!==p&&""!==p&&o++}}else o+=zn(u).length}return o}function Yu(e){var t=et._astNodes[0];if(Array.isArray(e)){if(vt(t))return Ut.value;e=gn(e)}else{if(!ht(t))return Ut.value;e=[e]}for(var r=0,n=0;n<Lu(e);n++)null!==e[n]&&""!==e[n]||r++;return r}var Vu={};function $u(e,t){var r=0===t||"*"===t,n=Vu[t];return n||(n=va._parseCriteria(t)),!(r&&null===e||!n||!n(e))}function ju(e,t){for(var r=0,n=0;n<ra.Z._getLength(e);n++)$u(e[n],t)&&r++;return Kn(r)}function Zu(e,t){var r,n,a,o=0;if(e=zn(e),Array.isArray(t)||ft(t)){for(t=zn(t),a=0;a<ra.Z._getLength(t);a++){if(kt(n=ju(e,t[a])))return n;if(r=$n(n),isNaN(r))return Ut.value;o+=r}return o}return ju(e,t)}function Wu(){for(var e,t=0,r=[],n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];if(a.length%2!=0)throw new Error(Ut.paramsLack);Array.isArray(a[0])||(a[0]=[[[a[0]]]]);for(var i=0;i<a.length;i+=2){var u=a[i][0],s=u.length+"-"+u[0].length;if(void 0===e)e=s;else if(e!==s)throw new Error(Ut.value);a[i]=a[i][0];var l=a[i+1];r.push({values:a[i],criteria:l})}for(var c=r[0].values.length,f=r[0].values[0].length,d=function(e){for(var n=function(n){r.every((function(t){var r=t.values,a=t.criteria;return $u(r[e][n],a)}))&&t++},a=0;a<f;a++)n(a)},h=0;h<c;h++)d(h);return t}function Xu(e,t){var r=et._instance.helper.getRangeValue;if(ft(e)){var n=e.getIdentities(0);e=r({newLine:n.colCount},n)}if(ft(t)){var a=t.getIdentities(0);t=r({newLine:a.colCount},a)}var o,i,u,s=0,l=t.rowCount,c=t.colCount;for(o=0;o<l;o++)for(i=0;i<c;i++)"number"==typeof t[o][i]&&s++;var f=e.rowCount,d=e.colCount,h=[],m=[],g=s+1;for(s=0,o=0;o<l;o++)for(i=0;i<c;i++)(u=t[o][i])!==Qn&&(h[s++]=$n(u));var p=h.slice(0);for(h.sort((function(e,t){return e-t})),o=0;o<g;o++)m[o]=[0];for(o=0;o<f;o++)for(i=0;i<d;i++)if(Hn(u=e[o][i])){for(var v=$n(u),y=!1,N=0;!y&&N<s;N++)v<=h[N]&&(m[p.indexOf(h[N])][0]++,y=!0);y||m[s][0]++}return[m]}function Ku(e){var t;"[object Object]"===Object.prototype.toString.call(e[e.length-1])&&e[e.length-1].isHiddenCells&&(t=e[e.length-1],e=e.slice(0,-1));for(var r=[],n=0;n<e.length;n++){var a=t&&t[n],o=zn(e[n]);if(o.error&&o.error.length>0)throw new Error(o.error[0]);for(var i=0;i<o.length;i++){var u=o.row+Math.floor(i/o.colCount),s=o.col+i%o.colCount;if(!(a&&a[u]&&a[u][s])){var l=o[i];"number"!=typeof l||isNaN(l)||r.push(l)}}}return r}function qu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Ku(t);return 0===n.length?0:Math.max.apply(Math,n)}function zu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Ku(t);return 0===n.length?0:Math.min.apply(Math,n)}var Ju={};function Qu(e){if(!e)throw new Error(Ut.na);for(var t=[],r=e[0],n=0;n<r.length;n++)for(var a=0;a<r[n].length;a++)Array.isArray(t[a])||(t[a]=[]),t[a].push(r[n][a]);return[t]}Ju.P=function(){var e=es.P.apply(this,arguments);return _n(e)?e:Math.sqrt(e)},Ju.S=function(){var e=es.S.apply(this,arguments);return _n(e)?e:Math.sqrt(e)};var es={};function ts(e,t,r,n){if(void 0===n&&(n=0),Array.isArray(r)||""===r)return Ut.value;if(r=$n(r=Dn(r,et._astNodes[0])),isNaN(r))return Ut.value;if(Array.isArray(t)&&!vt(et._astNodes[1]))t=gn(t);else{if(!ht(et._astNodes[1]))return Ut.value;t=[t]}if(t=t.filter((function(e){return"number"==typeof e})),An(n,et._astNodes[2]))return Ut.value;if("string"==typeof n)switch(n.toLowerCase()){case"true":n=1;break;case"false":case"":n=0}if("number"!=typeof n)return Ut.value;var a,o,i,u=0,s=0,l=0;for(a=0,i=Lu(t);a<i;a++)(o=t[a])!==Qn&&(o<r?u++:r<o?l++:s++);if(0===s)return Ut.na;var c=(0===n?l:u)+1;return e?c:c+(s-1)/2}es.P=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=Ku(t),a=n.length,o=0,i=ku.apply(void 0,t),u=0;u<a;u++)o+=Math.pow(n[u]-i,2);return o/a},es.S=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=Ku(t),a=n.length,o=0,i=ku.apply(void 0,t),u=0;u<a;u++)o+=Math.pow(n[u]-i,2);return o/(a-1)};var rs={};function ns(e,t,r){var n=0,a=0,o=va._parseCriteria(t);if(e.rowCount!==r.rowCount||e.colCount!==r.colCount)return Ut.value;for(var i=0;i<ra.Z._getLength(e);i++){var u=e[i];if(o&&o(u)){var s=r[i];"number"==typeof s&&(n=Nn(n,s),a++)}}return 0===a?Ut.div0:Kn(n/a)}function as(e,t,r,n){var a,o,i,u=e?t.length:t.getRowCount(0),s=e?t[0].length:t.getColumnCount(0),l=[];for(e||(i=t.toArray()),a=0;a<u;a++)for(l[a]=[],o=0;o<s;o++){var c=e?t[a][o]:i[a*s+o];l[a][o]=ns(r,c,n)}return[l]}function os(e,t,r){if(!ft(e)||!ft(r)&&void 0!==r)throw new Error(Ut.paramsErr);if(void 0!==r){var n=et._instance.helper.getRangeValue,a=e.identities[0];e=n(void 0,a);var o=r.identities[0];if((r=n(void 0,{sheetId:o.sheetId,row:o.row,col:o.col,rowCount:a.rowCount,colCount:a.colCount,refType:a.refType})).error&&r.error.length>0)return r.error[0]}else{if((e=zn(e)).error&&e.error.length>0)return e.error[0];r=e}return ft(t)?as(!1,t,e,r):Array.isArray(t)?as(!0,t=t[0],e,r):ns(e,t,r)}function is(){for(var e,t,r,n,a=0,o=0,i=arguments.length,u=new Array(i),s=0;s<i;s++)u[s]=arguments[s];var l=function(){var i=et._astNodes[e];if(n=u[e],Array.isArray(n))n=gn(n),vt(i)||(n=n.filter((function(e){return null!==e}))),n=n.map((function(e){return e=xn(e,i,!0),Xa._isString(e)?0:e}));else{if(n=Dn(n,i),Xa._isString(n)&&!ht(i))return{v:Ut.value};n=null===n?[]:[n]}for(t=0;t<Lu(n);t++)r=n[t],Xa._isNumber(r)||Xa._isBoolean(r)?(a+=$n(r),o++):(null===r||Xa._isString(r))&&o++};for(e=0;e<Lu(u);e++){var c=l();if("object"===typeof c)return c.v}return 0===o?Ut.div0:Kn(a/o)}function us(e,t,r){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),""===e?Ut.num:(e=(e=Array.isArray(e)?gn(e):[e]).filter((function(e){return"number"==typeof e})),Xa._st_includeAggregateMulti([e,t],r))}function ss(e,t){return us(e,t,15)}function ls(e,t){return us(e,t,14)}function cs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,a=t.length;n<a;n++){var o=t[n],i=et._astNodes[n];if(Array.isArray(o))o=(o=gn(o)).filter((function(e){return"number"==typeof e})),t[n]=o;else{if(ht(i)&&"number"!=typeof o){o=Qn,t[n]=[o];continue}if(o=Dn(o,i),o=Number(o),isNaN(o))return Ut.value;t[n]=[o]}}return Xa._st_includeAggregateMulti(t,12)}rs.EQ=function(e,t,r){return void 0===r&&(r=0),ts(!0,t,e,r)},rs.AVG=function(e,t,r){return void 0===r&&(r=0),ts(!1,t,e,r)};var fs={};function ds(e,t,r){for(var n=0,a=e.length;n<a;n++){var o=e[n];Array.isArray(o)?(o=(o=gn(o)).filter((function(e){return"number"==typeof e})),e[n]=o):(""===(o=Dn(o,et._astNodes[n]))&&(o={}),e[n]=[o])}var i={_sumx:0,_sumx2:0,n:0},u=function(e,t){var r,n,a,o,i;for(o=0;o<Lu(e);o++)for(r=e[o],i=0;i<Lu(r);i++)if(null===(a=r[i]))t.n++;else if(Xa._isString(a)){var u={value:0};if(Zn(a,u))n=u.value,t._sumx+=n,t._sumx2+=n*n;else if(!Array.isArray(r))return Ut.value;t.n++}else{if(Gn(a))return a;Hn(a)&&(n=$n(a),t._sumx+=n,t._sumx2+=n*n,t.n++)}}(e,i);if(Gn(u))return u;if(i.n<=t)return Ut.div0;var s=Math.max(0,(i.n*i._sumx2-i._sumx*i._sumx)/(i.n*(i.n-t)));return Kn(s=r?Math.sqrt(s):s)}function hs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ds(t,1,!0)}function ms(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ds(t,0,!0)}function gs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ds(t,1,!1)}function ps(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ds(t,0,!1)}function vs(e,t){if(!Array.isArray(e)||!Array.isArray(t))return Ut.div0;e=(e=gn(e)).map((function(e){return"number"!=typeof e&&(e=Qn),e})),t=(t=gn(t)).map((function(e){return"number"!=typeof e&&(e=Qn),e}));var r,n,a,o,i=0,u=0,s=0,l=0,c=0,f=Lu(t);if(f!==Lu(e))return Ut.na;var d,h,m,g=0;for(d=0;d<f;d++)h=e[d],m=t[d],h!==Qn&&m!==Qn&&(i+=h,u+=m,s+=h*h,l+=m*m,g++);if(g<=1)return Ut.div0;if(r=i/g,n=u/g,a=Math.sqrt((g*s-i*i)/(g*(g-1))),o=Math.sqrt((g*l-u*u)/(g*(g-1))),0===a||0===o)return Ut.div0;for(d=0;d<f;d++)h=e[d],m=t[d],h!==Qn&&m!==Qn&&(c+=(h-r)*(m-n));return Kn(c/$n((g-1)*a*o))}function ys(e,t){for(var r=0,n=t.length;r<n;r++){var a=t[r];if(Array.isArray(a))a=(a=gn(a)).filter((function(e){return"number"==typeof e})),t[r]=a;else{var o=et._astNodes[r];if(a=Dn(a,o),ht(o)&&"number"!=typeof a&&(a=0),a=Number(a),isNaN(a))return Ut.value;t[r]=[a]}}var i,u,s,l,c=e?1:0,f=0;for(s=0;s<Lu(t);s++)for(i=t[s],l=0;l<Lu(i);l++)if((u=i[l])!==Qn){if(u<=0)return Ut.num;c=e?c*u:c+1/u,f++}return e?f<=0?Ut.div0:Kn(Math.pow(c,1/f)):0===c?Ut.div0:Kn(f/c)}function Ns(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ys(!0,t)}function Ms(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ys(!1,t)}function Rs(e,t){if(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=$n(t),isNaN(e)||isNaN(t))return Ut.value;if(t=Math.floor(t),e<0)return Ut.num;if(t<1||t>1e10)return Ut.num;var r,n,a,o,i=Math.log(Math.sqrt(Math.PI)),u=1/Math.sqrt(Math.PI),s=0,l=e,c=.5*l,f=t%2==0;t>1&&(s=Math.exp(-c));var d=Xa._st_normsdist(-Math.sqrt(l));if(Gn(d))return d;var h=$n(d);if(n=f?s:2*h,t>2){if(l=.5*(t-1),a=f?1:.5,c>20){for(r=f?0:i,o=Math.log(c);a<=l;)r=Math.log(a)+r,n+=Math.exp(o*a-c-r),a+=1;return n}for(r=f?1:u/Math.sqrt(c),o=0;a<=l;)o+=r*=c/a,a+=1;return o*s+n}return n}function Es(){return function(){for(var e,t=[],r=0,n=arguments.length;r<n;r++){var a=r<0||arguments.length<=r?void 0:arguments[r];if(Array.isArray(a))a=(a=gn(a)).filter((function(e){return"number"==typeof e})),t=t.concat(a);else{var o=et._astNodes[r];if(a=Dn(a,o),ht(o)&&"number"!=typeof a)continue;if(a=Number(a),isNaN(a))return Ut.value;t.push(a)}}var i,u,s,l,c,f=0,d=0,h=0,m=0,g=Lu(t),p=[];if(g>0){for(c=t,p.push(c),s=0;s<Lu(c);s++)(e=c[s])!==Qn&&(f+=e,d+=e*e,m++);if(m<=3)return Ut.div0;if(i=f/m,0===(u=Bu((m*d-f*f)/(m*(m-1)))))return Ut.div0;for(l=0;l<g;l++)for(c=p[l],s=0;s<Lu(c);s++)(e=c[s])!==Qn&&(h+=Uu((e-i)/u,4));return Kn(m*(m+1)*h/((m-1)*(m-2)*(m-3))-3*(m-1)*(m-1)/((m-2)*(m-3)))}}.apply(void 0,arguments)}function _s(e,t){Array.isArray(e)&&(e=(e=gn(e)).map((function(e){return"number"!=typeof e?Qn:e}))),Array.isArray(t)&&(t=(t=gn(t)).map((function(e){return"number"!=typeof e?Qn:e})));var r,n,a,o=0,i=0,u=0,s=0,l=0,c=Lu(e);if(c!==Lu(t))return Ut.na;for(a=0;a<c;a++)r=e[a],(n=t[a])!==Qn&&r!==Qn&&(o+=r,i+=n,u+=n*n,s+=n*r,l++);return 0===l||l*u-i*i==0?Ut.div0:Kn(o/l-(l*s-i*o)/(l*u-i*i)*(i/l))}function Ts(e,t){Array.isArray(e)&&(e=(e=gn(e)).map((function(e){return"number"!=typeof e?Qn:e}))),Array.isArray(t)&&(t=(t=gn(t)).map((function(e){return"number"!=typeof e?Qn:e})));var r=0,n=0,a=0,o=0,i=0,u=Lu(e);if(u!==Lu(t))return Ut.na;for(var s=0,l=0;l<u;l++){var c=e[l],f=t[l];Xa._isNumber(c)&&Xa._isNumber(f)&&(r+=c,n+=f,a+=c*c,o+=f*f,i+=c*f,s++)}return s*a-r*r==0||s*o-n*n==0?Ut.div0:(s*i-r*n)/Math.sqrt((s*a-r*r)*(s*o-n*n))}function Ss(e,t){Array.isArray(e)&&(e=(e=gn(e)).map((function(e){return"number"!=typeof e?Qn:e}))),Array.isArray(t)&&(t=(t=gn(t)).map((function(e){return"number"!=typeof e?Qn:e})));var r=0,n=0,a=0,o=0,i=0,u=0,s=Lu(t);if(s!==Lu(e))return Ut.na;for(var l=0;l<s;l++){var c=t[l],f=e[l];Xa._isNumber(c)&&Xa._isNumber(f)&&(r+=c,n+=f,a+=c*c,o+=f*f,i+=c*f,u++)}var d=Bu((u*a-r*r)*(u*o-n*n));if(0===d)return Ut.div0;var h=(u*i-r*n)/d;return Kn(h*h)}fs.SNGL=function(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(et._astNodes[t],Array.isArray(n))n=(n=gn(n)).filter((function(e){return"number"==typeof e})),e=e.concat(n);else{if("number"!=typeof n)return Ut.value;e.push(n)}}return Xa._st_includeAggregateMulti(e,13)};var Is={};function Cs(){return function(e,t){var r=Array.isArray(e)?gn(e):[e],n=Array.isArray(t)?gn(t):[t],a=0,o=0,i=0,u=0,s=0,l=Lu(n);if(l!==Lu(r))return Ut.na;for(var c=0;c<l;c++){var f=r[c],d=n[c];if(d!==Qn&&f!==Qn&&!Gn(d)&&!Gn(f)&&"number"==typeof f&&"number"==typeof d){var h=$n(f),m=$n(d);a+=h,o+=m,i+=m*m,u+=m*h,s++}}return s*i-o*o==0?Ut.div0:Kn((s*u-o*a)/(s*i-o*o))}.apply(void 0,arguments)}function As(){return function(e,t){if("number"!=typeof t||t<0||t>=1)throw new Error(Ut.num);var r=0,n=[];Ua(gn(e).filter((function(e){return"number"==typeof e})),n);for(var a=function(e){for(var t=0,r=0;r<e.length;r++)e[r]!==Qn&&t++;return t}(n),o=parseInt((a*t/2).toString(),10),i=o;i<a-o;i++)r+=$n(n[i]);return r/(a-2*o)}.apply(void 0,arguments)}function ws(e,t){for(var r=[],n=function(e,n){var a=t[e],o=et._astNodes[e];if(Array.isArray(a))a=(a=gn(a)).map((function(e){return vt(o)||(e=xn(e,o,!0),Xa._isString(e)&&(e=0)),e})),a=a.filter((function(e){return Xa._isNumber(e)})),r=r.concat(a);else{if(""===(a=Dn(a,o)))return"continue";if(a=$n(a),isNaN(a))return{v:Ut.value};r.push(a)}},a=0,o=t.length;a<o;a++){var i=n(a);if("continue"!==i&&"object"===typeof i)return i.v}var u,s,l,c=!1,f=0;for(s=0;s<Lu(r);s++)if(Hn(l=r[s])||Xa._isBoolean(l)||Xa._isString(l))u=Xa._isString(l)?0:$n(l),(!c||e&&u>f||!e&&u<f)&&(f=u),c=!0;else if(Gn(l))return l;return f}function xs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ws(!0,t)}function Ds(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return ws(!1,t)}function bs(e,t,r,n){if(void 0===r&&(r=3),e=Array.isArray(e)?(e=gn(e)).filter((function(e){return"number"==typeof e})):[e=Dn(e,et._astNodes[0])],t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2],!0),t=$n(t),isNaN(t))return Ut.value;if(""===r&&(r=3),(r=Vn(r))<1)return Ut.num;var a=[];Ua(e,a);var o=Lu(a);if(0===o||t<a[0]||t>a[o-1])return Ut.na;var i=1===o?1:function(e,t,r){var n,a,o=Lu(e);if(t!==e[0]){var i=0,u=e[0];for(a=1;a<o&&e[a]<t;a++)e[a]!==u&&(i=a,u=e[a]);if(e[a]!==u&&(i=a),t===e[a])n=r?i/(o-1):(a+1)/(o+1);else if(0===i)n=0;else{var s=(t-e[i-1])/(e[i]-e[i-1]);n=r?(i-1+s)/(o-1):(i+s)/(o+1)}}else n=r?0:1/(o+1);return n}(a,t,n);return 0!==i?Math.floor(i*Uu(10,r))/Uu(10,r):i}Is.ORIGIN=function(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(Array.isArray(n))n=(n=gn(n)).filter((function(e){return"number"==typeof e})),e.push(n);else{var a=et._astNodes[t];if(n=Dn(n,a),ht(a)&&"number"!=typeof n)continue;if(n=Number(n),isNaN(n))return Ut.value;e.push([n])}}var o,i,u,s,l,c,f=0,d=0,h=0,m=0,g=[];for(u=0;u<Lu(e);u++)for(c=e[u],g.push(c),s=0;s<Lu(c);s++)(l=c[s])!==Qn&&(f+=l,d+=l*l,m++);if(m<=2)return Ut.div0;if(o=f/m,0===(i=Bu((m*d-f*f)/(m*(m-1)))))return Ut.div0;for(u=0;u<Lu(g);u++)for(c=g[u],s=0;s<Lu(c);s++)(l=c[s])!==Qn&&(h+=Uu((l-o)/i,3));return Kn(m*h/((m-1)*(m-2)))},Is.P=function(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(Array.isArray(n))n=(n=gn(n)).filter((function(e){return"number"==typeof e})),e.push(n);else{var a=et._astNodes[t];if(n=Dn(n,a),ht(a)&&"number"!=typeof n)continue;if(n=$n(n),isNaN(n))return Ut.value;e.push([n])}}var o,i,u,s,l,c,f=0,d=0,h=[];for(u=0;u<Lu(e);u++){if(c=e[u],1===Lu(e)&&0===Lu(c))return Ut.null;for(s=0;s<Lu(c);s++){var m={value:0};(l=c[s])!==Qn&&"boolean"!=typeof l&&Zn(l,m)&&(f+=m.value,d++,h.push(m.value))}}if(d<=2)return Ut.div0;o=f/d;var g=0,p=0,v=0;for(u=0;u<h.length;u++)v=h[u]-o,p+=Uu(v,2),g+=Uu(v,3);return 0===(i=Bu(p/d))?Ut.div0:Kn(g/d/i/i/i)};var Os={INC:function(e,t,r){return bs(e,t,r,!0)},EXC:function(e,t,r){return bs(e,t,r,!1)}},Fs=[[8,"0131","0301","0331","0429","0528","0627","0726","0825","0924","1023","1122","1222","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0913","1012","1111","1211","1310"],[0,"0208","0310","0408","0508","0606","0705","0804","0902","1002","1031","1130","1230"],[5,"0129","0227","0329","0427","0527","0625","0724","0823","0921","1020","1119","1219","1317"],[0,"0216","0317","0416","0515","0614","0713","0811","0910","1009","1107","1207","1306"],[0,"0204","0306","0405","0504","0603","0703","0801","0830","0929","1028","1127","1226"],[4,"0125","0223","0325","0424","0523","0622","0721","0820","0918","1018","1116","1216","1314"],[0,"0213","0314","0413","0512","0611","0710","0809","0908","1007","1106","1205","1304"],[0,"0202","0303","0401","0430","0530","0629","0728","0827","0925","1025","1124","1223"],[2,"0122","0220","0322","0420","0519","0618","0717","0816","0914","1014","1113","1213","1311"],[0,"0210","0311","0410","0509","0607","0707","0805","0904","1003","1102","1202","1301"],[6,"0130","0301","0330","0429","0528","0626","0726","0824","0922","1022","1121","1220","1319"],[0,"0218","0319","0417","0517","0615","0714","0813","0911","1010","1109","1209","1307"],[0,"0206","0308","0407","0506","0605","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0225","0327","0425","0525","0623","0723","0821","0920","1019","1117","1217","1315"],[0,"0214","0316","0414","0514","0613","0712","0811","0909","1009","1107","1207","1305"],[0,"0203","0304","0403","0502","0601","0630","0730","0829","0927","1027","1125","1225"],[2,"0123","0222","0323","0421","0521","0619","0719","0818","0916","1016","1115","1214","1313"],[0,"0211","0313","0411","0510","0609","0708","0807","0905","1005","1104","1203","1302"],[7,"0201","0302","0401","0430","0529","0628","0727","0825","0924","1024","1122","1222","1321"],[0,"0220","0320","0419","0518","0616","0716","0814","0912","1012","1110","1210","1309"],[0,"0208","0310","0408","0508","0606","0705","0804","0902","1001","1031","1129","1229"],[5,"0128","0227","0328","0427","0527","0625","0724","0823","0921","1020","1119","1218","1317"],[0,"0216","0317","0416","0516","0614","0714","0812","0911","1010","1108","1208","1306"],[0,"0205","0305","0404","0504","0602","0702","0801","0830","0929","1028","1127","1226"],[4,"0124","0223","0324","0423","0522","0621","0721","0819","0918","1018","1116","1216","1314"],[0,"0213","0314","0412","0512","0610","0710","0808","0907","1007","1105","1205","1304"],[0,"0202","0304","0402","0501","0531","0629","0729","0827","0926","1025","1124","1224"],[2,"0123","0221","0322","0420","0519","0618","0717","0815","0914","1013","1112","1212","1311"],[0,"0210","0311","0410","0509","0607","0707","0805","0903","1003","1101","1201","1231"],[6,"0130","0228","0330","0429","0528","0626","0726","0824","0922","1022","1120","1220","1319"],[0,"0217","0319","0418","0517","0616","0715","0814","0912","1011","1110","1209","1308"],[0,"0206","0307","0406","0506","0604","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0224","0326","0425","0524","0623","0722","0821","0920","1019","1118","1217","1315"],[0,"0214","0315","0414","0513","0612","0712","0810","0909","1008","1107","1207","1305"],[0,"0204","0305","0403","0503","0601","0701","0730","0829","0928","1027","1126","1226"],[3,"0124","0223","0323","0421","0521","0619","0718","0817","0916","1015","1114","1214","1313"],[0,"0211","0313","0411","0510","0609","0708","0806","0905","1004","1103","1203","1302"],[7,"0131","0302","0401","0430","0529","0628","0727","0825","0924","1023","1122","1222","1320"],[0,"0219","0321","0420","0519","0617","0717","0815","0913","1013","1111","1211","1309"],[0,"0208","0309","0408","0507","0606","0705","0804","0902","1001","1031","1129","1229"],[6,"0127","0226","0328","0426","0526","0625","0724","0823","0921","1020","1119","1218","1317"],[0,"0215","0317","0415","0515","0614","0713","0812","0910","1010","1108","1208","1306"],[0,"0205","0306","0405","0504","0603","0702","0801","0831","0929","1029","1127","1227"],[4,"0125","0224","0324","0423","0522","0621","0720","0819","0917","1017","1116","1215","1314"],[0,"0213","0314","0412","0512","0610","0709","0808","0906","1006","1105","1205","1303"],[0,"0202","0304","0402","0501","0531","0629","0728","0827","0925","1025","1124","1223"],[2,"0122","0221","0323","0421","0520","0619","0718","0816","0915","1014","1113","1212","1311"],[0,"0210","0311","0409","0509","0607","0707","0805","0903","1003","1101","1201","1230"],[7,"0129","0228","0329","0428","0528","0626","0726","0824","0922","1022","1120","1220","1318"],[0,"0217","0318","0417","0517","0615","0715","0814","0912","1011","1110","1209","1308"],[0,"0206","0308","0406","0506","0605","0704","0803","0901","1001","1030","1129","1228"],[5,"0127","0225","0326","0424","0524","0622","0722","0820","0919","1019","1117","1217","1315"],[0,"0214","0315","0414","0513","0611","0711","0810","0908","1008","1107","1206","1305"],[0,"0203","0305","0403","0503","0601","0630","0730","0828","0927","1027","1126","1225"],[3,"0124","0222","0324","0422","0522","0620","0719","0818","0916","1016","1114","1214","1313"],[0,"0212","0312","0411","0510","0609","0708","0806","0905","1004","1103","1203","1301"],[8,"0131","0302","0331","0430","0529","0628","0727","0825","0924","1023","1122","1221","1320"],[0,"0218","0320","0419","0519","0617","0717","0815","0913","1013","1111","1211","1309"],[0,"0208","0309","0408","0508","0606","0706","0804","0903","1002","1101","1130","1230"],[6,"0128","0227","0327","0426","0525","0624","0724","0822","0921","1020","1119","1218","1317"],[0,"0215","0317","0415","0515","0613","0713","0811","0910","1010","1108","1208","1306"],[0,"0205","0306","0405","0504","0602","0702","0731","0830","0929","1028","1127","1227"],[4,"0125","0224","0325","0424","0523","0621","0721","0819","0918","1017","1116","1216","1315"],[0,"0213","0314","0412","0512","0610","0709","0808","0906","1006","1104","1204","1303"],[0,"0202","0303","0402","0501","0531","0629","0728","0827","0925","1024","1123","1223"],[3,"0121","0220","0322","0421","0520","0619","0718","0816","0915","1014","1112","1212","1311"],[0,"0209","0311","0410","0509","0608","0708","0806","0904","1004","1102","1202","1231"],[7,"0130","0228","0329","0427","0527","0626","0725","0824","0922","1022","1120","1220","1318"],[0,"0217","0318","0417","0516","0615","0714","0813","0912","1011","1110","1209","1308"],[0,"0206","0308","0406","0505","0604","0703","0802","0901","0930","1030","1129","1228"],[5,"0127","0225","0327","0425","0524","0623","0722","0821","0919","1019","1118","1218","1316"],[0,"0215","0315","0414","0513","0611","0711","0809","0908","1007","1106","1206","1304"],[0,"0203","0305","0403","0503","0601","0630","0730","0828","0926","1026","1125","1224"],[4,"0123","0222","0324","0422","0522","0620","0719","0818","0916","1015","1114","1214","1312"],[0,"0211","0313","0412","0511","0610","0709","0807","0906","1005","1103","1203","1301"],[8,"0131","0301","0331","0429","0529","0627","0727","0825","0924","1023","1121","1221","1319"],[0,"0218","0320","0418","0518","0617","0716","0815","0913","1013","1111","1211","1309"],[0,"0207","0309","0407","0507","0606","0705","0804","0902","1002","1101","1130","1230"],[6,"0128","0227","0328","0426","0526","0624","0724","0823","0921","1021","1120","1219","1318"],[0,"0216","0317","0415","0514","0613","0712","0811","0909","1009","1108","1207","1306"],[0,"0205","0306","0405","0504","0602","0702","0731","0829","0928","1028","1126","1226"],[4,"0125","0224","0325","0424","0523","0621","0721","0819","0917","1017","1115","1215","1314"],[0,"0213","0315","0413","0513","0611","0710","0809","0907","1006","1105","1204","1303"],[10,"0202","0303","0401","0501","0531","0629","0728","0827","0925","1024","1123","1222","1321"],[0,"0220","0321","0420","0520","0618","0718","0816","0915","1014","1112","1212","1310"],[0,"0209","0310","0409","0509","0607","0707","0806","0904","1004","1102","1202","1231"],[6,"0129","0228","0329","0428","0527","0626","0726","0824","0923","1023","1121","1221","1319"],[0,"0217","0318","0416","0516","0614","0714","0812","0911","1011","1109","1209","1308"],[0,"0206","0308","0406","0505","0604","0703","0802","0831","0930","1029","1128","1228"],[5,"0127","0225","0327","0425","0524","0623","0722","0820","0919","1018","1117","1217","1316"],[0,"0215","0316","0415","0514","0612","0712","0810","0908","1008","1106","1206","1305"],[0,"0204","0304","0403","0503","0601","0630","0730","0828","0926","1026","1124","1224"],[3,"0123","0221","0323","0422","0521","0620","0719","0818","0916","1015","1114","1213","1312"],[0,"0210","0312","0411","0511","0609","0709","0807","0906","1005","1103","1203","1301"],[8,"0131","0301","0331","0430","0529","0628","0727","0826","0925","1024","1122","1222","1320"],[0,"0219","0319","0418","0517","0616","0715","0814","0912","1012","1111","1211","1309"],[0,"0207","0309","0407","0507","0605","0705","0803","0902","1002","1031","1130","1230"],[5,"0128","0227","0328","0426","0526","0624","0723","0822","0921","1020","1119","1219","1317"],[0,"0216","0318","0416","0515","0614","0713","0811","0910","1009","1108","1208","1307"],[0,"0205","0306","0405","0504","0602","0702","0731","0829","0928","1027","1126","1226"],[4,"0124","0223","0325","0423","0523","0621","0721","0819","0917","1017","1115","1215","1313"],[0,"0212","0314","0413","0512","0611","0710","0809","0907","1006","1105","1204","1303"],[0,"0201","0303","0402","0501","0531","0630","0729","0828","0926","1025","1124","1223"],[2,"0122","0220","0321","0419","0519","0618","0717","0816","0914","1014","1112","1212","1310"],[0,"0209","0310","0409","0508","0607","0706","0805","0904","1003","1102","1201","1231"],[7,"0129","0228","0329","0428","0527","0626","0725","0824","0922","1022","1121","1220","1319"],[0,"0218","0319","0417","0517","0615","0714","0813","0911","1011","1110","1210","1308"],[0,"0207","0308","0406","0505","0604","0703","0801","0831","0929","1029","1128","1227"],[5,"0126","0225","0327","0425","0524","0623","0722","0820","0919","1018","1117","1216","1315"],[0,"0214","0316","0414","0514","0612","0712","0810","0908","1008","1106","1206","1304"],[0,"0203","0305","0403","0503","0602","0701","0731","0829","0927","1027","1125","1225"],[4,"0123","0222","0322","0421","0521","0619","0719","0817","0916","1015","1114","1213","1312"],[0,"0210","0312","0410","0510","0608","0708","0807","0905","1005","1103","1203","1301"],[9,"0131","0301","0331","0429","0529","0627","0727","0825","0924","1024","1122","1222","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0913","1013","1112","1211","1310"],[0,"0208","0309","0407","0507","0605","0704","0803","0901","1001","1031","1129","1229"],[6,"0128","0226","0328","0426","0526","0624","0723","0822","0920","1020","1118","1218","1317"],[0,"0216","0317","0416","0515","0614","0713","0811","0910","1009","1108","1207","1306"],[0,"0205","0307","0405","0505","0603","0703","0801","0830","0929","1028","1126","1226"],[4,"0125","0223","0324","0423","0523","0621","0721","0819","0917","1017","1115","1215","1313"],[0,"0212","0313","0412","0512","0610","0710","0808","0907","1006","1105","1204","1303"],[0,"0201","0303","0401","0501","0530","0629","0729","0827","0926","1025","1124","1223"],[2,"0122","0220","0322","0420","0519","0618","0718","0816","0915","1015","1113","1213","1311"],[0,"0210","0310","0409","0508","0606","0706","0804","0903","1003","1101","1201","1231"],[6,"0129","0228","0329","0428","0527","0625","0725","0823","0922","1021","1120","1220","1319"],[0,"0217","0319","0417","0517","0615","0714","0813","0911","1010","1109","1209","1308"],[0,"0206","0308","0407","0506","0605","0704","0802","0901","0930","1029","1128","1228"],[5,"0126","0225","0326","0425","0524","0623","0722","0820","0919","1018","1116","1216","1315"],[0,"0213","0315","0414","0513","0612","0711","0810","0908","1008","1106","1205","1304"],[0,"0203","0304","0403","0502","0601","0701","0730","0829","0927","1027","1125","1225"],[3,"0123","0221","0323","0422","0521","0620","0719","0818","0917","1016","1115","1214","1313"],[0,"0211","0312","0410","0509","0608","0707","0806","0905","1004","1103","1203","1301"],[7,"0131","0301","0331","0429","0528","0627","0726","0825","0923","1023","1122","1222","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0913","1012","1111","1211","1309"],[0,"0208","0310","0408","0508","0606","0705","0804","0902","1001","1031","1130","1229"],[6,"0128","0227","0328","0426","0526","0624","0723","0822","0920","1019","1118","1217","1316"],[0,"0215","0317","0416","0515","0614","0713","0811","0910","1009","1107","1207","1305"],[0,"0204","0306","0405","0504","0603","0702","0801","0830","0929","1028","1126","1226"],[5,"0124","0223","0325","0423","0523","0622","0721","0820","0918","1018","1116","1216","1314"],[0,"0212","0313","0411","0511","0610","0709","0808","0906","1006","1105","1204","1303"],[0,"0201","0302","0401","0430","0530","0628","0728","0827","0925","1025","1124","1223"],[2,"0122","0220","0322","0420","0519","0618","0717","0816","0914","1014","1113","1212","1311"],[0,"0210","0311","0410","0509","0607","0707","0805","0903","1003","1102","1201","1231"],[7,"0130","0229","0329","0428","0527","0625","0725","0823","0921","1021","1119","1219","1318"],[0,"0217","0319","0417","0517","0615","0714","0813","0911","1010","1109","1208","1307"],[0,"0206","0308","0406","0506","0604","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0225","0326","0425","0525","0623","0723","0821","0920","1019","1117","1217","1315"],[0,"0214","0314","0413","0513","0611","0711","0810","0908","1008","1106","1205","1304"],[0,"0202","0304","0402","0502","0531","0630","0730","0828","0927","1027","1125","1225"],[3,"0123","0221","0323","0421","0521","0619","0719","0817","0916","1016","1114","1214","1313"],[0,"0211","0313","0411","0510","0609","0708","0806","0905","1005","1103","1203","1302"],[8,"0201","0301","0331","0429","0528","0627","0726","0824","0923","1022","1121","1221","1320"],[0,"0219","0320","0419","0518","0616","0716","0814","0912","1012","1110","1210","1309"],[0,"0208","0309","0408","0508","0606","0705","0804","0902","1001","1031","1129","1229"],[6,"0128","0226","0328","0427","0526","0625","0724","0823","0921","1020","1119","1218","1317"],[0,"0215","0316","0415","0515","0613","0713","0811","0910","1009","1107","1207","1305"],[0,"0204","0305","0404","0504","0602","0702","0731","0830","0929","1028","1126","1226"],[4,"0124","0223","0324","0423","0522","0621","0720","0819","0918","1017","1116","1216","1314"],[0,"0212","0314","0412","0512","0610","0710","0808","0907","1006","1105","1205","1304"],[0,"0202","0303","0401","0501","0530","0628","0727","0826","0924","1024","1123","1223"],[3,"0121","0220","0322","0420","0519","0618","0717","0815","0914","1013","1112","1212","1311"],[0,"0209","0311","0410","0509","0607","0707","0805","0903","1003","1101","1201","1231"],[7,"0129","0228","0330","0428","0528","0626","0726","0824","0922","1022","1120","1220","1318"],[0,"0217","0318","0417","0516","0615","0714","0813","0911","1010","1109","1208","1307"],[0,"0205","0307","0406","0505","0604","0704","0802","0901","0930","1029","1128","1227"],[5,"0126","0224","0326","0424","0524","0623","0722","0821","0919","1019","1117","1217","1315"],[0,"0214","0315","0414","0513","0612","0711","0810","0909","1008","1107","1206","1305"],[0,"0203","0304","0402","0502","0531","0629","0729","0828","0926","1026","1125","1224"],[4,"0123","0221","0323","0421","0521","0619","0718","0817","0915","1015","1114","1214","1312"],[0,"0211","0312","0411","0510","0609","0708","0806","0905","1004","1103","1203","1301"],[8,"0131","0302","0331","0430","0529","0628","0727","0825","0924","1023","1122","1221","1320"],[0,"0219","0320","0418","0518","0616","0716","0814","0912","1012","1110","1210","1308"],[0,"0207","0309","0407","0507","0605","0704","0803","0901","0930","1030","1128","1228"],[6,"0126","0225","0326","0425","0525","0623","0723","0821","0920","1019","1118","1217","1316"],[0,"0214","0316","0414","0514","0612","0712","0811","0909","1009","1107","1207","1305"],[0,"0204","0304","0403","0502","0601","0630","0730","0828","0927","1027","1125","1225"],[0,"0123","0222","0323","0422","0521","0620","0719","0818","0917","1017","1115","1215"],[0,"0113","0212","0313","0412","0511","0609","0709","0807","0906","1006","1104","1204"],[0,"0103","0201","0303","0401","0501","0530","0628","0728","0826","0925","1024","1123"],[3,"1223","0122","0220","0321","0419","0519","0617","0716","0815","0913","1012","1111","1211"],[0,"0110","0208","0310","0409","0508","0607","0706","0804","0903","1002","1031","1130"],[7,"1230","0128","0227","0329","0428","0527","0625","0725","0823","0922","1021","1119","1219"],[0,"0118","0216","0318","0417","0516","0615","0714","0813","0911","1011","1109","1209"],[0,"0107","0206","0306","0405","0504","0603","0703","0801","0831","0929","1029","1127"],[5,"1227","0125","0224","0325","0423","0523","0622","0721","0820","0919","1018","1117","1216"],[0,"0115","0213","0315","0413","0512","0611","0710","0809","0908","1007","1106","1206"],[0,"0104","0203","0304","0403","0502","0531","0630","0729","0828","0926","1026","1125"],[4,"1225","0123","0222","0322","0421","0520","0618","0718","0816","0914","1014","1113","1213"],[0,"0111","0210","0312","0410","0510","0608","0707","0806","0904","1003","1102","1202"],[8,"1231","0130","0301","0331","0429","0529","0627","0726","0825","0923","1022","1121","1221"],[0,"0119","0218","0320","0418","0518","0616","0716","0814","0913","1012","1110","1210"],[0,"0108","0207","0308","0406","0506","0605","0704","0803","0901","1001","1030","1129"],[6,"1228","0126","0225","0327","0425","0525","0623","0723","0822","0920","1020","1118","1218"],[0,"0116","0214","0316","0414","0514","0612","0712","0811","0909","1009","1108","1207"],[0,"0106","0204","0306","0404","0503","0602","0701","0731","0829","0928","1028","1127"],[4,"1226","0125","0223","0324","0422","0521","0620","0719","0817","0916","1016","1115","1214"],[0,"0113","0212","0313","0412","0511","0609","0709","0807","0905","1005","1104","1203"],[0,"0102","0201","0303","0401","0501","0530","0628","0727","0826","0924","1024","1122"],[2,"1222","0121","0220","0321","0420","0520","0618","0717","0816","0914","1013","1112","1211"]],Ls=1900,Us={},Bs=function(e,t,r){var n=e.getTime()-t.getTime();switch(r){case"y":return parseInt(e.getFullYear()-t.getFullYear());case"M":return parseInt(12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth()));case"d":return Math.ceil(n/1e3/60/60/24);case"w":return Math.floor(n/1e3/60/60/24/7);case"h":return Math.floor(n/1e3/60/60);case"m":return Math.floor(n/1e3/60);case"s":return Math.floor(n/1e3);case"ms":return parseInt(n)}},ks=function(e,t,r,n,a){var o=Fs[t];if(!o)return!1;for(var i,u,s,l=e.getFullYear(),c=e.getMonth()+1,f=e.getDate(),d=l,h=o.length-1;h>0;h--){i=h;var m=Number(o[h].substring(0,2)),g=Number(o[h].substring(2,4));if(u=(s=a&&m>12?m-12:m)<c||s==c&&g<=f||(m<=r||m>=n)&&a,12==s&&s>c&&1==h&&(u=!0,l--),u)break}return!!u&&(a&&12==m&&(l-=1),{year:l,month:s,day:g,lunarYear:d=a?d-1:d,lunarMonth:i,leapMonth:o[0]})},Ps=function(e,t,r){return"M"==r?Us.monthAdd(e,t):(Us.lunarToSolar(e),Us.solarToLunar(void 0))};Us.dateAdd=function(e,t){for(var r=function(e){for(var t=e.match(/[+-]?\d+((ms)|[yMdhmsw])/g),r=[],n=0;n<t.length;n++){if(/([+-])(\d+)(.+)/.test(t[n])){var a=parseInt(RegExp.$2);"-"===RegExp.$1&&(a=-a),r.push({value:a,unit:RegExp.$3})}return r}}(t),n=0;n<r.length;n++)e=Ps(e,r[n]);return e},Us.dateDiff=function(e,t,r){if("M"==r)return Us.monthDiff(e,t);var n=Us.lunarToSolar(e),a=Us.lunarToSolar(t);return Bs(a,n,r)},Us.monthAdd=function(e,t){if(e instanceof Date&&(e=Us.solarToLunar(e)),0==t)return e;var r,n=e.year,a=e.month;(e.leap||e.leapMonth>0&&e.month>e.leapMonth)&&a++;var o=!0;do{(t=t+a-(r=Us.monthsOfYear(n)))<=0?(o=!1,a=n==e.year?r+t:r+t-a):(n++,a=1)}while(o);var i=Us.leapMonthOfYear(n),u=!1;return i>0&&a>i&&(u=--a==i),{year:n,month:a,leap:u,leapMonth:i}},Us.monthDiff=function(e,t){var r=0;if(e instanceof Date&&(e=Us.solarToLunar(e)),t instanceof Date&&(t=Us.solarToLunar(t)),e.year==t.year)r=t.month-e.month,e.leapMonth>=e.month&&e.leapMonth<=t.month&&r++;else{r=12,(e.leapMonth>e.month||e.leapMonth==e.month&&!e.isLeaMonth)&&(r+=1),r-=e.month;for(var n=e.year+1,a=n;a<t.year;a++)r+=Us.monthsOfYear(n++);r+=t.month,(t.isLeapMonth||t.month<t.leapMonth)&&r++}return r},Us.daysOfMonth=function(e,t,r){"object"==typeof e&&(t=e.month,r=e.leap,e=e.year);var n=Us.lunarToSolar(e,t,1,r);Us.leapMonthOfYear(e)!=t||r?12==t?(e++,t=1):(r=!1,t++):r=!0;var a=Us.lunarToSolar(e,t,1,r);return Us.dateDiff(a,n,"d")},Us.monthsOfYear=function(e){return Fs[e-Ls].length-1},Us.leapMonthOfYear=function(e){var t=Fs[e-Ls];return t?t[0]:0},Us.lunarToSolar=function(e,t,r,n){var a=arguments[0];"object"==typeof a&&1==arguments.length&&(e=a.year,t=a.month,r=a.day,n=a.leap);var o=e-Ls;if(o<0||o>Fs.length)throw new Error("Specified date range is invalid.");var i=Fs[o][0];(n&&t==i||i>0&&t>i)&&(t+=1);var u=Fs[o][t],s=Number(u.substring(0,2)),l=Number(u.substring(2,4));s>12&&(e+=1,s-=12);var c=new Date(e,s-1,l),f=c.getTime()+24*(r-1)*60*60*1e3;return new Date(f)},Us.solarToLunar=function(e,t){var r=e.getFullYear()-Ls;if(r<=0||r>=Fs.length)throw new Error("Specified date range is invalid.");var n=ks(e,r,0,13,!1);if(!(n=n||ks(e,r-1,12,99,!0)))return!1;var a=new Date(n.year,n.month-1,n.day),o=Bs(e,a,"d")+1,i={leap:n.leapMonth>0&&n.leapMonth+1==n.lunarMonth,year:n.lunarYear,month:n.leapMonth>0&&n.lunarMonth>n.leapMonth?n.lunarMonth-1:n.lunarMonth,day:o,leapMonth:n.leapMonth};return t&&i?Us.format(i,t):i},Us.traditionalYearName=function(e){var t=yr.default.t("甲乙丙丁戊己庚辛壬癸").split(""),r=yr.default.t("子丑寅卯辰巳午未申酉戌亥").split("");return t[(e=e-Ls+36)%10]+r[e%12]+yr.default.t("年")},Us.yearName=function(e){for(var t=yr.default.t("〇,一,二,三,四,五,六,七,八,九").split(","),r=e.toString(),n="",a=0;a<r.length;a++)n+=t[parseInt(r.charAt(a))];return n+yr.default.t("年")},Us.animalName=function(e){return yr.default.t("鼠牛虎兔龙蛇马羊猴鸡狗猪").split("")[(e-4)%12]},Us.monthName=function(e,t,r){var n=yr.default.t("正,二,三,四,五,六,七,八,九,十,十一,十二").split(",");return t&&(n[11]=yr.default.t("腊")),(r?yr.default.t("闰"):"")+n[e-1]+yr.default.t("月")},Us.dayName=function(e){switch(e){case 10:return yr.default.t("初十");case 20:return yr.default.t("二十");case 30:return yr.default.t("三十");default:return yr.default.t("初十廿卅").split("")[Math.floor(e/10)]+yr.default.t("一二三四五六七八九十").split("")[(e-1)%10]||e}},Us.format=function(e,t){return t.replace(/[TAYyMmdD]/g,(function(t,r){switch(t){case"T":return Us.traditionalYearName(e.year);case"A":return Us.animalName(e.year);case"Y":return Us.yearName(e.year);case"y":return e.year;case"m":return Us.monthName(e.month,!1,e.leap);case"M":return Us.monthName(e.month,!0,e.leap);case"d":return Us.dayName(e.day);case"D":return 1==e.day?Us.monthName(e.month,!1,e.leap):Us.dayName(e.day)}}))};var Hs=Us,Gs=function(e,t,r){var n=new Date(e,t-1,r).getUTCDay();return{0:yr.default.t("星期一"),1:yr.default.t("星期二"),2:yr.default.t("星期三"),3:yr.default.t("星期四"),4:yr.default.t("星期五"),5:yr.default.t("星期六"),6:yr.default.t("星期天")}[n]},Ys=function(e,t){var r=yr.default.t("摩羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手摩羯"),n=2*e-(t<[20,19,21,21,21,22,23,23,23,23,22,22][e-1]?2:0);return r.substring(n,n+2)+yr.default.t("座")};function Vs(e){e=e.toString();for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],r=0,n=0;n<17;n++)r+=e[n]*t[n];return[1,0,"X",9,8,7,6,5,4,3,2][r%11]}function $s(e){var t,r,n,a,o,i;return i="TIME_ERROR"!=(o=function(e){e=(e=e.split(/\/|\\|-/))[0]+"-"+e[1]+"-"+e[2];var t=new Date(e);try{var r=Hs.solarToLunar(t);return r.year+"-"+r.month+"-"+r.day}catch(e){return"TIME_ERROR"}}(t=(a=(e=e.toString()).substr(6,4))+"-"+(r=e.substr(10,2))+"-"+(n=e.substr(12,2))))?function(e){return(e=e%12-4)<0&&(e+=12),yr.default.t("鼠牛虎兔龙蛇马羊猴鸡狗猪")[e]}(o.substr(0,4)):null,{date:t,nong:o,year:a,month:r,day:n,week:Gs(a,r,n),zodiac:Ys(r,n),zodiac_zh:i}}function js(e){return e=e.toString(),!(!/^\d{17}(\d|x)$/i.test(e)||Vs(e)!=e[17].toUpperCase())}function Zs(e){if(e=e.toString(),/(^\d{15}$)/.test(e))return function(e){return e=e.toString(),/(^\d{17}$)/.test(e)?e+Vs(e):/(^\d{18}$)/.test(e)?e.slice(0,17)+Vs(e):void 0}(e.slice(0,6)+"19"+e.slice(6,15))}var Ws=null,Xs=va._pow10,Ks=va._approxFloor,qs=va._approxCeiling,zs=ra.Z._getLength,Js=Math.abs,Qs=Math.sqrt,el=Math.floor,tl=Math.exp,rl=Math.log,nl=Math.PI,al=Math.random;function ol(e){if(_n(e))throw new Error(e);if(_n(e=Mn(e||0)))throw new Error(e);return Math.abs(e)}function il(e,t,r){var n;return"&"===r&&(n=Array.isArray(e)&&Array.isArray(t)?e.map((function(e,r){var n=null===t||void 0===t?void 0:t[r];return e.map((function(e,t){return e.map((function(e,r){var a,o,i,u;return null===e&&null===(null===(a=null===n||void 0===n?void 0:n[t])||void 0===a?void 0:a[r])?"":(0,vr.o8)(e)||(0,vr.o8)(null===(o=null===n||void 0===n?void 0:n[t])||void 0===o?void 0:o[r])?Ut.na:e.toString()+(null===(u=null===(i=null===n||void 0===n?void 0:n[t])||void 0===i?void 0:i[r])||void 0===u?void 0:u.toString())}))}))})):Array.isArray(e)&&!Array.isArray(t)?e.map((function(e){return e.map((function(e){return e.map((function(e){return null===e?t.toString():e.toString()+t.toString()}))}))})):Array.isArray(t)&&!Array.isArray(e)?t.map((function(t){return t.map((function(t){return t.map((function(t){return null===t?e.toString():e.toString()+t.toString()}))}))})):e.toString()+t.toString()),n}function ul(e){var t=e;return ft(t)&&((t=t.toArray()).error&&t.error.length?t=new Error(t.error[0]):null===(t=t[0])?t=0:t===Ut.ref&&(t=new Error(Ut.ref))),t}function sl(e){var t=e;if("string"==typeof t&&""!==t){var r=Number(t).valueOf();if(isNaN(r)){var n=wr(t);t=n?n.numericValue:t}else t=r}return t}function ll(e,t,r){var n,a,o=[e,t].map(ul),i=o[0],u=o[1],s=[i,u].find((function(e){return e instanceof Error}));if(s)throw s;if(n=[i,u].map(sl),i=n[0],u=n[1],i=Cn(i),u=Cn(u),isNaN(i)||isNaN(u)||""===i||""===u){if(i&&"="===i[0]||u&&"="===u[0])throw new Error(Ut.needUpdate);throw new Error(Ut.value)}switch(r){case"+":a=Ml(i,u);break;case"-":a=Rl(i,u);break;case"/":a=El(i,u);break;case"*":a=_l(i,u);break;case"^":a=wl(i,u)}return a}function cl(e,t,r){if(To(e))return e;if(To(t))return t;var n;switch("TRUE"===e&&(e=!0),"TRUE"===t&&(t=!0),"FALSE"===e&&(e=!1),"FALSE"===t&&(t=!1),null!==e||0!==t&&""!==t||(e=t),null!==t||0!==e&&""!==e||(t=e),r){case"=":"string"==typeof e&&"string"==typeof t&&(e=e.toUpperCase(),t=t.toUpperCase()),n=e===t;break;case">":n=1===Tn(e,t);break;case"<":n=-1===Tn(e,t);break;case">=":n=Tn(e,t)>-1;break;case"<=":n=Tn(e,t)<1;break;case"<>":case"NOT":"string"==typeof e&&"string"==typeof t&&(e=e.toUpperCase(),t=t.toUpperCase()),n=e!==t}return n}function fl(e,t){return h(this,void 0,void 0,c().mark((function r(){var n;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=et._funcNode,r.abrupt("return",new Promise((function(r){!function(e,t,r){var n=e,a={error:"#ERROR!",result:"#ERROR!",currencyFormat:""},o=(n=n.toString()).split("."),i=o[o.length-1]||"",u=i=i.toLowerCase(),s=o.slice(0,o.length-1).join(".")||"",l=i+s;-1!==["sh","sz","bj","ft"].indexOf(i)&&(i=""),function(e){var t=Gt.get(e);if(t)return t;var r=Te().get(e).then((function(t){return Gt.delete(e),t})).catch((function(t){return Gt.delete(e),t}));return Gt.set(e,r),r}(i?"/ifzq/appstock/app/"+i+"fqkline/get?param="+l+",day,,,3,qfq":"/ifzq/appstock/app/newfqkline/get?param="+l+",day,,,3,qfq").then((function(e){var n=e.headers.date,o=e.data,i=n;try{var c=function(e,t){if(void 0===t&&(t=!0),!e&&t)return new Date;var r=Ht(e.getMonth()+1),n=Ht(e.getDate());return[e.getFullYear(),r,n].join("-")}(i=i?new Date(i):new Date),f=o.data[l],d=f&&(f.qfqday||f.day),h=[];if(d&&d.length>=2&&(d.forEach((function(e){e[0]!==c&&h.push(e)})),h.length>1)){var m=h[h.length-1],g=h[h.length-2],p=m[2]-g[2],v=p/g[2],y="";switch(u){case"bj":case"sh":case"sz":y='"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)',/^(900)|^(20(0|1))/.test(s)&&(y="[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)");break;case"hk":y="[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)";break;case"us":y="\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)";break;default:y="General"}var N={lastClosePrice:Number(m[2]),company:f.qt[l][1],risingPrice:Number(p),risingRate:v,todayOpenDay:Number(m[1]),todayHighestPrice:Number(m[3]),todayLowestPrice:Number(m[4]),todayVolume:Number.parseInt(m[5],10),realTimePrice:Number(d[d.length-1][2])},M=[N.lastClosePrice,N.company,N.risingPrice,N.risingRate,N.todayOpenDay,N.todayHighestPrice,N.todayLowestPrice,N.todayVolume,N.realTimePrice];void 0!==M[t]&&(a={error:null,result:M[t],currencyFormat:"General"},[0,2,4,5,6,8].includes(t)&&(a.currencyFormat=y),3===t&&"string"!=typeof N.risingRate&&(a.currencyFormat="0.00%"))}}catch(n){console.error("get stock data error!")}r(a)})).catch((function(){r(a)}))}(e,t,(function(e){e.error?r(e.error):(n.setFormatType(e.currencyFormat),r(e.result))}))})));case 2:case"end":return r.stop()}}),r)})))}function dl(e,t){if(arguments.length<1)throw new Error(Ut.value);return parseInt(e,t)}function hl(e){return e=Dn(e,et._astNodes[0]),isNaN(e)?Ut.value:"number"!=typeof(e=Mn(e||0))?e:Math.floor(e)}function ml(e,t){var r=et._astNodes,n=Mn(e),a=r[0];if(_n(n)&&(""!==e||!dt(a)))throw new Error(Ut.value);var o=r[1],i=null===t?0:Mn(t);if(_n(i)&&(""!==t||!dt(o)))throw new Error(Ut.value);if(0===i||dt(o)&&""===o.value)throw new Error(Ut.div0);return n-i*hl(n/i)}function gl(){if(arguments.length>0)throw new Error(Ut.error);return Math.random()}function pl(e,t){return e=Mn(e||0),"number"==typeof(t=Mn(t||0))&&(t=Math.floor(t)),_n(e)?e:_n(t)?t:va._round(e,t)}function vl(e,t){return Zl.call(this,!0,e,t)}function yl(e){if(_n(e=Mn(e||0)))return e;if(e<0)throw new Error(Ut.num);return Math.sqrt(e)}function Nl(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Mn(t[0]);if(n<1||n>11&&n<101||n>111)throw new Error(Ut.value);if(_n(n))return n;var o,i=t.slice(1),u=[],s={},l=et._instance.custom.isCellHidden;if(i)for(var c=0;c<i.length;c++){var f=i[c];if(!ft(f))throw new Error(Ut.value);if(f.isCell){var d=f.identities[0];if(l(d.row,d.col,d.sheetId,n>100?"ALL":"FILTER"))continue;u.push(f)}else{u.push(f);for(var h=0;h<f.identities.length;h++)for(var m=f.identities[h],g=m.row;g<m.row+m.rowCount;g++)for(var p=m.col;p<m.col+m.colCount;p++)l(g,p,m.sheetId,n>100?"ALL":"FILTER")&&(s[h]=s[h]||{},s[h][g]=s[h][g]||{},s[h][g][p]=!0)}}else u=i;switch(s.isHiddenCells=!0,u.push(s),n){case 1:case 101:o=ku.apply(void 0,(0,a.Z)(u));break;case 2:case 102:o=Hu.apply(void 0,(0,a.Z)(u));break;case 3:case 103:o=Gu.apply(void 0,(0,a.Z)(u));break;case 4:case 104:o=qu.apply(void 0,(0,a.Z)(u));break;case 5:case 105:o=zu.apply(void 0,(0,a.Z)(u));break;case 6:case 106:o=oc.apply(void 0,(0,a.Z)(u));break;case 7:case 107:o=Ju.S.apply(Ju,(0,a.Z)(u));break;case 8:case 108:o=Ju.P.apply(Ju,(0,a.Z)(u));break;case 9:case 109:o=Fl.apply(void 0,(0,a.Z)(u));break;case 10:case 110:o=es.S.apply(es,(0,a.Z)(u));break;case 11:case 111:o=es.P.apply(es,(0,a.Z)(u))}return o}function Ml(e,t){return e+t}function Rl(e,t){return e-t}function El(e,t){return 0===t?Ut.div0:e/t}function _l(e,t){return e*t}function Tl(e,t){if(2!==arguments.length)throw new Error(Ut.na);if(_n(e=Mn(e),t=Mn(t)))throw new Error(Ut.error);return e>=t}function Sl(e,t){if(2!==arguments.length)throw new Error(Ut.na);if(_n(e=Mn(e),t=Mn(t)))throw new Error(Ut.error);return e<t}function Il(e,t){if(2!==arguments.length)throw new Error(Ut.na);if(_n(e=Mn(e),t=Mn(t)))throw new Error(Ut.error);return e<=t}function Cl(e,t){if(2!==arguments.length)throw new Error(Ut.na);return e===t}function Al(e,t){if(2!==arguments.length)throw new Error(Ut.na);return e!==t}function wl(e,t){return 0===e&&0===t?Ut.num:Math.pow(e,t)}function xl(e,t){return vt(et._astNodes[0])&&Array.isArray(e)?e[0][0][0]:Array.isArray(e)||So(e)?t:e}function Dl(e,t){var r=et._instance,n=r.helper.getCalcRef,a=et._element;if(!(e=void 0!==e?e:n([{sheetId:a.sheetId,row:a.row,col:a.col,refType:r.NODE_TYPE.CELL_RANGE_TYPE.CELL,rowCount:1,colCount:1}],!0))||!ft(e)||1!==e.getRangeCount())return kt(e)?e:Ut.value;var o=[[]],i=e.getRow(0)+1,u=e.getColumn(0)+1,s=e.getRowCount(0),l=e.getColumnCount(0),c=u,f=l;if(t&&(c=i,f=s),f>1){for(var d=0;d<f;d++)o[0].push([c+d]);return o.rangeCount=1,o.colCount=l,o.rowCount=s,o.error=[],o.row=i,o.col=u,o}return c}function bl(e){return Dl(e,!0)}function Ol(e){return Dl(e,!1)}function Fl(){var e,t=arguments;t[t.length-1].isHiddenCells&&"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&(e=t[t.length-1],t=Array.from(t).slice(0,-1));var r,n=0;for(r=0;r<t.length;r++){var a,o=t[r],i=void 0,u=!1;if(ft(o)){if(i=e&&e[r],(a=o.toArray()).error&&a.error.length>0)return a.error[0]}else if(Array.isArray(o)){if((a=zn(o)).error&&a.error.length>0)return a.error[0]}else u=!0,a=zn(o);for(var s=0;s<a.length;s++){if(i){var l=a.row+Math.floor(s/a.colCount),c=a.col+s%a.colCount;if(i[l]&&i[l][c])continue}var f=a[s];if("number"==typeof f)n+=f;else if(u&&"string"==typeof f){var d=parseFloat(f);if(isNaN(d))throw new Error(Ut.value);n+=d}else u&&"boolean"==typeof f&&(n+=Number(f))}}return n}function Ll(e){if(ft(e)){var t=et._instance.helper.getRangeValue,r=e.getIdentities(0);e=t({newLine:r.colCount},r)}var n,a,o,i,u,s,l,c,f,d,h,m,g,p,v,y,N=e.rowCount,M=[];if(e.rangeCount>1||N!==e.colCount)return Ut.value;for(n=0;n<N;n++)for(M[n]=[N],i=0;i<N;i++)M[n][i]=n===i?1:0;for(a=0;a<N;a++){if(0===e[a][a]){for(y=!1,u=a+1;!y&&u<N;u++)if(0!==e[u][a]){for(l=a;l<N;l++)p=e[a][l],e[a][l]=e[u][l],e[u][l]=p;for(c=1;c<N;c++)v=M[a][c],M[a][c]=M[u][c],M[u][c]=v;y=!0}if(!y)return Ut.num}for(s=0;s<N;s++)if(s!==a&&0!==e[s][a]){for(m=e[s][a]/e[a][a],f=a;f<N;f++)e[s][f]-=m*e[a][f];for(d=0;d<N;d++)M[s][d]-=m*M[a][d]}}for(o=0;o<N;o++)for(g=e[o][o],h=0;h<N;h++)M[o][h]/=g;return[M]}function Ul(e,t){var r=et._instance.helper.getRangeValue;if(ft(e)){var n=e.getIdentities(0);e=r({newLine:n.colCount},n)}if(ft(t)){var a=t.getIdentities(0);t=r({newLine:a.colCount},a)}var o,i,u,s,l,c,f=e.rowCount,d=e.colCount,h=t.rowCount,m=t.colCount,g=[];if(d!==h)return Ut.value;for(u=0;u<f;u++)for(g[u]=o=[],i=e[u],s=0;s<m;s++){for(c=0,l=0;l<h;l++)c+=i[l]*t[l][s];o[s]=c}return[g]}function Bl(e,t){var r,n,a,o,i,u,s=zn(e[0]),l=zs(s),c=s.rowCount,f=s.colCount,d=[],h=[],m=[];for(o=1;o<zs(e);o+=2){var g=1===(u=zn(e[o])).rowCount&&1===u.colCount&&!Rt(et._astNodes[o]);if(u.rowCount!==c||u.colCount!==f||g)return Ut.value;i=va._parseCriteria(e[o+1],!0),d.push(u),h.push(i)}for(a=0;a<l;a++){for(n=!0,o=0;o<zs(d)&&(i=h[o],r=d[o][a],n=i&&i(r));o++);n&&"number"==typeof(r=s[a])&&m.push(r)}return t(m)}function kl(){return Bl(arguments,(function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}))}function Pl(){return Bl(arguments,(function(e){var t=null;return e.length>0&&(t=Math.max.apply(null,e)),t}))}function Hl(){return Bl(arguments,(function(e){var t=null;return e.length>0&&(t=Math.min.apply(null,e)),t}))}function Gl(e,t,r){var n=et._instance.helper.getRangeValue;if(ft(t)&&(t=t.toArray()[0]),r=void 0!==r?r:e,!ft(e)||!ft(e))throw new Error(Ut.paramsErr);ea.Z._isNullOrUndefined(t)&&(t=0);var a,o=0,i=va._parseCriteria(t,!0),u=e.identities[0],s=r.identities[0],l={sheetId:s.sheetId,row:s.row,col:s.col,rowCount:u.rowCount,colCount:u.colCount,refType:u.refType},c=e.toArray(),f=n(void 0,l);for(a=0;a<ra.Z._getLength(c);a++)"number"==typeof f[a]&&i&&i(c[a])&&(o=Nn(o,f[a]));return Kn(o)}function Yl(){var e,t,r,n,a,o,i,u=arguments,s=0,l=[],c=0;for(e=0;e<zs(u);e++){if((n=zn(u[e])).error&&n.error.length>0)return n.error[0];if(0===e)t=n.rowCount,r=n.colCount,c=zs(n);else if(n.rowCount!==t||n.colCount!==r)throw new Error(Ut.value);l.push(n)}for(e=0;e<c;e++){for(a=1,o=0;o<zs(u);o++){if("number"!=typeof(i=l[o][e])||isNaN(i)){a=0;break}a*=i}s+=a}return Kn(s)}function Vl(e,t){return h(this,void 0,void 0,c().mark((function r(){var n,a,o,i,u,s,l,f,d;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=String(e),a=0,o=1,i=2,u=3,s=4,l=5,f=et._funcNode,d={result:"#PARAMS!",displayText:"#PARAMS!"},r.prev=2,15===n.length&&(n=String(Zs(e))),js(n)){r.next=5;break}return r.abrupt("return",yr.default.t("#身份证号码错误"));case 5:r.next=10;break;case 7:return r.prev=7,r.t0=r.catch(2),r.abrupt("return",d);case 10:r.t1=parseInt(t),r.next=r.t1===a?13:r.t1===o?14:r.t1===i?15:r.t1===u?16:r.t1===s?17:r.t1===l?18:21;break;case 13:return r.abrupt("return",function(e){var t=new Date,r=t.getMonth()+1,n=t.getDate(),a=t.getFullYear()-e.substring(6,10)-1;return(e.substring(10,12)<r||e.substring(10,12)==r&&e.substring(12,14)<=n)&&a++,a<=0&&(a=1),a}(n));case 14:return r.abrupt("return",n.toString()[16]%2?yr.default.t("男"):yr.default.t("女"));case 15:return r.abrupt("return",(f.setFormatType("yyyy/m/d"),Ar($s(n).date).numericValue));case 16:return r.abrupt("return",$s(n).zodiac);case 17:return r.abrupt("return",$s(n).zodiac_zh||d);case 18:return r.next=20,function(e){return h(this,void 0,void 0,c().mark((function t(){var r,n,a,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Ws){t.next=11;break}return t.prev=1,t.next=4,Te().get("https://docs.gtimg.com/common-cdn/json/docs-place-of-birth.v1.json");case 4:r=t.sent,Ws=r.data,t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",""+yr.default.t("网络异常"));case 11:return n=Ws[e.slice(0,2)]||"",a=Ws[e.slice(0,4)]||"",o=Ws[e.slice(0,6)]||"",t.abrupt("return",n||a||o?""+n+a+o:""+yr.default.t("未找到"));case 13:case"end":return t.stop()}}),t,null,[[1,8]])})))}(n);case 20:return r.abrupt("return",r.sent);case 21:return r.abrupt("return",d);case 22:case"end":return r.stop()}}),r,null,[[2,7]])})))}function $l(e){var t=String(e);try{return 15===t.length&&(t=String(Zs(e))),!!js(t)}catch(e){return console.warn(e),!1}}function jl(e,t){var r=String(e);try{return!!function(e){if(e=e.toString(),!/^[A-Z](\d{6})([\(|（]?)[\d|A]([）|\)]?)$/g.test(e))return!1;var t=e.replace(/[\(|（](?=\d|A)/,"").replace(/[）|\)]$/,"").split("");return t[0]=t[0].toUpperCase().charCodeAt()-64,8===t.length&&!!function(e){var t=0;Array.from(e).forEach((function(e,r){Number(r)<7&&(t+=Number(e)*(8-Number(r)))}));var r=t%11;switch(r){case 0:return e[7]===r.toString();case 1:return"A"===e[7];default:return e[7]===(11-r).toString()}}(t)}(r)}catch(e){return console.warn(e),!1}}function Zl(e,t,r){t=Dn(t,et._astNodes[0]);var n=Vn(r=Dn(r,et._astNodes[1])),a=$n(t),o=Xs(Math.abs(n)),i=qs(a=n<0?a/o:a*o),u=Ks(a);if(e){var s=i;i=u,u=s}return a=a<0?i:u,Kn(a=n<0?a*o:a/o)}function Wl(e,t){return void 0===t&&(t=0),Zl.call(this,!1,e,t)}function Xl(e,t){return Zl.call(this,!1,e,t)}function Kl(e,t){return va._round(e,t)}function ql(e){return""===(e=Dn(e,et._astNodes[0]))&&(e=0),e=parseFloat(e),isNaN(e)?Ut.value:Kn(Math.log(e))}function zl(e,t,r,n){return void 0===t&&(t=1),void 0===r&&(r=0),""===(e=Dn(e,et._astNodes[0],!0))&&(e=0),""===(t=Dn(t,et._astNodes[1],!0))&&(t=1),""===(r=Dn(r,et._astNodes[2],!0))&&(r=0),e=$n(e),t=$n(t),r=$n(r),0===t||0===e?0:0!==r&&e<0?!0===n?Ks(e/Math.abs(t))*Math.abs(t):qs(e/Math.abs(t))*Math.abs(t):!0===n?qs(e/Math.abs(t))*Math.abs(t):Ks(e/Math.abs(t))*Math.abs(t)}function Jl(e,t,r){return t=Dn(t,et._astNodes[0]),r=Dn(r,et._astNodes[1]),t=$n(t),r=$n(r),0===t||0===r?0:t>0&&r<0?Ut.num:t<0&&r>0?(r=-r,e?Ks(t/r)*r:qs(t/r)*r):e?qs(t/r)*r:Ks(t/r)*r}function Ql(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),""===(t=Dn(t,et._astNodes[0],!0))&&(t=0),""===(r=Dn(r,et._astNodes[1],!0))&&(r=1),t=$n(t),r=$n(r),0===t||0===r?0:e?qs(t/Js(r))*Js(r):Ks(t/Js(r))*Js(r)}var ec={ORIGIN:function(e,t){return Jl(!0,e,t)},MATH:function(e,t,r){return zl(e,t,r,!0)},PRECISE:function(e,t){return Ql(!0,e,t)}},tc={CEILING:ec},rc={};function nc(e,t,r,n,a){if(r=void 0===r?1:r,n=void 0===n||n,a=void 0===a?"":a,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),isNaN(e)||isNaN(t)||isNaN(r))return Ut.value;if("string"!=typeof a&&et._astNodes[4]&&(a=et._astNodes[4].originValue),"string"==typeof n)return Ut.value;if(n=Boolean(n),a=String(a),Number.isNaN(e)||Number.isNaN(t))return Ut.value;if(Number.isNaN(r))return Ut.value;if(e<1||e>bu.MAX_ROW_COUNT||t<1||t>bu.MAX_COLUMN_COUNT||r<1||4<r)return Ut.value;var o=3===r||4===r,i=2===r||4===r,u="";return u=function(e,t){if(void 0===e&&(e=""),t&&0<zs(t)){var r,n=!bu._isLetter(t[0])&&"_"!==t[0];for(r=1;!n&&r<zs(t);r++)n=!bu._isLetterOrDigit(t[r])&&"_"!==t[r];/^(true)|(false)$/i.test(t)&&(n=!0),n?(e+="'",e+=t.replace("'","''"),e+="'"):e+=t,e+="!"}return e}(u,a),n?(u=function(e,t,r){r||(e+="$");for(var n=e.length;t>.1;t=parseInt((t-1)/26),10)e=On.Z._insert(e,n,String.fromCharCode("A".charCodeAt(0)+(t-1)%26));return e}(u,t,i),u=function(e,t,r){return r||(e+="$"),e+t}(u,e,o)):(u=ac(u,"R",e,o),u=ac(u,"C",t,i)),u}function ac(e,t,r,n){return e+=t,n?0!==r&&(e+="[",e+=r.toString(),e+="]"):e+=r,e}function oc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;"[object Object]"===Object.prototype.toString.call(t[t.length-1])&&t[t.length-1].isHiddenCells&&(n=t[t.length-1],t=t.slice(0,-1));for(var a=1,o=0,i=0;i<t.length;i++){var u=t[i];if(ft(u)||Array.isArray(u)){var s=n&&n[i],l=zn(u);if(l.error&&l.error.length>0)throw new Error(l.error[0]);for(var c=0;c<l.length;c++){var f=l.row+Math.floor(c/l.colCount),d=l.col+c%l.colCount;if(!(s&&s[f]&&s[f][d])){var h=l[c];"number"!=typeof h||isNaN(h)||(a*=h,o++)}}}else{var m=Mn(u);if(kt(m))return m;a*=m,o++}}return 0===o&&(a=0),a}function ic(e,t){return void 0===t&&(t=10),e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),Array.isArray(e)||Array.isArray(t)?Ut.value:t?(e=$n(e),1===(t=$n(t))?Ut.div0:Kn(va._log(e,t))):Ut.num}function uc(e,t){return t=$n(t=Dn(t,et._astNodes[0])),isNaN(t)?Ut.value:Kn(Math[e](t))}function sc(e){return uc("sin",e)}function lc(e){return uc("cos",e)}function cc(e){return uc("tan",e)}function fc(e){return uc("asin",e)}function dc(e){return uc("acos",e)}function hc(e){return uc("atan",e)}function mc(){return Math.PI}function gc(e){return""===(e=Dn(e,et._astNodes[0]))&&(e=0),e=parseFloat(e),isNaN(e)?Ut.value:180*e/Math.PI}function pc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Math.PI*e/180}function vc(e,t){if(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=Number(e),t=Number(t),isNaN(e)||isNaN(t))return Ut.value;if(0===e&&0===t)return Ut.num;var r=Math.pow(e,t);return isNaN(r)?Ut.num:r}function yc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Kn(va._log(e,10))}function Nc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Kn(Math.exp(e))}function Mc(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,a=t.length;n<a;n++){var o=t[n];if(Array.isArray(o))o=(o=gn(o)).filter((function(e){return"number"==typeof e})),t[n]=o;else{var i=et._astNodes[n];if(o=Dn(o,i),ht(i)&&"number"!=typeof o&&(o=0),o=Number(o),isNaN(o))return Ut.value;t[n]=[o]}}var u,s,l,c,f=0;for(s=0;s<zs(t);s++)for(c=t[s],l=0;l<zs(c);l++)(u=c[l])!==Qn&&(f+=u*u);return Kn(f)}function Rc(e,t){for(var r=0,n=t.length;r<n;r++){var a=t[r];if(Array.isArray(a))a=(a=gn(a)).filter((function(e){return"number"==typeof e})),t[r]=a;else{var o=et._astNodes[r];if(a=Dn(a,o),ht(o)&&"number"!=typeof a&&(a=0),a=Number(a),isNaN(a))return Ut.value;t[r]=[a]}}var i,u,s,l,c,f=0,d=0,h=0,m=[];for(s=0;s<zs(t);s++)for(c=t[s],m.push(c),l=0;l<zs(c);l++)(i=c[l])!==Qn&&(f+=i,h++);for(u=f/h,s=0;s<zs(t);s++)for(c=m[s],l=0;l<zs(c);l++)(i=c[l])!==Qn&&(d+=e?(i-u)*(i-u):Math.abs(i-u));return e?Kn(d):0===h?Ut.div0:Kn(d/h)}function Ec(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Rc(!1,t)}function _c(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Rc(!0,t)}function Tc(e,t){if(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=Vn(e),t=Vn(t),isNaN(e)||isNaN(t))return Ut.value;if(e<0||e>3999)return Ut.value;if(t<0||t>4)return Ut.value;var r,n,a=["M","D","C","L","X","V","I"],o=[1e3,500,100,50,10,5,1],i=[];for(r=Xa._isBoolean(t)?t?0:4:t,n=0;n<7;n+=2){if(2<=n&&o[n-2]-o[n]<=e){var u,s=n,l=n-2;for(u=0;u<r&&s+1<7&&o[l]-o[s+1]<=e;u++)s++;i.push(a[s]),i.push(a[l]),e+=o[s],e-=o[l]}if(1<=n&&o[n-1]<=e&&(i.push(a[n-1]),e-=o[n-1]),1<=n&&o[n-1]-o[n]<=e){var c,f=n,d=n-1;for(c=0;c<r&&f+1<7&&o[d]-o[f+1]<=e;c++)f++;i.push(a[f]),i.push(a[d]),e+=o[f],e-=o[d]}for(;o[n]<=e;)i.push(a[n]),e-=o[n]}return i.join("")}function Sc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Kn(va._sinhCosh(e,!0))}function Ic(e,t){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=$n(t),isNaN(e)||isNaN(t)?Ut.value:0===e&&0===t?Ut.div0:Kn(Math.atan2(t,e))}function Cc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Kn(rl(e+Qs(e*e+1)))}function Ac(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Kn(rl(e+Qs(e*e-1)))}function wc(e){if(e=$n(e=Dn(e,et._astNodes[0])),isNaN(e))return Ut.value;var t=tl(e),r=tl(-e);return Kn(t-r)/(t+r)}function xc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Js(e)>=1?Ut.num:Kn(rl((1+e)/(1-e))/2)}function Dc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Kn(va._sinhCosh(e,!1))}function bc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Js(e)>=134217728?Ut.num:0===e?Ut.div0:Kn(1/Math.tan(e))}function Oc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:0===e?Ut.div0:e>10?1:e<-10?-1:1/wc(e)}function Fc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:Kn(e<0?Math.PI+Math.atan(1/e):Math.atan(1/e))}function Lc(e){return e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:xc(1/e)}function Uc(e){return"boolean"==typeof e?Ut.value:(e=$n(e=Dn(e,et._astNodes[0])),isNaN(e)?Ut.value:e<0?Ut.num:Kn(Qs(e*nl)))}function Bc(e,t){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=$n(t),isNaN(e)||isNaN(t)?Ut.value:e<0&&t>0||t<0&&e>0?Ut.num:0===e||0===t?0:Ks(e/t+.5)*t}function kc(e,t){return t=Dn(t,et._astNodes[0]),t=Number(t),isNaN(t)?Ut.value:(t=t<0?el(t):Math.ceil(t),(e&&t%2==0||!e&&t%2!=0)&&(t+=t<0?-1:1),t)}function Pc(e){return kc(!0,e)}function Hc(e){return kc(!1,e)}function Gc(e,t){return Xa._isBoolean(e)||Xa._isBoolean(t)||wn(e,et._astNodes[0])||wn(t,et._astNodes[1])?Ut.value:(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=Vn(e),t=Vn(t),isNaN(e)||isNaN(t)?Ut.value:t<e?Ut.num:Vn(e+al()*(t-e+1)))}rc.ORIGIN=function(e,t){return Jl(!1,e,t)},rc.MATH=function(e,t,r){return zl(e,t,r,!1)},rc.PRECISE=function(e,t){return Ql(!1,e,t)};var Yc=ea.Z._isNullOrUndefined,Vc=bn.Z,$c=Vc._parseLocale,jc=Vc._toOADate,Zc=ra.Z._getLength;function Wc(e,t,r){if(void 0===r&&(r=1),r<=0)throw new Error(Ut.value);if(Array.isArray(e)){if(gn(e).length>1)throw new Error(Ut.value);e=String(gn(e)[0])}else e=String(e);if(Array.isArray(t)){if(gn(t).length>1)throw new Error(Ut.value);t=String(gn(t)[0])}else t=String(t);if(!t)throw new Error(Ut.value);if(""===e)return 1;var n=t.replace(/[\u200B-\u200D\uFEFF]/g,"").indexOf(e.replace(/[\u200B-\u200D\uFEFF]/g,""),r-1);if(-1===n)throw new Error(Ut.value);return n+1}function Xc(e,t){return void 0===t&&(t=1),qc(!0,e,t)}function Kc(e,t){return void 0===t&&(t=1),qc(!1,e,t)}function qc(e,t,r){if(r<0||isNaN(r))throw new Error(Ut.value);return"string"!=typeof t&&(t=t.toString()),r>=Zc(t)?t:t.substr(e?0:Zc(t)-r,r)}function zc(e){if(_n(e))return e;if(!(e=Xn(e)))return 0;if("string"==typeof e)return e?e.length:0;if(e.length)return e.length;throw new Error(Ut.value)}function Jc(e,t,r){if(""===r&&(r=0),null===e&&(e=""),t<=0||r<0)throw new Error(Ut.value);if("number"==typeof e&&(e=String(e)),_n(t=Mn(t),r=Mn(r))||"string"!=typeof e)return r;var n=t-1,a=n+r;return e.substring(n,a)}function Qc(e,t,r){if(!t)return!1;"object"==typeof e&&(e=e.toArray().toString());var n=e.toString().match(new RegExp(t));return r?n:!!n}function ef(e,t,r,n){var a,o=Xn(e),i=Xn(t),u=Zc(i);if(Zc(arguments)>3){var s,l=Vn(n),c=0;if(l<1)return Ut.value;for(s=0;s<l;s++){if(-1===(c=o.indexOf(i,c)))return o;c+=u}var f=o.substring(0,c-u),d=o.substr(c);a=f.concat(r).concat(d)}else{if(""===i)return o;a=On.Z._join(o,i,r)}return a}function tf(e){if(Array.isArray(e))return Ut.value;var t=Xn(e);t=t.trim();var r,n,a=[],o=!0,i=String.fromCharCode(160);for(r=0,n=Zc(t);r<n;r++){var u=t.charAt(r),s=" "===u||"\t"===u||u===i,l="\n"===u;l||s&&!o||a.push(u),o=l||!s}return a.join("")}function rf(e,t){var r,n,a=[],o=Zc(e);for(r=0;r<o;r++){if(Array.isArray(e[r]))return Ut.value;var i=Xn(e[r]),u=Zc(i);if(0===u&&"concat"===t)return Ut.nil;for(n=0;n<u;n++)Yc(i[n])||a.push(Xn(i[n]))}return a.join("")}function nf(){return rf(arguments,"concatenate")}function af(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)?(n=gn(n),e=e.concat(n)):e.push(n)}return rf(e,"concat")}function of(e){if(!(e=Dn(e,et._astNodes[0])))return 0;e=Xn(e);var t,r=$c(e);return Yc(r)?function(e){var t=Ci.s._getCultureInfo().NumberFormat,r=bu.isDigit,n=!1;"$"!==e[0]&&e[0]!==t.currencySymbol||(e=e.substring(1),n=!0);var a=parseFloat(e);if(!e||isNaN(a)||!n&&isNaN(e)||!r(e[0].charCodeAt(0))&&"."!==e[0]&&"-"!==e[0])return Ut.value;"."===e[0]&&(e="0"+e);for(var o,i=e.length,u=0,s=0,l=0;u<i;u++){for(o=e[u];u<i&&r(o.charCodeAt(0));)o=e[++u];if(u===i){if(s&&u-s<=3)return Ut.value;break}if(o===t.numberGroupSeparator){if(l||s&&u-s<=3)return Ut.value;s=u}else if(o===t.numberDecimalSeparator){if(l||s&&u-s<=3)return Ut.value;l=u}}return e=On.Z._replace(e,",",""),parseFloat(e)}(e):Gn(t=jc(r))?ii(r):t}function uf(e){var t,r=e.toString(),n="",a=[];e<0&&(r=r.substr(1),n="-");var o=r.split("."),i=Zc(o);if(i<1||i>2)return Ut.value;for(2===i&&(a.push(o[1]),a.push(".")),r=o[0],t=Zc(r)-3;t>=0;t-=3)a.push(r.substr(t,3)),t>0&&a.push(",");return a.push(r.substring(0,t+3)),a.reverse(),n+a.join("")}function sf(e,t,r){if(void 0===t&&(t=2),void 0===r&&(r=!1),e=Dn(e,et._astNodes[0],!0),""===(t=Dn(t,et._astNodes[1],!0))&&ht(et._astNodes[1])&&(t=0),""===t&&(t=2),"string"==typeof r)switch(r.toLowerCase()){case"true":r=!0;break;case"false":case"":r=!1;break;default:return Ut.value}var n=0;t<0&&(e/=n=Vn(Math.pow(10,Math.abs(t)))),e=$n(Kl(e,Math.max(0,t))),t<0&&(e*=n),(e=r?e.toString():uf(e)).indexOf(".")<0&&t>0&&(e+=".");for(var a=e.length-e.indexOf(".");a<=t;a++)e+="0";return e}var lf={12449:65383,12451:65384,12453:65385,12455:65386,12457:65387,12540:65392,12450:65393,12452:65394,12454:65395,12456:65396,12458:65397,12459:65398,12461:65399,12463:65400,12465:65401,12467:65402,12469:65403,12471:65404,12473:65405,12475:65406,12477:65407,12479:65408,12481:65409,12484:65410,12486:65411,12488:65412,12490:65413,12491:65414,12492:65415,12493:65416,12494:65417,12495:65418,12498:65419,12501:65420,12504:65421,12507:65422,12510:65423,12511:65424,12512:65425,12513:65426,12514:65427,12516:65428,12518:65429,12520:65430,12521:65431,12522:65432,12523:65433,12524:65434,12525:65435,12527:65436,12530:65382,12531:65437,12483:65391};function cf(e){e=Xn(e);for(var t=[],r=!1,n=0,a=Zc(e);n<a;n++){var o=e.charCodeAt(n);12288!==o?o>65280&&o<65375?(t.push(String.fromCharCode(o-65248)),r=!0):lf[o]?(t.push(String.fromCharCode(lf[o])),r=!0):t.push(e[n]):(t.push(String.fromCharCode(32)),r=!0)}return r?t.join(""):e}function ff(e){return(e=Xn(e)).toUpperCase()}function df(e){return(e=Vn(e))<1||e>255?Ut.value:String.fromCharCode(e)}function hf(e,t){if(Array.isArray(e))return Ut.value;""===(t=Dn(t,et._astNodes[1],!0))&&(t=0);var r,n=[];if((t=parseInt(t))<0||t*Zc(e)>32767)return Ut.value;for(r=0;r<t;r++)n.push(e);return n.join("")}function mf(e){if("boolean"==typeof e&&(e=e.toString()),"string"!=typeof e)return e;var t=Zc(e),r=[];if(t>0){var n=e.toUpperCase(),a=e.toLowerCase(),o=1;for(r[0]=n[0];o<t;)r[o]=bu._isLetter(e[o-1])?a[o]:n[o],o++}return r.join("")}function gf(e,t){return"string"!=typeof e&&(e=e.toString()),"string"!=typeof t&&(t=t.toString()),e===t}function pf(e,t){var r=Array.isArray(e)?pn(e):[e];if(r.isReference&&0===r.length)return CalcErrorsNull;var n={value:!1},a=!!Yc(t)||t;if(!Wn(a,n))return Ut.value;a=n.value;var o,i,u=Array.from(arguments).map((function(e,t){return t<2?e:Array.isArray(e)?pn(e):[e]})),s=[],l=Zc(u);for(o=2;o<l;o++){var c=u[o],f=Zc(c);if(0===f)return Ut.null;for(i=0;i<f;i++)Yc(c[i])||""===c[i]?a||s.push(""):s.push(Xn(c[i]))}if(Array.isArray(r)){if(0===r.length)return Ut.null;var d=s[0];for(i=0,o=1;o<s.length;o++)i===r.length&&(i=0),d+=r[i++]+s[o];return d}return s.join(r)}function vf(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return pf.apply(this,t)}function yf(e){if(e=Dn(e,et._astNodes[0])){var t=e;return t<=0||t>1114111?Ut.value:t>=55296&&t<=57343?Ut.na:t<1048576?String.fromCharCode(t):(t-=1048576,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}return Ut.value}function Nf(e){var t,r,n=Xn(e);return""===n||null===n?Ut.value:(t=n.charCodeAt(0))>=55296&&t<=56319?1===n.length?Ut.value:(r=n.charCodeAt(1))>=56320&&r<=57343?t|r<<8:1:t>=56320&&t<=57343?t-53248+53248:t}function Mf(e){return(e=Xn(e)).toLowerCase()}function Rf(e){return function(e){var t=e;if(Array.isArray(e)){if(!e.__isUserWrite)return Ut.value;t=e[0][0]}var r=Xn(t);return""===r?Ut.value:r.charCodeAt(0)}(e)}function Ef(e,t,r,n){if(e=Xn(e),t=Vn(t=Dn(t,et._astNodes[1])),isNaN(t)||t<1)return Ut.value;if(""===(r=Dn(r,et._astNodes[2]))&&(r=0),r=Vn(r),isNaN(r)||r<0)return Ut.value;n=Xn(n);var a=Zc(e);t=Math.min(t,a+1),r=Math.min(r||0,a-t+1);var o=e.substring(0,t-1),i=e.substr(t-1+r);return o.concat(n).concat(i)}function _f(e){e=Xn(e);var t,r,n=[];for(t=0;t<Zc(e);t++)0<=(r=e.charCodeAt(t))&&r<=31||127===r||128<=r&&r<=159||n.push(e[t]);return n.join("")}function Tf(e,t){if(void 0===t&&(t=2),""===(e=Dn(e,et._astNodes[0],!0))&&(e=0),""===(t=Dn(t,et._astNodes[1],!0))&&(t=2),e=$n(e),t=Vn(t),isNaN(e)||isNaN(t))return Ut.value;if((e=Xn(e=$n(Kl(e,t)))).indexOf(".")>-1)for(var r=e.length-e.indexOf(".");r<=t;r++)e+="0";return function(e){var t=uf(e),r=[];return e<0&&(t=t.substr(1)),r.push("¥"),r.push(t),e<0&&(r.push(")"),r.unshift("(")),r.join("")}(e)}function Sf(e){return Array.isArray(e)&&(e=(e=gn(e))[0]),e=xn(e,et._astNodes[0]),Xa._isString(e)?e:""}function If(e,t){if(""===(t=Xn(t)))return Xn(e);Yc(e)&&(e=0);try{if(Cu){var r=new Cu(t);return 2===r.formatters[0]._numberFormat._formatType&&Hn(e)&&e<0?Ut.value:r.format(e)}return e.toString()}catch(e){return Ut.value}}function Cf(e,t,r){if(void 0===r&&(r=1),e=Xn(e),t=Xn(t),""===(r=Dn(r,et._astNodes[0]))&&(r=0),(r=Vn(r))<=0)return Ut.value;var n,a,o=-1;return(n=na.Z._getWildcardCriteria(e))?(a=na.Z._getRegIgnoreCase(n).exec(t),o=Yc(a)?-1:a.index):o=t.toLowerCase().indexOf(e.toLowerCase(),--r),-1===o?Ut.value:o+1}function Af(e,t){var r=""+(t||e||""),n=""+(e||""),a=et._instance;et._funcNode.setHyperLink(n);var o=a.custom.setExtraCalcResult;return o&&o({hyperlink:n}),r}function wf(e){var t=et._instance.custom.getCellHyperlink;return ft(e)&&e.getRangeCount()>0&&t&&t(e.getRow(0),e.getColumn(0),e.getSheetId(0))||""}var xf={version:"1.0.2"},Df=Math;function bf(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function Of(e,t,r,n,a){if(0===t)return r;if(1===t)return n;for(var o=2/e,i=n,u=1;u<t;++u)i=n*u*o+a*r,r=n,n=i;return i}function Ff(e,t,r,n,a){return function(r,o){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}return 0===o?e(r):1===o?t(r):o<0?NaN:Of(r,o|=0,e(r),t(r),a)}}var Lf,Uf,Bf,kf,Pf,Hf,Gf,Yf,Vf,$f,jf,Zf,Wf,Xf=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),r=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),n=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),a=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function o(o){var i=0,u=0,s=0,l=o*o;if(o<8)i=(u=bf(t,l))/(s=bf(r,l));else{var c=o-.785398164;u=bf(n,l=64/l),s=bf(a,l),i=Df.sqrt(e/o)*(Df.cos(c)*u-Df.sin(c)*s*8/o)}return i}var i=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),u=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),s=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function c(t){var r=0,n=0,a=0,o=t*t,c=Df.abs(t)-2.356194491;return Math.abs(t)<8?r=(n=t*bf(i,o))/(a=bf(u,o)):(n=bf(s,o=64/o),a=bf(l,o),r=Df.sqrt(e/Df.abs(t))*(Df.cos(c)*n-Df.sin(c)*a*8/Df.abs(t)),t<0&&(r=-r)),r}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return o(t);if(1===r)return c(t);if(0===t)return 0;var n=0;if(t>r)n=Of(t,r,o(t),c(t),-1);else{for(var a=!1,i=0,u=0,s=1,l=0,f=2/t,d=2*Df.floor((r+Df.floor(Df.sqrt(40*r)))/2);d>0;d--)l=d*f*s-i,i=s,s=l,Df.abs(s)>1e10&&(s*=1e-10,i*=1e-10,n*=1e-10,u*=1e-10),a&&(u+=s),a=!a,d==r&&(n=i);n/=u=2*u-s}return n}}(),Kf=(Lf=.636619772,Uf=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),Bf=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),kf=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),Pf=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),Hf=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),Gf=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),Yf=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),Vf=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),Ff((function(e){var t=0,r=0,n=0,a=e*e,o=e-.785398164;return e<8?t=(r=bf(Uf,a))/(n=bf(Bf,a))+Lf*Xf(e,0)*Df.log(e):(r=bf(kf,a=64/a),n=bf(Pf,a),t=Df.sqrt(Lf/e)*(Df.sin(o)*r+Df.cos(o)*n*8/e)),t}),(function(e){var t=0,r=0,n=0,a=e*e,o=e-2.356194491;return e<8?t=(r=e*bf(Hf,a))/(n=bf(Gf,a))+Lf*(Xf(e,1)*Df.log(e)-1/e):(r=bf(Yf,a=64/a),n=bf(Vf,a),t=Df.sqrt(Lf/e)*(Df.sin(o)*r+Df.cos(o)*n*8/e)),t}),0,1,-1)),qf=($f=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),jf=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Zf=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),Wf=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,r){if(0===(r=Math.round(r)))return function(e){return e<=3.75?bf($f,e*e/14.0625):Df.exp(Df.abs(e))/Df.sqrt(Df.abs(e))*bf(jf,3.75/Df.abs(e))}(t);if(1===r)return function(e){return e<3.75?e*bf(Zf,e*e/14.0625):(e<0?-1:1)*Df.exp(Df.abs(e))/Df.sqrt(Df.abs(e))*bf(Wf,3.75/Df.abs(e))}(t);if(r<0)return NaN;if(0===Df.abs(t))return 0;if(t==1/0)return 1/0;var n,a=0,o=2/Df.abs(t),i=0,u=1,s=0;for(n=2*Df.round((r+Df.round(Df.sqrt(40*r)))/2);n>0;n--)s=n*o*u+i,i=u,u=s,Df.abs(u)>1e10&&(u*=1e-10,i*=1e-10,a*=1e-10),n==r&&(a=i);return a*=e(t,0)/u,t<0&&r%2?-a:a}),zf=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),r=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),n=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return Ff((function(r){return r<=2?-Df.log(r/2)*qf(r,0)+bf(e,r*r/4):Df.exp(-r)/Df.sqrt(r)*bf(t,2/r)}),(function(e){return e<=2?Df.log(e/2)*qf(e,1)+1/e*bf(r,e*e/4):Df.exp(-e)/Df.sqrt(e)*bf(n,2/e)}),0,2,1)}();xf.besselj=Xf,xf.bessely=Kf,xf.besseli=qf,xf.besselk=zf;var Jf=xf,Qf=Xa._Complex,ed=ea.Z._isNullOrUndefined,td=ra.Z._getLength,rd=function(e,t){return!!Zn(e,t)&&kn(t.value)<1e21&&(t.value=parseInt(t.value,10),!0)},nd=Vn,ad=void 0,od=null;function id(e,t,r,n){function a(e,t,r,n,a,o){var i,u=e,s=[];n=n<0?0:n,a=(r=r<0?0:r)+a>t.rowCount?t.rowCount-r:a,o=n+o>t.colCount?t.colCount-n:o;for(var l=0;l<a;l++){i=[],s.push(i);for(var c=0;c<o;c++)i.push(u[l+r][c+n])}return[s]}function o(e){return!ed(e)&&!e._error}ft(t)&&(t=t.toArray()[0]),ft(r)&&(r=r.toArray()[0]);var i=et._element,u=et._instance,s=u.helper.getCalcRef,l=!0;if(ft(e)){var c,f,d={value:-1},h=e,m=h.getRowCount(0),g=h.getColumnCount(0),p=h.getRow(0),v=h.getColumn(0),y=h.getSheetId(0);if(2===td(arguments)){if(1!==h.getRangeCount()||1!==m&&1!==g)return Ut.ref;var N=o(t)&&rd(t,d)?d.value:0;if(0!==N||l||(N=m>0?i.row:i.col),N<0)return Ut.value;if(m*g<N)return Ut.ref;if(0===N){var M=1===m&&1===g;return s([{sheetId:y,row:p,col:v,refType:M?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:m,colCount:g}],M)}return s([{sheetId:y,row:c=Math.floor((N-1)/g)+p,col:f=(N-1)%g+v,refType:u.NODE_TYPE.CELL_RANGE_TYPE.CELL,rowCount:1,colCount:1}],!0)}if(t=o(t)&&rd(t,d)?d.value-1:-1,r=o(r)&&rd(r,d)?d.value-1:-1,(n=o(n)&&rd(n,d)?d.value-1:0)>=h.getRangeCount())return Ut.ref;m=h.getRowCount(n),g=h.getColumnCount(n);var R=h.getRow(n),E=h.getColumn(n);if(-1===t&&!l&&m>1&&i!==od&&(t=i.row),-1===r&&!l&&g>1&&i!==od&&(r=i.col),c=t+R,f=r+E,t<-1||r<-1||n<0)return Ut.value;if(m<=t||g<=r||h.getRangeCount()<=n)return Ut.ref;if(-1===t&&-1===r){var _=1===m&&1===g;return s([{sheetId:y,row:R,col:E,refType:_?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:m,colCount:g}],_)}if(-1===t){var T=1===m;return s([{sheetId:y,row:R,col:f,refType:T?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:m,colCount:1}],T)}if(-1===r){var S=1===g;return s([{sheetId:y,row:c,col:E,refType:S?u.NODE_TYPE.CELL_RANGE_TYPE.CELL:u.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:1,colCount:g}],S)}return s([{sheetId:y,row:c,col:f,refType:u.NODE_TYPE.CELL_RANGE_TYPE.CELL,rowCount:1,colCount:1}],!0)}if(Array.isArray(e)){var I=zn(e),C=I.rowCount;if(t=t!==ad?nd(t):-1,r=r!==ad?nd(r):-1,1!=(n=n!==ad?nd(n)-1:1))return Ut.ref;-1===t&&-1===r?t=r=0:-1===r&&1===C&&(r=t,t=1),t=-1===t?0:t,r=-1===r?0:r,C=I.rowCount;var A=I.colCount;return t<0||r<0||n<0?Ut.value:(t>C&&1===C&&r===ad&&(r=t,t=0),C<t||A<r?Ut.ref:0===t&&0===r?a(e[0],I,0,0,C,A):0===t?a(e[0],I,0,r-1,C,1):0===r?a(e[0],I,t-1,0,1,A):e[0][t-1][r-1])}if(t>=0&&t<=1&&r>=0&&r<=1)return e;throw new Error(Ut.ref)}function ud(e,t){var r,n=e;ft(e)&&(n=zn(e)[0],r=e.getSheetId(0)),ft(t)&&(t=zn(t)[0]);var a=et._element,o=et._instance;if(r=r||a.sheetId,""===n||"string"!=typeof n)throw new Error(Ut.ref);if(!n)throw new Error(Ut.na);void 0===t&&(t=!0);var i=n,u=i=i.replace(/\$/g,"");if(!(vr.lA(i)||vr.lr(i)||vr.yH(i)||vr.n0(i)))throw new Error(Ut.ref);function s(){var e=i.lastIndexOf("!");if(-1!==e){var t=i.slice(0,e);if(kt(r=o.helper.getSheetIdBySheetName(t)))throw new Error(Ut.ref);i=i.slice(e+1)}}if(t){var l=et._funcNode,c=(l.calculateParentFunctionNode&&l.calculateParentFunctionNode.funcName,{row:a.row,col:a.col,sheetId:a.sheetId}),f=!1;if(vr.lA(i)){s();var d=q(i),h=d.row,m=d.col,g={endRowIndex:h,startRowIndex:h,endColIndex:m,startColIndex:m,sheetId:r};f=!o.custom.addDependency(c,g)}else if(vr.lr(i)){s();var p=i.split(":"),v=p[0],y=p[1],N=q(v),M=N.row,R=N.col,E=q(y),_={endRowIndex:E.row,startRowIndex:M,endColIndex:E.col,startColIndex:R,sheetId:r};f=!o.custom.addDependency(c,_)}else if(vr.yH(i)){s();var T=i.split(":"),S=T[0],I=T[1],C=J(S),A=J(I),w={endRowIndex:F,startRowIndex:O,endColIndex:A,startColIndex:C,sheetId:r};f=!o.custom.addDependency(c,w)}else if(vr.n0(i)){s();var x=i.split(":"),D=x[0],b=x[1],L=Number(D),U={endRowIndex:Number(b),startRowIndex:L,endColIndex:F,startColIndex:O,sheetId:r};f=!o.custom.addDependency(c,U)}if(f){var B={id:a.id,sheetId:a.sheetId,row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount},k=o.custom.parse(u,B);return o.calculate(k,B)}return""}if("string"==typeof i){var P=i.match(/^R([\d])+C([\d])+/);if(P){var H=P[1],G=P[2];return o.custom.cellValue(H,G,a.sheetId)||0}throw new Error(Ut.na)}throw new Error(Ut.na)}function sd(e,t,r,n,a){""===t?t=0:ft(t)&&(t=zn(t)[0]),""===r?r=0:ft(r)&&(r=zn(r)[0]),""===n?n=1:ft(n)&&(n=zn(n)[0]),""===a?a=1:ft(a)&&(a=zn(a)[0]);var o=et._instance,i=o.helper.getCalcRef,u=e.getSheetId(0);if(!e||!ft(e)||1!==e.getRangeCount())return Ut.value;n=n!==ad?nd(n):e.getRowCount(0),a=a!==ad?nd(a):e.getColumnCount(0);var s=e.getRow(0)+t,l=e.getColumn(0)+r;if(n<=0||a<=0||s<0||l<0)return Ut.ref;var c=1===n&&1===a,f=et._element;return o.custom.addDependency({row:f.row,col:f.col,sheetId:f.sheetId},{endRowIndex:s+n-1,startRowIndex:s,endColIndex:l+a-1,startColIndex:l,sheetId:u}),i([{sheetId:u,row:s,col:l,refType:c?o.NODE_TYPE.CELL_RANGE_TYPE.CELL:o.NODE_TYPE.CELL_RANGE_TYPE.NORMAL,rowCount:n,colCount:a}],c)}function ld(e,t){var r=Number.POSITIVE_INFINITY,n=e._getReal(),a=e._getImag();return isNaN(n)||n===r||isNaN(a)||a===r?Ut.num:e._toString(t)}function cd(e,t){return Xa._isBoolean(e)||Xa._isBoolean(t)?Ut.value:(e=Dn(e,et._astNodes[0],!0),t=Dn(t,et._astNodes[1],!0),_n(e=Xa.convertArgToComplex(e),t=Xa.convertArgToComplex(t))||e._suffix!==t._suffix?Ut.num:ld(new Qf(e._real-t._real,e._imag-t._imag,e._suffix)))}function fd(e){return Xa._isBoolean(e)?Ut.value:(e=Dn(e,et._astNodes[0],!0),dt(et._astNodes[0])||""!==e?_n(e=Xa.convertArgToComplex(e))?Ut.num:ld(new Qf(e._real,-e._imag,e._suffix)):Ut.num)}function dd(e,t,r){return void 0===r&&(r="i"),Xa._isBoolean(e)||Xa._isBoolean(t)||wn(e,et._astNodes[0])||wn(t,et._astNodes[1])?Ut.value:(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=$n(t),isNaN(e)||isNaN(t)?Ut.value:(""===(r=Xn(r))&&(r="i"),"i"!==r&&"j"!==r?Ut.value:ld(new Qf(e,t),r)))}function hd(e,t,r){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=Vn(t),isNaN(e)||isNaN(t)?Ut.value:t<0?Ut.num:Kn(r?Jf.besseli(e,t):Jf.besselj(e,t))}function md(e,t,r){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=Vn(t),isNaN(e)||isNaN(t)?Ut.value:e<=0||t<0?Ut.num:Kn(r?Jf.besselk(e,t):Jf.bessely(e,t))}function gd(e,t){return hd(e,t,!0)}function pd(e,t){return hd(e,t,!1)}function vd(e,t){return md(e,t,!0)}function yd(e,t){return md(e,t,!1)}function Nd(e,t){var r={2:"0b",8:"0o",16:"0x",10:""},n=r[t],a=Math.pow(t,10),o=Number(""+(e.startsWith(r[16])?"":n)+e);return isNaN(o)?Ut.num:a/2<=o?o-a:o}function Md(e,t,r){e<0&&(e+=Math.pow(t,10));var n,a=e.toString(t),o=r-td(a);for(n=0;n<o;n++)a="0"+a;return a.toUpperCase()}function Rd(e,t){if(Xa._isBoolean(e)||wn(e,et._astNodes[0]))return Ut.value;if(Gn(e=Xn(e)))return e;if("0"===e||""===e)return 0;if(e.length>10)return Ut.num;var r=Nd(e,t);return td(r)<td(e)?Ut.num:r}function Ed(e,t,r){if(void 0===t&&(t=""),Xa._isBoolean(e)||Xa._isBoolean(t)||wn(e,et._astNodes[0])||wn(t,et._astNodes[1]))return Ut.value;if(!ht(et._astNodes[0])&&""===e)return Ut.na;if(""===(e=Dn(e,et._astNodes[0]))&&(e=0),e=$n(e),isNaN(e))return Ut.value;e=parseInt(e,10);var n=!0;if(t=Dn(t,et._astNodes[1],!0),ht(et._astNodes[1])||""!==t||(t=1,n=!1),t=Vn(t),isNaN(t))return Ut.value;if(t<1||t>10)return Ut.num;var a=Md(e,r,t);return 0<=a&&t<td(a)&&n?Ut.num:a}function _d(e,t,r,n,a){if(void 0===t&&(t=""),Xa._isBoolean(e)||Xa._isBoolean(t)||wn(e,et._astNodes[0])||wn(t,et._astNodes[1]))return Ut.value;if(Gn(e=Xn(e)))return e;if("0"===e||""===e)return 0;if(e.length>10)return Ut.num;var o=!0;if(t=Dn(t,et._astNodes[1],!0),ht(et._astNodes[1])||""!==t||(t=1,o=!1),t=Vn(t),isNaN(t))return Ut.value;if(t<1||t>10)return Ut.num;var i=Nd(e,r);if(td(i)<td(e))return Ut.num;if(a&&(i<-a||a-1<i))return Ut.num;var u=Md(i,n,t);return 0<=i&&t<td(u)&&o?Ut.num:u}function Td(e){return Rd(e,2)}function Sd(e,t){return _d(e,t,2,8)}function Id(e,t){return _d(e,t,2,16)}function Cd(e){return Rd(e,8)}function Ad(e,t){return _d(e,t,8,2,512)}function wd(e,t){return _d(e,t,8,16,549755813888)}function xd(e){return Rd(e,16)}function Dd(e,t){return _d(e,t,16,2,512)}function bd(e,t){return _d(e,t,16,8,536870912)}function Od(e,t){return Ed(e,t,2)}function Fd(e,t){return Ed(e,t,16)}function Ld(e,t){return Ed(e,t,8)}function Ud(e,t,r){e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=qn(e),t=qn(t),r=Xn(r),e.setHours(0,0,0,0),t.setHours(0,0,0,0),r=r.toLocaleUpperCase();var n=function(){var e=[];return e[0]=function(e,t){return t.getFullYear()-e.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0)},e[1]=function(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())+(t.getDate()<e.getDate()?-1:0)},e[2]=function(e,t){return(t.getTime()-e.getTime())/864e5},e[3]=function(e,t){var r=new Date(t.getFullYear(),t.getMonth()+(t.getDate()<e.getDate()?-1:0),e.getDate());return(t.getTime()-r.getTime())/864e5},e[4]=function(e,t){return t.getMonth()-e.getMonth()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?12:0)+(t.getDate()<e.getDate()?-1:0)},e[5]=function(e,t){var r=t.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0),n=e.getMonth(),a=e.getDate(),o=ai(e.getFullYear());return 1!==n||29!==a||ai(r)||a--,!o&&1===n&&28===a&&ai(r)&&a++,(t-new Date(r,n,a))/864e5},e}(),a=ea.Z._inArray(r,["Y","M","D","MD","YM","YD"]),o=!1;if(t<e){var i=e;e=t,t=i,o=!0}if(a<0)return Ut.num;var u=(0,n[a])(e,t);return o?-1*u:u}var Bd={ORIGIN:function(e,t){if(Xa._isBoolean(e)||Xa._isBoolean(t)||wn(e,et._astNodes[0])||wn(t,et._astNodes[1]))return Ut.value;var r=!0;if(e=Dn(e,et._astNodes[0]),""===(t=Dn(t,et._astNodes[1]))&&(t=0),void 0===t&&(t=0,r=!1),e=$n(e),t=$n(t),isNaN(e)||isNaN(t))return Ut.value;var n=Xa._st_normsdist(e*Math.sqrt(2)),a=2*parseFloat(n)-1;return r&&(n=Xa._st_normsdist(t*Math.sqrt(2)),a=2*parseFloat(n)-1-a),a},PRECISE:function(e){return Bd.ORIGIN(e)}},kd={};function Pd(e,t){for(var r=0,n=td(t);r<n;r++)for(var a=t[r],o=0;a[o];o++)if(0===e.localeCompare(a[o]))return!1;return!0}function Hd(e,t,r,n){var a,o=0,i=1;for(a=0;e[a]._str;a++)if(0===r.localeCompare(e[a]._str))return{_hasUnit:!0,_prefix:i,_constant:o=e[a]._c};if(t)for(a=0;t[a]._str;a++)r.substr(0,1)===t[a]._str.substr(0,1)&&Pd(r,n)&&(i=t[a]._c);for(a=0;e[a]._str;a++){var u=td(e[a]._str);if(r.substr(1,td(r))===e[a]._str.substr(0,u)&&Pd(r,n))return{_hasUnit:!0,_prefix:i,_constant:o=e[a]._c}}return{_hasUnit:!1,_prefix:i,_constant:o}}function Gd(e,t){return{_str:e,_c:t}}function Yd(e,t){var r,n=[];for(r=0;r<td(e);r++)n.push(new Gd(e[r],t[r]));return n.push(new Gd(null,0)),n}kd.PRECISE=function(e){return 1-Bd.ORIGIN(e)};var Vd=Yd(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,6852205001e-14,.002204622915,602217e18,.035273972,1e8/6479891,173/7847148,173/7847148,55/2794129,55/2794129,55/2794129,1129/7169481,4/3628739,1/1016047,1/1016047]),$d=1e4/254,jd=Yd(["m","mi","Nmi","in","ft","yd","ang","ell","ly","parsec","pc","Picapt","Pica","pica","survey_mi","km"],[1,.000621371192237334,1/1852,$d,3.2808398950131235,1.0936132983377078,1e10,1e3/1143,1057e-19,324078e-22,324078e-22,2834.645669,2834.645669,3e4/127,3937/6336e3,.001]),Zd=365.25,Wd=525960,Xd=31557600,Kd=Yd(["yr","day","d","hr","mn","min","s","sec"],[1,Zd,Zd,8766,Wd,Wd,Xd,Xd]),qd=.00750061708,zd=Yd(["Pa","atm","mmHg","p","at","psi","Torr"],[1,9869233e-12,qd,1,qd,857/5908807,152/20265]),Jd=1e5,Qd=Yd(["N","dyn","lbf","dy","pond"],[1,Jd,.224808924,Jd,2e7/196133]),eh=745.6998715822702,th=Yd(["HP","W","h","w","PS"],[1,eh,1,eh,5567865/5491697]),rh=62146e14,nh=1/(3600*eh),ah=1/3600,oh=947815e-9,ih=Yd(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,9999995.193,.239006249,.238846191,rh,nh,ah,23.73042222,oh,rh,nh,ah,oh]),uh=Yd(["T","gs","ga"],[1,1e4,1e4]),sh=.0049289216,lh=Yd(["tsp","tspm","tbs","oz","cup","pt","qt","gal","l","uk_pt","us_pt","lt","L","uk_gal","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON"],[1,6636025/6731721,1/3,1/6,1/48,1/96,1/192,1/768,sh,.008675585,1/96,sh,sh,8530/7867471,492892e19,492892e19,1/32256,977/6985011,77/442368,77/442368,77/256,77/256,582074e-59,582074e-59,22/4463451,22/4463451,118251e-20,118251e-20,19/2947205,19/2947205,775941e-21,775941e-21,112266,112266,112266,112266,10/5745039,10/5745039,34/7813253]),ch=Yd(["bit","byte"],[1,1/8]),fh=Yd(["kn","m/s","m/sec","m/h","m/hr","admkn","mph"],[1,463/900,463/900,1852,1852,57875/57912,57875/50292]),dh=Yd(["uk_acre","us_acre","ang2","ang^2","ar","ft2","ft^2","ha","in2","in^2","ly2","ly^2","m2","m^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Picapt2","Pica2","Pica^2","Picapt^2","yd2","yd^2"],[1,.999996000004,404686e18,404686e18,40.468564224,43560,43560,3870320/9563769,6272640,6272640,452135e-34,452135e-34,4046.8564224,4046.8564224,15481280/9563769,1/640,10558/8948409,10558/8948409,32517365760,32517365760,32517365760,32517365760,4840,4840]),hh=Yd(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]);function mh(e,t,r){if(Xa._isBoolean(e)||wn(e,et._astNodes[0]))return Ut.value;if(e=Dn(e,et._astNodes[0]),e=Number(e),isNaN(e))return Ut.value;function n(e,t){return e===t}t=Xn(t),r=Xn(r);var a=273.15,o=459.67;if(!t||!r)return Ut.na;var i=n(t,"C")||n(t,"cel"),u=n(r,"C")||n(r,"cel"),s=n(t,"F")||n(t,"fah"),l=n(r,"F")||n(r,"fah"),c=n(t,"K")||n(t,"kel"),f=n(r,"K")||n(r,"kel"),d=n(t,"Rank"),h=n(r,"Rank"),m=n(t,"Reau"),g=n(r,"Reau");if(i&&u||s&&l||c&&f||d&&h||m&&g)return e;if(i&&l)return 9*e/5+32;if(s&&u)return 5*(e-32)/9;if(s&&f)return 5*(e-32)/9+a;if(c&&l)return 9*(e-a)/5+32;if(i&&f)return e+a;if(c&&u)return e-a;if(i&&h)return 9*e/5+32+o;if(s&&h)return e+o;if(c&&h)return 9*e/5;if(m&&h)return 9*e/4+32+o;if(d&&u)return(e-32-o)/1.8;if(d&&l)return e-o;if(d&&f)return e/1.8;if(d&&g)return(e-o-32)/(9/4);if(i&&g)return 4*e/5;if(s&&g)return(e-32)/(9/4);if(c&&g)return.8*(e-a);if(m&&u)return 5*e/4;if(m&&l)return 9*e/4+32;if(m&&f)return 5*e/4+a;for(var p=[Vd,jd,Kd,zd,Qd,ih,th,uh,lh,ch,fh,dh],v=0;v<td(p);v++){var y=p[v],N=Hd(y,hh,t,p),M=N._hasUnit,R=N._constant,E=N._prefix,_=(N=Hd(y,hh,r,p))._hasUnit,T=N._prefix,S=N._constant;if(M&&_&&0!==R&&0!==T)return e*E/R*S/T}return Ut.na}function gh(e,t){return void 0===t&&(t=0),Xa._isBoolean(e)||Xa._isBoolean(t)||wn(e,et._astNodes[0])||wn(t,et._astNodes[1])?Ut.value:(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=$n(t),isNaN(e)||isNaN(t)?Ut.value:da(e,t)?1:0)}function ph(e,t){return void 0===t&&(t=0),Xa._isBoolean(e)||Xa._isBoolean(t)||wn(e,et._astNodes[0])||wn(t,et._astNodes[1])?Ut.value:(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),e=$n(e),t=$n(t),isNaN(e)||isNaN(t)?Ut.value:e>=t?1:0)}var vh=ea.Z,yh=(vh._isNullOrUndefined,vh._inArray),Nh=vh._isArray,Mh=ra.Z._getLength,Rh=va._pow1p,Eh=Xa._MAX_DOUBLE_VALUE,_h=Xa._daysBetweenBasis,Th=Xa._getDaysInMonth,Sh=Xa._compareDateTime,Ih=Xa._days360,Ch=bn.Z._toOADate,Ah=void 0,wh=null,xh=isFinite;function Dh(e,t,r,n){if(e>-1&&0!==e){var a=r,o=Math.pow(1+e,a._nper-(n?1:0)),i=(Math.pow(1+e,a._nper)-1)/e;return[!0,t=n?-a._pmt*i/e+o*a._nper*(a._pv+a._pmt*(a._type+1/e)):a._pv*o+a._pmt*(1+e*a._type)*i+a._fv,r]}return[!1,t,r]}function bh(e,t,r){return t>0?(r._havexpos?r._havexneg?Math.abs(e-r._xneg)<Math.abs(r._xpos-r._xneg)&&(r._xpos=e,r._ypos=t):t<r._ypos&&(r._xpos=e,r._ypos=t):(r._xpos=e,r._ypos=t,r._havexpos=!0),[!1,r]):t<0?(r._havexneg?r._havexpos?Math.abs(e-r._xpos)<Math.abs(r._xpos-r._xneg)&&(r._xneg=e,r._yneg=t):-t<-r._yneg&&(r._xneg=e,r._yneg=t):(r._xneg=e,r._yneg=t,r._havexneg=!0),[!1,r]):(r._root=e,[!0,r])}function Oh(e,t,r,n,a,o,i,u,s,l,c,f,d,h,m){var g,p,v,y,N=0,M=0,R=r-a,E=r+a,_=2===e;if(R<o._xmin&&(R=r),E>o._xmax&&(E=r),R===E)return _?[!1,n,o,i]:[!1,n,o];if(0===e?(g=t(i,u,s,R,c,f,d,h,m)-l,p=t(i,u,s,E,c,f,d,h,m)-l):1===e?(g=t(R,i,N,u),p=t(E,i,M,u)):(g=Dh(R,N,i),p=Dh(E,M,i)),Nh(g)){if(y=g[2],N=g[1],!(v=g[0]))return _?[v,n,o,y]:[v,n,o]}else N=g;if(Nh(p)){if(y=p[2],M=p[1],!(v=p[0]))return _?[v,n,o,y]:[v,n,o]}else M=p;return n=(M-N)/(E-R),_?[!0,n,o,y]:[!0,n,o]}function Fh(e,t,r){var n=0;if(t<e._xmin||t>e._xmax)return[!1,e,r];var a=Dh(t,n,r);if(r=a[2],n=a[1],!a[0])return[a[0],e,r];var o=bh(t,n,e);return e=o[1],[!!o[0],e,r]}function Lh(e,t,r,n,a,o,i,u,s,l){var c,f=0,d=e?15:2;if(!r._havexpos||!r._havexneg)return e?[!1,r,n]:[!1,r];var h=Math.abs(r._xpos-r._xneg)/(Math.abs(r._xpos)+Math.abs(r._xneg));for(c=0;c<100+4*d;c++){var m,g;if(m=c%4==0?1:c%4==2?2:3,r=(g=e?Bh(r,n,h,f,0,m):t?kh(!0,r,f,0,0,m,Uh,h,a,n,Oh):kh(!1,r,f,0,0,m,zh,h,o,i,u,n,a,s,l))[1],n=g[2],f=e?g[3]:g[2],g[0])return e?[!0,r,n]:[!0,r]}return e?[!1,r,n]:[!1,r]}function Uh(e,t,r,n){for(var a=0,o=Mh(t),i=0;i<o;i++){var u=qh(n[i])-qh(n[0]);if(u<0)return[!1,r];a+=t[i]/Rh(e,u/365)}return xh(a)?r=isNaN(a)?5e-324:a:a===Number.POSITIVE_INFINITY?r=Eh:a===Number.NEGATIVE_INFINITY&&(r=-Eh),[!0,r]}function Bh(e,t,r,n,a,o){var i;if(1===o){var u=Dh(i=(e._xpos+e._xneg)/2,a,t);if(t=u[2],a=u[1],!u[0])return[wh,e,t,n];if(0===a)return[!0,e=bh(i,a,e)[1],t,n];if(0===Math.sqrt(a*a-e._ypos*e._yneg))return[wh,e,t,n]}else if(2===o){var s,l=0,c=0;if(r>.1)return Bh(e,t,r,n,a,o=3);var f=n++%4;if(0===f)s=e._xpos,l=e._ypos;else if(2===f)s=e._xneg,l=e._yneg;else if(t=(u=Dh(s=(e._xpos+e._xneg)/2,l,t))[2],l=u[1],!u[0])return[wh,e,t,n];var d=Oh(2,void 0,s,c,Math.abs(e._xpos-e._xneg)/1e6,e,t);if(t=d[3],e=d[2],c=d[1],!d[0]||0===c)return[wh,e,t,n];if((i=s-1.01*l/c)<e._xpos&&i<e._xneg||i>e._xpos&&i>e._xneg)return[wh,e,t,n]}return[!1,e,t,n]}function kh(e,t,r,n,a,o,i,u,s,l,c,f,d,h,m,g,p){var v;switch(o){case 0:n=t._xpos-t._ypos*((t._xneg-t._xpos)/(t._yneg-t._ypos));break;case 1:if(n=(t._xpos+t._xneg)/2,v=e?i(n,l,a,s):i(f,d,s,n,c,h,m,g,p)-l,Nh(v)){if(a=v[1],!v[0])return[wh,t,r,n,a,o]}else a=v;if(0===a)return[!0,t=bh(n,a,t)[1],r,n,a,o];var y=Math.sqrt(a*a-t._ypos*t._yneg);if(0===y)return[wh,t,r,n,a,o];n+=(n-t._xpos)*a/y;break;case 3:n=(t._xpos+t._xneg)/2;break;case 2:var N,M,R=0,E=0;if(u>.1)return kh(e,t,r,n,a,o=3,i,u,s,l,c,f,d,h,m);var _=r++%4;if(0===_)N=t._xpos,R=t._ypos;else if(2===_)N=t._xneg,R=t._yneg;else if(N=(t._xpos+t._xneg)/2,v=e?i(N,l,R,s):i(f,d,s,N,c,h,m,g,p)-l,Nh(v)){if(R=v[1],!v[0])return[wh,t,r,n,a,o]}else R=v;M=Math.abs(t._xpos-t._xneg)/1e6;var T=e?c(1,i,N,E,M,t,l,s):Oh(0,i,N,E,M,t,f,d,s,l,c,h,m,g,p);if(t=T[2],E=T[1],!T[0]||0===E)return[wh,t,r,n,a,o];if((n=N-1.01*R/E)<t._xpos&&n<t._xneg||n>t._xpos&&n>t._xneg)return[wh,t,r,n,a,o]}return[!1,t,r,n,a,o]}function Ph(e,t,r,n,a,o,i,u,s,l,c,f,d){if(n<r._xmin||n>r._xmax)return[!1,r];var h=bh(n,e?Hh(n,a):t(a,o,i,n,s,l,c,f,d)-u,r);return r=h[1],[!!h[0],r]}function Hh(e,t,r){var n,a=Mh(t),o=0;for(n=0;n<a;n++)o+=(r?-n:1)*t[n]*Math.pow(1+e,-n-1-(r?1:0));return o}function Gh(e,t,r,n){return _h($h(e,t,r,!1),e,n)}function Yh(e,t,r,n){return _h(e,$h(e,t,r,!0),n)}function Vh(e,t,r,n){return yh(n,[0,2,4,5])>=0?360/r:3===n?365/r:_h($h(e,t,r,!1),$h(e,t,r,!0),1)}function $h(e,t,r,n){var a=Zh(t),o=Wh(t),i=Xh(t),u=new Date(1,0,1),s=(Th(a,o),12/r),l=a-Zh(e);u.setFullYear(1),l>0&&(l=(l-1)*r);do{l++,(u=new Date(a,o,i)).setMonth(o-l*s),Xh(u)!==i&&u.setDate(0)}while(Sh(e,u)<0);return n&&(l--,(u=new Date(a,o,i)).setMonth(o-l*s),Xh(u)!==i&&u.setDate(0)),u}function jh(e,t,r){var n=Zh(t),a=Wh(t),o=Xh(t),i=new Date(n,a,o),u=a-Wh(e)+12*(n-Zh(e));if(i.setMonth(Wh(i)-u),o===Th(n,a))for(;Xh(i)!==Th(Zh(i),Wh(i));)i.setDate(Xh(i)+1);return Xh(e)>=Xh(i)&&u--,parseInt((1+u/(12/r)).toString())}function Zh(e){return e.getFullYear()}function Wh(e){return e.getMonth()}function Xh(e){return e.getDate()}function Kh(e,t,r){var n=Zh(t)-Zh(e),a=Wh(t)-Wh(e)+12*n,o=Xh(t)-Xh(e),i=-1;return 0===r?i=Ih(e,t):yh(r,[1,2,3])>=0?i=qh(t)-qh(e):4===r&&(i=30*a+o),i}function qh(e){return e instanceof Date?Ch(e):e}function zh(e,t,r,n,a,o,i){for(var u=Gh(e,t,o,i),s=Yh(e,t,o,i),l=Vh(e,t,o,i),c=parseInt(jh(e,t,o).toString(),10),f=0,d=100*r/o,h=1+n/o,m=s/l,g=0;g<c;g++)f+=d/Math.pow(h,m+g);return a/Math.pow(h,c-1+s/l)+f-u/l*d}var Jh=ea.Z._inArray,Qh=Xa._MAX_DOUBLE_VALUE,em=Xa._compareDateTime,tm=Xa._annualYearBasis,rm=Xa._yearfrac;function nm(e,t){if("boolean"==typeof e)return Ut.value;if(!Array.isArray(t)&&"boolean"==typeof t)return Ut.value;if(e=Dn(e,et._astNodes[0]),isNaN(e))return Ut.value;t=gn(t),t=vt(et._astNodes[1])?t.map((function(e){if(kt(e))return e;var t=Number.parseFloat(e);return isNaN(t)?Ut.value:t})):t.map((function(e){if(kt(e))return e;if(null===e)return 0;var t=Number.parseFloat(e);return isNaN(t)?Ut.value:t}));for(var r,n=f(t);!(r=n()).done;){var a=r.value;if(kt(a))return a}for(var o=t.length,i=e,u=0;u<o;u++)i*=1+t[u];return i}function am(e,t,r,n,a){if(n=n||0,a=void 0===a?0:a,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Ut.value;a=0===a?0:1;var o=Math.pow(1+e,t);return Kn(-(o=0===e?(r+n)/t:(r*o+n)/((1+e*a)*(o-1)/e)))}function om(e,t,r,n,a){var o=am(e,t,r,n,a);return kt(o),o}function im(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(n=void 0===n?0:n,a=void 0===a?0:a,o=void 0===o?.1:o,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o))return Ut.value;a=0===a?0:1;var i={_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},u=Math.pow(17976931348623157e282,1/e);i._xmin=Math.max(-1e10,1-u),i._xmax=Math.min(1e10,u-1);var s={_nper:e,_pmt:t,_pv:r,_fv:n,_type:a},l=function(e,t,r){var n,a=e._precision/2;for(n=0;n<100;n++){var o,i,u,s=0,l=0;if(r<e._xmin||r>e._xmax)return[!1,e,t];var c=Dh(r,s,t);if(t=c[2],s=c[1],!(u=c[0]))return[u,e,t];var f=bh(r,s,e);if(e=f[1],f[0])return[!0,e,t];if(t=(c=Dh(r,l,t,!0))[2],l=c[1],!(u=c[0]))return[u,e,t];if(0===l)return[!1,e,t];if((o=r-1.000001*s/l)===r)return e._root=r,[!0,e,t];if(i=Math.abs(o-r)/(Math.abs(r)+Math.abs(o)),r=o,i<a)return e._root=r,[!0,e,t]}return[!1,e,t]}(i,s,o);s=l[2],i=l[1];var c,f=l[0];if(!f){for(c=2;(!i._havexneg||!i._havexpos)&&c<100;c*=2)s=(l=Fh(i,o*c,s))[2],s=(l=Fh(i=l[1],o/c,s))[2],i=l[1];i=(l=Lh(!0,!1,i,s))[1],f=l[0]}return f?i._root:Ut.num}(e,t,r,n,a,o);return kt(i)||et._funcNode.setFormatType("0.00%"),i}function um(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){return a=void 0===a?0:a,o=void 0===o?0:o,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o)?Ut.value:(o=0===o?0:1,t>=r+1?Ut.num:1===t&&1===o?0:hm(n,dm(e,r,n,a,o),e,t-1,o))}(e,t,r,n,a,o);return kt(i),i}function sm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(a=void 0===a?0:a,o=void 0===o?0:o,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o))return Ut.value;if(o=0===o?0:1,t>=r+1)return Ut.num;var i=dm(e,r,n,a,o);return i-hm(n,i,e,t-1,o)}(e,t,r,n,a,o);return kt(i),i}function lm(e,t,r,n,a){if(n=void 0===n?0:n,a=void 0===a?0:a,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Ut.value;a=0===a?0:1;var o=Math.pow(1+e,t);return Kn(-(o=0===e?r*t+n:n*o+r*(1+e*a)*(o-1)/e))}function cm(e,t,r,n,a){var o=lm(e,t,r,n,a);return kt(o),o}function fm(e,t,r,n,a){var o=function(e,t,r,n,a){if(n=void 0===n?0:n,a=void 0===a?0:a,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Ut.value;if(a=0===a?0:1,0===e)return Kn(-(r*t+n));var o=Math.pow(1+e,t);return-1===e?Ut.div0:Kn(-(n+r*(1+e*a)*(o-1)/e)/o)}(e,t,r,n,a);return kt(o),o}function dm(e,t,r,n,a){var o=Math.pow(1+e,t),i=isFinite(o)?o:Ut.num;return 0===e?t:(o=(o-1)/e,o=(-r*i-n)/((1+e*a)*(isFinite(o)?o:Ut.num)),isFinite(o)?o:Ut.num)}function hm(e,t,r,n,a){if(1===a){var o=-(e*(i=Math.pow(1+r,n-1))*r+t*(1+r)*(i-1))-t*r;return isFinite(o)?o:Ut.num}var i;return o=-(e*(i=Math.pow(1+r,n))*r+t*(i-1)),isFinite(o)?o:Ut.num}function mm(e,t){var r=function(e,t){if(!Array.isArray(e))return Ut.num;if(e=gn(e),t=Dn(t=void 0===t?.1:t,et._astNodes[1]),isNaN(t))return Ut.value;Math.abs(t)>1&&(t=.1);var r=e,n=ra.Z._getLength(r),a=[],o=!1,i=!1,u={_xmin:-1,_xmax:1e10,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0};if(n<2)return Ut.num;u._xmax=Math.min(u._xmax,Math.pow(Qh/1e10,1/n)-1);for(var s=0;s<n;s++){var l=r[s];if(kt(l))return Ut.value;a[s]=l,l>0&&(o=!0),l<0&&(i=!0)}if(!o||!i)return Ut.num;var c=function(e,t,r){var n,a=e._precision/2;for(n=0;n<20;n++){var o,i,u,s;if(r<e._xmin||r>e._xmax)return[!1,e];var l=bh(r,u=Hh(r,t),e);if(e=l[1],l[0])return[!0,e];if(0===(s=Hh(r,t,!0)))return[!1,e];if((o=r-1.000001*u/s)===r)return e._root=r,[!0,e];if(i=Math.abs(o-r)/(Math.abs(r)+Math.abs(o)),r=o,i<a)return e._root=r,[!0,e]}return[!1,e]}(u,a,t);u=c[1];var f,d=c[0];if(!d){for(f=2;(!u._havexneg||!u._havexpos)&&f<100;f*=2)u=Ph(!0,Ah,u,t*f,a)[1],u=Ph(!0,Ah,u,t/f,a)[1];c=function(e,t,r,n,a,o,i,u,s,l,c){var f,d,h=0;if(!t._havexpos||!t._havexneg)return[!1,t];for(d=Math.abs(t._xpos-t._xneg)/(Math.abs(t._xpos)+Math.abs(t._xneg)),f=0;f<160;f++){var m=0,g=0,p=kh(!0,t,h,m,g,f%4==0?1:f%4==2?2:3,Hh,d,Ah,r,Oh);if(t=p[1],h=p[2],m=p[3],p[0]!==wh){if(p[0])return[!0,t];var v=bh(m,g=Hh(m,r),t);if(t=v[1],v[0])return[!0,t];if((d=Math.abs(t._xpos-t._xneg)/(Math.abs(t._xpos)+Math.abs(t._xneg)))<t._precision)return t._yneg<g&&(g=t._yneg,m=t._xneg),t._ypos<g&&(m=t._xpos),t._root=m,[!0,t]}}return[!1,t]}(0,u,a),u=c[1],d=c[0]}return d?u._root:Ut.num}(e,t);return kt(r)||et._funcNode.setFormatType("0.00%"),r}function gm(e,t,r,n,a,o,i){if(t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),i=Dn(i,et._astNodes[6]),isNaN(t)||isNaN(r)||isNaN(a)||isNaN(o)||isNaN(i))return Ut.value;if(t<=0||r<=0||n<=0)return Ut.num;if(a<1||o<1)return Ut.num;if(o<a||o>r||0!==i&&1!==i)return Ut.num;var u,s,l=am(t,r,n,0,i),c=0;for(1===a&&(e&&(c=l),i<=0&&(c+=e?n*t:-n),a++),u=a;u<=o;u++)s=i>0?lm(t,u-2,l,n,1)-l:lm(t,u-1,l,n,0),c+=e?l-s*t:s;return e?c:c*t}function pm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){return gm(!1,e,t,r,n,a,o)}(e,t,r,n,a,o);return kt(i),i}function vm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){return gm(!0,e,t,r,n,a,o)}(e,t,r,n,a,o);return kt(i),i}function ym(e,t){var r=function(e,t){return"boolean"==typeof e||"boolean"==typeof t?Ut.value:(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),isNaN(e)||isNaN(t)?Ut.value:e<=0||t<1?Ut.num:(t=Vn(t),Math.pow(1+e/t,t)-1))}(e,t);return kt(r)||et._funcNode.setFormatType("0.00%"),r}function Nm(e,t){var r=function(e,t){return"boolean"==typeof e||"boolean"==typeof t?Ut.value:(e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),isNaN(e)||isNaN(t)?Ut.value:e<=0||t<1?Ut.num:t*(Math.pow(1+e,1/t)-1))}(e,t);return kt(r)||et._funcNode.setFormatType("0.00%"),r}function Mm(e,t,r,n){var a=function(e,t,r,n){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)?Ut.value:t<0||r<=0||n<=0||n>r?Ut.num:(e-t)*(r-n+1)*2/(r*(r+1))}(e,t,r,n);return kt(a),a}function Rm(e,t,r){var n=function(e,t,r){return e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),isNaN(e)||isNaN(t)||isNaN(r)?Ut.value:0===r?Ut.div0:(e-t)/r}(e,t,r);return kt(n),n}function Em(e,t,r,n,a,o,i){var u=function(e,t,r,n,a,o,i){return i=void 0===i?0:i,e=qn(e),t=qn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),i=Dn(i,et._astNodes[6]),isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o)||isNaN(i)?Ut.value:(o=o>=0?Math.floor(o):Math.ceil(o),i=i>=0?Math.floor(i):math.ceil(i),r<0||n<0||a<=0||Jh(o,[1,2,4])<0||Jh(i,[0,1,2,3,4])<0||em(e,t)>=0?Ut.num:zh(e,t,r,n,a,o,i))}(e,t,r,n,a,o,i);return kt(u),u}function _m(e,t,r,n,a){var o=function(e,t,r,n,a){if(a=void 0===a?0:a,e=qn(e),t=qn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),isNaN(r)||isNaN(n)||isNaN(a))return Ut.value;if(a=a>=0?Math.floor(a):math.ceil(a),r<=0)return Ut.num;if(n<=0)return Ut.num;if(Jh(a,[0,1,2,3,4])<0)return Ut.num;if(em(e,t)>=0)return Ut.num;var o=Kh(e,t,a),i=tm(e,a);return o<=0||i<=0?Ut.num:n-r*n*o/i}(e,t,r,n,a);return kt(o),o}function Tm(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(o=void 0===o?0:o,e=qn(e),t=qn(t),r=qn(r),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r instanceof Date&&r.setHours(0,0,0),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),isNaN(n)||isNaN(a)||isNaN(o))return Ut.value;if(o=o>=0?Math.floor(o):math.ceil(o),n<0)return Ut.num;if(a<0)return Ut.num;if(Jh(o,[0,1,2,3,4])<0)return Ut.num;if(em(e,t)>=0)return Ut.num;if(em(r,e)>=0)return Ut.num;if(em(r,t)>=0)return Ut.num;var i=Kh(e,t,o),u=Kh(r,t,o),s=Kh(r,e,o),l=tm(r,o);if(s<=0||l<=0||i<=0||u<=0)return Ut.num;var c=1+i/l*a;return 0===c?Ut.num:(100+u/l*n*100)/c-s/l*n*100}(e,t,r,n,a,o);return kt(i)||et._funcNode.setFormatType('"¥"#,##0.00_);[Red]\\("¥"#,##0.00\\)'),i}function Sm(e,t,r,n,a,o,i){var u=function(e,t,r,n,a,o,i){if(i=void 0===i?0:i,e=qn(e),t=qn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),i=Dn(i,et._astNodes[6]),isNaN(r)||isNaN(n)||isNaN(a)||isNaN(o)||isNaN(i))return Ut.value;if(o=o>=0?Math.floor(o):Math.ceil(o),i=i>=0?Math.floor(i):math.ceil(i),r<0)return Ut.num;if(n<=0)return Ut.num;if(a<=0)return Ut.num;if(Jh(o,[1,2,4])<0)return Ut.num;if(Jh(i,[0,1,2,3,4])<0)return Ut.num;if(em(e,t)>=0)return Ut.num;if(jh(e,t,o)<=1){var u=Gh(e,t,o,i),s=Yh(e,t,o,i),l=Vh(e,t,o,i);return(a/100+r/o-(n/100+u/l*r/o))/(n/100+u/l*r/o)*(o*l/s)}var c,f=.1,d={_xmin:0,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},h=function(e,t,r,n,a,o,i,u,s,l,c,f,d){var h,m,g,p=r._precision/2;for(h=0;h<20;h++){if(n<r._xmin||n>r._xmax)return[!1,r];var v=t(a,o,i,n,s,l,c,f,d)-u;if(Nh(v)){if(g=v[1],!(m=v[0]))return[m,r]}else g=v;var y=bh(n,g,r);if(r=y[1],y[0])return[!0,r];var N=r._havexneg&&r._havexpos?Math.abs(r._xpos-r._xneg):r._xmax-r._xmin,M=0;if(r=(y=Oh(0,t,n,M,(Math.abs(n)<1e-10?N:Math.abs(n))/1e6,r,a,o,i,u,s,l,c,f,d))[2],M=y[1]<0?y[1]:-y[1],!(m=y[0]))return[m,r];if(0===M)return[!1,r];var R=n-1.000001*g/M;if(R===n)return r._root=n,[!0,r];var E=Math.abs(R-n)/(Math.abs(n)+Math.abs(R));if(n=R,E<p)return r._root=n,[!0,r]}return[!1,r]}(0,zh,d,f,e,t,r,n,a,o,i);if(d=h[1],!(c=h[0])){for(f=1e-10;f<d._xmax;f*=2)d=Ph(!1,zh,d,f,e,t,r,n,a,o,i)[1];d=(h=Lh(!1,!1,d,e,t,r,n,a,o,i))[1],c=h[0]}return c?d._root:Ut.num}(e,t,r,n,a,o,i);return kt(u)||et._funcNode.setFormatType("0.00%"),u}function Im(e,t,r,n,a,o){var i=function(e,t,r,n,a,o){if(o=void 0===o?0:o,e=qn(e),t=qn(t),r=qn(r),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r instanceof Date&&r.setHours(0,0,0),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),o=Dn(o,et._astNodes[5]),isNaN(n)||isNaN(a)||isNaN(o))return Ut.value;if(o=o>=0?Math.floor(o):math.ceil(o),n<0)return Ut.num;if(a<=0)return Ut.num;if(Jh(o,[0,1,2,3,4])<0)return Ut.num;if(em(e,t)>=0)return Ut.num;if(em(r,e)>=0)return Ut.num;if(em(r,t)>=0)return Ut.num;var i=1+rm(r,t,o)*n;return i/=a/100+rm(r,e,o)*n,--i/rm(e,t,o)}(e,t,r,n,a,o);return kt(i)||et._funcNode.setFormatType("0.00%"),i}function Cm(e,t,r,n,a){var o=function(e,t,r,n,a){return a=void 0===a?0:a,e=qn(e),t=qn(t),e instanceof Date&&e.setHours(0,0,0),t instanceof Date&&t.setHours(0,0,0),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),isNaN(r)||isNaN(n)||isNaN(a)?Ut.value:(a=a>=0?Math.floor(a):math.ceil(a),r<=0||n<=0||Jh(a,[0,1,2,3,4])<0||em(e,t)>=0?Ut.num:(n/r-1)/rm(e,t,a))}(e,t,r,n,a);return kt(o)||et._funcNode.setFormatType("0.00%"),o}function Am(e,t,r,n,a){var o=function(e,t,r,n,a){if(a=void 0===a?12:a,e=Dn(e,et._astNodes[0]),t=Dn(t,et._astNodes[1]),r=Dn(r,et._astNodes[2]),n=Dn(n,et._astNodes[3]),a=Dn(a,et._astNodes[4]),isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(a))return Ut.value;if(e<0||t<0)return Ut.num;if(r<=0||n<=0)return Ut.num;if(Jh(a,[1,2,3,4,5,6,7,8,9,10,11,12])<0)return Ut.num;if(r+(a<12?1:0)<n)return Ut.num;if(0===e)return 0;for(var o=va._round(1-Math.pow(t/e,1/r),3),i=0,u=0,s=1;s<=n;s++)i+=u=1===s?e*o*a/12:s===r+1?(e-i)*o*(12-a)/12:(e-i)*o;return u}(e,t,r,n,a);return kt(o),o}var wm=ea.Z._isNullOrUndefined,xm=ra.Z._getLength;function Dm(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=gn(t);for(var n=!0,a=0;a<t.length;a++)t[a]||(n=!1),""!==t[a]&&"string"!=typeof t[a]||(n=Ut.value);return n}function bm(){return!1}function Om(e,t,r){var n,a,o,i;return ft(e)&&(e=e.toArray()[0]),_n(e)?(et._instance.custom.setExtraCalcResult({hyperlink:""}),e):(e&&(null===(n=et._astNodes[1])||void 0===n?void 0:n.hyperLink)?et._instance.custom.setExtraCalcResult({hyperlink:null===(a=et._astNodes[1])||void 0===a?void 0:a.hyperLink}):void 0!==r&&(null===(o=et._astNodes[2])||void 0===o?void 0:o.hyperLink)?et._instance.custom.setExtraCalcResult({hyperlink:null===(i=et._astNodes[2])||void 0===i?void 0:i.hyperLink}):et._instance.custom.setExtraCalcResult({hyperlink:""}),e?t:void 0!==r&&r)}function Fm(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=gn(t);for(var n=!1,a=0;a<t.length;a++)if(null===t[a]&&(n=Ut.value),t[a]){n=!0;break}return n}function Lm(){return!0}function Um(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0];if(ft(n)&&(n=zn(n)[0]),So(n))return n;var a=Vn(n);return a<1||xm(t)<=a?Ut.value:wm(t[a])?0:t[a]}function Bm(e){if(An(e,et._astNodes[0]))return Ut.value;if("string"==typeof e)switch(e.toLowerCase()){case"true":e=!0;break;case"false":case"":e=!1;break;default:return Ut.value}var t={};return Wn(e,t),!t.value}function km(){for(var e=[],t=0,r=arguments.length;t<r;t++){var n=t<0||arguments.length<=t?void 0:arguments[t];if(Array.isArray(n))n=(n=gn(n)).filter((function(e){return"number"==typeof e||"boolean"==typeof e})),e=e.concat(n);else{if("number"!=typeof n&&"boolean"!=typeof n)return Ut.value;e.push(n)}}var a,o=0;for(a=0;a<xm(e);a++)e[a]&&o++;return!!(o%2)}function Pm(e,t){var r=t._element.row,n=t._element.col;return et._instance.custom.getValueByTopCellPosition(e,r,n)}var Hm=((e={})[Dt.u7.BOOL]=function(e,t){return ft(e)&&!e.isCell&&(e=Pm(e,t)),e},e[Dt.u7.STRING]=function(e,t){return ft(e)&&!e.isCell&&(e=Pm(e,t)),e},e[Dt.u7.NUMBER]=function(e,t){return ft(e)&&!e.isCell&&(e=Pm(e,t)),e},e[Dt.u7.DATE]=function(e,t){return ft(e)&&!e.isCell&&(e=Pm(e,t)),e},e[Dt.u7.ARRAY]=function(e){return e},e[Dt.u7.NOT_ARRAY]=function(e,t){return ft(e)&&!e.isCell&&(e=Pm(e,t)),e},e[Dt.u7.ANY]=function(e){return e},e);function Gm(e,t,r){if(!Dt.BT[e])for(var n=t._funcNode.calculateParentFunctionNode,a=0;a<r.length;a++){var o=r[a];if(!ft(o))if(n&&Dt.A1[n.funcName]){if(kt(n.expandValue))throw new Error(node.expandValue)}else if(kt(o))throw new Error(o)}}function Ym(e,t,r,n,a,o){if(o===Dt.u7.ARRAY)return!1;if(o===Dt.u7.ANY&&!Dt.v_[e])return!1;var i=!1,u=r[n],s=vt(t)||!Rt(t)&&Array.isArray(u);if(i=s,!s&&ft(u)&&!u.isCell){var l=et._instance,c=l.helper.getRangeValue;a=a&&a.calculateParentFunctionNode;for(var f=1e3;a&&f-- >0;){var d=a&&a.funcName;if(Dt.A1[d]){for(var h=[],m=Dt.v_[e],g=0;g<u.identities.length;g++){var p=u.getIdentities(g),v=p.rowCount,y=p.colCount;if("ROW"===e&&(y=1),"COLUMN"===e&&(v=1),m){for(var N=l.helper.cellValueCalcFunc,M=0;M<v;M++){h[M]=h[M]||[];for(var R=0;R<y;R++){var E={row:M+p.row,col:R+p.col,rowCount:1,colCount:1,sheetId:p.sheetId,refType:x.NORMAL};h[M].push(new lt([E],!0,N))}}h=[h]}else{var _=c({newLine:p.colCount},p);h.push(_)}}r[n]=h,i=!0;break}a=a&&a.calculateParentFunctionNode}}return i}function Vm(e,t){if(ft(e)&&(!t||!t.acceptRef)){var r=et._instance.helper.getRangeValue,n=e.getIdentities(0),a=r({newLine:n.colCount},n);e=e.isCell?a[0]:[a]}return e}function $m(e,t,r){var n=et._instance.helper.getRangeValue,a=et,o=Dt.tM[t],i=[],u=function(e,t,r,n){var a=r,o=0,i=0,u=!1;if(t){!function(e,t){var r,n,a,o,i,u,s=(r=t,a=(n=(n={min:e.min,max:e.max})||{}).min,o=n.max,i=r.length,u="",void 0!==a&&i<a&&(u=Ut.paramsLack),void 0!==o&&i>o&&(u=Ut.paramsOver),u);if(s)throw new Error(s)}(t,r);var s=t.argumentsType;if(Array.isArray(s)){a=[];for(var l=0;l<r.length;l++){var c=s[l]||Dt.u7.ANY;if(Ym(e,n._astNodes[l],r,l,n._funcNode,c)){var f=r[l][0];if(i=i>f[0].length?i:f[0].length,o=o>f.length?o:f.length,"ROW"===e&&(i=1),"COLUMN"===e&&(o=1),Dt.JJ[e]){a.push(r[l][0][0][0]);continue}u=!0,f.isUserRange=!0,a.push(f)}else{var d=r[l],h=Hm[c];"function"==typeof h&&(d=h(d,n)),Dt.xU[e]||(d=Cn(d)),null!==(d=Vm(d,t))||Dt.yc[e]||(d=""),a.push(d)}}}}return{newArgs:a,canExpand:u,rowCount:o,colCount:i}}(t,o,r,a),s=u.newArgs,l=u.canExpand,c=u.rowCount,f=u.colCount;if(l){var d;!function(e,t,r){for(var n=0;n<e.length;n++){var a="",o=e[n],i=1===o.length,u=o[0]&&1===o[0].length&&o.length>1;o.isUserRange||(a=o,e[n]=[[o]],o=e[n]);for(var s=0;s<t;s++){void 0===o[s]&&(o[s]=[]);for(var l=0;l<r;l++)if(void 0===o[s][l]){var c=void 0;void 0===(c=i?o[0][l]:u?o[s][0]:o[s][l])&&(c=a),e[n][s][l]=c}}}}(s,c,f);for(var h=!1,m=0;m<s[0].length;m++)for(var g=0;g<s[0][m].length;g++){for(var p=void 0,v=[],y=0;y<s.length;y++)v.push(s[y][m][g]);void 0===i[m]&&(i[m]=[]),Gm(t,a,v);try{p=e.apply(void 0,v)}catch(e){p=e&&e.message||Ut.error}!d&&kt(p)&&(d=p),h||!Array.isArray(p)&&!ft(p)||(h=!0),i[m][g]=p}if(h){for(var N=[],M=0;M<i.length;M++)for(var R=0;R<i[M].length;R++){var E=i[M][R];if(Array.isArray(E))N.push(E[0]);else if(ft(E)){var _=E.getIdentities(0);_.refType===x.CELL?N.push([n({newLine:_.colCount},_)]):N.push(n({newLine:_.colCount},_))}else N.push([[E]])}i=N}else i=[i];i.errorValue=d}else{for(var T=0;T<s.length;T++){var S=s[T];Dt.xU[t]||(S=Cn(S)),S=Vm(S,o),Dt.yc[t]||null!==S||(S=""),s[T]=S}Gm(t,a,s),i=e.apply(void 0,s)}return i}var jm={};[d,g,E,_,m,T,M,y,N,R].forEach((function(e){Object.keys(e).forEach((function(t){if("object"==typeof e[t]){var r=e[t];Object.keys(r).forEach((function(e){var n=t+"."+e;jm[n]||(jm[n]=$m.bind(void 0,r[e],n))}))}else jm[t]||(jm[t]=$m.bind(void 0,e[t],t))}))}));var Zm={RANK:jm["RANK.EQ"],NETWORKDAYS:jm["NETWORKDAYS.ORIGIN"],CONFIDENCE:jm["CONFIDENCE.NORM"],POISSON:jm["POISSON.DIST"],QUARTILE:jm["QUARTILE.INC"],STDEV:jm["STDEV.S"],VAR:jm["VAR.S"],WORKDAY:jm["WORKDAY.ORIGIN"],SKEW:jm["SKEW.ORIGIN"],CEILING:jm["CEILING.ORIGIN"],FLOOR:jm["FLOOR.ORIGIN"],MODE:jm["MODE.SNGL"],PERCENTRANK:jm["PERCENTRANK.INC"],ERF:jm["ERF.ORIGIN"],ERFC:jm["ERFC.PRECISE"]};Object.assign(jm,Zm);var Wm=jm,Xm=Object.assign({},u),Km=function(e,t){return void 0===t&&(t=""),e+"_"+t},qm=function(e,t){return e.sheetId+"_"+e.row+"_"+e.col+"_"+t},zm=function(e,t){if(e.sheetId!==t.getAffectedSheetId())return e;var r=e.row,n=e.col;if(Ge(t)){var a=t.index,o=t.amount,i=t.type;(i===Y.ROWS?r>=a:n>=a)&&(r+=i===Y.ROWS?o:0,n+=i===Y.COLUMNS?o:0)}else if(Ye(t)){var u=t.index,s=t.amount,l=t.type;if(l===Y.ROWS?r===u:n===u)return null;(l===Y.ROWS?r>u:n>u)&&(r+=l===Y.ROWS?-s:0,n+=l===Y.COLUMNS?-s:0)}else if(Ve(t)){var c=t.row,f=t.column;if(-1!==c.to){var d=c.from,h=d.startIndex,m=d.endIndex,g=c.to-c.from.startIndex;r>=h&&r<=m&&(r+=g)}if(-1!==f.to){var p=f.from,v=p.startIndex,y=p.endIndex,N=f.to-f.from.startIndex;n>=v&&r<=y&&(n+=N)}}return{sheetId:e.sheetId,row:r,col:n}},Jm=function(){function e(){this.isCalculating=!1,this.asyncCalculateTaskMap=new Map}var t=e.prototype;return t.setTask=function(e,t,r){this.asyncCalculateTaskMap.set(qm(e,r),t)},t.getTask=function(e,t){return this.asyncCalculateTaskMap.get(qm(e,t))},t.stopTask=function(e,t){var r=this.asyncCalculateTaskMap.get(qm(e,t));r&&r.resolve(!0)},t.dealWithAsyncTask=function(e,t){var r=function(e){return e},n=null==e?void 0:e.resolve,a=new Promise((function(e){r=function(t){return e(t),null==n||n(!0),!0}}));return e&&(e.resolve=function(e){return e}),{resolve:r,promise:a,dependencyTasks:t}},t.handleUserChange=function(e){if(!this.isCalculating)return null;if(!function(e){return e.id===$.INSERT_DIMENSION_MUTATION||e.id===$.DELETE_DIMENSION_MUTATION||e.id===$.MAP_RANGE_MUTATION}(e))return null;var t=[];return this.asyncCalculateTaskMap.forEach((function(r,n){var a=function(e){var t=e.split("_"),r=t[0],n=t[1],a=t[2],o=Number(n),i=Number(a);return!r||Number.isNaN(o)||Number.isNaN(i)?null:{sheetId:r,row:o,col:i}}(n);if(a){var o=zm(a,e);o&&t.push(o)}})),t},t.startCalculateAsyncFunction=function(){this.isCalculating=!0},t.finishCalculateAsyncFunction=function(){0===this.asyncCalculateTaskMap.size&&(this.isCalculating=!1),this.asyncCalculateTaskMap.clear()},t.getTaskMap=function(){return this.asyncCalculateTaskMap},t.stopAllTask=function(){this.asyncCalculateTaskMap.forEach((function(e){e.resolve(!0)}))},e}(),Qm=function(){function e(e){var t=this;this.cellMap=xt,this.asyncTaskManager=new Jm,this.customFunctionRegistry={},this.extraCalcResultCache=null,this.getResultBySingleFormula=function(e,r){var n=function(e){return{row:-1,col:-1,sheetId:e}}(r),a={row:n.row,col:n.col,rowCount:t.externalMethods.countRows(r),colCount:t.externalMethods.countCols(r),id:jt(n.row,n.col),sheetId:r},o=t.getAstByCellInfo({cellInfo:a,formula:e}),i=t.calculateAndRunPostProcessing({ast:o,formula:e,cellInfo:a},n),u=(0,vr.zH)(i.result);return{ast:o,result:i.result,isError:u}},this.setExtraCalcResult=function(e){var r=t.extraCalcResultCache;r?Object.assign(r,e):t.extraCalcResultCache=e},this.getValueByTopCellPosition=function(e,r,n){if(ft(e)){var a,o;e.identities.length;var i=(o=e.identities[0]).sheetId;if(1===o.colCount&&1===o.rowCount)a=t.calculateService.helper.getCellValueByData(o.row,o.col,i);else if(1===o.colCount){if(r>o.row+o.rowCount-1||r<o.row)return Ut.value;var u=o.col,s=r;a=t.calculateService.helper.getCellValueByData(s,u,i)}else if(1===o.rowCount){if(n>o.col+o.colCount-1||n<o.col)return Ut.value;var l=o.row,c=n;a=t.externalMethods.getCellValue(l,c,i)}return void 0!==a?a:Ut.value}},this.externalMethods=e,this.formulaParser=new pr({getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,getSheetNames:e.getSheetNames,getSheetNameBySheetId:e.getSheetNameBySheetId,getSheetIdBySheetName:e.getSheetIdBySheetName}),this.calculateService=new(function(){return function(e){var t=this;this.formulas=Wm,this.bindExternalMethod=function(e){t.custom=e},this.getExternalMethod=function(){return t.custom},this.calculate=function(e,r){t.element=r,function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];Ft()&&(t=console).log.apply(t,[e].concat(n))}("|| === 开始计算"),t.helper.setCalculateService(t);var n=t.helper.calculateAstNode(e.body);return e.setValue(n),n},this.NODE_TYPE=e,this.helper=Xm,this.helper.setCalculateService(this)}}())({AST_TYPE:C,CROSS_TABLE_TYPE:A,CELL_RANGE_TYPE:x,VARIABLE_TYPE:w,RANGE_BINARY_TYPE:D});var r={getCellHyperlink:e.getCellHyperlink,countCols:e.countCols,countRows:e.countRows,getSheetIdBySheetName:e.getSheetIdBySheetName,getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,parse:this.formulaParser.parse.bind(this.formulaParser),addDependency:e.addDynamicDependency,cellValue:e.getCellValue,cellEditValue:e.getCellEditValue,getValueByTopCellPosition:this.getValueByTopCellPosition,isCellHidden:e.isCellHidden,setExtraCalcResult:this.setExtraCalcResult.bind(this)};this.calculateService.bindExternalMethod(r),this.resetPerformanceInfo()}var t=e.prototype;return t.getPerformanceInfo=function(){return this.performanceInfo},t.resetPerformanceInfo=function(){this.performanceInfo={formulaCount:0,asyncFormulaCount:0,calculateFormulaDuration:0,formatDuration:0,parseDuration:0,calculateDuration:0,calculateCount:0}},t.destroy=function(){this.asyncTaskManager.finishCalculateAsyncFunction(),this.cellMap.destroy(),this.resetPerformanceInfo()},t.formulaBecomeConstant=function(e){var t=this,r=Km(b);e.forEach((function(e){t.asyncTaskManager.stopTask(e,r)}))},t.handleUserChange=function(e){this.asyncTaskManager.handleUserChange(e),this.asyncTaskManager.finishCalculateAsyncFunction()},t.calculateTopSortNodes=function(e,t,r,n){var a=this,o=t.afterCalculateSingleNodeHook,i=t.afterCalculateAllSyncNodes,u=t.afterCalculateAllAsyncNodes,s=t.beforeEveryCalculation;void 0===n&&(n=b);var l=new Set;e.forEach((function(e){var t=e.range,r=e.id,i=e.isInCycle,u=t.sheetId;ae(t,(function(e,t){var c={row:e,col:t,sheetId:u,id:r,isInCycle:i},f=Date.now(),d=a.getFormulaModelAndAST(c,n),h=a.analyseAsyncNode({ast:null==d?void 0:d.ast,node:c,customType:n}),m=h.isAsyncNode,g=h.asyncTask;if(m)l.add({sortedNode:c,task:g});else if(d)if(s(c,{customType:n}))o({result:{result:{displayText:"#FUNC!",type:At.ERROR}},formulaInfo:d,sortedNode:c,customType:n});else{a.performanceInfo.formulaCount+=1;var p=a.calculateAndRunPostProcessing(d,c),v=Date.now()-f;a.performanceInfo.formulaCount+=1,a.performanceInfo.calculateDuration+=v,a.clearExtraCalcResult(),a.afterCalculateResult({result:p,formulaInfo:d,formulaModel:d.formulaModel,sortedNode:c,customType:n,afterCalculateSingleNodeHook:o})}}),{rowCount:a.externalMethods.countRows(u),colCount:a.externalMethods.countCols(u)})})),l.size>0&&(this.calculateTopSortNodesAsync(l,n,{afterCalculateSingleNodeHook:o,afterCalculateAllAsyncNodes:u}),this.performanceInfo.asyncFormulaCount+=l.size),i({customType:n}),et.clearCache()},t.registerCustomFormula=function(e,t,r,n){if(void 0===n&&(n=!1),!this.hasCustomFormulaRegistered(e)){var a=function(e){return t.apply(this,e)};this.customFunctionRegistry[e]=a,this.calculateService.formulas[e]=a,Dt.tM[e]=r,Dt.fR[e]=r,Dt.kY[e]=n}},t.hasCustomFormulaRegistered=function(e){return void 0!==this.customFunctionRegistry[e]},t.analyseAsyncNode=function(e){var t,r,n=this,a=e.ast,o=e.node,i=e.customType,u=Km(i,o.id),s=this.asyncTaskManager.getTask(o,u),l=ht(a)&&(null===(t=a.getAsyncFunctionNodeList())||void 0===t?void 0:t.length)>0,c=[];(s||l)&&(c=this.getNodeDependencyTasks(o,i));var f=c.length>0,d=l||f;if(d){r=this.asyncTaskManager.dealWithAsyncTask(s,c),this.asyncTaskManager.setTask(o,r,u);var h=o.sheetId,m=o.row,g=o.col,p=new k(h,m,m,g,g);this.externalMethods.getReferencedCellNode(p,i,(function(e){var t=e.offsetRefRange,a=e.inDegreeSegmentNode,o=e.customType,i=t.sheetId,u=Km(o,a.getId());ae(t,(function(e,t){n.asyncTaskManager.setTask({sheetId:i,row:e,col:t},{resolve:function(e){return e},promise:Promise.resolve(!1),dependencyTasks:[r.promise]},u)}))}))}else s&&s.resolve(!0);return{isAsyncNode:d,asyncTask:r}},t.calculateTopSortNodesAsync=function(e,t,r){var n=r.afterCalculateSingleNodeHook,a=r.afterCalculateAllAsyncNodes;return tt(this,void 0,void 0,c().mark((function r(){var o,i,u,s,l,d,h,m=this;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(this.asyncTaskManager.startCalculateAsyncFunction(),o=[],i=f(e);!(u=i()).done;)s=u.value,l=s.sortedNode,d=s.task,h=this.runAsyncCalculate({sortedNode:l,task:d,afterCalculateSingleNodeHook:n,customType:t}),o.push(h);return r.abrupt("return",Promise.all(o).then((function(){m.asyncTaskManager.finishCalculateAsyncFunction(),a({customType:t})})));case 4:case"end":return r.stop()}}),r,this)})))},t.runAsyncCalculate=function(e){var t=e.sortedNode,r=e.task,n=e.customType,a=e.afterCalculateSingleNodeHook;return tt(this,void 0,void 0,c().mark((function e(){var o=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return tt(o,void 0,void 0,c().mark((function o(){var i,u,s,l;return c().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Promise.all(r.dependencyTasks);case 2:if(i=this.getFormulaModelAndAST(t,n),u=Km(n,t.id),i&&ht(i.ast)){o.next=5;break}return o.abrupt("return",(this.asyncTaskManager.getTaskMap().delete(qm(t,u)),r.resolve(!1),void e()));case 5:return o.next=7,this.calculateAsyncNodes(i.ast);case 7:return s=!1,r.resolve(s),o.next=11,r.promise.then((function(e){s=e}));case 11:if(!s){o.next=13;break}return o.abrupt("return",(this.asyncTaskManager.getTaskMap().delete(qm(t,u)),void e()));case 13:l=this.calculateAndRunPostProcessing(i,t),this.afterCalculateResult({result:l,formulaInfo:i,formulaModel:i.formulaModel,sortedNode:t,customType:n,afterCalculateSingleNodeHook:a}),this.asyncTaskManager.getTaskMap().delete(qm(t,u)),e();case 15:case"end":return o.stop()}}),o,this)})))})));case 1:case"end":return e.stop()}}),e)})))},t.calculateAsyncNodes=function(e){return tt(this,void 0,void 0,c().mark((function t(){var r,n,a,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===(r=e.getAsyncFunctionNodeList()).length){t.next=9;break}n=f(r);case 3:if((a=n()).done){t.next=9;break}return o=a.value,t.next=7,this.calculateService.helper.asyncCalculate(o);case 7:t.next=3;break;case 9:case"end":return t.stop()}}),t,this)})))},t.getNodeDependencyTasks=function(e,t){var r=this,n=[],a=e.sheetId,o=e.row,i=e.col,u=new k(a,o,o,i,i);return this.externalMethods.getDependencyCellNode(u,t,(function(e){var t=e.offsetRefRange,a=e.customType,o=e.outDegreeSegmentNode,i=Km(a,o.getId()),u=t.sheetId;ae(t,(function(e,t){var a=r.asyncTaskManager.getTask({sheetId:u,row:e,col:t},i);a&&n.push(a.promise)}))})),n},t.getFormulaModelAndAST=function(e,t){var r=this.externalMethods.getFormulaDataByRowCol(e,{customType:t,id:e.id});if(!r)return null;var n=r.cellInfo,a=r.formulaModel,o=r.formulaString;return{ast:this.getAstByCellInfo({cellInfo:n,formula:o}),formula:o,formulaModel:a,cellInfo:n}},t.calculateAndRunPostProcessing=function(e,t){var r,n=e.ast,a=e.formula,o=e.cellInfo;r=t.isInCycle?{result:"#CIRCLE!",error:"#CIRCLE!"}:this.calculateCell({ast:n,formula:a,cellInfo:o});var i=Date.now(),u=this.dealWithResultAfterCalculate(n,r);this.performanceInfo.formatDuration+=Date.now()-i;var s=u.result;if(u.error){var l=u.error;s={displayText:l,type:Zt[l]||At.ERROR}}return Object.assign(Object.assign({},this.getExtraCalcResult()),{result:s})},t.afterCalculateResult=function(e){var t=e.result,r=e.formulaInfo,n=e.sortedNode,a=e.customType,o=e.afterCalculateSingleNodeHook;this.analyseCalculateNode(r,n),o({result:t,formulaInfo:r,sortedNode:n,customType:a})},t.getAstByCellInfo=function(e){var t,r=e.cellInfo,n=e.formula;n=(t=n)?t.length>=1&&"="===t[0]?t.substr(1,t.length):t:"";var a=Date.now(),o=this.formulaParser.parse(n,r),i=Date.now()-a;return this.performanceInfo.parseDuration+=i,o},t.calculateCell=function(e){var t,r=e.ast,n=e.formula,a=e.cellInfo;if(function(e){return!(ht(e)&&e.body)}(r))return"#ERROR!"===r.error&&n.indexOf("#REF!")>-1&&(r.error="#REF!"),{result:""===n?"=":r.error,error:r.error};try{var o=Date.now();t=this.calculateService.calculate(r,a);var i=Date.now()-o;this.performanceInfo.calculateFormulaDuration+=i}catch(r){console.error("函数计算时出现错误",r),t="object"==typeof r?r.message:Ut.error}return this.performanceInfo.calculateCount+=1,{result:Vt(t,15)}},t.dealWithResultAfterCalculate=function(e,t){if(!ht(e))return t;if(Et(e.body)&&(0,vr.de)(e.body))return t;var r=function(e,t,r){var n,a=t.error;if(Array.isArray(t.result))try{n=t.result[0][0][0]}catch(e){n=Ut.value}else if(ft(t.result)&&ht(e)){try{var o=t.result;n=t.result.isCell?o.toArray()[0]:r(o,e.row,e.col)}catch(e){n="object"==typeof e?e.message:Ut.error}null===n&&(n=0)}else n=t.result;return{result:n,error:a}}(e,t,this.getValueByTopCellPosition.bind(this)),n=r.result;return kt(n)&&(r.error=n),function(e){return e===Ut.circle}(r.result)&&(r.result=Ut.ref,r.error=Ut.ref),r},t.getExtraCalcResult=function(){return this.extraCalcResultCache},t.clearExtraCalcResult=function(){this.extraCalcResultCache=null},t.analyseCalculateNode=function(e,t){var r,n,a,o,i=e.formula,u=e.formulaModel,s=t.sheetId,l=t.row,c=t.col;/\bRAND\b\(|\bNOW\b\(|\bRANDBETWEEN\b\(/g.test(i)?null===(n=(r=this.externalMethods).addAlwaysNeedCalculateNodeHook)||void 0===n||n.call(r,{sheetId:s,row:l,col:c,formulaModel:u,nodeInfo:void 0}):/STOCK\(\s*"(\w+(\.\w+)*)\.([A-Z]+)"\s*,\s*8\s*\)/i.test(i)&&(null===(o=(a=this.externalMethods).addTimingCalculateNodeHook)||void 0===o||o.call(a,{sheetId:s,row:l,col:c,formulaModel:u,nodeInfo:void 0}))},e}(),eg=function(){function e(){this.nodeMap={}}var t=e.prototype;return t.handleUserChange=function(e){var t=this,r=this.getAllNodes();this.nodeMap={},r.forEach((function(r){var n=zm(r,e);null!==n&&t.addNode(Object.assign(Object.assign({},r),{row:n.row,col:n.col}))}))},t.addNode=function(e){var t;if(null!==e){var r=e.row,n=e.col,a=e.sheetId;void 0===this.nodeMap[a]&&(this.nodeMap[a]=[]),void 0===this.nodeMap[a][r]&&(this.nodeMap[a][r]=[]),(null===(t=this.nodeMap[a][r][n])||void 0===t?void 0:t.formulaModel)||(this.nodeMap[a][r][n]=e)}},t.removeNode=function(e){var t=e.row,r=e.col,n=e.sheetId;void 0!==this.nodeMap[n]&&void 0!==this.nodeMap[n][t]&&delete this.nodeMap[n][t][r]},t.addNodes=function(e){var t=this;e.forEach((function(e){t.addNode(e)}))},t.removeNodes=function(e){var t=this;e.forEach((function(e){t.removeNode(e)}))},t.clear=function(){this.nodeMap={}},t.getAllNodes=function(){var e=[];return Object.entries(this.nodeMap).forEach((function(t){t[1].forEach((function(t){t.forEach((function(t){e.push(t)}))}))})),e},e}(),tg=function(){function e(e){var t=this;this.latestAddedDynamicNodes={},this.afterCalculateSingleNode=function(e){if(t.needRecalculate)return!0;var r=e.result,n=e.formulaInfo,a=e.sortedNode,o=e.customType;return t.externalMethods.afterCalculateCellNode({result:r,formulaInfo:n,sortedNode:a,customType:o})},this.afterCalculateAllNodes=function(e){if(t.needRecalculate)return!0;t.externalMethods.afterCalculateAllNodes(e)},this.calculateCenter=new Qm(Object.assign(Object.assign({},e),{addDynamicDependency:this.hijackAddDependency.bind(this)})),this.externalMethods=e}var t=e.prototype;return t.destroy=function(){this.calculateCenter.destroy()},t.calculateSingleFormula=function(e,t){return this.calculateCenter.getResultBySingleFormula(e,t)},t.handleUserChange=function(e){this.calculateCenter.handleUserChange(e)},t.removeNodes=function(e){this.calculateCenter.formulaBecomeConstant(e)},t.calculateTopSortResult=function(e){for(var t=0,r=Object.entries(e);t<r.length;t++){var n=r[t],a=n[0],o=n[1];o&&0!==o.length?this.calculateTopSortNodes(o,{customType:a}):this.afterCalculateAllNodes({customType:a})}},t.calculateTopSortNodes=function(e,t){var r,n;this.currentCustomType=t.customType,this.externalMethods.beforeBatchCalculate();var a={afterCalculateSingleNodeHook:this.afterCalculateSingleNode,afterCalculateAllSyncNodes:this.afterCalculateAllNodes,afterCalculateAllAsyncNodes:this.afterCalculateAllNodes,beforeEveryCalculation:this.externalMethods.beforeCalculateSingleNode};this.needRecalculate=!1,this.calculateCenter.calculateTopSortNodes(e,a,0,t.customType);for(var o=0;this.needRecalculate&&o<100;){console.warn("函数检测到动态依赖，开始重算"),this.needRecalculate=!1,null===(n=(r=this.externalMethods).afterNodesChangedHook)||void 0===n||n.call(r,{customNodeType:b,graphSegmentType:I.DYNAMIC,inDegreeNodesMap:this.latestAddedDynamicNodes}),this.latestAddedDynamicNodes={};var i=Fe(e),u=this.externalMethods.getRecalculateTopSortNodesByChangedNodes(i)[t.customType];if(!u)return;this.calculateCenter.calculateTopSortNodes(u,a,0,t.customType),o+=1}this.latestAddedDynamicNodes={}},t.hijackAddDependency=function(e,t){var r=new Pe(new k(e.sheetId,e.row,e.row,e.col,e.col)),n=new Pe(new k(t.sheetId,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)),a=this.externalMethods.addDynamicDependency({inDegreeNode:r,outDegreeNode:n,customType:this.currentCustomType});return a&&(this.needRecalculate=!0,this.latestAddedDynamicNodes[e.sheetId]||(this.latestAddedDynamicNodes[e.sheetId]=[]),this.latestAddedDynamicNodes[e.sheetId].push(r)),a},e}(),rg=function(){function e(e){var t=this;this.calculateTimingFormulas=function(){var e=t.timingRecalculateNodeContainer.getAllNodes();e.length>0&&t.calculateSomeNodesImmediately(e)},this.afterCalculateAllNodes=function(e){var r=e.customType;t.externalMethods.afterCalculateAllNodes({customType:r})},this.externalMethods=e,this.formulaGraph=new Je({getFormulaModelByRowCol:e.getFormulaModelByRowCol,getSheetIdBySheetIndex:e.getSheetIdBySheetIndex,getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,isNodeNeedCalculateHook:e.isNodeNeedCalculateHook}),this.calculateLogicService=new tg({getCellHyperlink:e.getCellHyperlink,isCellHidden:e.isCellHidden,getCellEditValue:e.getCellEditValue,getCellValue:e.getCellValue,countRows:e.countRows,countCols:e.countCols,getSheetIdBySheetName:e.getSheetIdBySheetName,getSheetIdsAmongTwoSheets:e.getSheetIdsAmongTwoSheets,getSheetNames:e.getSheetNames,getSheetNameBySheetId:e.getSheetNameBySheetId,getFormulaModelByRowCol:e.getFormulaModelByRowCol,getFormulaDataByRowCol:e.getFormulaDataByRowCol,addDynamicDependency:this.formulaGraph.addDynamicDependency.bind(this.formulaGraph),getDependencyCellNode:this.formulaGraph.getDepRangeByRefRange.bind(this.formulaGraph),getReferencedCellNode:this.formulaGraph.getRefRangeByDepRange.bind(this.formulaGraph),getRecalculateTopSortNodesByChangedNodes:this.formulaGraph.getRecalculateTopSortNodesByChangedNodes.bind(this.formulaGraph),addAlwaysNeedCalculateNodeHook:this.addAlwaysCalculateNode.bind(this),addTimingCalculateNodeHook:this.addTimingCalculateNode.bind(this),beforeBatchCalculate:e.beforeBatchCalculate,beforeCalculateSingleNode:e.beforeCalculateSingleNode,afterCalculateAllNodes:this.afterCalculateAllNodes.bind(this),afterNodesChangedHook:this.externalMethods.afterNodesChangedHook,afterCalculateCellNode:e.afterCalculateSingleNode}),this.batchCalculateNodeContainer=new eg,this.alwaysNeedRecalculateNodeContainer=new eg,this.timingRecalculateNodeContainer=new eg,this.timingRecalculateTimer=setInterval(this.calculateTimingFormulas,6e4)}var t=e.prototype;return t.destroy=function(){clearInterval(this.timingRecalculateTimer),this.timingRecalculateNodeContainer.clear(),this.alwaysNeedRecalculateNodeContainer.clear(),this.batchCalculateNodeContainer.clear(),this.formulaGraph.destroy(),this.calculateLogicService.destroy()},t.commitChangingMutation=function(e){var t,r;if(void 0!==e){this.batchCalculateNodeContainer.handleUserChange(e),this.timingRecalculateNodeContainer.handleUserChange(e),this.alwaysNeedRecalculateNodeContainer.handleUserChange(e);var n=this.formulaGraph.commitMutation(e),a=n.needRecalculateNodes,o=n.isGraphChange;this.batchCalculateNodeContainer.addNodes(a),o&&(null===(r=(t=this.externalMethods).afterNodesChangedHook)||void 0===r||r.call(t)),(Ge(e)||Ye(e)||Ve(e))&&this.calculateLogicService.handleUserChange(e)}},t.commitChangingFormulaNodes=function(e,t){var r,n;void 0===t&&(t=!0);var a=this.formulaGraph.addNodes(e);this.alwaysNeedRecalculateNodeContainer.removeNodes(e),this.timingRecalculateNodeContainer.removeNodes(e),this.calculateLogicService.removeNodes(e),!0===t&&this.batchCalculateNodeContainer.addNodes(e),null===(n=(r=this.externalMethods).afterNodesChangedHook)||void 0===n||n.call(r,a&&Object.assign({graphSegmentType:I.FORMULA},a))},t.addCustomNodes=function(e){var t,r,n=this,a=e.changedRanges,o=e.customType,i=e.needCalculate,u=void 0===i||i,s=e.mergeableType,l=this.formulaGraph.addCustomNodes(o,a,s);if(!0===u){var c=[];a.forEach((function(e){var t=e.gridRange,r=e.formulaModel,a=e.nodeInfo;ae(t,(function(e,t,n){c.push({row:e,col:t,sheetId:n,formulaModel:r,nodeInfo:a})}),{rowCount:n.externalMethods.countRows(t.sheetId),colCount:n.externalMethods.countCols(t.sheetId)})})),this.batchCalculateNodeContainer.addNodes(c)}null===(r=(t=this.externalMethods).afterNodesChangedHook)||void 0===r||r.call(t,l&&Object.assign({graphSegmentType:I.FORMULA},l))},t.removeCustomNodes=function(e){var t,r,n=this,a=e.removedCustomNodes,o=e.customType,i=e.needCalculate,u=void 0===i||i,s=e.mergeableType;if(this.formulaGraph.removeCustomNodes(o,a,s),!0===u){var l=[];a.forEach((function(e){var t=e.gridRange;ae(t,(function(e,t,r){l.push({row:e,col:t,sheetId:r,nodeInfo:void 0})}),{rowCount:n.externalMethods.countRows(t.sheetId),colCount:n.externalMethods.countCols(t.sheetId)})})),this.batchCalculateNodeContainer.addNodes(l)}null===(r=(t=this.externalMethods).afterNodesChangedHook)||void 0===r||r.call(t)},t.calculateSomeSheetsImmediately=function(e,t){console.warn("函数开始整表计算"),this.batchCalculateNodeContainer.clear();var r=this.formulaGraph.getRecalculateTopSortNodesBySheetIdsAndNodes(e,t);this.calculateLogicService.calculateTopSortResult(r)},t.calculateSomeNodesImmediately=function(e){var t=[].concat((0,a.Z)(e),(0,a.Z)(this.alwaysNeedRecalculateNodeContainer.getAllNodes()));console.warn("函数开始更新计算");var r=this.formulaGraph.getRecalculateTopSortNodesByChangedNodes(t);this.calculateLogicService.calculateTopSortResult(r)},t.startCalculate=function(){this.calculateSomeNodesImmediately(this.batchCalculateNodeContainer.getAllNodes()),this.batchCalculateNodeContainer.clear()},t.markDirtyRange=function(e){var t=[];ae(e,(function(e,r,n){t.push({row:e,col:r,sheetId:n,nodeInfo:void 0})}),{rowCount:this.externalMethods.countRows(e.sheetId),colCount:this.externalMethods.countCols(e.sheetId)}),this.batchCalculateNodeContainer.addNodes(t)},t.getPerformanceInfo=function(){var e=this.calculateLogicService.calculateCenter.getPerformanceInfo(),t=this.formulaGraph.getPerformanceInfo();return Object.assign(Object.assign({},t),e)},t.resetPerformanceInfo=function(){this.calculateLogicService.calculateCenter.resetPerformanceInfo(),this.formulaGraph.resetPerformanceInfo()},t.addAlwaysCalculateNode=function(e){this.alwaysNeedRecalculateNodeContainer.addNode(e)},t.addTimingCalculateNode=function(e){this.timingRecalculateNodeContainer.addNode(e)},e}()}();var y=v.AD,N=v.Pz,M=v.QS,R=v.hP,E=v.zD,_=v.nx,T=v.VT,S=v.de,I=v.zH,C=v.D_,A=v.R8,w=v.Fz}}]),window.jsExecEndTimeStamp=Date.now(),window.cachedPerformanceEntries||(window.cachedPerformanceEntries=[]),window.cachedPerformanceEntries.push({name:"jsExec: js/initial_vendors_tencent_formula.b6776f3a5e4eb1d3ffe8.js",entryType:"jsExec",startTime:window.jsExecStartTimeStamp,endTime:window.jsExecEndTimeStamp});
//# sourceMappingURL=initial_vendors_tencent_formula.b6776f3a5e4eb1d3ffe8.js.map